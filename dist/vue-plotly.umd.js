var Dd=Object.defineProperty,Rd=Object.defineProperties;var Fd=Object.getOwnPropertyDescriptors;var Ah=Object.getOwnPropertySymbols;var Bd=Object.prototype.hasOwnProperty,Nd=Object.prototype.propertyIsEnumerable;var Mh=(Fo,La,fs)=>La in Fo?Dd(Fo,La,{enumerable:!0,configurable:!0,writable:!0,value:fs}):Fo[La]=fs,xc=(Fo,La)=>{for(var fs in La||(La={}))Bd.call(La,fs)&&Mh(Fo,fs,La[fs]);if(Ah)for(var fs of Ah(La))Nd.call(La,fs)&&Mh(Fo,fs,La[fs]);return Fo},Sh=(Fo,La)=>Rd(Fo,Fd(La));(function(Fo,La){typeof exports=="object"&&typeof module!="undefined"?La(exports):typeof define=="function"&&define.amd?define(["exports"],La):(Fo=typeof globalThis!="undefined"?globalThis:Fo||self,La(Fo["vue-plotly"]={}))})(this,function(Fo){"use strict";var La=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function fs(Gn){return Gn&&Gn.__esModule&&Object.prototype.hasOwnProperty.call(Gn,"default")?Gn.default:Gn}function bc(Gn){throw new Error('Could not dynamically require "'+Gn+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var qu={exports:{}};(function(Gn,Ca){(function(h){Gn.exports=h()})(function(){return function h(N,H,t){function m(e,f){if(!H[e]){if(!N[e]){var u=typeof bc=="function"&&bc;if(!f&&u)return u(e,!0);if(g)return g(e,!0);var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}var s=H[e]={exports:{}};N[e][0].call(s.exports,function(o){return m(N[e][1][o]||o)},s,s.exports,h,N,H,t)}return H[e].exports}for(var g=typeof bc=="function"&&bc,p=0;p<t.length;p++)m(t[p]);return m}({1:[function(h,N,H){var t=h("../src/lib"),m={"X,X div":'direction:ltr;font-family:"Open Sans",verdana,arial,sans-serif;margin:0;padding:0;',"X input,X button":'font-family:"Open Sans",verdana,arial,sans-serif;',"X input:focus,X button:focus":"outline:none;","X a":"text-decoration:none;","X a:hover":"text-decoration:none;","X .crisp":"shape-rendering:crispEdges;","X .user-select-none":"-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;","X svg":"overflow:hidden;","X svg a":"fill:#447adb;","X svg a:hover":"fill:#3c6dc5;","X .main-svg":"position:absolute;top:0;left:0;pointer-events:none;","X .main-svg .draglayer":"pointer-events:all;","X .cursor-default":"cursor:default;","X .cursor-pointer":"cursor:pointer;","X .cursor-crosshair":"cursor:crosshair;","X .cursor-move":"cursor:move;","X .cursor-col-resize":"cursor:col-resize;","X .cursor-row-resize":"cursor:row-resize;","X .cursor-ns-resize":"cursor:ns-resize;","X .cursor-ew-resize":"cursor:ew-resize;","X .cursor-sw-resize":"cursor:sw-resize;","X .cursor-s-resize":"cursor:s-resize;","X .cursor-se-resize":"cursor:se-resize;","X .cursor-w-resize":"cursor:w-resize;","X .cursor-e-resize":"cursor:e-resize;","X .cursor-nw-resize":"cursor:nw-resize;","X .cursor-n-resize":"cursor:n-resize;","X .cursor-ne-resize":"cursor:ne-resize;","X .cursor-grab":"cursor:-webkit-grab;cursor:grab;","X .modebar":"position:absolute;top:2px;right:2px;","X .ease-bg":"-webkit-transition:background-color .3s ease 0s;-moz-transition:background-color .3s ease 0s;-ms-transition:background-color .3s ease 0s;-o-transition:background-color .3s ease 0s;transition:background-color .3s ease 0s;","X .modebar--hover>:not(.watermark)":"opacity:0;-webkit-transition:opacity .3s ease 0s;-moz-transition:opacity .3s ease 0s;-ms-transition:opacity .3s ease 0s;-o-transition:opacity .3s ease 0s;transition:opacity .3s ease 0s;","X:hover .modebar--hover .modebar-group":"opacity:1;","X .modebar-group":"float:left;display:inline-block;box-sizing:border-box;padding-left:8px;position:relative;vertical-align:middle;white-space:nowrap;","X .modebar-btn":"position:relative;font-size:16px;padding:3px 4px;height:22px;cursor:pointer;line-height:normal;box-sizing:border-box;","X .modebar-btn svg":"position:relative;top:2px;","X .modebar.vertical":"display:flex;flex-direction:column;flex-wrap:wrap;align-content:flex-end;max-height:100%;","X .modebar.vertical svg":"top:-1px;","X .modebar.vertical .modebar-group":"display:block;float:none;padding-left:0px;padding-bottom:8px;","X .modebar.vertical .modebar-group .modebar-btn":"display:block;text-align:center;","X [data-title]:before,X [data-title]:after":"position:absolute;-webkit-transform:translate3d(0, 0, 0);-moz-transform:translate3d(0, 0, 0);-ms-transform:translate3d(0, 0, 0);-o-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);display:none;opacity:0;z-index:1001;pointer-events:none;top:110%;right:50%;","X [data-title]:hover:before,X [data-title]:hover:after":"display:block;opacity:1;","X [data-title]:before":'content:"";position:absolute;background:transparent;border:6px solid transparent;z-index:1002;margin-top:-12px;border-bottom-color:#69738a;margin-right:-6px;',"X [data-title]:after":"content:attr(data-title);background:#69738a;color:#fff;padding:8px 10px;font-size:12px;line-height:12px;white-space:nowrap;margin-right:-18px;border-radius:2px;","X .vertical [data-title]:before,X .vertical [data-title]:after":"top:0%;right:200%;","X .vertical [data-title]:before":"border:6px solid transparent;border-left-color:#69738a;margin-top:8px;margin-right:-30px;","X .select-outline":"fill:none;stroke-width:1;shape-rendering:crispEdges;","X .select-outline-1":"stroke:#fff;","X .select-outline-2":"stroke:#000;stroke-dasharray:2px 2px;",Y:'font-family:"Open Sans",verdana,arial,sans-serif;position:fixed;top:50px;right:20px;z-index:10000;font-size:10pt;max-width:180px;',"Y p":"margin:0;","Y .notifier-note":"min-width:180px;max-width:250px;border:1px solid #fff;z-index:3000;margin:0;background-color:#8c97af;background-color:rgba(140,151,175,.9);color:#fff;padding:10px;overflow-wrap:break-word;word-wrap:break-word;-ms-hyphens:auto;-webkit-hyphens:auto;hyphens:auto;","Y .notifier-close":"color:#fff;opacity:.8;float:right;padding:0 5px;background:none;border:none;font-size:20px;font-weight:bold;line-height:20px;","Y .notifier-close:hover":"color:#444;text-decoration:none;cursor:pointer;"};for(var g in m){var p=g.replace(/^,/," ,").replace(/X/g,".js-plotly-plot .plotly").replace(/Y/g,".plotly-notifier");t.addStyleRule(p,m[g])}},{"../src/lib":787}],2:[function(h,N,H){N.exports=h("../src/transforms/aggregate")},{"../src/transforms/aggregate":1383}],3:[function(h,N,H){N.exports=h("../src/traces/bar")},{"../src/traces/bar":933}],4:[function(h,N,H){N.exports=h("../src/traces/barpolar")},{"../src/traces/barpolar":946}],5:[function(h,N,H){N.exports=h("../src/traces/box")},{"../src/traces/box":956}],6:[function(h,N,H){N.exports=h("../src/components/calendars")},{"../src/components/calendars":648}],7:[function(h,N,H){N.exports=h("../src/traces/candlestick")},{"../src/traces/candlestick":965}],8:[function(h,N,H){N.exports=h("../src/traces/carpet")},{"../src/traces/carpet":984}],9:[function(h,N,H){N.exports=h("../src/traces/choropleth")},{"../src/traces/choropleth":998}],10:[function(h,N,H){N.exports=h("../src/traces/choroplethmapbox")},{"../src/traces/choroplethmapbox":1005}],11:[function(h,N,H){N.exports=h("../src/traces/cone")},{"../src/traces/cone":1011}],12:[function(h,N,H){N.exports=h("../src/traces/contour")},{"../src/traces/contour":1026}],13:[function(h,N,H){N.exports=h("../src/traces/contourcarpet")},{"../src/traces/contourcarpet":1037}],14:[function(h,N,H){N.exports=h("../src/core")},{"../src/core":765}],15:[function(h,N,H){N.exports=h("../src/traces/densitymapbox")},{"../src/traces/densitymapbox":1045}],16:[function(h,N,H){N.exports=h("../src/transforms/filter")},{"../src/transforms/filter":1384}],17:[function(h,N,H){N.exports=h("../src/traces/funnel")},{"../src/traces/funnel":1055}],18:[function(h,N,H){N.exports=h("../src/traces/funnelarea")},{"../src/traces/funnelarea":1064}],19:[function(h,N,H){N.exports=h("../src/transforms/groupby")},{"../src/transforms/groupby":1385}],20:[function(h,N,H){N.exports=h("../src/traces/heatmap")},{"../src/traces/heatmap":1077}],21:[function(h,N,H){N.exports=h("../src/traces/heatmapgl")},{"../src/traces/heatmapgl":1087}],22:[function(h,N,H){N.exports=h("../src/traces/histogram")},{"../src/traces/histogram":1099}],23:[function(h,N,H){N.exports=h("../src/traces/histogram2d")},{"../src/traces/histogram2d":1105}],24:[function(h,N,H){N.exports=h("../src/traces/histogram2dcontour")},{"../src/traces/histogram2dcontour":1109}],25:[function(h,N,H){N.exports=h("../src/traces/icicle")},{"../src/traces/icicle":1115}],26:[function(h,N,H){N.exports=h("../src/traces/image")},{"../src/traces/image":1128}],27:[function(h,N,H){var t=h("./core");t.register([h("./bar"),h("./box"),h("./heatmap"),h("./histogram"),h("./histogram2d"),h("./histogram2dcontour"),h("./contour"),h("./scatterternary"),h("./violin"),h("./funnel"),h("./waterfall"),h("./image"),h("./pie"),h("./sunburst"),h("./treemap"),h("./icicle"),h("./funnelarea"),h("./scatter3d"),h("./surface"),h("./isosurface"),h("./volume"),h("./mesh3d"),h("./cone"),h("./streamtube"),h("./scattergeo"),h("./choropleth"),h("./scattergl"),h("./splom"),h("./pointcloud"),h("./heatmapgl"),h("./parcoords"),h("./parcats"),h("./scattermapbox"),h("./choroplethmapbox"),h("./densitymapbox"),h("./sankey"),h("./indicator"),h("./table"),h("./carpet"),h("./scattercarpet"),h("./contourcarpet"),h("./ohlc"),h("./candlestick"),h("./scatterpolar"),h("./scatterpolargl"),h("./barpolar"),h("./aggregate"),h("./filter"),h("./groupby"),h("./sort"),h("./calendars")]),N.exports=t},{"./aggregate":2,"./bar":3,"./barpolar":4,"./box":5,"./calendars":6,"./candlestick":7,"./carpet":8,"./choropleth":9,"./choroplethmapbox":10,"./cone":11,"./contour":12,"./contourcarpet":13,"./core":14,"./densitymapbox":15,"./filter":16,"./funnel":17,"./funnelarea":18,"./groupby":19,"./heatmap":20,"./heatmapgl":21,"./histogram":22,"./histogram2d":23,"./histogram2dcontour":24,"./icicle":25,"./image":26,"./indicator":28,"./isosurface":29,"./mesh3d":30,"./ohlc":31,"./parcats":32,"./parcoords":33,"./pie":34,"./pointcloud":35,"./sankey":36,"./scatter3d":37,"./scattercarpet":38,"./scattergeo":39,"./scattergl":40,"./scattermapbox":41,"./scatterpolar":42,"./scatterpolargl":43,"./scatterternary":44,"./sort":45,"./splom":46,"./streamtube":47,"./sunburst":48,"./surface":49,"./table":50,"./treemap":51,"./violin":52,"./volume":53,"./waterfall":54}],28:[function(h,N,H){N.exports=h("../src/traces/indicator")},{"../src/traces/indicator":1136}],29:[function(h,N,H){N.exports=h("../src/traces/isosurface")},{"../src/traces/isosurface":1142}],30:[function(h,N,H){N.exports=h("../src/traces/mesh3d")},{"../src/traces/mesh3d":1147}],31:[function(h,N,H){N.exports=h("../src/traces/ohlc")},{"../src/traces/ohlc":1152}],32:[function(h,N,H){N.exports=h("../src/traces/parcats")},{"../src/traces/parcats":1161}],33:[function(h,N,H){N.exports=h("../src/traces/parcoords")},{"../src/traces/parcoords":1171}],34:[function(h,N,H){N.exports=h("../src/traces/pie")},{"../src/traces/pie":1182}],35:[function(h,N,H){N.exports=h("../src/traces/pointcloud")},{"../src/traces/pointcloud":1191}],36:[function(h,N,H){N.exports=h("../src/traces/sankey")},{"../src/traces/sankey":1197}],37:[function(h,N,H){N.exports=h("../src/traces/scatter3d")},{"../src/traces/scatter3d":1235}],38:[function(h,N,H){N.exports=h("../src/traces/scattercarpet")},{"../src/traces/scattercarpet":1242}],39:[function(h,N,H){N.exports=h("../src/traces/scattergeo")},{"../src/traces/scattergeo":1250}],40:[function(h,N,H){N.exports=h("../src/traces/scattergl")},{"../src/traces/scattergl":1263}],41:[function(h,N,H){N.exports=h("../src/traces/scattermapbox")},{"../src/traces/scattermapbox":1273}],42:[function(h,N,H){N.exports=h("../src/traces/scatterpolar")},{"../src/traces/scatterpolar":1281}],43:[function(h,N,H){N.exports=h("../src/traces/scatterpolargl")},{"../src/traces/scatterpolargl":1288}],44:[function(h,N,H){N.exports=h("../src/traces/scatterternary")},{"../src/traces/scatterternary":1296}],45:[function(h,N,H){N.exports=h("../src/transforms/sort")},{"../src/transforms/sort":1387}],46:[function(h,N,H){N.exports=h("../src/traces/splom")},{"../src/traces/splom":1305}],47:[function(h,N,H){N.exports=h("../src/traces/streamtube")},{"../src/traces/streamtube":1313}],48:[function(h,N,H){N.exports=h("../src/traces/sunburst")},{"../src/traces/sunburst":1321}],49:[function(h,N,H){N.exports=h("../src/traces/surface")},{"../src/traces/surface":1330}],50:[function(h,N,H){N.exports=h("../src/traces/table")},{"../src/traces/table":1338}],51:[function(h,N,H){N.exports=h("../src/traces/treemap")},{"../src/traces/treemap":1349}],52:[function(h,N,H){N.exports=h("../src/traces/violin")},{"../src/traces/violin":1362}],53:[function(h,N,H){N.exports=h("../src/traces/volume")},{"../src/traces/volume":1370}],54:[function(h,N,H){N.exports=h("../src/traces/waterfall")},{"../src/traces/waterfall":1378}],55:[function(h,N,H){N.exports=function(f){var u=(f=f||{}).eye||[0,0,1],i=f.center||[0,0,0],s=f.up||[0,1,0],o=f.distanceLimits||[0,1/0],a=f.mode||"turntable",c=t(),r=m(),n=g();return c.setDistanceLimits(o[0],o[1]),c.lookAt(0,u,i,s),r.setDistanceLimits(o[0],o[1]),r.lookAt(0,u,i,s),n.setDistanceLimits(o[0],o[1]),n.lookAt(0,u,i,s),new p({turntable:c,orbit:r,matrix:n},a)};var t=h("turntable-camera-controller"),m=h("orbit-camera-controller"),g=h("matrix-camera-controller");function p(f,u){this._controllerNames=Object.keys(f),this._controllerList=this._controllerNames.map(function(i){return f[i]}),this._mode=u,this._active=f[u],this._active||(this._mode="turntable",this._active=f.turntable),this.modes=this._controllerNames,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}var e=p.prototype;e.flush=function(f){for(var u=this._controllerList,i=0;i<u.length;++i)u[i].flush(f)},e.idle=function(f){for(var u=this._controllerList,i=0;i<u.length;++i)u[i].idle(f)},e.lookAt=function(f,u,i,s){for(var o=this._controllerList,a=0;a<o.length;++a)o[a].lookAt(f,u,i,s)},e.rotate=function(f,u,i,s){for(var o=this._controllerList,a=0;a<o.length;++a)o[a].rotate(f,u,i,s)},e.pan=function(f,u,i,s){for(var o=this._controllerList,a=0;a<o.length;++a)o[a].pan(f,u,i,s)},e.translate=function(f,u,i,s){for(var o=this._controllerList,a=0;a<o.length;++a)o[a].translate(f,u,i,s)},e.setMatrix=function(f,u){for(var i=this._controllerList,s=0;s<i.length;++s)i[s].setMatrix(f,u)},e.setDistanceLimits=function(f,u){for(var i=this._controllerList,s=0;s<i.length;++s)i[s].setDistanceLimits(f,u)},e.setDistance=function(f,u){for(var i=this._controllerList,s=0;s<i.length;++s)i[s].setDistance(f,u)},e.recalcMatrix=function(f){this._active.recalcMatrix(f)},e.getDistance=function(f){return this._active.getDistance(f)},e.getDistanceLimits=function(f){return this._active.getDistanceLimits(f)},e.lastT=function(){return this._active.lastT()},e.setMode=function(f){if(f!==this._mode){var u=this._controllerNames.indexOf(f);if(!(u<0)){var i=this._active,s=this._controllerList[u],o=Math.max(i.lastT(),s.lastT());i.recalcMatrix(o),s.setMatrix(o,i.computedMatrix),this._active=s,this._mode=f,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}}},e.getMode=function(){return this._mode}},{"matrix-camera-controller":457,"orbit-camera-controller":478,"turntable-camera-controller":587}],56:[function(h,N,H){(function(t,m){typeof H=="object"&&N!==void 0?m(H,h("d3-array"),h("d3-collection"),h("d3-shape"),h("elementary-circuits-directed-graph")):m(t.d3=t.d3||{},t.d3,t.d3,t.d3,null)})(this,function(t,m,g,p,e){function f(ie){return ie.target.depth}function u(ie,ae){return ie.sourceLinks.length?ie.depth:ae-1}function i(ie){return function(){return ie}}e=e&&e.hasOwnProperty("default")?e.default:e;var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ie){return typeof ie}:function(ie){return ie&&typeof Symbol=="function"&&ie.constructor===Symbol&&ie!==Symbol.prototype?"symbol":typeof ie};function o(ie,ae){return c(ie.source,ae.source)||ie.index-ae.index}function a(ie,ae){return c(ie.target,ae.target)||ie.index-ae.index}function c(ie,ae){return ie.partOfCycle===ae.partOfCycle?ie.y0-ae.y0:ie.circularLinkType==="top"||ae.circularLinkType==="bottom"?-1:1}function r(ie){return ie.value}function n(ie){return(ie.y0+ie.y1)/2}function d(ie){return n(ie.source)}function l(ie){return n(ie.target)}function y(ie){return ie.index}function v(ie){return ie.nodes}function _(ie){return ie.links}function x(ie,ae){var he=ie.get(ae);if(!he)throw new Error("missing: "+ae);return he}function T(ie,ae){return ae(ie)}function A(ie,ae,he){var se=0;if(he===null){for(var de=[],ce=0;ce<ie.links.length;ce++){var ve=ie.links[ce],ke=ve.source.index,Ee=ve.target.index;de[ke]||(de[ke]=[]),de[Ee]||(de[Ee]=[]),de[ke].indexOf(Ee)===-1&&de[ke].push(Ee)}var be=e(de);be.sort(function(me,we){return me.length-we.length});var xe={};for(ce=0;ce<be.length;ce++){var ue=be[ce].slice(-2);xe[ue[0]]||(xe[ue[0]]={}),xe[ue[0]][ue[1]]=!0}ie.links.forEach(function(me){var we=me.target.index,Me=me.source.index;we===Me||xe[Me]&&xe[Me][we]?(me.circular=!0,me.circularLinkID=se,se+=1):me.circular=!1})}else ie.links.forEach(function(me){me.source[he]<me.target[he]?me.circular=!1:(me.circular=!0,me.circularLinkID=se,se+=1)})}function S(ie,ae){var he=0,se=0;ie.links.forEach(function(de){de.circular&&(de.source.circularLinkType||de.target.circularLinkType?de.circularLinkType=de.source.circularLinkType?de.source.circularLinkType:de.target.circularLinkType:de.circularLinkType=he<se?"top":"bottom",de.circularLinkType=="top"?he+=1:se+=1,ie.nodes.forEach(function(ce){T(ce,ae)!=T(de.source,ae)&&T(ce,ae)!=T(de.target,ae)||(ce.circularLinkType=de.circularLinkType)}))}),ie.links.forEach(function(de){de.circular&&(de.source.circularLinkType==de.target.circularLinkType&&(de.circularLinkType=de.source.circularLinkType),$(de,ae)&&(de.circularLinkType=de.source.circularLinkType))})}function w(ie){var ae=Math.abs(ie.y1-ie.y0),he=Math.abs(ie.target.x0-ie.source.x1);return Math.atan(he/ae)}function L(ie,ae){var he=0;ie.sourceLinks.forEach(function(de){he=de.circular&&!$(de,ae)?he+1:he});var se=0;return ie.targetLinks.forEach(function(de){se=de.circular&&!$(de,ae)?se+1:se}),he+se}function k(ie){var ae=ie.source.sourceLinks,he=0;ae.forEach(function(ce){he=ce.circular?he+1:he});var se=ie.target.targetLinks,de=0;return se.forEach(function(ce){de=ce.circular?de+1:de}),!(he>1||de>1)}function C(ie,ae,he){return ie.sort(P),ie.forEach(function(se,de){var ce,ve,ke=0;if($(se,he)&&k(se))se.circularPathData.verticalBuffer=ke+se.width/2;else{for(var Ee=0;Ee<de;Ee++)if(ce=ie[de],ve=ie[Ee],!(ce.source.column<ve.target.column||ce.target.column>ve.source.column)){var be=ie[Ee].circularPathData.verticalBuffer+ie[Ee].width/2+ae;ke=be>ke?be:ke}se.circularPathData.verticalBuffer=ke+se.width/2}}),ie}function M(ie,ae,he,se){var de=m.min(ie.links,function(ce){return ce.source.y0});ie.links.forEach(function(ce){ce.circular&&(ce.circularPathData={})}),C(ie.links.filter(function(ce){return ce.circularLinkType=="top"}),ae,se),C(ie.links.filter(function(ce){return ce.circularLinkType=="bottom"}),ae,se),ie.links.forEach(function(ce){if(ce.circular){if(ce.circularPathData.arcRadius=ce.width+10,ce.circularPathData.leftNodeBuffer=5,ce.circularPathData.rightNodeBuffer=5,ce.circularPathData.sourceWidth=ce.source.x1-ce.source.x0,ce.circularPathData.sourceX=ce.source.x0+ce.circularPathData.sourceWidth,ce.circularPathData.targetX=ce.target.x0,ce.circularPathData.sourceY=ce.y0,ce.circularPathData.targetY=ce.y1,$(ce,se)&&k(ce))ce.circularPathData.leftSmallArcRadius=10+ce.width/2,ce.circularPathData.leftLargeArcRadius=10+ce.width/2,ce.circularPathData.rightSmallArcRadius=10+ce.width/2,ce.circularPathData.rightLargeArcRadius=10+ce.width/2,ce.circularLinkType=="bottom"?(ce.circularPathData.verticalFullExtent=ce.source.y1+25+ce.circularPathData.verticalBuffer,ce.circularPathData.verticalLeftInnerExtent=ce.circularPathData.verticalFullExtent-ce.circularPathData.leftLargeArcRadius,ce.circularPathData.verticalRightInnerExtent=ce.circularPathData.verticalFullExtent-ce.circularPathData.rightLargeArcRadius):(ce.circularPathData.verticalFullExtent=ce.source.y0-25-ce.circularPathData.verticalBuffer,ce.circularPathData.verticalLeftInnerExtent=ce.circularPathData.verticalFullExtent+ce.circularPathData.leftLargeArcRadius,ce.circularPathData.verticalRightInnerExtent=ce.circularPathData.verticalFullExtent+ce.circularPathData.rightLargeArcRadius);else{var ve=ce.source.column,ke=ce.circularLinkType,Ee=ie.links.filter(function(ue){return ue.source.column==ve&&ue.circularLinkType==ke});ce.circularLinkType=="bottom"?Ee.sort(F):Ee.sort(O);var be=0;Ee.forEach(function(ue,me){ue.circularLinkID==ce.circularLinkID&&(ce.circularPathData.leftSmallArcRadius=10+ce.width/2+be,ce.circularPathData.leftLargeArcRadius=10+ce.width/2+me*ae+be),be+=ue.width}),ve=ce.target.column,Ee=ie.links.filter(function(ue){return ue.target.column==ve&&ue.circularLinkType==ke}),ce.circularLinkType=="bottom"?Ee.sort(W):Ee.sort(j),be=0,Ee.forEach(function(ue,me){ue.circularLinkID==ce.circularLinkID&&(ce.circularPathData.rightSmallArcRadius=10+ce.width/2+be,ce.circularPathData.rightLargeArcRadius=10+ce.width/2+me*ae+be),be+=ue.width}),ce.circularLinkType=="bottom"?(ce.circularPathData.verticalFullExtent=Math.max(he,ce.source.y1,ce.target.y1)+25+ce.circularPathData.verticalBuffer,ce.circularPathData.verticalLeftInnerExtent=ce.circularPathData.verticalFullExtent-ce.circularPathData.leftLargeArcRadius,ce.circularPathData.verticalRightInnerExtent=ce.circularPathData.verticalFullExtent-ce.circularPathData.rightLargeArcRadius):(ce.circularPathData.verticalFullExtent=de-25-ce.circularPathData.verticalBuffer,ce.circularPathData.verticalLeftInnerExtent=ce.circularPathData.verticalFullExtent+ce.circularPathData.leftLargeArcRadius,ce.circularPathData.verticalRightInnerExtent=ce.circularPathData.verticalFullExtent+ce.circularPathData.rightLargeArcRadius)}ce.circularPathData.leftInnerExtent=ce.circularPathData.sourceX+ce.circularPathData.leftNodeBuffer,ce.circularPathData.rightInnerExtent=ce.circularPathData.targetX-ce.circularPathData.rightNodeBuffer,ce.circularPathData.leftFullExtent=ce.circularPathData.sourceX+ce.circularPathData.leftLargeArcRadius+ce.circularPathData.leftNodeBuffer,ce.circularPathData.rightFullExtent=ce.circularPathData.targetX-ce.circularPathData.rightLargeArcRadius-ce.circularPathData.rightNodeBuffer}if(ce.circular)ce.path=function(ue){var me="";return me=ue.circularLinkType=="top"?"M"+ue.circularPathData.sourceX+" "+ue.circularPathData.sourceY+" L"+ue.circularPathData.leftInnerExtent+" "+ue.circularPathData.sourceY+" A"+ue.circularPathData.leftLargeArcRadius+" "+ue.circularPathData.leftSmallArcRadius+" 0 0 0 "+ue.circularPathData.leftFullExtent+" "+(ue.circularPathData.sourceY-ue.circularPathData.leftSmallArcRadius)+" L"+ue.circularPathData.leftFullExtent+" "+ue.circularPathData.verticalLeftInnerExtent+" A"+ue.circularPathData.leftLargeArcRadius+" "+ue.circularPathData.leftLargeArcRadius+" 0 0 0 "+ue.circularPathData.leftInnerExtent+" "+ue.circularPathData.verticalFullExtent+" L"+ue.circularPathData.rightInnerExtent+" "+ue.circularPathData.verticalFullExtent+" A"+ue.circularPathData.rightLargeArcRadius+" "+ue.circularPathData.rightLargeArcRadius+" 0 0 0 "+ue.circularPathData.rightFullExtent+" "+ue.circularPathData.verticalRightInnerExtent+" L"+ue.circularPathData.rightFullExtent+" "+(ue.circularPathData.targetY-ue.circularPathData.rightSmallArcRadius)+" A"+ue.circularPathData.rightLargeArcRadius+" "+ue.circularPathData.rightSmallArcRadius+" 0 0 0 "+ue.circularPathData.rightInnerExtent+" "+ue.circularPathData.targetY+" L"+ue.circularPathData.targetX+" "+ue.circularPathData.targetY:"M"+ue.circularPathData.sourceX+" "+ue.circularPathData.sourceY+" L"+ue.circularPathData.leftInnerExtent+" "+ue.circularPathData.sourceY+" A"+ue.circularPathData.leftLargeArcRadius+" "+ue.circularPathData.leftSmallArcRadius+" 0 0 1 "+ue.circularPathData.leftFullExtent+" "+(ue.circularPathData.sourceY+ue.circularPathData.leftSmallArcRadius)+" L"+ue.circularPathData.leftFullExtent+" "+ue.circularPathData.verticalLeftInnerExtent+" A"+ue.circularPathData.leftLargeArcRadius+" "+ue.circularPathData.leftLargeArcRadius+" 0 0 1 "+ue.circularPathData.leftInnerExtent+" "+ue.circularPathData.verticalFullExtent+" L"+ue.circularPathData.rightInnerExtent+" "+ue.circularPathData.verticalFullExtent+" A"+ue.circularPathData.rightLargeArcRadius+" "+ue.circularPathData.rightLargeArcRadius+" 0 0 1 "+ue.circularPathData.rightFullExtent+" "+ue.circularPathData.verticalRightInnerExtent+" L"+ue.circularPathData.rightFullExtent+" "+(ue.circularPathData.targetY+ue.circularPathData.rightSmallArcRadius)+" A"+ue.circularPathData.rightLargeArcRadius+" "+ue.circularPathData.rightSmallArcRadius+" 0 0 1 "+ue.circularPathData.rightInnerExtent+" "+ue.circularPathData.targetY+" L"+ue.circularPathData.targetX+" "+ue.circularPathData.targetY,me}(ce);else{var xe=p.linkHorizontal().source(function(ue){return[ue.source.x0+(ue.source.x1-ue.source.x0),ue.y0]}).target(function(ue){return[ue.target.x0,ue.y1]});ce.path=xe(ce)}})}function P(ie,ae){return Z(ie)==Z(ae)?ie.circularLinkType=="bottom"?F(ie,ae):O(ie,ae):Z(ae)-Z(ie)}function O(ie,ae){return ie.y0-ae.y0}function F(ie,ae){return ae.y0-ie.y0}function j(ie,ae){return ie.y1-ae.y1}function W(ie,ae){return ae.y1-ie.y1}function Z(ie){return ie.target.column-ie.source.column}function Q(ie){return ie.target.x0-ie.source.x1}function X(ie,ae){var he=w(ie),se=Q(ae)/Math.tan(he);return J(ie)=="up"?ie.y1+se:ie.y1-se}function G(ie,ae){var he=w(ie),se=Q(ae)/Math.tan(he);return J(ie)=="up"?ie.y1-se:ie.y1+se}function Y(ie,ae,he,se){ie.links.forEach(function(de){if(!de.circular&&de.target.column-de.source.column>1){var ce=de.source.column+1,ve=de.target.column-1,ke=1,Ee=ve-ce+1;for(ke=1;ce<=ve;ce++,ke++)ie.nodes.forEach(function(be){if(be.column==ce){var xe,ue=ke/(Ee+1),me=Math.pow(1-ue,3),we=3*ue*Math.pow(1-ue,2),Me=3*Math.pow(ue,2)*(1-ue),Se=Math.pow(ue,3),De=me*de.y0+we*de.y0+Me*de.y1+Se*de.y1,Fe=De-de.width/2,Ye=De+de.width/2;Fe>be.y0&&Fe<be.y1?(xe=be.y1-Fe+10,xe=be.circularLinkType=="bottom"?xe:-xe,be=D(be,xe,ae,he),ie.nodes.forEach(function(et){T(et,se)!=T(be,se)&&et.column==be.column&&K(be,et)&&D(et,xe,ae,he)})):(Ye>be.y0&&Ye<be.y1||Fe<be.y0&&Ye>be.y1)&&(xe=Ye-be.y0+10,be=D(be,xe,ae,he),ie.nodes.forEach(function(et){T(et,se)!=T(be,se)&&et.column==be.column&&et.y0<be.y1&&et.y1>be.y1&&D(et,xe,ae,he)}))}})}})}function K(ie,ae){return ie.y0>ae.y0&&ie.y0<ae.y1||ie.y1>ae.y0&&ie.y1<ae.y1||ie.y0<ae.y0&&ie.y1>ae.y1}function D(ie,ae,he,se){return ie.y0+ae>=he&&ie.y1+ae<=se&&(ie.y0=ie.y0+ae,ie.y1=ie.y1+ae,ie.targetLinks.forEach(function(de){de.y1=de.y1+ae}),ie.sourceLinks.forEach(function(de){de.y0=de.y0+ae})),ie}function B(ie,ae,he,se){ie.nodes.forEach(function(de){se&&de.y+(de.y1-de.y0)>ae&&(de.y=de.y-(de.y+(de.y1-de.y0)-ae));var ce=ie.links.filter(function(Ee){return T(Ee.source,he)==T(de,he)}),ve=ce.length;ve>1&&ce.sort(function(Ee,be){if(!Ee.circular&&!be.circular){if(Ee.target.column==be.target.column||!ee(Ee,be))return Ee.y1-be.y1;if(Ee.target.column>be.target.column){var xe=G(be,Ee);return Ee.y1-xe}if(be.target.column>Ee.target.column)return G(Ee,be)-be.y1}return Ee.circular&&!be.circular?Ee.circularLinkType=="top"?-1:1:be.circular&&!Ee.circular?be.circularLinkType=="top"?1:-1:Ee.circular&&be.circular?Ee.circularLinkType===be.circularLinkType&&Ee.circularLinkType=="top"?Ee.target.column===be.target.column?Ee.target.y1-be.target.y1:be.target.column-Ee.target.column:Ee.circularLinkType===be.circularLinkType&&Ee.circularLinkType=="bottom"?Ee.target.column===be.target.column?be.target.y1-Ee.target.y1:Ee.target.column-be.target.column:Ee.circularLinkType=="top"?-1:1:void 0});var ke=de.y0;ce.forEach(function(Ee){Ee.y0=ke+Ee.width/2,ke+=Ee.width}),ce.forEach(function(Ee,be){if(Ee.circularLinkType=="bottom"){for(var xe=be+1,ue=0;xe<ve;xe++)ue+=ce[xe].width;Ee.y0=de.y1-ue-Ee.width/2}})})}function q(ie,ae,he){ie.nodes.forEach(function(se){var de=ie.links.filter(function(ke){return T(ke.target,he)==T(se,he)}),ce=de.length;ce>1&&de.sort(function(ke,Ee){if(!ke.circular&&!Ee.circular){if(ke.source.column==Ee.source.column||!ee(ke,Ee))return ke.y0-Ee.y0;if(Ee.source.column<ke.source.column){var be=X(Ee,ke);return ke.y0-be}if(ke.source.column<Ee.source.column)return X(ke,Ee)-Ee.y0}return ke.circular&&!Ee.circular?ke.circularLinkType=="top"?-1:1:Ee.circular&&!ke.circular?Ee.circularLinkType=="top"?1:-1:ke.circular&&Ee.circular?ke.circularLinkType===Ee.circularLinkType&&ke.circularLinkType=="top"?ke.source.column===Ee.source.column?ke.source.y1-Ee.source.y1:ke.source.column-Ee.source.column:ke.circularLinkType===Ee.circularLinkType&&ke.circularLinkType=="bottom"?ke.source.column===Ee.source.column?ke.source.y1-Ee.source.y1:Ee.source.column-ke.source.column:ke.circularLinkType=="top"?-1:1:void 0});var ve=se.y0;de.forEach(function(ke){ke.y1=ve+ke.width/2,ve+=ke.width}),de.forEach(function(ke,Ee){if(ke.circularLinkType=="bottom"){for(var be=Ee+1,xe=0;be<ce;be++)xe+=de[be].width;ke.y1=se.y1-xe-ke.width/2}})})}function ee(ie,ae){return J(ie)==J(ae)}function J(ie){return ie.y0-ie.y1>0?"up":"down"}function $(ie,ae){return T(ie.source,ae)==T(ie.target,ae)}function te(ie,ae,he){var se=ie.nodes,de=ie.links,ce=!1,ve=!1;if(de.forEach(function(be){be.circularLinkType=="top"?ce=!0:be.circularLinkType=="bottom"&&(ve=!0)}),ce==0||ve==0){var ke=m.min(se,function(be){return be.y0}),Ee=(he-ae)/(m.max(se,function(be){return be.y1})-ke);se.forEach(function(be){var xe=(be.y1-be.y0)*Ee;be.y0=(be.y0-ke)*Ee,be.y1=be.y0+xe}),de.forEach(function(be){be.y0=(be.y0-ke)*Ee,be.y1=(be.y1-ke)*Ee,be.width=be.width*Ee})}}t.sankeyCircular=function(){var ie,ae,he=0,se=0,de=1,ce=1,ve=24,ke=y,Ee=u,be=v,xe=_,ue=32,me=2,we=null;function Me(){var Oe={nodes:be.apply(null,arguments),links:xe.apply(null,arguments)};Se(Oe),A(Oe,ke,we),De(Oe),Fe(Oe),S(Oe,ke),Ye(Oe,ue,ke),et(Oe);for(var je=4,We=0;We<je;We++)B(Oe,ce,ke),q(Oe,ce,ke),Y(Oe,se,ce,ke),B(Oe,ce,ke),q(Oe,ce,ke);return te(Oe,se,ce),M(Oe,me,ce,ke),Oe}function Se(Oe){Oe.nodes.forEach(function(We,Ge){We.index=Ge,We.sourceLinks=[],We.targetLinks=[]});var je=g.map(Oe.nodes,ke);return Oe.links.forEach(function(We,Ge){We.index=Ge;var Qe=We.source,it=We.target;(Qe===void 0?"undefined":s(Qe))!=="object"&&(Qe=We.source=x(je,Qe)),(it===void 0?"undefined":s(it))!=="object"&&(it=We.target=x(je,it)),Qe.sourceLinks.push(We),it.targetLinks.push(We)}),Oe}function De(Oe){Oe.nodes.forEach(function(je){je.partOfCycle=!1,je.value=Math.max(m.sum(je.sourceLinks,r),m.sum(je.targetLinks,r)),je.sourceLinks.forEach(function(We){We.circular&&(je.partOfCycle=!0,je.circularLinkType=We.circularLinkType)}),je.targetLinks.forEach(function(We){We.circular&&(je.partOfCycle=!0,je.circularLinkType=We.circularLinkType)})})}function Fe(Oe){var je,We,Ge;for(je=Oe.nodes,We=[],Ge=0;je.length;++Ge,je=We,We=[])je.forEach(function(Qe){Qe.depth=Ge,Qe.sourceLinks.forEach(function(it){We.indexOf(it.target)<0&&!it.circular&&We.push(it.target)})});for(je=Oe.nodes,We=[],Ge=0;je.length;++Ge,je=We,We=[])je.forEach(function(Qe){Qe.height=Ge,Qe.targetLinks.forEach(function(it){We.indexOf(it.source)<0&&!it.circular&&We.push(it.source)})});Oe.nodes.forEach(function(Qe){Qe.column=Math.floor(Ee.call(null,Qe,Ge))})}function Ye(Oe,je,We){var Ge=g.nest().key(function(wt){return wt.column}).sortKeys(m.ascending).entries(Oe.nodes).map(function(wt){return wt.values});(function(wt){if(ae){var rt=1/0;Ge.forEach(function($t){var Ue=ce*ae/($t.length+1);rt=Ue<rt?Ue:rt}),ie=rt}var $e=m.min(Ge,function($t){return(ce-se-($t.length-1)*ie)/m.sum($t,r)});$e*=.3,Oe.links.forEach(function($t){$t.width=$t.value*$e});var xt=function($t){var Ue=0,He=0,Be=0,Je=0,_e=m.max($t.nodes,function(Le){return Le.column});return $t.links.forEach(function(Le){Le.circular&&(Le.circularLinkType=="top"?Ue+=Le.width:He+=Le.width,Le.target.column==0&&(Je+=Le.width),Le.source.column==_e&&(Be+=Le.width))}),{top:Ue=Ue>0?Ue+25+10:Ue,bottom:He=He>0?He+25+10:He,left:Je=Je>0?Je+25+10:Je,right:Be=Be>0?Be+25+10:Be}}(Oe),Qt=function($t,Ue){var He=m.max($t.nodes,function(Ce){return Ce.column}),Be=de-he,Je=ce-se,_e=Be/(Be+Ue.right+Ue.left),Le=Je/(Je+Ue.top+Ue.bottom);return he=he*_e+Ue.left,de=Ue.right==0?de:de*_e,se=se*Le+Ue.top,ce*=Le,$t.nodes.forEach(function(Ce){Ce.x0=he+Ce.column*((de-he-ve)/He),Ce.x1=Ce.x0+ve}),Le}(Oe,xt);$e*=Qt,Oe.links.forEach(function($t){$t.width=$t.value*$e}),Ge.forEach(function($t){var Ue=$t.length;$t.forEach(function(He,Be){He.depth==Ge.length-1&&Ue==1||He.depth==0&&Ue==1?(He.y0=ce/2-He.value*$e,He.y1=He.y0+He.value*$e):He.partOfCycle?L(He,wt)==0?(He.y0=ce/2+Be,He.y1=He.y0+He.value*$e):He.circularLinkType=="top"?(He.y0=se+Be,He.y1=He.y0+He.value*$e):(He.y0=ce-He.value*$e-Be,He.y1=He.y0+He.value*$e):xt.top==0||xt.bottom==0?(He.y0=(ce-se)/Ue*Be,He.y1=He.y0+He.value*$e):(He.y0=(ce-se)/2-Ue/2+Be,He.y1=He.y0+He.value*$e)})})})(We),Lt();for(var Qe=1,it=je;it>0;--it)lt(Qe*=.99,We),Lt();function lt(wt,rt){var $e=Ge.length;Ge.forEach(function(xt){var Qt=xt.length,$t=xt[0].depth;xt.forEach(function(Ue){var He;if((Ue.sourceLinks.length||Ue.targetLinks.length)&&!(Ue.partOfCycle&&L(Ue,rt)>0))if($t==0&&Qt==1)He=Ue.y1-Ue.y0,Ue.y0=ce/2-He/2,Ue.y1=ce/2+He/2;else if($t==$e-1&&Qt==1)He=Ue.y1-Ue.y0,Ue.y0=ce/2-He/2,Ue.y1=ce/2+He/2;else{var Be=m.mean(Ue.sourceLinks,l),Je=m.mean(Ue.targetLinks,d),_e=((Be&&Je?(Be+Je)/2:Be||Je)-n(Ue))*wt;Ue.y0+=_e,Ue.y1+=_e}})})}function Lt(){Ge.forEach(function(wt){var rt,$e,xt,Qt=se,$t=wt.length;for(wt.sort(c),xt=0;xt<$t;++xt)($e=Qt-(rt=wt[xt]).y0)>0&&(rt.y0+=$e,rt.y1+=$e),Qt=rt.y1+ie;if(($e=Qt-ie-ce)>0)for(Qt=rt.y0-=$e,rt.y1-=$e,xt=$t-2;xt>=0;--xt)($e=(rt=wt[xt]).y1+ie-Qt)>0&&(rt.y0-=$e,rt.y1-=$e),Qt=rt.y0})}}function et(Oe){Oe.nodes.forEach(function(je){je.sourceLinks.sort(a),je.targetLinks.sort(o)}),Oe.nodes.forEach(function(je){var We=je.y0,Ge=We,Qe=je.y1,it=Qe;je.sourceLinks.forEach(function(lt){lt.circular?(lt.y0=Qe-lt.width/2,Qe-=lt.width):(lt.y0=We+lt.width/2,We+=lt.width)}),je.targetLinks.forEach(function(lt){lt.circular?(lt.y1=it-lt.width/2,it-=lt.width):(lt.y1=Ge+lt.width/2,Ge+=lt.width)})})}return Me.nodeId=function(Oe){return arguments.length?(ke=typeof Oe=="function"?Oe:i(Oe),Me):ke},Me.nodeAlign=function(Oe){return arguments.length?(Ee=typeof Oe=="function"?Oe:i(Oe),Me):Ee},Me.nodeWidth=function(Oe){return arguments.length?(ve=+Oe,Me):ve},Me.nodePadding=function(Oe){return arguments.length?(ie=+Oe,Me):ie},Me.nodes=function(Oe){return arguments.length?(be=typeof Oe=="function"?Oe:i(Oe),Me):be},Me.links=function(Oe){return arguments.length?(xe=typeof Oe=="function"?Oe:i(Oe),Me):xe},Me.size=function(Oe){return arguments.length?(he=se=0,de=+Oe[0],ce=+Oe[1],Me):[de-he,ce-se]},Me.extent=function(Oe){return arguments.length?(he=+Oe[0][0],de=+Oe[1][0],se=+Oe[0][1],ce=+Oe[1][1],Me):[[he,se],[de,ce]]},Me.iterations=function(Oe){return arguments.length?(ue=+Oe,Me):ue},Me.circularLinkGap=function(Oe){return arguments.length?(me=+Oe,Me):me},Me.nodePaddingRatio=function(Oe){return arguments.length?(ae=+Oe,Me):ae},Me.sortNodes=function(Oe){return arguments.length?(we=Oe,Me):we},Me.update=function(Oe){return S(Oe,ke),et(Oe),Oe.links.forEach(function(je){je.circular&&(je.circularLinkType=je.y0+je.y1<ce?"top":"bottom",je.source.circularLinkType=je.circularLinkType,je.target.circularLinkType=je.circularLinkType)}),B(Oe,ce,ke,!1),q(Oe,ce,ke),M(Oe,me,ce,ke),Oe},Me},t.sankeyCenter=function(ie){return ie.targetLinks.length?ie.depth:ie.sourceLinks.length?m.min(ie.sourceLinks,f)-1:0},t.sankeyLeft=function(ie){return ie.depth},t.sankeyRight=function(ie,ae){return ae-1-ie.height},t.sankeyJustify=u,Object.defineProperty(t,"__esModule",{value:!0})})},{"d3-array":159,"d3-collection":160,"d3-shape":171,"elementary-circuits-directed-graph":185}],57:[function(h,N,H){(function(t,m){typeof H=="object"&&N!==void 0?m(H,h("d3-array"),h("d3-collection"),h("d3-shape")):m(t.d3=t.d3||{},t.d3,t.d3,t.d3)})(this,function(t,m,g,p){function e(T){return T.target.depth}function f(T,A){return T.sourceLinks.length?T.depth:A-1}function u(T){return function(){return T}}function i(T,A){return o(T.source,A.source)||T.index-A.index}function s(T,A){return o(T.target,A.target)||T.index-A.index}function o(T,A){return T.y0-A.y0}function a(T){return T.value}function c(T){return(T.y0+T.y1)/2}function r(T){return c(T.source)*T.value}function n(T){return c(T.target)*T.value}function d(T){return T.index}function l(T){return T.nodes}function y(T){return T.links}function v(T,A){var S=T.get(A);if(!S)throw new Error("missing: "+A);return S}function _(T){return[T.source.x1,T.y0]}function x(T){return[T.target.x0,T.y1]}t.sankey=function(){var T=0,A=0,S=1,w=1,L=24,k=8,C=d,M=f,P=l,O=y,F=32;function j(){var Y={nodes:P.apply(null,arguments),links:O.apply(null,arguments)};return W(Y),Z(Y),Q(Y),X(Y),G(Y),Y}function W(Y){Y.nodes.forEach(function(D,B){D.index=B,D.sourceLinks=[],D.targetLinks=[]});var K=g.map(Y.nodes,C);Y.links.forEach(function(D,B){D.index=B;var q=D.source,ee=D.target;typeof q!="object"&&(q=D.source=v(K,q)),typeof ee!="object"&&(ee=D.target=v(K,ee)),q.sourceLinks.push(D),ee.targetLinks.push(D)})}function Z(Y){Y.nodes.forEach(function(K){K.value=Math.max(m.sum(K.sourceLinks,a),m.sum(K.targetLinks,a))})}function Q(Y){var K,D,B;for(K=Y.nodes,D=[],B=0;K.length;++B,K=D,D=[])K.forEach(function(ee){ee.depth=B,ee.sourceLinks.forEach(function(J){D.indexOf(J.target)<0&&D.push(J.target)})});for(K=Y.nodes,D=[],B=0;K.length;++B,K=D,D=[])K.forEach(function(ee){ee.height=B,ee.targetLinks.forEach(function(J){D.indexOf(J.source)<0&&D.push(J.source)})});var q=(S-T-L)/(B-1);Y.nodes.forEach(function(ee){ee.x1=(ee.x0=T+Math.max(0,Math.min(B-1,Math.floor(M.call(null,ee,B))))*q)+L})}function X(Y){var K=g.nest().key(function($){return $.x0}).sortKeys(m.ascending).entries(Y.nodes).map(function($){return $.values});(function(){var $=m.max(K,function(ae){return ae.length}),te=2/3*(w-A)/($-1);k>te&&(k=te);var ie=m.min(K,function(ae){return(w-A-(ae.length-1)*k)/m.sum(ae,a)});K.forEach(function(ae){ae.forEach(function(he,se){he.y1=(he.y0=se)+he.value*ie})}),Y.links.forEach(function(ae){ae.width=ae.value*ie})})(),J();for(var D=1,B=F;B>0;--B)ee(D*=.99),J(),q(D),J();function q($){K.forEach(function(te){te.forEach(function(ie){if(ie.targetLinks.length){var ae=(m.sum(ie.targetLinks,r)/m.sum(ie.targetLinks,a)-c(ie))*$;ie.y0+=ae,ie.y1+=ae}})})}function ee($){K.slice().reverse().forEach(function(te){te.forEach(function(ie){if(ie.sourceLinks.length){var ae=(m.sum(ie.sourceLinks,n)/m.sum(ie.sourceLinks,a)-c(ie))*$;ie.y0+=ae,ie.y1+=ae}})})}function J(){K.forEach(function($){var te,ie,ae,he=A,se=$.length;for($.sort(o),ae=0;ae<se;++ae)(ie=he-(te=$[ae]).y0)>0&&(te.y0+=ie,te.y1+=ie),he=te.y1+k;if((ie=he-k-w)>0)for(he=te.y0-=ie,te.y1-=ie,ae=se-2;ae>=0;--ae)(ie=(te=$[ae]).y1+k-he)>0&&(te.y0-=ie,te.y1-=ie),he=te.y0})}}function G(Y){Y.nodes.forEach(function(K){K.sourceLinks.sort(s),K.targetLinks.sort(i)}),Y.nodes.forEach(function(K){var D=K.y0,B=D;K.sourceLinks.forEach(function(q){q.y0=D+q.width/2,D+=q.width}),K.targetLinks.forEach(function(q){q.y1=B+q.width/2,B+=q.width})})}return j.update=function(Y){return G(Y),Y},j.nodeId=function(Y){return arguments.length?(C=typeof Y=="function"?Y:u(Y),j):C},j.nodeAlign=function(Y){return arguments.length?(M=typeof Y=="function"?Y:u(Y),j):M},j.nodeWidth=function(Y){return arguments.length?(L=+Y,j):L},j.nodePadding=function(Y){return arguments.length?(k=+Y,j):k},j.nodes=function(Y){return arguments.length?(P=typeof Y=="function"?Y:u(Y),j):P},j.links=function(Y){return arguments.length?(O=typeof Y=="function"?Y:u(Y),j):O},j.size=function(Y){return arguments.length?(T=A=0,S=+Y[0],w=+Y[1],j):[S-T,w-A]},j.extent=function(Y){return arguments.length?(T=+Y[0][0],S=+Y[1][0],A=+Y[0][1],w=+Y[1][1],j):[[T,A],[S,w]]},j.iterations=function(Y){return arguments.length?(F=+Y,j):F},j},t.sankeyCenter=function(T){return T.targetLinks.length?T.depth:T.sourceLinks.length?m.min(T.sourceLinks,e)-1:0},t.sankeyLeft=function(T){return T.depth},t.sankeyRight=function(T,A){return A-1-T.height},t.sankeyJustify=f,t.sankeyLinkHorizontal=function(){return p.linkHorizontal().source(_).target(x)},Object.defineProperty(t,"__esModule",{value:!0})})},{"d3-array":159,"d3-collection":160,"d3-shape":171}],58:[function(h,N,H){(function(){var t={version:"3.8.0"},m=[].slice,g=function(oe){return m.call(oe)},p=self.document;function e(oe){return oe&&(oe.ownerDocument||oe.document||oe).documentElement}function f(oe){return oe&&(oe.ownerDocument&&oe.ownerDocument.defaultView||oe.document&&oe||oe.defaultView)}if(p)try{g(p.documentElement.childNodes)[0].nodeType}catch(oe){g=function(E){for(var z=E.length,R=new Array(z);z--;)R[z]=E[z];return R}}if(Date.now||(Date.now=function(){return+new Date}),p)try{p.createElement("DIV").style.setProperty("opacity",0,"")}catch(oe){var u=this.Element.prototype,i=u.setAttribute,s=u.setAttributeNS,o=this.CSSStyleDeclaration.prototype,a=o.setProperty;u.setAttribute=function(E,z){i.call(this,E,z+"")},u.setAttributeNS=function(E,z,R){s.call(this,E,z,R+"")},o.setProperty=function(E,z,R){a.call(this,E,z+"",R)}}function c(oe,E){return oe<E?-1:oe>E?1:oe>=E?0:NaN}function r(oe){return oe===null?NaN:+oe}function n(oe){return!isNaN(oe)}function d(oe){return{left:function(E,z,R,U){for(arguments.length<3&&(R=0),arguments.length<4&&(U=E.length);R<U;){var ne=R+U>>>1;oe(E[ne],z)<0?R=ne+1:U=ne}return R},right:function(E,z,R,U){for(arguments.length<3&&(R=0),arguments.length<4&&(U=E.length);R<U;){var ne=R+U>>>1;oe(E[ne],z)>0?U=ne:R=ne+1}return R}}}t.ascending=c,t.descending=function(oe,E){return E<oe?-1:E>oe?1:E>=oe?0:NaN},t.min=function(oe,E){var z,R,U=-1,ne=oe.length;if(arguments.length===1){for(;++U<ne;)if((R=oe[U])!=null&&R>=R){z=R;break}for(;++U<ne;)(R=oe[U])!=null&&z>R&&(z=R)}else{for(;++U<ne;)if((R=E.call(oe,oe[U],U))!=null&&R>=R){z=R;break}for(;++U<ne;)(R=E.call(oe,oe[U],U))!=null&&z>R&&(z=R)}return z},t.max=function(oe,E){var z,R,U=-1,ne=oe.length;if(arguments.length===1){for(;++U<ne;)if((R=oe[U])!=null&&R>=R){z=R;break}for(;++U<ne;)(R=oe[U])!=null&&R>z&&(z=R)}else{for(;++U<ne;)if((R=E.call(oe,oe[U],U))!=null&&R>=R){z=R;break}for(;++U<ne;)(R=E.call(oe,oe[U],U))!=null&&R>z&&(z=R)}return z},t.extent=function(oe,E){var z,R,U,ne=-1,le=oe.length;if(arguments.length===1){for(;++ne<le;)if((R=oe[ne])!=null&&R>=R){z=U=R;break}for(;++ne<le;)(R=oe[ne])!=null&&(z>R&&(z=R),U<R&&(U=R))}else{for(;++ne<le;)if((R=E.call(oe,oe[ne],ne))!=null&&R>=R){z=U=R;break}for(;++ne<le;)(R=E.call(oe,oe[ne],ne))!=null&&(z>R&&(z=R),U<R&&(U=R))}return[z,U]},t.sum=function(oe,E){var z,R=0,U=oe.length,ne=-1;if(arguments.length===1)for(;++ne<U;)n(z=+oe[ne])&&(R+=z);else for(;++ne<U;)n(z=+E.call(oe,oe[ne],ne))&&(R+=z);return R},t.mean=function(oe,E){var z,R=0,U=oe.length,ne=-1,le=U;if(arguments.length===1)for(;++ne<U;)n(z=r(oe[ne]))?R+=z:--le;else for(;++ne<U;)n(z=r(E.call(oe,oe[ne],ne)))?R+=z:--le;if(le)return R/le},t.quantile=function(oe,E){var z=(oe.length-1)*E+1,R=Math.floor(z),U=+oe[R-1],ne=z-R;return ne?U+ne*(oe[R]-U):U},t.median=function(oe,E){var z,R=[],U=oe.length,ne=-1;if(arguments.length===1)for(;++ne<U;)n(z=r(oe[ne]))&&R.push(z);else for(;++ne<U;)n(z=r(E.call(oe,oe[ne],ne)))&&R.push(z);if(R.length)return t.quantile(R.sort(c),.5)},t.variance=function(oe,E){var z,R,U=oe.length,ne=0,le=0,pe=-1,ye=0;if(arguments.length===1)for(;++pe<U;)n(z=r(oe[pe]))&&(le+=(R=z-ne)*(z-(ne+=R/++ye)));else for(;++pe<U;)n(z=r(E.call(oe,oe[pe],pe)))&&(le+=(R=z-ne)*(z-(ne+=R/++ye)));if(ye>1)return le/(ye-1)},t.deviation=function(){var oe=t.variance.apply(this,arguments);return oe&&Math.sqrt(oe)};var l=d(c);function y(oe){return oe.length}t.bisectLeft=l.left,t.bisect=t.bisectRight=l.right,t.bisector=function(oe){return d(oe.length===1?function(E,z){return c(oe(E),z)}:oe)},t.shuffle=function(oe,E,z){(ne=arguments.length)<3&&(z=oe.length,ne<2&&(E=0));for(var R,U,ne=z-E;ne;)U=Math.random()*ne--|0,R=oe[ne+E],oe[ne+E]=oe[U+E],oe[U+E]=R;return oe},t.permute=function(oe,E){for(var z=E.length,R=new Array(z);z--;)R[z]=oe[E[z]];return R},t.pairs=function(oe){for(var E=0,z=oe.length-1,R=oe[0],U=new Array(z<0?0:z);E<z;)U[E]=[R,R=oe[++E]];return U},t.transpose=function(oe){if(!(U=oe.length))return[];for(var E=-1,z=t.min(oe,y),R=new Array(z);++E<z;)for(var U,ne=-1,le=R[E]=new Array(U);++ne<U;)le[ne]=oe[ne][E];return R},t.zip=function(){return t.transpose(arguments)},t.keys=function(oe){var E=[];for(var z in oe)E.push(z);return E},t.values=function(oe){var E=[];for(var z in oe)E.push(oe[z]);return E},t.entries=function(oe){var E=[];for(var z in oe)E.push({key:z,value:oe[z]});return E},t.merge=function(oe){for(var E,z,R,U=oe.length,ne=-1,le=0;++ne<U;)le+=oe[ne].length;for(z=new Array(le);--U>=0;)for(E=(R=oe[U]).length;--E>=0;)z[--le]=R[E];return z};var v=Math.abs;function _(oe){for(var E=1;oe*E%1;)E*=10;return E}function x(oe,E){for(var z in E)Object.defineProperty(oe.prototype,z,{value:E[z],enumerable:!1})}function T(){this._=Object.create(null)}t.range=function(oe,E,z){if(arguments.length<3&&(z=1,arguments.length<2&&(E=oe,oe=0)),(E-oe)/z==1/0)throw new Error("infinite range");var R,U=[],ne=_(v(z)),le=-1;if(oe*=ne,E*=ne,(z*=ne)<0)for(;(R=oe+z*++le)>E;)U.push(R/ne);else for(;(R=oe+z*++le)<E;)U.push(R/ne);return U},t.map=function(oe,E){var z=new T;if(oe instanceof T)oe.forEach(function(pe,ye){z.set(pe,ye)});else if(Array.isArray(oe)){var R,U=-1,ne=oe.length;if(arguments.length===1)for(;++U<ne;)z.set(U,oe[U]);else for(;++U<ne;)z.set(E.call(oe,R=oe[U],U),R)}else for(var le in oe)z.set(le,oe[le]);return z};function A(oe){return(oe+="")=="__proto__"||oe[0]==="\0"?"\0"+oe:oe}function S(oe){return(oe+="")[0]==="\0"?oe.slice(1):oe}function w(oe){return A(oe)in this._}function L(oe){return(oe=A(oe))in this._&&delete this._[oe]}function k(){var oe=[];for(var E in this._)oe.push(S(E));return oe}function C(){var oe=0;for(var E in this._)++oe;return oe}function M(){for(var oe in this._)return!1;return!0}function P(){this._=Object.create(null)}function O(oe){return oe}function F(oe,E,z){return function(){var R=z.apply(E,arguments);return R===E?oe:R}}function j(oe,E){if(E in oe)return E;E=E.charAt(0).toUpperCase()+E.slice(1);for(var z=0,R=W.length;z<R;++z){var U=W[z]+E;if(U in oe)return U}}x(T,{has:w,get:function(oe){return this._[A(oe)]},set:function(oe,E){return this._[A(oe)]=E},remove:L,keys:k,values:function(){var oe=[];for(var E in this._)oe.push(this._[E]);return oe},entries:function(){var oe=[];for(var E in this._)oe.push({key:S(E),value:this._[E]});return oe},size:C,empty:M,forEach:function(oe){for(var E in this._)oe.call(this,S(E),this._[E])}}),t.nest=function(){var oe,E,z={},R=[],U=[];function ne(le,pe,ye){if(ye>=R.length)return E?E.call(z,pe):oe?pe.sort(oe):pe;for(var Te,Ne,qe,tt,yt=-1,St=pe.length,_t=R[ye++],Tt=new T;++yt<St;)(tt=Tt.get(Te=_t(Ne=pe[yt])))?tt.push(Ne):Tt.set(Te,[Ne]);return le?(Ne=le(),qe=function(gt,Dt){Ne.set(gt,ne(le,Dt,ye))}):(Ne={},qe=function(gt,Dt){Ne[gt]=ne(le,Dt,ye)}),Tt.forEach(qe),Ne}return z.map=function(le,pe){return ne(pe,le,0)},z.entries=function(le){return function pe(ye,Te){if(Te>=R.length)return ye;var Ne=[],qe=U[Te++];return ye.forEach(function(tt,yt){Ne.push({key:tt,values:pe(yt,Te)})}),qe?Ne.sort(function(tt,yt){return qe(tt.key,yt.key)}):Ne}(ne(t.map,le,0),0)},z.key=function(le){return R.push(le),z},z.sortKeys=function(le){return U[R.length-1]=le,z},z.sortValues=function(le){return oe=le,z},z.rollup=function(le){return E=le,z},z},t.set=function(oe){var E=new P;if(oe)for(var z=0,R=oe.length;z<R;++z)E.add(oe[z]);return E},x(P,{has:w,add:function(oe){return this._[A(oe+="")]=!0,oe},remove:L,values:k,size:C,empty:M,forEach:function(oe){for(var E in this._)oe.call(this,S(E))}}),t.behavior={},t.rebind=function(oe,E){for(var z,R=1,U=arguments.length;++R<U;)oe[z=arguments[R]]=F(oe,E,E[z]);return oe};var W=["webkit","ms","moz","Moz","o","O"];function Z(){}function Q(){}function X(oe){var E=[],z=new T;function R(){for(var U,ne=E,le=-1,pe=ne.length;++le<pe;)(U=ne[le].on)&&U.apply(this,arguments);return oe}return R.on=function(U,ne){var le,pe=z.get(U);return arguments.length<2?pe&&pe.on:(pe&&(pe.on=null,E=E.slice(0,le=E.indexOf(pe)).concat(E.slice(le+1)),z.remove(U)),ne&&E.push(z.set(U,{on:ne})),oe)},R}function G(){t.event.preventDefault()}function Y(){for(var oe,E=t.event;oe=E.sourceEvent;)E=oe;return E}function K(oe){for(var E=new Q,z=0,R=arguments.length;++z<R;)E[arguments[z]]=X(E);return E.of=function(U,ne){return function(le){try{var pe=le.sourceEvent=t.event;le.target=oe,t.event=le,E[le.type].apply(U,ne)}finally{t.event=pe}}},E}t.dispatch=function(){for(var oe=new Q,E=-1,z=arguments.length;++E<z;)oe[arguments[E]]=X(oe);return oe},Q.prototype.on=function(oe,E){var z=oe.indexOf("."),R="";if(z>=0&&(R=oe.slice(z+1),oe=oe.slice(0,z)),oe)return arguments.length<2?this[oe].on(R):this[oe].on(R,E);if(arguments.length===2){if(E==null)for(oe in this)this.hasOwnProperty(oe)&&this[oe].on(R,null);return this}},t.event=null,t.requote=function(oe){return oe.replace(D,"\\$&")};var D=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,B=function(oe,E){for(var z in E)oe[z]=E[z]};function q(oe){return B(oe,te),oe}var ee=function(oe,E){return E.querySelector(oe)},J=function(oe,E){return E.querySelectorAll(oe)},$=function(oe,E){var z=oe.matches||oe[j(oe,"matchesSelector")];return($=function(R,U){return z.call(R,U)})(oe,E)};typeof Sizzle=="function"&&(ee=function(oe,E){return Sizzle(oe,E)[0]||null},J=Sizzle,$=Sizzle.matchesSelector),t.selection=function(){return t.select(p.documentElement)};var te=t.selection.prototype=[];function ie(oe){return typeof oe=="function"?oe:function(){return ee(oe,this)}}function ae(oe){return typeof oe=="function"?oe:function(){return J(oe,this)}}te.select=function(oe){var E,z,R,U,ne=[];oe=ie(oe);for(var le=-1,pe=this.length;++le<pe;){ne.push(E=[]),E.parentNode=(R=this[le]).parentNode;for(var ye=-1,Te=R.length;++ye<Te;)(U=R[ye])?(E.push(z=oe.call(U,U.__data__,ye,le)),z&&"__data__"in U&&(z.__data__=U.__data__)):E.push(null)}return q(ne)},te.selectAll=function(oe){var E,z,R=[];oe=ae(oe);for(var U=-1,ne=this.length;++U<ne;)for(var le=this[U],pe=-1,ye=le.length;++pe<ye;)(z=le[pe])&&(R.push(E=g(oe.call(z,z.__data__,pe,U))),E.parentNode=z);return q(R)};var he="http://www.w3.org/1999/xhtml",se={svg:"http://www.w3.org/2000/svg",xhtml:he,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function de(oe,E){return oe=t.ns.qualify(oe),E==null?oe.local?function(){this.removeAttributeNS(oe.space,oe.local)}:function(){this.removeAttribute(oe)}:typeof E=="function"?oe.local?function(){var z=E.apply(this,arguments);z==null?this.removeAttributeNS(oe.space,oe.local):this.setAttributeNS(oe.space,oe.local,z)}:function(){var z=E.apply(this,arguments);z==null?this.removeAttribute(oe):this.setAttribute(oe,z)}:oe.local?function(){this.setAttributeNS(oe.space,oe.local,E)}:function(){this.setAttribute(oe,E)}}function ce(oe){return oe.trim().replace(/\s+/g," ")}function ve(oe){return new RegExp("(?:^|\\s+)"+t.requote(oe)+"(?:\\s+|$)","g")}function ke(oe){return(oe+"").trim().split(/^|\s+/)}function Ee(oe,E){var z=(oe=ke(oe).map(be)).length;return typeof E=="function"?function(){for(var R=-1,U=E.apply(this,arguments);++R<z;)oe[R](this,U)}:function(){for(var R=-1;++R<z;)oe[R](this,E)}}function be(oe){var E=ve(oe);return function(z,R){if(U=z.classList)return R?U.add(oe):U.remove(oe);var U=z.getAttribute("class")||"";R?(E.lastIndex=0,E.test(U)||z.setAttribute("class",ce(U+" "+oe))):z.setAttribute("class",ce(U.replace(E," ")))}}function xe(oe,E,z){return E==null?function(){this.style.removeProperty(oe)}:typeof E=="function"?function(){var R=E.apply(this,arguments);R==null?this.style.removeProperty(oe):this.style.setProperty(oe,R,z)}:function(){this.style.setProperty(oe,E,z)}}function ue(oe,E){return E==null?function(){delete this[oe]}:typeof E=="function"?function(){var z=E.apply(this,arguments);z==null?delete this[oe]:this[oe]=z}:function(){this[oe]=E}}function me(oe){return typeof oe=="function"?oe:(oe=t.ns.qualify(oe)).local?function(){return this.ownerDocument.createElementNS(oe.space,oe.local)}:function(){var E=this.ownerDocument,z=this.namespaceURI;return z===he&&E.documentElement.namespaceURI===he?E.createElement(oe):E.createElementNS(z,oe)}}function we(){var oe=this.parentNode;oe&&oe.removeChild(this)}function Me(oe){return{__data__:oe}}function Se(oe){return function(){return $(this,oe)}}function De(oe){return arguments.length||(oe=c),function(E,z){return E&&z?oe(E.__data__,z.__data__):!E-!z}}function Fe(oe,E){for(var z=0,R=oe.length;z<R;z++)for(var U,ne=oe[z],le=0,pe=ne.length;le<pe;le++)(U=ne[le])&&E(U,le,z);return oe}function Ye(oe){return B(oe,et),oe}t.ns={prefix:se,qualify:function(oe){var E=oe.indexOf(":"),z=oe;return E>=0&&(z=oe.slice(0,E))!=="xmlns"&&(oe=oe.slice(E+1)),se.hasOwnProperty(z)?{space:se[z],local:oe}:oe}},te.attr=function(oe,E){if(arguments.length<2){if(typeof oe=="string"){var z=this.node();return(oe=t.ns.qualify(oe)).local?z.getAttributeNS(oe.space,oe.local):z.getAttribute(oe)}for(E in oe)this.each(de(E,oe[E]));return this}return this.each(de(oe,E))},te.classed=function(oe,E){if(arguments.length<2){if(typeof oe=="string"){var z=this.node(),R=(oe=ke(oe)).length,U=-1;if(E=z.classList){for(;++U<R;)if(!E.contains(oe[U]))return!1}else for(E=z.getAttribute("class");++U<R;)if(!ve(oe[U]).test(E))return!1;return!0}for(E in oe)this.each(Ee(E,oe[E]));return this}return this.each(Ee(oe,E))},te.style=function(oe,E,z){var R=arguments.length;if(R<3){if(typeof oe!="string"){for(z in R<2&&(E=""),oe)this.each(xe(z,oe[z],E));return this}if(R<2){var U=this.node();return f(U).getComputedStyle(U,null).getPropertyValue(oe)}z=""}return this.each(xe(oe,E,z))},te.property=function(oe,E){if(arguments.length<2){if(typeof oe=="string")return this.node()[oe];for(E in oe)this.each(ue(E,oe[E]));return this}return this.each(ue(oe,E))},te.text=function(oe){return arguments.length?this.each(typeof oe=="function"?function(){var E=oe.apply(this,arguments);this.textContent=E==null?"":E}:oe==null?function(){this.textContent=""}:function(){this.textContent=oe}):this.node().textContent},te.html=function(oe){return arguments.length?this.each(typeof oe=="function"?function(){var E=oe.apply(this,arguments);this.innerHTML=E==null?"":E}:oe==null?function(){this.innerHTML=""}:function(){this.innerHTML=oe}):this.node().innerHTML},te.append=function(oe){return oe=me(oe),this.select(function(){return this.appendChild(oe.apply(this,arguments))})},te.insert=function(oe,E){return oe=me(oe),E=ie(E),this.select(function(){return this.insertBefore(oe.apply(this,arguments),E.apply(this,arguments)||null)})},te.remove=function(){return this.each(we)},te.data=function(oe,E){var z,R,U=-1,ne=this.length;if(!arguments.length){for(oe=new Array(ne=(z=this[0]).length);++U<ne;)(R=z[U])&&(oe[U]=R.__data__);return oe}function le(Ne,qe){var tt,yt,St,_t=Ne.length,Tt=qe.length,gt=Math.min(_t,Tt),Dt=new Array(Tt),Ot=new Array(Tt),Bt=new Array(_t);if(E){var er,ur=new T,Tr=new Array(_t);for(tt=-1;++tt<_t;)(yt=Ne[tt])&&(ur.has(er=E.call(yt,yt.__data__,tt))?Bt[tt]=yt:ur.set(er,yt),Tr[tt]=er);for(tt=-1;++tt<Tt;)(yt=ur.get(er=E.call(qe,St=qe[tt],tt)))?yt!==!0&&(Dt[tt]=yt,yt.__data__=St):Ot[tt]=Me(St),ur.set(er,!0);for(tt=-1;++tt<_t;)tt in Tr&&ur.get(Tr[tt])!==!0&&(Bt[tt]=Ne[tt])}else{for(tt=-1;++tt<gt;)yt=Ne[tt],St=qe[tt],yt?(yt.__data__=St,Dt[tt]=yt):Ot[tt]=Me(St);for(;tt<Tt;++tt)Ot[tt]=Me(qe[tt]);for(;tt<_t;++tt)Bt[tt]=Ne[tt]}Ot.update=Dt,Ot.parentNode=Dt.parentNode=Bt.parentNode=Ne.parentNode,pe.push(Ot),ye.push(Dt),Te.push(Bt)}var pe=Ye([]),ye=q([]),Te=q([]);if(typeof oe=="function")for(;++U<ne;)le(z=this[U],oe.call(z,z.parentNode.__data__,U));else for(;++U<ne;)le(z=this[U],oe);return ye.enter=function(){return pe},ye.exit=function(){return Te},ye},te.datum=function(oe){return arguments.length?this.property("__data__",oe):this.property("__data__")},te.filter=function(oe){var E,z,R,U=[];typeof oe!="function"&&(oe=Se(oe));for(var ne=0,le=this.length;ne<le;ne++){U.push(E=[]),E.parentNode=(z=this[ne]).parentNode;for(var pe=0,ye=z.length;pe<ye;pe++)(R=z[pe])&&oe.call(R,R.__data__,pe,ne)&&E.push(R)}return q(U)},te.order=function(){for(var oe=-1,E=this.length;++oe<E;)for(var z,R=this[oe],U=R.length-1,ne=R[U];--U>=0;)(z=R[U])&&(ne&&ne!==z.nextSibling&&ne.parentNode.insertBefore(z,ne),ne=z);return this},te.sort=function(oe){oe=De.apply(this,arguments);for(var E=-1,z=this.length;++E<z;)this[E].sort(oe);return this.order()},te.each=function(oe){return Fe(this,function(E,z,R){oe.call(E,E.__data__,z,R)})},te.call=function(oe){var E=g(arguments);return oe.apply(E[0]=this,E),this},te.empty=function(){return!this.node()},te.node=function(){for(var oe=0,E=this.length;oe<E;oe++)for(var z=this[oe],R=0,U=z.length;R<U;R++){var ne=z[R];if(ne)return ne}return null},te.size=function(){var oe=0;return Fe(this,function(){++oe}),oe};var et=[];function Oe(oe){var E,z;return function(R,U,ne){var le,pe=oe[ne].update,ye=pe.length;for(ne!=z&&(z=ne,E=0),U>=E&&(E=U+1);!(le=pe[E])&&++E<ye;);return le}}function je(oe,E,z){var R="__on"+oe,U=oe.indexOf("."),ne=Ge;U>0&&(oe=oe.slice(0,U));var le=We.get(oe);function pe(){var ye=this[R];ye&&(this.removeEventListener(oe,ye,ye.$),delete this[R])}return le&&(oe=le,ne=Qe),U?E?function(){var ye=ne(E,g(arguments));pe.call(this),this.addEventListener(oe,this[R]=ye,ye.$=z),ye._=E}:pe:E?Z:function(){var ye,Te=new RegExp("^__on([^.]+)"+t.requote(oe)+"$");for(var Ne in this)if(ye=Ne.match(Te)){var qe=this[Ne];this.removeEventListener(ye[1],qe,qe.$),delete this[Ne]}}}t.selection.enter=Ye,t.selection.enter.prototype=et,et.append=te.append,et.empty=te.empty,et.node=te.node,et.call=te.call,et.size=te.size,et.select=function(oe){for(var E,z,R,U,ne,le=[],pe=-1,ye=this.length;++pe<ye;){R=(U=this[pe]).update,le.push(E=[]),E.parentNode=U.parentNode;for(var Te=-1,Ne=U.length;++Te<Ne;)(ne=U[Te])?(E.push(R[Te]=z=oe.call(U.parentNode,ne.__data__,Te,pe)),z.__data__=ne.__data__):E.push(null)}return q(le)},et.insert=function(oe,E){return arguments.length<2&&(E=Oe(this)),te.insert.call(this,oe,E)},t.select=function(oe){var E;return typeof oe=="string"?(E=[ee(oe,p)]).parentNode=p.documentElement:(E=[oe]).parentNode=e(oe),q([E])},t.selectAll=function(oe){var E;return typeof oe=="string"?(E=g(J(oe,p))).parentNode=p.documentElement:(E=g(oe)).parentNode=null,q([E])},te.on=function(oe,E,z){var R=arguments.length;if(R<3){if(typeof oe!="string"){for(z in R<2&&(E=!1),oe)this.each(je(z,oe[z],E));return this}if(R<2)return(R=this.node()["__on"+oe])&&R._;z=!1}return this.each(je(oe,E,z))};var We=t.map({mouseenter:"mouseover",mouseleave:"mouseout"});function Ge(oe,E){return function(z){var R=t.event;t.event=z,E[0]=this.__data__;try{oe.apply(this,E)}finally{t.event=R}}}function Qe(oe,E){var z=Ge(oe,E);return function(R){var U=R.relatedTarget;U&&(U===this||8&U.compareDocumentPosition(this))||z.call(this,R)}}p&&We.forEach(function(oe){"on"+oe in p&&We.remove(oe)});var it,lt=0;function Lt(oe){var E=".dragsuppress-"+ ++lt,z="click"+E,R=t.select(f(oe)).on("touchmove"+E,G).on("dragstart"+E,G).on("selectstart"+E,G);if(it==null&&(it=!("onselectstart"in oe)&&j(oe.style,"userSelect")),it){var U=e(oe).style,ne=U[it];U[it]="none"}return function(le){if(R.on(E,null),it&&(U[it]=ne),le){var pe=function(){R.on(z,null)};R.on(z,function(){G(),pe()},!0),setTimeout(pe,0)}}}t.mouse=function(oe){return rt(oe,Y())};var wt=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;function rt(oe,E){E.changedTouches&&(E=E.changedTouches[0]);var z=oe.ownerSVGElement||oe;if(z.createSVGPoint){var R=z.createSVGPoint();if(wt<0){var U=f(oe);if(U.scrollX||U.scrollY){var ne=(z=t.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important"))[0][0].getScreenCTM();wt=!(ne.f||ne.e),z.remove()}}return wt?(R.x=E.pageX,R.y=E.pageY):(R.x=E.clientX,R.y=E.clientY),[(R=R.matrixTransform(oe.getScreenCTM().inverse())).x,R.y]}var le=oe.getBoundingClientRect();return[E.clientX-le.left-oe.clientLeft,E.clientY-le.top-oe.clientTop]}function $e(){return t.event.changedTouches[0].identifier}t.touch=function(oe,E,z){if(arguments.length<3&&(z=E,E=Y().changedTouches),E){for(var R,U=0,ne=E.length;U<ne;++U)if((R=E[U]).identifier===z)return rt(oe,R)}},t.behavior.drag=function(){var oe=K(U,"drag","dragstart","dragend"),E=null,z=ne(Z,t.mouse,f,"mousemove","mouseup"),R=ne($e,t.touch,O,"touchmove","touchend");function U(){this.on("mousedown.drag",z).on("touchstart.drag",R)}function ne(le,pe,ye,Te,Ne){return function(){var qe,tt=this,yt=t.event.target.correspondingElement||t.event.target,St=tt.parentNode,_t=oe.of(tt,arguments),Tt=0,gt=le(),Dt=".drag"+(gt==null?"":"-"+gt),Ot=t.select(ye(yt)).on(Te+Dt,ur).on(Ne+Dt,Tr),Bt=Lt(yt),er=pe(St,gt);function ur(){var wr,Xr,Wr=pe(St,gt);Wr&&(wr=Wr[0]-er[0],Xr=Wr[1]-er[1],Tt|=wr|Xr,er=Wr,_t({type:"drag",x:Wr[0]+qe[0],y:Wr[1]+qe[1],dx:wr,dy:Xr}))}function Tr(){pe(St,gt)&&(Ot.on(Te+Dt,null).on(Ne+Dt,null),Bt(Tt),_t({type:"dragend"}))}qe=E?[(qe=E.apply(tt,arguments)).x-er[0],qe.y-er[1]]:[0,0],_t({type:"dragstart"})}}return U.origin=function(le){return arguments.length?(E=le,U):E},t.rebind(U,oe,"on")},t.touches=function(oe,E){return arguments.length<2&&(E=Y().touches),E?g(E).map(function(z){var R=rt(oe,z);return R.identifier=z.identifier,R}):[]};var xt=1e-6,Qt=Math.PI,$t=2*Qt,Ue=$t-xt,He=Qt/2,Be=Qt/180,Je=180/Qt;function _e(oe){return oe>1?He:oe<-1?-He:Math.asin(oe)}function Le(oe){return((oe=Math.exp(oe))+1/oe)/2}var Ce=Math.SQRT2;t.interpolateZoom=function(oe,E){var z,R,U=oe[0],ne=oe[1],le=oe[2],pe=E[0],ye=E[1],Te=E[2],Ne=pe-U,qe=ye-ne,tt=Ne*Ne+qe*qe;if(tt<1e-12)R=Math.log(Te/le)/Ce,z=function(Dt){return[U+Dt*Ne,ne+Dt*qe,le*Math.exp(Ce*Dt*R)]};else{var yt=Math.sqrt(tt),St=(Te*Te-le*le+4*tt)/(2*le*2*yt),_t=(Te*Te-le*le-4*tt)/(2*Te*2*yt),Tt=Math.log(Math.sqrt(St*St+1)-St),gt=Math.log(Math.sqrt(_t*_t+1)-_t);R=(gt-Tt)/Ce,z=function(Dt){var Ot,Bt=Dt*R,er=Le(Tt),ur=le/(2*yt)*(er*(Ot=Ce*Bt+Tt,((Ot=Math.exp(2*Ot))-1)/(Ot+1))-function(Tr){return((Tr=Math.exp(Tr))-1/Tr)/2}(Tt));return[U+ur*Ne,ne+ur*qe,le*er/Le(Ce*Bt+Tt)]}}return z.duration=1e3*R,z},t.behavior.zoom=function(){var oe,E,z,R,U,ne,le,pe,ye,Te={x:0,y:0,k:1},Ne=[960,500],qe=ut,tt=250,yt=0,St="mousedown.zoom",_t="mousemove.zoom",Tt="mouseup.zoom",gt="touchstart.zoom",Dt=K(Ot,"zoomstart","zoom","zoomend");function Ot(Nr){Nr.on(St,an).on(Xe+".zoom",Yn).on("dblclick.zoom",sa).on(gt,Nn)}function Bt(Nr){return[(Nr[0]-Te.x)/Te.k,(Nr[1]-Te.y)/Te.k]}function er(Nr){Te.k=Math.max(qe[0],Math.min(qe[1],Nr))}function ur(Nr,wn){wn=function(Wn){return[Wn[0]*Te.k+Te.x,Wn[1]*Te.k+Te.y]}(wn),Te.x+=Nr[0]-wn[0],Te.y+=Nr[1]-wn[1]}function Tr(Nr,wn,Wn,Vn){Nr.__chart__={x:Te.x,y:Te.y,k:Te.k},er(Math.pow(2,Vn)),ur(E=wn,Wn),Nr=t.select(Nr),tt>0&&(Nr=Nr.transition().duration(tt)),Nr.call(Ot.event)}function wr(){le&&le.domain(ne.range().map(function(Nr){return(Nr-Te.x)/Te.k}).map(ne.invert)),ye&&ye.domain(pe.range().map(function(Nr){return(Nr-Te.y)/Te.k}).map(pe.invert))}function Xr(Nr){yt++||Nr({type:"zoomstart"})}function Wr(Nr){wr(),Nr({type:"zoom",scale:Te.k,translate:[Te.x,Te.y]})}function un(Nr){--yt||(Nr({type:"zoomend"}),E=null)}function an(){var Nr=this,wn=Dt.of(Nr,arguments),Wn=0,Vn=t.select(f(Nr)).on(_t,Ta).on(Tt,Zn),$n=Bt(t.mouse(Nr)),ca=Lt(Nr);function Ta(){Wn=1,ur(t.mouse(Nr),$n),Wr(wn)}function Zn(){Vn.on(_t,null).on(Tt,null),ca(Wn),un(wn)}Ms.call(Nr),Xr(wn)}function Nn(){var Nr,wn=this,Wn=Dt.of(wn,arguments),Vn={},$n=0,ca=".zoom-"+t.event.changedTouches[0].identifier,Ta="touchmove"+ca,Zn="touchend"+ca,va=[],da=t.select(wn),Sa=Lt(wn);function ya(){var Li=t.touches(wn);return Nr=Te.k,Li.forEach(function(Ci){Ci.identifier in Vn&&(Vn[Ci.identifier]=Bt(Ci))}),Li}function Ea(){var Li=t.event.target;t.select(Li).on(Ta,Ba).on(Zn,li),va.push(Li);for(var Ci=t.event.changedTouches,si=0,wi=Ci.length;si<wi;++si)Vn[Ci[si].identifier]=null;var pi=ya(),go=Date.now();if(pi.length===1){if(go-U<500){var Vi=pi[0];Tr(wn,Vi,Vn[Vi.identifier],Math.floor(Math.log(Te.k)/Math.LN2)+1),G()}U=go}else if(pi.length>1){Vi=pi[0];var Oo=pi[1],_s=Vi[0]-Oo[0],Us=Vi[1]-Oo[1];$n=_s*_s+Us*Us}}function Ba(){var Li,Ci,si,wi,pi=t.touches(wn);Ms.call(wn);for(var go=0,Vi=pi.length;go<Vi;++go,wi=null)if(si=pi[go],wi=Vn[si.identifier]){if(Ci)break;Li=si,Ci=wi}if(wi){var Oo=(Oo=si[0]-Li[0])*Oo+(Oo=si[1]-Li[1])*Oo,_s=$n&&Math.sqrt(Oo/$n);Li=[(Li[0]+si[0])/2,(Li[1]+si[1])/2],Ci=[(Ci[0]+wi[0])/2,(Ci[1]+wi[1])/2],er(_s*Nr)}U=null,ur(Li,Ci),Wr(Wn)}function li(){if(t.event.touches.length){for(var Li=t.event.changedTouches,Ci=0,si=Li.length;Ci<si;++Ci)delete Vn[Li[Ci].identifier];for(var wi in Vn)return void ya()}t.selectAll(va).on(ca,null),da.on(St,an).on(gt,Nn),Sa(),un(Wn)}Ea(),Xr(Wn),da.on(St,null).on(gt,Ea)}function Yn(){var Nr=Dt.of(this,arguments);R?clearTimeout(R):(Ms.call(this),oe=Bt(E=z||t.mouse(this)),Xr(Nr)),R=setTimeout(function(){R=null,un(Nr)},50),G(),er(Math.pow(2,.002*Pe())*Te.k),ur(E,oe),Wr(Nr)}function sa(){var Nr=t.mouse(this),wn=Math.log(Te.k)/Math.LN2;Tr(this,Nr,Bt(Nr),t.event.shiftKey?Math.ceil(wn)-1:Math.floor(wn)+1)}return Xe||(Xe="onwheel"in p?(Pe=function(){return-t.event.deltaY*(t.event.deltaMode?120:1)},"wheel"):"onmousewheel"in p?(Pe=function(){return t.event.wheelDelta},"mousewheel"):(Pe=function(){return-t.event.detail},"MozMousePixelScroll")),Ot.event=function(Nr){Nr.each(function(){var wn=Dt.of(this,arguments),Wn=Te;ms?t.select(this).transition().each("start.zoom",function(){Te=this.__chart__||{x:0,y:0,k:1},Xr(wn)}).tween("zoom:zoom",function(){var Vn=Ne[0],$n=Ne[1],ca=E?E[0]:Vn/2,Ta=E?E[1]:$n/2,Zn=t.interpolateZoom([(ca-Te.x)/Te.k,(Ta-Te.y)/Te.k,Vn/Te.k],[(ca-Wn.x)/Wn.k,(Ta-Wn.y)/Wn.k,Vn/Wn.k]);return function(va){var da=Zn(va),Sa=Vn/da[2];this.__chart__=Te={x:ca-da[0]*Sa,y:Ta-da[1]*Sa,k:Sa},Wr(wn)}}).each("interrupt.zoom",function(){un(wn)}).each("end.zoom",function(){un(wn)}):(this.__chart__=Te,Xr(wn),Wr(wn),un(wn))})},Ot.translate=function(Nr){return arguments.length?(Te={x:+Nr[0],y:+Nr[1],k:Te.k},wr(),Ot):[Te.x,Te.y]},Ot.scale=function(Nr){return arguments.length?(Te={x:Te.x,y:Te.y,k:null},er(+Nr),wr(),Ot):Te.k},Ot.scaleExtent=function(Nr){return arguments.length?(qe=Nr==null?ut:[+Nr[0],+Nr[1]],Ot):qe},Ot.center=function(Nr){return arguments.length?(z=Nr&&[+Nr[0],+Nr[1]],Ot):z},Ot.size=function(Nr){return arguments.length?(Ne=Nr&&[+Nr[0],+Nr[1]],Ot):Ne},Ot.duration=function(Nr){return arguments.length?(tt=+Nr,Ot):tt},Ot.x=function(Nr){return arguments.length?(le=Nr,ne=Nr.copy(),Te={x:0,y:0,k:1},Ot):le},Ot.y=function(Nr){return arguments.length?(ye=Nr,pe=Nr.copy(),Te={x:0,y:0,k:1},Ot):ye},t.rebind(Ot,Dt,"on")};var Pe,Xe,ut=[0,1/0];function kt(){}function ft(oe,E,z){return this instanceof ft?(this.h=+oe,this.s=+E,void(this.l=+z)):arguments.length<2?oe instanceof ft?new ft(oe.h,oe.s,oe.l):hr(""+oe,mr,ft):new ft(oe,E,z)}t.color=kt,kt.prototype.toString=function(){return this.rgb()+""},t.hsl=ft;var Et=ft.prototype=new kt;function mt(oe,E,z){var R,U;function ne(le){return Math.round(255*function(pe){return pe>360?pe-=360:pe<0&&(pe+=360),pe<60?R+(U-R)*pe/60:pe<180?U:pe<240?R+(U-R)*(240-pe)/60:R}(le))}return oe=isNaN(oe)?0:(oe%=360)<0?oe+360:oe,E=isNaN(E)||E<0?0:E>1?1:E,R=2*(z=z<0?0:z>1?1:z)-(U=z<=.5?z*(1+E):z+E-z*E),new Vt(ne(oe+120),ne(oe),ne(oe-120))}function It(oe,E,z){return this instanceof It?(this.h=+oe,this.c=+E,void(this.l=+z)):arguments.length<2?oe instanceof It?new It(oe.h,oe.c,oe.l):Ie(oe instanceof At?oe.l:(oe=sr((oe=t.rgb(oe)).r,oe.g,oe.b)).l,oe.a,oe.b):new It(oe,E,z)}Et.brighter=function(oe){return oe=Math.pow(.7,arguments.length?oe:1),new ft(this.h,this.s,this.l/oe)},Et.darker=function(oe){return oe=Math.pow(.7,arguments.length?oe:1),new ft(this.h,this.s,oe*this.l)},Et.rgb=function(){return mt(this.h,this.s,this.l)},t.hcl=It;var vt=It.prototype=new kt;function nt(oe,E,z){return isNaN(oe)&&(oe=0),isNaN(E)&&(E=0),new At(z,Math.cos(oe*=Be)*E,Math.sin(oe)*E)}function At(oe,E,z){return this instanceof At?(this.l=+oe,this.a=+E,void(this.b=+z)):arguments.length<2?oe instanceof At?new At(oe.l,oe.a,oe.b):oe instanceof It?nt(oe.h,oe.c,oe.l):sr((oe=Vt(oe)).r,oe.g,oe.b):new At(oe,E,z)}vt.brighter=function(oe){return new It(this.h,this.c,Math.min(100,this.l+Ft*(arguments.length?oe:1)))},vt.darker=function(oe){return new It(this.h,this.c,Math.max(0,this.l-Ft*(arguments.length?oe:1)))},vt.rgb=function(){return nt(this.h,this.c,this.l).rgb()},t.lab=At;var Ft=18,Nt=At.prototype=new kt;function Kt(oe,E,z){var R=(oe+16)/116,U=R+E/500,ne=R-z/200;return new Vt(Pt(3.2404542*(U=.95047*ot(U))-1.5371385*(R=1*ot(R))-.4985314*(ne=1.08883*ot(ne))),Pt(-.969266*U+1.8760108*R+.041556*ne),Pt(.0556434*U-.2040259*R+1.0572252*ne))}function Ie(oe,E,z){return oe>0?new It(Math.atan2(z,E)*Je,Math.sqrt(E*E+z*z),oe):new It(NaN,NaN,oe)}function ot(oe){return oe>.206893034?oe*oe*oe:(oe-4/29)/7.787037}function bt(oe){return oe>.008856?Math.pow(oe,1/3):7.787037*oe+4/29}function Pt(oe){return Math.round(255*(oe<=.00304?12.92*oe:1.055*Math.pow(oe,1/2.4)-.055))}function Vt(oe,E,z){return this instanceof Vt?(this.r=~~oe,this.g=~~E,void(this.b=~~z)):arguments.length<2?oe instanceof Vt?new Vt(oe.r,oe.g,oe.b):hr(""+oe,Vt,mt):new Vt(oe,E,z)}function nr(oe){return new Vt(oe>>16,oe>>8&255,255&oe)}function Yt(oe){return nr(oe)+""}Nt.brighter=function(oe){return new At(Math.min(100,this.l+Ft*(arguments.length?oe:1)),this.a,this.b)},Nt.darker=function(oe){return new At(Math.max(0,this.l-Ft*(arguments.length?oe:1)),this.a,this.b)},Nt.rgb=function(){return Kt(this.l,this.a,this.b)},t.rgb=Vt;var Xt=Vt.prototype=new kt;function ar(oe){return oe<16?"0"+Math.max(0,oe).toString(16):Math.min(255,oe).toString(16)}function hr(oe,E,z){var R,U,ne,le=0,pe=0,ye=0;if(R=/([a-z]+)\((.*)\)/.exec(oe=oe.toLowerCase()))switch(U=R[2].split(","),R[1]){case"hsl":return z(parseFloat(U[0]),parseFloat(U[1])/100,parseFloat(U[2])/100);case"rgb":return E(yr(U[0]),yr(U[1]),yr(U[2]))}return(ne=zr.get(oe))?E(ne.r,ne.g,ne.b):(oe==null||oe.charAt(0)!=="#"||isNaN(ne=parseInt(oe.slice(1),16))||(oe.length===4?(le=(3840&ne)>>4,le|=le>>4,pe=240&ne,pe|=pe>>4,ye=15&ne,ye|=ye<<4):oe.length===7&&(le=(16711680&ne)>>16,pe=(65280&ne)>>8,ye=255&ne)),E(le,pe,ye))}function mr(oe,E,z){var R,U,ne=Math.min(oe/=255,E/=255,z/=255),le=Math.max(oe,E,z),pe=le-ne,ye=(le+ne)/2;return pe?(U=ye<.5?pe/(le+ne):pe/(2-le-ne),R=oe==le?(E-z)/pe+(E<z?6:0):E==le?(z-oe)/pe+2:(oe-E)/pe+4,R*=60):(R=NaN,U=ye>0&&ye<1?0:R),new ft(R,U,ye)}function sr(oe,E,z){var R=bt((.4124564*(oe=fr(oe))+.3575761*(E=fr(E))+.1804375*(z=fr(z)))/.95047),U=bt((.2126729*oe+.7151522*E+.072175*z)/1);return At(116*U-16,500*(R-U),200*(U-bt((.0193339*oe+.119192*E+.9503041*z)/1.08883)))}function fr(oe){return(oe/=255)<=.04045?oe/12.92:Math.pow((oe+.055)/1.055,2.4)}function yr(oe){var E=parseFloat(oe);return oe.charAt(oe.length-1)==="%"?Math.round(2.55*E):E}Xt.brighter=function(oe){oe=Math.pow(.7,arguments.length?oe:1);var E=this.r,z=this.g,R=this.b,U=30;return E||z||R?(E&&E<U&&(E=U),z&&z<U&&(z=U),R&&R<U&&(R=U),new Vt(Math.min(255,E/oe),Math.min(255,z/oe),Math.min(255,R/oe))):new Vt(U,U,U)},Xt.darker=function(oe){return new Vt((oe=Math.pow(.7,arguments.length?oe:1))*this.r,oe*this.g,oe*this.b)},Xt.hsl=function(){return mr(this.r,this.g,this.b)},Xt.toString=function(){return"#"+ar(this.r)+ar(this.g)+ar(this.b)};var zr=t.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});function xr(oe){return typeof oe=="function"?oe:function(){return oe}}function Br(oe){return function(E,z,R){return arguments.length===2&&typeof z=="function"&&(R=z,z=null),Jr(E,z,oe,R)}}function Jr(oe,E,z,R){var U={},ne=t.dispatch("beforesend","progress","load","error"),le={},pe=new XMLHttpRequest,ye=null;function Te(){var Ne,qe=pe.status;if(!qe&&function(tt){var yt=tt.responseType;return yt&&yt!=="text"?tt.response:tt.responseText}(pe)||qe>=200&&qe<300||qe===304){try{Ne=z.call(U,pe)}catch(tt){return void ne.error.call(U,tt)}ne.load.call(U,Ne)}else ne.error.call(U,pe)}return self.XDomainRequest&&!("withCredentials"in pe)&&/^(http(s)?:)?\/\//.test(oe)&&(pe=new XDomainRequest),"onload"in pe?pe.onload=pe.onerror=Te:pe.onreadystatechange=function(){pe.readyState>3&&Te()},pe.onprogress=function(Ne){var qe=t.event;t.event=Ne;try{ne.progress.call(U,pe)}finally{t.event=qe}},U.header=function(Ne,qe){return Ne=(Ne+"").toLowerCase(),arguments.length<2?le[Ne]:(qe==null?delete le[Ne]:le[Ne]=qe+"",U)},U.mimeType=function(Ne){return arguments.length?(E=Ne==null?null:Ne+"",U):E},U.responseType=function(Ne){return arguments.length?(ye=Ne,U):ye},U.response=function(Ne){return z=Ne,U},["get","post"].forEach(function(Ne){U[Ne]=function(){return U.send.apply(U,[Ne].concat(g(arguments)))}}),U.send=function(Ne,qe,tt){if(arguments.length===2&&typeof qe=="function"&&(tt=qe,qe=null),pe.open(Ne,oe,!0),E==null||"accept"in le||(le.accept=E+",*/*"),pe.setRequestHeader)for(var yt in le)pe.setRequestHeader(yt,le[yt]);return E!=null&&pe.overrideMimeType&&pe.overrideMimeType(E),ye!=null&&(pe.responseType=ye),tt!=null&&U.on("error",tt).on("load",function(St){tt(null,St)}),ne.beforesend.call(U,pe),pe.send(qe==null?null:qe),U},U.abort=function(){return pe.abort(),U},t.rebind(U,ne,"on"),R==null?U:U.get(function(Ne){return Ne.length===1?function(qe,tt){Ne(qe==null?tt:null)}:Ne}(R))}zr.forEach(function(oe,E){zr.set(oe,nr(E))}),t.functor=xr,t.xhr=Br(O),t.dsv=function(oe,E){var z=new RegExp('["'+oe+`
]`),R=oe.charCodeAt(0);function U(Te,Ne,qe){arguments.length<3&&(qe=Ne,Ne=null);var tt=Jr(Te,E,Ne==null?ne:le(Ne),qe);return tt.row=function(yt){return arguments.length?tt.response((Ne=yt)==null?ne:le(yt)):Ne},tt}function ne(Te){return U.parse(Te.responseText)}function le(Te){return function(Ne){return U.parse(Ne.responseText,Te)}}function pe(Te){return Te.map(ye).join(oe)}function ye(Te){return z.test(Te)?'"'+Te.replace(/\"/g,'""')+'"':Te}return U.parse=function(Te,Ne){var qe;return U.parseRows(Te,function(tt,yt){if(qe)return qe(tt,yt-1);var St=function(_t){for(var Tt={},gt=tt.length,Dt=0;Dt<gt;++Dt)Tt[tt[Dt]]=_t[Dt];return Tt};qe=Ne?function(_t,Tt){return Ne(St(_t),Tt)}:St})},U.parseRows=function(Te,Ne){var qe,tt,yt={},St={},_t=[],Tt=Te.length,gt=0,Dt=0;function Ot(){if(gt>=Tt)return St;if(tt)return tt=!1,yt;var er=gt;if(Te.charCodeAt(er)===34){for(var ur=er;ur++<Tt;)if(Te.charCodeAt(ur)===34){if(Te.charCodeAt(ur+1)!==34)break;++ur}return gt=ur+2,(Tr=Te.charCodeAt(ur+1))===13?(tt=!0,Te.charCodeAt(ur+2)===10&&++gt):Tr===10&&(tt=!0),Te.slice(er+1,ur).replace(/""/g,'"')}for(;gt<Tt;){var Tr,wr=1;if((Tr=Te.charCodeAt(gt++))===10)tt=!0;else if(Tr===13)tt=!0,Te.charCodeAt(gt)===10&&(++gt,++wr);else if(Tr!==R)continue;return Te.slice(er,gt-wr)}return Te.slice(er)}for(;(qe=Ot())!==St;){for(var Bt=[];qe!==yt&&qe!==St;)Bt.push(qe),qe=Ot();Ne&&(Bt=Ne(Bt,Dt++))==null||_t.push(Bt)}return _t},U.format=function(Te){if(Array.isArray(Te[0]))return U.formatRows(Te);var Ne=new P,qe=[];return Te.forEach(function(tt){for(var yt in tt)Ne.has(yt)||qe.push(Ne.add(yt))}),[qe.map(ye).join(oe)].concat(Te.map(function(tt){return qe.map(function(yt){return ye(tt[yt])}).join(oe)})).join(`
`)},U.formatRows=function(Te){return Te.map(pe).join(`
`)},U},t.csv=t.dsv(",","text/csv"),t.tsv=t.dsv("	","text/tab-separated-values");var fn,Cn,Pn,An,rn=this[j(this,"requestAnimationFrame")]||function(oe){setTimeout(oe,17)};function Fr(oe,E,z){var R=arguments.length;R<2&&(E=0),R<3&&(z=Date.now());var U=z+E,ne={c:oe,t:U,n:null};return Cn?Cn.n=ne:fn=ne,Cn=ne,Pn||(An=clearTimeout(An),Pn=1,rn(Lr)),ne}function Lr(){var oe=Qr(),E=$r()-oe;E>24?(isFinite(E)&&(clearTimeout(An),An=setTimeout(Lr,E)),Pn=0):(Pn=1,rn(Lr))}function Qr(){for(var oe=Date.now(),E=fn;E;)oe>=E.t&&E.c(oe-E.t)&&(E.c=null),E=E.n;return oe}function $r(){for(var oe,E=fn,z=1/0;E;)E.c?(E.t<z&&(z=E.t),E=(oe=E).n):E=oe?oe.n=E.n:fn=E.n;return Cn=oe,z}function Kr(oe){return oe[0]}function en(oe){return oe[1]}function Tn(oe){for(var E,z,R,U=oe.length,ne=[0,1],le=2,pe=2;pe<U;pe++){for(;le>1&&(E=oe[ne[le-2]],z=oe[ne[le-1]],R=oe[pe],(z[0]-E[0])*(R[1]-E[1])-(z[1]-E[1])*(R[0]-E[0])<=0);)--le;ne[le++]=pe}return ne.slice(0,le)}function Mn(oe,E){return oe[0]-E[0]||oe[1]-E[1]}t.timer=function(){Fr.apply(this,arguments)},t.timer.flush=function(){Qr(),$r()},t.round=function(oe,E){return E?Math.round(oe*(E=Math.pow(10,E)))/E:Math.round(oe)},t.geom={},t.geom.hull=function(oe){var E=Kr,z=en;if(arguments.length)return R(oe);function R(U){if(U.length<3)return[];var ne,le=xr(E),pe=xr(z),ye=U.length,Te=[],Ne=[];for(ne=0;ne<ye;ne++)Te.push([+le.call(this,U[ne],ne),+pe.call(this,U[ne],ne),ne]);for(Te.sort(Mn),ne=0;ne<ye;ne++)Ne.push([Te[ne][0],-Te[ne][1]]);var qe=Tn(Te),tt=Tn(Ne),yt=tt[0]===qe[0],St=tt[tt.length-1]===qe[qe.length-1],_t=[];for(ne=qe.length-1;ne>=0;--ne)_t.push(U[Te[qe[ne]][2]]);for(ne=+yt;ne<tt.length-St;++ne)_t.push(U[Te[tt[ne]][2]]);return _t}return R.x=function(U){return arguments.length?(E=U,R):E},R.y=function(U){return arguments.length?(z=U,R):z},R},t.geom.polygon=function(oe){return B(oe,Rn),oe};var Rn=t.geom.polygon.prototype=[];function Zt(oe,E,z){return(z[0]-E[0])*(oe[1]-E[1])<(z[1]-E[1])*(oe[0]-E[0])}function Ct(oe,E,z,R){var U=oe[0],ne=z[0],le=E[0]-U,pe=R[0]-ne,ye=oe[1],Te=z[1],Ne=E[1]-ye,qe=R[1]-Te,tt=(pe*(ye-Te)-qe*(U-ne))/(qe*le-pe*Ne);return[U+tt*le,ye+tt*Ne]}function Ht(oe){var E=oe[0],z=oe[oe.length-1];return!(E[0]-z[0]||E[1]-z[1])}Rn.area=function(){for(var oe,E=-1,z=this.length,R=this[z-1],U=0;++E<z;)oe=R,R=this[E],U+=oe[1]*R[0]-oe[0]*R[1];return .5*U},Rn.centroid=function(oe){var E,z,R=-1,U=this.length,ne=0,le=0,pe=this[U-1];for(arguments.length||(oe=-1/(6*this.area()));++R<U;)E=pe,pe=this[R],z=E[0]*pe[1]-pe[0]*E[1],ne+=(E[0]+pe[0])*z,le+=(E[1]+pe[1])*z;return[ne*oe,le*oe]},Rn.clip=function(oe){for(var E,z,R,U,ne,le,pe=Ht(oe),ye=-1,Te=this.length-Ht(this),Ne=this[Te-1];++ye<Te;){for(E=oe.slice(),oe.length=0,U=this[ye],ne=E[(R=E.length-pe)-1],z=-1;++z<R;)Zt(le=E[z],Ne,U)?(Zt(ne,Ne,U)||oe.push(Ct(ne,le,Ne,U)),oe.push(le)):Zt(ne,Ne,U)&&oe.push(Ct(ne,le,Ne,U)),ne=le;pe&&oe.push(oe[0]),Ne=U}return oe};var cr,_r,Vr,jr,vr,br=[],Ar=[];function kr(){ni(this),this.edge=this.site=this.circle=null}function Cr(oe){var E=br.pop()||new kr;return E.site=oe,E}function Hr(oe){Ln(oe),Vr.remove(oe),br.push(oe),ni(oe)}function ln(oe){var E=oe.circle,z=E.x,R=E.cy,U={x:z,y:R},ne=oe.P,le=oe.N,pe=[oe];Hr(oe);for(var ye=ne;ye.circle&&v(z-ye.circle.x)<xt&&v(R-ye.circle.cy)<xt;)ne=ye.P,pe.unshift(ye),Hr(ye),ye=ne;pe.unshift(ye),Ln(ye);for(var Te=le;Te.circle&&v(z-Te.circle.x)<xt&&v(R-Te.circle.cy)<xt;)le=Te.N,pe.push(Te),Hr(Te),Te=le;pe.push(Te),Ln(Te);var Ne,qe=pe.length;for(Ne=1;Ne<qe;++Ne)Te=pe[Ne],ye=pe[Ne-1],fa(Te.edge,ye.site,Te.site,U);ye=pe[0],(Te=pe[qe-1]).edge=gn(ye.site,Te.site,null,U),hn(ye),hn(Te)}function xn(oe){for(var E,z,R,U,ne=oe.x,le=oe.y,pe=Vr._;pe;)if((R=Zr(pe,le)-ne)>xt)pe=pe.L;else{if(!((U=ne-yn(pe,le))>xt)){R>-xt?(E=pe.P,z=pe):U>-xt?(E=pe,z=pe.N):E=z=pe;break}if(!pe.R){E=pe;break}pe=pe.R}var ye=Cr(oe);if(Vr.insert(E,ye),E||z){if(E===z)return Ln(E),z=Cr(E.site),Vr.insert(ye,z),ye.edge=z.edge=gn(E.site,ye.site),hn(E),void hn(z);if(z){Ln(E),Ln(z);var Te=E.site,Ne=Te.x,qe=Te.y,tt=oe.x-Ne,yt=oe.y-qe,St=z.site,_t=St.x-Ne,Tt=St.y-qe,gt=2*(tt*Tt-yt*_t),Dt=tt*tt+yt*yt,Ot=_t*_t+Tt*Tt,Bt={x:(Tt*Dt-yt*Ot)/gt+Ne,y:(tt*Ot-_t*Dt)/gt+qe};fa(z.edge,Te,St,Bt),ye.edge=gn(Te,oe,null,Bt),z.edge=gn(oe,St,null,Bt),hn(E),hn(z)}else ye.edge=gn(E.site,ye.site)}}function Zr(oe,E){var z=oe.site,R=z.x,U=z.y,ne=U-E;if(!ne)return R;var le=oe.P;if(!le)return-1/0;var pe=(z=le.site).x,ye=z.y,Te=ye-E;if(!Te)return pe;var Ne=pe-R,qe=1/ne-1/Te,tt=Ne/Te;return qe?(-tt+Math.sqrt(tt*tt-2*qe*(Ne*Ne/(-2*Te)-ye+Te/2+U-ne/2)))/qe+R:(R+pe)/2}function yn(oe,E){var z=oe.N;if(z)return Zr(z,E);var R=oe.site;return R.y===E?R.x:1/0}function Ir(oe){this.site=oe,this.edges=[]}function Gr(oe,E){return E.angle-oe.angle}function mn(){ni(this),this.x=this.y=this.arc=this.site=this.cy=null}function hn(oe){var E=oe.P,z=oe.N;if(E&&z){var R=E.site,U=oe.site,ne=z.site;if(R!==ne){var le=U.x,pe=U.y,ye=R.x-le,Te=R.y-pe,Ne=ne.x-le,qe=2*(ye*(Tt=ne.y-pe)-Te*Ne);if(!(qe>=-1e-12)){var tt=ye*ye+Te*Te,yt=Ne*Ne+Tt*Tt,St=(Tt*tt-Te*yt)/qe,_t=(ye*yt-Ne*tt)/qe,Tt=_t+pe,gt=Ar.pop()||new mn;gt.arc=oe,gt.site=U,gt.x=St+le,gt.y=Tt+Math.sqrt(St*St+_t*_t),gt.cy=Tt,oe.circle=gt;for(var Dt=null,Ot=vr._;Ot;)if(gt.y<Ot.y||gt.y===Ot.y&&gt.x<=Ot.x){if(!Ot.L){Dt=Ot.P;break}Ot=Ot.L}else{if(!Ot.R){Dt=Ot;break}Ot=Ot.R}vr.insert(Dt,gt),Dt||(jr=gt)}}}}function Ln(oe){var E=oe.circle;E&&(E.P||(jr=E.N),vr.remove(E),Ar.push(E),ni(E),oe.circle=null)}function ia(oe,E){var z=oe.b;if(z)return!0;var R,U,ne=oe.a,le=E[0][0],pe=E[1][0],ye=E[0][1],Te=E[1][1],Ne=oe.l,qe=oe.r,tt=Ne.x,yt=Ne.y,St=qe.x,_t=qe.y,Tt=(tt+St)/2,gt=(yt+_t)/2;if(_t===yt){if(Tt<le||Tt>=pe)return;if(tt>St){if(ne){if(ne.y>=Te)return}else ne={x:Tt,y:ye};z={x:Tt,y:Te}}else{if(ne){if(ne.y<ye)return}else ne={x:Tt,y:Te};z={x:Tt,y:ye}}}else if(U=gt-(R=(tt-St)/(_t-yt))*Tt,R<-1||R>1)if(tt>St){if(ne){if(ne.y>=Te)return}else ne={x:(ye-U)/R,y:ye};z={x:(Te-U)/R,y:Te}}else{if(ne){if(ne.y<ye)return}else ne={x:(Te-U)/R,y:Te};z={x:(ye-U)/R,y:ye}}else if(yt<_t){if(ne){if(ne.x>=pe)return}else ne={x:le,y:R*le+U};z={x:pe,y:R*pe+U}}else{if(ne){if(ne.x<le)return}else ne={x:pe,y:R*pe+U};z={x:le,y:R*le+U}}return oe.a=ne,oe.b=z,!0}function qn(oe,E){this.l=oe,this.r=E,this.a=this.b=null}function gn(oe,E,z,R){var U=new qn(oe,E);return cr.push(U),z&&fa(U,oe,E,z),R&&fa(U,E,oe,R),_r[oe.i].edges.push(new Za(U,oe,E)),_r[E.i].edges.push(new Za(U,E,oe)),U}function ta(oe,E,z){var R=new qn(oe,null);return R.a=E,R.b=z,cr.push(R),R}function fa(oe,E,z,R){oe.a||oe.b?oe.l===z?oe.b=R:oe.a=R:(oe.a=R,oe.l=E,oe.r=z)}function Za(oe,E,z){var R=oe.a,U=oe.b;this.edge=oe,this.site=E,this.angle=z?Math.atan2(z.y-E.y,z.x-E.x):oe.l===E?Math.atan2(U.x-R.x,R.y-U.y):Math.atan2(R.x-U.x,U.y-R.y)}function Pi(){this._=null}function ni(oe){oe.U=oe.C=oe.L=oe.R=oe.P=oe.N=null}function yi(oe,E){var z=E,R=E.R,U=z.U;U?U.L===z?U.L=R:U.R=R:oe._=R,R.U=U,z.U=R,z.R=R.L,z.R&&(z.R.U=z),R.L=z}function Aa(oe,E){var z=E,R=E.L,U=z.U;U?U.L===z?U.L=R:U.R=R:oe._=R,R.U=U,z.U=R,z.L=R.R,z.L&&(z.L.U=z),R.R=z}function ja(oe){for(;oe.L;)oe=oe.L;return oe}function co(oe,E){var z,R,U,ne=oe.sort(Bo).pop();for(cr=[],_r=new Array(oe.length),Vr=new Pi,vr=new Pi;;)if(U=jr,ne&&(!U||ne.y<U.y||ne.y===U.y&&ne.x<U.x))ne.x===z&&ne.y===R||(_r[ne.i]=new Ir(ne),xn(ne),z=ne.x,R=ne.y),ne=oe.pop();else{if(!U)break;ln(U.arc)}E&&(function(pe){for(var ye,Te,Ne,qe,tt,yt=cr,St=(Te=pe[0][0],Ne=pe[0][1],qe=pe[1][0],tt=pe[1][1],function(Tt){var gt,Dt=Tt.a,Ot=Tt.b,Bt=Dt.x,er=Dt.y,ur=0,Tr=1,wr=Ot.x-Bt,Xr=Ot.y-er;if(gt=Te-Bt,wr||!(gt>0)){if(gt/=wr,wr<0){if(gt<ur)return;gt<Tr&&(Tr=gt)}else if(wr>0){if(gt>Tr)return;gt>ur&&(ur=gt)}if(gt=qe-Bt,wr||!(gt<0)){if(gt/=wr,wr<0){if(gt>Tr)return;gt>ur&&(ur=gt)}else if(wr>0){if(gt<ur)return;gt<Tr&&(Tr=gt)}if(gt=Ne-er,Xr||!(gt>0)){if(gt/=Xr,Xr<0){if(gt<ur)return;gt<Tr&&(Tr=gt)}else if(Xr>0){if(gt>Tr)return;gt>ur&&(ur=gt)}if(gt=tt-er,Xr||!(gt<0)){if(gt/=Xr,Xr<0){if(gt>Tr)return;gt>ur&&(ur=gt)}else if(Xr>0){if(gt<ur)return;gt<Tr&&(Tr=gt)}return ur>0&&(Tt.a={x:Bt+ur*wr,y:er+ur*Xr}),Tr<1&&(Tt.b={x:Bt+Tr*wr,y:er+Tr*Xr}),Tt}}}}}),_t=yt.length;_t--;)(!ia(ye=yt[_t],pe)||!St(ye)||v(ye.a.x-ye.b.x)<xt&&v(ye.a.y-ye.b.y)<xt)&&(ye.a=ye.b=null,yt.splice(_t,1))}(E),function(pe){for(var ye,Te,Ne,qe,tt,yt,St,_t,Tt,gt,Dt=pe[0][0],Ot=pe[1][0],Bt=pe[0][1],er=pe[1][1],ur=_r,Tr=ur.length;Tr--;)if((tt=ur[Tr])&&tt.prepare())for(_t=(St=tt.edges).length,yt=0;yt<_t;)Ne=(gt=St[yt].end()).x,qe=gt.y,ye=(Tt=St[++yt%_t].start()).x,Te=Tt.y,(v(Ne-ye)>xt||v(qe-Te)>xt)&&(St.splice(yt,0,new Za(ta(tt.site,gt,v(Ne-Dt)<xt&&er-qe>xt?{x:Dt,y:v(ye-Dt)<xt?Te:er}:v(qe-er)<xt&&Ot-Ne>xt?{x:v(Te-er)<xt?ye:Ot,y:er}:v(Ne-Ot)<xt&&qe-Bt>xt?{x:Ot,y:v(ye-Ot)<xt?Te:Bt}:v(qe-Bt)<xt&&Ne-Dt>xt?{x:v(Te-Bt)<xt?ye:Dt,y:Bt}:null),tt.site,null)),++_t)}(E));var le={cells:_r,edges:cr};return Vr=vr=cr=_r=null,le}function Bo(oe,E){return E.y-oe.y||E.x-oe.x}Ir.prototype.prepare=function(){for(var oe,E=this.edges,z=E.length;z--;)(oe=E[z].edge).b&&oe.a||E.splice(z,1);return E.sort(Gr),E.length},Za.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},Pi.prototype={insert:function(oe,E){var z,R,U;if(oe){if(E.P=oe,E.N=oe.N,oe.N&&(oe.N.P=E),oe.N=E,oe.R){for(oe=oe.R;oe.L;)oe=oe.L;oe.L=E}else oe.R=E;z=oe}else this._?(oe=ja(this._),E.P=null,E.N=oe,oe.P=oe.L=E,z=oe):(E.P=E.N=null,this._=E,z=null);for(E.L=E.R=null,E.U=z,E.C=!0,oe=E;z&&z.C;)z===(R=z.U).L?(U=R.R)&&U.C?(z.C=U.C=!1,R.C=!0,oe=R):(oe===z.R&&(yi(this,z),z=(oe=z).U),z.C=!1,R.C=!0,Aa(this,R)):(U=R.L)&&U.C?(z.C=U.C=!1,R.C=!0,oe=R):(oe===z.L&&(Aa(this,z),z=(oe=z).U),z.C=!1,R.C=!0,yi(this,R)),z=oe.U;this._.C=!1},remove:function(oe){oe.N&&(oe.N.P=oe.P),oe.P&&(oe.P.N=oe.N),oe.N=oe.P=null;var E,z,R,U=oe.U,ne=oe.L,le=oe.R;if(z=ne?le?ja(le):ne:le,U?U.L===oe?U.L=z:U.R=z:this._=z,ne&&le?(R=z.C,z.C=oe.C,z.L=ne,ne.U=z,z!==le?(U=z.U,z.U=oe.U,oe=z.R,U.L=oe,z.R=le,le.U=z):(z.U=U,U=z,oe=z.R)):(R=oe.C,oe=z),oe&&(oe.U=U),!R)if(oe&&oe.C)oe.C=!1;else{do{if(oe===this._)break;if(oe===U.L){if((E=U.R).C&&(E.C=!1,U.C=!0,yi(this,U),E=U.R),E.L&&E.L.C||E.R&&E.R.C){E.R&&E.R.C||(E.L.C=!1,E.C=!0,Aa(this,E),E=U.R),E.C=U.C,U.C=E.R.C=!1,yi(this,U),oe=this._;break}}else if((E=U.L).C&&(E.C=!1,U.C=!0,Aa(this,U),E=U.L),E.L&&E.L.C||E.R&&E.R.C){E.L&&E.L.C||(E.R.C=!1,E.C=!0,yi(this,E),E=U.L),E.C=U.C,U.C=E.L.C=!1,Aa(this,U),oe=this._;break}E.C=!0,oe=U,U=U.U}while(!oe.C);oe&&(oe.C=!1)}}},t.geom.voronoi=function(oe){var E=Kr,z=en,R=E,U=z,ne=Wo;if(oe)return le(oe);function le(ye){var Te=new Array(ye.length),Ne=ne[0][0],qe=ne[0][1],tt=ne[1][0],yt=ne[1][1];return co(pe(ye),ne).cells.forEach(function(St,_t){var Tt=St.edges,gt=St.site;(Te[_t]=Tt.length?Tt.map(function(Dt){var Ot=Dt.start();return[Ot.x,Ot.y]}):gt.x>=Ne&&gt.x<=tt&&gt.y>=qe&&gt.y<=yt?[[Ne,yt],[tt,yt],[tt,qe],[Ne,qe]]:[]).point=ye[_t]}),Te}function pe(ye){return ye.map(function(Te,Ne){return{x:Math.round(R(Te,Ne)/xt)*xt,y:Math.round(U(Te,Ne)/xt)*xt,i:Ne}})}return le.links=function(ye){return co(pe(ye)).edges.filter(function(Te){return Te.l&&Te.r}).map(function(Te){return{source:ye[Te.l.i],target:ye[Te.r.i]}})},le.triangles=function(ye){var Te=[];return co(pe(ye)).cells.forEach(function(Ne,qe){for(var tt,yt,St,_t,Tt=Ne.site,gt=Ne.edges.sort(Gr),Dt=-1,Ot=gt.length,Bt=gt[Ot-1].edge,er=Bt.l===Tt?Bt.r:Bt.l;++Dt<Ot;)tt=er,er=(Bt=gt[Dt].edge).l===Tt?Bt.r:Bt.l,qe<tt.i&&qe<er.i&&(St=tt,_t=er,((yt=Tt).x-_t.x)*(St.y-yt.y)-(yt.x-St.x)*(_t.y-yt.y)<0)&&Te.push([ye[qe],ye[tt.i],ye[er.i]])}),Te},le.x=function(ye){return arguments.length?(R=xr(E=ye),le):E},le.y=function(ye){return arguments.length?(U=xr(z=ye),le):z},le.clipExtent=function(ye){return arguments.length?(ne=ye==null?Wo:ye,le):ne===Wo?null:ne},le.size=function(ye){return arguments.length?le.clipExtent(ye&&[[0,0],ye]):ne===Wo?null:ne&&ne[1]},le};var Wo=[[-1e6,-1e6],[1e6,1e6]];function qi(oe){return oe.x}function Wi(oe){return oe.y}function No(oe,E,z,R,U,ne){if(!oe(E,z,R,U,ne)){var le=.5*(z+U),pe=.5*(R+ne),ye=E.nodes;ye[0]&&No(oe,ye[0],z,R,le,pe),ye[1]&&No(oe,ye[1],le,R,U,pe),ye[2]&&No(oe,ye[2],z,pe,le,ne),ye[3]&&No(oe,ye[3],le,pe,U,ne)}}function Ha(oe,E,z,R,U,ne,le){var pe,ye=1/0;return function Te(Ne,qe,tt,yt,St){if(!(qe>ne||tt>le||yt<R||St<U)){if(_t=Ne.point){var _t,Tt=E-Ne.x,gt=z-Ne.y,Dt=Tt*Tt+gt*gt;if(Dt<ye){var Ot=Math.sqrt(ye=Dt);R=E-Ot,U=z-Ot,ne=E+Ot,le=z+Ot,pe=_t}}for(var Bt=Ne.nodes,er=.5*(qe+yt),ur=.5*(tt+St),Tr=(z>=ur)<<1|E>=er,wr=Tr+4;Tr<wr;++Tr)if(Ne=Bt[3&Tr])switch(3&Tr){case 0:Te(Ne,qe,tt,er,ur);break;case 1:Te(Ne,er,tt,yt,ur);break;case 2:Te(Ne,qe,ur,er,St);break;case 3:Te(Ne,er,ur,yt,St)}}}(oe,R,U,ne,le),pe}function ko(oe,E){oe=t.rgb(oe),E=t.rgb(E);var z=oe.r,R=oe.g,U=oe.b,ne=E.r-z,le=E.g-R,pe=E.b-U;return function(ye){return"#"+ar(Math.round(z+ne*ye))+ar(Math.round(R+le*ye))+ar(Math.round(U+pe*ye))}}function uo(oe,E){var z,R={},U={};for(z in oe)z in E?R[z]=Di(oe[z],E[z]):U[z]=oe[z];for(z in E)z in oe||(U[z]=E[z]);return function(ne){for(z in R)U[z]=R[z](ne);return U}}function xi(oe,E){return oe=+oe,E=+E,function(z){return oe*(1-z)+E*z}}function Xi(oe,E){var z,R,U,ne=fo.lastIndex=_o.lastIndex=0,le=-1,pe=[],ye=[];for(oe+="",E+="";(z=fo.exec(oe))&&(R=_o.exec(E));)(U=R.index)>ne&&(U=E.slice(ne,U),pe[le]?pe[le]+=U:pe[++le]=U),(z=z[0])===(R=R[0])?pe[le]?pe[le]+=R:pe[++le]=R:(pe[++le]=null,ye.push({i:le,x:xi(z,R)})),ne=_o.lastIndex;return ne<E.length&&(U=E.slice(ne),pe[le]?pe[le]+=U:pe[++le]=U),pe.length<2?ye[0]?(E=ye[0].x,function(Te){return E(Te)+""}):function(){return E}:(E=ye.length,function(Te){for(var Ne,qe=0;qe<E;++qe)pe[(Ne=ye[qe]).i]=Ne.x(Te);return pe.join("")})}t.geom.delaunay=function(oe){return t.geom.voronoi().triangles(oe)},t.geom.quadtree=function(oe,E,z,R,U){var ne,le=Kr,pe=en;if(ne=arguments.length)return le=qi,pe=Wi,ne===3&&(U=z,R=E,z=E=0),ye(oe);function ye(Te){var Ne,qe,tt,yt,St,_t,Tt,gt,Dt,Ot=xr(le),Bt=xr(pe);if(E!=null)_t=E,Tt=z,gt=R,Dt=U;else if(gt=Dt=-(_t=Tt=1/0),qe=[],tt=[],St=Te.length,ne)for(yt=0;yt<St;++yt)(Ne=Te[yt]).x<_t&&(_t=Ne.x),Ne.y<Tt&&(Tt=Ne.y),Ne.x>gt&&(gt=Ne.x),Ne.y>Dt&&(Dt=Ne.y),qe.push(Ne.x),tt.push(Ne.y);else for(yt=0;yt<St;++yt){var er=+Ot(Ne=Te[yt],yt),ur=+Bt(Ne,yt);er<_t&&(_t=er),ur<Tt&&(Tt=ur),er>gt&&(gt=er),ur>Dt&&(Dt=ur),qe.push(er),tt.push(ur)}var Tr=gt-_t,wr=Dt-Tt;function Xr(an,Nn,Yn,sa,Nr,wn,Wn,Vn){if(!isNaN(Yn)&&!isNaN(sa))if(an.leaf){var $n=an.x,ca=an.y;if($n!=null)if(v($n-Yn)+v(ca-sa)<.01)Wr(an,Nn,Yn,sa,Nr,wn,Wn,Vn);else{var Ta=an.point;an.x=an.y=an.point=null,Wr(an,Ta,$n,ca,Nr,wn,Wn,Vn),Wr(an,Nn,Yn,sa,Nr,wn,Wn,Vn)}else an.x=Yn,an.y=sa,an.point=Nn}else Wr(an,Nn,Yn,sa,Nr,wn,Wn,Vn)}function Wr(an,Nn,Yn,sa,Nr,wn,Wn,Vn){var $n=.5*(Nr+Wn),ca=.5*(wn+Vn),Ta=Yn>=$n,Zn=sa>=ca,va=Zn<<1|Ta;an.leaf=!1,Ta?Nr=$n:Wn=$n,Zn?wn=ca:Vn=ca,Xr(an=an.nodes[va]||(an.nodes[va]={leaf:!0,nodes:[],point:null,x:null,y:null}),Nn,Yn,sa,Nr,wn,Wn,Vn)}Tr>wr?Dt=Tt+Tr:gt=_t+wr;var un={leaf:!0,nodes:[],point:null,x:null,y:null,add:function(an){Xr(un,an,+Ot(an,++yt),+Bt(an,yt),_t,Tt,gt,Dt)},visit:function(an){No(an,un,_t,Tt,gt,Dt)},find:function(an){return Ha(un,an[0],an[1],_t,Tt,gt,Dt)}};if(yt=-1,E==null){for(;++yt<St;)Xr(un,Te[yt],qe[yt],tt[yt],_t,Tt,gt,Dt);--yt}else Te.forEach(un.add);return qe=tt=Te=Ne=null,un}return ye.x=function(Te){return arguments.length?(le=Te,ye):le},ye.y=function(Te){return arguments.length?(pe=Te,ye):pe},ye.extent=function(Te){return arguments.length?(Te==null?E=z=R=U=null:(E=+Te[0][0],z=+Te[0][1],R=+Te[1][0],U=+Te[1][1]),ye):E==null?null:[[E,z],[R,U]]},ye.size=function(Te){return arguments.length?(Te==null?E=z=R=U=null:(E=z=0,R=+Te[0],U=+Te[1]),ye):E==null?null:[R-E,U-z]},ye},t.interpolateRgb=ko,t.interpolateObject=uo,t.interpolateNumber=xi,t.interpolateString=Xi;var fo=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,_o=new RegExp(fo.source,"g");function Di(oe,E){for(var z,R=t.interpolators.length;--R>=0&&!(z=t.interpolators[R](oe,E)););return z}function fi(oe,E){var z,R=[],U=[],ne=oe.length,le=E.length,pe=Math.min(oe.length,E.length);for(z=0;z<pe;++z)R.push(Di(oe[z],E[z]));for(;z<ne;++z)U[z]=oe[z];for(;z<le;++z)U[z]=E[z];return function(ye){for(z=0;z<pe;++z)U[z]=R[z](ye);return U}}t.interpolate=Di,t.interpolators=[function(oe,E){var z=typeof E;return(z==="string"?zr.has(E.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(E)?ko:Xi:E instanceof kt?ko:Array.isArray(E)?fi:z==="object"&&isNaN(E)?uo:xi)(oe,E)}],t.interpolateArray=fi;var Gi=function(){return O},ys=t.map({linear:Gi,poly:function(oe){return function(E){return Math.pow(E,oe)}},quad:function(){return Ts},cubic:function(){return ks},sin:function(){return As},exp:function(){return Ao},circle:function(){return Mo},elastic:function(oe,E){var z;return arguments.length<2&&(E=.45),arguments.length?z=E/$t*Math.asin(1/oe):(oe=1,z=E/4),function(R){return 1+oe*Math.pow(2,-10*R)*Math.sin((R-z)*$t/E)}},back:function(oe){return oe||(oe=1.70158),function(E){return E*E*((oe+1)*E-oe)}},bounce:function(){return jo}}),ws=t.map({in:O,out:hs,"in-out":Qo,"out-in":function(oe){return Qo(hs(oe))}});function qa(oe){return function(E){return E<=0?0:E>=1?1:oe(E)}}function hs(oe){return function(E){return 1-oe(1-E)}}function Qo(oe){return function(E){return .5*(E<.5?oe(2*E):2-oe(2-2*E))}}function Ts(oe){return oe*oe}function ks(oe){return oe*oe*oe}function xs(oe){if(oe<=0)return 0;if(oe>=1)return 1;var E=oe*oe,z=E*oe;return 4*(oe<.5?z:3*(oe-E)+z-.75)}function As(oe){return 1-Math.cos(oe*He)}function Ao(oe){return Math.pow(2,10*(oe-1))}function Mo(oe){return 1-Math.sqrt(1-oe*oe)}function jo(oe){return oe<1/2.75?7.5625*oe*oe:oe<2/2.75?7.5625*(oe-=1.5/2.75)*oe+.75:oe<2.5/2.75?7.5625*(oe-=2.25/2.75)*oe+.9375:7.5625*(oe-=2.625/2.75)*oe+.984375}function Uo(oe,E){return E-=oe,function(z){return Math.round(oe+E*z)}}function Vo(oe){var E,z,R,U=[oe.a,oe.b],ne=[oe.c,oe.d],le=ho(U),pe=$o(U,ne),ye=ho(((E=ne)[0]+=(R=-pe)*(z=U)[0],E[1]+=R*z[1],E))||0;U[0]*ne[1]<ne[0]*U[1]&&(U[0]*=-1,U[1]*=-1,le*=-1,pe*=-1),this.rotate=(le?Math.atan2(U[1],U[0]):Math.atan2(-ne[0],ne[1]))*Je,this.translate=[oe.e,oe.f],this.scale=[le,ye],this.skew=ye?Math.atan2(pe,ye)*Je:0}function $o(oe,E){return oe[0]*E[0]+oe[1]*E[1]}function ho(oe){var E=Math.sqrt($o(oe,oe));return E&&(oe[0]/=E,oe[1]/=E),E}t.ease=function(oe){var E=oe.indexOf("-"),z=E>=0?oe.slice(0,E):oe,R=E>=0?oe.slice(E+1):"in";return z=ys.get(z)||Gi,qa((R=ws.get(R)||O)(z.apply(null,m.call(arguments,1))))},t.interpolateHcl=function(oe,E){oe=t.hcl(oe),E=t.hcl(E);var z=oe.h,R=oe.c,U=oe.l,ne=E.h-z,le=E.c-R,pe=E.l-U;return isNaN(le)&&(le=0,R=isNaN(R)?E.c:R),isNaN(ne)?(ne=0,z=isNaN(z)?E.h:z):ne>180?ne-=360:ne<-180&&(ne+=360),function(ye){return nt(z+ne*ye,R+le*ye,U+pe*ye)+""}},t.interpolateHsl=function(oe,E){oe=t.hsl(oe),E=t.hsl(E);var z=oe.h,R=oe.s,U=oe.l,ne=E.h-z,le=E.s-R,pe=E.l-U;return isNaN(le)&&(le=0,R=isNaN(R)?E.s:R),isNaN(ne)?(ne=0,z=isNaN(z)?E.h:z):ne>180?ne-=360:ne<-180&&(ne+=360),function(ye){return mt(z+ne*ye,R+le*ye,U+pe*ye)+""}},t.interpolateLab=function(oe,E){oe=t.lab(oe),E=t.lab(E);var z=oe.l,R=oe.a,U=oe.b,ne=E.l-z,le=E.a-R,pe=E.b-U;return function(ye){return Kt(z+ne*ye,R+le*ye,U+pe*ye)+""}},t.interpolateRound=Uo,t.transform=function(oe){var E=p.createElementNS(t.ns.prefix.svg,"g");return(t.transform=function(z){if(z!=null){E.setAttribute("transform",z);var R=E.transform.baseVal.consolidate()}return new Vo(R?R.matrix:ps)})(oe)},Vo.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var ps={a:1,b:0,c:0,d:1,e:0,f:0};function oo(oe){return oe.length?oe.pop()+",":""}function Ho(oe,E){var z=[],R=[];return oe=t.transform(oe),E=t.transform(E),function(U,ne,le,pe){if(U[0]!==ne[0]||U[1]!==ne[1]){var ye=le.push("translate(",null,",",null,")");pe.push({i:ye-4,x:xi(U[0],ne[0])},{i:ye-2,x:xi(U[1],ne[1])})}else(ne[0]||ne[1])&&le.push("translate("+ne+")")}(oe.translate,E.translate,z,R),function(U,ne,le,pe){U!==ne?(U-ne>180?ne+=360:ne-U>180&&(U+=360),pe.push({i:le.push(oo(le)+"rotate(",null,")")-2,x:xi(U,ne)})):ne&&le.push(oo(le)+"rotate("+ne+")")}(oe.rotate,E.rotate,z,R),function(U,ne,le,pe){U!==ne?pe.push({i:le.push(oo(le)+"skewX(",null,")")-2,x:xi(U,ne)}):ne&&le.push(oo(le)+"skewX("+ne+")")}(oe.skew,E.skew,z,R),function(U,ne,le,pe){if(U[0]!==ne[0]||U[1]!==ne[1]){var ye=le.push(oo(le)+"scale(",null,",",null,")");pe.push({i:ye-4,x:xi(U[0],ne[0])},{i:ye-2,x:xi(U[1],ne[1])})}else ne[0]===1&&ne[1]===1||le.push(oo(le)+"scale("+ne+")")}(oe.scale,E.scale,z,R),oe=E=null,function(U){for(var ne,le=-1,pe=R.length;++le<pe;)z[(ne=R[le]).i]=ne.x(U);return z.join("")}}function ds(oe,E){return E=(E-=oe=+oe)||1/E,function(z){return(z-oe)/E}}function So(oe,E){return E=(E-=oe=+oe)||1/E,function(z){return Math.max(0,Math.min(1,(z-oe)/E))}}function Ua(oe){for(var E=oe.source,z=oe.target,R=function(le,pe){if(le===pe)return le;for(var ye=Re(le),Te=Re(pe),Ne=ye.pop(),qe=Te.pop(),tt=null;Ne===qe;)tt=Ne,Ne=ye.pop(),qe=Te.pop();return tt}(E,z),U=[E];E!==R;)E=E.parent,U.push(E);for(var ne=U.length;z!==R;)U.splice(ne,0,z),z=z.parent;return U}function Re(oe){for(var E=[],z=oe.parent;z!=null;)E.push(oe),oe=z,z=z.parent;return E.push(oe),E}function Ve(oe){oe.fixed|=2}function Ke(oe){oe.fixed&=-7}function at(oe){oe.fixed|=4,oe.px=oe.x,oe.py=oe.y}function dt(oe){oe.fixed&=-5}t.interpolateTransform=Ho,t.layout={},t.layout.bundle=function(){return function(oe){for(var E=[],z=-1,R=oe.length;++z<R;)E.push(Ua(oe[z]));return E}},t.layout.chord=function(){var oe,E,z,R,U,ne,le,pe={},ye=0;function Te(){var qe,tt,yt,St,_t,Tt={},gt=[],Dt=t.range(R),Ot=[];for(oe=[],E=[],qe=0,St=-1;++St<R;){for(tt=0,_t=-1;++_t<R;)tt+=z[St][_t];gt.push(tt),Ot.push(t.range(R)),qe+=tt}for(U&&Dt.sort(function(un,an){return U(gt[un],gt[an])}),ne&&Ot.forEach(function(un,an){un.sort(function(Nn,Yn){return ne(z[an][Nn],z[an][Yn])})}),qe=($t-ye*R)/qe,tt=0,St=-1;++St<R;){for(yt=tt,_t=-1;++_t<R;){var Bt=Dt[St],er=Ot[Bt][_t],ur=z[Bt][er],Tr=tt,wr=tt+=ur*qe;Tt[Bt+"-"+er]={index:Bt,subindex:er,startAngle:Tr,endAngle:wr,value:ur}}E[Bt]={index:Bt,startAngle:yt,endAngle:tt,value:gt[Bt]},tt+=ye}for(St=-1;++St<R;)for(_t=St-1;++_t<R;){var Xr=Tt[St+"-"+_t],Wr=Tt[_t+"-"+St];(Xr.value||Wr.value)&&oe.push(Xr.value<Wr.value?{source:Wr,target:Xr}:{source:Xr,target:Wr})}le&&Ne()}function Ne(){oe.sort(function(qe,tt){return le((qe.source.value+qe.target.value)/2,(tt.source.value+tt.target.value)/2)})}return pe.matrix=function(qe){return arguments.length?(R=(z=qe)&&z.length,oe=E=null,pe):z},pe.padding=function(qe){return arguments.length?(ye=qe,oe=E=null,pe):ye},pe.sortGroups=function(qe){return arguments.length?(U=qe,oe=E=null,pe):U},pe.sortSubgroups=function(qe){return arguments.length?(ne=qe,oe=null,pe):ne},pe.sortChords=function(qe){return arguments.length?(le=qe,oe&&Ne(),pe):le},pe.chords=function(){return oe||Te(),oe},pe.groups=function(){return E||Te(),E},pe},t.layout.force=function(){var oe,E,z,R,U,ne,le={},pe=t.dispatch("start","tick","end"),ye=[1,1],Te=.9,Ne=ht,qe=Mt,tt=-30,yt=Wt,St=.1,_t=.64,Tt=[],gt=[];function Dt(Bt){return function(er,ur,Tr,wr){if(er.point!==Bt){var Xr=er.cx-Bt.x,Wr=er.cy-Bt.y,un=wr-ur,an=Xr*Xr+Wr*Wr;if(un*un/_t<an){if(an<yt){var Nn=er.charge/an;Bt.px-=Xr*Nn,Bt.py-=Wr*Nn}return!0}er.point&&an&&an<yt&&(Nn=er.pointCharge/an,Bt.px-=Xr*Nn,Bt.py-=Wr*Nn)}return!er.charge}}function Ot(Bt){Bt.px=t.event.x,Bt.py=t.event.y,le.resume()}return le.tick=function(){if((z*=.99)<.005)return oe=null,pe.end({type:"end",alpha:z=0}),!0;var Bt,er,ur,Tr,wr,Xr,Wr,un,an,Nn=Tt.length,Yn=gt.length;for(er=0;er<Yn;++er)Tr=(ur=gt[er]).source,(Xr=(un=(wr=ur.target).x-Tr.x)*un+(an=wr.y-Tr.y)*an)&&(un*=Xr=z*U[er]*((Xr=Math.sqrt(Xr))-R[er])/Xr,an*=Xr,wr.x-=un*(Wr=Tr.weight+wr.weight?Tr.weight/(Tr.weight+wr.weight):.5),wr.y-=an*Wr,Tr.x+=un*(Wr=1-Wr),Tr.y+=an*Wr);if((Wr=z*St)&&(un=ye[0]/2,an=ye[1]/2,er=-1,Wr))for(;++er<Nn;)(ur=Tt[er]).x+=(un-ur.x)*Wr,ur.y+=(an-ur.y)*Wr;if(tt)for(function sa(Nr,wn,Wn){var Vn=0,$n=0;if(Nr.charge=0,!Nr.leaf)for(var ca,Ta=Nr.nodes,Zn=Ta.length,va=-1;++va<Zn;)(ca=Ta[va])!=null&&(sa(ca,wn,Wn),Nr.charge+=ca.charge,Vn+=ca.charge*ca.cx,$n+=ca.charge*ca.cy);if(Nr.point){Nr.leaf||(Nr.point.x+=Math.random()-.5,Nr.point.y+=Math.random()-.5);var da=wn*Wn[Nr.point.index];Nr.charge+=Nr.pointCharge=da,Vn+=da*Nr.point.x,$n+=da*Nr.point.y}Nr.cx=Vn/Nr.charge,Nr.cy=$n/Nr.charge}(Bt=t.geom.quadtree(Tt),z,ne),er=-1;++er<Nn;)(ur=Tt[er]).fixed||Bt.visit(Dt(ur));for(er=-1;++er<Nn;)(ur=Tt[er]).fixed?(ur.x=ur.px,ur.y=ur.py):(ur.x-=(ur.px-(ur.px=ur.x))*Te,ur.y-=(ur.py-(ur.py=ur.y))*Te);pe.tick({type:"tick",alpha:z})},le.nodes=function(Bt){return arguments.length?(Tt=Bt,le):Tt},le.links=function(Bt){return arguments.length?(gt=Bt,le):gt},le.size=function(Bt){return arguments.length?(ye=Bt,le):ye},le.linkDistance=function(Bt){return arguments.length?(Ne=typeof Bt=="function"?Bt:+Bt,le):Ne},le.distance=le.linkDistance,le.linkStrength=function(Bt){return arguments.length?(qe=typeof Bt=="function"?Bt:+Bt,le):qe},le.friction=function(Bt){return arguments.length?(Te=+Bt,le):Te},le.charge=function(Bt){return arguments.length?(tt=typeof Bt=="function"?Bt:+Bt,le):tt},le.chargeDistance=function(Bt){return arguments.length?(yt=Bt*Bt,le):Math.sqrt(yt)},le.gravity=function(Bt){return arguments.length?(St=+Bt,le):St},le.theta=function(Bt){return arguments.length?(_t=Bt*Bt,le):Math.sqrt(_t)},le.alpha=function(Bt){return arguments.length?(Bt=+Bt,z?Bt>0?z=Bt:(oe.c=null,oe.t=NaN,oe=null,pe.end({type:"end",alpha:z=0})):Bt>0&&(pe.start({type:"start",alpha:z=Bt}),oe=Fr(le.tick)),le):z},le.start=function(){var Bt,er,ur,Tr=Tt.length,wr=gt.length,Xr=ye[0],Wr=ye[1];for(Bt=0;Bt<Tr;++Bt)(ur=Tt[Bt]).index=Bt,ur.weight=0;for(Bt=0;Bt<wr;++Bt)typeof(ur=gt[Bt]).source=="number"&&(ur.source=Tt[ur.source]),typeof ur.target=="number"&&(ur.target=Tt[ur.target]),++ur.source.weight,++ur.target.weight;for(Bt=0;Bt<Tr;++Bt)ur=Tt[Bt],isNaN(ur.x)&&(ur.x=un("x",Xr)),isNaN(ur.y)&&(ur.y=un("y",Wr)),isNaN(ur.px)&&(ur.px=ur.x),isNaN(ur.py)&&(ur.py=ur.y);if(R=[],typeof Ne=="function")for(Bt=0;Bt<wr;++Bt)R[Bt]=+Ne.call(this,gt[Bt],Bt);else for(Bt=0;Bt<wr;++Bt)R[Bt]=Ne;if(U=[],typeof qe=="function")for(Bt=0;Bt<wr;++Bt)U[Bt]=+qe.call(this,gt[Bt],Bt);else for(Bt=0;Bt<wr;++Bt)U[Bt]=qe;if(ne=[],typeof tt=="function")for(Bt=0;Bt<Tr;++Bt)ne[Bt]=+tt.call(this,Tt[Bt],Bt);else for(Bt=0;Bt<Tr;++Bt)ne[Bt]=tt;function un(an,Nn){if(!er){for(er=new Array(Tr),wn=0;wn<Tr;++wn)er[wn]=[];for(wn=0;wn<wr;++wn){var Yn=gt[wn];er[Yn.source.index].push(Yn.target),er[Yn.target.index].push(Yn.source)}}for(var sa,Nr=er[Bt],wn=-1,Wn=Nr.length;++wn<Wn;)if(!isNaN(sa=Nr[wn][an]))return sa;return Math.random()*Nn}return le.resume()},le.resume=function(){return le.alpha(.1)},le.stop=function(){return le.alpha(0)},le.drag=function(){if(E||(E=t.behavior.drag().origin(O).on("dragstart.force",Ve).on("drag.force",Ot).on("dragend.force",Ke)),!arguments.length)return E;this.on("mouseover.force",at).on("mouseout.force",dt).call(E)},t.rebind(le,pe,"on")};var ht=20,Mt=1,Wt=1/0;function Jt(oe,E){return t.rebind(oe,E,"sort","children","value"),oe.nodes=oe,oe.links=Pr,oe}function qt(oe,E){for(var z=[oe];(oe=z.pop())!=null;)if(E(oe),(U=oe.children)&&(R=U.length))for(var R,U;--R>=0;)z.push(U[R])}function tr(oe,E){for(var z=[oe],R=[];(oe=z.pop())!=null;)if(R.push(oe),(ne=oe.children)&&(U=ne.length))for(var U,ne,le=-1;++le<U;)z.push(ne[le]);for(;(oe=R.pop())!=null;)E(oe)}function lr(oe){return oe.children}function dr(oe){return oe.value}function gr(oe,E){return E.value-oe.value}function Pr(oe){return t.merge(oe.map(function(E){return(E.children||[]).map(function(z){return{source:E,target:z}})}))}t.layout.hierarchy=function(){var oe=gr,E=lr,z=dr;function R(U){var ne,le=[U],pe=[];for(U.depth=0;(ne=le.pop())!=null;)if(pe.push(ne),(Te=E.call(R,ne,ne.depth))&&(ye=Te.length)){for(var ye,Te,Ne;--ye>=0;)le.push(Ne=Te[ye]),Ne.parent=ne,Ne.depth=ne.depth+1;z&&(ne.value=0),ne.children=Te}else z&&(ne.value=+z.call(R,ne,ne.depth)||0),delete ne.children;return tr(U,function(qe){var tt,yt;oe&&(tt=qe.children)&&tt.sort(oe),z&&(yt=qe.parent)&&(yt.value+=qe.value)}),pe}return R.sort=function(U){return arguments.length?(oe=U,R):oe},R.children=function(U){return arguments.length?(E=U,R):E},R.value=function(U){return arguments.length?(z=U,R):z},R.revalue=function(U){return z&&(qt(U,function(ne){ne.children&&(ne.value=0)}),tr(U,function(ne){var le;ne.children||(ne.value=+z.call(R,ne,ne.depth)||0),(le=ne.parent)&&(le.value+=ne.value)})),U},R},t.layout.partition=function(){var oe=t.layout.hierarchy(),E=[1,1];function z(R,U){var ne=oe.call(this,R,U);return function le(pe,ye,Te,Ne){var qe=pe.children;if(pe.x=ye,pe.y=pe.depth*Ne,pe.dx=Te,pe.dy=Ne,qe&&(tt=qe.length)){var tt,yt,St,_t=-1;for(Te=pe.value?Te/pe.value:0;++_t<tt;)le(yt=qe[_t],ye,St=yt.value*Te,Ne),ye+=St}}(ne[0],0,E[0],E[1]/function le(pe){var ye=pe.children,Te=0;if(ye&&(Ne=ye.length))for(var Ne,qe=-1;++qe<Ne;)Te=Math.max(Te,le(ye[qe]));return 1+Te}(ne[0])),ne}return z.size=function(R){return arguments.length?(E=R,z):E},Jt(z,oe)},t.layout.pie=function(){var oe=Number,E=tn,z=0,R=$t,U=0;function ne(le){var pe,ye=le.length,Te=le.map(function(Dt,Ot){return+oe.call(ne,Dt,Ot)}),Ne=+(typeof z=="function"?z.apply(this,arguments):z),qe=(typeof R=="function"?R.apply(this,arguments):R)-Ne,tt=Math.min(Math.abs(qe)/ye,+(typeof U=="function"?U.apply(this,arguments):U)),yt=tt*(qe<0?-1:1),St=t.sum(Te),_t=St?(qe-ye*yt)/St:0,Tt=t.range(ye),gt=[];return E!=null&&Tt.sort(E===tn?function(Dt,Ot){return Te[Ot]-Te[Dt]}:function(Dt,Ot){return E(le[Dt],le[Ot])}),Tt.forEach(function(Dt){gt[Dt]={data:le[Dt],value:pe=Te[Dt],startAngle:Ne,endAngle:Ne+=pe*_t+yt,padAngle:tt}}),gt}return ne.value=function(le){return arguments.length?(oe=le,ne):oe},ne.sort=function(le){return arguments.length?(E=le,ne):E},ne.startAngle=function(le){return arguments.length?(z=le,ne):z},ne.endAngle=function(le){return arguments.length?(R=le,ne):R},ne.padAngle=function(le){return arguments.length?(U=le,ne):U},ne};var tn={};function pn(oe){return oe.x}function Sn(oe){return oe.y}function In(oe,E,z){oe.y0=E,oe.y=z}t.layout.stack=function(){var oe=O,E=pa,z=_a,R=In,U=pn,ne=Sn;function le(pe,ye){if(!(tt=pe.length))return pe;var Te=pe.map(function(Dt,Ot){return oe.call(le,Dt,Ot)}),Ne=Te.map(function(Dt){return Dt.map(function(Ot,Bt){return[U.call(le,Ot,Bt),ne.call(le,Ot,Bt)]})}),qe=E.call(le,Ne,ye);Te=t.permute(Te,qe),Ne=t.permute(Ne,qe);var tt,yt,St,_t,Tt=z.call(le,Ne,ye),gt=Te[0].length;for(St=0;St<gt;++St)for(R.call(le,Te[0][St],_t=Tt[St],Ne[0][St][1]),yt=1;yt<tt;++yt)R.call(le,Te[yt][St],_t+=Ne[yt-1][St][1],Ne[yt][St][1]);return pe}return le.values=function(pe){return arguments.length?(oe=pe,le):oe},le.order=function(pe){return arguments.length?(E=typeof pe=="function"?pe:Un.get(pe)||pa,le):E},le.offset=function(pe){return arguments.length?(z=typeof pe=="function"?pe:On.get(pe)||_a,le):z},le.x=function(pe){return arguments.length?(U=pe,le):U},le.y=function(pe){return arguments.length?(ne=pe,le):ne},le.out=function(pe){return arguments.length?(R=pe,le):R},le};var Un=t.map({"inside-out":function(oe){var E,z,R=oe.length,U=oe.map(Ra),ne=oe.map(Da),le=t.range(R).sort(function(qe,tt){return U[qe]-U[tt]}),pe=0,ye=0,Te=[],Ne=[];for(E=0;E<R;++E)z=le[E],pe<ye?(pe+=ne[z],Te.push(z)):(ye+=ne[z],Ne.push(z));return Ne.reverse().concat(Te)},reverse:function(oe){return t.range(oe.length).reverse()},default:pa}),On=t.map({silhouette:function(oe){var E,z,R,U=oe.length,ne=oe[0].length,le=[],pe=0,ye=[];for(z=0;z<ne;++z){for(E=0,R=0;E<U;E++)R+=oe[E][z][1];R>pe&&(pe=R),le.push(R)}for(z=0;z<ne;++z)ye[z]=(pe-le[z])/2;return ye},wiggle:function(oe){var E,z,R,U,ne,le,pe,ye,Te,Ne=oe.length,qe=oe[0],tt=qe.length,yt=[];for(yt[0]=ye=Te=0,z=1;z<tt;++z){for(E=0,U=0;E<Ne;++E)U+=oe[E][z][1];for(E=0,ne=0,pe=qe[z][0]-qe[z-1][0];E<Ne;++E){for(R=0,le=(oe[E][z][1]-oe[E][z-1][1])/(2*pe);R<E;++R)le+=(oe[R][z][1]-oe[R][z-1][1])/pe;ne+=le*oe[E][z][1]}yt[z]=ye-=U?ne/U*pe:0,ye<Te&&(Te=ye)}for(z=0;z<tt;++z)yt[z]-=Te;return yt},expand:function(oe){var E,z,R,U=oe.length,ne=oe[0].length,le=1/U,pe=[];for(z=0;z<ne;++z){for(E=0,R=0;E<U;E++)R+=oe[E][z][1];if(R)for(E=0;E<U;E++)oe[E][z][1]/=R;else for(E=0;E<U;E++)oe[E][z][1]=le}for(z=0;z<ne;++z)pe[z]=0;return pe},zero:_a});function pa(oe){return t.range(oe.length)}function _a(oe){for(var E=-1,z=oe[0].length,R=[];++E<z;)R[E]=0;return R}function Ra(oe){for(var E,z=1,R=0,U=oe[0][1],ne=oe.length;z<ne;++z)(E=oe[z][1])>U&&(R=z,U=E);return R}function Da(oe){return oe.reduce(Fa,0)}function Fa(oe,E){return oe+E[1]}function bi(oe,E){return gi(oe,Math.ceil(Math.log(E.length)/Math.LN2+1))}function gi(oe,E){for(var z=-1,R=+oe[0],U=(oe[1]-R)/E,ne=[];++z<=E;)ne[z]=U*z+R;return ne}function ai(oe){return[t.min(oe),t.max(oe)]}function ii(oe,E){return oe.value-E.value}function vi(oe,E){var z=oe._pack_next;oe._pack_next=E,E._pack_prev=oe,E._pack_next=z,z._pack_prev=E}function Ri(oe,E){oe._pack_next=E,E._pack_prev=oe}function Zi(oe,E){var z=E.x-oe.x,R=E.y-oe.y,U=oe.r+E.r;return .999*U*U>z*z+R*R}function Ji(oe){if((E=oe.children)&&(ye=E.length)){var E,z,R,U,ne,le,pe,ye,Te=1/0,Ne=-1/0,qe=1/0,tt=-1/0;if(E.forEach(Ki),(z=E[0]).x=-z.r,z.y=0,Ot(z),ye>1&&((R=E[1]).x=R.r,R.y=0,Ot(R),ye>2))for(Pa(z,R,U=E[2]),Ot(U),vi(z,U),z._pack_prev=U,vi(U,R),R=z._pack_next,ne=3;ne<ye;ne++){Pa(z,R,U=E[ne]);var yt=0,St=1,_t=1;for(le=R._pack_next;le!==R;le=le._pack_next,St++)if(Zi(le,U)){yt=1;break}if(yt==1)for(pe=z._pack_prev;pe!==le._pack_prev&&!Zi(pe,U);pe=pe._pack_prev,_t++);yt?(St<_t||St==_t&&R.r<z.r?Ri(z,R=le):Ri(z=pe,R),ne--):(vi(z,U),R=U,Ot(U))}var Tt=(Te+Ne)/2,gt=(qe+tt)/2,Dt=0;for(ne=0;ne<ye;ne++)(U=E[ne]).x-=Tt,U.y-=gt,Dt=Math.max(Dt,U.r+Math.sqrt(U.x*U.x+U.y*U.y));oe.r=Dt,E.forEach(Qi)}function Ot(Bt){Te=Math.min(Bt.x-Bt.r,Te),Ne=Math.max(Bt.x+Bt.r,Ne),qe=Math.min(Bt.y-Bt.r,qe),tt=Math.max(Bt.y+Bt.r,tt)}}function Ki(oe){oe._pack_next=oe._pack_prev=oe}function Qi(oe){delete oe._pack_next,delete oe._pack_prev}function Pa(oe,E,z){var R=oe.r+z.r,U=E.x-oe.x,ne=E.y-oe.y;if(R&&(U||ne)){var le=E.r+z.r,pe=U*U+ne*ne,ye=.5+((R*=R)-(le*=le))/(2*pe),Te=Math.sqrt(Math.max(0,2*le*(R+pe)-(R-=pe)*R-le*le))/(2*pe);z.x=oe.x+ye*U+Te*ne,z.y=oe.y+ye*ne-Te*U}else z.x=oe.x+R,z.y=oe.y}function ct(oe,E){return oe.parent==E.parent?1:2}function zt(oe){var E=oe.children;return E.length?E[0]:oe.t}function ir(oe){var E,z=oe.children;return(E=z.length)?z[E-1]:oe.t}function jt(oe,E,z){var R=z/(E.i-oe.i);E.c-=R,E.s+=z,oe.c+=R,E.z+=z,E.m+=z}function or(oe,E,z){return oe.a.parent===E.parent?oe.a:z}function Er(oe){return{x:oe.x,y:oe.y,dx:oe.dx,dy:oe.dy}}function Or(oe,E){var z=oe.x+E[3],R=oe.y+E[0],U=oe.dx-E[1]-E[3],ne=oe.dy-E[0]-E[2];return U<0&&(z+=U/2,U=0),ne<0&&(R+=ne/2,ne=0),{x:z,y:R,dx:U,dy:ne}}function qr(oe){var E=oe[0],z=oe[oe.length-1];return E<z?[E,z]:[z,E]}function on(oe){return oe.rangeExtent?oe.rangeExtent():qr(oe.range())}function nn(oe,E,z,R){var U=z(oe[0],oe[1]),ne=R(E[0],E[1]);return function(le){return ne(U(le))}}function dn(oe,E){var z,R=0,U=oe.length-1,ne=oe[R],le=oe[U];return le<ne&&(z=R,R=U,U=z,z=ne,ne=le,le=z),oe[R]=E.floor(ne),oe[U]=E.ceil(le),oe}function bn(oe){return oe?{floor:function(E){return Math.floor(E/oe)*oe},ceil:function(E){return Math.ceil(E/oe)*oe}}:sn}t.layout.histogram=function(){var oe=!0,E=Number,z=ai,R=bi;function U(ne,le){for(var pe,ye,Te=[],Ne=ne.map(E,this),qe=z.call(this,Ne,le),tt=R.call(this,qe,Ne,le),yt=(le=-1,Ne.length),St=tt.length-1,_t=oe?1:1/yt;++le<St;)(pe=Te[le]=[]).dx=tt[le+1]-(pe.x=tt[le]),pe.y=0;if(St>0)for(le=-1;++le<yt;)(ye=Ne[le])>=qe[0]&&ye<=qe[1]&&((pe=Te[t.bisect(tt,ye,1,St)-1]).y+=_t,pe.push(ne[le]));return Te}return U.value=function(ne){return arguments.length?(E=ne,U):E},U.range=function(ne){return arguments.length?(z=xr(ne),U):z},U.bins=function(ne){return arguments.length?(R=typeof ne=="number"?function(le){return gi(le,ne)}:xr(ne),U):R},U.frequency=function(ne){return arguments.length?(oe=!!ne,U):oe},U},t.layout.pack=function(){var oe,E=t.layout.hierarchy().sort(ii),z=0,R=[1,1];function U(ne,le){var pe=E.call(this,ne,le),ye=pe[0],Te=R[0],Ne=R[1],qe=oe==null?Math.sqrt:typeof oe=="function"?oe:function(){return oe};if(ye.x=ye.y=0,tr(ye,function(yt){yt.r=+qe(yt.value)}),tr(ye,Ji),z){var tt=z*(oe?1:Math.max(2*ye.r/Te,2*ye.r/Ne))/2;tr(ye,function(yt){yt.r+=tt}),tr(ye,Ji),tr(ye,function(yt){yt.r-=tt})}return function yt(St,_t,Tt,gt){var Dt=St.children;if(St.x=_t+=gt*St.x,St.y=Tt+=gt*St.y,St.r*=gt,Dt)for(var Ot=-1,Bt=Dt.length;++Ot<Bt;)yt(Dt[Ot],_t,Tt,gt)}(ye,Te/2,Ne/2,oe?1:1/Math.max(2*ye.r/Te,2*ye.r/Ne)),pe}return U.size=function(ne){return arguments.length?(R=ne,U):R},U.radius=function(ne){return arguments.length?(oe=ne==null||typeof ne=="function"?ne:+ne,U):oe},U.padding=function(ne){return arguments.length?(z=+ne,U):z},Jt(U,E)},t.layout.tree=function(){var oe=t.layout.hierarchy().sort(null).value(null),E=ct,z=[1,1],R=null;function U(ye,Te){var Ne=oe.call(this,ye,Te),qe=Ne[0],tt=function(Ot){for(var Bt,er={A:null,children:[Ot]},ur=[er];(Bt=ur.pop())!=null;)for(var Tr,wr=Bt.children,Xr=0,Wr=wr.length;Xr<Wr;++Xr)ur.push((wr[Xr]=Tr={_:wr[Xr],parent:Bt,children:(Tr=wr[Xr].children)&&Tr.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:Xr}).a=Tr);return er.children[0]}(qe);if(tr(tt,ne),tt.parent.m=-tt.z,qt(tt,le),R)qt(qe,pe);else{var yt=qe,St=qe,_t=qe;qt(qe,function(Ot){Ot.x<yt.x&&(yt=Ot),Ot.x>St.x&&(St=Ot),Ot.depth>_t.depth&&(_t=Ot)});var Tt=E(yt,St)/2-yt.x,gt=z[0]/(St.x+E(St,yt)/2+Tt),Dt=z[1]/(_t.depth||1);qt(qe,function(Ot){Ot.x=(Ot.x+Tt)*gt,Ot.y=Ot.depth*Dt})}return Ne}function ne(ye){var Te=ye.children,Ne=ye.parent.children,qe=ye.i?Ne[ye.i-1]:null;if(Te.length){(function(yt){for(var St,_t=0,Tt=0,gt=yt.children,Dt=gt.length;--Dt>=0;)(St=gt[Dt]).z+=_t,St.m+=_t,_t+=St.s+(Tt+=St.c)})(ye);var tt=(Te[0].z+Te[Te.length-1].z)/2;qe?(ye.z=qe.z+E(ye._,qe._),ye.m=ye.z-tt):ye.z=tt}else qe&&(ye.z=qe.z+E(ye._,qe._));ye.parent.A=function(yt,St,_t){if(St){for(var Tt,gt=yt,Dt=yt,Ot=St,Bt=gt.parent.children[0],er=gt.m,ur=Dt.m,Tr=Ot.m,wr=Bt.m;Ot=ir(Ot),gt=zt(gt),Ot&&gt;)Bt=zt(Bt),(Dt=ir(Dt)).a=yt,(Tt=Ot.z+Tr-gt.z-er+E(Ot._,gt._))>0&&(jt(or(Ot,yt,_t),yt,Tt),er+=Tt,ur+=Tt),Tr+=Ot.m,er+=gt.m,wr+=Bt.m,ur+=Dt.m;Ot&&!ir(Dt)&&(Dt.t=Ot,Dt.m+=Tr-ur),gt&&!zt(Bt)&&(Bt.t=gt,Bt.m+=er-wr,_t=yt)}return _t}(ye,qe,ye.parent.A||Ne[0])}function le(ye){ye._.x=ye.z+ye.parent.m,ye.m+=ye.parent.m}function pe(ye){ye.x*=z[0],ye.y=ye.depth*z[1]}return U.separation=function(ye){return arguments.length?(E=ye,U):E},U.size=function(ye){return arguments.length?(R=(z=ye)==null?pe:null,U):R?null:z},U.nodeSize=function(ye){return arguments.length?(R=(z=ye)==null?null:pe,U):R?z:null},Jt(U,oe)},t.layout.cluster=function(){var oe=t.layout.hierarchy().sort(null).value(null),E=ct,z=[1,1],R=!1;function U(ne,le){var pe,ye=oe.call(this,ne,le),Te=ye[0],Ne=0;tr(Te,function(_t){var Tt=_t.children;Tt&&Tt.length?(_t.x=function(gt){return gt.reduce(function(Dt,Ot){return Dt+Ot.x},0)/gt.length}(Tt),_t.y=function(gt){return 1+t.max(gt,function(Dt){return Dt.y})}(Tt)):(_t.x=pe?Ne+=E(_t,pe):0,_t.y=0,pe=_t)});var qe=function _t(Tt){var gt=Tt.children;return gt&&gt.length?_t(gt[0]):Tt}(Te),tt=function _t(Tt){var gt,Dt=Tt.children;return Dt&&(gt=Dt.length)?_t(Dt[gt-1]):Tt}(Te),yt=qe.x-E(qe,tt)/2,St=tt.x+E(tt,qe)/2;return tr(Te,R?function(_t){_t.x=(_t.x-Te.x)*z[0],_t.y=(Te.y-_t.y)*z[1]}:function(_t){_t.x=(_t.x-yt)/(St-yt)*z[0],_t.y=(1-(Te.y?_t.y/Te.y:1))*z[1]}),ye}return U.separation=function(ne){return arguments.length?(E=ne,U):E},U.size=function(ne){return arguments.length?(R=(z=ne)==null,U):R?null:z},U.nodeSize=function(ne){return arguments.length?(R=(z=ne)!=null,U):R?z:null},Jt(U,oe)},t.layout.treemap=function(){var oe,E=t.layout.hierarchy(),z=Math.round,R=[1,1],U=null,ne=Er,le=!1,pe="squarify",ye=.5*(1+Math.sqrt(5));function Te(_t,Tt){for(var gt,Dt,Ot=-1,Bt=_t.length;++Ot<Bt;)Dt=(gt=_t[Ot]).value*(Tt<0?0:Tt),gt.area=isNaN(Dt)||Dt<=0?0:Dt}function Ne(_t){var Tt=_t.children;if(Tt&&Tt.length){var gt,Dt,Ot,Bt=ne(_t),er=[],ur=Tt.slice(),Tr=1/0,wr=pe==="slice"?Bt.dx:pe==="dice"?Bt.dy:pe==="slice-dice"?1&_t.depth?Bt.dy:Bt.dx:Math.min(Bt.dx,Bt.dy);for(Te(ur,Bt.dx*Bt.dy/_t.value),er.area=0;(Ot=ur.length)>0;)er.push(gt=ur[Ot-1]),er.area+=gt.area,pe!=="squarify"||(Dt=tt(er,wr))<=Tr?(ur.pop(),Tr=Dt):(er.area-=er.pop().area,yt(er,wr,Bt,!1),wr=Math.min(Bt.dx,Bt.dy),er.length=er.area=0,Tr=1/0);er.length&&(yt(er,wr,Bt,!0),er.length=er.area=0),Tt.forEach(Ne)}}function qe(_t){var Tt=_t.children;if(Tt&&Tt.length){var gt,Dt=ne(_t),Ot=Tt.slice(),Bt=[];for(Te(Ot,Dt.dx*Dt.dy/_t.value),Bt.area=0;gt=Ot.pop();)Bt.push(gt),Bt.area+=gt.area,gt.z!=null&&(yt(Bt,gt.z?Dt.dx:Dt.dy,Dt,!Ot.length),Bt.length=Bt.area=0);Tt.forEach(qe)}}function tt(_t,Tt){for(var gt,Dt=_t.area,Ot=0,Bt=1/0,er=-1,ur=_t.length;++er<ur;)(gt=_t[er].area)&&(gt<Bt&&(Bt=gt),gt>Ot&&(Ot=gt));return Tt*=Tt,(Dt*=Dt)?Math.max(Tt*Ot*ye/Dt,Dt/(Tt*Bt*ye)):1/0}function yt(_t,Tt,gt,Dt){var Ot,Bt=-1,er=_t.length,ur=gt.x,Tr=gt.y,wr=Tt?z(_t.area/Tt):0;if(Tt==gt.dx){for((Dt||wr>gt.dy)&&(wr=gt.dy);++Bt<er;)(Ot=_t[Bt]).x=ur,Ot.y=Tr,Ot.dy=wr,ur+=Ot.dx=Math.min(gt.x+gt.dx-ur,wr?z(Ot.area/wr):0);Ot.z=!0,Ot.dx+=gt.x+gt.dx-ur,gt.y+=wr,gt.dy-=wr}else{for((Dt||wr>gt.dx)&&(wr=gt.dx);++Bt<er;)(Ot=_t[Bt]).x=ur,Ot.y=Tr,Ot.dx=wr,Tr+=Ot.dy=Math.min(gt.y+gt.dy-Tr,wr?z(Ot.area/wr):0);Ot.z=!1,Ot.dy+=gt.y+gt.dy-Tr,gt.x+=wr,gt.dx-=wr}}function St(_t){var Tt=oe||E(_t),gt=Tt[0];return gt.x=gt.y=0,gt.value?(gt.dx=R[0],gt.dy=R[1]):gt.dx=gt.dy=0,oe&&E.revalue(gt),Te([gt],gt.dx*gt.dy/gt.value),(oe?qe:Ne)(gt),le&&(oe=Tt),Tt}return St.size=function(_t){return arguments.length?(R=_t,St):R},St.padding=function(_t){if(!arguments.length)return U;function Tt(Ot){var Bt=_t.call(St,Ot,Ot.depth);return Bt==null?Er(Ot):Or(Ot,typeof Bt=="number"?[Bt,Bt,Bt,Bt]:Bt)}function gt(Ot){return Or(Ot,_t)}var Dt;return ne=(U=_t)==null?Er:(Dt=typeof _t)=="function"?Tt:(Dt==="number"&&(_t=[_t,_t,_t,_t]),gt),St},St.round=function(_t){return arguments.length?(z=_t?Math.round:Number,St):z!=Number},St.sticky=function(_t){return arguments.length?(le=_t,oe=null,St):le},St.ratio=function(_t){return arguments.length?(ye=_t,St):ye},St.mode=function(_t){return arguments.length?(pe=_t+"",St):pe},Jt(St,E)},t.random={normal:function(oe,E){var z=arguments.length;return z<2&&(E=1),z<1&&(oe=0),function(){var R,U,ne;do ne=(R=2*Math.random()-1)*R+(U=2*Math.random()-1)*U;while(!ne||ne>1);return oe+E*R*Math.sqrt(-2*Math.log(ne)/ne)}},logNormal:function(){var oe=t.random.normal.apply(t,arguments);return function(){return Math.exp(oe())}},bates:function(oe){var E=t.random.irwinHall(oe);return function(){return E()/oe}},irwinHall:function(oe){return function(){for(var E=0,z=0;z<oe;z++)E+=Math.random();return E}}},t.scale={};var sn={floor:O,ceil:O};function _n(oe,E,z,R){var U=[],ne=[],le=0,pe=Math.min(oe.length,E.length)-1;for(oe[pe]<oe[0]&&(oe=oe.slice().reverse(),E=E.slice().reverse());++le<=pe;)U.push(z(oe[le-1],oe[le])),ne.push(R(E[le-1],E[le]));return function(ye){var Te=t.bisect(oe,ye,1,pe)-1;return ne[Te](U[Te](ye))}}function zn(oe,E){return t.rebind(oe,E,"range","rangeRound","interpolate","clamp")}function jn(oe,E){return dn(oe,bn(ea(oe,E)[2])),dn(oe,bn(ea(oe,E)[2])),oe}function ea(oe,E){E==null&&(E=10);var z=qr(oe),R=z[1]-z[0],U=Math.pow(10,Math.floor(Math.log(R/E)/Math.LN10)),ne=E/R*U;return ne<=.15?U*=10:ne<=.35?U*=5:ne<=.75&&(U*=2),z[0]=Math.ceil(z[0]/U)*U,z[1]=Math.floor(z[1]/U)*U+.5*U,z[2]=U,z}function Yr(oe,E){return t.range.apply(t,ea(oe,E))}t.scale.linear=function(){return function oe(E,z,R,U){var ne,le;function pe(){var Te=Math.min(E.length,z.length)>2?_n:nn,Ne=U?So:ds;return ne=Te(E,z,Ne,R),le=Te(z,E,Ne,Di),ye}function ye(Te){return ne(Te)}return ye.invert=function(Te){return le(Te)},ye.domain=function(Te){return arguments.length?(E=Te.map(Number),pe()):E},ye.range=function(Te){return arguments.length?(z=Te,pe()):z},ye.rangeRound=function(Te){return ye.range(Te).interpolate(Uo)},ye.clamp=function(Te){return arguments.length?(U=Te,pe()):U},ye.interpolate=function(Te){return arguments.length?(R=Te,pe()):R},ye.ticks=function(Te){return Yr(E,Te)},ye.tickFormat=function(Te,Ne){return d3_scale_linearTickFormat(E,Te,Ne)},ye.nice=function(Te){return jn(E,Te),pe()},ye.copy=function(){return oe(E,z,R,U)},pe()}([0,1],[0,1],Di,!1)},t.scale.log=function(){return function oe(E,z,R,U){function ne(ye){return(R?Math.log(ye<0?0:ye):-Math.log(ye>0?0:-ye))/Math.log(z)}function le(ye){return R?Math.pow(z,ye):-Math.pow(z,-ye)}function pe(ye){return E(ne(ye))}return pe.invert=function(ye){return le(E.invert(ye))},pe.domain=function(ye){return arguments.length?(R=ye[0]>=0,E.domain((U=ye.map(Number)).map(ne)),pe):U},pe.base=function(ye){return arguments.length?(z=+ye,E.domain(U.map(ne)),pe):z},pe.nice=function(){var ye=dn(U.map(ne),R?Math:Kn);return E.domain(ye),U=ye.map(le),pe},pe.ticks=function(){var ye=qr(U),Te=[],Ne=ye[0],qe=ye[1],tt=Math.floor(ne(Ne)),yt=Math.ceil(ne(qe)),St=z%1?2:z;if(isFinite(yt-tt)){if(R){for(;tt<yt;tt++)for(var _t=1;_t<St;_t++)Te.push(le(tt)*_t);Te.push(le(tt))}else for(Te.push(le(tt));tt++<yt;)for(_t=St-1;_t>0;_t--)Te.push(le(tt)*_t);for(tt=0;Te[tt]<Ne;tt++);for(yt=Te.length;Te[yt-1]>qe;yt--);Te=Te.slice(tt,yt)}return Te},pe.copy=function(){return oe(E.copy(),z,R,U)},zn(pe,E)}(t.scale.linear().domain([0,1]),10,!0,[1,10])};var Kn={floor:function(oe){return-Math.ceil(-oe)},ceil:function(oe){return-Math.floor(-oe)}};function En(oe){return function(E){return E<0?-Math.pow(-E,oe):Math.pow(E,oe)}}t.scale.pow=function(){return function oe(E,z,R){var U=En(z),ne=En(1/z);function le(pe){return E(U(pe))}return le.invert=function(pe){return ne(E.invert(pe))},le.domain=function(pe){return arguments.length?(E.domain((R=pe.map(Number)).map(U)),le):R},le.ticks=function(pe){return Yr(R,pe)},le.tickFormat=function(pe,ye){return d3_scale_linearTickFormat(R,pe,ye)},le.nice=function(pe){return le.domain(jn(R,pe))},le.exponent=function(pe){return arguments.length?(U=En(z=pe),ne=En(1/z),E.domain(R.map(U)),le):z},le.copy=function(){return oe(E.copy(),z,R)},zn(le,E)}(t.scale.linear(),1,[0,1])},t.scale.sqrt=function(){return t.scale.pow().exponent(.5)},t.scale.ordinal=function(){return function oe(E,z){var R,U,ne;function le(ye){return U[((R.get(ye)||(z.t==="range"?R.set(ye,E.push(ye)):NaN))-1)%U.length]}function pe(ye,Te){return t.range(E.length).map(function(Ne){return ye+Te*Ne})}return le.domain=function(ye){if(!arguments.length)return E;E=[],R=new T;for(var Te,Ne=-1,qe=ye.length;++Ne<qe;)R.has(Te=ye[Ne])||R.set(Te,E.push(Te));return le[z.t].apply(le,z.a)},le.range=function(ye){return arguments.length?(U=ye,ne=0,z={t:"range",a:arguments},le):U},le.rangePoints=function(ye,Te){arguments.length<2&&(Te=0);var Ne=ye[0],qe=ye[1],tt=E.length<2?(Ne=(Ne+qe)/2,0):(qe-Ne)/(E.length-1+Te);return U=pe(Ne+tt*Te/2,tt),ne=0,z={t:"rangePoints",a:arguments},le},le.rangeRoundPoints=function(ye,Te){arguments.length<2&&(Te=0);var Ne=ye[0],qe=ye[1],tt=E.length<2?(Ne=qe=Math.round((Ne+qe)/2),0):(qe-Ne)/(E.length-1+Te)|0;return U=pe(Ne+Math.round(tt*Te/2+(qe-Ne-(E.length-1+Te)*tt)/2),tt),ne=0,z={t:"rangeRoundPoints",a:arguments},le},le.rangeBands=function(ye,Te,Ne){arguments.length<2&&(Te=0),arguments.length<3&&(Ne=Te);var qe=ye[1]<ye[0],tt=ye[qe-0],yt=ye[1-qe],St=(yt-tt)/(E.length-Te+2*Ne);return U=pe(tt+St*Ne,St),qe&&U.reverse(),ne=St*(1-Te),z={t:"rangeBands",a:arguments},le},le.rangeRoundBands=function(ye,Te,Ne){arguments.length<2&&(Te=0),arguments.length<3&&(Ne=Te);var qe=ye[1]<ye[0],tt=ye[qe-0],yt=ye[1-qe],St=Math.floor((yt-tt)/(E.length-Te+2*Ne));return U=pe(tt+Math.round((yt-tt-(E.length-Te)*St)/2),St),qe&&U.reverse(),ne=Math.round(St*(1-Te)),z={t:"rangeRoundBands",a:arguments},le},le.rangeBand=function(){return ne},le.rangeExtent=function(){return qr(z.a[0])},le.copy=function(){return oe(E,z)},le.domain(E)}([],{t:"range",a:[[]]})},t.scale.category10=function(){return t.scale.ordinal().range(Bn)},t.scale.category20=function(){return t.scale.ordinal().range(Jn)},t.scale.category20b=function(){return t.scale.ordinal().range(ba)},t.scale.category20c=function(){return t.scale.ordinal().range(Ma)};var Bn=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(Yt),Jn=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(Yt),ba=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(Yt),Ma=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(Yt);function kn(){return 0}t.scale.quantile=function(){return function oe(E,z){var R;function U(){var le=0,pe=z.length;for(R=[];++le<pe;)R[le-1]=t.quantile(E,le/pe);return ne}function ne(le){if(!isNaN(le=+le))return z[t.bisect(R,le)]}return ne.domain=function(le){return arguments.length?(E=le.map(r).filter(n).sort(c),U()):E},ne.range=function(le){return arguments.length?(z=le,U()):z},ne.quantiles=function(){return R},ne.invertExtent=function(le){return(le=z.indexOf(le))<0?[NaN,NaN]:[le>0?R[le-1]:E[0],le<R.length?R[le]:E[E.length-1]]},ne.copy=function(){return oe(E,z)},U()}([],[])},t.scale.quantize=function(){return function oe(E,z,R){var U,ne;function le(ye){return R[Math.max(0,Math.min(ne,Math.floor(U*(ye-E))))]}function pe(){return U=R.length/(z-E),ne=R.length-1,le}return le.domain=function(ye){return arguments.length?(E=+ye[0],z=+ye[ye.length-1],pe()):[E,z]},le.range=function(ye){return arguments.length?(R=ye,pe()):R},le.invertExtent=function(ye){return[ye=(ye=R.indexOf(ye))<0?NaN:ye/U+E,ye+1/U]},le.copy=function(){return oe(E,z,R)},pe()}(0,1,[0,1])},t.scale.threshold=function(){return function oe(E,z){function R(U){if(U<=U)return z[t.bisect(E,U)]}return R.domain=function(U){return arguments.length?(E=U,R):E},R.range=function(U){return arguments.length?(z=U,R):z},R.invertExtent=function(U){return U=z.indexOf(U),[E[U-1],E[U]]},R.copy=function(){return oe(E,z)},R}([.5],[0,1])},t.scale.identity=function(){return function oe(E){function z(R){return+R}return z.invert=z,z.domain=z.range=function(R){return arguments.length?(E=R.map(z),z):E},z.ticks=function(R){return Yr(E,R)},z.tickFormat=function(R,U){return d3_scale_linearTickFormat(E,R,U)},z.copy=function(){return oe(E)},z}([0,1])},t.svg={},t.svg.arc=function(){var oe=ka,E=ha,z=kn,R=Ia,U=Oa,ne=wa,le=Ka;function pe(){var Te=Math.max(0,+oe.apply(this,arguments)),Ne=Math.max(0,+E.apply(this,arguments)),qe=U.apply(this,arguments)-He,tt=ne.apply(this,arguments)-He,yt=Math.abs(tt-qe),St=qe>tt?0:1;if(Ne<Te&&(_t=Ne,Ne=Te,Te=_t),yt>=Ue)return ye(Ne,St)+(Te?ye(Te,1-St):"")+"Z";var _t,Tt,gt,Dt,Ot,Bt,er,ur,Tr,wr,Xr,Wr,un=0,an=0,Nn=[];if((Dt=(+le.apply(this,arguments)||0)/2)&&(gt=R===Ia?Math.sqrt(Te*Te+Ne*Ne):+R.apply(this,arguments),St||(an*=-1),Ne&&(an=_e(gt/Ne*Math.sin(Dt))),Te&&(un=_e(gt/Te*Math.sin(Dt)))),Ne){Ot=Ne*Math.cos(qe+an),Bt=Ne*Math.sin(qe+an),er=Ne*Math.cos(tt-an),ur=Ne*Math.sin(tt-an);var Yn=Math.abs(tt-qe-2*an)<=Qt?0:1;if(an&&Qn(Ot,Bt,er,ur)===St^Yn){var sa=(qe+tt)/2;Ot=Ne*Math.cos(sa),Bt=Ne*Math.sin(sa),er=ur=null}}else Ot=Bt=0;if(Te){Tr=Te*Math.cos(tt-un),wr=Te*Math.sin(tt-un),Xr=Te*Math.cos(qe+un),Wr=Te*Math.sin(qe+un);var Nr=Math.abs(qe-tt+2*un)<=Qt?0:1;if(un&&Qn(Tr,wr,Xr,Wr)===1-St^Nr){var wn=(qe+tt)/2;Tr=Te*Math.cos(wn),wr=Te*Math.sin(wn),Xr=Wr=null}}else Tr=wr=0;if(yt>xt&&(_t=Math.min(Math.abs(Ne-Te)/2,+z.apply(this,arguments)))>.001){Tt=Te<Ne^St?0:1;var Wn=_t,Vn=_t;if(yt<Qt){var $n=Xr==null?[Tr,wr]:er==null?[Ot,Bt]:Ct([Ot,Bt],[Xr,Wr],[er,ur],[Tr,wr]),ca=Ot-$n[0],Ta=Bt-$n[1],Zn=er-$n[0],va=ur-$n[1],da=1/Math.sin(Math.acos((ca*Zn+Ta*va)/(Math.sqrt(ca*ca+Ta*Ta)*Math.sqrt(Zn*Zn+va*va)))/2),Sa=Math.sqrt($n[0]*$n[0]+$n[1]*$n[1]);Vn=Math.min(_t,(Te-Sa)/(da-1)),Wn=Math.min(_t,(Ne-Sa)/(da+1))}if(er!=null){var ya=Ga(Xr==null?[Tr,wr]:[Xr,Wr],[Ot,Bt],Ne,Wn,St),Ea=Ga([er,ur],[Tr,wr],Ne,Wn,St);_t===Wn?Nn.push("M",ya[0],"A",Wn,",",Wn," 0 0,",Tt," ",ya[1],"A",Ne,",",Ne," 0 ",1-St^Qn(ya[1][0],ya[1][1],Ea[1][0],Ea[1][1]),",",St," ",Ea[1],"A",Wn,",",Wn," 0 0,",Tt," ",Ea[0]):Nn.push("M",ya[0],"A",Wn,",",Wn," 0 1,",Tt," ",Ea[0])}else Nn.push("M",Ot,",",Bt);if(Xr!=null){var Ba=Ga([Ot,Bt],[Xr,Wr],Te,-Vn,St),li=Ga([Tr,wr],er==null?[Ot,Bt]:[er,ur],Te,-Vn,St);_t===Vn?Nn.push("L",li[0],"A",Vn,",",Vn," 0 0,",Tt," ",li[1],"A",Te,",",Te," 0 ",St^Qn(li[1][0],li[1][1],Ba[1][0],Ba[1][1]),",",1-St," ",Ba[1],"A",Vn,",",Vn," 0 0,",Tt," ",Ba[0]):Nn.push("L",li[0],"A",Vn,",",Vn," 0 0,",Tt," ",Ba[0])}else Nn.push("L",Tr,",",wr)}else Nn.push("M",Ot,",",Bt),er!=null&&Nn.push("A",Ne,",",Ne," 0 ",Yn,",",St," ",er,",",ur),Nn.push("L",Tr,",",wr),Xr!=null&&Nn.push("A",Te,",",Te," 0 ",Nr,",",1-St," ",Xr,",",Wr);return Nn.push("Z"),Nn.join("")}function ye(Te,Ne){return"M0,"+Te+"A"+Te+","+Te+" 0 1,"+Ne+" 0,"+-Te+"A"+Te+","+Te+" 0 1,"+Ne+" 0,"+Te}return pe.innerRadius=function(Te){return arguments.length?(oe=xr(Te),pe):oe},pe.outerRadius=function(Te){return arguments.length?(E=xr(Te),pe):E},pe.cornerRadius=function(Te){return arguments.length?(z=xr(Te),pe):z},pe.padRadius=function(Te){return arguments.length?(R=Te==Ia?Ia:xr(Te),pe):R},pe.startAngle=function(Te){return arguments.length?(U=xr(Te),pe):U},pe.endAngle=function(Te){return arguments.length?(ne=xr(Te),pe):ne},pe.padAngle=function(Te){return arguments.length?(le=xr(Te),pe):le},pe.centroid=function(){var Te=(+oe.apply(this,arguments)+ +E.apply(this,arguments))/2,Ne=(+U.apply(this,arguments)+ +ne.apply(this,arguments))/2-He;return[Math.cos(Ne)*Te,Math.sin(Ne)*Te]},pe};var Ia="auto";function ka(oe){return oe.innerRadius}function ha(oe){return oe.outerRadius}function Oa(oe){return oe.startAngle}function wa(oe){return oe.endAngle}function Ka(oe){return oe&&oe.padAngle}function Qn(oe,E,z,R){return(oe-z)*E-(E-R)*oe>0?0:1}function Ga(oe,E,z,R,U){var ne=oe[0]-E[0],le=oe[1]-E[1],pe=(U?R:-R)/Math.sqrt(ne*ne+le*le),ye=pe*le,Te=-pe*ne,Ne=oe[0]+ye,qe=oe[1]+Te,tt=E[0]+ye,yt=E[1]+Te,St=(Ne+tt)/2,_t=(qe+yt)/2,Tt=tt-Ne,gt=yt-qe,Dt=Tt*Tt+gt*gt,Ot=z-R,Bt=Ne*yt-tt*qe,er=(gt<0?-1:1)*Math.sqrt(Math.max(0,Ot*Ot*Dt-Bt*Bt)),ur=(Bt*gt-Tt*er)/Dt,Tr=(-Bt*Tt-gt*er)/Dt,wr=(Bt*gt+Tt*er)/Dt,Xr=(-Bt*Tt+gt*er)/Dt,Wr=ur-St,un=Tr-_t,an=wr-St,Nn=Xr-_t;return Wr*Wr+un*un>an*an+Nn*Nn&&(ur=wr,Tr=Xr),[[ur-ye,Tr-Te],[ur*z/Ot,Tr*z/Ot]]}function Fi(){return!0}function Xo(oe){var E=Kr,z=en,R=Fi,U=po,ne=U.key,le=.7;function pe(ye){var Te,Ne=[],qe=[],tt=-1,yt=ye.length,St=xr(E),_t=xr(z);function Tt(){Ne.push("M",U(oe(qe),le))}for(;++tt<yt;)R.call(this,Te=ye[tt],tt)?qe.push([+St.call(this,Te,tt),+_t.call(this,Te,tt)]):qe.length&&(Tt(),qe=[]);return qe.length&&Tt(),Ne.length?Ne.join(""):null}return pe.x=function(ye){return arguments.length?(E=ye,pe):E},pe.y=function(ye){return arguments.length?(z=ye,pe):z},pe.defined=function(ye){return arguments.length?(R=ye,pe):R},pe.interpolate=function(ye){return arguments.length?(ne=typeof ye=="function"?U=ye:(U=Io.get(ye)||po).key,pe):ne},pe.tension=function(ye){return arguments.length?(le=ye,pe):le},pe}t.svg.line=function(){return Xo(O)};var Io=t.map({linear:po,"linear-closed":ma,step:function(oe){for(var E=0,z=oe.length,R=oe[0],U=[R[0],",",R[1]];++E<z;)U.push("H",(R[0]+(R=oe[E])[0])/2,"V",R[1]);return z>1&&U.push("H",R[0]),U.join("")},"step-before":hi,"step-after":mo,basis:Ui,"basis-open":function(oe){if(oe.length<4)return po(oe);for(var E,z=[],R=-1,U=oe.length,ne=[0],le=[0];++R<3;)E=oe[R],ne.push(E[0]),le.push(E[1]);for(z.push($a($i,ne)+","+$a($i,le)),--R;++R<U;)E=oe[R],ne.shift(),ne.push(E[0]),le.shift(),le.push(E[1]),os(z,ne,le);return z.join("")},"basis-closed":function(oe){for(var E,z,R=-1,U=oe.length,ne=U+4,le=[],pe=[];++R<4;)z=oe[R%U],le.push(z[0]),pe.push(z[1]);for(E=[$a($i,le),",",$a($i,pe)],--R;++R<ne;)z=oe[R%U],le.shift(),le.push(z[0]),pe.shift(),pe.push(z[1]),os(E,le,pe);return E.join("")},bundle:function(oe,E){var z=oe.length-1;if(z)for(var R,U,ne=oe[0][0],le=oe[0][1],pe=oe[z][0]-ne,ye=oe[z][1]-le,Te=-1;++Te<=z;)R=oe[Te],U=Te/z,R[0]=E*R[0]+(1-E)*(ne+U*pe),R[1]=E*R[1]+(1-E)*(le+U*ye);return Ui(oe)},cardinal:function(oe,E){return oe.length<3?po(oe):oe[0]+Ya(oe,_i(oe,E))},"cardinal-open":function(oe,E){return oe.length<4?po(oe):oe[1]+Ya(oe.slice(1,-1),_i(oe,E))},"cardinal-closed":function(oe,E){return oe.length<3?ma(oe):oe[0]+Ya((oe.push(oe[0]),oe),_i([oe[oe.length-2]].concat(oe,[oe[1]]),E))},monotone:function(oe){return oe.length<3?po(oe):oe[0]+Ya(oe,function(E){for(var z,R,U,ne,le=[],pe=function(Ne){for(var qe=0,tt=Ne.length-1,yt=[],St=Ne[0],_t=Ne[1],Tt=yt[0]=es(St,_t);++qe<tt;)yt[qe]=(Tt+(Tt=es(St=_t,_t=Ne[qe+1])))/2;return yt[qe]=Tt,yt}(E),ye=-1,Te=E.length-1;++ye<Te;)z=es(E[ye],E[ye+1]),v(z)<xt?pe[ye]=pe[ye+1]=0:(R=pe[ye]/z,U=pe[ye+1]/z,(ne=R*R+U*U)>9&&(ne=3*z/Math.sqrt(ne),pe[ye]=ne*R,pe[ye+1]=ne*U));for(ye=-1;++ye<=Te;)ne=(E[Math.min(Te,ye+1)][0]-E[Math.max(0,ye-1)][0])/(6*(1+pe[ye]*pe[ye])),le.push([ne||0,pe[ye]*ne||0]);return le}(oe))}});function po(oe){return oe.length>1?oe.join("L"):oe+"Z"}function ma(oe){return oe.join("L")+"Z"}function hi(oe){for(var E=0,z=oe.length,R=oe[0],U=[R[0],",",R[1]];++E<z;)U.push("V",(R=oe[E])[1],"H",R[0]);return U.join("")}function mo(oe){for(var E=0,z=oe.length,R=oe[0],U=[R[0],",",R[1]];++E<z;)U.push("H",(R=oe[E])[0],"V",R[1]);return U.join("")}function Ya(oe,E){if(E.length<1||oe.length!=E.length&&oe.length!=E.length+2)return po(oe);var z=oe.length!=E.length,R="",U=oe[0],ne=oe[1],le=E[0],pe=le,ye=1;if(z&&(R+="Q"+(ne[0]-2*le[0]/3)+","+(ne[1]-2*le[1]/3)+","+ne[0]+","+ne[1],U=oe[1],ye=2),E.length>1){pe=E[1],ne=oe[ye],ye++,R+="C"+(U[0]+le[0])+","+(U[1]+le[1])+","+(ne[0]-pe[0])+","+(ne[1]-pe[1])+","+ne[0]+","+ne[1];for(var Te=2;Te<E.length;Te++,ye++)ne=oe[ye],pe=E[Te],R+="S"+(ne[0]-pe[0])+","+(ne[1]-pe[1])+","+ne[0]+","+ne[1]}if(z){var Ne=oe[ye];R+="Q"+(ne[0]+2*pe[0]/3)+","+(ne[1]+2*pe[1]/3)+","+Ne[0]+","+Ne[1]}return R}function _i(oe,E){for(var z,R=[],U=(1-E)/2,ne=oe[0],le=oe[1],pe=1,ye=oe.length;++pe<ye;)z=ne,ne=le,le=oe[pe],R.push([U*(le[0]-z[0]),U*(le[1]-z[1])]);return R}function Ui(oe){if(oe.length<3)return po(oe);var E=1,z=oe.length,R=oe[0],U=R[0],ne=R[1],le=[U,U,U,(R=oe[1])[0]],pe=[ne,ne,ne,R[1]],ye=[U,",",ne,"L",$a($i,le),",",$a($i,pe)];for(oe.push(oe[z-1]);++E<=z;)R=oe[E],le.shift(),le.push(R[0]),pe.shift(),pe.push(R[1]),os(ye,le,pe);return oe.pop(),ye.push("L",R),ye.join("")}function $a(oe,E){return oe[0]*E[0]+oe[1]*E[1]+oe[2]*E[2]+oe[3]*E[3]}Io.forEach(function(oe,E){E.key=oe,E.closed=/-closed$/.test(oe)});var so=[0,2/3,1/3,0],ei=[0,1/3,2/3,0],$i=[0,1/6,2/3,1/6];function os(oe,E,z){oe.push("C",$a(so,E),",",$a(so,z),",",$a(ei,E),",",$a(ei,z),",",$a($i,E),",",$a($i,z))}function es(oe,E){return(E[1]-oe[1])/(E[0]-oe[0])}function Fs(oe){for(var E,z,R,U=-1,ne=oe.length;++U<ne;)z=(E=oe[U])[0],R=E[1]-He,E[0]=z*Math.cos(R),E[1]=z*Math.sin(R);return oe}function Ii(oe){var E=Kr,z=Kr,R=0,U=en,ne=Fi,le=po,pe=le.key,ye=le,Te="L",Ne=.7;function qe(tt){var yt,St,_t,Tt=[],gt=[],Dt=[],Ot=-1,Bt=tt.length,er=xr(E),ur=xr(R),Tr=E===z?function(){return St}:xr(z),wr=R===U?function(){return _t}:xr(U);function Xr(){Tt.push("M",le(oe(Dt),Ne),Te,ye(oe(gt.reverse()),Ne),"Z")}for(;++Ot<Bt;)ne.call(this,yt=tt[Ot],Ot)?(gt.push([St=+er.call(this,yt,Ot),_t=+ur.call(this,yt,Ot)]),Dt.push([+Tr.call(this,yt,Ot),+wr.call(this,yt,Ot)])):gt.length&&(Xr(),gt=[],Dt=[]);return gt.length&&Xr(),Tt.length?Tt.join(""):null}return qe.x=function(tt){return arguments.length?(E=z=tt,qe):z},qe.x0=function(tt){return arguments.length?(E=tt,qe):E},qe.x1=function(tt){return arguments.length?(z=tt,qe):z},qe.y=function(tt){return arguments.length?(R=U=tt,qe):U},qe.y0=function(tt){return arguments.length?(R=tt,qe):R},qe.y1=function(tt){return arguments.length?(U=tt,qe):U},qe.defined=function(tt){return arguments.length?(ne=tt,qe):ne},qe.interpolate=function(tt){return arguments.length?(pe=typeof tt=="function"?le=tt:(le=Io.get(tt)||po).key,ye=le.reverse||le,Te=le.closed?"M":"L",qe):pe},qe.tension=function(tt){return arguments.length?(Ne=tt,qe):Ne},qe}function Bs(oe){return oe.source}function Oi(oe){return oe.target}function ts(oe){return oe.radius}function oa(oe){return[oe.x,oe.y]}function ga(oe){return function(){var E=oe.apply(this,arguments),z=E[0],R=E[1]-He;return[z*Math.cos(R),z*Math.sin(R)]}}function Ns(){return 64}function js(){return"circle"}function rs(oe){var E=Math.sqrt(oe/Qt);return"M0,"+E+"A"+E+","+E+" 0 1,1 0,"+-E+"A"+E+","+E+" 0 1,1 0,"+E+"Z"}t.svg.line.radial=function(){var oe=Xo(Fs);return oe.radius=oe.x,delete oe.x,oe.angle=oe.y,delete oe.y,oe},hi.reverse=mo,mo.reverse=hi,t.svg.area=function(){return Ii(O)},t.svg.area.radial=function(){var oe=Ii(Fs);return oe.radius=oe.x,delete oe.x,oe.innerRadius=oe.x0,delete oe.x0,oe.outerRadius=oe.x1,delete oe.x1,oe.angle=oe.y,delete oe.y,oe.startAngle=oe.y0,delete oe.y0,oe.endAngle=oe.y1,delete oe.y1,oe},t.svg.chord=function(){var oe=Bs,E=Oi,z=ts,R=Oa,U=wa;function ne(Te,Ne){var qe,tt,yt=le(this,oe,Te,Ne),St=le(this,E,Te,Ne);return"M"+yt.p0+pe(yt.r,yt.p1,yt.a1-yt.a0)+(tt=St,((qe=yt).a0==tt.a0&&qe.a1==tt.a1?ye(yt.r,yt.p1,yt.r,yt.p0):ye(yt.r,yt.p1,St.r,St.p0)+pe(St.r,St.p1,St.a1-St.a0)+ye(St.r,St.p1,yt.r,yt.p0))+"Z")}function le(Te,Ne,qe,tt){var yt=Ne.call(Te,qe,tt),St=z.call(Te,yt,tt),_t=R.call(Te,yt,tt)-He,Tt=U.call(Te,yt,tt)-He;return{r:St,a0:_t,a1:Tt,p0:[St*Math.cos(_t),St*Math.sin(_t)],p1:[St*Math.cos(Tt),St*Math.sin(Tt)]}}function pe(Te,Ne,qe){return"A"+Te+","+Te+" 0 "+ +(qe>Qt)+",1 "+Ne}function ye(Te,Ne,qe,tt){return"Q 0,0 "+tt}return ne.radius=function(Te){return arguments.length?(z=xr(Te),ne):z},ne.source=function(Te){return arguments.length?(oe=xr(Te),ne):oe},ne.target=function(Te){return arguments.length?(E=xr(Te),ne):E},ne.startAngle=function(Te){return arguments.length?(R=xr(Te),ne):R},ne.endAngle=function(Te){return arguments.length?(U=xr(Te),ne):U},ne},t.svg.diagonal=function(){var oe=Bs,E=Oi,z=oa;function R(U,ne){var le=oe.call(this,U,ne),pe=E.call(this,U,ne),ye=(le.y+pe.y)/2,Te=[le,{x:le.x,y:ye},{x:pe.x,y:ye},pe];return"M"+(Te=Te.map(z))[0]+"C"+Te[1]+" "+Te[2]+" "+Te[3]}return R.source=function(U){return arguments.length?(oe=xr(U),R):oe},R.target=function(U){return arguments.length?(E=xr(U),R):E},R.projection=function(U){return arguments.length?(z=U,R):z},R},t.svg.diagonal.radial=function(){var oe=t.svg.diagonal(),E=oa,z=oe.projection;return oe.projection=function(R){return arguments.length?z(ga(E=R)):E},oe},t.svg.symbol=function(){var oe=js,E=Ns;function z(R,U){return(Eo.get(oe.call(this,R,U))||rs)(E.call(this,R,U))}return z.type=function(R){return arguments.length?(oe=xr(R),z):oe},z.size=function(R){return arguments.length?(E=xr(R),z):E},z};var Eo=t.map({circle:rs,cross:function(oe){var E=Math.sqrt(oe/5)/2;return"M"+-3*E+","+-E+"H"+-E+"V"+-3*E+"H"+E+"V"+-E+"H"+3*E+"V"+E+"H"+E+"V"+3*E+"H"+-E+"V"+E+"H"+-3*E+"Z"},diamond:function(oe){var E=Math.sqrt(oe/(2*$s)),z=E*$s;return"M0,"+-E+"L"+z+",0 0,"+E+" "+-z+",0Z"},square:function(oe){var E=Math.sqrt(oe)/2;return"M"+-E+","+-E+"L"+E+","+-E+" "+E+","+E+" "+-E+","+E+"Z"},"triangle-down":function(oe){var E=Math.sqrt(oe/qo),z=E*qo/2;return"M0,"+z+"L"+E+","+-z+" "+-E+","+-z+"Z"},"triangle-up":function(oe){var E=Math.sqrt(oe/qo),z=E*qo/2;return"M0,"+-z+"L"+E+","+z+" "+-E+","+z+"Z"}});t.svg.symbolTypes=Eo.keys();var qo=Math.sqrt(3),$s=Math.tan(30*Be);te.transition=function(oe){for(var E,z,R=ms||++gs,U=Es(oe),ne=[],le=ss||{time:Date.now(),ease:xs,delay:0,duration:250},pe=-1,ye=this.length;++pe<ye;){ne.push(E=[]);for(var Te=this[pe],Ne=-1,qe=Te.length;++Ne<qe;)(z=Te[Ne])&&ls(z,Ne,U,R,le),E.push(z)}return ti(ne,U,R)},te.interrupt=function(oe){return this.each(oe==null?Ms:Wa(Es(oe)))};var Ms=Wa(Es());function Wa(oe){return function(){var E,z,R;(E=this[oe])&&(R=E[z=E.active])&&(R.timer.c=null,R.timer.t=NaN,--E.count?delete E[z]:delete this[oe],E.active+=.5,R.event&&R.event.interrupt.call(this,this.__data__,R.index))}}function ti(oe,E,z){return B(oe,Ei),oe.namespace=E,oe.id=z,oe}var ms,ss,Ei=[],gs=0;function Ss(oe,E,z,R){var U=oe.id,ne=oe.namespace;return Fe(oe,typeof z=="function"?function(le,pe,ye){le[ne][U].tween.set(E,R(z.call(le,le.__data__,pe,ye)))}:(z=R(z),function(le){le[ne][U].tween.set(E,z)}))}function bs(oe){return oe==null&&(oe=""),function(){this.textContent=oe}}function Es(oe){return oe==null?"__transition__":"__transition_"+oe+"__"}function ls(oe,E,z,R,U){var ne,le,pe,ye,Te,Ne=oe[z]||(oe[z]={active:0,count:0}),qe=Ne[R];function tt(St){var _t=Ne.active,Tt=Ne[_t];for(var gt in Tt&&(Tt.timer.c=null,Tt.timer.t=NaN,--Ne.count,delete Ne[_t],Tt.event&&Tt.event.interrupt.call(oe,oe.__data__,Tt.index)),Ne)if(+gt<R){var Dt=Ne[gt];Dt.timer.c=null,Dt.timer.t=NaN,--Ne.count,delete Ne[gt]}le.c=yt,Fr(function(){return le.c&&yt(St||1)&&(le.c=null,le.t=NaN),1},0,ne),Ne.active=R,qe.event&&qe.event.start.call(oe,oe.__data__,E),Te=[],qe.tween.forEach(function(Ot,Bt){(Bt=Bt.call(oe,oe.__data__,E))&&Te.push(Bt)}),ye=qe.ease,pe=qe.duration}function yt(St){for(var _t=St/pe,Tt=ye(_t),gt=Te.length;gt>0;)Te[--gt].call(oe,Tt);if(_t>=1)return qe.event&&qe.event.end.call(oe,oe.__data__,E),--Ne.count?delete Ne[R]:delete oe[z],1}qe||(ne=U.time,le=Fr(function(St){var _t=qe.delay;if(le.t=_t+ne,_t<=St)return tt(St-_t);le.c=tt},0,ne),qe=Ne[R]={tween:new T,time:ne,timer:le,delay:U.delay,duration:U.duration,ease:U.ease,index:E},U=null,++Ne.count)}Ei.call=te.call,Ei.empty=te.empty,Ei.node=te.node,Ei.size=te.size,t.transition=function(oe,E){return oe&&oe.transition?ms?oe.transition(E):oe:t.selection().transition(oe)},t.transition.prototype=Ei,Ei.select=function(oe){var E,z,R,U=this.id,ne=this.namespace,le=[];oe=ie(oe);for(var pe=-1,ye=this.length;++pe<ye;){le.push(E=[]);for(var Te=this[pe],Ne=-1,qe=Te.length;++Ne<qe;)(R=Te[Ne])&&(z=oe.call(R,R.__data__,Ne,pe))?("__data__"in R&&(z.__data__=R.__data__),ls(z,Ne,ne,U,R[ne][U]),E.push(z)):E.push(null)}return ti(le,ne,U)},Ei.selectAll=function(oe){var E,z,R,U,ne,le=this.id,pe=this.namespace,ye=[];oe=ae(oe);for(var Te=-1,Ne=this.length;++Te<Ne;)for(var qe=this[Te],tt=-1,yt=qe.length;++tt<yt;)if(R=qe[tt]){ne=R[pe][le],z=oe.call(R,R.__data__,tt,Te),ye.push(E=[]);for(var St=-1,_t=z.length;++St<_t;)(U=z[St])&&ls(U,St,pe,le,ne),E.push(U)}return ti(ye,pe,le)},Ei.filter=function(oe){var E,z,R=[];typeof oe!="function"&&(oe=Se(oe));for(var U=0,ne=this.length;U<ne;U++){R.push(E=[]);for(var le,pe=0,ye=(le=this[U]).length;pe<ye;pe++)(z=le[pe])&&oe.call(z,z.__data__,pe,U)&&E.push(z)}return ti(R,this.namespace,this.id)},Ei.tween=function(oe,E){var z=this.id,R=this.namespace;return arguments.length<2?this.node()[R][z].tween.get(oe):Fe(this,E==null?function(U){U[R][z].tween.remove(oe)}:function(U){U[R][z].tween.set(oe,E)})},Ei.attr=function(oe,E){if(arguments.length<2){for(E in oe)this.attr(E,oe[E]);return this}var z=oe=="transform"?Ho:Di,R=t.ns.qualify(oe);function U(){this.removeAttribute(R)}function ne(){this.removeAttributeNS(R.space,R.local)}function le(ye){return ye==null?U:(ye+="",function(){var Te,Ne=this.getAttribute(R);return Ne!==ye&&(Te=z(Ne,ye),function(qe){this.setAttribute(R,Te(qe))})})}function pe(ye){return ye==null?ne:(ye+="",function(){var Te,Ne=this.getAttributeNS(R.space,R.local);return Ne!==ye&&(Te=z(Ne,ye),function(qe){this.setAttributeNS(R.space,R.local,Te(qe))})})}return Ss(this,"attr."+oe,E,R.local?pe:le)},Ei.attrTween=function(oe,E){var z=t.ns.qualify(oe);return this.tween("attr."+oe,z.local?function(R,U){var ne=E.call(this,R,U,this.getAttributeNS(z.space,z.local));return ne&&function(le){this.setAttributeNS(z.space,z.local,ne(le))}}:function(R,U){var ne=E.call(this,R,U,this.getAttribute(z));return ne&&function(le){this.setAttribute(z,ne(le))}})},Ei.style=function(oe,E,z){var R=arguments.length;if(R<3){if(typeof oe!="string"){for(z in R<2&&(E=""),oe)this.style(z,oe[z],E);return this}z=""}function U(){this.style.removeProperty(oe)}function ne(le){return le==null?U:(le+="",function(){var pe,ye=f(this).getComputedStyle(this,null).getPropertyValue(oe);return ye!==le&&(pe=Di(ye,le),function(Te){this.style.setProperty(oe,pe(Te),z)})})}return Ss(this,"style."+oe,E,ne)},Ei.styleTween=function(oe,E,z){function R(U,ne){var le=E.call(this,U,ne,f(this).getComputedStyle(this,null).getPropertyValue(oe));return le&&function(pe){this.style.setProperty(oe,le(pe),z)}}return arguments.length<3&&(z=""),this.tween("style."+oe,R)},Ei.text=function(oe){return Ss(this,"text",oe,bs)},Ei.remove=function(){var oe=this.namespace;return this.each("end.transition",function(){var E;this[oe].count<2&&(E=this.parentNode)&&E.removeChild(this)})},Ei.ease=function(oe){var E=this.id,z=this.namespace;return arguments.length<1?this.node()[z][E].ease:(typeof oe!="function"&&(oe=t.ease.apply(t,arguments)),Fe(this,function(R){R[z][E].ease=oe}))},Ei.delay=function(oe){var E=this.id,z=this.namespace;return arguments.length<1?this.node()[z][E].delay:Fe(this,typeof oe=="function"?function(R,U,ne){R[z][E].delay=+oe.call(R,R.__data__,U,ne)}:(oe=+oe,function(R){R[z][E].delay=oe}))},Ei.duration=function(oe){var E=this.id,z=this.namespace;return arguments.length<1?this.node()[z][E].duration:Fe(this,typeof oe=="function"?function(R,U,ne){R[z][E].duration=Math.max(1,oe.call(R,R.__data__,U,ne))}:(oe=Math.max(1,oe),function(R){R[z][E].duration=oe}))},Ei.each=function(oe,E){var z=this.id,R=this.namespace;if(arguments.length<2){var U=ss,ne=ms;try{ms=z,Fe(this,function(le,pe,ye){ss=le[R][z],oe.call(le,le.__data__,pe,ye)})}finally{ss=U,ms=ne}}else Fe(this,function(le){var pe=le[R][z];(pe.event||(pe.event=t.dispatch("start","end","interrupt"))).on(oe,E)});return this},Ei.transition=function(){for(var oe,E,z,R=this.id,U=++gs,ne=this.namespace,le=[],pe=0,ye=this.length;pe<ye;pe++){le.push(oe=[]);for(var Te,Ne=0,qe=(Te=this[pe]).length;Ne<qe;Ne++)(E=Te[Ne])&&ls(E,Ne,ne,U,{time:(z=E[ne][R]).time,ease:z.ease,delay:z.delay+z.duration,duration:z.duration}),oe.push(E)}return ti(le,ne,U)},t.svg.axis=function(){var oe,E=t.scale.linear(),z=el,R=6,U=6,ne=3,le=[10],pe=null;function ye(Te){Te.each(function(){var Ne,qe=t.select(this),tt=this.__chart__||E,yt=this.__chart__=E.copy(),St=pe==null?yt.ticks?yt.ticks.apply(yt,le):yt.domain():pe,_t=oe==null?yt.tickFormat?yt.tickFormat.apply(yt,le):O:oe,Tt=qe.selectAll(".tick").data(St,yt),gt=Tt.enter().insert("g",".domain").attr("class","tick").style("opacity",xt),Dt=t.transition(Tt.exit()).style("opacity",xt).remove(),Ot=t.transition(Tt.order()).style("opacity",1),Bt=Math.max(R,0)+ne,er=on(yt),ur=qe.selectAll(".domain").data([0]),Tr=(ur.enter().append("path").attr("class","domain"),t.transition(ur));gt.append("line"),gt.append("text");var wr,Xr,Wr,un,an=gt.select("line"),Nn=Ot.select("line"),Yn=Tt.select("text").text(_t),sa=gt.select("text"),Nr=Ot.select("text"),wn=z==="top"||z==="left"?-1:1;if(z==="bottom"||z==="top"?(Ne=vs,wr="x",Wr="y",Xr="x2",un="y2",Yn.attr("dy",wn<0?"0em":".71em").style("text-anchor","middle"),Tr.attr("d","M"+er[0]+","+wn*U+"V0H"+er[1]+"V"+wn*U)):(Ne=tl,wr="y",Wr="x",Xr="y2",un="x2",Yn.attr("dy",".32em").style("text-anchor",wn<0?"end":"start"),Tr.attr("d","M"+wn*U+","+er[0]+"H0V"+er[1]+"H"+wn*U)),an.attr(un,wn*R),sa.attr(Wr,wn*Bt),Nn.attr(Xr,0).attr(un,wn*R),Nr.attr(wr,0).attr(Wr,wn*Bt),yt.rangeBand){var Wn=yt,Vn=Wn.rangeBand()/2;tt=yt=function($n){return Wn($n)+Vn}}else tt.rangeBand?tt=yt:Dt.call(Ne,yt,tt);gt.call(Ne,tt,yt),Ot.call(Ne,yt,yt)})}return ye.scale=function(Te){return arguments.length?(E=Te,ye):E},ye.orient=function(Te){return arguments.length?(z=Te in cl?Te+"":el,ye):z},ye.ticks=function(){return arguments.length?(le=g(arguments),ye):le},ye.tickValues=function(Te){return arguments.length?(pe=Te,ye):pe},ye.tickFormat=function(Te){return arguments.length?(oe=Te,ye):oe},ye.tickSize=function(Te){var Ne=arguments.length;return Ne?(R=+Te,U=+arguments[Ne-1],ye):R},ye.innerTickSize=function(Te){return arguments.length?(R=+Te,ye):R},ye.outerTickSize=function(Te){return arguments.length?(U=+Te,ye):U},ye.tickPadding=function(Te){return arguments.length?(ne=+Te,ye):ne},ye.tickSubdivide=function(){return arguments.length&&ye},ye};var el="bottom",cl={top:1,right:1,bottom:1,left:1};function vs(oe,E,z){oe.attr("transform",function(R){var U=E(R);return"translate("+(isFinite(U)?U:z(R))+",0)"})}function tl(oe,E,z){oe.attr("transform",function(R){var U=E(R);return"translate(0,"+(isFinite(U)?U:z(R))+")"})}t.svg.brush=function(){var oe,E,z=K(Ne,"brushstart","brush","brushend"),R=null,U=null,ne=[0,0],le=[0,0],pe=!0,ye=!0,Te=eo[0];function Ne(_t){_t.each(function(){var Tt=t.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",St).on("touchstart.brush",St),gt=Tt.selectAll(".background").data([0]);gt.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),Tt.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var Dt=Tt.selectAll(".resize").data(Te,O);Dt.exit().remove(),Dt.enter().append("g").attr("class",function(ur){return"resize "+ur}).style("cursor",function(ur){return Ls[ur]}).append("rect").attr("x",function(ur){return/[ew]$/.test(ur)?-3:null}).attr("y",function(ur){return/^[ns]/.test(ur)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),Dt.style("display",Ne.empty()?"none":null);var Ot,Bt=t.transition(Tt),er=t.transition(gt);R&&(Ot=on(R),er.attr("x",Ot[0]).attr("width",Ot[1]-Ot[0]),tt(Bt)),U&&(Ot=on(U),er.attr("y",Ot[0]).attr("height",Ot[1]-Ot[0]),yt(Bt)),qe(Bt)})}function qe(_t){_t.selectAll(".resize").attr("transform",function(Tt){return"translate("+ne[+/e$/.test(Tt)]+","+le[+/^s/.test(Tt)]+")"})}function tt(_t){_t.select(".extent").attr("x",ne[0]),_t.selectAll(".extent,.n>rect,.s>rect").attr("width",ne[1]-ne[0])}function yt(_t){_t.select(".extent").attr("y",le[0]),_t.selectAll(".extent,.e>rect,.w>rect").attr("height",le[1]-le[0])}function St(){var _t,Tt,gt=this,Dt=t.select(t.event.target),Ot=z.of(gt,arguments),Bt=t.select(gt),er=Dt.datum(),ur=!/^(n|s)$/.test(er)&&R,Tr=!/^(e|w)$/.test(er)&&U,wr=Dt.classed("extent"),Xr=Lt(gt),Wr=t.mouse(gt),un=t.select(f(gt)).on("keydown.brush",Yn).on("keyup.brush",sa);if(t.event.changedTouches?un.on("touchmove.brush",Nr).on("touchend.brush",Wn):un.on("mousemove.brush",Nr).on("mouseup.brush",Wn),Bt.interrupt().selectAll("*").interrupt(),wr)Wr[0]=ne[0]-Wr[0],Wr[1]=le[0]-Wr[1];else if(er){var an=+/w$/.test(er),Nn=+/^n/.test(er);Tt=[ne[1-an]-Wr[0],le[1-Nn]-Wr[1]],Wr[0]=ne[an],Wr[1]=le[Nn]}else t.event.altKey&&(_t=Wr.slice());function Yn(){t.event.keyCode==32&&(wr||(_t=null,Wr[0]-=ne[1],Wr[1]-=le[1],wr=2),G())}function sa(){t.event.keyCode==32&&wr==2&&(Wr[0]+=ne[1],Wr[1]+=le[1],wr=0,G())}function Nr(){var Vn=t.mouse(gt),$n=!1;Tt&&(Vn[0]+=Tt[0],Vn[1]+=Tt[1]),wr||(t.event.altKey?(_t||(_t=[(ne[0]+ne[1])/2,(le[0]+le[1])/2]),Wr[0]=ne[+(Vn[0]<_t[0])],Wr[1]=le[+(Vn[1]<_t[1])]):_t=null),ur&&wn(Vn,R,0)&&(tt(Bt),$n=!0),Tr&&wn(Vn,U,1)&&(yt(Bt),$n=!0),$n&&(qe(Bt),Ot({type:"brush",mode:wr?"move":"resize"}))}function wn(Vn,$n,ca){var Ta,Zn,va=on($n),da=va[0],Sa=va[1],ya=Wr[ca],Ea=ca?le:ne,Ba=Ea[1]-Ea[0];if(wr&&(da-=ya,Sa-=Ba+ya),Ta=(ca?ye:pe)?Math.max(da,Math.min(Sa,Vn[ca])):Vn[ca],wr?Zn=(Ta+=ya)+Ba:(_t&&(ya=Math.max(da,Math.min(Sa,2*_t[ca]-Ta))),ya<Ta?(Zn=Ta,Ta=ya):Zn=ya),Ea[0]!=Ta||Ea[1]!=Zn)return ca?E=null:oe=null,Ea[0]=Ta,Ea[1]=Zn,!0}function Wn(){Nr(),Bt.style("pointer-events","all").selectAll(".resize").style("display",Ne.empty()?"none":null),t.select("body").style("cursor",null),un.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),Xr(),Ot({type:"brushend"})}Bt.style("pointer-events","none").selectAll(".resize").style("display",null),t.select("body").style("cursor",Dt.style("cursor")),Ot({type:"brushstart"}),Nr()}return Ne.event=function(_t){_t.each(function(){var Tt=z.of(this,arguments),gt={x:ne,y:le,i:oe,j:E},Dt=this.__chart__||gt;this.__chart__=gt,ms?t.select(this).transition().each("start.brush",function(){oe=Dt.i,E=Dt.j,ne=Dt.x,le=Dt.y,Tt({type:"brushstart"})}).tween("brush:brush",function(){var Ot=fi(ne,gt.x),Bt=fi(le,gt.y);return oe=E=null,function(er){ne=gt.x=Ot(er),le=gt.y=Bt(er),Tt({type:"brush",mode:"resize"})}}).each("end.brush",function(){oe=gt.i,E=gt.j,Tt({type:"brush",mode:"resize"}),Tt({type:"brushend"})}):(Tt({type:"brushstart"}),Tt({type:"brush",mode:"resize"}),Tt({type:"brushend"}))})},Ne.x=function(_t){return arguments.length?(Te=eo[!(R=_t)<<1|!U],Ne):R},Ne.y=function(_t){return arguments.length?(Te=eo[!R<<1|!(U=_t)],Ne):U},Ne.clamp=function(_t){return arguments.length?(R&&U?(pe=!!_t[0],ye=!!_t[1]):R?pe=!!_t:U&&(ye=!!_t),Ne):R&&U?[pe,ye]:R?pe:U?ye:null},Ne.extent=function(_t){var Tt,gt,Dt,Ot,Bt;return arguments.length?(R&&(Tt=_t[0],gt=_t[1],U&&(Tt=Tt[0],gt=gt[0]),oe=[Tt,gt],R.invert&&(Tt=R(Tt),gt=R(gt)),gt<Tt&&(Bt=Tt,Tt=gt,gt=Bt),Tt==ne[0]&&gt==ne[1]||(ne=[Tt,gt])),U&&(Dt=_t[0],Ot=_t[1],R&&(Dt=Dt[1],Ot=Ot[1]),E=[Dt,Ot],U.invert&&(Dt=U(Dt),Ot=U(Ot)),Ot<Dt&&(Bt=Dt,Dt=Ot,Ot=Bt),Dt==le[0]&&Ot==le[1]||(le=[Dt,Ot])),Ne):(R&&(oe?(Tt=oe[0],gt=oe[1]):(Tt=ne[0],gt=ne[1],R.invert&&(Tt=R.invert(Tt),gt=R.invert(gt)),gt<Tt&&(Bt=Tt,Tt=gt,gt=Bt))),U&&(E?(Dt=E[0],Ot=E[1]):(Dt=le[0],Ot=le[1],U.invert&&(Dt=U.invert(Dt),Ot=U.invert(Ot)),Ot<Dt&&(Bt=Dt,Dt=Ot,Ot=Bt))),R&&U?[[Tt,Dt],[gt,Ot]]:R?[Tt,gt]:U&&[Dt,Ot])},Ne.clear=function(){return Ne.empty()||(ne=[0,0],le=[0,0],oe=E=null),Ne},Ne.empty=function(){return!!R&&ne[0]==ne[1]||!!U&&le[0]==le[1]},t.rebind(Ne,z,"on")};var Ls={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},eo=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];function ul(oe){return JSON.parse(oe.responseText)}function fl(oe){var E=p.createRange();return E.selectNode(p.body),E.createContextualFragment(oe.responseText)}t.text=Br(function(oe){return oe.responseText}),t.json=function(oe,E){return Jr(oe,"application/json",ul,E)},t.html=function(oe,E){return Jr(oe,"text/html",fl,E)},t.xml=Br(function(oe){return oe.responseXML}),typeof N=="object"&&N.exports?N.exports=t:this.d3=t}).apply(self)},{}],59:[function(h,N,H){N.exports=h("./quad")},{"./quad":60}],60:[function(h,N,H){var t=h("binary-search-bounds"),m=h("clamp"),g=h("parse-rect"),p=h("array-bounds"),e=h("pick-by-alias"),f=h("defined"),u=h("flatten-vertex-data"),i=h("is-obj"),s=h("dtype"),o=h("math-log2");function a(c,r){for(var n=r[0],d=r[1],l=1/(r[2]-n),y=1/(r[3]-d),v=new Array(c.length),_=0,x=c.length/2;_<x;_++)v[2*_]=m((c[2*_]-n)*l,0,1),v[2*_+1]=m((c[2*_+1]-d)*y,0,1);return v}N.exports=function(c,r){r||(r={}),c=u(c,"float64"),r=e(r,{bounds:"range bounds dataBox databox",maxDepth:"depth maxDepth maxdepth level maxLevel maxlevel levels",dtype:"type dtype format out dst output destination"});var n=f(r.maxDepth,255),d=f(r.bounds,p(c,2));d[0]===d[2]&&d[2]++,d[1]===d[3]&&d[3]++;var l,y=a(c,d),v=c.length>>>1;r.dtype||(r.dtype="array"),typeof r.dtype=="string"?l=new(s(r.dtype))(v):r.dtype&&(l=r.dtype,Array.isArray(l)&&(l.length=v));for(var _=0;_<v;++_)l[_]=_;var x=[],T=[],A=[],S=[];(function j(W,Z,Q,X,G,Y){if(!X.length)return null;var K=x[G]||(x[G]=[]),D=A[G]||(A[G]=[]),B=T[G]||(T[G]=[]),q=K.length;if(++G>n||Y>1073741824){for(var ee=0;ee<X.length;ee++)K.push(X[ee]),D.push(Y),B.push(null,null,null,null);return q}if(K.push(X[0]),D.push(Y),X.length<=1)return B.push(null,null,null,null),q;for(var J=.5*Q,$=W+J,te=Z+J,ie=[],ae=[],he=[],se=[],de=1,ce=X.length;de<ce;de++){var ve=X[de],ke=y[2*ve],Ee=y[2*ve+1];ke<$?Ee<te?ie.push(ve):ae.push(ve):Ee<te?he.push(ve):se.push(ve)}return Y<<=2,B.push(j(W,Z,J,ie,G,Y),j(W,te,J,ae,G,Y+1),j($,Z,J,he,G,Y+2),j($,te,J,se,G,Y+3)),q})(0,0,1,l,0,1);for(var w=0,L=0;L<x.length;L++){var k=x[L];if(l.set)l.set(k,w);else for(var C=0,M=k.length;C<M;C++)l[C+w]=k[C];var P=w+x[L].length;S[L]=[w,P],w=P}return l.range=function(){for(var j,W=[],Z=arguments.length;Z--;)W[Z]=arguments[Z];if(i(W[W.length-1])){var Q=W.pop();W.length||Q.x==null&&Q.l==null&&Q.left==null||(W=[Q],j={}),j=e(Q,{level:"level maxLevel",d:"d diam diameter r radius px pxSize pixel pixelSize maxD size minSize",lod:"lod details ranges offsets"})}else j={};W.length||(W=d);var X=g.apply(void 0,W),G=[Math.min(X.x,X.x+X.width),Math.min(X.y,X.y+X.height),Math.max(X.x,X.x+X.width),Math.max(X.y,X.y+X.height)],Y=G[0],K=G[1],D=G[2],B=G[3],q=a([Y,K,D,B],d),ee=q[0],J=q[1],$=q[2],te=q[3],ie=f(j.level,x.length);if(j.d!=null){var ae;typeof j.d=="number"?ae=[j.d,j.d]:j.d.length&&(ae=j.d),ie=Math.min(Math.max(Math.ceil(-o(Math.abs(ae[0])/(d[2]-d[0]))),Math.ceil(-o(Math.abs(ae[1])/(d[3]-d[1])))),ie)}if(ie=Math.min(ie,x.length),j.lod)return O(ee,J,$,te,ie);var he=[];function se(ce,ve,ke,Ee,be,xe){if(be!==null&&xe!==null&&!(ee>ce+ke||J>ve+ke||$<ce||te<ve||Ee>=ie||be===xe)){var ue=x[Ee];xe===void 0&&(xe=ue.length);for(var me=be;me<xe;me++){var we=ue[me],Me=c[2*we],Se=c[2*we+1];Me>=Y&&Me<=D&&Se>=K&&Se<=B&&he.push(we)}var De=T[Ee],Fe=De[4*be+0],Ye=De[4*be+1],et=De[4*be+2],Oe=De[4*be+3],je=de(De,be+1),We=.5*ke,Ge=Ee+1;se(ce,ve,We,Ge,Fe,Ye||et||Oe||je),se(ce,ve+We,We,Ge,Ye,et||Oe||je),se(ce+We,ve,We,Ge,et,Oe||je),se(ce+We,ve+We,We,Ge,Oe,je)}}function de(ce,ve){for(var ke=null,Ee=0;ke===null;)if(ke=ce[4*ve+Ee],++Ee>ce.length)return null;return ke}return se(0,0,1,0,0,1),he},l;function O(j,W,Z,Q,X){for(var G=[],Y=0;Y<X;Y++){var K=A[Y],D=S[Y][0],B=F(j,W,Y),q=F(Z,Q,Y),ee=t.ge(K,B),J=t.gt(K,q,ee,K.length-1);G[Y]=[ee+D,J+D]}return G}function F(j,W,Z){for(var Q=1,X=.5,G=.5,Y=.5,K=0;K<Z;K++)Q<<=2,Q+=j<X?W<G?0:1:W<G?2:3,Y*=.5,X+=j<X?-Y:Y,G+=W<G?-Y:Y;return Q}}},{"array-bounds":76,"binary-search-bounds":103,clamp:126,defined:176,dtype:181,"flatten-vertex-data":248,"is-obj":446,"math-log2":456,"parse-rect":481,"pick-by-alias":485}],61:[function(h,N,H){Object.defineProperty(H,"__esModule",{value:!0});var t=h("@turf/meta");function m(e){var f=0;if(e&&e.length>0){f+=Math.abs(g(e[0]));for(var u=1;u<e.length;u++)f-=Math.abs(g(e[u]))}return f}function g(e){var f,u,i,s,o,a,c=0,r=e.length;if(r>2){for(a=0;a<r;a++)a===r-2?(i=r-2,s=r-1,o=0):a===r-1?(i=r-1,s=0,o=1):(i=a,s=a+1,o=a+2),f=e[i],u=e[s],c+=(p(e[o][0])-p(f[0]))*Math.sin(p(u[1]));c=6378137*c*6378137/2}return c}function p(e){return e*Math.PI/180}H.default=function(e){return t.geomReduce(e,function(f,u){return f+function(i){var s,o=0;switch(i.type){case"Polygon":return m(i.coordinates);case"MultiPolygon":for(s=0;s<i.coordinates.length;s++)o+=m(i.coordinates[s]);return o;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(u)},0)}},{"@turf/meta":63}],62:[function(h,N,H){function t(r,n,d){d===void 0&&(d={});var l={type:"Feature"};return(d.id===0||d.id)&&(l.id=d.id),d.bbox&&(l.bbox=d.bbox),l.properties=n||{},l.geometry=r,l}function m(r,n,d){if(d===void 0&&(d={}),!r)throw new Error("coordinates is required");if(!Array.isArray(r))throw new Error("coordinates must be an Array");if(r.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!c(r[0])||!c(r[1]))throw new Error("coordinates must contain numbers");return t({type:"Point",coordinates:r},n,d)}function g(r,n,d){d===void 0&&(d={});for(var l=0,y=r;l<y.length;l++){var v=y[l];if(v.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var _=0;_<v[v.length-1].length;_++)if(v[v.length-1][_]!==v[0][_])throw new Error("First and last Position are not equivalent.")}return t({type:"Polygon",coordinates:r},n,d)}function p(r,n,d){if(d===void 0&&(d={}),r.length<2)throw new Error("coordinates must be an array of two or more positions");return t({type:"LineString",coordinates:r},n,d)}function e(r,n){n===void 0&&(n={});var d={type:"FeatureCollection"};return n.id&&(d.id=n.id),n.bbox&&(d.bbox=n.bbox),d.features=r,d}function f(r,n,d){return d===void 0&&(d={}),t({type:"MultiLineString",coordinates:r},n,d)}function u(r,n,d){return d===void 0&&(d={}),t({type:"MultiPoint",coordinates:r},n,d)}function i(r,n,d){return d===void 0&&(d={}),t({type:"MultiPolygon",coordinates:r},n,d)}function s(r,n){n===void 0&&(n="kilometers");var d=H.factors[n];if(!d)throw new Error(n+" units is invalid");return r*d}function o(r,n){n===void 0&&(n="kilometers");var d=H.factors[n];if(!d)throw new Error(n+" units is invalid");return r/d}function a(r){return 180*(r%(2*Math.PI))/Math.PI}function c(r){return!isNaN(r)&&r!==null&&!Array.isArray(r)}Object.defineProperty(H,"__esModule",{value:!0}),H.earthRadius=63710088e-1,H.factors={centimeters:100*H.earthRadius,centimetres:100*H.earthRadius,degrees:H.earthRadius/111325,feet:3.28084*H.earthRadius,inches:39.37*H.earthRadius,kilometers:H.earthRadius/1e3,kilometres:H.earthRadius/1e3,meters:H.earthRadius,metres:H.earthRadius,miles:H.earthRadius/1609.344,millimeters:1e3*H.earthRadius,millimetres:1e3*H.earthRadius,nauticalmiles:H.earthRadius/1852,radians:1,yards:1.0936*H.earthRadius},H.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/H.earthRadius,yards:1.0936133},H.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},H.feature=t,H.geometry=function(r,n,d){switch(r){case"Point":return m(n).geometry;case"LineString":return p(n).geometry;case"Polygon":return g(n).geometry;case"MultiPoint":return u(n).geometry;case"MultiLineString":return f(n).geometry;case"MultiPolygon":return i(n).geometry;default:throw new Error(r+" is invalid")}},H.point=m,H.points=function(r,n,d){return d===void 0&&(d={}),e(r.map(function(l){return m(l,n)}),d)},H.polygon=g,H.polygons=function(r,n,d){return d===void 0&&(d={}),e(r.map(function(l){return g(l,n)}),d)},H.lineString=p,H.lineStrings=function(r,n,d){return d===void 0&&(d={}),e(r.map(function(l){return p(l,n)}),d)},H.featureCollection=e,H.multiLineString=f,H.multiPoint=u,H.multiPolygon=i,H.geometryCollection=function(r,n,d){return d===void 0&&(d={}),t({type:"GeometryCollection",geometries:r},n,d)},H.round=function(r,n){if(n===void 0&&(n=0),n&&!(n>=0))throw new Error("precision must be a positive number");var d=Math.pow(10,n||0);return Math.round(r*d)/d},H.radiansToLength=s,H.lengthToRadians=o,H.lengthToDegrees=function(r,n){return a(o(r,n))},H.bearingToAzimuth=function(r){var n=r%360;return n<0&&(n+=360),n},H.radiansToDegrees=a,H.degreesToRadians=function(r){return r%360*Math.PI/180},H.convertLength=function(r,n,d){if(n===void 0&&(n="kilometers"),d===void 0&&(d="kilometers"),!(r>=0))throw new Error("length must be a positive number");return s(o(r,n),d)},H.convertArea=function(r,n,d){if(n===void 0&&(n="meters"),d===void 0&&(d="kilometers"),!(r>=0))throw new Error("area must be a positive number");var l=H.areaFactors[n];if(!l)throw new Error("invalid original units");var y=H.areaFactors[d];if(!y)throw new Error("invalid final units");return r/l*y},H.isNumber=c,H.isObject=function(r){return!!r&&r.constructor===Object},H.validateBBox=function(r){if(!r)throw new Error("bbox is required");if(!Array.isArray(r))throw new Error("bbox must be an Array");if(r.length!==4&&r.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");r.forEach(function(n){if(!c(n))throw new Error("bbox must only contain numbers")})},H.validateId=function(r){if(!r)throw new Error("id is required");if(["string","number"].indexOf(typeof r)===-1)throw new Error("id must be a number or a string")}},{}],63:[function(h,N,H){Object.defineProperty(H,"__esModule",{value:!0});var t=h("@turf/helpers");function m(s,o,a){if(s!==null)for(var c,r,n,d,l,y,v,_,x=0,T=0,A=s.type,S=A==="FeatureCollection",w=A==="Feature",L=S?s.features.length:1,k=0;k<L;k++){l=(_=!!(v=S?s.features[k].geometry:w?s.geometry:s)&&v.type==="GeometryCollection")?v.geometries.length:1;for(var C=0;C<l;C++){var M=0,P=0;if((d=_?v.geometries[C]:v)!==null){y=d.coordinates;var O=d.type;switch(x=!a||O!=="Polygon"&&O!=="MultiPolygon"?0:1,O){case null:break;case"Point":if(o(y,T,k,M,P)===!1)return!1;T++,M++;break;case"LineString":case"MultiPoint":for(c=0;c<y.length;c++){if(o(y[c],T,k,M,P)===!1)return!1;T++,O==="MultiPoint"&&M++}O==="LineString"&&M++;break;case"Polygon":case"MultiLineString":for(c=0;c<y.length;c++){for(r=0;r<y[c].length-x;r++){if(o(y[c][r],T,k,M,P)===!1)return!1;T++}O==="MultiLineString"&&M++,O==="Polygon"&&P++}O==="Polygon"&&M++;break;case"MultiPolygon":for(c=0;c<y.length;c++){for(P=0,r=0;r<y[c].length;r++){for(n=0;n<y[c][r].length-x;n++){if(o(y[c][r][n],T,k,M,P)===!1)return!1;T++}P++}M++}break;case"GeometryCollection":for(c=0;c<d.geometries.length;c++)if(m(d.geometries[c],o,a)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function g(s,o){var a;switch(s.type){case"FeatureCollection":for(a=0;a<s.features.length&&o(s.features[a].properties,a)!==!1;a++);break;case"Feature":o(s.properties,0)}}function p(s,o){if(s.type==="Feature")o(s,0);else if(s.type==="FeatureCollection")for(var a=0;a<s.features.length&&o(s.features[a],a)!==!1;a++);}function e(s,o){var a,c,r,n,d,l,y,v,_,x,T=0,A=s.type==="FeatureCollection",S=s.type==="Feature",w=A?s.features.length:1;for(a=0;a<w;a++){for(l=A?s.features[a].geometry:S?s.geometry:s,v=A?s.features[a].properties:S?s.properties:{},_=A?s.features[a].bbox:S?s.bbox:void 0,x=A?s.features[a].id:S?s.id:void 0,d=(y=!!l&&l.type==="GeometryCollection")?l.geometries.length:1,r=0;r<d;r++)if((n=y?l.geometries[r]:l)!==null)switch(n.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(o(n,T,v,_,x)===!1)return!1;break;case"GeometryCollection":for(c=0;c<n.geometries.length;c++)if(o(n.geometries[c],T,v,_,x)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}else if(o(null,T,v,_,x)===!1)return!1;T++}}function f(s,o){e(s,function(a,c,r,n,d){var l,y=a===null?null:a.type;switch(y){case null:case"Point":case"LineString":case"Polygon":return o(t.feature(a,r,{bbox:n,id:d}),c,0)!==!1&&void 0}switch(y){case"MultiPoint":l="Point";break;case"MultiLineString":l="LineString";break;case"MultiPolygon":l="Polygon"}for(var v=0;v<a.coordinates.length;v++){var _={type:l,coordinates:a.coordinates[v]};if(o(t.feature(_,r),c,v)===!1)return!1}})}function u(s,o){f(s,function(a,c,r){var n=0;if(a.geometry){var d=a.geometry.type;if(d!=="Point"&&d!=="MultiPoint"){var l,y=0,v=0,_=0;return m(a,function(x,T,A,S,w){if(l===void 0||c>y||S>v||w>_)return l=x,y=c,v=S,_=w,void(n=0);var L=t.lineString([l,x],a.properties);if(o(L,c,r,w,n)===!1)return!1;n++,l=x})!==!1&&void 0}}})}function i(s,o){if(!s)throw new Error("geojson is required");f(s,function(a,c,r){if(a.geometry!==null){var n=a.geometry.type,d=a.geometry.coordinates;switch(n){case"LineString":if(o(a,c,r,0,0)===!1)return!1;break;case"Polygon":for(var l=0;l<d.length;l++)if(o(t.lineString(d[l],a.properties),c,r,l)===!1)return!1}}})}H.coordEach=m,H.coordReduce=function(s,o,a,c){var r=a;return m(s,function(n,d,l,y,v){r=d===0&&a===void 0?n:o(r,n,d,l,y,v)},c),r},H.propEach=g,H.propReduce=function(s,o,a){var c=a;return g(s,function(r,n){c=n===0&&a===void 0?r:o(c,r,n)}),c},H.featureEach=p,H.featureReduce=function(s,o,a){var c=a;return p(s,function(r,n){c=n===0&&a===void 0?r:o(c,r,n)}),c},H.coordAll=function(s){var o=[];return m(s,function(a){o.push(a)}),o},H.geomEach=e,H.geomReduce=function(s,o,a){var c=a;return e(s,function(r,n,d,l,y){c=n===0&&a===void 0?r:o(c,r,n,d,l,y)}),c},H.flattenEach=f,H.flattenReduce=function(s,o,a){var c=a;return f(s,function(r,n,d){c=n===0&&d===0&&a===void 0?r:o(c,r,n,d)}),c},H.segmentEach=u,H.segmentReduce=function(s,o,a){var c=a,r=!1;return u(s,function(n,d,l,y,v){c=r===!1&&a===void 0?n:o(c,n,d,l,y,v),r=!0}),c},H.lineEach=i,H.lineReduce=function(s,o,a){var c=a;return i(s,function(r,n,d,l){c=n===0&&a===void 0?r:o(c,r,n,d,l)}),c},H.findSegment=function(s,o){if(o=o||{},!t.isObject(o))throw new Error("options is invalid");var a,c=o.featureIndex||0,r=o.multiFeatureIndex||0,n=o.geometryIndex||0,d=o.segmentIndex||0,l=o.properties;switch(s.type){case"FeatureCollection":c<0&&(c=s.features.length+c),l=l||s.features[c].properties,a=s.features[c].geometry;break;case"Feature":l=l||s.properties,a=s.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":a=s;break;default:throw new Error("geojson is invalid")}if(a===null)return null;var y=a.coordinates;switch(a.type){case"Point":case"MultiPoint":return null;case"LineString":return d<0&&(d=y.length+d-1),t.lineString([y[d],y[d+1]],l,o);case"Polygon":return n<0&&(n=y.length+n),d<0&&(d=y[n].length+d-1),t.lineString([y[n][d],y[n][d+1]],l,o);case"MultiLineString":return r<0&&(r=y.length+r),d<0&&(d=y[r].length+d-1),t.lineString([y[r][d],y[r][d+1]],l,o);case"MultiPolygon":return r<0&&(r=y.length+r),n<0&&(n=y[r].length+n),d<0&&(d=y[r][n].length-d-1),t.lineString([y[r][n][d],y[r][n][d+1]],l,o)}throw new Error("geojson is invalid")},H.findPoint=function(s,o){if(o=o||{},!t.isObject(o))throw new Error("options is invalid");var a,c=o.featureIndex||0,r=o.multiFeatureIndex||0,n=o.geometryIndex||0,d=o.coordIndex||0,l=o.properties;switch(s.type){case"FeatureCollection":c<0&&(c=s.features.length+c),l=l||s.features[c].properties,a=s.features[c].geometry;break;case"Feature":l=l||s.properties,a=s.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":a=s;break;default:throw new Error("geojson is invalid")}if(a===null)return null;var y=a.coordinates;switch(a.type){case"Point":return t.point(y,l,o);case"MultiPoint":return r<0&&(r=y.length+r),t.point(y[r],l,o);case"LineString":return d<0&&(d=y.length+d),t.point(y[d],l,o);case"Polygon":return n<0&&(n=y.length+n),d<0&&(d=y[n].length+d),t.point(y[n][d],l,o);case"MultiLineString":return r<0&&(r=y.length+r),d<0&&(d=y[r].length+d),t.point(y[r][d],l,o);case"MultiPolygon":return r<0&&(r=y.length+r),n<0&&(n=y[r].length+n),d<0&&(d=y[r][n].length-d),t.point(y[r][n][d],l,o)}throw new Error("geojson is invalid")}},{"@turf/helpers":62}],64:[function(h,N,H){Object.defineProperty(H,"__esModule",{value:!0});var t=h("@turf/meta");function m(g){var p=[1/0,1/0,-1/0,-1/0];return t.coordEach(g,function(e){p[0]>e[0]&&(p[0]=e[0]),p[1]>e[1]&&(p[1]=e[1]),p[2]<e[0]&&(p[2]=e[0]),p[3]<e[1]&&(p[3]=e[1])}),p}m.default=m,H.default=m},{"@turf/meta":66}],65:[function(h,N,H){arguments[4][62][0].apply(H,arguments)},{dup:62}],66:[function(h,N,H){arguments[4][63][0].apply(H,arguments)},{"@turf/helpers":65,dup:63}],67:[function(h,N,H){Object.defineProperty(H,"__esModule",{value:!0});var t=h("@turf/meta"),m=h("@turf/helpers");H.default=function(g,p){p===void 0&&(p={});var e=0,f=0,u=0;return t.coordEach(g,function(i){e+=i[0],f+=i[1],u++}),m.point([e/u,f/u],p.properties)}},{"@turf/helpers":68,"@turf/meta":69}],68:[function(h,N,H){function t(r,n,d){d===void 0&&(d={});var l={type:"Feature"};return(d.id===0||d.id)&&(l.id=d.id),d.bbox&&(l.bbox=d.bbox),l.properties=n||{},l.geometry=r,l}function m(r,n,d){return d===void 0&&(d={}),t({type:"Point",coordinates:r},n,d)}function g(r,n,d){d===void 0&&(d={});for(var l=0,y=r;l<y.length;l++){var v=y[l];if(v.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var _=0;_<v[v.length-1].length;_++)if(v[v.length-1][_]!==v[0][_])throw new Error("First and last Position are not equivalent.")}return t({type:"Polygon",coordinates:r},n,d)}function p(r,n,d){if(d===void 0&&(d={}),r.length<2)throw new Error("coordinates must be an array of two or more positions");return t({type:"LineString",coordinates:r},n,d)}function e(r,n){n===void 0&&(n={});var d={type:"FeatureCollection"};return n.id&&(d.id=n.id),n.bbox&&(d.bbox=n.bbox),d.features=r,d}function f(r,n,d){return d===void 0&&(d={}),t({type:"MultiLineString",coordinates:r},n,d)}function u(r,n,d){return d===void 0&&(d={}),t({type:"MultiPoint",coordinates:r},n,d)}function i(r,n,d){return d===void 0&&(d={}),t({type:"MultiPolygon",coordinates:r},n,d)}function s(r,n){n===void 0&&(n="kilometers");var d=H.factors[n];if(!d)throw new Error(n+" units is invalid");return r*d}function o(r,n){n===void 0&&(n="kilometers");var d=H.factors[n];if(!d)throw new Error(n+" units is invalid");return r/d}function a(r){return 180*(r%(2*Math.PI))/Math.PI}function c(r){return!isNaN(r)&&r!==null&&!Array.isArray(r)&&!/^\s*$/.test(r)}Object.defineProperty(H,"__esModule",{value:!0}),H.earthRadius=63710088e-1,H.factors={centimeters:100*H.earthRadius,centimetres:100*H.earthRadius,degrees:H.earthRadius/111325,feet:3.28084*H.earthRadius,inches:39.37*H.earthRadius,kilometers:H.earthRadius/1e3,kilometres:H.earthRadius/1e3,meters:H.earthRadius,metres:H.earthRadius,miles:H.earthRadius/1609.344,millimeters:1e3*H.earthRadius,millimetres:1e3*H.earthRadius,nauticalmiles:H.earthRadius/1852,radians:1,yards:H.earthRadius/1.0936},H.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/H.earthRadius,yards:1/1.0936},H.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},H.feature=t,H.geometry=function(r,n,d){switch(r){case"Point":return m(n).geometry;case"LineString":return p(n).geometry;case"Polygon":return g(n).geometry;case"MultiPoint":return u(n).geometry;case"MultiLineString":return f(n).geometry;case"MultiPolygon":return i(n).geometry;default:throw new Error(r+" is invalid")}},H.point=m,H.points=function(r,n,d){return d===void 0&&(d={}),e(r.map(function(l){return m(l,n)}),d)},H.polygon=g,H.polygons=function(r,n,d){return d===void 0&&(d={}),e(r.map(function(l){return g(l,n)}),d)},H.lineString=p,H.lineStrings=function(r,n,d){return d===void 0&&(d={}),e(r.map(function(l){return p(l,n)}),d)},H.featureCollection=e,H.multiLineString=f,H.multiPoint=u,H.multiPolygon=i,H.geometryCollection=function(r,n,d){return d===void 0&&(d={}),t({type:"GeometryCollection",geometries:r},n,d)},H.round=function(r,n){if(n===void 0&&(n=0),n&&!(n>=0))throw new Error("precision must be a positive number");var d=Math.pow(10,n||0);return Math.round(r*d)/d},H.radiansToLength=s,H.lengthToRadians=o,H.lengthToDegrees=function(r,n){return a(o(r,n))},H.bearingToAzimuth=function(r){var n=r%360;return n<0&&(n+=360),n},H.radiansToDegrees=a,H.degreesToRadians=function(r){return r%360*Math.PI/180},H.convertLength=function(r,n,d){if(n===void 0&&(n="kilometers"),d===void 0&&(d="kilometers"),!(r>=0))throw new Error("length must be a positive number");return s(o(r,n),d)},H.convertArea=function(r,n,d){if(n===void 0&&(n="meters"),d===void 0&&(d="kilometers"),!(r>=0))throw new Error("area must be a positive number");var l=H.areaFactors[n];if(!l)throw new Error("invalid original units");var y=H.areaFactors[d];if(!y)throw new Error("invalid final units");return r/l*y},H.isNumber=c,H.isObject=function(r){return!!r&&r.constructor===Object},H.validateBBox=function(r){if(!r)throw new Error("bbox is required");if(!Array.isArray(r))throw new Error("bbox must be an Array");if(r.length!==4&&r.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");r.forEach(function(n){if(!c(n))throw new Error("bbox must only contain numbers")})},H.validateId=function(r){if(!r)throw new Error("id is required");if(["string","number"].indexOf(typeof r)===-1)throw new Error("id must be a number or a string")},H.radians2degrees=function(){throw new Error("method has been renamed to `radiansToDegrees`")},H.degrees2radians=function(){throw new Error("method has been renamed to `degreesToRadians`")},H.distanceToDegrees=function(){throw new Error("method has been renamed to `lengthToDegrees`")},H.distanceToRadians=function(){throw new Error("method has been renamed to `lengthToRadians`")},H.radiansToDistance=function(){throw new Error("method has been renamed to `radiansToLength`")},H.bearingToAngle=function(){throw new Error("method has been renamed to `bearingToAzimuth`")},H.convertDistance=function(){throw new Error("method has been renamed to `convertLength`")}},{}],69:[function(h,N,H){Object.defineProperty(H,"__esModule",{value:!0});var t=h("@turf/helpers");function m(s,o,a){if(s!==null)for(var c,r,n,d,l,y,v,_,x=0,T=0,A=s.type,S=A==="FeatureCollection",w=A==="Feature",L=S?s.features.length:1,k=0;k<L;k++){l=(_=!!(v=S?s.features[k].geometry:w?s.geometry:s)&&v.type==="GeometryCollection")?v.geometries.length:1;for(var C=0;C<l;C++){var M=0,P=0;if((d=_?v.geometries[C]:v)!==null){y=d.coordinates;var O=d.type;switch(x=!a||O!=="Polygon"&&O!=="MultiPolygon"?0:1,O){case null:break;case"Point":if(o(y,T,k,M,P)===!1)return!1;T++,M++;break;case"LineString":case"MultiPoint":for(c=0;c<y.length;c++){if(o(y[c],T,k,M,P)===!1)return!1;T++,O==="MultiPoint"&&M++}O==="LineString"&&M++;break;case"Polygon":case"MultiLineString":for(c=0;c<y.length;c++){for(r=0;r<y[c].length-x;r++){if(o(y[c][r],T,k,M,P)===!1)return!1;T++}O==="MultiLineString"&&M++,O==="Polygon"&&P++}O==="Polygon"&&M++;break;case"MultiPolygon":for(c=0;c<y.length;c++){for(P=0,r=0;r<y[c].length;r++){for(n=0;n<y[c][r].length-x;n++){if(o(y[c][r][n],T,k,M,P)===!1)return!1;T++}P++}M++}break;case"GeometryCollection":for(c=0;c<d.geometries.length;c++)if(m(d.geometries[c],o,a)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function g(s,o){var a;switch(s.type){case"FeatureCollection":for(a=0;a<s.features.length&&o(s.features[a].properties,a)!==!1;a++);break;case"Feature":o(s.properties,0)}}function p(s,o){if(s.type==="Feature")o(s,0);else if(s.type==="FeatureCollection")for(var a=0;a<s.features.length&&o(s.features[a],a)!==!1;a++);}function e(s,o){var a,c,r,n,d,l,y,v,_,x,T=0,A=s.type==="FeatureCollection",S=s.type==="Feature",w=A?s.features.length:1;for(a=0;a<w;a++){for(l=A?s.features[a].geometry:S?s.geometry:s,v=A?s.features[a].properties:S?s.properties:{},_=A?s.features[a].bbox:S?s.bbox:void 0,x=A?s.features[a].id:S?s.id:void 0,d=(y=!!l&&l.type==="GeometryCollection")?l.geometries.length:1,r=0;r<d;r++)if((n=y?l.geometries[r]:l)!==null)switch(n.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(o(n,T,v,_,x)===!1)return!1;break;case"GeometryCollection":for(c=0;c<n.geometries.length;c++)if(o(n.geometries[c],T,v,_,x)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}else if(o(null,T,v,_,x)===!1)return!1;T++}}function f(s,o){e(s,function(a,c,r,n,d){var l,y=a===null?null:a.type;switch(y){case null:case"Point":case"LineString":case"Polygon":return o(t.feature(a,r,{bbox:n,id:d}),c,0)!==!1&&void 0}switch(y){case"MultiPoint":l="Point";break;case"MultiLineString":l="LineString";break;case"MultiPolygon":l="Polygon"}for(var v=0;v<a.coordinates.length;v++){var _={type:l,coordinates:a.coordinates[v]};if(o(t.feature(_,r),c,v)===!1)return!1}})}function u(s,o){f(s,function(a,c,r){var n=0;if(a.geometry){var d=a.geometry.type;if(d!=="Point"&&d!=="MultiPoint"){var l,y=0,v=0,_=0;return m(a,function(x,T,A,S,w){if(l===void 0||c>y||S>v||w>_)return l=x,y=c,v=S,_=w,void(n=0);var L=t.lineString([l,x],a.properties);if(o(L,c,r,w,n)===!1)return!1;n++,l=x})!==!1&&void 0}}})}function i(s,o){if(!s)throw new Error("geojson is required");f(s,function(a,c,r){if(a.geometry!==null){var n=a.geometry.type,d=a.geometry.coordinates;switch(n){case"LineString":if(o(a,c,r,0,0)===!1)return!1;break;case"Polygon":for(var l=0;l<d.length;l++)if(o(t.lineString(d[l],a.properties),c,r,l)===!1)return!1}}})}H.coordEach=m,H.coordReduce=function(s,o,a,c){var r=a;return m(s,function(n,d,l,y,v){r=d===0&&a===void 0?n:o(r,n,d,l,y,v)},c),r},H.propEach=g,H.propReduce=function(s,o,a){var c=a;return g(s,function(r,n){c=n===0&&a===void 0?r:o(c,r,n)}),c},H.featureEach=p,H.featureReduce=function(s,o,a){var c=a;return p(s,function(r,n){c=n===0&&a===void 0?r:o(c,r,n)}),c},H.coordAll=function(s){var o=[];return m(s,function(a){o.push(a)}),o},H.geomEach=e,H.geomReduce=function(s,o,a){var c=a;return e(s,function(r,n,d,l,y){c=n===0&&a===void 0?r:o(c,r,n,d,l,y)}),c},H.flattenEach=f,H.flattenReduce=function(s,o,a){var c=a;return f(s,function(r,n,d){c=n===0&&d===0&&a===void 0?r:o(c,r,n,d)}),c},H.segmentEach=u,H.segmentReduce=function(s,o,a){var c=a,r=!1;return u(s,function(n,d,l,y,v){c=r===!1&&a===void 0?n:o(c,n,d,l,y,v),r=!0}),c},H.lineEach=i,H.lineReduce=function(s,o,a){var c=a;return i(s,function(r,n,d,l){c=n===0&&a===void 0?r:o(c,r,n,d,l)}),c},H.findSegment=function(s,o){if(o=o||{},!t.isObject(o))throw new Error("options is invalid");var a,c=o.featureIndex||0,r=o.multiFeatureIndex||0,n=o.geometryIndex||0,d=o.segmentIndex||0,l=o.properties;switch(s.type){case"FeatureCollection":c<0&&(c=s.features.length+c),l=l||s.features[c].properties,a=s.features[c].geometry;break;case"Feature":l=l||s.properties,a=s.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":a=s;break;default:throw new Error("geojson is invalid")}if(a===null)return null;var y=a.coordinates;switch(a.type){case"Point":case"MultiPoint":return null;case"LineString":return d<0&&(d=y.length+d-1),t.lineString([y[d],y[d+1]],l,o);case"Polygon":return n<0&&(n=y.length+n),d<0&&(d=y[n].length+d-1),t.lineString([y[n][d],y[n][d+1]],l,o);case"MultiLineString":return r<0&&(r=y.length+r),d<0&&(d=y[r].length+d-1),t.lineString([y[r][d],y[r][d+1]],l,o);case"MultiPolygon":return r<0&&(r=y.length+r),n<0&&(n=y[r].length+n),d<0&&(d=y[r][n].length-d-1),t.lineString([y[r][n][d],y[r][n][d+1]],l,o)}throw new Error("geojson is invalid")},H.findPoint=function(s,o){if(o=o||{},!t.isObject(o))throw new Error("options is invalid");var a,c=o.featureIndex||0,r=o.multiFeatureIndex||0,n=o.geometryIndex||0,d=o.coordIndex||0,l=o.properties;switch(s.type){case"FeatureCollection":c<0&&(c=s.features.length+c),l=l||s.features[c].properties,a=s.features[c].geometry;break;case"Feature":l=l||s.properties,a=s.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":a=s;break;default:throw new Error("geojson is invalid")}if(a===null)return null;var y=a.coordinates;switch(a.type){case"Point":return t.point(y,l,o);case"MultiPoint":return r<0&&(r=y.length+r),t.point(y[r],l,o);case"LineString":return d<0&&(d=y.length+d),t.point(y[d],l,o);case"Polygon":return n<0&&(n=y.length+n),d<0&&(d=y[n].length+d),t.point(y[n][d],l,o);case"MultiLineString":return r<0&&(r=y.length+r),d<0&&(d=y[r].length+d),t.point(y[r][d],l,o);case"MultiPolygon":return r<0&&(r=y.length+r),n<0&&(n=y[r].length+n),d<0&&(d=y[r][n].length-d),t.point(y[r][n][d],l,o)}throw new Error("geojson is invalid")}},{"@turf/helpers":68}],70:[function(h,N,H){var t=typeof WeakMap=="undefined"?h("weak-map"):WeakMap,m=h("gl-buffer"),g=h("gl-vao"),p=new t;N.exports=function(e){var f=p.get(e),u=f&&(f._triangleBuffer.handle||f._triangleBuffer.buffer);if(!u||!e.isBuffer(u)){var i=m(e,new Float32Array([-1,-1,-1,4,4,-1]));(f=g(e,[{buffer:i,type:e.FLOAT,size:2}]))._triangleBuffer=i,p.set(e,f)}f.bind(),e.drawArrays(e.TRIANGLES,0,3),f.unbind()}},{"gl-buffer":261,"gl-vao":353,"weak-map":609}],71:[function(h,N,H){N.exports=function(t){var m=0,g=0,p=0,e=0;return t.map(function(f){var u=(f=f.slice())[0],i=u.toUpperCase();if(u!=i)switch(f[0]=i,u){case"a":f[6]+=p,f[7]+=e;break;case"v":f[1]+=e;break;case"h":f[1]+=p;break;default:for(var s=1;s<f.length;)f[s++]+=p,f[s++]+=e}switch(i){case"Z":p=m,e=g;break;case"H":p=f[1];break;case"V":e=f[1];break;case"M":p=m=f[1],e=g=f[2];break;default:p=f[f.length-2],e=f[f.length-1]}return f})}},{}],72:[function(h,N,H){var t=h("pad-left");N.exports=function(m,g,p){g=typeof g=="number"?g:1,p=p||": ";var e=m.split(/\r?\n/),f=String(e.length+g-1).length;return e.map(function(u,i){var s=i+g,o=String(s).length;return t(s,f-o)+p+u}).join(`
`)}},{"pad-left":479}],73:[function(h,N,H){N.exports=function(g){var p=g.length;if(p===0)return[];if(p===1)return[0];for(var e=g[0].length,f=[g[0]],u=[0],i=1;i<p;++i)if(f.push(g[i]),m(f,e)){if(u.push(i),u.length===e+1)return u}else f.pop();return u};var t=h("robust-orientation");function m(g,p){for(var e=new Array(p+1),f=0;f<g.length;++f)e[f]=g[f];for(f=0;f<=g.length;++f){for(var u=g.length;u<=p;++u){for(var i=new Array(p),s=0;s<p;++s)i[s]=Math.pow(u+1-f,s);e[u]=i}if(t.apply(void 0,e))return!0}return!1}},{"robust-orientation":534}],74:[function(h,N,H){N.exports=function(g,p){return t(p).filter(function(e){for(var f=new Array(e.length),u=0;u<e.length;++u)f[u]=p[e[u]];return m(f)*g<1})};var t=h("delaunay-triangulate"),m=h("circumradius")},{circumradius:125,"delaunay-triangulate":177}],75:[function(h,N,H){N.exports=function(g,p){return m(t(g,p))};var t=h("alpha-complex"),m=h("simplicial-complex-boundary")},{"alpha-complex":74,"simplicial-complex-boundary":542}],76:[function(h,N,H){N.exports=function(t,m){if(!t||t.length==null)throw Error("Argument should be an array");m=m==null?1:Math.floor(m);for(var g=Array(2*m),p=0;p<m;p++){for(var e=-1/0,f=1/0,u=p,i=t.length;u<i;u+=m)t[u]>e&&(e=t[u]),t[u]<f&&(f=t[u]);g[p]=f,g[m+p]=e}return g}},{}],77:[function(h,N,H){N.exports=function(t,m,g){if(typeof Array.prototype.findIndex=="function")return t.findIndex(m,g);if(typeof m!="function")throw new TypeError("predicate must be a function");var p=Object(t),e=p.length;if(e===0)return-1;for(var f=0;f<e;f++)if(m.call(g,p[f],f,p))return f;return-1}},{}],78:[function(h,N,H){var t=h("array-bounds");N.exports=function(m,g,p){if(!m||m.length==null)throw Error("Argument should be an array");g==null&&(g=1),p==null&&(p=t(m,g));for(var e=0;e<g;e++){var f=p[g+e],u=p[e],i=e,s=m.length;if(f===1/0&&u===-1/0)for(i=e;i<s;i+=g)m[i]=m[i]===f?1:m[i]===u?0:.5;else if(f===1/0)for(i=e;i<s;i+=g)m[i]=m[i]===f?1:0;else if(u===-1/0)for(i=e;i<s;i+=g)m[i]=m[i]===u?0:1;else{var o=f-u;for(i=e;i<s;i+=g)isNaN(m[i])||(m[i]=o===0?.5:(m[i]-u)/o)}}return m}},{"array-bounds":76}],79:[function(h,N,H){N.exports=function(t,m){var g=typeof t=="number",p=typeof m=="number";g&&!p?(m=t,t=0):g||p||(t=0,m=0);var e=(m|=0)-(t|=0);if(e<0)throw new Error("array length must be positive");for(var f=new Array(e),u=0,i=t;u<e;u++,i++)f[u]=i;return f}},{}],80:[function(h,N,H){(function(t){(function(){var m=h("object-assign");/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function g(S,w){if(S===w)return 0;for(var L=S.length,k=w.length,C=0,M=Math.min(L,k);C<M;++C)if(S[C]!==w[C]){L=S[C],k=w[C];break}return L<k?-1:k<L?1:0}function p(S){return t.Buffer&&typeof t.Buffer.isBuffer=="function"?t.Buffer.isBuffer(S):!(S==null||!S._isBuffer)}var e=h("util/"),f=Object.prototype.hasOwnProperty,u=Array.prototype.slice,i=function(){}.name==="foo";function s(S){return Object.prototype.toString.call(S)}function o(S){return!p(S)&&typeof t.ArrayBuffer=="function"&&(typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(S):!!S&&(S instanceof DataView||!!(S.buffer&&S.buffer instanceof ArrayBuffer)))}var a=N.exports=y,c=/\s*function\s+([^\(\s]*)\s*/;function r(S){if(e.isFunction(S)){if(i)return S.name;var w=S.toString().match(c);return w&&w[1]}}function n(S,w){return typeof S=="string"?S.length<w?S:S.slice(0,w):S}function d(S){if(i||!e.isFunction(S))return e.inspect(S);var w=r(S);return"[Function"+(w?": "+w:"")+"]"}function l(S,w,L,k,C){throw new a.AssertionError({message:L,actual:S,expected:w,operator:k,stackStartFunction:C})}function y(S,w){S||l(S,!0,w,"==",a.ok)}function v(S,w,L,k){if(S===w)return!0;if(p(S)&&p(w))return g(S,w)===0;if(e.isDate(S)&&e.isDate(w))return S.getTime()===w.getTime();if(e.isRegExp(S)&&e.isRegExp(w))return S.source===w.source&&S.global===w.global&&S.multiline===w.multiline&&S.lastIndex===w.lastIndex&&S.ignoreCase===w.ignoreCase;if(S!==null&&typeof S=="object"||w!==null&&typeof w=="object"){if(o(S)&&o(w)&&s(S)===s(w)&&!(S instanceof Float32Array||S instanceof Float64Array))return g(new Uint8Array(S.buffer),new Uint8Array(w.buffer))===0;if(p(S)!==p(w))return!1;var C=(k=k||{actual:[],expected:[]}).actual.indexOf(S);return C!==-1&&C===k.expected.indexOf(w)||(k.actual.push(S),k.expected.push(w),function(M,P,O,F){if(M==null||P==null)return!1;if(e.isPrimitive(M)||e.isPrimitive(P))return M===P;if(O&&Object.getPrototypeOf(M)!==Object.getPrototypeOf(P))return!1;var j=_(M),W=_(P);if(j&&!W||!j&&W)return!1;if(j)return M=u.call(M),P=u.call(P),v(M,P,O);var Z,Q,X=A(M),G=A(P);if(X.length!==G.length)return!1;for(X.sort(),G.sort(),Q=X.length-1;Q>=0;Q--)if(X[Q]!==G[Q])return!1;for(Q=X.length-1;Q>=0;Q--)if(Z=X[Q],!v(M[Z],P[Z],O,F))return!1;return!0}(S,w,L,k))}return L?S===w:S==w}function _(S){return Object.prototype.toString.call(S)=="[object Arguments]"}function x(S,w){if(!S||!w)return!1;if(Object.prototype.toString.call(w)=="[object RegExp]")return w.test(S);try{if(S instanceof w)return!0}catch(L){}return!Error.isPrototypeOf(w)&&w.call({},S)===!0}function T(S,w,L,k){var C;if(typeof w!="function")throw new TypeError('"block" argument must be a function');typeof L=="string"&&(k=L,L=null),C=function(O){var F;try{O()}catch(j){F=j}return F}(w),k=(L&&L.name?" ("+L.name+").":".")+(k?" "+k:"."),S&&!C&&l(C,L,"Missing expected exception"+k);var M=typeof k=="string",P=!S&&C&&!L;if((!S&&e.isError(C)&&M&&x(C,L)||P)&&l(C,L,"Got unwanted exception"+k),S&&C&&L&&!x(C,L)||!S&&C)throw C}a.AssertionError=function(S){this.name="AssertionError",this.actual=S.actual,this.expected=S.expected,this.operator=S.operator,S.message?(this.message=S.message,this.generatedMessage=!1):(this.message=function(O){return n(d(O.actual),128)+" "+O.operator+" "+n(d(O.expected),128)}(this),this.generatedMessage=!0);var w=S.stackStartFunction||l;if(Error.captureStackTrace)Error.captureStackTrace(this,w);else{var L=new Error;if(L.stack){var k=L.stack,C=r(w),M=k.indexOf(`
`+C);if(M>=0){var P=k.indexOf(`
`,M+1);k=k.substring(P+1)}this.stack=k}}},e.inherits(a.AssertionError,Error),a.fail=l,a.ok=y,a.equal=function(S,w,L){S!=w&&l(S,w,L,"==",a.equal)},a.notEqual=function(S,w,L){S==w&&l(S,w,L,"!=",a.notEqual)},a.deepEqual=function(S,w,L){v(S,w,!1)||l(S,w,L,"deepEqual",a.deepEqual)},a.deepStrictEqual=function(S,w,L){v(S,w,!0)||l(S,w,L,"deepStrictEqual",a.deepStrictEqual)},a.notDeepEqual=function(S,w,L){v(S,w,!1)&&l(S,w,L,"notDeepEqual",a.notDeepEqual)},a.notDeepStrictEqual=function S(w,L,k){v(w,L,!0)&&l(w,L,k,"notDeepStrictEqual",S)},a.strictEqual=function(S,w,L){S!==w&&l(S,w,L,"===",a.strictEqual)},a.notStrictEqual=function(S,w,L){S===w&&l(S,w,L,"!==",a.notStrictEqual)},a.throws=function(S,w,L){T(!0,S,w,L)},a.doesNotThrow=function(S,w,L){T(!1,S,w,L)},a.ifError=function(S){if(S)throw S},a.strict=m(function S(w,L){w||l(w,!0,L,"==",S)},a,{equal:a.strictEqual,deepEqual:a.deepStrictEqual,notEqual:a.notStrictEqual,notDeepEqual:a.notDeepStrictEqual}),a.strict.strict=a.strict;var A=Object.keys||function(S){var w=[];for(var L in S)f.call(S,L)&&w.push(L);return w}}).call(this)}).call(this,typeof La!="undefined"?La:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"object-assign":476,"util/":83}],81:[function(h,N,H){typeof Object.create=="function"?N.exports=function(t,m){t.super_=m,t.prototype=Object.create(m.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:N.exports=function(t,m){t.super_=m;var g=function(){};g.prototype=m.prototype,t.prototype=new g,t.prototype.constructor=t}},{}],82:[function(h,N,H){N.exports=function(t){return t&&typeof t=="object"&&typeof t.copy=="function"&&typeof t.fill=="function"&&typeof t.readUInt8=="function"}},{}],83:[function(h,N,H){(function(t,m){(function(){var g=/%[sdj%]/g;H.format=function(M){if(!l(M)){for(var P=[],O=0;O<arguments.length;O++)P.push(f(arguments[O]));return P.join(" ")}O=1;for(var F=arguments,j=F.length,W=String(M).replace(g,function(Q){if(Q==="%%")return"%";if(O>=j)return Q;switch(Q){case"%s":return String(F[O++]);case"%d":return Number(F[O++]);case"%j":try{return JSON.stringify(F[O++])}catch(X){return"[Circular]"}default:return Q}}),Z=F[O];O<j;Z=F[++O])n(Z)||!_(Z)?W+=" "+Z:W+=" "+f(Z);return W},H.deprecate=function(M,P){if(y(m.process))return function(){return H.deprecate(M,P).apply(this,arguments)};if(t.noDeprecation===!0)return M;var O=!1;return function(){if(!O){if(t.throwDeprecation)throw new Error(P);t.traceDeprecation?console.trace(P):console.error(P),O=!0}return M.apply(this,arguments)}};var p,e={};function f(M,P){var O={seen:[],stylize:i};return arguments.length>=3&&(O.depth=arguments[2]),arguments.length>=4&&(O.colors=arguments[3]),r(P)?O.showHidden=P:P&&H._extend(O,P),y(O.showHidden)&&(O.showHidden=!1),y(O.depth)&&(O.depth=2),y(O.colors)&&(O.colors=!1),y(O.customInspect)&&(O.customInspect=!0),O.colors&&(O.stylize=u),s(O,M,O.depth)}function u(M,P){var O=f.styles[P];return O?"["+f.colors[O][0]+"m"+M+"["+f.colors[O][1]+"m":M}function i(M,P){return M}function s(M,P,O){if(M.customInspect&&P&&A(P.inspect)&&P.inspect!==H.inspect&&(!P.constructor||P.constructor.prototype!==P)){var F=P.inspect(O,M);return l(F)||(F=s(M,F,O)),F}var j=function(D,B){if(y(B))return D.stylize("undefined","undefined");if(l(B)){var q="'"+JSON.stringify(B).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return D.stylize(q,"string")}if(d(B))return D.stylize(""+B,"number");if(r(B))return D.stylize(""+B,"boolean");if(n(B))return D.stylize("null","null")}(M,P);if(j)return j;var W=Object.keys(P),Z=function(D){var B={};return D.forEach(function(q,ee){B[q]=!0}),B}(W);if(M.showHidden&&(W=Object.getOwnPropertyNames(P)),T(P)&&(W.indexOf("message")>=0||W.indexOf("description")>=0))return o(P);if(W.length===0){if(A(P)){var Q=P.name?": "+P.name:"";return M.stylize("[Function"+Q+"]","special")}if(v(P))return M.stylize(RegExp.prototype.toString.call(P),"regexp");if(x(P))return M.stylize(Date.prototype.toString.call(P),"date");if(T(P))return o(P)}var X,G="",Y=!1,K=["{","}"];return c(P)&&(Y=!0,K=["[","]"]),A(P)&&(G=" [Function"+(P.name?": "+P.name:"")+"]"),v(P)&&(G=" "+RegExp.prototype.toString.call(P)),x(P)&&(G=" "+Date.prototype.toUTCString.call(P)),T(P)&&(G=" "+o(P)),W.length!==0||Y&&P.length!=0?O<0?v(P)?M.stylize(RegExp.prototype.toString.call(P),"regexp"):M.stylize("[Object]","special"):(M.seen.push(P),X=Y?function(D,B,q,ee,J){for(var $=[],te=0,ie=B.length;te<ie;++te)C(B,String(te))?$.push(a(D,B,q,ee,String(te),!0)):$.push("");return J.forEach(function(ae){ae.match(/^\d+$/)||$.push(a(D,B,q,ee,ae,!0))}),$}(M,P,O,Z,W):W.map(function(D){return a(M,P,O,Z,D,Y)}),M.seen.pop(),function(D,B,q){return D.reduce(function(ee,J){return J.indexOf(`
`)>=0,ee+J.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?q[0]+(B===""?"":B+`
 `)+" "+D.join(`,
  `)+" "+q[1]:q[0]+B+" "+D.join(", ")+" "+q[1]}(X,G,K)):K[0]+G+K[1]}function o(M){return"["+Error.prototype.toString.call(M)+"]"}function a(M,P,O,F,j,W){var Z,Q,X;if((X=Object.getOwnPropertyDescriptor(P,j)||{value:P[j]}).get?Q=X.set?M.stylize("[Getter/Setter]","special"):M.stylize("[Getter]","special"):X.set&&(Q=M.stylize("[Setter]","special")),C(F,j)||(Z="["+j+"]"),Q||(M.seen.indexOf(X.value)<0?(Q=n(O)?s(M,X.value,null):s(M,X.value,O-1)).indexOf(`
`)>-1&&(Q=W?Q.split(`
`).map(function(G){return"  "+G}).join(`
`).substr(2):`
`+Q.split(`
`).map(function(G){return"   "+G}).join(`
`)):Q=M.stylize("[Circular]","special")),y(Z)){if(W&&j.match(/^\d+$/))return Q;(Z=JSON.stringify(""+j)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(Z=Z.substr(1,Z.length-2),Z=M.stylize(Z,"name")):(Z=Z.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),Z=M.stylize(Z,"string"))}return Z+": "+Q}function c(M){return Array.isArray(M)}function r(M){return typeof M=="boolean"}function n(M){return M===null}function d(M){return typeof M=="number"}function l(M){return typeof M=="string"}function y(M){return M===void 0}function v(M){return _(M)&&S(M)==="[object RegExp]"}function _(M){return typeof M=="object"&&M!==null}function x(M){return _(M)&&S(M)==="[object Date]"}function T(M){return _(M)&&(S(M)==="[object Error]"||M instanceof Error)}function A(M){return typeof M=="function"}function S(M){return Object.prototype.toString.call(M)}function w(M){return M<10?"0"+M.toString(10):M.toString(10)}H.debuglog=function(M){if(y(p)&&(p=t.env.NODE_DEBUG||""),M=M.toUpperCase(),!e[M])if(new RegExp("\\b"+M+"\\b","i").test(p)){var P=t.pid;e[M]=function(){var O=H.format.apply(H,arguments);console.error("%s %d: %s",M,P,O)}}else e[M]=function(){};return e[M]},H.inspect=f,f.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},f.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},H.isArray=c,H.isBoolean=r,H.isNull=n,H.isNullOrUndefined=function(M){return M==null},H.isNumber=d,H.isString=l,H.isSymbol=function(M){return typeof M=="symbol"},H.isUndefined=y,H.isRegExp=v,H.isObject=_,H.isDate=x,H.isError=T,H.isFunction=A,H.isPrimitive=function(M){return M===null||typeof M=="boolean"||typeof M=="number"||typeof M=="string"||typeof M=="symbol"||M===void 0},H.isBuffer=h("./support/isBuffer");var L=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function k(){var M=new Date,P=[w(M.getHours()),w(M.getMinutes()),w(M.getSeconds())].join(":");return[M.getDate(),L[M.getMonth()],P].join(" ")}function C(M,P){return Object.prototype.hasOwnProperty.call(M,P)}H.log=function(){console.log("%s - %s",k(),H.format.apply(H,arguments))},H.inherits=h("inherits"),H._extend=function(M,P){if(!P||!_(P))return M;for(var O=Object.keys(P),F=O.length;F--;)M[O[F]]=P[O[F]];return M}}).call(this)}).call(this,h("_process"),typeof La!="undefined"?La:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"./support/isBuffer":82,_process:514,inherits:81}],84:[function(h,N,H){N.exports=function(t){return atob(t)}},{}],85:[function(h,N,H){N.exports=function(g,p){for(var e=p.length,f=new Array(e+1),u=0;u<e;++u){for(var i=new Array(e+1),s=0;s<=e;++s)i[s]=g[s][u];f[u]=i}for(f[e]=new Array(e+1),u=0;u<=e;++u)f[e][u]=1;var o=new Array(e+1);for(u=0;u<e;++u)o[u]=p[u];o[e]=1;var a=t(f,o),c=m(a[e+1]);c===0&&(c=1);var r=new Array(e+1);for(u=0;u<=e;++u)r[u]=m(a[u])/c;return r};var t=h("robust-linear-solve");function m(g){for(var p=0,e=0;e<g.length;++e)p+=g[e];return p}},{"robust-linear-solve":533}],86:[function(h,N,H){H.byteLength=function(s){var o=u(s),a=o[0],c=o[1];return 3*(a+c)/4-c},H.toByteArray=function(s){var o,a,c=u(s),r=c[0],n=c[1],d=new g(function(v,_,x){return 3*(_+x)/4-x}(0,r,n)),l=0,y=n>0?r-4:r;for(a=0;a<y;a+=4)o=m[s.charCodeAt(a)]<<18|m[s.charCodeAt(a+1)]<<12|m[s.charCodeAt(a+2)]<<6|m[s.charCodeAt(a+3)],d[l++]=o>>16&255,d[l++]=o>>8&255,d[l++]=255&o;return n===2&&(o=m[s.charCodeAt(a)]<<2|m[s.charCodeAt(a+1)]>>4,d[l++]=255&o),n===1&&(o=m[s.charCodeAt(a)]<<10|m[s.charCodeAt(a+1)]<<4|m[s.charCodeAt(a+2)]>>2,d[l++]=o>>8&255,d[l++]=255&o),d},H.fromByteArray=function(s){for(var o,a=s.length,c=a%3,r=[],n=0,d=a-c;n<d;n+=16383)r.push(i(s,n,n+16383>d?d:n+16383));return c===1?(o=s[a-1],r.push(t[o>>2]+t[o<<4&63]+"==")):c===2&&(o=(s[a-2]<<8)+s[a-1],r.push(t[o>>10]+t[o>>4&63]+t[o<<2&63]+"=")),r.join("")};for(var t=[],m=[],g=typeof Uint8Array!="undefined"?Uint8Array:Array,p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,f=p.length;e<f;++e)t[e]=p[e],m[p.charCodeAt(e)]=e;function u(s){var o=s.length;if(o%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var a=s.indexOf("=");return a===-1&&(a=o),[a,a===o?0:4-a%4]}function i(s,o,a){for(var c,r,n=[],d=o;d<a;d+=3)c=(s[d]<<16&16711680)+(s[d+1]<<8&65280)+(255&s[d+2]),n.push(t[(r=c)>>18&63]+t[r>>12&63]+t[r>>6&63]+t[63&r]);return n.join("")}m["-".charCodeAt(0)]=62,m["_".charCodeAt(0)]=63},{}],87:[function(h,N,H){var t=h("./lib/rationalize");N.exports=function(m,g){return t(m[0].mul(g[1]).add(g[0].mul(m[1])),m[1].mul(g[1]))}},{"./lib/rationalize":97}],88:[function(h,N,H){N.exports=function(t,m){return t[0].mul(m[1]).cmp(m[0].mul(t[1]))}},{}],89:[function(h,N,H){var t=h("./lib/rationalize");N.exports=function(m,g){return t(m[0].mul(g[1]),m[1].mul(g[0]))}},{"./lib/rationalize":97}],90:[function(h,N,H){var t=h("./is-rat"),m=h("./lib/is-bn"),g=h("./lib/num-to-bn"),p=h("./lib/str-to-bn"),e=h("./lib/rationalize"),f=h("./div");N.exports=function u(i,s){if(t(i))return s?f(i,u(s)):[i[0].clone(),i[1].clone()];var o,a,c=0;if(m(i))o=i.clone();else if(typeof i=="string")o=p(i);else{if(i===0)return[g(0),g(1)];if(i===Math.floor(i))o=g(i);else{for(;i!==Math.floor(i);)i*=Math.pow(2,256),c-=256;o=g(i)}}if(t(s))o.mul(s[1]),a=s[0].clone();else if(m(s))a=s.clone();else if(typeof s=="string")a=p(s);else if(s)if(s===Math.floor(s))a=g(s);else{for(;s!==Math.floor(s);)s*=Math.pow(2,256),c+=256;a=g(s)}else a=g(1);return c>0?o=o.ushln(c):c<0&&(a=a.ushln(-c)),e(o,a)}},{"./div":89,"./is-rat":91,"./lib/is-bn":95,"./lib/num-to-bn":96,"./lib/rationalize":97,"./lib/str-to-bn":98}],91:[function(h,N,H){var t=h("./lib/is-bn");N.exports=function(m){return Array.isArray(m)&&m.length===2&&t(m[0])&&t(m[1])}},{"./lib/is-bn":95}],92:[function(h,N,H){var t=h("bn.js");N.exports=function(m){return m.cmp(new t(0))}},{"bn.js":106}],93:[function(h,N,H){var t=h("./bn-sign");N.exports=function(m){var g=m.length,p=m.words,e=0;if(g===1)e=p[0];else if(g===2)e=p[0]+67108864*p[1];else for(var f=0;f<g;f++){var u=p[f];e+=u*Math.pow(67108864,f)}return t(m)*e}},{"./bn-sign":92}],94:[function(h,N,H){var t=h("double-bits"),m=h("bit-twiddle").countTrailingZeros;N.exports=function(g){var p=m(t.lo(g));if(p<32)return p;var e=m(t.hi(g));return e>20?52:e+32}},{"bit-twiddle":104,"double-bits":179}],95:[function(h,N,H){h("bn.js"),N.exports=function(t){return t&&typeof t=="object"&&Boolean(t.words)}},{"bn.js":106}],96:[function(h,N,H){var t=h("bn.js"),m=h("double-bits");N.exports=function(g){var p=m.exponent(g);return p<52?new t(g):new t(g*Math.pow(2,52-p)).ushln(p-52)}},{"bn.js":106,"double-bits":179}],97:[function(h,N,H){var t=h("./num-to-bn"),m=h("./bn-sign");N.exports=function(g,p){var e=m(g),f=m(p);if(e===0)return[t(0),t(1)];if(f===0)return[t(0),t(0)];f<0&&(g=g.neg(),p=p.neg());var u=g.gcd(p);return u.cmpn(1)?[g.div(u),p.div(u)]:[g,p]}},{"./bn-sign":92,"./num-to-bn":96}],98:[function(h,N,H){var t=h("bn.js");N.exports=function(m){return new t(m)}},{"bn.js":106}],99:[function(h,N,H){var t=h("./lib/rationalize");N.exports=function(m,g){return t(m[0].mul(g[0]),m[1].mul(g[1]))}},{"./lib/rationalize":97}],100:[function(h,N,H){var t=h("./lib/bn-sign");N.exports=function(m){return t(m[0])*t(m[1])}},{"./lib/bn-sign":92}],101:[function(h,N,H){var t=h("./lib/rationalize");N.exports=function(m,g){return t(m[0].mul(g[1]).sub(m[1].mul(g[0])),m[1].mul(g[1]))}},{"./lib/rationalize":97}],102:[function(h,N,H){var t=h("./lib/bn-to-num"),m=h("./lib/ctz");N.exports=function(g){var p=g[0],e=g[1];if(p.cmpn(0)===0)return 0;var f=p.abs().divmod(e.abs()),u=f.div,i=t(u),s=f.mod,o=p.negative!==e.negative?-1:1;if(s.cmpn(0)===0)return o*i;if(i){var a=m(i)+4,c=t(s.ushln(a).divRound(e));return o*(i+c*Math.pow(2,-a))}var r=e.bitLength()-s.bitLength()+53;return c=t(s.ushln(r).divRound(e)),r<1023?o*c*Math.pow(2,-r):(c*=Math.pow(2,-1023),o*c*Math.pow(2,1023-r))}},{"./lib/bn-to-num":93,"./lib/ctz":94}],103:[function(h,N,H){function t(u,i,s,o,a){for(var c=a+1;o<=a;){var r=o+a>>>1,n=u[r];(s!==void 0?s(n,i):n-i)>=0?(c=r,a=r-1):o=r+1}return c}function m(u,i,s,o,a){for(var c=a+1;o<=a;){var r=o+a>>>1,n=u[r];(s!==void 0?s(n,i):n-i)>0?(c=r,a=r-1):o=r+1}return c}function g(u,i,s,o,a){for(var c=o-1;o<=a;){var r=o+a>>>1,n=u[r];(s!==void 0?s(n,i):n-i)<0?(c=r,o=r+1):a=r-1}return c}function p(u,i,s,o,a){for(var c=o-1;o<=a;){var r=o+a>>>1,n=u[r];(s!==void 0?s(n,i):n-i)<=0?(c=r,o=r+1):a=r-1}return c}function e(u,i,s,o,a){for(;o<=a;){var c=o+a>>>1,r=u[c],n=s!==void 0?s(r,i):r-i;if(n===0)return c;n<=0?o=c+1:a=c-1}return-1}function f(u,i,s,o,a,c){return typeof s=="function"?c(u,i,s,o===void 0?0:0|o,a===void 0?u.length-1:0|a):c(u,i,void 0,s===void 0?0:0|s,o===void 0?u.length-1:0|o)}N.exports={ge:function(u,i,s,o,a){return f(u,i,s,o,a,t)},gt:function(u,i,s,o,a){return f(u,i,s,o,a,m)},lt:function(u,i,s,o,a){return f(u,i,s,o,a,g)},le:function(u,i,s,o,a){return f(u,i,s,o,a,p)},eq:function(u,i,s,o,a){return f(u,i,s,o,a,e)}}},{}],104:[function(h,N,H){function t(g){var p=32;return(g&=-g)&&p--,65535&g&&(p-=16),16711935&g&&(p-=8),252645135&g&&(p-=4),858993459&g&&(p-=2),1431655765&g&&(p-=1),p}H.INT_BITS=32,H.INT_MAX=2147483647,H.INT_MIN=-1<<31,H.sign=function(g){return(g>0)-(g<0)},H.abs=function(g){var p=g>>31;return(g^p)-p},H.min=function(g,p){return p^(g^p)&-(g<p)},H.max=function(g,p){return g^(g^p)&-(g<p)},H.isPow2=function(g){return!(g&g-1||!g)},H.log2=function(g){var p,e;return p=(g>65535)<<4,p|=e=((g>>>=p)>255)<<3,p|=e=((g>>>=e)>15)<<2,(p|=e=((g>>>=e)>3)<<1)|(g>>>=e)>>1},H.log10=function(g){return g>=1e9?9:g>=1e8?8:g>=1e7?7:g>=1e6?6:g>=1e5?5:g>=1e4?4:g>=1e3?3:g>=100?2:g>=10?1:0},H.popCount=function(g){return 16843009*((g=(858993459&(g-=g>>>1&1431655765))+(g>>>2&858993459))+(g>>>4)&252645135)>>>24},H.countTrailingZeros=t,H.nextPow2=function(g){return g+=g===0,--g,g|=g>>>1,g|=g>>>2,g|=g>>>4,g|=g>>>8,(g|=g>>>16)+1},H.prevPow2=function(g){return g|=g>>>1,g|=g>>>2,g|=g>>>4,g|=g>>>8,(g|=g>>>16)-(g>>>1)},H.parity=function(g){return g^=g>>>16,g^=g>>>8,g^=g>>>4,27030>>>(g&=15)&1};var m=new Array(256);(function(g){for(var p=0;p<256;++p){var e=p,f=p,u=7;for(e>>>=1;e;e>>>=1)f<<=1,f|=1&e,--u;g[p]=f<<u&255}})(m),H.reverse=function(g){return m[255&g]<<24|m[g>>>8&255]<<16|m[g>>>16&255]<<8|m[g>>>24&255]},H.interleave2=function(g,p){return(g=1431655765&((g=858993459&((g=252645135&((g=16711935&((g&=65535)|g<<8))|g<<4))|g<<2))|g<<1))|(p=1431655765&((p=858993459&((p=252645135&((p=16711935&((p&=65535)|p<<8))|p<<4))|p<<2))|p<<1))<<1},H.deinterleave2=function(g,p){return(g=65535&((g=16711935&((g=252645135&((g=858993459&((g=g>>>p&1431655765)|g>>>1))|g>>>2))|g>>>4))|g>>>16))<<16>>16},H.interleave3=function(g,p,e){return g=1227133513&((g=3272356035&((g=251719695&((g=4278190335&((g&=1023)|g<<16))|g<<8))|g<<4))|g<<2),(g|=(p=1227133513&((p=3272356035&((p=251719695&((p=4278190335&((p&=1023)|p<<16))|p<<8))|p<<4))|p<<2))<<1)|(e=1227133513&((e=3272356035&((e=251719695&((e=4278190335&((e&=1023)|e<<16))|e<<8))|e<<4))|e<<2))<<2},H.deinterleave3=function(g,p){return(g=1023&((g=4278190335&((g=251719695&((g=3272356035&((g=g>>>p&1227133513)|g>>>2))|g>>>4))|g>>>8))|g>>>16))<<22>>22},H.nextCombination=function(g){var p=g|g-1;return p+1|(~p&-~p)-1>>>t(g)+1}},{}],105:[function(h,N,H){var t=h("clamp");N.exports=function(e,f){f||(f={});var u,i,s,o,a,c,r,n,d,l,y,v=f.cutoff==null?.25:f.cutoff,_=f.radius==null?8:f.radius,x=f.channel||0;if(ArrayBuffer.isView(e)||Array.isArray(e)){if(!f.width||!f.height)throw Error("For raw data width and height should be provided by options");u=f.width,i=f.height,o=e,c=f.stride?f.stride:Math.floor(e.length/u/i)}else window.HTMLCanvasElement&&e instanceof window.HTMLCanvasElement?(r=(n=e).getContext("2d"),u=n.width,i=n.height,d=r.getImageData(0,0,u,i),o=d.data,c=4):window.CanvasRenderingContext2D&&e instanceof window.CanvasRenderingContext2D?(n=e.canvas,r=e,u=n.width,i=n.height,d=r.getImageData(0,0,u,i),o=d.data,c=4):window.ImageData&&e instanceof window.ImageData&&(d=e,u=e.width,i=e.height,o=d.data,c=4);if(s=Math.max(u,i),window.Uint8ClampedArray&&o instanceof window.Uint8ClampedArray||window.Uint8Array&&o instanceof window.Uint8Array)for(a=o,o=Array(u*i),l=0,y=a.length;l<y;l++)o[l]=a[l*c+x]/255;else if(c!==1)throw Error("Raw data can have only 1 value per pixel");var T=Array(u*i),A=Array(u*i),S=Array(s),w=Array(s),L=Array(s+1),k=Array(s);for(l=0,y=u*i;l<y;l++){var C=o[l];T[l]=C===1?0:C===0?m:Math.pow(Math.max(0,.5-C),2),A[l]=C===1?m:C===0?0:Math.pow(Math.max(0,C-.5),2)}g(T,u,i,S,w,k,L),g(A,u,i,S,w,k,L);var M=window.Float32Array?new Float32Array(u*i):new Array(u*i);for(l=0,y=u*i;l<y;l++)M[l]=t(1-((T[l]-A[l])/_+v),0,1);return M};var m=1e20;function g(e,f,u,i,s,o,a){for(var c=0;c<f;c++){for(var r=0;r<u;r++)i[r]=e[r*f+c];for(p(i,s,o,a,u),r=0;r<u;r++)e[r*f+c]=s[r]}for(r=0;r<u;r++){for(c=0;c<f;c++)i[c]=e[r*f+c];for(p(i,s,o,a,f),c=0;c<f;c++)e[r*f+c]=Math.sqrt(s[c])}}function p(e,f,u,i,s){u[0]=0,i[0]=-m,i[1]=+m;for(var o=1,a=0;o<s;o++){for(var c=(e[o]+o*o-(e[u[a]]+u[a]*u[a]))/(2*o-2*u[a]);c<=i[a];)a--,c=(e[o]+o*o-(e[u[a]]+u[a]*u[a]))/(2*o-2*u[a]);u[++a]=o,i[a]=c,i[a+1]=+m}for(o=0,a=0;o<s;o++){for(;i[a+1]<o;)a++;f[o]=(o-u[a])*(o-u[a])+e[u[a]]}}},{clamp:126}],106:[function(h,N,H){(function(t,m){function g(w,L){if(!w)throw new Error(L||"Assertion failed")}function p(w,L){w.super_=L;var k=function(){};k.prototype=L.prototype,w.prototype=new k,w.prototype.constructor=w}function e(w,L,k){if(e.isBN(w))return w;this.negative=0,this.words=null,this.length=0,this.red=null,w!==null&&(L!=="le"&&L!=="be"||(k=L,L=10),this._init(w||0,L||10,k||"be"))}var f;typeof t=="object"?t.exports=e:m.BN=e,e.BN=e,e.wordSize=26;try{f=h("buffer").Buffer}catch(w){}function u(w,L,k){for(var C=0,M=Math.min(w.length,k),P=L;P<M;P++){var O=w.charCodeAt(P)-48;C<<=4,C|=O>=49&&O<=54?O-49+10:O>=17&&O<=22?O-17+10:15&O}return C}function i(w,L,k,C){for(var M=0,P=Math.min(w.length,k),O=L;O<P;O++){var F=w.charCodeAt(O)-48;M*=C,M+=F>=49?F-49+10:F>=17?F-17+10:F}return M}e.isBN=function(w){return w instanceof e||w!==null&&typeof w=="object"&&w.constructor.wordSize===e.wordSize&&Array.isArray(w.words)},e.max=function(w,L){return w.cmp(L)>0?w:L},e.min=function(w,L){return w.cmp(L)<0?w:L},e.prototype._init=function(w,L,k){if(typeof w=="number")return this._initNumber(w,L,k);if(typeof w=="object")return this._initArray(w,L,k);L==="hex"&&(L=16),g(L===(0|L)&&L>=2&&L<=36);var C=0;(w=w.toString().replace(/\s+/g,""))[0]==="-"&&C++,L===16?this._parseHex(w,C):this._parseBase(w,L,C),w[0]==="-"&&(this.negative=1),this.strip(),k==="le"&&this._initArray(this.toArray(),L,k)},e.prototype._initNumber=function(w,L,k){w<0&&(this.negative=1,w=-w),w<67108864?(this.words=[67108863&w],this.length=1):w<4503599627370496?(this.words=[67108863&w,w/67108864&67108863],this.length=2):(g(w<9007199254740992),this.words=[67108863&w,w/67108864&67108863,1],this.length=3),k==="le"&&this._initArray(this.toArray(),L,k)},e.prototype._initArray=function(w,L,k){if(g(typeof w.length=="number"),w.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(w.length/3),this.words=new Array(this.length);for(var C=0;C<this.length;C++)this.words[C]=0;var M,P,O=0;if(k==="be")for(C=w.length-1,M=0;C>=0;C-=3)P=w[C]|w[C-1]<<8|w[C-2]<<16,this.words[M]|=P<<O&67108863,this.words[M+1]=P>>>26-O&67108863,(O+=24)>=26&&(O-=26,M++);else if(k==="le")for(C=0,M=0;C<w.length;C+=3)P=w[C]|w[C+1]<<8|w[C+2]<<16,this.words[M]|=P<<O&67108863,this.words[M+1]=P>>>26-O&67108863,(O+=24)>=26&&(O-=26,M++);return this.strip()},e.prototype._parseHex=function(w,L){this.length=Math.ceil((w.length-L)/6),this.words=new Array(this.length);for(var k=0;k<this.length;k++)this.words[k]=0;var C,M,P=0;for(k=w.length-6,C=0;k>=L;k-=6)M=u(w,k,k+6),this.words[C]|=M<<P&67108863,this.words[C+1]|=M>>>26-P&4194303,(P+=24)>=26&&(P-=26,C++);k+6!==L&&(M=u(w,L,k+6),this.words[C]|=M<<P&67108863,this.words[C+1]|=M>>>26-P&4194303),this.strip()},e.prototype._parseBase=function(w,L,k){this.words=[0],this.length=1;for(var C=0,M=1;M<=67108863;M*=L)C++;C--,M=M/L|0;for(var P=w.length-k,O=P%C,F=Math.min(P,P-O)+k,j=0,W=k;W<F;W+=C)j=i(w,W,W+C,L),this.imuln(M),this.words[0]+j<67108864?this.words[0]+=j:this._iaddn(j);if(O!==0){var Z=1;for(j=i(w,W,w.length,L),W=0;W<O;W++)Z*=L;this.imuln(Z),this.words[0]+j<67108864?this.words[0]+=j:this._iaddn(j)}},e.prototype.copy=function(w){w.words=new Array(this.length);for(var L=0;L<this.length;L++)w.words[L]=this.words[L];w.length=this.length,w.negative=this.negative,w.red=this.red},e.prototype.clone=function(){var w=new e(null);return this.copy(w),w},e.prototype._expand=function(w){for(;this.length<w;)this.words[this.length++]=0;return this},e.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},e.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},e.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var s=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],o=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],a=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function c(w,L,k){k.negative=L.negative^w.negative;var C=w.length+L.length|0;k.length=C,C=C-1|0;var M=0|w.words[0],P=0|L.words[0],O=M*P,F=67108863&O,j=O/67108864|0;k.words[0]=F;for(var W=1;W<C;W++){for(var Z=j>>>26,Q=67108863&j,X=Math.min(W,L.length-1),G=Math.max(0,W-w.length+1);G<=X;G++){var Y=W-G|0;Z+=(O=(M=0|w.words[Y])*(P=0|L.words[G])+Q)/67108864|0,Q=67108863&O}k.words[W]=0|Q,j=0|Z}return j!==0?k.words[W]=0|j:k.length--,k.strip()}e.prototype.toString=function(w,L){var k;if(L=0|L||1,(w=w||10)===16||w==="hex"){k="";for(var C=0,M=0,P=0;P<this.length;P++){var O=this.words[P],F=(16777215&(O<<C|M)).toString(16);k=(M=O>>>24-C&16777215)!=0||P!==this.length-1?s[6-F.length]+F+k:F+k,(C+=2)>=26&&(C-=26,P--)}for(M!==0&&(k=M.toString(16)+k);k.length%L!=0;)k="0"+k;return this.negative!==0&&(k="-"+k),k}if(w===(0|w)&&w>=2&&w<=36){var j=o[w],W=a[w];k="";var Z=this.clone();for(Z.negative=0;!Z.isZero();){var Q=Z.modn(W).toString(w);k=(Z=Z.idivn(W)).isZero()?Q+k:s[j-Q.length]+Q+k}for(this.isZero()&&(k="0"+k);k.length%L!=0;)k="0"+k;return this.negative!==0&&(k="-"+k),k}g(!1,"Base should be between 2 and 36")},e.prototype.toNumber=function(){var w=this.words[0];return this.length===2?w+=67108864*this.words[1]:this.length===3&&this.words[2]===1?w+=4503599627370496+67108864*this.words[1]:this.length>2&&g(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-w:w},e.prototype.toJSON=function(){return this.toString(16)},e.prototype.toBuffer=function(w,L){return g(f!==void 0),this.toArrayLike(f,w,L)},e.prototype.toArray=function(w,L){return this.toArrayLike(Array,w,L)},e.prototype.toArrayLike=function(w,L,k){var C=this.byteLength(),M=k||Math.max(1,C);g(C<=M,"byte array longer than desired length"),g(M>0,"Requested array length <= 0"),this.strip();var P,O,F=L==="le",j=new w(M),W=this.clone();if(F){for(O=0;!W.isZero();O++)P=W.andln(255),W.iushrn(8),j[O]=P;for(;O<M;O++)j[O]=0}else{for(O=0;O<M-C;O++)j[O]=0;for(O=0;!W.isZero();O++)P=W.andln(255),W.iushrn(8),j[M-O-1]=P}return j},Math.clz32?e.prototype._countBits=function(w){return 32-Math.clz32(w)}:e.prototype._countBits=function(w){var L=w,k=0;return L>=4096&&(k+=13,L>>>=13),L>=64&&(k+=7,L>>>=7),L>=8&&(k+=4,L>>>=4),L>=2&&(k+=2,L>>>=2),k+L},e.prototype._zeroBits=function(w){if(w===0)return 26;var L=w,k=0;return(8191&L)==0&&(k+=13,L>>>=13),(127&L)==0&&(k+=7,L>>>=7),(15&L)==0&&(k+=4,L>>>=4),(3&L)==0&&(k+=2,L>>>=2),(1&L)==0&&k++,k},e.prototype.bitLength=function(){var w=this.words[this.length-1],L=this._countBits(w);return 26*(this.length-1)+L},e.prototype.zeroBits=function(){if(this.isZero())return 0;for(var w=0,L=0;L<this.length;L++){var k=this._zeroBits(this.words[L]);if(w+=k,k!==26)break}return w},e.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},e.prototype.toTwos=function(w){return this.negative!==0?this.abs().inotn(w).iaddn(1):this.clone()},e.prototype.fromTwos=function(w){return this.testn(w-1)?this.notn(w).iaddn(1).ineg():this.clone()},e.prototype.isNeg=function(){return this.negative!==0},e.prototype.neg=function(){return this.clone().ineg()},e.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},e.prototype.iuor=function(w){for(;this.length<w.length;)this.words[this.length++]=0;for(var L=0;L<w.length;L++)this.words[L]=this.words[L]|w.words[L];return this.strip()},e.prototype.ior=function(w){return g((this.negative|w.negative)==0),this.iuor(w)},e.prototype.or=function(w){return this.length>w.length?this.clone().ior(w):w.clone().ior(this)},e.prototype.uor=function(w){return this.length>w.length?this.clone().iuor(w):w.clone().iuor(this)},e.prototype.iuand=function(w){var L;L=this.length>w.length?w:this;for(var k=0;k<L.length;k++)this.words[k]=this.words[k]&w.words[k];return this.length=L.length,this.strip()},e.prototype.iand=function(w){return g((this.negative|w.negative)==0),this.iuand(w)},e.prototype.and=function(w){return this.length>w.length?this.clone().iand(w):w.clone().iand(this)},e.prototype.uand=function(w){return this.length>w.length?this.clone().iuand(w):w.clone().iuand(this)},e.prototype.iuxor=function(w){var L,k;this.length>w.length?(L=this,k=w):(L=w,k=this);for(var C=0;C<k.length;C++)this.words[C]=L.words[C]^k.words[C];if(this!==L)for(;C<L.length;C++)this.words[C]=L.words[C];return this.length=L.length,this.strip()},e.prototype.ixor=function(w){return g((this.negative|w.negative)==0),this.iuxor(w)},e.prototype.xor=function(w){return this.length>w.length?this.clone().ixor(w):w.clone().ixor(this)},e.prototype.uxor=function(w){return this.length>w.length?this.clone().iuxor(w):w.clone().iuxor(this)},e.prototype.inotn=function(w){g(typeof w=="number"&&w>=0);var L=0|Math.ceil(w/26),k=w%26;this._expand(L),k>0&&L--;for(var C=0;C<L;C++)this.words[C]=67108863&~this.words[C];return k>0&&(this.words[C]=~this.words[C]&67108863>>26-k),this.strip()},e.prototype.notn=function(w){return this.clone().inotn(w)},e.prototype.setn=function(w,L){g(typeof w=="number"&&w>=0);var k=w/26|0,C=w%26;return this._expand(k+1),this.words[k]=L?this.words[k]|1<<C:this.words[k]&~(1<<C),this.strip()},e.prototype.iadd=function(w){var L,k,C;if(this.negative!==0&&w.negative===0)return this.negative=0,L=this.isub(w),this.negative^=1,this._normSign();if(this.negative===0&&w.negative!==0)return w.negative=0,L=this.isub(w),w.negative=1,L._normSign();this.length>w.length?(k=this,C=w):(k=w,C=this);for(var M=0,P=0;P<C.length;P++)L=(0|k.words[P])+(0|C.words[P])+M,this.words[P]=67108863&L,M=L>>>26;for(;M!==0&&P<k.length;P++)L=(0|k.words[P])+M,this.words[P]=67108863&L,M=L>>>26;if(this.length=k.length,M!==0)this.words[this.length]=M,this.length++;else if(k!==this)for(;P<k.length;P++)this.words[P]=k.words[P];return this},e.prototype.add=function(w){var L;return w.negative!==0&&this.negative===0?(w.negative=0,L=this.sub(w),w.negative^=1,L):w.negative===0&&this.negative!==0?(this.negative=0,L=w.sub(this),this.negative=1,L):this.length>w.length?this.clone().iadd(w):w.clone().iadd(this)},e.prototype.isub=function(w){if(w.negative!==0){w.negative=0;var L=this.iadd(w);return w.negative=1,L._normSign()}if(this.negative!==0)return this.negative=0,this.iadd(w),this.negative=1,this._normSign();var k,C,M=this.cmp(w);if(M===0)return this.negative=0,this.length=1,this.words[0]=0,this;M>0?(k=this,C=w):(k=w,C=this);for(var P=0,O=0;O<C.length;O++)P=(L=(0|k.words[O])-(0|C.words[O])+P)>>26,this.words[O]=67108863&L;for(;P!==0&&O<k.length;O++)P=(L=(0|k.words[O])+P)>>26,this.words[O]=67108863&L;if(P===0&&O<k.length&&k!==this)for(;O<k.length;O++)this.words[O]=k.words[O];return this.length=Math.max(this.length,O),k!==this&&(this.negative=1),this.strip()},e.prototype.sub=function(w){return this.clone().isub(w)};var r=function(w,L,k){var C,M,P,O=w.words,F=L.words,j=k.words,W=0,Z=0|O[0],Q=8191&Z,X=Z>>>13,G=0|O[1],Y=8191&G,K=G>>>13,D=0|O[2],B=8191&D,q=D>>>13,ee=0|O[3],J=8191&ee,$=ee>>>13,te=0|O[4],ie=8191&te,ae=te>>>13,he=0|O[5],se=8191&he,de=he>>>13,ce=0|O[6],ve=8191&ce,ke=ce>>>13,Ee=0|O[7],be=8191&Ee,xe=Ee>>>13,ue=0|O[8],me=8191&ue,we=ue>>>13,Me=0|O[9],Se=8191&Me,De=Me>>>13,Fe=0|F[0],Ye=8191&Fe,et=Fe>>>13,Oe=0|F[1],je=8191&Oe,We=Oe>>>13,Ge=0|F[2],Qe=8191&Ge,it=Ge>>>13,lt=0|F[3],Lt=8191&lt,wt=lt>>>13,rt=0|F[4],$e=8191&rt,xt=rt>>>13,Qt=0|F[5],$t=8191&Qt,Ue=Qt>>>13,He=0|F[6],Be=8191&He,Je=He>>>13,_e=0|F[7],Le=8191&_e,Ce=_e>>>13,Pe=0|F[8],Xe=8191&Pe,ut=Pe>>>13,kt=0|F[9],ft=8191&kt,Et=kt>>>13;k.negative=w.negative^L.negative,k.length=19;var mt=(W+(C=Math.imul(Q,Ye))|0)+((8191&(M=(M=Math.imul(Q,et))+Math.imul(X,Ye)|0))<<13)|0;W=((P=Math.imul(X,et))+(M>>>13)|0)+(mt>>>26)|0,mt&=67108863,C=Math.imul(Y,Ye),M=(M=Math.imul(Y,et))+Math.imul(K,Ye)|0,P=Math.imul(K,et);var It=(W+(C=C+Math.imul(Q,je)|0)|0)+((8191&(M=(M=M+Math.imul(Q,We)|0)+Math.imul(X,je)|0))<<13)|0;W=((P=P+Math.imul(X,We)|0)+(M>>>13)|0)+(It>>>26)|0,It&=67108863,C=Math.imul(B,Ye),M=(M=Math.imul(B,et))+Math.imul(q,Ye)|0,P=Math.imul(q,et),C=C+Math.imul(Y,je)|0,M=(M=M+Math.imul(Y,We)|0)+Math.imul(K,je)|0,P=P+Math.imul(K,We)|0;var vt=(W+(C=C+Math.imul(Q,Qe)|0)|0)+((8191&(M=(M=M+Math.imul(Q,it)|0)+Math.imul(X,Qe)|0))<<13)|0;W=((P=P+Math.imul(X,it)|0)+(M>>>13)|0)+(vt>>>26)|0,vt&=67108863,C=Math.imul(J,Ye),M=(M=Math.imul(J,et))+Math.imul($,Ye)|0,P=Math.imul($,et),C=C+Math.imul(B,je)|0,M=(M=M+Math.imul(B,We)|0)+Math.imul(q,je)|0,P=P+Math.imul(q,We)|0,C=C+Math.imul(Y,Qe)|0,M=(M=M+Math.imul(Y,it)|0)+Math.imul(K,Qe)|0,P=P+Math.imul(K,it)|0;var nt=(W+(C=C+Math.imul(Q,Lt)|0)|0)+((8191&(M=(M=M+Math.imul(Q,wt)|0)+Math.imul(X,Lt)|0))<<13)|0;W=((P=P+Math.imul(X,wt)|0)+(M>>>13)|0)+(nt>>>26)|0,nt&=67108863,C=Math.imul(ie,Ye),M=(M=Math.imul(ie,et))+Math.imul(ae,Ye)|0,P=Math.imul(ae,et),C=C+Math.imul(J,je)|0,M=(M=M+Math.imul(J,We)|0)+Math.imul($,je)|0,P=P+Math.imul($,We)|0,C=C+Math.imul(B,Qe)|0,M=(M=M+Math.imul(B,it)|0)+Math.imul(q,Qe)|0,P=P+Math.imul(q,it)|0,C=C+Math.imul(Y,Lt)|0,M=(M=M+Math.imul(Y,wt)|0)+Math.imul(K,Lt)|0,P=P+Math.imul(K,wt)|0;var At=(W+(C=C+Math.imul(Q,$e)|0)|0)+((8191&(M=(M=M+Math.imul(Q,xt)|0)+Math.imul(X,$e)|0))<<13)|0;W=((P=P+Math.imul(X,xt)|0)+(M>>>13)|0)+(At>>>26)|0,At&=67108863,C=Math.imul(se,Ye),M=(M=Math.imul(se,et))+Math.imul(de,Ye)|0,P=Math.imul(de,et),C=C+Math.imul(ie,je)|0,M=(M=M+Math.imul(ie,We)|0)+Math.imul(ae,je)|0,P=P+Math.imul(ae,We)|0,C=C+Math.imul(J,Qe)|0,M=(M=M+Math.imul(J,it)|0)+Math.imul($,Qe)|0,P=P+Math.imul($,it)|0,C=C+Math.imul(B,Lt)|0,M=(M=M+Math.imul(B,wt)|0)+Math.imul(q,Lt)|0,P=P+Math.imul(q,wt)|0,C=C+Math.imul(Y,$e)|0,M=(M=M+Math.imul(Y,xt)|0)+Math.imul(K,$e)|0,P=P+Math.imul(K,xt)|0;var Ft=(W+(C=C+Math.imul(Q,$t)|0)|0)+((8191&(M=(M=M+Math.imul(Q,Ue)|0)+Math.imul(X,$t)|0))<<13)|0;W=((P=P+Math.imul(X,Ue)|0)+(M>>>13)|0)+(Ft>>>26)|0,Ft&=67108863,C=Math.imul(ve,Ye),M=(M=Math.imul(ve,et))+Math.imul(ke,Ye)|0,P=Math.imul(ke,et),C=C+Math.imul(se,je)|0,M=(M=M+Math.imul(se,We)|0)+Math.imul(de,je)|0,P=P+Math.imul(de,We)|0,C=C+Math.imul(ie,Qe)|0,M=(M=M+Math.imul(ie,it)|0)+Math.imul(ae,Qe)|0,P=P+Math.imul(ae,it)|0,C=C+Math.imul(J,Lt)|0,M=(M=M+Math.imul(J,wt)|0)+Math.imul($,Lt)|0,P=P+Math.imul($,wt)|0,C=C+Math.imul(B,$e)|0,M=(M=M+Math.imul(B,xt)|0)+Math.imul(q,$e)|0,P=P+Math.imul(q,xt)|0,C=C+Math.imul(Y,$t)|0,M=(M=M+Math.imul(Y,Ue)|0)+Math.imul(K,$t)|0,P=P+Math.imul(K,Ue)|0;var Nt=(W+(C=C+Math.imul(Q,Be)|0)|0)+((8191&(M=(M=M+Math.imul(Q,Je)|0)+Math.imul(X,Be)|0))<<13)|0;W=((P=P+Math.imul(X,Je)|0)+(M>>>13)|0)+(Nt>>>26)|0,Nt&=67108863,C=Math.imul(be,Ye),M=(M=Math.imul(be,et))+Math.imul(xe,Ye)|0,P=Math.imul(xe,et),C=C+Math.imul(ve,je)|0,M=(M=M+Math.imul(ve,We)|0)+Math.imul(ke,je)|0,P=P+Math.imul(ke,We)|0,C=C+Math.imul(se,Qe)|0,M=(M=M+Math.imul(se,it)|0)+Math.imul(de,Qe)|0,P=P+Math.imul(de,it)|0,C=C+Math.imul(ie,Lt)|0,M=(M=M+Math.imul(ie,wt)|0)+Math.imul(ae,Lt)|0,P=P+Math.imul(ae,wt)|0,C=C+Math.imul(J,$e)|0,M=(M=M+Math.imul(J,xt)|0)+Math.imul($,$e)|0,P=P+Math.imul($,xt)|0,C=C+Math.imul(B,$t)|0,M=(M=M+Math.imul(B,Ue)|0)+Math.imul(q,$t)|0,P=P+Math.imul(q,Ue)|0,C=C+Math.imul(Y,Be)|0,M=(M=M+Math.imul(Y,Je)|0)+Math.imul(K,Be)|0,P=P+Math.imul(K,Je)|0;var Kt=(W+(C=C+Math.imul(Q,Le)|0)|0)+((8191&(M=(M=M+Math.imul(Q,Ce)|0)+Math.imul(X,Le)|0))<<13)|0;W=((P=P+Math.imul(X,Ce)|0)+(M>>>13)|0)+(Kt>>>26)|0,Kt&=67108863,C=Math.imul(me,Ye),M=(M=Math.imul(me,et))+Math.imul(we,Ye)|0,P=Math.imul(we,et),C=C+Math.imul(be,je)|0,M=(M=M+Math.imul(be,We)|0)+Math.imul(xe,je)|0,P=P+Math.imul(xe,We)|0,C=C+Math.imul(ve,Qe)|0,M=(M=M+Math.imul(ve,it)|0)+Math.imul(ke,Qe)|0,P=P+Math.imul(ke,it)|0,C=C+Math.imul(se,Lt)|0,M=(M=M+Math.imul(se,wt)|0)+Math.imul(de,Lt)|0,P=P+Math.imul(de,wt)|0,C=C+Math.imul(ie,$e)|0,M=(M=M+Math.imul(ie,xt)|0)+Math.imul(ae,$e)|0,P=P+Math.imul(ae,xt)|0,C=C+Math.imul(J,$t)|0,M=(M=M+Math.imul(J,Ue)|0)+Math.imul($,$t)|0,P=P+Math.imul($,Ue)|0,C=C+Math.imul(B,Be)|0,M=(M=M+Math.imul(B,Je)|0)+Math.imul(q,Be)|0,P=P+Math.imul(q,Je)|0,C=C+Math.imul(Y,Le)|0,M=(M=M+Math.imul(Y,Ce)|0)+Math.imul(K,Le)|0,P=P+Math.imul(K,Ce)|0;var Ie=(W+(C=C+Math.imul(Q,Xe)|0)|0)+((8191&(M=(M=M+Math.imul(Q,ut)|0)+Math.imul(X,Xe)|0))<<13)|0;W=((P=P+Math.imul(X,ut)|0)+(M>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,C=Math.imul(Se,Ye),M=(M=Math.imul(Se,et))+Math.imul(De,Ye)|0,P=Math.imul(De,et),C=C+Math.imul(me,je)|0,M=(M=M+Math.imul(me,We)|0)+Math.imul(we,je)|0,P=P+Math.imul(we,We)|0,C=C+Math.imul(be,Qe)|0,M=(M=M+Math.imul(be,it)|0)+Math.imul(xe,Qe)|0,P=P+Math.imul(xe,it)|0,C=C+Math.imul(ve,Lt)|0,M=(M=M+Math.imul(ve,wt)|0)+Math.imul(ke,Lt)|0,P=P+Math.imul(ke,wt)|0,C=C+Math.imul(se,$e)|0,M=(M=M+Math.imul(se,xt)|0)+Math.imul(de,$e)|0,P=P+Math.imul(de,xt)|0,C=C+Math.imul(ie,$t)|0,M=(M=M+Math.imul(ie,Ue)|0)+Math.imul(ae,$t)|0,P=P+Math.imul(ae,Ue)|0,C=C+Math.imul(J,Be)|0,M=(M=M+Math.imul(J,Je)|0)+Math.imul($,Be)|0,P=P+Math.imul($,Je)|0,C=C+Math.imul(B,Le)|0,M=(M=M+Math.imul(B,Ce)|0)+Math.imul(q,Le)|0,P=P+Math.imul(q,Ce)|0,C=C+Math.imul(Y,Xe)|0,M=(M=M+Math.imul(Y,ut)|0)+Math.imul(K,Xe)|0,P=P+Math.imul(K,ut)|0;var ot=(W+(C=C+Math.imul(Q,ft)|0)|0)+((8191&(M=(M=M+Math.imul(Q,Et)|0)+Math.imul(X,ft)|0))<<13)|0;W=((P=P+Math.imul(X,Et)|0)+(M>>>13)|0)+(ot>>>26)|0,ot&=67108863,C=Math.imul(Se,je),M=(M=Math.imul(Se,We))+Math.imul(De,je)|0,P=Math.imul(De,We),C=C+Math.imul(me,Qe)|0,M=(M=M+Math.imul(me,it)|0)+Math.imul(we,Qe)|0,P=P+Math.imul(we,it)|0,C=C+Math.imul(be,Lt)|0,M=(M=M+Math.imul(be,wt)|0)+Math.imul(xe,Lt)|0,P=P+Math.imul(xe,wt)|0,C=C+Math.imul(ve,$e)|0,M=(M=M+Math.imul(ve,xt)|0)+Math.imul(ke,$e)|0,P=P+Math.imul(ke,xt)|0,C=C+Math.imul(se,$t)|0,M=(M=M+Math.imul(se,Ue)|0)+Math.imul(de,$t)|0,P=P+Math.imul(de,Ue)|0,C=C+Math.imul(ie,Be)|0,M=(M=M+Math.imul(ie,Je)|0)+Math.imul(ae,Be)|0,P=P+Math.imul(ae,Je)|0,C=C+Math.imul(J,Le)|0,M=(M=M+Math.imul(J,Ce)|0)+Math.imul($,Le)|0,P=P+Math.imul($,Ce)|0,C=C+Math.imul(B,Xe)|0,M=(M=M+Math.imul(B,ut)|0)+Math.imul(q,Xe)|0,P=P+Math.imul(q,ut)|0;var bt=(W+(C=C+Math.imul(Y,ft)|0)|0)+((8191&(M=(M=M+Math.imul(Y,Et)|0)+Math.imul(K,ft)|0))<<13)|0;W=((P=P+Math.imul(K,Et)|0)+(M>>>13)|0)+(bt>>>26)|0,bt&=67108863,C=Math.imul(Se,Qe),M=(M=Math.imul(Se,it))+Math.imul(De,Qe)|0,P=Math.imul(De,it),C=C+Math.imul(me,Lt)|0,M=(M=M+Math.imul(me,wt)|0)+Math.imul(we,Lt)|0,P=P+Math.imul(we,wt)|0,C=C+Math.imul(be,$e)|0,M=(M=M+Math.imul(be,xt)|0)+Math.imul(xe,$e)|0,P=P+Math.imul(xe,xt)|0,C=C+Math.imul(ve,$t)|0,M=(M=M+Math.imul(ve,Ue)|0)+Math.imul(ke,$t)|0,P=P+Math.imul(ke,Ue)|0,C=C+Math.imul(se,Be)|0,M=(M=M+Math.imul(se,Je)|0)+Math.imul(de,Be)|0,P=P+Math.imul(de,Je)|0,C=C+Math.imul(ie,Le)|0,M=(M=M+Math.imul(ie,Ce)|0)+Math.imul(ae,Le)|0,P=P+Math.imul(ae,Ce)|0,C=C+Math.imul(J,Xe)|0,M=(M=M+Math.imul(J,ut)|0)+Math.imul($,Xe)|0,P=P+Math.imul($,ut)|0;var Pt=(W+(C=C+Math.imul(B,ft)|0)|0)+((8191&(M=(M=M+Math.imul(B,Et)|0)+Math.imul(q,ft)|0))<<13)|0;W=((P=P+Math.imul(q,Et)|0)+(M>>>13)|0)+(Pt>>>26)|0,Pt&=67108863,C=Math.imul(Se,Lt),M=(M=Math.imul(Se,wt))+Math.imul(De,Lt)|0,P=Math.imul(De,wt),C=C+Math.imul(me,$e)|0,M=(M=M+Math.imul(me,xt)|0)+Math.imul(we,$e)|0,P=P+Math.imul(we,xt)|0,C=C+Math.imul(be,$t)|0,M=(M=M+Math.imul(be,Ue)|0)+Math.imul(xe,$t)|0,P=P+Math.imul(xe,Ue)|0,C=C+Math.imul(ve,Be)|0,M=(M=M+Math.imul(ve,Je)|0)+Math.imul(ke,Be)|0,P=P+Math.imul(ke,Je)|0,C=C+Math.imul(se,Le)|0,M=(M=M+Math.imul(se,Ce)|0)+Math.imul(de,Le)|0,P=P+Math.imul(de,Ce)|0,C=C+Math.imul(ie,Xe)|0,M=(M=M+Math.imul(ie,ut)|0)+Math.imul(ae,Xe)|0,P=P+Math.imul(ae,ut)|0;var Vt=(W+(C=C+Math.imul(J,ft)|0)|0)+((8191&(M=(M=M+Math.imul(J,Et)|0)+Math.imul($,ft)|0))<<13)|0;W=((P=P+Math.imul($,Et)|0)+(M>>>13)|0)+(Vt>>>26)|0,Vt&=67108863,C=Math.imul(Se,$e),M=(M=Math.imul(Se,xt))+Math.imul(De,$e)|0,P=Math.imul(De,xt),C=C+Math.imul(me,$t)|0,M=(M=M+Math.imul(me,Ue)|0)+Math.imul(we,$t)|0,P=P+Math.imul(we,Ue)|0,C=C+Math.imul(be,Be)|0,M=(M=M+Math.imul(be,Je)|0)+Math.imul(xe,Be)|0,P=P+Math.imul(xe,Je)|0,C=C+Math.imul(ve,Le)|0,M=(M=M+Math.imul(ve,Ce)|0)+Math.imul(ke,Le)|0,P=P+Math.imul(ke,Ce)|0,C=C+Math.imul(se,Xe)|0,M=(M=M+Math.imul(se,ut)|0)+Math.imul(de,Xe)|0,P=P+Math.imul(de,ut)|0;var nr=(W+(C=C+Math.imul(ie,ft)|0)|0)+((8191&(M=(M=M+Math.imul(ie,Et)|0)+Math.imul(ae,ft)|0))<<13)|0;W=((P=P+Math.imul(ae,Et)|0)+(M>>>13)|0)+(nr>>>26)|0,nr&=67108863,C=Math.imul(Se,$t),M=(M=Math.imul(Se,Ue))+Math.imul(De,$t)|0,P=Math.imul(De,Ue),C=C+Math.imul(me,Be)|0,M=(M=M+Math.imul(me,Je)|0)+Math.imul(we,Be)|0,P=P+Math.imul(we,Je)|0,C=C+Math.imul(be,Le)|0,M=(M=M+Math.imul(be,Ce)|0)+Math.imul(xe,Le)|0,P=P+Math.imul(xe,Ce)|0,C=C+Math.imul(ve,Xe)|0,M=(M=M+Math.imul(ve,ut)|0)+Math.imul(ke,Xe)|0,P=P+Math.imul(ke,ut)|0;var Yt=(W+(C=C+Math.imul(se,ft)|0)|0)+((8191&(M=(M=M+Math.imul(se,Et)|0)+Math.imul(de,ft)|0))<<13)|0;W=((P=P+Math.imul(de,Et)|0)+(M>>>13)|0)+(Yt>>>26)|0,Yt&=67108863,C=Math.imul(Se,Be),M=(M=Math.imul(Se,Je))+Math.imul(De,Be)|0,P=Math.imul(De,Je),C=C+Math.imul(me,Le)|0,M=(M=M+Math.imul(me,Ce)|0)+Math.imul(we,Le)|0,P=P+Math.imul(we,Ce)|0,C=C+Math.imul(be,Xe)|0,M=(M=M+Math.imul(be,ut)|0)+Math.imul(xe,Xe)|0,P=P+Math.imul(xe,ut)|0;var Xt=(W+(C=C+Math.imul(ve,ft)|0)|0)+((8191&(M=(M=M+Math.imul(ve,Et)|0)+Math.imul(ke,ft)|0))<<13)|0;W=((P=P+Math.imul(ke,Et)|0)+(M>>>13)|0)+(Xt>>>26)|0,Xt&=67108863,C=Math.imul(Se,Le),M=(M=Math.imul(Se,Ce))+Math.imul(De,Le)|0,P=Math.imul(De,Ce),C=C+Math.imul(me,Xe)|0,M=(M=M+Math.imul(me,ut)|0)+Math.imul(we,Xe)|0,P=P+Math.imul(we,ut)|0;var ar=(W+(C=C+Math.imul(be,ft)|0)|0)+((8191&(M=(M=M+Math.imul(be,Et)|0)+Math.imul(xe,ft)|0))<<13)|0;W=((P=P+Math.imul(xe,Et)|0)+(M>>>13)|0)+(ar>>>26)|0,ar&=67108863,C=Math.imul(Se,Xe),M=(M=Math.imul(Se,ut))+Math.imul(De,Xe)|0,P=Math.imul(De,ut);var hr=(W+(C=C+Math.imul(me,ft)|0)|0)+((8191&(M=(M=M+Math.imul(me,Et)|0)+Math.imul(we,ft)|0))<<13)|0;W=((P=P+Math.imul(we,Et)|0)+(M>>>13)|0)+(hr>>>26)|0,hr&=67108863;var mr=(W+(C=Math.imul(Se,ft))|0)+((8191&(M=(M=Math.imul(Se,Et))+Math.imul(De,ft)|0))<<13)|0;return W=((P=Math.imul(De,Et))+(M>>>13)|0)+(mr>>>26)|0,mr&=67108863,j[0]=mt,j[1]=It,j[2]=vt,j[3]=nt,j[4]=At,j[5]=Ft,j[6]=Nt,j[7]=Kt,j[8]=Ie,j[9]=ot,j[10]=bt,j[11]=Pt,j[12]=Vt,j[13]=nr,j[14]=Yt,j[15]=Xt,j[16]=ar,j[17]=hr,j[18]=mr,W!==0&&(j[19]=W,k.length++),k};function n(w,L,k){return new d().mulp(w,L,k)}function d(w,L){this.x=w,this.y=L}Math.imul||(r=c),e.prototype.mulTo=function(w,L){var k=this.length+w.length;return this.length===10&&w.length===10?r(this,w,L):k<63?c(this,w,L):k<1024?function(C,M,P){P.negative=M.negative^C.negative,P.length=C.length+M.length;for(var O=0,F=0,j=0;j<P.length-1;j++){var W=F;F=0;for(var Z=67108863&O,Q=Math.min(j,M.length-1),X=Math.max(0,j-C.length+1);X<=Q;X++){var G=j-X,Y=(0|C.words[G])*(0|M.words[X]),K=67108863&Y;Z=67108863&(K=K+Z|0),F+=(W=(W=W+(Y/67108864|0)|0)+(K>>>26)|0)>>>26,W&=67108863}P.words[j]=Z,O=W,W=F}return O!==0?P.words[j]=O:P.length--,P.strip()}(this,w,L):n(this,w,L)},d.prototype.makeRBT=function(w){for(var L=new Array(w),k=e.prototype._countBits(w)-1,C=0;C<w;C++)L[C]=this.revBin(C,k,w);return L},d.prototype.revBin=function(w,L,k){if(w===0||w===k-1)return w;for(var C=0,M=0;M<L;M++)C|=(1&w)<<L-M-1,w>>=1;return C},d.prototype.permute=function(w,L,k,C,M,P){for(var O=0;O<P;O++)C[O]=L[w[O]],M[O]=k[w[O]]},d.prototype.transform=function(w,L,k,C,M,P){this.permute(P,w,L,k,C,M);for(var O=1;O<M;O<<=1)for(var F=O<<1,j=Math.cos(2*Math.PI/F),W=Math.sin(2*Math.PI/F),Z=0;Z<M;Z+=F)for(var Q=j,X=W,G=0;G<O;G++){var Y=k[Z+G],K=C[Z+G],D=k[Z+G+O],B=C[Z+G+O],q=Q*D-X*B;B=Q*B+X*D,D=q,k[Z+G]=Y+D,C[Z+G]=K+B,k[Z+G+O]=Y-D,C[Z+G+O]=K-B,G!==F&&(q=j*Q-W*X,X=j*X+W*Q,Q=q)}},d.prototype.guessLen13b=function(w,L){var k=1|Math.max(L,w),C=1&k,M=0;for(k=k/2|0;k;k>>>=1)M++;return 1<<M+1+C},d.prototype.conjugate=function(w,L,k){if(!(k<=1))for(var C=0;C<k/2;C++){var M=w[C];w[C]=w[k-C-1],w[k-C-1]=M,M=L[C],L[C]=-L[k-C-1],L[k-C-1]=-M}},d.prototype.normalize13b=function(w,L){for(var k=0,C=0;C<L/2;C++){var M=8192*Math.round(w[2*C+1]/L)+Math.round(w[2*C]/L)+k;w[C]=67108863&M,k=M<67108864?0:M/67108864|0}return w},d.prototype.convert13b=function(w,L,k,C){for(var M=0,P=0;P<L;P++)M+=0|w[P],k[2*P]=8191&M,M>>>=13,k[2*P+1]=8191&M,M>>>=13;for(P=2*L;P<C;++P)k[P]=0;g(M===0),g((-8192&M)==0)},d.prototype.stub=function(w){for(var L=new Array(w),k=0;k<w;k++)L[k]=0;return L},d.prototype.mulp=function(w,L,k){var C=2*this.guessLen13b(w.length,L.length),M=this.makeRBT(C),P=this.stub(C),O=new Array(C),F=new Array(C),j=new Array(C),W=new Array(C),Z=new Array(C),Q=new Array(C),X=k.words;X.length=C,this.convert13b(w.words,w.length,O,C),this.convert13b(L.words,L.length,W,C),this.transform(O,P,F,j,C,M),this.transform(W,P,Z,Q,C,M);for(var G=0;G<C;G++){var Y=F[G]*Z[G]-j[G]*Q[G];j[G]=F[G]*Q[G]+j[G]*Z[G],F[G]=Y}return this.conjugate(F,j,C),this.transform(F,j,X,P,C,M),this.conjugate(X,P,C),this.normalize13b(X,C),k.negative=w.negative^L.negative,k.length=w.length+L.length,k.strip()},e.prototype.mul=function(w){var L=new e(null);return L.words=new Array(this.length+w.length),this.mulTo(w,L)},e.prototype.mulf=function(w){var L=new e(null);return L.words=new Array(this.length+w.length),n(this,w,L)},e.prototype.imul=function(w){return this.clone().mulTo(w,this)},e.prototype.imuln=function(w){g(typeof w=="number"),g(w<67108864);for(var L=0,k=0;k<this.length;k++){var C=(0|this.words[k])*w,M=(67108863&C)+(67108863&L);L>>=26,L+=C/67108864|0,L+=M>>>26,this.words[k]=67108863&M}return L!==0&&(this.words[k]=L,this.length++),this},e.prototype.muln=function(w){return this.clone().imuln(w)},e.prototype.sqr=function(){return this.mul(this)},e.prototype.isqr=function(){return this.imul(this.clone())},e.prototype.pow=function(w){var L=function(P){for(var O=new Array(P.bitLength()),F=0;F<O.length;F++){var j=F/26|0,W=F%26;O[F]=(P.words[j]&1<<W)>>>W}return O}(w);if(L.length===0)return new e(1);for(var k=this,C=0;C<L.length&&L[C]===0;C++,k=k.sqr());if(++C<L.length)for(var M=k.sqr();C<L.length;C++,M=M.sqr())L[C]!==0&&(k=k.mul(M));return k},e.prototype.iushln=function(w){g(typeof w=="number"&&w>=0);var L,k=w%26,C=(w-k)/26,M=67108863>>>26-k<<26-k;if(k!==0){var P=0;for(L=0;L<this.length;L++){var O=this.words[L]&M,F=(0|this.words[L])-O<<k;this.words[L]=F|P,P=O>>>26-k}P&&(this.words[L]=P,this.length++)}if(C!==0){for(L=this.length-1;L>=0;L--)this.words[L+C]=this.words[L];for(L=0;L<C;L++)this.words[L]=0;this.length+=C}return this.strip()},e.prototype.ishln=function(w){return g(this.negative===0),this.iushln(w)},e.prototype.iushrn=function(w,L,k){var C;g(typeof w=="number"&&w>=0),C=L?(L-L%26)/26:0;var M=w%26,P=Math.min((w-M)/26,this.length),O=67108863^67108863>>>M<<M,F=k;if(C-=P,C=Math.max(0,C),F){for(var j=0;j<P;j++)F.words[j]=this.words[j];F.length=P}if(P!==0)if(this.length>P)for(this.length-=P,j=0;j<this.length;j++)this.words[j]=this.words[j+P];else this.words[0]=0,this.length=1;var W=0;for(j=this.length-1;j>=0&&(W!==0||j>=C);j--){var Z=0|this.words[j];this.words[j]=W<<26-M|Z>>>M,W=Z&O}return F&&W!==0&&(F.words[F.length++]=W),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},e.prototype.ishrn=function(w,L,k){return g(this.negative===0),this.iushrn(w,L,k)},e.prototype.shln=function(w){return this.clone().ishln(w)},e.prototype.ushln=function(w){return this.clone().iushln(w)},e.prototype.shrn=function(w){return this.clone().ishrn(w)},e.prototype.ushrn=function(w){return this.clone().iushrn(w)},e.prototype.testn=function(w){g(typeof w=="number"&&w>=0);var L=w%26,k=(w-L)/26,C=1<<L;return!(this.length<=k)&&!!(this.words[k]&C)},e.prototype.imaskn=function(w){g(typeof w=="number"&&w>=0);var L=w%26,k=(w-L)/26;if(g(this.negative===0,"imaskn works only with positive numbers"),this.length<=k)return this;if(L!==0&&k++,this.length=Math.min(k,this.length),L!==0){var C=67108863^67108863>>>L<<L;this.words[this.length-1]&=C}return this.strip()},e.prototype.maskn=function(w){return this.clone().imaskn(w)},e.prototype.iaddn=function(w){return g(typeof w=="number"),g(w<67108864),w<0?this.isubn(-w):this.negative!==0?this.length===1&&(0|this.words[0])<w?(this.words[0]=w-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(w),this.negative=1,this):this._iaddn(w)},e.prototype._iaddn=function(w){this.words[0]+=w;for(var L=0;L<this.length&&this.words[L]>=67108864;L++)this.words[L]-=67108864,L===this.length-1?this.words[L+1]=1:this.words[L+1]++;return this.length=Math.max(this.length,L+1),this},e.prototype.isubn=function(w){if(g(typeof w=="number"),g(w<67108864),w<0)return this.iaddn(-w);if(this.negative!==0)return this.negative=0,this.iaddn(w),this.negative=1,this;if(this.words[0]-=w,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var L=0;L<this.length&&this.words[L]<0;L++)this.words[L]+=67108864,this.words[L+1]-=1;return this.strip()},e.prototype.addn=function(w){return this.clone().iaddn(w)},e.prototype.subn=function(w){return this.clone().isubn(w)},e.prototype.iabs=function(){return this.negative=0,this},e.prototype.abs=function(){return this.clone().iabs()},e.prototype._ishlnsubmul=function(w,L,k){var C,M,P=w.length+k;this._expand(P);var O=0;for(C=0;C<w.length;C++){M=(0|this.words[C+k])+O;var F=(0|w.words[C])*L;O=((M-=67108863&F)>>26)-(F/67108864|0),this.words[C+k]=67108863&M}for(;C<this.length-k;C++)O=(M=(0|this.words[C+k])+O)>>26,this.words[C+k]=67108863&M;if(O===0)return this.strip();for(g(O===-1),O=0,C=0;C<this.length;C++)O=(M=-(0|this.words[C])+O)>>26,this.words[C]=67108863&M;return this.negative=1,this.strip()},e.prototype._wordDiv=function(w,L){var k=(this.length,w.length),C=this.clone(),M=w,P=0|M.words[M.length-1];(k=26-this._countBits(P))!=0&&(M=M.ushln(k),C.iushln(k),P=0|M.words[M.length-1]);var O,F=C.length-M.length;if(L!=="mod"){(O=new e(null)).length=F+1,O.words=new Array(O.length);for(var j=0;j<O.length;j++)O.words[j]=0}var W=C.clone()._ishlnsubmul(M,1,F);W.negative===0&&(C=W,O&&(O.words[F]=1));for(var Z=F-1;Z>=0;Z--){var Q=67108864*(0|C.words[M.length+Z])+(0|C.words[M.length+Z-1]);for(Q=Math.min(Q/P|0,67108863),C._ishlnsubmul(M,Q,Z);C.negative!==0;)Q--,C.negative=0,C._ishlnsubmul(M,1,Z),C.isZero()||(C.negative^=1);O&&(O.words[Z]=Q)}return O&&O.strip(),C.strip(),L!=="div"&&k!==0&&C.iushrn(k),{div:O||null,mod:C}},e.prototype.divmod=function(w,L,k){return g(!w.isZero()),this.isZero()?{div:new e(0),mod:new e(0)}:this.negative!==0&&w.negative===0?(P=this.neg().divmod(w,L),L!=="mod"&&(C=P.div.neg()),L!=="div"&&(M=P.mod.neg(),k&&M.negative!==0&&M.iadd(w)),{div:C,mod:M}):this.negative===0&&w.negative!==0?(P=this.divmod(w.neg(),L),L!=="mod"&&(C=P.div.neg()),{div:C,mod:P.mod}):(this.negative&w.negative)!=0?(P=this.neg().divmod(w.neg(),L),L!=="div"&&(M=P.mod.neg(),k&&M.negative!==0&&M.isub(w)),{div:P.div,mod:M}):w.length>this.length||this.cmp(w)<0?{div:new e(0),mod:this}:w.length===1?L==="div"?{div:this.divn(w.words[0]),mod:null}:L==="mod"?{div:null,mod:new e(this.modn(w.words[0]))}:{div:this.divn(w.words[0]),mod:new e(this.modn(w.words[0]))}:this._wordDiv(w,L);var C,M,P},e.prototype.div=function(w){return this.divmod(w,"div",!1).div},e.prototype.mod=function(w){return this.divmod(w,"mod",!1).mod},e.prototype.umod=function(w){return this.divmod(w,"mod",!0).mod},e.prototype.divRound=function(w){var L=this.divmod(w);if(L.mod.isZero())return L.div;var k=L.div.negative!==0?L.mod.isub(w):L.mod,C=w.ushrn(1),M=w.andln(1),P=k.cmp(C);return P<0||M===1&&P===0?L.div:L.div.negative!==0?L.div.isubn(1):L.div.iaddn(1)},e.prototype.modn=function(w){g(w<=67108863);for(var L=(1<<26)%w,k=0,C=this.length-1;C>=0;C--)k=(L*k+(0|this.words[C]))%w;return k},e.prototype.idivn=function(w){g(w<=67108863);for(var L=0,k=this.length-1;k>=0;k--){var C=(0|this.words[k])+67108864*L;this.words[k]=C/w|0,L=C%w}return this.strip()},e.prototype.divn=function(w){return this.clone().idivn(w)},e.prototype.egcd=function(w){g(w.negative===0),g(!w.isZero());var L=this,k=w.clone();L=L.negative!==0?L.umod(w):L.clone();for(var C=new e(1),M=new e(0),P=new e(0),O=new e(1),F=0;L.isEven()&&k.isEven();)L.iushrn(1),k.iushrn(1),++F;for(var j=k.clone(),W=L.clone();!L.isZero();){for(var Z=0,Q=1;(L.words[0]&Q)==0&&Z<26;++Z,Q<<=1);if(Z>0)for(L.iushrn(Z);Z-- >0;)(C.isOdd()||M.isOdd())&&(C.iadd(j),M.isub(W)),C.iushrn(1),M.iushrn(1);for(var X=0,G=1;(k.words[0]&G)==0&&X<26;++X,G<<=1);if(X>0)for(k.iushrn(X);X-- >0;)(P.isOdd()||O.isOdd())&&(P.iadd(j),O.isub(W)),P.iushrn(1),O.iushrn(1);L.cmp(k)>=0?(L.isub(k),C.isub(P),M.isub(O)):(k.isub(L),P.isub(C),O.isub(M))}return{a:P,b:O,gcd:k.iushln(F)}},e.prototype._invmp=function(w){g(w.negative===0),g(!w.isZero());var L=this,k=w.clone();L=L.negative!==0?L.umod(w):L.clone();for(var C,M=new e(1),P=new e(0),O=k.clone();L.cmpn(1)>0&&k.cmpn(1)>0;){for(var F=0,j=1;(L.words[0]&j)==0&&F<26;++F,j<<=1);if(F>0)for(L.iushrn(F);F-- >0;)M.isOdd()&&M.iadd(O),M.iushrn(1);for(var W=0,Z=1;(k.words[0]&Z)==0&&W<26;++W,Z<<=1);if(W>0)for(k.iushrn(W);W-- >0;)P.isOdd()&&P.iadd(O),P.iushrn(1);L.cmp(k)>=0?(L.isub(k),M.isub(P)):(k.isub(L),P.isub(M))}return(C=L.cmpn(1)===0?M:P).cmpn(0)<0&&C.iadd(w),C},e.prototype.gcd=function(w){if(this.isZero())return w.abs();if(w.isZero())return this.abs();var L=this.clone(),k=w.clone();L.negative=0,k.negative=0;for(var C=0;L.isEven()&&k.isEven();C++)L.iushrn(1),k.iushrn(1);for(;;){for(;L.isEven();)L.iushrn(1);for(;k.isEven();)k.iushrn(1);var M=L.cmp(k);if(M<0){var P=L;L=k,k=P}else if(M===0||k.cmpn(1)===0)break;L.isub(k)}return k.iushln(C)},e.prototype.invm=function(w){return this.egcd(w).a.umod(w)},e.prototype.isEven=function(){return(1&this.words[0])==0},e.prototype.isOdd=function(){return(1&this.words[0])==1},e.prototype.andln=function(w){return this.words[0]&w},e.prototype.bincn=function(w){g(typeof w=="number");var L=w%26,k=(w-L)/26,C=1<<L;if(this.length<=k)return this._expand(k+1),this.words[k]|=C,this;for(var M=C,P=k;M!==0&&P<this.length;P++){var O=0|this.words[P];M=(O+=M)>>>26,O&=67108863,this.words[P]=O}return M!==0&&(this.words[P]=M,this.length++),this},e.prototype.isZero=function(){return this.length===1&&this.words[0]===0},e.prototype.cmpn=function(w){var L,k=w<0;if(this.negative!==0&&!k)return-1;if(this.negative===0&&k)return 1;if(this.strip(),this.length>1)L=1;else{k&&(w=-w),g(w<=67108863,"Number is too big");var C=0|this.words[0];L=C===w?0:C<w?-1:1}return this.negative!==0?0|-L:L},e.prototype.cmp=function(w){if(this.negative!==0&&w.negative===0)return-1;if(this.negative===0&&w.negative!==0)return 1;var L=this.ucmp(w);return this.negative!==0?0|-L:L},e.prototype.ucmp=function(w){if(this.length>w.length)return 1;if(this.length<w.length)return-1;for(var L=0,k=this.length-1;k>=0;k--){var C=0|this.words[k],M=0|w.words[k];if(C!==M){C<M?L=-1:C>M&&(L=1);break}}return L},e.prototype.gtn=function(w){return this.cmpn(w)===1},e.prototype.gt=function(w){return this.cmp(w)===1},e.prototype.gten=function(w){return this.cmpn(w)>=0},e.prototype.gte=function(w){return this.cmp(w)>=0},e.prototype.ltn=function(w){return this.cmpn(w)===-1},e.prototype.lt=function(w){return this.cmp(w)===-1},e.prototype.lten=function(w){return this.cmpn(w)<=0},e.prototype.lte=function(w){return this.cmp(w)<=0},e.prototype.eqn=function(w){return this.cmpn(w)===0},e.prototype.eq=function(w){return this.cmp(w)===0},e.red=function(w){return new A(w)},e.prototype.toRed=function(w){return g(!this.red,"Already a number in reduction context"),g(this.negative===0,"red works only with positives"),w.convertTo(this)._forceRed(w)},e.prototype.fromRed=function(){return g(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},e.prototype._forceRed=function(w){return this.red=w,this},e.prototype.forceRed=function(w){return g(!this.red,"Already a number in reduction context"),this._forceRed(w)},e.prototype.redAdd=function(w){return g(this.red,"redAdd works only with red numbers"),this.red.add(this,w)},e.prototype.redIAdd=function(w){return g(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,w)},e.prototype.redSub=function(w){return g(this.red,"redSub works only with red numbers"),this.red.sub(this,w)},e.prototype.redISub=function(w){return g(this.red,"redISub works only with red numbers"),this.red.isub(this,w)},e.prototype.redShl=function(w){return g(this.red,"redShl works only with red numbers"),this.red.shl(this,w)},e.prototype.redMul=function(w){return g(this.red,"redMul works only with red numbers"),this.red._verify2(this,w),this.red.mul(this,w)},e.prototype.redIMul=function(w){return g(this.red,"redMul works only with red numbers"),this.red._verify2(this,w),this.red.imul(this,w)},e.prototype.redSqr=function(){return g(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},e.prototype.redISqr=function(){return g(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},e.prototype.redSqrt=function(){return g(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},e.prototype.redInvm=function(){return g(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},e.prototype.redNeg=function(){return g(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},e.prototype.redPow=function(w){return g(this.red&&!w.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,w)};var l={k256:null,p224:null,p192:null,p25519:null};function y(w,L){this.name=w,this.p=new e(L,16),this.n=this.p.bitLength(),this.k=new e(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function v(){y.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function _(){y.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function x(){y.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function T(){y.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function A(w){if(typeof w=="string"){var L=e._prime(w);this.m=L.p,this.prime=L}else g(w.gtn(1),"modulus must be greater than 1"),this.m=w,this.prime=null}function S(w){A.call(this,w),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new e(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}y.prototype._tmp=function(){var w=new e(null);return w.words=new Array(Math.ceil(this.n/13)),w},y.prototype.ireduce=function(w){var L,k=w;do this.split(k,this.tmp),L=(k=(k=this.imulK(k)).iadd(this.tmp)).bitLength();while(L>this.n);var C=L<this.n?-1:k.ucmp(this.p);return C===0?(k.words[0]=0,k.length=1):C>0?k.isub(this.p):k.strip(),k},y.prototype.split=function(w,L){w.iushrn(this.n,0,L)},y.prototype.imulK=function(w){return w.imul(this.k)},p(v,y),v.prototype.split=function(w,L){for(var k=Math.min(w.length,9),C=0;C<k;C++)L.words[C]=w.words[C];if(L.length=k,w.length<=9)return w.words[0]=0,void(w.length=1);var M=w.words[9];for(L.words[L.length++]=4194303&M,C=10;C<w.length;C++){var P=0|w.words[C];w.words[C-10]=(4194303&P)<<4|M>>>22,M=P}M>>>=22,w.words[C-10]=M,M===0&&w.length>10?w.length-=10:w.length-=9},v.prototype.imulK=function(w){w.words[w.length]=0,w.words[w.length+1]=0,w.length+=2;for(var L=0,k=0;k<w.length;k++){var C=0|w.words[k];L+=977*C,w.words[k]=67108863&L,L=64*C+(L/67108864|0)}return w.words[w.length-1]===0&&(w.length--,w.words[w.length-1]===0&&w.length--),w},p(_,y),p(x,y),p(T,y),T.prototype.imulK=function(w){for(var L=0,k=0;k<w.length;k++){var C=19*(0|w.words[k])+L,M=67108863&C;C>>>=26,w.words[k]=M,L=C}return L!==0&&(w.words[w.length++]=L),w},e._prime=function(w){if(l[w])return l[w];var L;if(w==="k256")L=new v;else if(w==="p224")L=new _;else if(w==="p192")L=new x;else{if(w!=="p25519")throw new Error("Unknown prime "+w);L=new T}return l[w]=L,L},A.prototype._verify1=function(w){g(w.negative===0,"red works only with positives"),g(w.red,"red works only with red numbers")},A.prototype._verify2=function(w,L){g((w.negative|L.negative)==0,"red works only with positives"),g(w.red&&w.red===L.red,"red works only with red numbers")},A.prototype.imod=function(w){return this.prime?this.prime.ireduce(w)._forceRed(this):w.umod(this.m)._forceRed(this)},A.prototype.neg=function(w){return w.isZero()?w.clone():this.m.sub(w)._forceRed(this)},A.prototype.add=function(w,L){this._verify2(w,L);var k=w.add(L);return k.cmp(this.m)>=0&&k.isub(this.m),k._forceRed(this)},A.prototype.iadd=function(w,L){this._verify2(w,L);var k=w.iadd(L);return k.cmp(this.m)>=0&&k.isub(this.m),k},A.prototype.sub=function(w,L){this._verify2(w,L);var k=w.sub(L);return k.cmpn(0)<0&&k.iadd(this.m),k._forceRed(this)},A.prototype.isub=function(w,L){this._verify2(w,L);var k=w.isub(L);return k.cmpn(0)<0&&k.iadd(this.m),k},A.prototype.shl=function(w,L){return this._verify1(w),this.imod(w.ushln(L))},A.prototype.imul=function(w,L){return this._verify2(w,L),this.imod(w.imul(L))},A.prototype.mul=function(w,L){return this._verify2(w,L),this.imod(w.mul(L))},A.prototype.isqr=function(w){return this.imul(w,w.clone())},A.prototype.sqr=function(w){return this.mul(w,w)},A.prototype.sqrt=function(w){if(w.isZero())return w.clone();var L=this.m.andln(3);if(g(L%2==1),L===3){var k=this.m.add(new e(1)).iushrn(2);return this.pow(w,k)}for(var C=this.m.subn(1),M=0;!C.isZero()&&C.andln(1)===0;)M++,C.iushrn(1);g(!C.isZero());var P=new e(1).toRed(this),O=P.redNeg(),F=this.m.subn(1).iushrn(1),j=this.m.bitLength();for(j=new e(2*j*j).toRed(this);this.pow(j,F).cmp(O)!==0;)j.redIAdd(O);for(var W=this.pow(j,C),Z=this.pow(w,C.addn(1).iushrn(1)),Q=this.pow(w,C),X=M;Q.cmp(P)!==0;){for(var G=Q,Y=0;G.cmp(P)!==0;Y++)G=G.redSqr();g(Y<X);var K=this.pow(W,new e(1).iushln(X-Y-1));Z=Z.redMul(K),W=K.redSqr(),Q=Q.redMul(W),X=Y}return Z},A.prototype.invm=function(w){var L=w._invmp(this.m);return L.negative!==0?(L.negative=0,this.imod(L).redNeg()):this.imod(L)},A.prototype.pow=function(w,L){if(L.isZero())return new e(1).toRed(this);if(L.cmpn(1)===0)return w.clone();var k=new Array(16);k[0]=new e(1).toRed(this),k[1]=w;for(var C=2;C<k.length;C++)k[C]=this.mul(k[C-1],w);var M=k[0],P=0,O=0,F=L.bitLength()%26;for(F===0&&(F=26),C=L.length-1;C>=0;C--){for(var j=L.words[C],W=F-1;W>=0;W--){var Z=j>>W&1;M!==k[0]&&(M=this.sqr(M)),Z!==0||P!==0?(P<<=1,P|=Z,(++O==4||C===0&&W===0)&&(M=this.mul(M,k[P]),O=0,P=0)):O=0}F=26}return M},A.prototype.convertTo=function(w){var L=w.umod(this.m);return L===w?L.clone():L},A.prototype.convertFrom=function(w){var L=w.clone();return L.red=null,L},e.mont=function(w){return new S(w)},p(S,A),S.prototype.convertTo=function(w){return this.imod(w.ushln(this.shift))},S.prototype.convertFrom=function(w){var L=this.imod(w.mul(this.rinv));return L.red=null,L},S.prototype.imul=function(w,L){if(w.isZero()||L.isZero())return w.words[0]=0,w.length=1,w;var k=w.imul(L),C=k.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),M=k.isub(C).iushrn(this.shift),P=M;return M.cmp(this.m)>=0?P=M.isub(this.m):M.cmpn(0)<0&&(P=M.iadd(this.m)),P._forceRed(this)},S.prototype.mul=function(w,L){if(w.isZero()||L.isZero())return new e(0)._forceRed(this);var k=w.mul(L),C=k.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),M=k.isub(C).iushrn(this.shift),P=M;return M.cmp(this.m)>=0?P=M.isub(this.m):M.cmpn(0)<0&&(P=M.iadd(this.m)),P._forceRed(this)},S.prototype.invm=function(w){return this.imod(w._invmp(this.m).mul(this.r2))._forceRed(this)}})(N===void 0||N,this)},{buffer:115}],107:[function(h,N,H){N.exports=function(t){var m,g,p,e=t.length,f=0;for(m=0;m<e;++m)f+=t[m].length;var u=new Array(f),i=0;for(m=0;m<e;++m){var s=t[m],o=s.length;for(g=0;g<o;++g){var a=u[i++]=new Array(o-1),c=0;for(p=0;p<o;++p)p!==g&&(a[c++]=s[p]);if(1&g){var r=a[1];a[1]=a[0],a[0]=r}}}return u}},{}],108:[function(h,N,H){N.exports=function(a,c,r){switch(arguments.length){case 1:return s(a);case 2:return typeof c=="function"?u(a,a,c,!0):o(a,c);case 3:return u(a,c,r,!1);default:throw new Error("box-intersect: Invalid arguments")}};var t,m=h("typedarray-pool"),g=h("./lib/sweep"),p=h("./lib/intersect");function e(a,c){for(var r=0;r<a;++r)if(!(c[r]<=c[r+a]))return!0;return!1}function f(a,c,r,n){for(var d=0,l=0,y=0,v=a.length;y<v;++y){var _=a[y];if(!e(c,_)){for(var x=0;x<2*c;++x)r[d++]=_[x];n[l++]=y}}return l}function u(a,c,r,n){var d=a.length,l=c.length;if(!(d<=0||l<=0)){var y=a[0].length>>>1;if(!(y<=0)){var v,_=m.mallocDouble(2*y*d),x=m.mallocInt32(d);if((d=f(a,y,_,x))>0){if(y===1&&n)g.init(d),v=g.sweepComplete(y,r,0,d,_,x,0,d,_,x);else{var T=m.mallocDouble(2*y*l),A=m.mallocInt32(l);(l=f(c,y,T,A))>0&&(g.init(d+l),v=y===1?g.sweepBipartite(y,r,0,d,_,x,0,l,T,A):p(y,r,n,d,_,x,l,T,A),m.free(T),m.free(A))}m.free(_),m.free(x)}return v}}}function i(a,c){t.push([a,c])}function s(a){return t=[],u(a,a,i,!0),t}function o(a,c){return t=[],u(a,c,i,!1),t}},{"./lib/intersect":110,"./lib/sweep":114,"typedarray-pool":601}],109:[function(h,N,H){function t(m){return m?function(g,p,e,f,u,i,s,o,a,c,r){return u-f>a-o?function(n,d,l,y,v,_,x,T,A,S,w){for(var L=2*n,k=y,C=L*y;k<v;++k,C+=L){var M=_[d+C],P=_[d+C+n],O=x[k];e:for(var F=T,j=L*T;F<A;++F,j+=L){var W=S[d+j],Z=S[d+j+n],Q=w[F];if(!(Z<M||P<W)){for(var X=d+1;X<n;++X){var G=_[X+C],Y=_[X+n+C],K=S[X+j],D=S[X+n+j];if(Y<K||D<G)continue e}var B=l(O,Q);if(B!==void 0)return B}}}}(g,p,e,f,u,i,s,o,a,c,r):function(n,d,l,y,v,_,x,T,A,S,w){for(var L=2*n,k=T,C=L*T;k<A;++k,C+=L){var M=S[d+C],P=S[d+C+n],O=w[k];e:for(var F=y,j=L*y;F<v;++F,j+=L){var W=_[d+j],Z=_[d+j+n],Q=x[F];if(!(P<W||Z<M)){for(var X=d+1;X<n;++X){var G=_[X+j],Y=_[X+n+j],K=S[X+C],D=S[X+n+C];if(Y<K||D<G)continue e}var B=l(Q,O);if(B!==void 0)return B}}}}(g,p,e,f,u,i,s,o,a,c,r)}:function(g,p,e,f,u,i,s,o,a,c,r,n){return i-u>c-a?f?function(d,l,y,v,_,x,T,A,S,w,L){for(var k=2*d,C=v,M=k*v;C<_;++C,M+=k){var P=x[l+M],O=x[l+M+d],F=T[C];e:for(var j=A,W=k*A;j<S;++j,W+=k){var Z=w[l+W],Q=L[j];if(!(Z<=P||O<Z)){for(var X=l+1;X<d;++X){var G=x[X+M],Y=x[X+d+M],K=w[X+W],D=w[X+d+W];if(Y<K||D<G)continue e}var B=y(Q,F);if(B!==void 0)return B}}}}(g,p,e,u,i,s,o,a,c,r,n):function(d,l,y,v,_,x,T,A,S,w,L){for(var k=2*d,C=v,M=k*v;C<_;++C,M+=k){var P=x[l+M],O=x[l+M+d],F=T[C];e:for(var j=A,W=k*A;j<S;++j,W+=k){var Z=w[l+W],Q=L[j];if(!(Z<P||O<Z)){for(var X=l+1;X<d;++X){var G=x[X+M],Y=x[X+d+M],K=w[X+W],D=w[X+d+W];if(Y<K||D<G)continue e}var B=y(F,Q);if(B!==void 0)return B}}}}(g,p,e,u,i,s,o,a,c,r,n):f?function(d,l,y,v,_,x,T,A,S,w,L){for(var k=2*d,C=A,M=k*A;C<S;++C,M+=k){var P=w[l+M],O=L[C];e:for(var F=v,j=k*v;F<_;++F,j+=k){var W=x[l+j],Z=x[l+j+d],Q=T[F];if(!(P<=W||Z<P)){for(var X=l+1;X<d;++X){var G=x[X+j],Y=x[X+d+j],K=w[X+M],D=w[X+d+M];if(Y<K||D<G)continue e}var B=y(O,Q);if(B!==void 0)return B}}}}(g,p,e,u,i,s,o,a,c,r,n):function(d,l,y,v,_,x,T,A,S,w,L){for(var k=2*d,C=A,M=k*A;C<S;++C,M+=k){var P=w[l+M],O=L[C];e:for(var F=v,j=k*v;F<_;++F,j+=k){var W=x[l+j],Z=x[l+j+d],Q=T[F];if(!(P<W||Z<P)){for(var X=l+1;X<d;++X){var G=x[X+j],Y=x[X+d+j],K=w[X+M],D=w[X+d+M];if(Y<K||D<G)continue e}var B=y(Q,O);if(B!==void 0)return B}}}}(g,p,e,u,i,s,o,a,c,r,n)}}H.partial=t(!1),H.full=t(!0)},{}],110:[function(h,N,H){N.exports=function(x,T,A,S,w,L,k,C,M){(function(be,xe){var ue=8*m.log2(xe+1)*(be+1)|0,me=m.nextPow2(6*ue);d.length<me&&(t.free(d),d=t.mallocInt32(me));var we=m.nextPow2(2*ue);l.length<we&&(t.free(l),l=t.mallocDouble(we))})(x,S+k);var P,O=0,F=2*x;for(y(O++,0,0,S,0,k,A?16:0,-1/0,1/0),A||y(O++,0,0,k,0,S,1,-1/0,1/0);O>0;){var j=6*(O-=1),W=d[j],Z=d[j+1],Q=d[j+2],X=d[j+3],G=d[j+4],Y=d[j+5],K=2*O,D=l[K],B=l[K+1],q=1&Y,ee=!!(16&Y),J=w,$=L,te=C,ie=M;if(q&&(J=C,$=M,te=w,ie=L),!(2&Y&&(Q=a(x,W,Z,Q,J,$,B),Z>=Q)||4&Y&&(Z=c(x,W,Z,Q,J,$,D))>=Q)){var ae=Q-Z,he=G-X;if(ee){if(x*ae*(ae+he)<1<<22){if((P=f.scanComplete(x,W,T,Z,Q,J,$,X,G,te,ie))!==void 0)return P;continue}}else{if(x*Math.min(ae,he)<128){if((P=p(x,W,T,q,Z,Q,J,$,X,G,te,ie))!==void 0)return P;continue}if(x*ae*he<1<<22){if((P=f.scanBipartite(x,W,T,q,Z,Q,J,$,X,G,te,ie))!==void 0)return P;continue}}var se=s(x,W,Z,Q,J,$,D,B);if(Z<se)if(x*(se-Z)<128){if((P=e(x,W+1,T,Z,se,J,$,X,G,te,ie))!==void 0)return P}else if(W===x-2){if((P=q?f.sweepBipartite(x,T,X,G,te,ie,Z,se,J,$):f.sweepBipartite(x,T,Z,se,J,$,X,G,te,ie))!==void 0)return P}else y(O++,W+1,Z,se,X,G,q,-1/0,1/0),y(O++,W+1,X,G,Z,se,1^q,-1/0,1/0);if(se<Q){var de=u(x,W,X,G,te,ie),ce=te[F*de+W],ve=o(x,W,de,G,te,ie,ce);if(ve<G&&y(O++,W,se,Q,ve,G,(4|q)+(ee?16:0),ce,B),X<de&&y(O++,W,se,Q,X,de,(2|q)+(ee?16:0),D,ce),de+1===ve){if((P=ee?_(x,W,T,se,Q,J,$,de,te,ie[de]):v(x,W,T,q,se,Q,J,$,de,te,ie[de]))!==void 0)return P}else if(de<ve){var ke;if(ee){if(ke=r(x,W,se,Q,J,$,ce),se<ke){var Ee=o(x,W,se,ke,J,$,ce);if(W===x-2){if(se<Ee&&(P=f.sweepComplete(x,T,se,Ee,J,$,de,ve,te,ie))!==void 0||Ee<ke&&(P=f.sweepBipartite(x,T,Ee,ke,J,$,de,ve,te,ie))!==void 0)return P}else se<Ee&&y(O++,W+1,se,Ee,de,ve,16,-1/0,1/0),Ee<ke&&(y(O++,W+1,Ee,ke,de,ve,0,-1/0,1/0),y(O++,W+1,de,ve,Ee,ke,1,-1/0,1/0))}}else ke=q?n(x,W,se,Q,J,$,ce):r(x,W,se,Q,J,$,ce),se<ke&&(W===x-2?P=q?f.sweepBipartite(x,T,de,ve,te,ie,se,ke,J,$):f.sweepBipartite(x,T,se,ke,J,$,de,ve,te,ie):(y(O++,W+1,se,ke,de,ve,q,-1/0,1/0),y(O++,W+1,de,ve,se,ke,1^q,-1/0,1/0)))}}}}};var t=h("typedarray-pool"),m=h("bit-twiddle"),g=h("./brute"),p=g.partial,e=g.full,f=h("./sweep"),u=h("./median"),i=h("./partition"),s=i("!(lo>=p0)&&!(p1>=hi)"),o=i("lo===p0"),a=i("lo<p0"),c=i("hi<=p0"),r=i("lo<=p0&&p0<=hi"),n=i("lo<p0&&p0<=hi"),d=t.mallocInt32(1024),l=t.mallocDouble(1024);function y(x,T,A,S,w,L,k,C,M){var P=6*x;d[P]=T,d[P+1]=A,d[P+2]=S,d[P+3]=w,d[P+4]=L,d[P+5]=k;var O=2*x;l[O]=C,l[O+1]=M}function v(x,T,A,S,w,L,k,C,M,P,O){var F=2*x,j=M*F,W=P[j+T];e:for(var Z=w,Q=w*F;Z<L;++Z,Q+=F){var X=k[Q+T],G=k[Q+T+x];if(!(W<X||G<W)&&(!S||W!==X)){for(var Y,K=C[Z],D=T+1;D<x;++D){X=k[Q+D],G=k[Q+D+x];var B=P[j+D],q=P[j+D+x];if(G<B||q<X)continue e}if((Y=S?A(O,K):A(K,O))!==void 0)return Y}}}function _(x,T,A,S,w,L,k,C,M,P){var O=2*x,F=C*O,j=M[F+T];e:for(var W=S,Z=S*O;W<w;++W,Z+=O){var Q=k[W];if(Q!==P){var X=L[Z+T],G=L[Z+T+x];if(!(j<X||G<j)){for(var Y=T+1;Y<x;++Y){X=L[Z+Y],G=L[Z+Y+x];var K=M[F+Y],D=M[F+Y+x];if(G<K||D<X)continue e}var B=A(Q,P);if(B!==void 0)return B}}}}},{"./brute":109,"./median":111,"./partition":112,"./sweep":114,"bit-twiddle":104,"typedarray-pool":601}],111:[function(h,N,H){N.exports=function(g,p,e,f,u,i){if(f<=e+1)return e;for(var s=e,o=f,a=f+e>>>1,c=2*g,r=a,n=u[c*a+p];s<o;){if(o-s<8){m(g,p,s,o,u,i),n=u[c*a+p];break}var d=o-s,l=Math.random()*d+s|0,y=u[c*l+p],v=Math.random()*d+s|0,_=u[c*v+p],x=Math.random()*d+s|0,T=u[c*x+p];y<=_?T>=_?(r=v,n=_):y>=T?(r=l,n=y):(r=x,n=T):_>=T?(r=v,n=_):T>=y?(r=l,n=y):(r=x,n=T);for(var A=c*(o-1),S=c*r,w=0;w<c;++w,++A,++S){var L=u[A];u[A]=u[S],u[S]=L}var k=i[o-1];for(i[o-1]=i[r],i[r]=k,r=t(g,p,s,o-1,u,i,n),A=c*(o-1),S=c*r,w=0;w<c;++w,++A,++S)L=u[A],u[A]=u[S],u[S]=L;if(k=i[o-1],i[o-1]=i[r],i[r]=k,a<r){for(o=r-1;s<o&&u[c*(o-1)+p]===n;)o-=1;o+=1}else{if(!(r<a))break;for(s=r+1;s<o&&u[c*s+p]===n;)s+=1}}return t(g,p,e,a,u,i,u[c*a+p])};var t=h("./partition")("lo<p0");function m(g,p,e,f,u,i){for(var s=2*g,o=s*(e+1)+p,a=e+1;a<f;++a,o+=s)for(var c=u[o],r=a,n=s*(a-1);r>e&&u[n+p]>c;--r,n-=s){for(var d=n,l=n+s,y=0;y<s;++y,++d,++l){var v=u[d];u[d]=u[l],u[l]=v}var _=i[r];i[r]=i[r-1],i[r-1]=_}}},{"./partition":112}],112:[function(h,N,H){N.exports=function(m){return t[m]};var t={"lo===p0":function(m,g,p,e,f,u,i){for(var s=2*m,o=s*p,a=o,c=p,r=g,n=p;e>n;++n,o+=s)if(f[o+r]===i)if(c===n)c+=1,a+=s;else{for(var d=0;s>d;++d){var l=f[o+d];f[o+d]=f[a],f[a++]=l}var y=u[n];u[n]=u[c],u[c++]=y}return c},"lo<p0":function(m,g,p,e,f,u,i){for(var s=2*m,o=s*p,a=o,c=p,r=g,n=p;e>n;++n,o+=s)if(f[o+r]<i)if(c===n)c+=1,a+=s;else{for(var d=0;s>d;++d){var l=f[o+d];f[o+d]=f[a],f[a++]=l}var y=u[n];u[n]=u[c],u[c++]=y}return c},"lo<=p0":function(m,g,p,e,f,u,i){for(var s=2*m,o=s*p,a=o,c=p,r=m+g,n=p;e>n;++n,o+=s)if(f[o+r]<=i)if(c===n)c+=1,a+=s;else{for(var d=0;s>d;++d){var l=f[o+d];f[o+d]=f[a],f[a++]=l}var y=u[n];u[n]=u[c],u[c++]=y}return c},"hi<=p0":function(m,g,p,e,f,u,i){for(var s=2*m,o=s*p,a=o,c=p,r=m+g,n=p;e>n;++n,o+=s)if(f[o+r]<=i)if(c===n)c+=1,a+=s;else{for(var d=0;s>d;++d){var l=f[o+d];f[o+d]=f[a],f[a++]=l}var y=u[n];u[n]=u[c],u[c++]=y}return c},"lo<p0&&p0<=hi":function(m,g,p,e,f,u,i){for(var s=2*m,o=s*p,a=o,c=p,r=g,n=m+g,d=p;e>d;++d,o+=s){var l=f[o+r],y=f[o+n];if(l<i&&i<=y)if(c===d)c+=1,a+=s;else{for(var v=0;s>v;++v){var _=f[o+v];f[o+v]=f[a],f[a++]=_}var x=u[d];u[d]=u[c],u[c++]=x}}return c},"lo<=p0&&p0<=hi":function(m,g,p,e,f,u,i){for(var s=2*m,o=s*p,a=o,c=p,r=g,n=m+g,d=p;e>d;++d,o+=s){var l=f[o+r],y=f[o+n];if(l<=i&&i<=y)if(c===d)c+=1,a+=s;else{for(var v=0;s>v;++v){var _=f[o+v];f[o+v]=f[a],f[a++]=_}var x=u[d];u[d]=u[c],u[c++]=x}}return c},"!(lo>=p0)&&!(p1>=hi)":function(m,g,p,e,f,u,i,s){for(var o=2*m,a=o*p,c=a,r=p,n=g,d=m+g,l=p;e>l;++l,a+=o){var y=f[a+n],v=f[a+d];if(!(y>=i||s>=v))if(r===l)r+=1,c+=o;else{for(var _=0;o>_;++_){var x=f[a+_];f[a+_]=f[c],f[c++]=x}var T=u[l];u[l]=u[r],u[r++]=T}}return r}}},{}],113:[function(h,N,H){N.exports=function(i,s){s<=128?t(0,s-1,i):function o(a,c,r){var n=(c-a+1)/6|0,d=a+n,l=c-n,y=a+c>>1,v=y-n,_=y+n,x=d,T=v,A=y,S=_,w=l,L=a+1,k=c-1,C=0;f(x,T,r)&&(C=x,x=T,T=C),f(S,w,r)&&(C=S,S=w,w=C),f(x,A,r)&&(C=x,x=A,A=C),f(T,A,r)&&(C=T,T=A,A=C),f(x,S,r)&&(C=x,x=S,S=C),f(A,S,r)&&(C=A,A=S,S=C),f(T,w,r)&&(C=T,T=w,w=C),f(T,A,r)&&(C=T,T=A,A=C),f(S,w,r)&&(C=S,S=w,w=C);for(var M=r[2*T],P=r[2*T+1],O=r[2*S],F=r[2*S+1],j=2*x,W=2*A,Z=2*w,Q=2*d,X=2*y,G=2*l,Y=0;Y<2;++Y){var K=r[j+Y],D=r[W+Y],B=r[Z+Y];r[Q+Y]=K,r[X+Y]=D,r[G+Y]=B}g(v,a,r),g(_,c,r);for(var q=L;q<=k;++q)if(u(q,M,P,r))q!==L&&m(q,L,r),++L;else if(!u(q,O,F,r))for(;;){if(u(k,O,F,r)){u(k,M,P,r)?(p(q,L,k,r),++L,--k):(m(q,k,r),--k);break}if(--k<q)break}e(a,L-1,M,P,r),e(c,k+1,O,F,r),L-2-a<=32?t(a,L-2,r):o(a,L-2,r),c-(k+2)<=32?t(k+2,c,r):o(k+2,c,r),k-L<=32?t(L,k,r):o(L,k,r)}(0,s-1,i)};function t(i,s,o){for(var a=2*(i+1),c=i+1;c<=s;++c){for(var r=o[a++],n=o[a++],d=c,l=a-2;d-- >i;){var y=o[l-2],v=o[l-1];if(y<r||y===r&&v<n)break;o[l]=y,o[l+1]=v,l-=2}o[l]=r,o[l+1]=n}}function m(i,s,o){s*=2;var a=o[i*=2],c=o[i+1];o[i]=o[s],o[i+1]=o[s+1],o[s]=a,o[s+1]=c}function g(i,s,o){s*=2,o[i*=2]=o[s],o[i+1]=o[s+1]}function p(i,s,o,a){s*=2,o*=2;var c=a[i*=2],r=a[i+1];a[i]=a[s],a[i+1]=a[s+1],a[s]=a[o],a[s+1]=a[o+1],a[o]=c,a[o+1]=r}function e(i,s,o,a,c){s*=2,c[i*=2]=c[s],c[s]=o,c[i+1]=c[s+1],c[s+1]=a}function f(i,s,o){s*=2;var a=o[i*=2],c=o[s];return!(a<c)&&(a!==c||o[i+1]>o[s+1])}function u(i,s,o,a){var c=a[i*=2];return c<s||c===s&&a[i+1]<o}},{}],114:[function(h,N,H){N.exports={init:function(r){var n=m.nextPow2(r);p.length<n&&(t.free(p),p=t.mallocInt32(n)),e.length<n&&(t.free(e),e=t.mallocInt32(n)),f.length<n&&(t.free(f),f=t.mallocInt32(n)),u.length<n&&(t.free(u),u=t.mallocInt32(n)),i.length<n&&(t.free(i),i=t.mallocInt32(n)),s.length<n&&(t.free(s),s=t.mallocInt32(n));var d=8*n;o.length<d&&(t.free(o),o=t.mallocDouble(d))},sweepBipartite:function(r,n,d,l,y,v,_,x,T,A){for(var S=0,w=2*r,L=r-1,k=w-1,C=d;C<l;++C){var M=v[C],P=w*C;o[S++]=y[P+L],o[S++]=-(M+1),o[S++]=y[P+k],o[S++]=M}for(C=_;C<x;++C){M=A[C]+(1<<28);var O=w*C;o[S++]=T[O+L],o[S++]=-M,o[S++]=T[O+k],o[S++]=M}var F=S>>>1;g(o,F);var j=0,W=0;for(C=0;C<F;++C){var Z=0|o[2*C+1];if(Z>=1<<28)a(f,u,W--,Z=Z-(1<<28)|0);else if(Z>=0)a(p,e,j--,Z);else if(Z<=-(1<<28)){Z=-Z-(1<<28)|0;for(var Q=0;Q<j;++Q)if((X=n(p[Q],Z))!==void 0)return X;c(f,u,W++,Z)}else{for(Z=-Z-1|0,Q=0;Q<W;++Q){var X;if((X=n(Z,f[Q]))!==void 0)return X}c(p,e,j++,Z)}}},sweepComplete:function(r,n,d,l,y,v,_,x,T,A){for(var S=0,w=2*r,L=r-1,k=w-1,C=d;C<l;++C){var M=v[C]+1<<1,P=w*C;o[S++]=y[P+L],o[S++]=-M,o[S++]=y[P+k],o[S++]=M}for(C=_;C<x;++C){M=A[C]+1<<1;var O=w*C;o[S++]=T[O+L],o[S++]=1|-M,o[S++]=T[O+k],o[S++]=1|M}var F=S>>>1;g(o,F);var j=0,W=0,Z=0;for(C=0;C<F;++C){var Q=0|o[2*C+1],X=1&Q;if(C<F-1&&Q>>1==o[2*C+3]>>1&&(X=2,C+=1),Q<0){for(var G=-(Q>>1)-1,Y=0;Y<Z;++Y)if((K=n(i[Y],G))!==void 0)return K;if(X!==0){for(Y=0;Y<j;++Y)if((K=n(p[Y],G))!==void 0)return K}if(X!==1)for(Y=0;Y<W;++Y){var K;if((K=n(f[Y],G))!==void 0)return K}X===0?c(p,e,j++,G):X===1?c(f,u,W++,G):X===2&&c(i,s,Z++,G)}else G=(Q>>1)-1,X===0?a(p,e,j--,G):X===1?a(f,u,W--,G):X===2&&a(i,s,Z--,G)}},scanBipartite:function(r,n,d,l,y,v,_,x,T,A,S,w){var L=0,k=2*r,C=n,M=n+r,P=1,O=1;l?O=1<<28:P=1<<28;for(var F=y;F<v;++F){var j=F+P,W=k*F;o[L++]=_[W+C],o[L++]=-j,o[L++]=_[W+M],o[L++]=j}for(F=T;F<A;++F){j=F+O;var Z=k*F;o[L++]=S[Z+C],o[L++]=-j}var Q=L>>>1;g(o,Q);var X=0;for(F=0;F<Q;++F){var G=0|o[2*F+1];if(G<0){var Y=!1;if((j=-G)>=1<<28?(Y=!l,j-=1<<28):(Y=!!l,j-=1),Y)c(p,e,X++,j);else{var K=w[j],D=k*j,B=S[D+n+1],q=S[D+n+1+r];e:for(var ee=0;ee<X;++ee){var J=p[ee],$=k*J;if(!(q<_[$+n+1]||_[$+n+1+r]<B)){for(var te=n+2;te<r;++te)if(S[D+te+r]<_[$+te]||_[$+te+r]<S[D+te])continue e;var ie,ae=x[J];if((ie=l?d(K,ae):d(ae,K))!==void 0)return ie}}}}else a(p,e,X--,G-P)}},scanComplete:function(r,n,d,l,y,v,_,x,T,A,S){for(var w=0,L=2*r,k=n,C=n+r,M=l;M<y;++M){var P=M+(1<<28),O=L*M;o[w++]=v[O+k],o[w++]=-P,o[w++]=v[O+C],o[w++]=P}for(M=x;M<T;++M){P=M+1;var F=L*M;o[w++]=A[F+k],o[w++]=-P}var j=w>>>1;g(o,j);var W=0;for(M=0;M<j;++M){var Z=0|o[2*M+1];if(Z<0)if((P=-Z)>=1<<28)p[W++]=P-(1<<28);else{var Q=S[P-=1],X=L*P,G=A[X+n+1],Y=A[X+n+1+r];e:for(var K=0;K<W;++K){var D=p[K],B=_[D];if(B===Q)break;var q=L*D;if(!(Y<v[q+n+1]||v[q+n+1+r]<G)){for(var ee=n+2;ee<r;++ee)if(A[X+ee+r]<v[q+ee]||v[q+ee+r]<A[X+ee])continue e;var J=d(B,Q);if(J!==void 0)return J}}}else{for(P=Z-(1<<28),K=W-1;K>=0;--K)if(p[K]===P){for(ee=K+1;ee<W;++ee)p[ee-1]=p[ee];break}--W}}}};var t=h("typedarray-pool"),m=h("bit-twiddle"),g=h("./sort"),p=t.mallocInt32(1024),e=t.mallocInt32(1024),f=t.mallocInt32(1024),u=t.mallocInt32(1024),i=t.mallocInt32(1024),s=t.mallocInt32(1024),o=t.mallocDouble(8192);function a(r,n,d,l){var y=n[l],v=r[d-1];r[y]=v,n[v]=y}function c(r,n,d,l){r[d]=l,n[l]=d}},{"./sort":113,"bit-twiddle":104,"typedarray-pool":601}],115:[function(h,N,H){},{}],116:[function(h,N,H){var t,m=typeof Reflect=="object"?Reflect:null,g=m&&typeof m.apply=="function"?m.apply:function(d,l,y){return Function.prototype.apply.call(d,l,y)};t=m&&typeof m.ownKeys=="function"?m.ownKeys:Object.getOwnPropertySymbols?function(d){return Object.getOwnPropertyNames(d).concat(Object.getOwnPropertySymbols(d))}:function(d){return Object.getOwnPropertyNames(d)};var p=Number.isNaN||function(d){return d!=d};function e(){e.init.call(this)}N.exports=e,N.exports.once=function(d,l){return new Promise(function(y,v){function _(){x!==void 0&&d.removeListener("error",x),y([].slice.call(arguments))}var x;l!=="error"&&(x=function(T){d.removeListener(l,_),v(T)},d.once("error",x)),d.once(l,_)})},e.EventEmitter=e,e.prototype._events=void 0,e.prototype._eventsCount=0,e.prototype._maxListeners=void 0;var f=10;function u(d){if(typeof d!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof d)}function i(d){return d._maxListeners===void 0?e.defaultMaxListeners:d._maxListeners}function s(d,l,y,v){var _,x,T,A;if(u(y),(x=d._events)===void 0?(x=d._events=Object.create(null),d._eventsCount=0):(x.newListener!==void 0&&(d.emit("newListener",l,y.listener?y.listener:y),x=d._events),T=x[l]),T===void 0)T=x[l]=y,++d._eventsCount;else if(typeof T=="function"?T=x[l]=v?[y,T]:[T,y]:v?T.unshift(y):T.push(y),(_=i(d))>0&&T.length>_&&!T.warned){T.warned=!0;var S=new Error("Possible EventEmitter memory leak detected. "+T.length+" "+String(l)+" listeners added. Use emitter.setMaxListeners() to increase limit");S.name="MaxListenersExceededWarning",S.emitter=d,S.type=l,S.count=T.length,A=S,console&&console.warn&&console.warn(A)}return d}function o(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function a(d,l,y){var v={fired:!1,wrapFn:void 0,target:d,type:l,listener:y},_=o.bind(v);return _.listener=y,v.wrapFn=_,_}function c(d,l,y){var v=d._events;if(v===void 0)return[];var _=v[l];return _===void 0?[]:typeof _=="function"?y?[_.listener||_]:[_]:y?function(x){for(var T=new Array(x.length),A=0;A<T.length;++A)T[A]=x[A].listener||x[A];return T}(_):n(_,_.length)}function r(d){var l=this._events;if(l!==void 0){var y=l[d];if(typeof y=="function")return 1;if(y!==void 0)return y.length}return 0}function n(d,l){for(var y=new Array(l),v=0;v<l;++v)y[v]=d[v];return y}Object.defineProperty(e,"defaultMaxListeners",{enumerable:!0,get:function(){return f},set:function(d){if(typeof d!="number"||d<0||p(d))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+d+".");f=d}}),e.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},e.prototype.setMaxListeners=function(d){if(typeof d!="number"||d<0||p(d))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+d+".");return this._maxListeners=d,this},e.prototype.getMaxListeners=function(){return i(this)},e.prototype.emit=function(d){for(var l=[],y=1;y<arguments.length;y++)l.push(arguments[y]);var v=d==="error",_=this._events;if(_!==void 0)v=v&&_.error===void 0;else if(!v)return!1;if(v){var x;if(l.length>0&&(x=l[0]),x instanceof Error)throw x;var T=new Error("Unhandled error."+(x?" ("+x.message+")":""));throw T.context=x,T}var A=_[d];if(A===void 0)return!1;if(typeof A=="function")g(A,this,l);else{var S=A.length,w=n(A,S);for(y=0;y<S;++y)g(w[y],this,l)}return!0},e.prototype.addListener=function(d,l){return s(this,d,l,!1)},e.prototype.on=e.prototype.addListener,e.prototype.prependListener=function(d,l){return s(this,d,l,!0)},e.prototype.once=function(d,l){return u(l),this.on(d,a(this,d,l)),this},e.prototype.prependOnceListener=function(d,l){return u(l),this.prependListener(d,a(this,d,l)),this},e.prototype.removeListener=function(d,l){var y,v,_,x,T;if(u(l),(v=this._events)===void 0)return this;if((y=v[d])===void 0)return this;if(y===l||y.listener===l)--this._eventsCount==0?this._events=Object.create(null):(delete v[d],v.removeListener&&this.emit("removeListener",d,y.listener||l));else if(typeof y!="function"){for(_=-1,x=y.length-1;x>=0;x--)if(y[x]===l||y[x].listener===l){T=y[x].listener,_=x;break}if(_<0)return this;_===0?y.shift():function(A,S){for(;S+1<A.length;S++)A[S]=A[S+1];A.pop()}(y,_),y.length===1&&(v[d]=y[0]),v.removeListener!==void 0&&this.emit("removeListener",d,T||l)}return this},e.prototype.off=e.prototype.removeListener,e.prototype.removeAllListeners=function(d){var l,y,v;if((y=this._events)===void 0)return this;if(y.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):y[d]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete y[d]),this;if(arguments.length===0){var _,x=Object.keys(y);for(v=0;v<x.length;++v)(_=x[v])!=="removeListener"&&this.removeAllListeners(_);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(l=y[d])=="function")this.removeListener(d,l);else if(l!==void 0)for(v=l.length-1;v>=0;v--)this.removeListener(d,l[v]);return this},e.prototype.listeners=function(d){return c(this,d,!0)},e.prototype.rawListeners=function(d){return c(this,d,!1)},e.listenerCount=function(d,l){return typeof d.listenerCount=="function"?d.listenerCount(l):r.call(d,l)},e.prototype.listenerCount=r,e.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},{}],117:[function(h,N,H){(function(t){(function(){var m=h("base64-js"),g=h("ieee754");H.Buffer=e,H.SlowBuffer=function(D){return+D!=D&&(D=0),e.alloc(+D)},H.INSPECT_MAX_BYTES=50;function p(D){if(D>2147483647)throw new RangeError('The value "'+D+'" is invalid for option "size"');var B=new Uint8Array(D);return B.__proto__=e.prototype,B}function e(D,B,q){if(typeof D=="number"){if(typeof B=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return i(D)}return f(D,B,q)}function f(D,B,q){if(typeof D=="string")return function($,te){if(typeof te=="string"&&te!==""||(te="utf8"),!e.isEncoding(te))throw new TypeError("Unknown encoding: "+te);var ie=0|a($,te),ae=p(ie),he=ae.write($,te);return he!==ie&&(ae=ae.slice(0,he)),ae}(D,B);if(ArrayBuffer.isView(D))return s(D);if(D==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof D);if(Y(D,ArrayBuffer)||D&&Y(D.buffer,ArrayBuffer))return function($,te,ie){if(te<0||$.byteLength<te)throw new RangeError('"offset" is outside of buffer bounds');if($.byteLength<te+(ie||0))throw new RangeError('"length" is outside of buffer bounds');var ae;return ae=te===void 0&&ie===void 0?new Uint8Array($):ie===void 0?new Uint8Array($,te):new Uint8Array($,te,ie),ae.__proto__=e.prototype,ae}(D,B,q);if(typeof D=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var ee=D.valueOf&&D.valueOf();if(ee!=null&&ee!==D)return e.from(ee,B,q);var J=function($){if(e.isBuffer($)){var te=0|o($.length),ie=p(te);return ie.length===0||$.copy(ie,0,0,te),ie}if($.length!==void 0)return typeof $.length!="number"||K($.length)?p(0):s($);if($.type==="Buffer"&&Array.isArray($.data))return s($.data)}(D);if(J)return J;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof D[Symbol.toPrimitive]=="function")return e.from(D[Symbol.toPrimitive]("string"),B,q);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof D)}function u(D){if(typeof D!="number")throw new TypeError('"size" argument must be of type number');if(D<0)throw new RangeError('The value "'+D+'" is invalid for option "size"')}function i(D){return u(D),p(D<0?0:0|o(D))}function s(D){for(var B=D.length<0?0:0|o(D.length),q=p(B),ee=0;ee<B;ee+=1)q[ee]=255&D[ee];return q}function o(D){if(D>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647 .toString(16)+" bytes");return 0|D}function a(D,B){if(e.isBuffer(D))return D.length;if(ArrayBuffer.isView(D)||Y(D,ArrayBuffer))return D.byteLength;if(typeof D!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof D);var q=D.length,ee=arguments.length>2&&arguments[2]===!0;if(!ee&&q===0)return 0;for(var J=!1;;)switch(B){case"ascii":case"latin1":case"binary":return q;case"utf8":case"utf-8":return Q(D).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*q;case"hex":return q>>>1;case"base64":return X(D).length;default:if(J)return ee?-1:Q(D).length;B=(""+B).toLowerCase(),J=!0}}function c(D,B,q){var ee=!1;if((B===void 0||B<0)&&(B=0),B>this.length||((q===void 0||q>this.length)&&(q=this.length),q<=0)||(q>>>=0)<=(B>>>=0))return"";for(D||(D="utf8");;)switch(D){case"hex":return k(this,B,q);case"utf8":case"utf-8":return S(this,B,q);case"ascii":return w(this,B,q);case"latin1":case"binary":return L(this,B,q);case"base64":return A(this,B,q);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,B,q);default:if(ee)throw new TypeError("Unknown encoding: "+D);D=(D+"").toLowerCase(),ee=!0}}function r(D,B,q){var ee=D[B];D[B]=D[q],D[q]=ee}function n(D,B,q,ee,J){if(D.length===0)return-1;if(typeof q=="string"?(ee=q,q=0):q>2147483647?q=2147483647:q<-2147483648&&(q=-2147483648),K(q=+q)&&(q=J?0:D.length-1),q<0&&(q=D.length+q),q>=D.length){if(J)return-1;q=D.length-1}else if(q<0){if(!J)return-1;q=0}if(typeof B=="string"&&(B=e.from(B,ee)),e.isBuffer(B))return B.length===0?-1:d(D,B,q,ee,J);if(typeof B=="number")return B&=255,typeof Uint8Array.prototype.indexOf=="function"?J?Uint8Array.prototype.indexOf.call(D,B,q):Uint8Array.prototype.lastIndexOf.call(D,B,q):d(D,[B],q,ee,J);throw new TypeError("val must be string, number or Buffer")}function d(D,B,q,ee,J){var $,te=1,ie=D.length,ae=B.length;if(ee!==void 0&&((ee=String(ee).toLowerCase())==="ucs2"||ee==="ucs-2"||ee==="utf16le"||ee==="utf-16le")){if(D.length<2||B.length<2)return-1;te=2,ie/=2,ae/=2,q/=2}function he(ve,ke){return te===1?ve[ke]:ve.readUInt16BE(ke*te)}if(J){var se=-1;for($=q;$<ie;$++)if(he(D,$)===he(B,se===-1?0:$-se)){if(se===-1&&(se=$),$-se+1===ae)return se*te}else se!==-1&&($-=$-se),se=-1}else for(q+ae>ie&&(q=ie-ae),$=q;$>=0;$--){for(var de=!0,ce=0;ce<ae;ce++)if(he(D,$+ce)!==he(B,ce)){de=!1;break}if(de)return $}return-1}function l(D,B,q,ee){q=Number(q)||0;var J=D.length-q;ee?(ee=Number(ee))>J&&(ee=J):ee=J;var $=B.length;ee>$/2&&(ee=$/2);for(var te=0;te<ee;++te){var ie=parseInt(B.substr(2*te,2),16);if(K(ie))return te;D[q+te]=ie}return te}function y(D,B,q,ee){return G(Q(B,D.length-q),D,q,ee)}function v(D,B,q,ee){return G(function(J){for(var $=[],te=0;te<J.length;++te)$.push(255&J.charCodeAt(te));return $}(B),D,q,ee)}function _(D,B,q,ee){return v(D,B,q,ee)}function x(D,B,q,ee){return G(X(B),D,q,ee)}function T(D,B,q,ee){return G(function(J,$){for(var te,ie,ae,he=[],se=0;se<J.length&&!(($-=2)<0);++se)te=J.charCodeAt(se),ie=te>>8,ae=te%256,he.push(ae),he.push(ie);return he}(B,D.length-q),D,q,ee)}function A(D,B,q){return B===0&&q===D.length?m.fromByteArray(D):m.fromByteArray(D.slice(B,q))}function S(D,B,q){q=Math.min(D.length,q);for(var ee=[],J=B;J<q;){var $,te,ie,ae,he=D[J],se=null,de=he>239?4:he>223?3:he>191?2:1;if(J+de<=q)switch(de){case 1:he<128&&(se=he);break;case 2:(192&($=D[J+1]))==128&&(ae=(31&he)<<6|63&$)>127&&(se=ae);break;case 3:$=D[J+1],te=D[J+2],(192&$)==128&&(192&te)==128&&(ae=(15&he)<<12|(63&$)<<6|63&te)>2047&&(ae<55296||ae>57343)&&(se=ae);break;case 4:$=D[J+1],te=D[J+2],ie=D[J+3],(192&$)==128&&(192&te)==128&&(192&ie)==128&&(ae=(15&he)<<18|(63&$)<<12|(63&te)<<6|63&ie)>65535&&ae<1114112&&(se=ae)}se===null?(se=65533,de=1):se>65535&&(se-=65536,ee.push(se>>>10&1023|55296),se=56320|1023&se),ee.push(se),J+=de}return function(ce){var ve=ce.length;if(ve<=4096)return String.fromCharCode.apply(String,ce);for(var ke="",Ee=0;Ee<ve;)ke+=String.fromCharCode.apply(String,ce.slice(Ee,Ee+=4096));return ke}(ee)}H.kMaxLength=2147483647,e.TYPED_ARRAY_SUPPORT=function(){try{var D=new Uint8Array(1);return D.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},D.foo()===42}catch(B){return!1}}(),e.TYPED_ARRAY_SUPPORT||typeof console=="undefined"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(e.prototype,"parent",{enumerable:!0,get:function(){if(e.isBuffer(this))return this.buffer}}),Object.defineProperty(e.prototype,"offset",{enumerable:!0,get:function(){if(e.isBuffer(this))return this.byteOffset}}),typeof Symbol!="undefined"&&Symbol.species!=null&&e[Symbol.species]===e&&Object.defineProperty(e,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),e.poolSize=8192,e.from=function(D,B,q){return f(D,B,q)},e.prototype.__proto__=Uint8Array.prototype,e.__proto__=Uint8Array,e.alloc=function(D,B,q){return function(ee,J,$){return u(ee),ee<=0?p(ee):J!==void 0?typeof $=="string"?p(ee).fill(J,$):p(ee).fill(J):p(ee)}(D,B,q)},e.allocUnsafe=function(D){return i(D)},e.allocUnsafeSlow=function(D){return i(D)},e.isBuffer=function(D){return D!=null&&D._isBuffer===!0&&D!==e.prototype},e.compare=function(D,B){if(Y(D,Uint8Array)&&(D=e.from(D,D.offset,D.byteLength)),Y(B,Uint8Array)&&(B=e.from(B,B.offset,B.byteLength)),!e.isBuffer(D)||!e.isBuffer(B))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(D===B)return 0;for(var q=D.length,ee=B.length,J=0,$=Math.min(q,ee);J<$;++J)if(D[J]!==B[J]){q=D[J],ee=B[J];break}return q<ee?-1:ee<q?1:0},e.isEncoding=function(D){switch(String(D).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},e.concat=function(D,B){if(!Array.isArray(D))throw new TypeError('"list" argument must be an Array of Buffers');if(D.length===0)return e.alloc(0);var q;if(B===void 0)for(B=0,q=0;q<D.length;++q)B+=D[q].length;var ee=e.allocUnsafe(B),J=0;for(q=0;q<D.length;++q){var $=D[q];if(Y($,Uint8Array)&&($=e.from($)),!e.isBuffer($))throw new TypeError('"list" argument must be an Array of Buffers');$.copy(ee,J),J+=$.length}return ee},e.byteLength=a,e.prototype._isBuffer=!0,e.prototype.swap16=function(){var D=this.length;if(D%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var B=0;B<D;B+=2)r(this,B,B+1);return this},e.prototype.swap32=function(){var D=this.length;if(D%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var B=0;B<D;B+=4)r(this,B,B+3),r(this,B+1,B+2);return this},e.prototype.swap64=function(){var D=this.length;if(D%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var B=0;B<D;B+=8)r(this,B,B+7),r(this,B+1,B+6),r(this,B+2,B+5),r(this,B+3,B+4);return this},e.prototype.toString=function(){var D=this.length;return D===0?"":arguments.length===0?S(this,0,D):c.apply(this,arguments)},e.prototype.toLocaleString=e.prototype.toString,e.prototype.equals=function(D){if(!e.isBuffer(D))throw new TypeError("Argument must be a Buffer");return this===D||e.compare(this,D)===0},e.prototype.inspect=function(){var D="",B=H.INSPECT_MAX_BYTES;return D=this.toString("hex",0,B).replace(/(.{2})/g,"$1 ").trim(),this.length>B&&(D+=" ... "),"<Buffer "+D+">"},e.prototype.compare=function(D,B,q,ee,J){if(Y(D,Uint8Array)&&(D=e.from(D,D.offset,D.byteLength)),!e.isBuffer(D))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof D);if(B===void 0&&(B=0),q===void 0&&(q=D?D.length:0),ee===void 0&&(ee=0),J===void 0&&(J=this.length),B<0||q>D.length||ee<0||J>this.length)throw new RangeError("out of range index");if(ee>=J&&B>=q)return 0;if(ee>=J)return-1;if(B>=q)return 1;if(this===D)return 0;for(var $=(J>>>=0)-(ee>>>=0),te=(q>>>=0)-(B>>>=0),ie=Math.min($,te),ae=this.slice(ee,J),he=D.slice(B,q),se=0;se<ie;++se)if(ae[se]!==he[se]){$=ae[se],te=he[se];break}return $<te?-1:te<$?1:0},e.prototype.includes=function(D,B,q){return this.indexOf(D,B,q)!==-1},e.prototype.indexOf=function(D,B,q){return n(this,D,B,q,!0)},e.prototype.lastIndexOf=function(D,B,q){return n(this,D,B,q,!1)},e.prototype.write=function(D,B,q,ee){if(B===void 0)ee="utf8",q=this.length,B=0;else if(q===void 0&&typeof B=="string")ee=B,q=this.length,B=0;else{if(!isFinite(B))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");B>>>=0,isFinite(q)?(q>>>=0,ee===void 0&&(ee="utf8")):(ee=q,q=void 0)}var J=this.length-B;if((q===void 0||q>J)&&(q=J),D.length>0&&(q<0||B<0)||B>this.length)throw new RangeError("Attempt to write outside buffer bounds");ee||(ee="utf8");for(var $=!1;;)switch(ee){case"hex":return l(this,D,B,q);case"utf8":case"utf-8":return y(this,D,B,q);case"ascii":return v(this,D,B,q);case"latin1":case"binary":return _(this,D,B,q);case"base64":return x(this,D,B,q);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,D,B,q);default:if($)throw new TypeError("Unknown encoding: "+ee);ee=(""+ee).toLowerCase(),$=!0}},e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function w(D,B,q){var ee="";q=Math.min(D.length,q);for(var J=B;J<q;++J)ee+=String.fromCharCode(127&D[J]);return ee}function L(D,B,q){var ee="";q=Math.min(D.length,q);for(var J=B;J<q;++J)ee+=String.fromCharCode(D[J]);return ee}function k(D,B,q){var ee=D.length;(!B||B<0)&&(B=0),(!q||q<0||q>ee)&&(q=ee);for(var J="",$=B;$<q;++$)J+=Z(D[$]);return J}function C(D,B,q){for(var ee=D.slice(B,q),J="",$=0;$<ee.length;$+=2)J+=String.fromCharCode(ee[$]+256*ee[$+1]);return J}function M(D,B,q){if(D%1!=0||D<0)throw new RangeError("offset is not uint");if(D+B>q)throw new RangeError("Trying to access beyond buffer length")}function P(D,B,q,ee,J,$){if(!e.isBuffer(D))throw new TypeError('"buffer" argument must be a Buffer instance');if(B>J||B<$)throw new RangeError('"value" argument is out of bounds');if(q+ee>D.length)throw new RangeError("Index out of range")}function O(D,B,q,ee,J,$){if(q+ee>D.length)throw new RangeError("Index out of range");if(q<0)throw new RangeError("Index out of range")}function F(D,B,q,ee,J){return B=+B,q>>>=0,J||O(D,0,q,4),g.write(D,B,q,ee,23,4),q+4}function j(D,B,q,ee,J){return B=+B,q>>>=0,J||O(D,0,q,8),g.write(D,B,q,ee,52,8),q+8}e.prototype.slice=function(D,B){var q=this.length;(D=~~D)<0?(D+=q)<0&&(D=0):D>q&&(D=q),(B=B===void 0?q:~~B)<0?(B+=q)<0&&(B=0):B>q&&(B=q),B<D&&(B=D);var ee=this.subarray(D,B);return ee.__proto__=e.prototype,ee},e.prototype.readUIntLE=function(D,B,q){D>>>=0,B>>>=0,q||M(D,B,this.length);for(var ee=this[D],J=1,$=0;++$<B&&(J*=256);)ee+=this[D+$]*J;return ee},e.prototype.readUIntBE=function(D,B,q){D>>>=0,B>>>=0,q||M(D,B,this.length);for(var ee=this[D+--B],J=1;B>0&&(J*=256);)ee+=this[D+--B]*J;return ee},e.prototype.readUInt8=function(D,B){return D>>>=0,B||M(D,1,this.length),this[D]},e.prototype.readUInt16LE=function(D,B){return D>>>=0,B||M(D,2,this.length),this[D]|this[D+1]<<8},e.prototype.readUInt16BE=function(D,B){return D>>>=0,B||M(D,2,this.length),this[D]<<8|this[D+1]},e.prototype.readUInt32LE=function(D,B){return D>>>=0,B||M(D,4,this.length),(this[D]|this[D+1]<<8|this[D+2]<<16)+16777216*this[D+3]},e.prototype.readUInt32BE=function(D,B){return D>>>=0,B||M(D,4,this.length),16777216*this[D]+(this[D+1]<<16|this[D+2]<<8|this[D+3])},e.prototype.readIntLE=function(D,B,q){D>>>=0,B>>>=0,q||M(D,B,this.length);for(var ee=this[D],J=1,$=0;++$<B&&(J*=256);)ee+=this[D+$]*J;return ee>=(J*=128)&&(ee-=Math.pow(2,8*B)),ee},e.prototype.readIntBE=function(D,B,q){D>>>=0,B>>>=0,q||M(D,B,this.length);for(var ee=B,J=1,$=this[D+--ee];ee>0&&(J*=256);)$+=this[D+--ee]*J;return $>=(J*=128)&&($-=Math.pow(2,8*B)),$},e.prototype.readInt8=function(D,B){return D>>>=0,B||M(D,1,this.length),128&this[D]?-1*(255-this[D]+1):this[D]},e.prototype.readInt16LE=function(D,B){D>>>=0,B||M(D,2,this.length);var q=this[D]|this[D+1]<<8;return 32768&q?4294901760|q:q},e.prototype.readInt16BE=function(D,B){D>>>=0,B||M(D,2,this.length);var q=this[D+1]|this[D]<<8;return 32768&q?4294901760|q:q},e.prototype.readInt32LE=function(D,B){return D>>>=0,B||M(D,4,this.length),this[D]|this[D+1]<<8|this[D+2]<<16|this[D+3]<<24},e.prototype.readInt32BE=function(D,B){return D>>>=0,B||M(D,4,this.length),this[D]<<24|this[D+1]<<16|this[D+2]<<8|this[D+3]},e.prototype.readFloatLE=function(D,B){return D>>>=0,B||M(D,4,this.length),g.read(this,D,!0,23,4)},e.prototype.readFloatBE=function(D,B){return D>>>=0,B||M(D,4,this.length),g.read(this,D,!1,23,4)},e.prototype.readDoubleLE=function(D,B){return D>>>=0,B||M(D,8,this.length),g.read(this,D,!0,52,8)},e.prototype.readDoubleBE=function(D,B){return D>>>=0,B||M(D,8,this.length),g.read(this,D,!1,52,8)},e.prototype.writeUIntLE=function(D,B,q,ee){D=+D,B>>>=0,q>>>=0,ee||P(this,D,B,q,Math.pow(2,8*q)-1,0);var J=1,$=0;for(this[B]=255&D;++$<q&&(J*=256);)this[B+$]=D/J&255;return B+q},e.prototype.writeUIntBE=function(D,B,q,ee){D=+D,B>>>=0,q>>>=0,ee||P(this,D,B,q,Math.pow(2,8*q)-1,0);var J=q-1,$=1;for(this[B+J]=255&D;--J>=0&&($*=256);)this[B+J]=D/$&255;return B+q},e.prototype.writeUInt8=function(D,B,q){return D=+D,B>>>=0,q||P(this,D,B,1,255,0),this[B]=255&D,B+1},e.prototype.writeUInt16LE=function(D,B,q){return D=+D,B>>>=0,q||P(this,D,B,2,65535,0),this[B]=255&D,this[B+1]=D>>>8,B+2},e.prototype.writeUInt16BE=function(D,B,q){return D=+D,B>>>=0,q||P(this,D,B,2,65535,0),this[B]=D>>>8,this[B+1]=255&D,B+2},e.prototype.writeUInt32LE=function(D,B,q){return D=+D,B>>>=0,q||P(this,D,B,4,4294967295,0),this[B+3]=D>>>24,this[B+2]=D>>>16,this[B+1]=D>>>8,this[B]=255&D,B+4},e.prototype.writeUInt32BE=function(D,B,q){return D=+D,B>>>=0,q||P(this,D,B,4,4294967295,0),this[B]=D>>>24,this[B+1]=D>>>16,this[B+2]=D>>>8,this[B+3]=255&D,B+4},e.prototype.writeIntLE=function(D,B,q,ee){if(D=+D,B>>>=0,!ee){var J=Math.pow(2,8*q-1);P(this,D,B,q,J-1,-J)}var $=0,te=1,ie=0;for(this[B]=255&D;++$<q&&(te*=256);)D<0&&ie===0&&this[B+$-1]!==0&&(ie=1),this[B+$]=(D/te>>0)-ie&255;return B+q},e.prototype.writeIntBE=function(D,B,q,ee){if(D=+D,B>>>=0,!ee){var J=Math.pow(2,8*q-1);P(this,D,B,q,J-1,-J)}var $=q-1,te=1,ie=0;for(this[B+$]=255&D;--$>=0&&(te*=256);)D<0&&ie===0&&this[B+$+1]!==0&&(ie=1),this[B+$]=(D/te>>0)-ie&255;return B+q},e.prototype.writeInt8=function(D,B,q){return D=+D,B>>>=0,q||P(this,D,B,1,127,-128),D<0&&(D=255+D+1),this[B]=255&D,B+1},e.prototype.writeInt16LE=function(D,B,q){return D=+D,B>>>=0,q||P(this,D,B,2,32767,-32768),this[B]=255&D,this[B+1]=D>>>8,B+2},e.prototype.writeInt16BE=function(D,B,q){return D=+D,B>>>=0,q||P(this,D,B,2,32767,-32768),this[B]=D>>>8,this[B+1]=255&D,B+2},e.prototype.writeInt32LE=function(D,B,q){return D=+D,B>>>=0,q||P(this,D,B,4,2147483647,-2147483648),this[B]=255&D,this[B+1]=D>>>8,this[B+2]=D>>>16,this[B+3]=D>>>24,B+4},e.prototype.writeInt32BE=function(D,B,q){return D=+D,B>>>=0,q||P(this,D,B,4,2147483647,-2147483648),D<0&&(D=4294967295+D+1),this[B]=D>>>24,this[B+1]=D>>>16,this[B+2]=D>>>8,this[B+3]=255&D,B+4},e.prototype.writeFloatLE=function(D,B,q){return F(this,D,B,!0,q)},e.prototype.writeFloatBE=function(D,B,q){return F(this,D,B,!1,q)},e.prototype.writeDoubleLE=function(D,B,q){return j(this,D,B,!0,q)},e.prototype.writeDoubleBE=function(D,B,q){return j(this,D,B,!1,q)},e.prototype.copy=function(D,B,q,ee){if(!e.isBuffer(D))throw new TypeError("argument should be a Buffer");if(q||(q=0),ee||ee===0||(ee=this.length),B>=D.length&&(B=D.length),B||(B=0),ee>0&&ee<q&&(ee=q),ee===q||D.length===0||this.length===0)return 0;if(B<0)throw new RangeError("targetStart out of bounds");if(q<0||q>=this.length)throw new RangeError("Index out of range");if(ee<0)throw new RangeError("sourceEnd out of bounds");ee>this.length&&(ee=this.length),D.length-B<ee-q&&(ee=D.length-B+q);var J=ee-q;if(this===D&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(B,q,ee);else if(this===D&&q<B&&B<ee)for(var $=J-1;$>=0;--$)D[$+B]=this[$+q];else Uint8Array.prototype.set.call(D,this.subarray(q,ee),B);return J},e.prototype.fill=function(D,B,q,ee){if(typeof D=="string"){if(typeof B=="string"?(ee=B,B=0,q=this.length):typeof q=="string"&&(ee=q,q=this.length),ee!==void 0&&typeof ee!="string")throw new TypeError("encoding must be a string");if(typeof ee=="string"&&!e.isEncoding(ee))throw new TypeError("Unknown encoding: "+ee);if(D.length===1){var J=D.charCodeAt(0);(ee==="utf8"&&J<128||ee==="latin1")&&(D=J)}}else typeof D=="number"&&(D&=255);if(B<0||this.length<B||this.length<q)throw new RangeError("Out of range index");if(q<=B)return this;var $;if(B>>>=0,q=q===void 0?this.length:q>>>0,D||(D=0),typeof D=="number")for($=B;$<q;++$)this[$]=D;else{var te=e.isBuffer(D)?D:e.from(D,ee),ie=te.length;if(ie===0)throw new TypeError('The value "'+D+'" is invalid for argument "value"');for($=0;$<q-B;++$)this[$+B]=te[$%ie]}return this};var W=/[^+/0-9A-Za-z-_]/g;function Z(D){return D<16?"0"+D.toString(16):D.toString(16)}function Q(D,B){var q;B=B||1/0;for(var ee=D.length,J=null,$=[],te=0;te<ee;++te){if((q=D.charCodeAt(te))>55295&&q<57344){if(!J){if(q>56319){(B-=3)>-1&&$.push(239,191,189);continue}if(te+1===ee){(B-=3)>-1&&$.push(239,191,189);continue}J=q;continue}if(q<56320){(B-=3)>-1&&$.push(239,191,189),J=q;continue}q=65536+(J-55296<<10|q-56320)}else J&&(B-=3)>-1&&$.push(239,191,189);if(J=null,q<128){if((B-=1)<0)break;$.push(q)}else if(q<2048){if((B-=2)<0)break;$.push(q>>6|192,63&q|128)}else if(q<65536){if((B-=3)<0)break;$.push(q>>12|224,q>>6&63|128,63&q|128)}else{if(!(q<1114112))throw new Error("Invalid code point");if((B-=4)<0)break;$.push(q>>18|240,q>>12&63|128,q>>6&63|128,63&q|128)}}return $}function X(D){return m.toByteArray(function(B){if((B=(B=B.split("=")[0]).trim().replace(W,"")).length<2)return"";for(;B.length%4!=0;)B+="=";return B}(D))}function G(D,B,q,ee){for(var J=0;J<ee&&!(J+q>=B.length||J>=D.length);++J)B[J+q]=D[J];return J}function Y(D,B){return D instanceof B||D!=null&&D.constructor!=null&&D.constructor.name!=null&&D.constructor.name===B.name}function K(D){return D!=D}}).call(this)}).call(this,h("buffer").Buffer)},{"base64-js":86,buffer:117,ieee754:437}],118:[function(h,N,H){var t=h("./lib/monotone"),m=h("./lib/triangulation"),g=h("./lib/delaunay"),p=h("./lib/filter");function e(i){return[Math.min(i[0],i[1]),Math.max(i[0],i[1])]}function f(i,s){return i[0]-s[0]||i[1]-s[1]}function u(i,s,o){return s in i?i[s]:o}N.exports=function(i,s,o){Array.isArray(s)?(o=o||{},s=s||[]):(o=s||{},s=[]);var a=!!u(o,"delaunay",!0),c=!!u(o,"interior",!0),r=!!u(o,"exterior",!0),n=!!u(o,"infinity",!1);if(!c&&!r||i.length===0)return[];var d=t(i,s);if(a||c!==r||n){for(var l=m(i.length,function(_){return _.map(e).sort(f)}(s)),y=0;y<d.length;++y){var v=d[y];l.addTriangle(v[0],v[1],v[2])}return a&&g(i,l),r?c?n?p(l,0,n):l.cells():p(l,1,n):p(l,-1)}return d}},{"./lib/delaunay":119,"./lib/filter":120,"./lib/monotone":121,"./lib/triangulation":122}],119:[function(h,N,H){var t=h("robust-in-sphere")[4];h("binary-search-bounds");function m(g,p,e,f,u,i){var s=p.opposite(f,u);if(!(s<0)){if(u<f){var o=f;f=u,u=o,o=i,i=s,s=o}p.isConstraint(f,u)||t(g[f],g[u],g[i],g[s])<0&&e.push(f,u)}}N.exports=function(g,p){for(var e=[],f=g.length,u=p.stars,i=0;i<f;++i)for(var s=u[i],o=1;o<s.length;o+=2)if(!((n=s[o])<i)&&!p.isConstraint(i,n)){for(var a=s[o-1],c=-1,r=1;r<s.length;r+=2)if(s[r-1]===n){c=s[r];break}c<0||t(g[i],g[n],g[a],g[c])<0&&e.push(i,n)}for(;e.length>0;){for(var n=e.pop(),d=(i=e.pop(),a=-1,c=-1,s=u[i],1);d<s.length;d+=2){var l=s[d-1],y=s[d];l===n?c=y:y===n&&(a=l)}a<0||c<0||t(g[i],g[n],g[a],g[c])>=0||(p.flip(i,n),m(g,p,e,a,i,c),m(g,p,e,i,c,a),m(g,p,e,c,n,a),m(g,p,e,n,a,c))}}},{"binary-search-bounds":103,"robust-in-sphere":532}],120:[function(h,N,H){var t,m=h("binary-search-bounds");function g(e,f,u,i,s,o,a){this.cells=e,this.neighbor=f,this.flags=i,this.constraint=u,this.active=s,this.next=o,this.boundary=a}function p(e,f){return e[0]-f[0]||e[1]-f[1]||e[2]-f[2]}N.exports=function(e,f,u){var i=function(T,A){for(var S=T.cells(),w=S.length,L=0;L<w;++L){var k=(X=S[L])[0],C=X[1],M=X[2];C<M?C<k&&(X[0]=C,X[1]=M,X[2]=k):M<k&&(X[0]=M,X[1]=k,X[2]=C)}S.sort(p);var P=new Array(w);for(L=0;L<P.length;++L)P[L]=0;var O=[],F=[],j=new Array(3*w),W=new Array(3*w),Z=null;A&&(Z=[]);var Q=new g(S,j,W,P,O,F,Z);for(L=0;L<w;++L)for(var X=S[L],G=0;G<3;++G){k=X[G],C=X[(G+1)%3];var Y=j[3*L+G]=Q.locate(C,k,T.opposite(C,k)),K=W[3*L+G]=T.isConstraint(k,C);Y<0&&(K?F.push(L):(O.push(L),P[L]=1),A&&Z.push([C,k,-1]))}return Q}(e,u);if(f===0)return u?i.cells.concat(i.boundary):i.cells;for(var s=1,o=i.active,a=i.next,c=i.flags,r=i.cells,n=i.constraint,d=i.neighbor;o.length>0||a.length>0;){for(;o.length>0;){var l=o.pop();if(c[l]!==-s){c[l]=s,r[l];for(var y=0;y<3;++y){var v=d[3*l+y];v>=0&&c[v]===0&&(n[3*l+y]?a.push(v):(o.push(v),c[v]=s))}}}var _=a;a=o,o=_,a.length=0,s=-s}var x=function(T,A,S){for(var w=0,L=0;L<T.length;++L)A[L]===S&&(T[w++]=T[L]);return T.length=w,T}(r,c,f);return u?x.concat(i.boundary):x},g.prototype.locate=(t=[0,0,0],function(e,f,u){var i=e,s=f,o=u;return f<u?f<e&&(i=f,s=u,o=e):u<e&&(i=u,s=e,o=f),i<0?-1:(t[0]=i,t[1]=s,t[2]=o,m.eq(this.cells,t,p))})},{"binary-search-bounds":103}],121:[function(h,N,H){var t=h("binary-search-bounds"),m=h("robust-orientation")[3];function g(a,c,r,n,d){this.a=a,this.b=c,this.idx=r,this.lowerIds=n,this.upperIds=d}function p(a,c,r,n){this.a=a,this.b=c,this.type=r,this.idx=n}function e(a,c){var r=a.a[0]-c.a[0]||a.a[1]-c.a[1]||a.type-c.type;return r||(a.type!==0&&(r=m(a.a,a.b,c.b))?r:a.idx-c.idx)}function f(a,c){return m(a.a,a.b,c)}function u(a,c,r,n,d){for(var l=t.lt(c,n,f),y=t.gt(c,n,f),v=l;v<y;++v){for(var _=c[v],x=_.lowerIds,T=x.length;T>1&&m(r[x[T-2]],r[x[T-1]],n)>0;)a.push([x[T-1],x[T-2],d]),T-=1;x.length=T,x.push(d);var A=_.upperIds;for(T=A.length;T>1&&m(r[A[T-2]],r[A[T-1]],n)<0;)a.push([A[T-2],A[T-1],d]),T-=1;A.length=T,A.push(d)}}function i(a,c){var r;return(r=a.a[0]<c.a[0]?m(a.a,a.b,c.a):m(c.b,c.a,a.a))?r:(r=c.b[0]<a.b[0]?m(a.a,a.b,c.b):m(c.b,c.a,a.b))||a.idx-c.idx}function s(a,c,r){var n=t.le(a,r,i),d=a[n],l=d.upperIds,y=l[l.length-1];d.upperIds=[y],a.splice(n+1,0,new g(r.a,r.b,r.idx,[y],l))}function o(a,c,r){var n=r.a;r.a=r.b,r.b=n;var d=t.eq(a,r,i),l=a[d];a[d-1].upperIds=l.upperIds,a.splice(d,1)}N.exports=function(a,c){for(var r=a.length,n=c.length,d=[],l=0;l<r;++l)d.push(new p(a[l],null,0,l));for(l=0;l<n;++l){var y=c[l],v=a[y[0]],_=a[y[1]];v[0]<_[0]?d.push(new p(v,_,2,l),new p(_,v,1,l)):v[0]>_[0]&&d.push(new p(_,v,2,l),new p(v,_,1,l))}d.sort(e);for(var x=d[0].a[0]-(1+Math.abs(d[0].a[0]))*Math.pow(2,-52),T=[new g([x,1],[x,0],-1,[],[],[],[])],A=[],S=(l=0,d.length);l<S;++l){var w=d[l],L=w.type;L===0?u(A,T,a,w.a,w.idx):L===2?s(T,a,w):o(T,a,w)}return A}},{"binary-search-bounds":103,"robust-orientation":534}],122:[function(h,N,H){var t=h("binary-search-bounds");function m(e,f){this.stars=e,this.edges=f}N.exports=function(e,f){for(var u=new Array(e),i=0;i<e;++i)u[i]=[];return new m(u,f)};var g=m.prototype;function p(e,f,u){for(var i=1,s=e.length;i<s;i+=2)if(e[i-1]===f&&e[i]===u)return e[i-1]=e[s-2],e[i]=e[s-1],void(e.length=s-2)}g.isConstraint=function(){var e=[0,0];function f(u,i){return u[0]-i[0]||u[1]-i[1]}return function(u,i){return e[0]=Math.min(u,i),e[1]=Math.max(u,i),t.eq(this.edges,e,f)>=0}}(),g.removeTriangle=function(e,f,u){var i=this.stars;p(i[e],f,u),p(i[f],u,e),p(i[u],e,f)},g.addTriangle=function(e,f,u){var i=this.stars;i[e].push(f,u),i[f].push(u,e),i[u].push(e,f)},g.opposite=function(e,f){for(var u=this.stars[f],i=1,s=u.length;i<s;i+=2)if(u[i]===e)return u[i-1];return-1},g.flip=function(e,f){var u=this.opposite(e,f),i=this.opposite(f,e);this.removeTriangle(e,f,u),this.removeTriangle(f,e,i),this.addTriangle(e,i,u),this.addTriangle(f,u,i)},g.edges=function(){for(var e=this.stars,f=[],u=0,i=e.length;u<i;++u)for(var s=e[u],o=0,a=s.length;o<a;o+=2)f.push([s[o],s[o+1]]);return f},g.cells=function(){for(var e=this.stars,f=[],u=0,i=e.length;u<i;++u)for(var s=e[u],o=0,a=s.length;o<a;o+=2){var c=s[o],r=s[o+1];u<Math.min(c,r)&&f.push([u,c,r])}return f}},{"binary-search-bounds":103}],123:[function(h,N,H){N.exports=function(t){for(var m=1,g=1;g<t.length;++g)for(var p=0;p<g;++p)if(t[g]<t[p])m=-m;else if(t[p]===t[g])return 0;return m}},{}],124:[function(h,N,H){var t=h("dup"),m=h("robust-linear-solve");function g(f,u){for(var i=0,s=f.length,o=0;o<s;++o)i+=f[o]*u[o];return i}function p(f){var u=f.length;if(u===0)return[];f[0].length;var i=t([f.length+1,f.length+1],1),s=t([f.length+1],1);i[u][u]=0;for(var o=0;o<u;++o){for(var a=0;a<=o;++a)i[a][o]=i[o][a]=2*g(f[o],f[a]);s[o]=g(f[o],f[o])}var c=m(i,s),r=0,n=c[u+1];for(o=0;o<n.length;++o)r+=n[o];var d=new Array(u);for(o=0;o<u;++o){n=c[o];var l=0;for(a=0;a<n.length;++a)l+=n[a];d[o]=l/r}return d}function e(f){if(f.length===0)return[];for(var u=f[0].length,i=t([u]),s=p(f),o=0;o<f.length;++o)for(var a=0;a<u;++a)i[a]+=f[o][a]*s[o];return i}e.barycenetric=p,N.exports=e},{dup:182,"robust-linear-solve":533}],125:[function(h,N,H){N.exports=function(m){for(var g=t(m),p=0,e=0;e<m.length;++e)for(var f=m[e],u=0;u<g.length;++u)p+=Math.pow(f[u]-g[u],2);return Math.sqrt(p/m.length)};var t=h("circumcenter")},{circumcenter:124}],126:[function(h,N,H){N.exports=function(t,m,g){return m<g?t<m?m:t>g?g:t:t<g?g:t>m?m:t}},{}],127:[function(h,N,H){N.exports=function(y,v,_){var x;if(_){x=v;for(var T=new Array(v.length),A=0;A<v.length;++A){var S=v[A];T[A]=[S[0],S[1],_[A]]}v=T}for(var w=function(L,k,C){var M=c(L,[],a(L));return d(k,M,C),!!M}(y,v,!!_);l(y,v,!!_);)w=!0;if(_&&w)for(x.length=0,_.length=0,A=0;A<v.length;++A)S=v[A],x.push([S[0],S[1]]),_.push(S[2]);return w};var t=h("union-find"),m=h("box-intersect"),g=h("robust-segment-intersect"),p=h("big-rat"),e=h("big-rat/cmp"),f=h("big-rat/to-float"),u=h("rat-vec"),i=h("nextafter"),s=h("./lib/rat-seg-intersect");function o(y){var v=f(y);return[i(v,-1/0),i(v,1/0)]}function a(y){for(var v=new Array(y.length),_=0;_<y.length;++_){var x=y[_];v[_]=[i(x[0],-1/0),i(x[1],-1/0),i(x[0],1/0),i(x[1],1/0)]}return v}function c(y,v,_){for(var x=v.length,T=new t(x),A=[],S=0;S<v.length;++S){var w=v[S],L=o(w[0]),k=o(w[1]);A.push([i(L[0],-1/0),i(k[0],-1/0),i(L[1],1/0),i(k[1],1/0)])}m(A,function(F,j){T.link(F,j)});var C=!0,M=new Array(x);for(S=0;S<x;++S)(O=T.find(S))!==S&&(C=!1,y[O]=[Math.min(y[S][0],y[O][0]),Math.min(y[S][1],y[O][1])]);if(C)return null;var P=0;for(S=0;S<x;++S){var O;(O=T.find(S))===S?(M[S]=P,y[P++]=y[S]):M[S]=-1}for(y.length=P,S=0;S<x;++S)M[S]<0&&(M[S]=M[T.find(S)]);return M}function r(y,v){return y[0]-v[0]||y[1]-v[1]}function n(y,v){var _=y[0]-v[0]||y[1]-v[1];return _||(y[2]<v[2]?-1:y[2]>v[2]?1:0)}function d(y,v,_){if(y.length!==0){if(v)for(var x=0;x<y.length;++x){var T=v[(S=y[x])[0]],A=v[S[1]];S[0]=Math.min(T,A),S[1]=Math.max(T,A)}else for(x=0;x<y.length;++x){var S;T=(S=y[x])[0],A=S[1],S[0]=Math.min(T,A),S[1]=Math.max(T,A)}_?y.sort(n):y.sort(r);var w=1;for(x=1;x<y.length;++x){var L=y[x-1],k=y[x];(k[0]!==L[0]||k[1]!==L[1]||_&&k[2]!==L[2])&&(y[w++]=k)}y.length=w}}function l(y,v,_){var x=function(L,k){for(var C=new Array(k.length),M=0;M<k.length;++M){var P=k[M],O=L[P[0]],F=L[P[1]];C[M]=[i(Math.min(O[0],F[0]),-1/0),i(Math.min(O[1],F[1]),-1/0),i(Math.max(O[0],F[0]),1/0),i(Math.max(O[1],F[1]),1/0)]}return C}(y,v),T=function(L,k,C){var M=[];return m(C,function(P,O){var F=k[P],j=k[O];if(F[0]!==j[0]&&F[0]!==j[1]&&F[1]!==j[0]&&F[1]!==j[1]){var W=L[F[0]],Z=L[F[1]],Q=L[j[0]],X=L[j[1]];g(W,Z,Q,X)&&M.push([P,O])}}),M}(y,v,x),A=a(y),S=function(L,k,C,M){var P=[];return m(C,M,function(O,F){var j=k[O];if(j[0]!==F&&j[1]!==F){var W=L[F],Z=L[j[0]],Q=L[j[1]];g(Z,Q,W,W)&&P.push([O,F])}}),P}(y,v,x,A),w=c(y,function(L,k,C,M,P){var O,F,j=L.map(function(he){return[p(he[0]),p(he[1])]});for(O=0;O<C.length;++O){var W=C[O];F=W[0];var Z=W[1],Q=k[F],X=k[Z],G=s(u(L[Q[0]]),u(L[Q[1]]),u(L[X[0]]),u(L[X[1]]));if(G){var Y=L.length;L.push([f(G[0]),f(G[1])]),j.push(G),M.push([F,Y],[Z,Y])}}for(M.sort(function(he,se){if(he[0]!==se[0])return he[0]-se[0];var de=j[he[1]],ce=j[se[1]];return e(de[0],ce[0])||e(de[1],ce[1])}),O=M.length-1;O>=0;--O){var K=k[F=(ie=M[O])[0]],D=K[0],B=K[1],q=L[D],ee=L[B];if((q[0]-ee[0]||q[1]-ee[1])<0){var J=D;D=B,B=J}K[0]=D;var $,te=K[1]=ie[1];for(P&&($=K[2]);O>0&&M[O-1][0]===F;){var ie,ae=(ie=M[--O])[1];P?k.push([te,ae,$]):k.push([te,ae]),te=ae}P?k.push([te,B,$]):k.push([te,B])}return j}(y,v,T,S,_));return d(v,w,_),!!w||T.length>0||S.length>0}},{"./lib/rat-seg-intersect":128,"big-rat":90,"big-rat/cmp":88,"big-rat/to-float":102,"box-intersect":108,nextafter:473,"rat-vec":518,"robust-segment-intersect":537,"union-find":602}],128:[function(h,N,H){N.exports=function(s,o,a,c){var r=e(o,s),n=e(c,a),d=i(r,n);if(p(d)===0)return null;var l=e(s,a),y=i(n,l),v=m(y,d),_=u(r,v);return f(s,_)};var t=h("big-rat/mul"),m=h("big-rat/div"),g=h("big-rat/sub"),p=h("big-rat/sign"),e=h("rat-vec/sub"),f=h("rat-vec/add"),u=h("rat-vec/muls");function i(s,o){return g(t(s[0],o[1]),t(s[1],o[0]))}},{"big-rat/div":89,"big-rat/mul":99,"big-rat/sign":100,"big-rat/sub":101,"rat-vec/add":517,"rat-vec/muls":519,"rat-vec/sub":520}],129:[function(h,N,H){var t=h("clamp");function m(g,p){p==null&&(p=!0);var e=g[0],f=g[1],u=g[2],i=g[3];return i==null&&(i=p?1:255),p&&(e*=255,f*=255,u*=255,i*=255),16777216*(e=255&t(e,0,255))+((f=255&t(f,0,255))<<16)+((u=255&t(u,0,255))<<8)+(i=255&t(i,0,255))}N.exports=m,N.exports.to=m,N.exports.from=function(g,p){var e=(g=+g)>>>24,f=(16711680&g)>>>16,u=(65280&g)>>>8,i=255&g;return p===!1?[e,f,u,i]:[e/255,f/255,u/255,i/255]}},{clamp:126}],130:[function(h,N,H){N.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}],131:[function(h,N,H){var t=h("color-rgba"),m=h("clamp"),g=h("dtype");N.exports=function(p,e){e!=="float"&&e||(e="array"),e==="uint"&&(e="uint8"),e==="uint_clamped"&&(e="uint8_clamped");var f=new(g(e))(4),u=e!=="uint8"&&e!=="uint8_clamped";return p.length&&typeof p!="string"||((p=t(p))[0]/=255,p[1]/=255,p[2]/=255),function(i){return i instanceof Uint8Array||i instanceof Uint8ClampedArray||!!(Array.isArray(i)&&(i[0]>1||i[0]===0)&&(i[1]>1||i[1]===0)&&(i[2]>1||i[2]===0)&&(!i[3]||i[3]>1))}(p)?(f[0]=p[0],f[1]=p[1],f[2]=p[2],f[3]=p[3]!=null?p[3]:255,u&&(f[0]/=255,f[1]/=255,f[2]/=255,f[3]/=255),f):(u?(f[0]=p[0],f[1]=p[1],f[2]=p[2],f[3]=p[3]!=null?p[3]:1):(f[0]=m(Math.floor(255*p[0]),0,255),f[1]=m(Math.floor(255*p[1]),0,255),f[2]=m(Math.floor(255*p[2]),0,255),f[3]=p[3]==null?255:m(Math.floor(255*p[3]),0,255)),f)}},{clamp:126,"color-rgba":133,dtype:181}],132:[function(h,N,H){(function(t){(function(){var m=h("color-name"),g=h("is-plain-obj"),p=h("defined");N.exports=function(f){var u,i,s=[],o=1;if(typeof f=="string")if(m[f])s=m[f].slice(),i="rgb";else if(f==="transparent")o=0,i="rgb",s=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(f)){var a=(n=f.slice(1)).length;o=1,a<=4?(s=[parseInt(n[0]+n[0],16),parseInt(n[1]+n[1],16),parseInt(n[2]+n[2],16)],a===4&&(o=parseInt(n[3]+n[3],16)/255)):(s=[parseInt(n[0]+n[1],16),parseInt(n[2]+n[3],16),parseInt(n[4]+n[5],16)],a===8&&(o=parseInt(n[6]+n[7],16)/255)),s[0]||(s[0]=0),s[1]||(s[1]=0),s[2]||(s[2]=0),i="rgb"}else if(u=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(f)){var c=u[1],r=c==="rgb",n=c.replace(/a$/,"");i=n,a=n==="cmyk"?4:n==="gray"?1:3,s=u[2].trim().split(/\s*,\s*/).map(function(l,y){if(/%$/.test(l))return y===a?parseFloat(l)/100:n==="rgb"?255*parseFloat(l)/100:parseFloat(l);if(n[y]==="h"){if(/deg$/.test(l))return parseFloat(l);if(e[l]!==void 0)return e[l]}return parseFloat(l)}),c===n&&s.push(1),o=r||s[a]===void 0?1:s[a],s=s.slice(0,a)}else f.length>10&&/[0-9](?:\s|\/)/.test(f)&&(s=f.match(/([0-9]+)/g).map(function(l){return parseFloat(l)}),i=f.match(/([a-z])/gi).join("").toLowerCase());else if(isNaN(f))if(g(f)){var d=p(f.r,f.red,f.R,null);d!==null?(i="rgb",s=[d,p(f.g,f.green,f.G),p(f.b,f.blue,f.B)]):(i="hsl",s=[p(f.h,f.hue,f.H),p(f.s,f.saturation,f.S),p(f.l,f.lightness,f.L,f.b,f.brightness)]),o=p(f.a,f.alpha,f.opacity,1),f.opacity!=null&&(o/=100)}else(Array.isArray(f)||t.ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(f))&&(s=[f[0],f[1],f[2]],i="rgb",o=f.length===4?f[3]:1);else i="rgb",s=[f>>>16,(65280&f)>>>8,255&f];return{space:i,values:s,alpha:o}};var e={red:0,orange:60,yellow:120,green:180,blue:240,purple:300}}).call(this)}).call(this,typeof La!="undefined"?La:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"color-name":130,defined:176,"is-plain-obj":447}],133:[function(h,N,H){var t=h("color-parse"),m=h("color-space/hsl"),g=h("clamp");N.exports=function(p){var e,f=t(p);return f.space?((e=Array(3))[0]=g(f.values[0],0,255),e[1]=g(f.values[1],0,255),e[2]=g(f.values[2],0,255),f.space[0]==="h"&&(e=m.rgb(e)),e.push(g(f.alpha,0,1)),e):[]}},{clamp:126,"color-parse":132,"color-space/hsl":134}],134:[function(h,N,H){var t=h("./rgb");N.exports={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(m){var g,p,e,f,u,i=m[0]/360,s=m[1]/100,o=m[2]/100;if(s===0)return[u=255*o,u,u];g=2*o-(p=o<.5?o*(1+s):o+s-o*s),f=[0,0,0];for(var a=0;a<3;a++)(e=i+1/3*-(a-1))<0?e++:e>1&&e--,u=6*e<1?g+6*(p-g)*e:2*e<1?p:3*e<2?g+(p-g)*(2/3-e)*6:g,f[a]=255*u;return f}},t.hsl=function(m){var g,p,e=m[0]/255,f=m[1]/255,u=m[2]/255,i=Math.min(e,f,u),s=Math.max(e,f,u),o=s-i;return s===i?g=0:e===s?g=(f-u)/o:f===s?g=2+(u-e)/o:u===s&&(g=4+(e-f)/o),(g=Math.min(60*g,360))<0&&(g+=360),p=(i+s)/2,[g,100*(s===i?0:p<=.5?o/(s+i):o/(2-s-i)),100*p]}},{"./rgb":135}],135:[function(h,N,H){N.exports={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]}},{}],136:[function(h,N,H){N.exports={jet:[{index:0,rgb:[0,0,131]},{index:.125,rgb:[0,60,170]},{index:.375,rgb:[5,255,255]},{index:.625,rgb:[255,255,0]},{index:.875,rgb:[250,0,0]},{index:1,rgb:[128,0,0]}],hsv:[{index:0,rgb:[255,0,0]},{index:.169,rgb:[253,255,2]},{index:.173,rgb:[247,255,2]},{index:.337,rgb:[0,252,4]},{index:.341,rgb:[0,252,10]},{index:.506,rgb:[1,249,255]},{index:.671,rgb:[2,0,253]},{index:.675,rgb:[8,0,253]},{index:.839,rgb:[255,0,251]},{index:.843,rgb:[255,0,245]},{index:1,rgb:[255,0,6]}],hot:[{index:0,rgb:[0,0,0]},{index:.3,rgb:[230,0,0]},{index:.6,rgb:[255,210,0]},{index:1,rgb:[255,255,255]}],spring:[{index:0,rgb:[255,0,255]},{index:1,rgb:[255,255,0]}],summer:[{index:0,rgb:[0,128,102]},{index:1,rgb:[255,255,102]}],autumn:[{index:0,rgb:[255,0,0]},{index:1,rgb:[255,255,0]}],winter:[{index:0,rgb:[0,0,255]},{index:1,rgb:[0,255,128]}],bone:[{index:0,rgb:[0,0,0]},{index:.376,rgb:[84,84,116]},{index:.753,rgb:[169,200,200]},{index:1,rgb:[255,255,255]}],copper:[{index:0,rgb:[0,0,0]},{index:.804,rgb:[255,160,102]},{index:1,rgb:[255,199,127]}],greys:[{index:0,rgb:[0,0,0]},{index:1,rgb:[255,255,255]}],yignbu:[{index:0,rgb:[8,29,88]},{index:.125,rgb:[37,52,148]},{index:.25,rgb:[34,94,168]},{index:.375,rgb:[29,145,192]},{index:.5,rgb:[65,182,196]},{index:.625,rgb:[127,205,187]},{index:.75,rgb:[199,233,180]},{index:.875,rgb:[237,248,217]},{index:1,rgb:[255,255,217]}],greens:[{index:0,rgb:[0,68,27]},{index:.125,rgb:[0,109,44]},{index:.25,rgb:[35,139,69]},{index:.375,rgb:[65,171,93]},{index:.5,rgb:[116,196,118]},{index:.625,rgb:[161,217,155]},{index:.75,rgb:[199,233,192]},{index:.875,rgb:[229,245,224]},{index:1,rgb:[247,252,245]}],yiorrd:[{index:0,rgb:[128,0,38]},{index:.125,rgb:[189,0,38]},{index:.25,rgb:[227,26,28]},{index:.375,rgb:[252,78,42]},{index:.5,rgb:[253,141,60]},{index:.625,rgb:[254,178,76]},{index:.75,rgb:[254,217,118]},{index:.875,rgb:[255,237,160]},{index:1,rgb:[255,255,204]}],bluered:[{index:0,rgb:[0,0,255]},{index:1,rgb:[255,0,0]}],rdbu:[{index:0,rgb:[5,10,172]},{index:.35,rgb:[106,137,247]},{index:.5,rgb:[190,190,190]},{index:.6,rgb:[220,170,132]},{index:.7,rgb:[230,145,90]},{index:1,rgb:[178,10,28]}],picnic:[{index:0,rgb:[0,0,255]},{index:.1,rgb:[51,153,255]},{index:.2,rgb:[102,204,255]},{index:.3,rgb:[153,204,255]},{index:.4,rgb:[204,204,255]},{index:.5,rgb:[255,255,255]},{index:.6,rgb:[255,204,255]},{index:.7,rgb:[255,153,255]},{index:.8,rgb:[255,102,204]},{index:.9,rgb:[255,102,102]},{index:1,rgb:[255,0,0]}],rainbow:[{index:0,rgb:[150,0,90]},{index:.125,rgb:[0,0,200]},{index:.25,rgb:[0,25,255]},{index:.375,rgb:[0,152,255]},{index:.5,rgb:[44,255,150]},{index:.625,rgb:[151,255,0]},{index:.75,rgb:[255,234,0]},{index:.875,rgb:[255,111,0]},{index:1,rgb:[255,0,0]}],portland:[{index:0,rgb:[12,51,131]},{index:.25,rgb:[10,136,186]},{index:.5,rgb:[242,211,56]},{index:.75,rgb:[242,143,56]},{index:1,rgb:[217,30,30]}],blackbody:[{index:0,rgb:[0,0,0]},{index:.2,rgb:[230,0,0]},{index:.4,rgb:[230,210,0]},{index:.7,rgb:[255,255,255]},{index:1,rgb:[160,200,255]}],earth:[{index:0,rgb:[0,0,130]},{index:.1,rgb:[0,180,180]},{index:.2,rgb:[40,210,40]},{index:.4,rgb:[230,230,50]},{index:.6,rgb:[120,70,20]},{index:1,rgb:[255,255,255]}],electric:[{index:0,rgb:[0,0,0]},{index:.15,rgb:[30,0,100]},{index:.4,rgb:[120,0,100]},{index:.6,rgb:[160,90,0]},{index:.8,rgb:[230,200,0]},{index:1,rgb:[255,250,220]}],alpha:[{index:0,rgb:[255,255,255,0]},{index:1,rgb:[255,255,255,1]}],viridis:[{index:0,rgb:[68,1,84]},{index:.13,rgb:[71,44,122]},{index:.25,rgb:[59,81,139]},{index:.38,rgb:[44,113,142]},{index:.5,rgb:[33,144,141]},{index:.63,rgb:[39,173,129]},{index:.75,rgb:[92,200,99]},{index:.88,rgb:[170,220,50]},{index:1,rgb:[253,231,37]}],inferno:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[31,12,72]},{index:.25,rgb:[85,15,109]},{index:.38,rgb:[136,34,106]},{index:.5,rgb:[186,54,85]},{index:.63,rgb:[227,89,51]},{index:.75,rgb:[249,140,10]},{index:.88,rgb:[249,201,50]},{index:1,rgb:[252,255,164]}],magma:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[28,16,68]},{index:.25,rgb:[79,18,123]},{index:.38,rgb:[129,37,129]},{index:.5,rgb:[181,54,122]},{index:.63,rgb:[229,80,100]},{index:.75,rgb:[251,135,97]},{index:.88,rgb:[254,194,135]},{index:1,rgb:[252,253,191]}],plasma:[{index:0,rgb:[13,8,135]},{index:.13,rgb:[75,3,161]},{index:.25,rgb:[125,3,168]},{index:.38,rgb:[168,34,150]},{index:.5,rgb:[203,70,121]},{index:.63,rgb:[229,107,93]},{index:.75,rgb:[248,148,65]},{index:.88,rgb:[253,195,40]},{index:1,rgb:[240,249,33]}],warm:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[172,0,187]},{index:.25,rgb:[219,0,170]},{index:.38,rgb:[255,0,130]},{index:.5,rgb:[255,63,74]},{index:.63,rgb:[255,123,0]},{index:.75,rgb:[234,176,0]},{index:.88,rgb:[190,228,0]},{index:1,rgb:[147,255,0]}],cool:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[116,0,218]},{index:.25,rgb:[98,74,237]},{index:.38,rgb:[68,146,231]},{index:.5,rgb:[0,204,197]},{index:.63,rgb:[0,247,146]},{index:.75,rgb:[0,255,88]},{index:.88,rgb:[40,255,8]},{index:1,rgb:[147,255,0]}],"rainbow-soft":[{index:0,rgb:[125,0,179]},{index:.1,rgb:[199,0,180]},{index:.2,rgb:[255,0,121]},{index:.3,rgb:[255,108,0]},{index:.4,rgb:[222,194,0]},{index:.5,rgb:[150,255,0]},{index:.6,rgb:[0,255,55]},{index:.7,rgb:[0,246,150]},{index:.8,rgb:[50,167,222]},{index:.9,rgb:[103,51,235]},{index:1,rgb:[124,0,186]}],bathymetry:[{index:0,rgb:[40,26,44]},{index:.13,rgb:[59,49,90]},{index:.25,rgb:[64,76,139]},{index:.38,rgb:[63,110,151]},{index:.5,rgb:[72,142,158]},{index:.63,rgb:[85,174,163]},{index:.75,rgb:[120,206,163]},{index:.88,rgb:[187,230,172]},{index:1,rgb:[253,254,204]}],cdom:[{index:0,rgb:[47,15,62]},{index:.13,rgb:[87,23,86]},{index:.25,rgb:[130,28,99]},{index:.38,rgb:[171,41,96]},{index:.5,rgb:[206,67,86]},{index:.63,rgb:[230,106,84]},{index:.75,rgb:[242,149,103]},{index:.88,rgb:[249,193,135]},{index:1,rgb:[254,237,176]}],chlorophyll:[{index:0,rgb:[18,36,20]},{index:.13,rgb:[25,63,41]},{index:.25,rgb:[24,91,59]},{index:.38,rgb:[13,119,72]},{index:.5,rgb:[18,148,80]},{index:.63,rgb:[80,173,89]},{index:.75,rgb:[132,196,122]},{index:.88,rgb:[175,221,162]},{index:1,rgb:[215,249,208]}],density:[{index:0,rgb:[54,14,36]},{index:.13,rgb:[89,23,80]},{index:.25,rgb:[110,45,132]},{index:.38,rgb:[120,77,178]},{index:.5,rgb:[120,113,213]},{index:.63,rgb:[115,151,228]},{index:.75,rgb:[134,185,227]},{index:.88,rgb:[177,214,227]},{index:1,rgb:[230,241,241]}],"freesurface-blue":[{index:0,rgb:[30,4,110]},{index:.13,rgb:[47,14,176]},{index:.25,rgb:[41,45,236]},{index:.38,rgb:[25,99,212]},{index:.5,rgb:[68,131,200]},{index:.63,rgb:[114,156,197]},{index:.75,rgb:[157,181,203]},{index:.88,rgb:[200,208,216]},{index:1,rgb:[241,237,236]}],"freesurface-red":[{index:0,rgb:[60,9,18]},{index:.13,rgb:[100,17,27]},{index:.25,rgb:[142,20,29]},{index:.38,rgb:[177,43,27]},{index:.5,rgb:[192,87,63]},{index:.63,rgb:[205,125,105]},{index:.75,rgb:[216,162,148]},{index:.88,rgb:[227,199,193]},{index:1,rgb:[241,237,236]}],oxygen:[{index:0,rgb:[64,5,5]},{index:.13,rgb:[106,6,15]},{index:.25,rgb:[144,26,7]},{index:.38,rgb:[168,64,3]},{index:.5,rgb:[188,100,4]},{index:.63,rgb:[206,136,11]},{index:.75,rgb:[220,174,25]},{index:.88,rgb:[231,215,44]},{index:1,rgb:[248,254,105]}],par:[{index:0,rgb:[51,20,24]},{index:.13,rgb:[90,32,35]},{index:.25,rgb:[129,44,34]},{index:.38,rgb:[159,68,25]},{index:.5,rgb:[182,99,19]},{index:.63,rgb:[199,134,22]},{index:.75,rgb:[212,171,35]},{index:.88,rgb:[221,210,54]},{index:1,rgb:[225,253,75]}],phase:[{index:0,rgb:[145,105,18]},{index:.13,rgb:[184,71,38]},{index:.25,rgb:[186,58,115]},{index:.38,rgb:[160,71,185]},{index:.5,rgb:[110,97,218]},{index:.63,rgb:[50,123,164]},{index:.75,rgb:[31,131,110]},{index:.88,rgb:[77,129,34]},{index:1,rgb:[145,105,18]}],salinity:[{index:0,rgb:[42,24,108]},{index:.13,rgb:[33,50,162]},{index:.25,rgb:[15,90,145]},{index:.38,rgb:[40,118,137]},{index:.5,rgb:[59,146,135]},{index:.63,rgb:[79,175,126]},{index:.75,rgb:[120,203,104]},{index:.88,rgb:[193,221,100]},{index:1,rgb:[253,239,154]}],temperature:[{index:0,rgb:[4,35,51]},{index:.13,rgb:[23,51,122]},{index:.25,rgb:[85,59,157]},{index:.38,rgb:[129,79,143]},{index:.5,rgb:[175,95,130]},{index:.63,rgb:[222,112,101]},{index:.75,rgb:[249,146,66]},{index:.88,rgb:[249,196,65]},{index:1,rgb:[232,250,91]}],turbidity:[{index:0,rgb:[34,31,27]},{index:.13,rgb:[65,50,41]},{index:.25,rgb:[98,69,52]},{index:.38,rgb:[131,89,57]},{index:.5,rgb:[161,112,59]},{index:.63,rgb:[185,140,66]},{index:.75,rgb:[202,174,88]},{index:.88,rgb:[216,209,126]},{index:1,rgb:[233,246,171]}],"velocity-blue":[{index:0,rgb:[17,32,64]},{index:.13,rgb:[35,52,116]},{index:.25,rgb:[29,81,156]},{index:.38,rgb:[31,113,162]},{index:.5,rgb:[50,144,169]},{index:.63,rgb:[87,173,176]},{index:.75,rgb:[149,196,189]},{index:.88,rgb:[203,221,211]},{index:1,rgb:[254,251,230]}],"velocity-green":[{index:0,rgb:[23,35,19]},{index:.13,rgb:[24,64,38]},{index:.25,rgb:[11,95,45]},{index:.38,rgb:[39,123,35]},{index:.5,rgb:[95,146,12]},{index:.63,rgb:[152,165,18]},{index:.75,rgb:[201,186,69]},{index:.88,rgb:[233,216,137]},{index:1,rgb:[255,253,205]}],cubehelix:[{index:0,rgb:[0,0,0]},{index:.07,rgb:[22,5,59]},{index:.13,rgb:[60,4,105]},{index:.2,rgb:[109,1,135]},{index:.27,rgb:[161,0,147]},{index:.33,rgb:[210,2,142]},{index:.4,rgb:[251,11,123]},{index:.47,rgb:[255,29,97]},{index:.53,rgb:[255,54,69]},{index:.6,rgb:[255,85,46]},{index:.67,rgb:[255,120,34]},{index:.73,rgb:[255,157,37]},{index:.8,rgb:[241,191,57]},{index:.87,rgb:[224,220,93]},{index:.93,rgb:[218,241,142]},{index:1,rgb:[227,253,198]}]}},{}],137:[function(h,N,H){var t=h("./colorScale"),m=h("lerp");function g(f){return[f[0]/255,f[1]/255,f[2]/255,f[3]]}function p(f){for(var u,i="#",s=0;s<3;++s)i+=("00"+(u=(u=f[s]).toString(16))).substr(u.length);return i}function e(f){return"rgba("+f.join(",")+")"}N.exports=function(f){var u,i,s,o,a,c,r,n,d,l;if(f||(f={}),n=(f.nshades||72)-1,r=f.format||"hex",(c=f.colormap)||(c="jet"),typeof c=="string"){if(c=c.toLowerCase(),!t[c])throw Error(c+" not a supported colorscale");a=t[c]}else{if(!Array.isArray(c))throw Error("unsupported colormap option",c);a=c.slice()}if(a.length>n+1)throw new Error(c+" map requires nshades to be at least size "+a.length);d=Array.isArray(f.alpha)?f.alpha.length!==2?[1,1]:f.alpha.slice():typeof f.alpha=="number"?[f.alpha,f.alpha]:[1,1],u=a.map(function(T){return Math.round(T.index*n)}),d[0]=Math.min(Math.max(d[0],0),1),d[1]=Math.min(Math.max(d[1],0),1);var y=a.map(function(T,A){var S=a[A].index,w=a[A].rgb.slice();return w.length===4&&w[3]>=0&&w[3]<=1||(w[3]=d[0]+(d[1]-d[0])*S),w}),v=[];for(l=0;l<u.length-1;++l){o=u[l+1]-u[l],i=y[l],s=y[l+1];for(var _=0;_<o;_++){var x=_/o;v.push([Math.round(m(i[0],s[0],x)),Math.round(m(i[1],s[1],x)),Math.round(m(i[2],s[2],x)),m(i[3],s[3],x)])}}return v.push(a[a.length-1].rgb.concat(d[1])),r==="hex"?v=v.map(p):r==="rgbaString"?v=v.map(e):r==="float"&&(v=v.map(g)),v}},{"./colorScale":136,lerp:450}],138:[function(h,N,H){N.exports=function(u,i,s,o){var a=t(i,s,o);if(a===0){var c=m(t(u,i,s)),r=m(t(u,i,o));if(c===r){if(c===0){var n=f(u,i,s),d=f(u,i,o);return n===d?0:n?1:-1}return 0}return r===0?c>0||f(u,i,o)?-1:1:c===0?r>0||f(u,i,s)?1:-1:m(r-c)}var l=t(u,i,s);return l>0?a>0&&t(u,i,o)>0?1:-1:l<0?a>0||t(u,i,o)>0?1:-1:t(u,i,o)>0||f(u,i,s)?1:-1};var t=h("robust-orientation"),m=h("signum"),g=h("two-sum"),p=h("robust-product"),e=h("robust-sum");function f(u,i,s){var o=g(u[0],-i[0]),a=g(u[1],-i[1]),c=g(s[0],-i[0]),r=g(s[1],-i[1]),n=e(p(o,c),p(a,r));return n[n.length-1]>=0}},{"robust-orientation":534,"robust-product":535,"robust-sum":539,signum:541,"two-sum":589}],139:[function(h,N,H){N.exports=function(g,p){var e=g.length,f=g.length-p.length;if(f)return f;switch(e){case 0:return 0;case 1:return g[0]-p[0];case 2:return g[0]+g[1]-p[0]-p[1]||t(g[0],g[1])-t(p[0],p[1]);case 3:var u=g[0]+g[1],i=p[0]+p[1];if(f=u+g[2]-(i+p[2]))return f;var s=t(g[0],g[1]),o=t(p[0],p[1]);return t(s,g[2])-t(o,p[2])||t(s+g[2],u)-t(o+p[2],i);case 4:var a=g[0],c=g[1],r=g[2],n=g[3],d=p[0],l=p[1],y=p[2],v=p[3];return a+c+r+n-(d+l+y+v)||t(a,c,r,n)-t(d,l,y,v,d)||t(a+c,a+r,a+n,c+r,c+n,r+n)-t(d+l,d+y,d+v,l+y,l+v,y+v)||t(a+c+r,a+c+n,a+r+n,c+r+n)-t(d+l+y,d+l+v,d+y+v,l+y+v);default:for(var _=g.slice().sort(m),x=p.slice().sort(m),T=0;T<e;++T)if(f=_[T]-x[T])return f;return 0}};var t=Math.min;function m(g,p){return g-p}},{}],140:[function(h,N,H){var t=h("compare-cell"),m=h("cell-orientation");N.exports=function(g,p){return t(g,p)||m(g)-m(p)}},{"cell-orientation":123,"compare-cell":139}],141:[function(h,N,H){var t=h("./lib/ch1d"),m=h("./lib/ch2d"),g=h("./lib/chnd");N.exports=function(p){var e=p.length;if(e===0)return[];if(e===1)return[[0]];var f=p[0].length;return f===0?[]:f===1?t(p):f===2?m(p):g(p,f)}},{"./lib/ch1d":142,"./lib/ch2d":143,"./lib/chnd":144}],142:[function(h,N,H){N.exports=function(t){for(var m=0,g=0,p=1;p<t.length;++p)t[p][0]<t[m][0]&&(m=p),t[p][0]>t[g][0]&&(g=p);return m<g?[[m],[g]]:m>g?[[g],[m]]:[[m]]}},{}],143:[function(h,N,H){N.exports=function(m){var g=t(m),p=g.length;if(p<=2)return[];for(var e=new Array(p),f=g[p-1],u=0;u<p;++u){var i=g[u];e[u]=[f,i],f=i}return e};var t=h("monotone-convex-hull-2d")},{"monotone-convex-hull-2d":458}],144:[function(h,N,H){N.exports=function(g,p){try{return t(g,!0)}catch(u){var e=m(g);if(e.length<=p)return[];var f=function(i,s){for(var o=i.length,a=new Array(o),c=0;c<s.length;++c)a[c]=i[s[c]];var r=s.length;for(c=0;c<o;++c)s.indexOf(c)<0&&(a[r++]=i[c]);return a}(g,e);return function(i,s){for(var o=i.length,a=s.length,c=0;c<o;++c)for(var r=i[c],n=0;n<r.length;++n){var d=r[n];if(d<a)r[n]=s[d];else{d-=a;for(var l=0;l<a;++l)d>=s[l]&&(d+=1);r[n]=d}}return i}(t(f,!0),e)}};var t=h("incremental-convex-hull"),m=h("affine-hull")},{"affine-hull":73,"incremental-convex-hull":438}],145:[function(h,N,H){N.exports={AFG:"afghan",ALA:"\\b\\wland",ALB:"albania",DZA:"algeria",ASM:"^(?=.*americ).*samoa",AND:"andorra",AGO:"angola",AIA:"anguill?a",ATA:"antarctica",ATG:"antigua",ARG:"argentin",ARM:"armenia",ABW:"^(?!.*bonaire).*\\baruba",AUS:"australia",AUT:"^(?!.*hungary).*austria|\\baustri.*\\bemp",AZE:"azerbaijan",BHS:"bahamas",BHR:"bahrain",BGD:"bangladesh|^(?=.*east).*paki?stan",BRB:"barbados",BLR:"belarus|byelo",BEL:"^(?!.*luxem).*belgium",BLZ:"belize|^(?=.*british).*honduras",BEN:"benin|dahome",BMU:"bermuda",BTN:"bhutan",BOL:"bolivia",BES:"^(?=.*bonaire).*eustatius|^(?=.*carib).*netherlands|\\bbes.?islands",BIH:"herzegovina|bosnia",BWA:"botswana|bechuana",BVT:"bouvet",BRA:"brazil",IOT:"british.?indian.?ocean",BRN:"brunei",BGR:"bulgaria",BFA:"burkina|\\bfaso|upper.?volta",BDI:"burundi",CPV:"verde",KHM:"cambodia|kampuchea|khmer",CMR:"cameroon",CAN:"canada",CYM:"cayman",CAF:"\\bcentral.african.republic",TCD:"\\bchad",CHL:"\\bchile",CHN:"^(?!.*\\bmac)(?!.*\\bhong)(?!.*\\btai)(?!.*\\brep).*china|^(?=.*peo)(?=.*rep).*china",CXR:"christmas",CCK:"\\bcocos|keeling",COL:"colombia",COM:"comoro",COG:"^(?!.*\\bdem)(?!.*\\bd[\\.]?r)(?!.*kinshasa)(?!.*zaire)(?!.*belg)(?!.*l.opoldville)(?!.*free).*\\bcongo",COK:"\\bcook",CRI:"costa.?rica",CIV:"ivoire|ivory",HRV:"croatia",CUB:"\\bcuba",CUW:"^(?!.*bonaire).*\\bcura(c|\xE7)ao",CYP:"cyprus",CSK:"czechoslovakia",CZE:"^(?=.*rep).*czech|czechia|bohemia",COD:"\\bdem.*congo|congo.*\\bdem|congo.*\\bd[\\.]?r|\\bd[\\.]?r.*congo|belgian.?congo|congo.?free.?state|kinshasa|zaire|l.opoldville|drc|droc|rdc",DNK:"denmark",DJI:"djibouti",DMA:"dominica(?!n)",DOM:"dominican.rep",ECU:"ecuador",EGY:"egypt",SLV:"el.?salvador",GNQ:"guine.*eq|eq.*guine|^(?=.*span).*guinea",ERI:"eritrea",EST:"estonia",ETH:"ethiopia|abyssinia",FLK:"falkland|malvinas",FRO:"faroe|faeroe",FJI:"fiji",FIN:"finland",FRA:"^(?!.*\\bdep)(?!.*martinique).*france|french.?republic|\\bgaul",GUF:"^(?=.*french).*guiana",PYF:"french.?polynesia|tahiti",ATF:"french.?southern",GAB:"gabon",GMB:"gambia",GEO:"^(?!.*south).*georgia",DDR:"german.?democratic.?republic|democratic.?republic.*germany|east.germany",DEU:"^(?!.*east).*germany|^(?=.*\\bfed.*\\brep).*german",GHA:"ghana|gold.?coast",GIB:"gibraltar",GRC:"greece|hellenic|hellas",GRL:"greenland",GRD:"grenada",GLP:"guadeloupe",GUM:"\\bguam",GTM:"guatemala",GGY:"guernsey",GIN:"^(?!.*eq)(?!.*span)(?!.*bissau)(?!.*portu)(?!.*new).*guinea",GNB:"bissau|^(?=.*portu).*guinea",GUY:"guyana|british.?guiana",HTI:"haiti",HMD:"heard.*mcdonald",VAT:"holy.?see|vatican|papal.?st",HND:"^(?!.*brit).*honduras",HKG:"hong.?kong",HUN:"^(?!.*austr).*hungary",ISL:"iceland",IND:"india(?!.*ocea)",IDN:"indonesia",IRN:"\\biran|persia",IRQ:"\\biraq|mesopotamia",IRL:"(^ireland)|(^republic.*ireland)",IMN:"^(?=.*isle).*\\bman",ISR:"israel",ITA:"italy",JAM:"jamaica",JPN:"japan",JEY:"jersey",JOR:"jordan",KAZ:"kazak",KEN:"kenya|british.?east.?africa|east.?africa.?prot",KIR:"kiribati",PRK:"^(?=.*democrat|people|north|d.*p.*.r).*\\bkorea|dprk|korea.*(d.*p.*r)",KWT:"kuwait",KGZ:"kyrgyz|kirghiz",LAO:"\\blaos?\\b",LVA:"latvia",LBN:"lebanon",LSO:"lesotho|basuto",LBR:"liberia",LBY:"libya",LIE:"liechtenstein",LTU:"lithuania",LUX:"^(?!.*belg).*luxem",MAC:"maca(o|u)",MDG:"madagascar|malagasy",MWI:"malawi|nyasa",MYS:"malaysia",MDV:"maldive",MLI:"\\bmali\\b",MLT:"\\bmalta",MHL:"marshall",MTQ:"martinique",MRT:"mauritania",MUS:"mauritius",MYT:"\\bmayotte",MEX:"\\bmexic",FSM:"fed.*micronesia|micronesia.*fed",MCO:"monaco",MNG:"mongolia",MNE:"^(?!.*serbia).*montenegro",MSR:"montserrat",MAR:"morocco|\\bmaroc",MOZ:"mozambique",MMR:"myanmar|burma",NAM:"namibia",NRU:"nauru",NPL:"nepal",NLD:"^(?!.*\\bant)(?!.*\\bcarib).*netherlands",ANT:"^(?=.*\\bant).*(nether|dutch)",NCL:"new.?caledonia",NZL:"new.?zealand",NIC:"nicaragua",NER:"\\bniger(?!ia)",NGA:"nigeria",NIU:"niue",NFK:"norfolk",MNP:"mariana",NOR:"norway",OMN:"\\boman|trucial",PAK:"^(?!.*east).*paki?stan",PLW:"palau",PSE:"palestin|\\bgaza|west.?bank",PAN:"panama",PNG:"papua|new.?guinea",PRY:"paraguay",PER:"peru",PHL:"philippines",PCN:"pitcairn",POL:"poland",PRT:"portugal",PRI:"puerto.?rico",QAT:"qatar",KOR:"^(?!.*d.*p.*r)(?!.*democrat)(?!.*people)(?!.*north).*\\bkorea(?!.*d.*p.*r)",MDA:"moldov|b(a|e)ssarabia",REU:"r(e|\xE9)union",ROU:"r(o|u|ou)mania",RUS:"\\brussia|soviet.?union|u\\.?s\\.?s\\.?r|socialist.?republics",RWA:"rwanda",BLM:"barth(e|\xE9)lemy",SHN:"helena",KNA:"kitts|\\bnevis",LCA:"\\blucia",MAF:"^(?=.*collectivity).*martin|^(?=.*france).*martin(?!ique)|^(?=.*french).*martin(?!ique)",SPM:"miquelon",VCT:"vincent",WSM:"^(?!.*amer).*samoa",SMR:"san.?marino",STP:"\\bs(a|\xE3)o.?tom(e|\xE9)",SAU:"\\bsa\\w*.?arabia",SEN:"senegal",SRB:"^(?!.*monte).*serbia",SYC:"seychell",SLE:"sierra",SGP:"singapore",SXM:"^(?!.*martin)(?!.*saba).*maarten",SVK:"^(?!.*cze).*slovak",SVN:"slovenia",SLB:"solomon",SOM:"somali",ZAF:"south.africa|s\\\\..?africa",SGS:"south.?georgia|sandwich",SSD:"\\bs\\w*.?sudan",ESP:"spain",LKA:"sri.?lanka|ceylon",SDN:"^(?!.*\\bs(?!u)).*sudan",SUR:"surinam|dutch.?guiana",SJM:"svalbard",SWZ:"swaziland",SWE:"sweden",CHE:"switz|swiss",SYR:"syria",TWN:"taiwan|taipei|formosa|^(?!.*peo)(?=.*rep).*china",TJK:"tajik",THA:"thailand|\\bsiam",MKD:"macedonia|fyrom",TLS:"^(?=.*leste).*timor|^(?=.*east).*timor",TGO:"togo",TKL:"tokelau",TON:"tonga",TTO:"trinidad|tobago",TUN:"tunisia",TUR:"turkey",TKM:"turkmen",TCA:"turks",TUV:"tuvalu",UGA:"uganda",UKR:"ukrain",ARE:"emirates|^u\\.?a\\.?e\\.?$|united.?arab.?em",GBR:"united.?kingdom|britain|^u\\.?k\\.?$",TZA:"tanzania",USA:"united.?states\\b(?!.*islands)|\\bu\\.?s\\.?a\\.?\\b|^\\s*u\\.?s\\.?\\b(?!.*islands)",UMI:"minor.?outlying.?is",URY:"uruguay",UZB:"uzbek",VUT:"vanuatu|new.?hebrides",VEN:"venezuela",VNM:"^(?!.*republic).*viet.?nam|^(?=.*socialist).*viet.?nam",VGB:"^(?=.*\\bu\\.?\\s?k).*virgin|^(?=.*brit).*virgin|^(?=.*kingdom).*virgin",VIR:"^(?=.*\\bu\\.?\\s?s).*virgin|^(?=.*states).*virgin",WLF:"futuna|wallis",ESH:"western.sahara",YEM:"^(?!.*arab)(?!.*north)(?!.*sana)(?!.*peo)(?!.*dem)(?!.*south)(?!.*aden)(?!.*\\bp\\.?d\\.?r).*yemen",YMD:"^(?=.*peo).*yemen|^(?!.*rep)(?=.*dem).*yemen|^(?=.*south).*yemen|^(?=.*aden).*yemen|^(?=.*\\bp\\.?d\\.?r).*yemen",YUG:"yugoslavia",ZMB:"zambia|northern.?rhodesia",EAZ:"zanzibar",ZWE:"zimbabwe|^(?!.*northern).*rhodesia"}},{}],146:[function(h,N,H){N.exports=["xx-small","x-small","small","medium","large","x-large","xx-large","larger","smaller"]},{}],147:[function(h,N,H){N.exports=["normal","condensed","semi-condensed","extra-condensed","ultra-condensed","expanded","semi-expanded","extra-expanded","ultra-expanded"]},{}],148:[function(h,N,H){N.exports=["normal","italic","oblique"]},{}],149:[function(h,N,H){N.exports=["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900"]},{}],150:[function(h,N,H){N.exports={parse:h("./parse"),stringify:h("./stringify")}},{"./parse":152,"./stringify":153}],151:[function(h,N,H){var t=h("css-font-size-keywords");N.exports={isSize:function(m){return/^[\d\.]/.test(m)||m.indexOf("/")!==-1||t.indexOf(m)!==-1}}},{"css-font-size-keywords":146}],152:[function(h,N,H){var t=h("unquote"),m=h("css-global-keywords"),g=h("css-system-font-keywords"),p=h("css-font-weight-keywords"),e=h("css-font-style-keywords"),f=h("css-font-stretch-keywords"),u=h("string-split-by"),i=h("./lib/util").isSize;N.exports=o;var s=o.cache={};function o(c){if(typeof c!="string")throw new Error("Font argument must be a string.");if(s[c])return s[c];if(c==="")throw new Error("Cannot parse an empty string.");if(g.indexOf(c)!==-1)return s[c]={system:c};for(var r,n={style:"normal",variant:"normal",weight:"normal",stretch:"normal",lineHeight:"normal",size:"1rem",family:["serif"]},d=u(c,/\s+/);r=d.shift();){if(m.indexOf(r)!==-1)return["style","variant","weight","stretch"].forEach(function(y){n[y]=r}),s[c]=n;if(e.indexOf(r)===-1)if(r!=="normal"&&r!=="small-caps")if(f.indexOf(r)===-1){if(p.indexOf(r)===-1){if(i(r)){var l=u(r,"/");if(n.size=l[0],l[1]!=null?n.lineHeight=a(l[1]):d[0]==="/"&&(d.shift(),n.lineHeight=a(d.shift())),!d.length)throw new Error("Missing required font-family.");return n.family=u(d.join(" "),/\s*,\s*/).map(t),s[c]=n}throw new Error("Unknown or unsupported font token: "+r)}n.weight=r}else n.stretch=r;else n.variant=r;else n.style=r}throw new Error("Missing required font-size.")}function a(c){var r=parseFloat(c);return r.toString()===c?r:c}},{"./lib/util":151,"css-font-stretch-keywords":147,"css-font-style-keywords":148,"css-font-weight-keywords":149,"css-global-keywords":154,"css-system-font-keywords":155,"string-split-by":574,unquote:604}],153:[function(h,N,H){var t=h("pick-by-alias"),m=h("./lib/util").isSize,g=r(h("css-global-keywords")),p=r(h("css-system-font-keywords")),e=r(h("css-font-weight-keywords")),f=r(h("css-font-style-keywords")),u=r(h("css-font-stretch-keywords")),i={normal:1,"small-caps":1},s={serif:1,"sans-serif":1,monospace:1,cursive:1,fantasy:1,"system-ui":1},o="1rem",a="serif";function c(n,d){if(n&&!d[n]&&!g[n])throw Error("Unknown keyword `"+n+"`");return n}function r(n){for(var d={},l=0;l<n.length;l++)d[n[l]]=1;return d}N.exports=function(n){if((n=t(n,{style:"style fontstyle fontStyle font-style slope distinction",variant:"variant font-variant fontVariant fontvariant var capitalization",weight:"weight w font-weight fontWeight fontweight",stretch:"stretch font-stretch fontStretch fontstretch width",size:"size s font-size fontSize fontsize height em emSize",lineHeight:"lh line-height lineHeight lineheight leading",family:"font family fontFamily font-family fontfamily type typeface face",system:"system reserved default global"})).system)return n.system&&c(n.system,p),n.system;if(c(n.style,f),c(n.variant,i),c(n.weight,e),c(n.stretch,u),n.size==null&&(n.size=o),typeof n.size=="number"&&(n.size+="px"),!m)throw Error("Bad size value `"+n.size+"`");n.family||(n.family=a),Array.isArray(n.family)&&(n.family.length||(n.family=[a]),n.family=n.family.map(function(l){return s[l]?l:'"'+l+'"'}).join(", "));var d=[];return d.push(n.style),n.variant!==n.style&&d.push(n.variant),n.weight!==n.variant&&n.weight!==n.style&&d.push(n.weight),n.stretch!==n.weight&&n.stretch!==n.variant&&n.stretch!==n.style&&d.push(n.stretch),d.push(n.size+(n.lineHeight==null||n.lineHeight==="normal"||n.lineHeight+""=="1"?"":"/"+n.lineHeight)),d.push(n.family),d.filter(Boolean).join(" ")}},{"./lib/util":151,"css-font-stretch-keywords":147,"css-font-style-keywords":148,"css-font-weight-keywords":149,"css-global-keywords":154,"css-system-font-keywords":155,"pick-by-alias":485}],154:[function(h,N,H){N.exports=["inherit","initial","unset"]},{}],155:[function(h,N,H){N.exports=["caption","icon","menu","message-box","small-caption","status-bar"]},{}],156:[function(h,N,H){N.exports=function(t,m,g,p,e,f){var u=e-1,i=e*e,s=u*u,o=(1+2*e)*s,a=e*s,c=i*(3-2*e),r=i*u;if(t.length){f||(f=new Array(t.length));for(var n=t.length-1;n>=0;--n)f[n]=o*t[n]+a*m[n]+c*g[n]+r*p[n];return f}return o*t+a*m+c*g+r*p},N.exports.derivative=function(t,m,g,p,e,f){var u=6*e*e-6*e,i=3*e*e-4*e+1,s=-6*e*e+6*e,o=3*e*e-2*e;if(t.length){f||(f=new Array(t.length));for(var a=t.length-1;a>=0;--a)f[a]=u*t[a]+i*m[a]+s*g[a]+o*p[a];return f}return u*t+i*m+s*g[a]+o*p}},{}],157:[function(h,N,H){var t,m=h("type/value/is"),g=h("type/value/ensure"),p=h("type/plain-function/ensure"),e=h("es5-ext/object/copy"),f=h("es5-ext/object/normalize-options"),u=h("es5-ext/object/map"),i=Function.prototype.bind,s=Object.defineProperty,o=Object.prototype.hasOwnProperty;t=function(a,c,r){var n,d=g(c)&&p(c.value);return delete(n=e(c)).writable,delete n.value,n.get=function(){return!r.overwriteDefinition&&o.call(this,a)?d:(c.value=i.call(d,r.resolveContext?r.resolveContext(this):this),s(this,a,c),this[a])},n},N.exports=function(a){var c=f(arguments[1]);return m(c.resolveContext)&&p(c.resolveContext),u(a,function(r,n){return t(n,r,c)})}},{"es5-ext/object/copy":202,"es5-ext/object/map":210,"es5-ext/object/normalize-options":211,"type/plain-function/ensure":595,"type/value/ensure":599,"type/value/is":600}],158:[function(h,N,H){var t=h("type/value/is"),m=h("type/plain-function/is"),g=h("es5-ext/object/assign"),p=h("es5-ext/object/normalize-options"),e=h("es5-ext/string/#/contains");(N.exports=function(f,u){var i,s,o,a,c;return arguments.length<2||typeof f!="string"?(a=u,u=f,f=null):a=arguments[2],t(f)?(i=e.call(f,"c"),s=e.call(f,"e"),o=e.call(f,"w")):(i=o=!0,s=!1),c={value:u,configurable:i,enumerable:s,writable:o},a?g(p(a),c):c}).gs=function(f,u,i){var s,o,a,c;return typeof f!="string"?(a=i,i=u,u=f,f=null):a=arguments[3],t(u)?m(u)?t(i)?m(i)||(a=i,i=void 0):i=void 0:(a=u,u=i=void 0):u=void 0,t(f)?(s=e.call(f,"c"),o=e.call(f,"e")):(s=!0,o=!1),c={get:u,set:i,configurable:s,enumerable:o},a?g(p(a),c):c}},{"es5-ext/object/assign":199,"es5-ext/object/normalize-options":211,"es5-ext/string/#/contains":218,"type/plain-function/is":596,"type/value/is":600}],159:[function(h,N,H){(function(t,m){m(typeof H=="object"&&N!==void 0?H:t.d3=t.d3||{})})(this,function(t){function m(M,P){return M<P?-1:M>P?1:M>=P?0:NaN}function g(M){var P;return M.length===1&&(P=M,M=function(O,F){return m(P(O),F)}),{left:function(O,F,j,W){for(j==null&&(j=0),W==null&&(W=O.length);j<W;){var Z=j+W>>>1;M(O[Z],F)<0?j=Z+1:W=Z}return j},right:function(O,F,j,W){for(j==null&&(j=0),W==null&&(W=O.length);j<W;){var Z=j+W>>>1;M(O[Z],F)>0?W=Z:j=Z+1}return j}}}var p=g(m),e=p.right,f=p.left;function u(M,P){return[M,P]}function i(M){return M===null?NaN:+M}function s(M,P){var O,F,j=M.length,W=0,Z=-1,Q=0,X=0;if(P==null)for(;++Z<j;)isNaN(O=i(M[Z]))||(X+=(F=O-Q)*(O-(Q+=F/++W)));else for(;++Z<j;)isNaN(O=i(P(M[Z],Z,M)))||(X+=(F=O-Q)*(O-(Q+=F/++W)));if(W>1)return X/(W-1)}function o(M,P){var O=s(M,P);return O&&Math.sqrt(O)}function a(M,P){var O,F,j,W=M.length,Z=-1;if(P==null){for(;++Z<W;)if((O=M[Z])!=null&&O>=O)for(F=j=O;++Z<W;)(O=M[Z])!=null&&(F>O&&(F=O),j<O&&(j=O))}else for(;++Z<W;)if((O=P(M[Z],Z,M))!=null&&O>=O)for(F=j=O;++Z<W;)(O=P(M[Z],Z,M))!=null&&(F>O&&(F=O),j<O&&(j=O));return[F,j]}var c=Array.prototype,r=c.slice,n=c.map;function d(M){return function(){return M}}function l(M){return M}function y(M,P,O){M=+M,P=+P,O=(j=arguments.length)<2?(P=M,M=0,1):j<3?1:+O;for(var F=-1,j=0|Math.max(0,Math.ceil((P-M)/O)),W=new Array(j);++F<j;)W[F]=M+F*O;return W}var v=Math.sqrt(50),_=Math.sqrt(10),x=Math.sqrt(2);function T(M,P,O){var F=(P-M)/Math.max(0,O),j=Math.floor(Math.log(F)/Math.LN10),W=F/Math.pow(10,j);return j>=0?(W>=v?10:W>=_?5:W>=x?2:1)*Math.pow(10,j):-Math.pow(10,-j)/(W>=v?10:W>=_?5:W>=x?2:1)}function A(M,P,O){var F=Math.abs(P-M)/Math.max(0,O),j=Math.pow(10,Math.floor(Math.log(F)/Math.LN10)),W=F/j;return W>=v?j*=10:W>=_?j*=5:W>=x&&(j*=2),P<M?-j:j}function S(M){return Math.ceil(Math.log(M.length)/Math.LN2)+1}function w(M,P,O){if(O==null&&(O=i),F=M.length){if((P=+P)<=0||F<2)return+O(M[0],0,M);if(P>=1)return+O(M[F-1],F-1,M);var F,j=(F-1)*P,W=Math.floor(j),Z=+O(M[W],W,M);return Z+(+O(M[W+1],W+1,M)-Z)*(j-W)}}function L(M,P){var O,F,j=M.length,W=-1;if(P==null){for(;++W<j;)if((O=M[W])!=null&&O>=O)for(F=O;++W<j;)(O=M[W])!=null&&F>O&&(F=O)}else for(;++W<j;)if((O=P(M[W],W,M))!=null&&O>=O)for(F=O;++W<j;)(O=P(M[W],W,M))!=null&&F>O&&(F=O);return F}function k(M){if(!(j=M.length))return[];for(var P=-1,O=L(M,C),F=new Array(O);++P<O;)for(var j,W=-1,Z=F[P]=new Array(j);++W<j;)Z[W]=M[W][P];return F}function C(M){return M.length}t.bisect=e,t.bisectRight=e,t.bisectLeft=f,t.ascending=m,t.bisector=g,t.cross=function(M,P,O){var F,j,W,Z,Q=M.length,X=P.length,G=new Array(Q*X);for(O==null&&(O=u),F=W=0;F<Q;++F)for(Z=M[F],j=0;j<X;++j,++W)G[W]=O(Z,P[j]);return G},t.descending=function(M,P){return P<M?-1:P>M?1:P>=M?0:NaN},t.deviation=o,t.extent=a,t.histogram=function(){var M=l,P=a,O=S;function F(j){var W,Z,Q=j.length,X=new Array(Q);for(W=0;W<Q;++W)X[W]=M(j[W],W,j);var G=P(X),Y=G[0],K=G[1],D=O(X,Y,K);Array.isArray(D)||(D=A(Y,K,D),D=y(Math.ceil(Y/D)*D,K,D));for(var B=D.length;D[0]<=Y;)D.shift(),--B;for(;D[B-1]>K;)D.pop(),--B;var q,ee=new Array(B+1);for(W=0;W<=B;++W)(q=ee[W]=[]).x0=W>0?D[W-1]:Y,q.x1=W<B?D[W]:K;for(W=0;W<Q;++W)Y<=(Z=X[W])&&Z<=K&&ee[e(D,Z,0,B)].push(j[W]);return ee}return F.value=function(j){return arguments.length?(M=typeof j=="function"?j:d(j),F):M},F.domain=function(j){return arguments.length?(P=typeof j=="function"?j:d([j[0],j[1]]),F):P},F.thresholds=function(j){return arguments.length?(O=typeof j=="function"?j:Array.isArray(j)?d(r.call(j)):d(j),F):O},F},t.thresholdFreedmanDiaconis=function(M,P,O){return M=n.call(M,i).sort(m),Math.ceil((O-P)/(2*(w(M,.75)-w(M,.25))*Math.pow(M.length,-1/3)))},t.thresholdScott=function(M,P,O){return Math.ceil((O-P)/(3.5*o(M)*Math.pow(M.length,-1/3)))},t.thresholdSturges=S,t.max=function(M,P){var O,F,j=M.length,W=-1;if(P==null){for(;++W<j;)if((O=M[W])!=null&&O>=O)for(F=O;++W<j;)(O=M[W])!=null&&O>F&&(F=O)}else for(;++W<j;)if((O=P(M[W],W,M))!=null&&O>=O)for(F=O;++W<j;)(O=P(M[W],W,M))!=null&&O>F&&(F=O);return F},t.mean=function(M,P){var O,F=M.length,j=F,W=-1,Z=0;if(P==null)for(;++W<F;)isNaN(O=i(M[W]))?--j:Z+=O;else for(;++W<F;)isNaN(O=i(P(M[W],W,M)))?--j:Z+=O;if(j)return Z/j},t.median=function(M,P){var O,F=M.length,j=-1,W=[];if(P==null)for(;++j<F;)isNaN(O=i(M[j]))||W.push(O);else for(;++j<F;)isNaN(O=i(P(M[j],j,M)))||W.push(O);return w(W.sort(m),.5)},t.merge=function(M){for(var P,O,F,j=M.length,W=-1,Z=0;++W<j;)Z+=M[W].length;for(O=new Array(Z);--j>=0;)for(P=(F=M[j]).length;--P>=0;)O[--Z]=F[P];return O},t.min=L,t.pairs=function(M,P){P==null&&(P=u);for(var O=0,F=M.length-1,j=M[0],W=new Array(F<0?0:F);O<F;)W[O]=P(j,j=M[++O]);return W},t.permute=function(M,P){for(var O=P.length,F=new Array(O);O--;)F[O]=M[P[O]];return F},t.quantile=w,t.range=y,t.scan=function(M,P){if(O=M.length){var O,F,j=0,W=0,Z=M[W];for(P==null&&(P=m);++j<O;)(P(F=M[j],Z)<0||P(Z,Z)!==0)&&(Z=F,W=j);return P(Z,Z)===0?W:void 0}},t.shuffle=function(M,P,O){for(var F,j,W=(O==null?M.length:O)-(P=P==null?0:+P);W;)j=Math.random()*W--|0,F=M[W+P],M[W+P]=M[j+P],M[j+P]=F;return M},t.sum=function(M,P){var O,F=M.length,j=-1,W=0;if(P==null)for(;++j<F;)(O=+M[j])&&(W+=O);else for(;++j<F;)(O=+P(M[j],j,M))&&(W+=O);return W},t.ticks=function(M,P,O){var F,j,W,Z,Q=-1;if(O=+O,(M=+M)==(P=+P)&&O>0)return[M];if((F=P<M)&&(j=M,M=P,P=j),(Z=T(M,P,O))===0||!isFinite(Z))return[];if(Z>0)for(M=Math.ceil(M/Z),P=Math.floor(P/Z),W=new Array(j=Math.ceil(P-M+1));++Q<j;)W[Q]=(M+Q)*Z;else for(M=Math.floor(M*Z),P=Math.ceil(P*Z),W=new Array(j=Math.ceil(M-P+1));++Q<j;)W[Q]=(M-Q)/Z;return F&&W.reverse(),W},t.tickIncrement=T,t.tickStep=A,t.transpose=k,t.variance=s,t.zip=function(){return k(arguments)},Object.defineProperty(t,"__esModule",{value:!0})})},{}],160:[function(h,N,H){(function(t,m){m(typeof H=="object"&&N!==void 0?H:t.d3=t.d3||{})})(this,function(t){function m(){}function g(a,c){var r=new m;if(a instanceof m)a.each(function(v,_){r.set(_,v)});else if(Array.isArray(a)){var n,d=-1,l=a.length;if(c==null)for(;++d<l;)r.set(d,a[d]);else for(;++d<l;)r.set(c(n=a[d],d,a),n)}else if(a)for(var y in a)r.set(y,a[y]);return r}function p(){return{}}function e(a,c,r){a[c]=r}function f(){return g()}function u(a,c,r){a.set(c,r)}function i(){}m.prototype=g.prototype={constructor:m,has:function(a){return"$"+a in this},get:function(a){return this["$"+a]},set:function(a,c){return this["$"+a]=c,this},remove:function(a){var c="$"+a;return c in this&&delete this[c]},clear:function(){for(var a in this)a[0]==="$"&&delete this[a]},keys:function(){var a=[];for(var c in this)c[0]==="$"&&a.push(c.slice(1));return a},values:function(){var a=[];for(var c in this)c[0]==="$"&&a.push(this[c]);return a},entries:function(){var a=[];for(var c in this)c[0]==="$"&&a.push({key:c.slice(1),value:this[c]});return a},size:function(){var a=0;for(var c in this)c[0]==="$"&&++a;return a},empty:function(){for(var a in this)if(a[0]==="$")return!1;return!0},each:function(a){for(var c in this)c[0]==="$"&&a(this[c],c.slice(1),this)}};var s=g.prototype;function o(a,c){var r=new i;if(a instanceof i)a.each(function(l){r.add(l)});else if(a){var n=-1,d=a.length;if(c==null)for(;++n<d;)r.add(a[n]);else for(;++n<d;)r.add(c(a[n],n,a))}return r}i.prototype=o.prototype={constructor:i,has:s.has,add:function(a){return this["$"+(a+="")]=a,this},remove:s.remove,clear:s.clear,values:s.keys,size:s.size,empty:s.empty,each:s.each},t.nest=function(){var a,c,r,n=[],d=[];function l(y,v,_,x){if(v>=n.length)return a!=null&&y.sort(a),c!=null?c(y):y;for(var T,A,S,w=-1,L=y.length,k=n[v++],C=g(),M=_();++w<L;)(S=C.get(T=k(A=y[w])+""))?S.push(A):C.set(T,[A]);return C.each(function(P,O){x(M,O,l(P,v,_,x))}),M}return r={object:function(y){return l(y,0,p,e)},map:function(y){return l(y,0,f,u)},entries:function(y){return function v(_,x){if(++x>n.length)return _;var T,A=d[x-1];return c!=null&&x>=n.length?T=_.entries():(T=[],_.each(function(S,w){T.push({key:w,values:v(S,x)})})),A!=null?T.sort(function(S,w){return A(S.key,w.key)}):T}(l(y,0,f,u),0)},key:function(y){return n.push(y),r},sortKeys:function(y){return d[n.length-1]=y,r},sortValues:function(y){return a=y,r},rollup:function(y){return c=y,r}}},t.set=o,t.map=g,t.keys=function(a){var c=[];for(var r in a)c.push(r);return c},t.values=function(a){var c=[];for(var r in a)c.push(a[r]);return c},t.entries=function(a){var c=[];for(var r in a)c.push({key:r,value:a[r]});return c},Object.defineProperty(t,"__esModule",{value:!0})})},{}],161:[function(h,N,H){(function(t,m){m(typeof H=="object"&&N!==void 0?H:(t=t||self).d3=t.d3||{})})(this,function(t){function m(ue,me,we){ue.prototype=me.prototype=we,we.constructor=ue}function g(ue,me){var we=Object.create(ue.prototype);for(var Me in me)we[Me]=me[Me];return we}function p(){}var e="\\s*([+-]?\\d+)\\s*",f="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",u="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",i=/^#([0-9a-f]{3,8})$/,s=new RegExp("^rgb\\("+[e,e,e]+"\\)$"),o=new RegExp("^rgb\\("+[u,u,u]+"\\)$"),a=new RegExp("^rgba\\("+[e,e,e,f]+"\\)$"),c=new RegExp("^rgba\\("+[u,u,u,f]+"\\)$"),r=new RegExp("^hsl\\("+[f,u,u]+"\\)$"),n=new RegExp("^hsla\\("+[f,u,u,f]+"\\)$"),d={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function l(){return this.rgb().formatHex()}function y(){return this.rgb().formatRgb()}function v(ue){var me,we;return ue=(ue+"").trim().toLowerCase(),(me=i.exec(ue))?(we=me[1].length,me=parseInt(me[1],16),we===6?_(me):we===3?new S(me>>8&15|me>>4&240,me>>4&15|240&me,(15&me)<<4|15&me,1):we===8?x(me>>24&255,me>>16&255,me>>8&255,(255&me)/255):we===4?x(me>>12&15|me>>8&240,me>>8&15|me>>4&240,me>>4&15|240&me,((15&me)<<4|15&me)/255):null):(me=s.exec(ue))?new S(me[1],me[2],me[3],1):(me=o.exec(ue))?new S(255*me[1]/100,255*me[2]/100,255*me[3]/100,1):(me=a.exec(ue))?x(me[1],me[2],me[3],me[4]):(me=c.exec(ue))?x(255*me[1]/100,255*me[2]/100,255*me[3]/100,me[4]):(me=r.exec(ue))?C(me[1],me[2]/100,me[3]/100,1):(me=n.exec(ue))?C(me[1],me[2]/100,me[3]/100,me[4]):d.hasOwnProperty(ue)?_(d[ue]):ue==="transparent"?new S(NaN,NaN,NaN,0):null}function _(ue){return new S(ue>>16&255,ue>>8&255,255&ue,1)}function x(ue,me,we,Me){return Me<=0&&(ue=me=we=NaN),new S(ue,me,we,Me)}function T(ue){return ue instanceof p||(ue=v(ue)),ue?new S((ue=ue.rgb()).r,ue.g,ue.b,ue.opacity):new S}function A(ue,me,we,Me){return arguments.length===1?T(ue):new S(ue,me,we,Me==null?1:Me)}function S(ue,me,we,Me){this.r=+ue,this.g=+me,this.b=+we,this.opacity=+Me}function w(){return"#"+k(this.r)+k(this.g)+k(this.b)}function L(){var ue=this.opacity;return((ue=isNaN(ue)?1:Math.max(0,Math.min(1,ue)))===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(ue===1?")":", "+ue+")")}function k(ue){return((ue=Math.max(0,Math.min(255,Math.round(ue)||0)))<16?"0":"")+ue.toString(16)}function C(ue,me,we,Me){return Me<=0?ue=me=we=NaN:we<=0||we>=1?ue=me=NaN:me<=0&&(ue=NaN),new O(ue,me,we,Me)}function M(ue){if(ue instanceof O)return new O(ue.h,ue.s,ue.l,ue.opacity);if(ue instanceof p||(ue=v(ue)),!ue)return new O;if(ue instanceof O)return ue;var me=(ue=ue.rgb()).r/255,we=ue.g/255,Me=ue.b/255,Se=Math.min(me,we,Me),De=Math.max(me,we,Me),Fe=NaN,Ye=De-Se,et=(De+Se)/2;return Ye?(Fe=me===De?(we-Me)/Ye+6*(we<Me):we===De?(Me-me)/Ye+2:(me-we)/Ye+4,Ye/=et<.5?De+Se:2-De-Se,Fe*=60):Ye=et>0&&et<1?0:Fe,new O(Fe,Ye,et,ue.opacity)}function P(ue,me,we,Me){return arguments.length===1?M(ue):new O(ue,me,we,Me==null?1:Me)}function O(ue,me,we,Me){this.h=+ue,this.s=+me,this.l=+we,this.opacity=+Me}function F(ue,me,we){return 255*(ue<60?me+(we-me)*ue/60:ue<180?we:ue<240?me+(we-me)*(240-ue)/60:me)}m(p,v,{copy:function(ue){return Object.assign(new this.constructor,this,ue)},displayable:function(){return this.rgb().displayable()},hex:l,formatHex:l,formatHsl:function(){return M(this).formatHsl()},formatRgb:y,toString:y}),m(S,A,g(p,{brighter:function(ue){return ue=ue==null?1/.7:Math.pow(1/.7,ue),new S(this.r*ue,this.g*ue,this.b*ue,this.opacity)},darker:function(ue){return ue=ue==null?.7:Math.pow(.7,ue),new S(this.r*ue,this.g*ue,this.b*ue,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:w,formatHex:w,formatRgb:L,toString:L})),m(O,P,g(p,{brighter:function(ue){return ue=ue==null?1/.7:Math.pow(1/.7,ue),new O(this.h,this.s,this.l*ue,this.opacity)},darker:function(ue){return ue=ue==null?.7:Math.pow(.7,ue),new O(this.h,this.s,this.l*ue,this.opacity)},rgb:function(){var ue=this.h%360+360*(this.h<0),me=isNaN(ue)||isNaN(this.s)?0:this.s,we=this.l,Me=we+(we<.5?we:1-we)*me,Se=2*we-Me;return new S(F(ue>=240?ue-240:ue+120,Se,Me),F(ue,Se,Me),F(ue<120?ue+240:ue-120,Se,Me),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var ue=this.opacity;return((ue=isNaN(ue)?1:Math.max(0,Math.min(1,ue)))===1?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(ue===1?")":", "+ue+")")}}));var j=Math.PI/180,W=180/Math.PI,Z=6/29,Q=3*Z*Z;function X(ue){if(ue instanceof Y)return new Y(ue.l,ue.a,ue.b,ue.opacity);if(ue instanceof $)return te(ue);ue instanceof S||(ue=T(ue));var me,we,Me=q(ue.r),Se=q(ue.g),De=q(ue.b),Fe=K((.2225045*Me+.7168786*Se+.0606169*De)/1);return Me===Se&&Se===De?me=we=Fe:(me=K((.4360747*Me+.3850649*Se+.1430804*De)/.96422),we=K((.0139322*Me+.0971045*Se+.7141733*De)/.82521)),new Y(116*Fe-16,500*(me-Fe),200*(Fe-we),ue.opacity)}function G(ue,me,we,Me){return arguments.length===1?X(ue):new Y(ue,me,we,Me==null?1:Me)}function Y(ue,me,we,Me){this.l=+ue,this.a=+me,this.b=+we,this.opacity=+Me}function K(ue){return ue>.008856451679035631?Math.pow(ue,1/3):ue/Q+4/29}function D(ue){return ue>Z?ue*ue*ue:Q*(ue-4/29)}function B(ue){return 255*(ue<=.0031308?12.92*ue:1.055*Math.pow(ue,1/2.4)-.055)}function q(ue){return(ue/=255)<=.04045?ue/12.92:Math.pow((ue+.055)/1.055,2.4)}function ee(ue){if(ue instanceof $)return new $(ue.h,ue.c,ue.l,ue.opacity);if(ue instanceof Y||(ue=X(ue)),ue.a===0&&ue.b===0)return new $(NaN,0<ue.l&&ue.l<100?0:NaN,ue.l,ue.opacity);var me=Math.atan2(ue.b,ue.a)*W;return new $(me<0?me+360:me,Math.sqrt(ue.a*ue.a+ue.b*ue.b),ue.l,ue.opacity)}function J(ue,me,we,Me){return arguments.length===1?ee(ue):new $(ue,me,we,Me==null?1:Me)}function $(ue,me,we,Me){this.h=+ue,this.c=+me,this.l=+we,this.opacity=+Me}function te(ue){if(isNaN(ue.h))return new Y(ue.l,0,0,ue.opacity);var me=ue.h*j;return new Y(ue.l,Math.cos(me)*ue.c,Math.sin(me)*ue.c,ue.opacity)}m(Y,G,g(p,{brighter:function(ue){return new Y(this.l+18*(ue==null?1:ue),this.a,this.b,this.opacity)},darker:function(ue){return new Y(this.l-18*(ue==null?1:ue),this.a,this.b,this.opacity)},rgb:function(){var ue=(this.l+16)/116,me=isNaN(this.a)?ue:ue+this.a/500,we=isNaN(this.b)?ue:ue-this.b/200;return new S(B(3.1338561*(me=.96422*D(me))-1.6168667*(ue=1*D(ue))-.4906146*(we=.82521*D(we))),B(-.9787684*me+1.9161415*ue+.033454*we),B(.0719453*me-.2289914*ue+1.4052427*we),this.opacity)}})),m($,J,g(p,{brighter:function(ue){return new $(this.h,this.c,this.l+18*(ue==null?1:ue),this.opacity)},darker:function(ue){return new $(this.h,this.c,this.l-18*(ue==null?1:ue),this.opacity)},rgb:function(){return te(this).rgb()}}));var ie=-.14861,ae=1.78277,he=-.29227,se=-.90649,de=1.97294,ce=de*se,ve=de*ae,ke=ae*he-se*ie;function Ee(ue){if(ue instanceof xe)return new xe(ue.h,ue.s,ue.l,ue.opacity);ue instanceof S||(ue=T(ue));var me=ue.r/255,we=ue.g/255,Me=ue.b/255,Se=(ke*Me+ce*me-ve*we)/(ke+ce-ve),De=Me-Se,Fe=(de*(we-Se)-he*De)/se,Ye=Math.sqrt(Fe*Fe+De*De)/(de*Se*(1-Se)),et=Ye?Math.atan2(Fe,De)*W-120:NaN;return new xe(et<0?et+360:et,Ye,Se,ue.opacity)}function be(ue,me,we,Me){return arguments.length===1?Ee(ue):new xe(ue,me,we,Me==null?1:Me)}function xe(ue,me,we,Me){this.h=+ue,this.s=+me,this.l=+we,this.opacity=+Me}m(xe,be,g(p,{brighter:function(ue){return ue=ue==null?1/.7:Math.pow(1/.7,ue),new xe(this.h,this.s,this.l*ue,this.opacity)},darker:function(ue){return ue=ue==null?.7:Math.pow(.7,ue),new xe(this.h,this.s,this.l*ue,this.opacity)},rgb:function(){var ue=isNaN(this.h)?0:(this.h+120)*j,me=+this.l,we=isNaN(this.s)?0:this.s*me*(1-me),Me=Math.cos(ue),Se=Math.sin(ue);return new S(255*(me+we*(ie*Me+ae*Se)),255*(me+we*(he*Me+se*Se)),255*(me+we*(de*Me)),this.opacity)}})),t.color=v,t.cubehelix=be,t.gray=function(ue,me){return new Y(ue,0,0,me==null?1:me)},t.hcl=J,t.hsl=P,t.lab=G,t.lch=function(ue,me,we,Me){return arguments.length===1?ee(ue):new $(we,me,ue,Me==null?1:Me)},t.rgb=A,Object.defineProperty(t,"__esModule",{value:!0})})},{}],162:[function(h,N,H){(function(t,m){m(typeof H=="object"&&N!==void 0?H:(t=t||self).d3=t.d3||{})})(this,function(t){var m={value:function(){}};function g(){for(var i,s=0,o=arguments.length,a={};s<o;++s){if(!(i=arguments[s]+"")||i in a||/[\s.]/.test(i))throw new Error("illegal type: "+i);a[i]=[]}return new p(a)}function p(i){this._=i}function e(i,s){return i.trim().split(/^|\s+/).map(function(o){var a="",c=o.indexOf(".");if(c>=0&&(a=o.slice(c+1),o=o.slice(0,c)),o&&!s.hasOwnProperty(o))throw new Error("unknown type: "+o);return{type:o,name:a}})}function f(i,s){for(var o,a=0,c=i.length;a<c;++a)if((o=i[a]).name===s)return o.value}function u(i,s,o){for(var a=0,c=i.length;a<c;++a)if(i[a].name===s){i[a]=m,i=i.slice(0,a).concat(i.slice(a+1));break}return o!=null&&i.push({name:s,value:o}),i}p.prototype=g.prototype={constructor:p,on:function(i,s){var o,a=this._,c=e(i+"",a),r=-1,n=c.length;if(!(arguments.length<2)){if(s!=null&&typeof s!="function")throw new Error("invalid callback: "+s);for(;++r<n;)if(o=(i=c[r]).type)a[o]=u(a[o],i.name,s);else if(s==null)for(o in a)a[o]=u(a[o],i.name,null);return this}for(;++r<n;)if((o=(i=c[r]).type)&&(o=f(a[o],i.name)))return o},copy:function(){var i={},s=this._;for(var o in s)i[o]=s[o].slice();return new p(i)},call:function(i,s){if((o=arguments.length-2)>0)for(var o,a,c=new Array(o),r=0;r<o;++r)c[r]=arguments[r+2];if(!this._.hasOwnProperty(i))throw new Error("unknown type: "+i);for(r=0,o=(a=this._[i]).length;r<o;++r)a[r].value.apply(s,c)},apply:function(i,s,o){if(!this._.hasOwnProperty(i))throw new Error("unknown type: "+i);for(var a=this._[i],c=0,r=a.length;c<r;++c)a[c].value.apply(s,o)}},t.dispatch=g,Object.defineProperty(t,"__esModule",{value:!0})})},{}],163:[function(h,N,H){(function(t,m){typeof H=="object"&&N!==void 0?m(H,h("d3-quadtree"),h("d3-collection"),h("d3-dispatch"),h("d3-timer")):m(t.d3=t.d3||{},t.d3,t.d3,t.d3,t.d3)})(this,function(t,m,g,p,e){function f(d){return function(){return d}}function u(){return 1e-6*(Math.random()-.5)}function i(d){return d.x+d.vx}function s(d){return d.y+d.vy}function o(d){return d.index}function a(d,l){var y=d.get(l);if(!y)throw new Error("missing: "+l);return y}function c(d){return d.x}function r(d){return d.y}var n=Math.PI*(3-Math.sqrt(5));t.forceCenter=function(d,l){var y;function v(){var _,x,T=y.length,A=0,S=0;for(_=0;_<T;++_)A+=(x=y[_]).x,S+=x.y;for(A=A/T-d,S=S/T-l,_=0;_<T;++_)(x=y[_]).x-=A,x.y-=S}return d==null&&(d=0),l==null&&(l=0),v.initialize=function(_){y=_},v.x=function(_){return arguments.length?(d=+_,v):d},v.y=function(_){return arguments.length?(l=+_,v):l},v},t.forceCollide=function(d){var l,y,v=1,_=1;function x(){for(var S,w,L,k,C,M,P,O=l.length,F=0;F<_;++F)for(w=m.quadtree(l,i,s).visitAfter(T),S=0;S<O;++S)L=l[S],M=y[L.index],P=M*M,k=L.x+L.vx,C=L.y+L.vy,w.visit(j);function j(W,Z,Q,X,G){var Y=W.data,K=W.r,D=M+K;if(!Y)return Z>k+D||X<k-D||Q>C+D||G<C-D;if(Y.index>L.index){var B=k-Y.x-Y.vx,q=C-Y.y-Y.vy,ee=B*B+q*q;ee<D*D&&(B===0&&(ee+=(B=u())*B),q===0&&(ee+=(q=u())*q),ee=(D-(ee=Math.sqrt(ee)))/ee*v,L.vx+=(B*=ee)*(D=(K*=K)/(P+K)),L.vy+=(q*=ee)*D,Y.vx-=B*(D=1-D),Y.vy-=q*D)}}}function T(S){if(S.data)return S.r=y[S.data.index];for(var w=S.r=0;w<4;++w)S[w]&&S[w].r>S.r&&(S.r=S[w].r)}function A(){if(l){var S,w,L=l.length;for(y=new Array(L),S=0;S<L;++S)w=l[S],y[w.index]=+d(w,S,l)}}return typeof d!="function"&&(d=f(d==null?1:+d)),x.initialize=function(S){l=S,A()},x.iterations=function(S){return arguments.length?(_=+S,x):_},x.strength=function(S){return arguments.length?(v=+S,x):v},x.radius=function(S){return arguments.length?(d=typeof S=="function"?S:f(+S),A(),x):d},x},t.forceLink=function(d){var l,y,v,_,x,T=o,A=function(P){return 1/Math.min(_[P.source.index],_[P.target.index])},S=f(30),w=1;function L(P){for(var O=0,F=d.length;O<w;++O)for(var j,W,Z,Q,X,G,Y,K=0;K<F;++K)W=(j=d[K]).source,Q=(Z=j.target).x+Z.vx-W.x-W.vx||u(),X=Z.y+Z.vy-W.y-W.vy||u(),Q*=G=((G=Math.sqrt(Q*Q+X*X))-y[K])/G*P*l[K],X*=G,Z.vx-=Q*(Y=x[K]),Z.vy-=X*Y,W.vx+=Q*(Y=1-Y),W.vy+=X*Y}function k(){if(v){var P,O,F=v.length,j=d.length,W=g.map(v,T);for(P=0,_=new Array(F);P<j;++P)(O=d[P]).index=P,typeof O.source!="object"&&(O.source=a(W,O.source)),typeof O.target!="object"&&(O.target=a(W,O.target)),_[O.source.index]=(_[O.source.index]||0)+1,_[O.target.index]=(_[O.target.index]||0)+1;for(P=0,x=new Array(j);P<j;++P)O=d[P],x[P]=_[O.source.index]/(_[O.source.index]+_[O.target.index]);l=new Array(j),C(),y=new Array(j),M()}}function C(){if(v)for(var P=0,O=d.length;P<O;++P)l[P]=+A(d[P],P,d)}function M(){if(v)for(var P=0,O=d.length;P<O;++P)y[P]=+S(d[P],P,d)}return d==null&&(d=[]),L.initialize=function(P){v=P,k()},L.links=function(P){return arguments.length?(d=P,k(),L):d},L.id=function(P){return arguments.length?(T=P,L):T},L.iterations=function(P){return arguments.length?(w=+P,L):w},L.strength=function(P){return arguments.length?(A=typeof P=="function"?P:f(+P),C(),L):A},L.distance=function(P){return arguments.length?(S=typeof P=="function"?P:f(+P),M(),L):S},L},t.forceManyBody=function(){var d,l,y,v,_=f(-30),x=1,T=1/0,A=.81;function S(C){var M,P=d.length,O=m.quadtree(d,c,r).visitAfter(L);for(y=C,M=0;M<P;++M)l=d[M],O.visit(k)}function w(){if(d){var C,M,P=d.length;for(v=new Array(P),C=0;C<P;++C)M=d[C],v[M.index]=+_(M,C,d)}}function L(C){var M,P,O,F,j,W=0,Z=0;if(C.length){for(O=F=j=0;j<4;++j)(M=C[j])&&(P=Math.abs(M.value))&&(W+=M.value,Z+=P,O+=P*M.x,F+=P*M.y);C.x=O/Z,C.y=F/Z}else{(M=C).x=M.data.x,M.y=M.data.y;do W+=v[M.data.index];while(M=M.next)}C.value=W}function k(C,M,P,O){if(!C.value)return!0;var F=C.x-l.x,j=C.y-l.y,W=O-M,Z=F*F+j*j;if(W*W/A<Z)return Z<T&&(F===0&&(Z+=(F=u())*F),j===0&&(Z+=(j=u())*j),Z<x&&(Z=Math.sqrt(x*Z)),l.vx+=F*C.value*y/Z,l.vy+=j*C.value*y/Z),!0;if(!(C.length||Z>=T)){(C.data!==l||C.next)&&(F===0&&(Z+=(F=u())*F),j===0&&(Z+=(j=u())*j),Z<x&&(Z=Math.sqrt(x*Z)));do C.data!==l&&(W=v[C.data.index]*y/Z,l.vx+=F*W,l.vy+=j*W);while(C=C.next)}}return S.initialize=function(C){d=C,w()},S.strength=function(C){return arguments.length?(_=typeof C=="function"?C:f(+C),w(),S):_},S.distanceMin=function(C){return arguments.length?(x=C*C,S):Math.sqrt(x)},S.distanceMax=function(C){return arguments.length?(T=C*C,S):Math.sqrt(T)},S.theta=function(C){return arguments.length?(A=C*C,S):Math.sqrt(A)},S},t.forceRadial=function(d,l,y){var v,_,x,T=f(.1);function A(w){for(var L=0,k=v.length;L<k;++L){var C=v[L],M=C.x-l||1e-6,P=C.y-y||1e-6,O=Math.sqrt(M*M+P*P),F=(x[L]-O)*_[L]*w/O;C.vx+=M*F,C.vy+=P*F}}function S(){if(v){var w,L=v.length;for(_=new Array(L),x=new Array(L),w=0;w<L;++w)x[w]=+d(v[w],w,v),_[w]=isNaN(x[w])?0:+T(v[w],w,v)}}return typeof d!="function"&&(d=f(+d)),l==null&&(l=0),y==null&&(y=0),A.initialize=function(w){v=w,S()},A.strength=function(w){return arguments.length?(T=typeof w=="function"?w:f(+w),S(),A):T},A.radius=function(w){return arguments.length?(d=typeof w=="function"?w:f(+w),S(),A):d},A.x=function(w){return arguments.length?(l=+w,A):l},A.y=function(w){return arguments.length?(y=+w,A):y},A},t.forceSimulation=function(d){var l,y=1,v=.001,_=1-Math.pow(v,1/300),x=0,T=.6,A=g.map(),S=e.timer(L),w=p.dispatch("tick","end");function L(){k(),w.call("tick",l),y<v&&(S.stop(),w.call("end",l))}function k(P){var O,F,j=d.length;P===void 0&&(P=1);for(var W=0;W<P;++W)for(y+=(x-y)*_,A.each(function(Z){Z(y)}),O=0;O<j;++O)(F=d[O]).fx==null?F.x+=F.vx*=T:(F.x=F.fx,F.vx=0),F.fy==null?F.y+=F.vy*=T:(F.y=F.fy,F.vy=0);return l}function C(){for(var P,O=0,F=d.length;O<F;++O){if((P=d[O]).index=O,P.fx!=null&&(P.x=P.fx),P.fy!=null&&(P.y=P.fy),isNaN(P.x)||isNaN(P.y)){var j=10*Math.sqrt(O),W=O*n;P.x=j*Math.cos(W),P.y=j*Math.sin(W)}(isNaN(P.vx)||isNaN(P.vy))&&(P.vx=P.vy=0)}}function M(P){return P.initialize&&P.initialize(d),P}return d==null&&(d=[]),C(),l={tick:k,restart:function(){return S.restart(L),l},stop:function(){return S.stop(),l},nodes:function(P){return arguments.length?(d=P,C(),A.each(M),l):d},alpha:function(P){return arguments.length?(y=+P,l):y},alphaMin:function(P){return arguments.length?(v=+P,l):v},alphaDecay:function(P){return arguments.length?(_=+P,l):+_},alphaTarget:function(P){return arguments.length?(x=+P,l):x},velocityDecay:function(P){return arguments.length?(T=1-P,l):1-T},force:function(P,O){return arguments.length>1?(O==null?A.remove(P):A.set(P,M(O)),l):A.get(P)},find:function(P,O,F){var j,W,Z,Q,X,G=0,Y=d.length;for(F==null?F=1/0:F*=F,G=0;G<Y;++G)(Z=(j=P-(Q=d[G]).x)*j+(W=O-Q.y)*W)<F&&(X=Q,F=Z);return X},on:function(P,O){return arguments.length>1?(w.on(P,O),l):w.on(P)}}},t.forceX=function(d){var l,y,v,_=f(.1);function x(A){for(var S,w=0,L=l.length;w<L;++w)(S=l[w]).vx+=(v[w]-S.x)*y[w]*A}function T(){if(l){var A,S=l.length;for(y=new Array(S),v=new Array(S),A=0;A<S;++A)y[A]=isNaN(v[A]=+d(l[A],A,l))?0:+_(l[A],A,l)}}return typeof d!="function"&&(d=f(d==null?0:+d)),x.initialize=function(A){l=A,T()},x.strength=function(A){return arguments.length?(_=typeof A=="function"?A:f(+A),T(),x):_},x.x=function(A){return arguments.length?(d=typeof A=="function"?A:f(+A),T(),x):d},x},t.forceY=function(d){var l,y,v,_=f(.1);function x(A){for(var S,w=0,L=l.length;w<L;++w)(S=l[w]).vy+=(v[w]-S.y)*y[w]*A}function T(){if(l){var A,S=l.length;for(y=new Array(S),v=new Array(S),A=0;A<S;++A)y[A]=isNaN(v[A]=+d(l[A],A,l))?0:+_(l[A],A,l)}}return typeof d!="function"&&(d=f(d==null?0:+d)),x.initialize=function(A){l=A,T()},x.strength=function(A){return arguments.length?(_=typeof A=="function"?A:f(+A),T(),x):_},x.y=function(A){return arguments.length?(d=typeof A=="function"?A:f(+A),T(),x):d},x},Object.defineProperty(t,"__esModule",{value:!0})})},{"d3-collection":160,"d3-dispatch":162,"d3-quadtree":170,"d3-timer":175}],164:[function(h,N,H){(function(t,m){m(typeof H=="object"&&N!==void 0?H:(t=typeof globalThis!="undefined"?globalThis:t||self).d3=t.d3||{})})(this,function(t){function m(l,y){if((v=(l=y?l.toExponential(y-1):l.toExponential()).indexOf("e"))<0)return null;var v,_=l.slice(0,v);return[_.length>1?_[0]+_.slice(2):_,+l.slice(v+1)]}function g(l){return(l=m(Math.abs(l)))?l[1]:NaN}var p,e=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function f(l){if(!(y=e.exec(l)))throw new Error("invalid format: "+l);var y;return new u({fill:y[1],align:y[2],sign:y[3],symbol:y[4],zero:y[5],width:y[6],comma:y[7],precision:y[8]&&y[8].slice(1),trim:y[9],type:y[10]})}function u(l){this.fill=l.fill===void 0?" ":l.fill+"",this.align=l.align===void 0?">":l.align+"",this.sign=l.sign===void 0?"-":l.sign+"",this.symbol=l.symbol===void 0?"":l.symbol+"",this.zero=!!l.zero,this.width=l.width===void 0?void 0:+l.width,this.comma=!!l.comma,this.precision=l.precision===void 0?void 0:+l.precision,this.trim=!!l.trim,this.type=l.type===void 0?"":l.type+""}function i(l,y){var v=m(l,y);if(!v)return l+"";var _=v[0],x=v[1];return x<0?"0."+new Array(-x).join("0")+_:_.length>x+1?_.slice(0,x+1)+"."+_.slice(x+1):_+new Array(x-_.length+2).join("0")}f.prototype=u.prototype,u.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,0|this.width))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var s={"%":function(l,y){return(100*l).toFixed(y)},b:function(l){return Math.round(l).toString(2)},c:function(l){return l+""},d:function(l){return Math.abs(l=Math.round(l))>=1e21?l.toLocaleString("en").replace(/,/g,""):l.toString(10)},e:function(l,y){return l.toExponential(y)},f:function(l,y){return l.toFixed(y)},g:function(l,y){return l.toPrecision(y)},o:function(l){return Math.round(l).toString(8)},p:function(l,y){return i(100*l,y)},r:i,s:function(l,y){var v=m(l,y);if(!v)return l+"";var _=v[0],x=v[1],T=x-(p=3*Math.max(-8,Math.min(8,Math.floor(x/3))))+1,A=_.length;return T===A?_:T>A?_+new Array(T-A+1).join("0"):T>0?_.slice(0,T)+"."+_.slice(T):"0."+new Array(1-T).join("0")+m(l,Math.max(0,y+T-1))[0]},X:function(l){return Math.round(l).toString(16).toUpperCase()},x:function(l){return Math.round(l).toString(16)}};function o(l){return l}var a,c=Array.prototype.map,r=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function n(l){var y,v,_=l.grouping===void 0||l.thousands===void 0?o:(y=c.call(l.grouping,Number),v=l.thousands+"",function(M,P){for(var O=M.length,F=[],j=0,W=y[0],Z=0;O>0&&W>0&&(Z+W+1>P&&(W=Math.max(1,P-Z)),F.push(M.substring(O-=W,O+W)),!((Z+=W+1)>P));)W=y[j=(j+1)%y.length];return F.reverse().join(v)}),x=l.currency===void 0?"":l.currency[0]+"",T=l.currency===void 0?"":l.currency[1]+"",A=l.decimal===void 0?".":l.decimal+"",S=l.numerals===void 0?o:function(M){return function(P){return P.replace(/[0-9]/g,function(O){return M[+O]})}}(c.call(l.numerals,String)),w=l.percent===void 0?"%":l.percent+"",L=l.minus===void 0?"-":l.minus+"",k=l.nan===void 0?"NaN":l.nan+"";function C(M){var P=(M=f(M)).fill,O=M.align,F=M.sign,j=M.symbol,W=M.zero,Z=M.width,Q=M.comma,X=M.precision,G=M.trim,Y=M.type;Y==="n"?(Q=!0,Y="g"):s[Y]||(X===void 0&&(X=12),G=!0,Y="g"),(W||P==="0"&&O==="=")&&(W=!0,P="0",O="=");var K=j==="$"?x:j==="#"&&/[boxX]/.test(Y)?"0"+Y.toLowerCase():"",D=j==="$"?T:/[%p]/.test(Y)?w:"",B=s[Y],q=/[defgprs%]/.test(Y);function ee(J){var $,te,ie,ae=K,he=D;if(Y==="c")he=B(J)+he,J="";else{var se=(J=+J)<0||1/J<0;if(J=isNaN(J)?k:B(Math.abs(J),X),G&&(J=function(ve){e:for(var ke,Ee=ve.length,be=1,xe=-1;be<Ee;++be)switch(ve[be]){case".":xe=ke=be;break;case"0":xe===0&&(xe=be),ke=be;break;default:if(!+ve[be])break e;xe>0&&(xe=0)}return xe>0?ve.slice(0,xe)+ve.slice(ke+1):ve}(J)),se&&+J==0&&F!=="+"&&(se=!1),ae=(se?F==="("?F:L:F==="-"||F==="("?"":F)+ae,he=(Y==="s"?r[8+p/3]:"")+he+(se&&F==="("?")":""),q){for($=-1,te=J.length;++$<te;)if(48>(ie=J.charCodeAt($))||ie>57){he=(ie===46?A+J.slice($+1):J.slice($))+he,J=J.slice(0,$);break}}}Q&&!W&&(J=_(J,1/0));var de=ae.length+J.length+he.length,ce=de<Z?new Array(Z-de+1).join(P):"";switch(Q&&W&&(J=_(ce+J,ce.length?Z-he.length:1/0),ce=""),O){case"<":J=ae+J+he+ce;break;case"=":J=ae+ce+J+he;break;case"^":J=ce.slice(0,de=ce.length>>1)+ae+J+he+ce.slice(de);break;default:J=ce+ae+J+he}return S(J)}return X=X===void 0?6:/[gprs]/.test(Y)?Math.max(1,Math.min(21,X)):Math.max(0,Math.min(20,X)),ee.toString=function(){return M+""},ee}return{format:C,formatPrefix:function(M,P){var O=C(((M=f(M)).type="f",M)),F=3*Math.max(-8,Math.min(8,Math.floor(g(P)/3))),j=Math.pow(10,-F),W=r[8+F/3];return function(Z){return O(j*Z)+W}}}}function d(l){return a=n(l),t.format=a.format,t.formatPrefix=a.formatPrefix,a}d({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),t.FormatSpecifier=u,t.formatDefaultLocale=d,t.formatLocale=n,t.formatSpecifier=f,t.precisionFixed=function(l){return Math.max(0,-g(Math.abs(l)))},t.precisionPrefix=function(l,y){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(g(y)/3)))-g(Math.abs(l)))},t.precisionRound=function(l,y){return l=Math.abs(l),y=Math.abs(y)-l,Math.max(0,g(y)-g(l))+1},Object.defineProperty(t,"__esModule",{value:!0})})},{}],165:[function(h,N,H){(function(t,m){typeof H=="object"&&N!==void 0?m(H,h("d3-geo"),h("d3-array")):m(t.d3=t.d3||{},t.d3,t.d3)})(this,function(t,m,g){var p=Math.abs,e=Math.atan,f=Math.atan2,u=Math.cos,i=Math.exp,s=Math.floor,o=Math.log,a=Math.max,c=Math.min,r=Math.pow,n=Math.round,d=Math.sign||function(Re){return Re>0?1:Re<0?-1:0},l=Math.sin,y=Math.tan,v=1e-6,_=Math.PI,x=_/2,T=_/4,A=Math.SQRT1_2,S=O(2),w=O(_),L=2*_,k=180/_,C=_/180;function M(Re){return Re>1?x:Re<-1?-x:Math.asin(Re)}function P(Re){return Re>1?0:Re<-1?_:Math.acos(Re)}function O(Re){return Re>0?Math.sqrt(Re):0}function F(Re){return(i(Re)-i(-Re))/2}function j(Re){return(i(Re)+i(-Re))/2}function W(Re){var Ve=y(Re/2),Ke=2*o(u(Re/2))/(Ve*Ve);function at(dt,ht){var Mt=u(dt),Wt=u(ht),Jt=l(ht),qt=Wt*Mt,tr=-((1-qt?o((1+qt)/2)/(1-qt):-.5)+Ke/(1+qt));return[tr*Wt*l(dt),tr*Jt]}return at.invert=function(dt,ht){var Mt,Wt=O(dt*dt+ht*ht),Jt=-Re/2,qt=50;if(!Wt)return[0,0];do{var tr=Jt/2,lr=u(tr),dr=l(tr),gr=dr/lr,Pr=-o(p(lr));Jt-=Mt=(2/gr*Pr-Ke*gr-Wt)/(-Pr/(dr*dr)+1-Ke/(2*lr*lr))*(lr<0?.7:1)}while(p(Mt)>v&&--qt>0);var tn=l(Jt);return[f(dt*tn,Wt*u(Jt)),M(ht*tn/Wt)]},at}function Z(Re,Ve){var Ke=u(Ve),at=function(dt){return dt?dt/Math.sin(dt):1}(P(Ke*u(Re/=2)));return[2*Ke*l(Re)*at,l(Ve)*at]}function Q(Re){var Ve=l(Re),Ke=u(Re),at=Re>=0?1:-1,dt=y(at*Re),ht=(1+Ve-Ke)/2;function Mt(Wt,Jt){var qt=u(Jt),tr=u(Wt/=2);return[(1+qt)*l(Wt),(at*Jt>-f(tr,dt)-.001?0:10*-at)+ht+l(Jt)*Ke-(1+qt)*Ve*tr]}return Mt.invert=function(Wt,Jt){var qt=0,tr=0,lr=50;do{var dr=u(qt),gr=l(qt),Pr=u(tr),tn=l(tr),pn=1+Pr,Sn=pn*gr-Wt,In=ht+tn*Ke-pn*Ve*dr-Jt,Un=pn*dr/2,On=-gr*tn,pa=Ve*pn*gr/2,_a=Ke*Pr+Ve*dr*tn,Ra=On*pa-_a*Un,Da=(In*On-Sn*_a)/Ra/2,Fa=(Sn*pa-In*Un)/Ra;p(Fa)>2&&(Fa/=2),qt-=Da,tr-=Fa}while((p(Da)>v||p(Fa)>v)&&--lr>0);return at*tr>-f(u(qt),dt)-.001?[2*qt,tr]:null},Mt}function X(Re,Ve){var Ke=y(Ve/2),at=O(1-Ke*Ke),dt=1+at*u(Re/=2),ht=l(Re)*at/dt,Mt=Ke/dt,Wt=ht*ht,Jt=Mt*Mt;return[4/3*ht*(3+Wt-3*Jt),4/3*Mt*(3+3*Wt-Jt)]}Z.invert=function(Re,Ve){if(!(Re*Re+4*Ve*Ve>_*_+v)){var Ke=Re,at=Ve,dt=25;do{var ht,Mt=l(Ke),Wt=l(Ke/2),Jt=u(Ke/2),qt=l(at),tr=u(at),lr=l(2*at),dr=qt*qt,gr=tr*tr,Pr=Wt*Wt,tn=1-gr*Jt*Jt,pn=tn?P(tr*Jt)*O(ht=1/tn):ht=0,Sn=2*pn*tr*Wt-Re,In=pn*qt-Ve,Un=ht*(gr*Pr+pn*tr*Jt*dr),On=ht*(.5*Mt*lr-2*pn*qt*Wt),pa=.25*ht*(lr*Wt-pn*qt*gr*Mt),_a=ht*(dr*Jt+pn*Pr*tr),Ra=On*pa-_a*Un;if(!Ra)break;var Da=(In*On-Sn*_a)/Ra,Fa=(Sn*pa-In*Un)/Ra;Ke-=Da,at-=Fa}while((p(Da)>v||p(Fa)>v)&&--dt>0);return[Ke,at]}},X.invert=function(Re,Ve){if(Ve*=3/8,!(Re*=3/8)&&p(Ve)>1)return null;var Ke=1+Re*Re+Ve*Ve,at=O((Ke-O(Ke*Ke-4*Ve*Ve))/2),dt=M(at)/3,ht=at?function(qt){return o(qt+O(qt*qt-1))}(p(Ve/at))/3:function(qt){return o(qt+O(qt*qt+1))}(p(Re))/3,Mt=u(dt),Wt=j(ht),Jt=Wt*Wt-Mt*Mt;return[2*d(Re)*f(F(ht)*Mt,.25-Jt),2*d(Ve)*f(Wt*l(dt),.25+Jt)]};var G=O(8),Y=o(1+S);function K(Re,Ve){var Ke=p(Ve);return Ke<T?[Re,o(y(T+Ve/2))]:[Re*u(Ke)*(2*S-1/l(Ke)),d(Ve)*(2*S*(Ke-T)-o(y(Ke/2)))]}function D(Re){var Ve=2*_/Re;function Ke(at,dt){var ht=m.geoAzimuthalEquidistantRaw(at,dt);if(p(at)>x){var Mt=f(ht[1],ht[0]),Wt=O(ht[0]*ht[0]+ht[1]*ht[1]),Jt=Ve*n((Mt-x)/Ve)+x,qt=f(l(Mt-=Jt),2-u(Mt));Mt=Jt+M(_/Wt*l(qt))-qt,ht[0]=Wt*u(Mt),ht[1]=Wt*l(Mt)}return ht}return Ke.invert=function(at,dt){var ht=O(at*at+dt*dt);if(ht>x){var Mt=f(dt,at),Wt=Ve*n((Mt-x)/Ve)+x,Jt=Mt>Wt?-1:1,qt=ht*u(Wt-Mt),tr=1/y(Jt*P((qt-_)/O(_*(_-2*qt)+ht*ht)));Mt=Wt+2*e((tr+Jt*O(tr*tr-3))/3),at=ht*u(Mt),dt=ht*l(Mt)}return m.geoAzimuthalEquidistantRaw.invert(at,dt)},Ke}function B(Re,Ve){if(arguments.length<2&&(Ve=Re),Ve===1)return m.geoAzimuthalEqualAreaRaw;if(Ve===1/0)return q;function Ke(at,dt){var ht=m.geoAzimuthalEqualAreaRaw(at/Ve,dt);return ht[0]*=Re,ht}return Ke.invert=function(at,dt){var ht=m.geoAzimuthalEqualAreaRaw.invert(at/Re,dt);return ht[0]*=Ve,ht},Ke}function q(Re,Ve){return[Re*u(Ve)/u(Ve/=2),2*l(Ve)]}function ee(Re,Ve,Ke){var at,dt,ht,Mt=100;Ke=Ke===void 0?0:+Ke,Ve=+Ve;do(dt=Re(Ke))===(ht=Re(Ke+v))&&(ht=dt+v),Ke-=at=-1*v*(dt-Ve)/(dt-ht);while(Mt-- >0&&p(at)>v);return Mt<0?NaN:Ke}function J(Re,Ve,Ke){return Ve===void 0&&(Ve=40),Ke===void 0&&(Ke=1e-12),function(at,dt,ht,Mt){var Wt,Jt,qt;ht=ht===void 0?0:+ht,Mt=Mt===void 0?0:+Mt;for(var tr=0;tr<Ve;tr++){var lr=Re(ht,Mt),dr=lr[0]-at,gr=lr[1]-dt;if(p(dr)<Ke&&p(gr)<Ke)break;var Pr=dr*dr+gr*gr;if(Pr>Wt)ht-=Jt/=2,Mt-=qt/=2;else{Wt=Pr;var tn=(ht>0?-1:1)*Ke,pn=(Mt>0?-1:1)*Ke,Sn=Re(ht+tn,Mt),In=Re(ht,Mt+pn),Un=(Sn[0]-lr[0])/tn,On=(Sn[1]-lr[1])/tn,pa=(In[0]-lr[0])/pn,_a=(In[1]-lr[1])/pn,Ra=_a*Un-On*pa,Da=(p(Ra)<.5?.5:1)/Ra;if(ht+=Jt=(gr*pa-dr*_a)*Da,Mt+=qt=(dr*On-gr*Un)*Da,p(Jt)<Ke&&p(qt)<Ke)break}}return[ht,Mt]}}function $(){var Re=B(1.68,2);function Ve(Ke,at){if(Ke+at<-1.4){var dt=(Ke-at+1.6)*(Ke+at+1.4)/8;Ke+=dt,at-=.8*dt*l(at+_/2)}var ht=Re(Ke,at),Mt=(1-u(Ke*at))/12;return ht[1]<0&&(ht[0]*=1+Mt),ht[1]>0&&(ht[1]*=1+Mt/1.5*ht[0]*ht[0]),ht}return Ve.invert=J(Ve),Ve}function te(Re,Ve){var Ke,at=Re*l(Ve),dt=30;do Ve-=Ke=(Ve+l(Ve)-at)/(1+u(Ve));while(p(Ke)>v&&--dt>0);return Ve/2}function ie(Re,Ve,Ke){function at(dt,ht){return[Re*dt*u(ht=te(Ke,ht)),Ve*l(ht)]}return at.invert=function(dt,ht){return ht=M(ht/Ve),[dt/(Re*u(ht)),M((2*ht+l(2*ht))/Ke)]},at}K.invert=function(Re,Ve){if((at=p(Ve))<Y)return[Re,2*e(i(Ve))-x];var Ke,at,dt=T,ht=25;do{var Mt=u(dt/2),Wt=y(dt/2);dt-=Ke=(G*(dt-T)-o(Wt)-at)/(G-Mt*Mt/(2*Wt))}while(p(Ke)>1e-12&&--ht>0);return[Re/(u(dt)*(G-1/l(dt))),d(Ve)*dt]},q.invert=function(Re,Ve){var Ke=2*M(Ve/2);return[Re*u(Ke/2)/u(Ke),Ke]};var ae=ie(S/x,S,_),he=2.00276,se=1.11072;function de(Re,Ve){var Ke=te(_,Ve);return[he*Re/(1/u(Ve)+se/u(Ke)),(Ve+S*l(Ke))/he]}function ce(Re){var Ve=0,Ke=m.geoProjectionMutator(Re),at=Ke(Ve);return at.parallel=function(dt){return arguments.length?Ke(Ve=dt*C):Ve*k},at}function ve(Re,Ve){return[Re*u(Ve),Ve]}function ke(Re){if(!Re)return ve;var Ve=1/y(Re);function Ke(at,dt){var ht=Ve+Re-dt,Mt=ht&&at*u(dt)/ht;return[ht*l(Mt),Ve-ht*u(Mt)]}return Ke.invert=function(at,dt){var ht=O(at*at+(dt=Ve-dt)*dt),Mt=Ve+Re-ht;return[ht/u(Mt)*f(at,dt),Mt]},Ke}function Ee(Re){function Ve(Ke,at){var dt=x-at,ht=dt&&Ke*Re*l(dt)/dt;return[dt*l(ht)/Re,x-dt*u(ht)]}return Ve.invert=function(Ke,at){var dt=Ke*Re,ht=x-at,Mt=O(dt*dt+ht*ht),Wt=f(dt,ht);return[(Mt?Mt/l(Mt):1)*Wt/Re,x-Mt]},Ve}de.invert=function(Re,Ve){var Ke,at,dt=he*Ve,ht=Ve<0?-T:T,Mt=25;do at=dt-S*l(ht),ht-=Ke=(l(2*ht)+2*ht-_*l(at))/(2*u(2*ht)+2+_*u(at)*S*u(ht));while(p(Ke)>v&&--Mt>0);return at=dt-S*l(ht),[Re*(1/u(at)+se/u(ht))/he,at]},ve.invert=function(Re,Ve){return[Re/u(Ve),Ve]};var be=ie(1,4/_,_);function xe(Re,Ve,Ke,at,dt,ht){var Mt,Wt=u(ht);if(p(Re)>1||p(ht)>1)Mt=P(Ke*dt+Ve*at*Wt);else{var Jt=l(Re/2),qt=l(ht/2);Mt=2*M(O(Jt*Jt+Ve*at*qt*qt))}return p(Mt)>v?[Mt,f(at*l(ht),Ve*dt-Ke*at*Wt)]:[0,0]}function ue(Re,Ve,Ke){return P((Re*Re+Ve*Ve-Ke*Ke)/(2*Re*Ve))}function me(Re){return Re-2*_*s((Re+_)/(2*_))}function we(Re,Ve,Ke){for(var at,dt=[[Re[0],Re[1],l(Re[1]),u(Re[1])],[Ve[0],Ve[1],l(Ve[1]),u(Ve[1])],[Ke[0],Ke[1],l(Ke[1]),u(Ke[1])]],ht=dt[2],Mt=0;Mt<3;++Mt,ht=at)at=dt[Mt],ht.v=xe(at[1]-ht[1],ht[3],ht[2],at[3],at[2],at[0]-ht[0]),ht.point=[0,0];var Wt=ue(dt[0].v[0],dt[2].v[0],dt[1].v[0]),Jt=ue(dt[0].v[0],dt[1].v[0],dt[2].v[0]),qt=_-Wt;dt[2].point[1]=0,dt[0].point[0]=-(dt[1].point[0]=dt[0].v[0]/2);var tr=[dt[2].point[0]=dt[0].point[0]+dt[2].v[0]*u(Wt),2*(dt[0].point[1]=dt[1].point[1]=dt[2].v[0]*l(Wt))];return function(lr,dr){var gr,Pr=l(dr),tn=u(dr),pn=new Array(3);for(gr=0;gr<3;++gr){var Sn=dt[gr];if(pn[gr]=xe(dr-Sn[1],Sn[3],Sn[2],tn,Pr,lr-Sn[0]),!pn[gr][0])return Sn.point;pn[gr][1]=me(pn[gr][1]-Sn.v[1])}var In=tr.slice();for(gr=0;gr<3;++gr){var Un=gr==2?0:gr+1,On=ue(dt[gr].v[0],pn[gr][0],pn[Un][0]);pn[gr][1]<0&&(On=-On),gr?gr==1?(On=Jt-On,In[0]-=pn[gr][0]*u(On),In[1]-=pn[gr][0]*l(On)):(On=qt-On,In[0]+=pn[gr][0]*u(On),In[1]+=pn[gr][0]*l(On)):(In[0]+=pn[gr][0]*u(On),In[1]-=pn[gr][0]*l(On))}return In[0]/=3,In[1]/=3,In}}function Me(Re){return Re[0]*=C,Re[1]*=C,Re}function Se(Re,Ve,Ke){var at=m.geoCentroid({type:"MultiPoint",coordinates:[Re,Ve,Ke]}),dt=[-at[0],-at[1]],ht=m.geoRotation(dt),Mt=we(Me(ht(Re)),Me(ht(Ve)),Me(ht(Ke)));Mt.invert=J(Mt);var Wt=m.geoProjection(Mt).rotate(dt),Jt=Wt.center;return delete Wt.rotate,Wt.center=function(qt){return arguments.length?Jt(ht(qt)):ht.invert(Jt())},Wt.clipAngle(90)}function De(Re,Ve){var Ke=O(1-l(Ve));return[2/w*Re*Ke,w*(1-Ke)]}function Fe(Re){var Ve=y(Re);function Ke(at,dt){return[at,(at?at/l(at):1)*(l(dt)*u(at)-Ve*u(dt))]}return Ke.invert=Ve?function(at,dt){at&&(dt*=l(at)/at);var ht=u(at);return[at,2*f(O(ht*ht+Ve*Ve-dt*dt)-ht,Ve-dt)]}:function(at,dt){return[at,M(at?dt*y(at)/at:dt)]},Ke}De.invert=function(Re,Ve){var Ke=(Ke=Ve/w-1)*Ke;return[Ke>0?Re*O(_/Ke)/2:0,M(1-Ke)]};var Ye=O(3);function et(Re,Ve){return[Ye*Re*(2*u(2*Ve/3)-1)/w,Ye*w*l(Ve/3)]}function Oe(Re){var Ve=u(Re);function Ke(at,dt){return[at*Ve,l(dt)/Ve]}return Ke.invert=function(at,dt){return[at/Ve,M(dt*Ve)]},Ke}function je(Re){var Ve=u(Re);function Ke(at,dt){return[at*Ve,(1+Ve)*y(dt/2)]}return Ke.invert=function(at,dt){return[at/Ve,2*e(dt/(1+Ve))]},Ke}function We(Re,Ve){var Ke=O(8/(3*_));return[Ke*Re*(1-p(Ve)/_),Ke*Ve]}function Ge(Re,Ve){var Ke=O(4-3*l(p(Ve)));return[2/O(6*_)*Re*Ke,d(Ve)*O(2*_/3)*(2-Ke)]}function Qe(Re,Ve){var Ke=O(_*(4+_));return[2/Ke*Re*(1+O(1-4*Ve*Ve/(_*_))),4/Ke*Ve]}function it(Re,Ve){var Ke=(2+x)*l(Ve);Ve/=2;for(var at=0,dt=1/0;at<10&&p(dt)>v;at++){var ht=u(Ve);Ve-=dt=(Ve+l(Ve)*(ht+2)-Ke)/(2*ht*(1+ht))}return[2/O(_*(4+_))*Re*(1+u(Ve)),2*O(_/(4+_))*l(Ve)]}function lt(Re,Ve){return[Re*(1+u(Ve))/O(2+_),2*Ve/O(2+_)]}function Lt(Re,Ve){for(var Ke=(1+x)*l(Ve),at=0,dt=1/0;at<10&&p(dt)>v;at++)Ve-=dt=(Ve+l(Ve)-Ke)/(1+u(Ve));return Ke=O(2+_),[Re*(1+u(Ve))/Ke,2*Ve/Ke]}et.invert=function(Re,Ve){var Ke=3*M(Ve/(Ye*w));return[w*Re/(Ye*(2*u(2*Ke/3)-1)),Ke]},We.invert=function(Re,Ve){var Ke=O(8/(3*_)),at=Ve/Ke;return[Re/(Ke*(1-p(at)/_)),at]},Ge.invert=function(Re,Ve){var Ke=2-p(Ve)/O(2*_/3);return[Re*O(6*_)/(2*Ke),d(Ve)*M((4-Ke*Ke)/3)]},Qe.invert=function(Re,Ve){var Ke=O(_*(4+_))/2;return[Re*Ke/(1+O(1-Ve*Ve*(4+_)/(4*_))),Ve*Ke/2]},it.invert=function(Re,Ve){var Ke=Ve*O((4+_)/_)/2,at=M(Ke),dt=u(at);return[Re/(2/O(_*(4+_))*(1+dt)),M((at+Ke*(dt+2))/(2+x))]},lt.invert=function(Re,Ve){var Ke=O(2+_),at=Ve*Ke/2;return[Ke*Re/(1+u(at)),at]},Lt.invert=function(Re,Ve){var Ke=1+x,at=O(Ke/2);return[2*Re*at/(1+u(Ve*=at)),M((Ve+l(Ve))/Ke)]};var wt=3+2*S;function rt(Re,Ve){var Ke=l(Re/=2),at=u(Re),dt=O(u(Ve)),ht=u(Ve/=2),Mt=l(Ve)/(ht+S*at*dt),Wt=O(2/(1+Mt*Mt)),Jt=O((S*ht+(at+Ke)*dt)/(S*ht+(at-Ke)*dt));return[wt*(Wt*(Jt-1/Jt)-2*o(Jt)),wt*(Wt*Mt*(Jt+1/Jt)-2*e(Mt))]}rt.invert=function(Re,Ve){if(!(Ke=X.invert(Re/1.2,1.065*Ve)))return null;var Ke,at=Ke[0],dt=Ke[1],ht=20;Re/=wt,Ve/=wt;do{var Mt=at/2,Wt=dt/2,Jt=l(Mt),qt=u(Mt),tr=l(Wt),lr=u(Wt),dr=u(dt),gr=O(dr),Pr=tr/(lr+S*qt*gr),tn=Pr*Pr,pn=O(2/(1+tn)),Sn=(S*lr+(qt+Jt)*gr)/(S*lr+(qt-Jt)*gr),In=O(Sn),Un=In-1/In,On=In+1/In,pa=pn*Un-2*o(In)-Re,_a=pn*Pr*On-2*e(Pr)-Ve,Ra=tr&&A*gr*Jt*tn/tr,Da=(S*qt*lr+gr)/(2*(lr+S*qt*gr)*(lr+S*qt*gr)*gr),Fa=-.5*Pr*pn*pn*pn,bi=Fa*Ra,gi=Fa*Da,ai=(ai=2*lr+S*gr*(qt-Jt))*ai*In,ii=(S*qt*lr*gr+dr)/ai,vi=-S*Jt*tr/(gr*ai),Ri=Un*bi-2*ii/In+pn*(ii+ii/Sn),Zi=Un*gi-2*vi/In+pn*(vi+vi/Sn),Ji=Pr*On*bi-2*Ra/(1+tn)+pn*On*Ra+pn*Pr*(ii-ii/Sn),Ki=Pr*On*gi-2*Da/(1+tn)+pn*On*Da+pn*Pr*(vi-vi/Sn),Qi=Zi*Ji-Ki*Ri;if(!Qi)break;var Pa=(_a*Zi-pa*Ki)/Qi,ct=(pa*Ji-_a*Ri)/Qi;at-=Pa,dt=a(-x,c(x,dt-ct))}while((p(Pa)>v||p(ct)>v)&&--ht>0);return p(p(dt)-x)<v?[0,dt]:ht&&[at,dt]};var $e=u(35*C);function xt(Re,Ve){var Ke=y(Ve/2);return[Re*$e*O(1-Ke*Ke),(1+$e)*Ke]}function Qt(Re,Ve){var Ke=Ve/2,at=u(Ke);return[2*Re/w*u(Ve)*at*at,w*y(Ke)]}function $t(Re){var Ve=1-Re,Ke=dt(_,0)[0]-dt(-_,0)[0],at=O(2*(dt(0,x)[1]-dt(0,-x)[1])/Ke);function dt(Wt,Jt){var qt=u(Jt),tr=l(Jt);return[qt/(Ve+Re*qt)*Wt,Ve*Jt+Re*tr]}function ht(Wt,Jt){var qt=dt(Wt,Jt);return[qt[0]*at,qt[1]/at]}function Mt(Wt){return ht(0,Wt)[1]}return ht.invert=function(Wt,Jt){var qt=ee(Mt,Jt);return[Wt/at*(Re+Ve/u(qt)),qt]},ht}function Ue(Re){return[Re[0]/2,M(y(Re[1]/2*C))*k]}function He(Re){return[2*Re[0],2*e(l(Re[1]*C))*k]}function Be(Re,Ve){var Ke=2*_/Ve,at=Re*Re;function dt(ht,Mt){var Wt=m.geoAzimuthalEquidistantRaw(ht,Mt),Jt=Wt[0],qt=Wt[1],tr=Jt*Jt+qt*qt;if(tr>at){var lr=O(tr),dr=f(qt,Jt),gr=Ke*n(dr/Ke),Pr=dr-gr,tn=Re*u(Pr),pn=(Re*l(Pr)-Pr*l(tn))/(x-tn),Sn=Je(Pr,pn),In=(_-Re)/_e(Sn,tn,_);Jt=lr;var Un,On=50;do Jt-=Un=(Re+_e(Sn,tn,Jt)*In-lr)/(Sn(Jt)*In);while(p(Un)>v&&--On>0);qt=Pr*l(Jt),Jt<x&&(qt-=pn*(Jt-x));var pa=l(gr),_a=u(gr);Wt[0]=Jt*_a-qt*pa,Wt[1]=Jt*pa+qt*_a}return Wt}return dt.invert=function(ht,Mt){var Wt=ht*ht+Mt*Mt;if(Wt>at){var Jt=O(Wt),qt=f(Mt,ht),tr=Ke*n(qt/Ke),lr=qt-tr;ht=Jt*u(lr),Mt=Jt*l(lr);for(var dr=ht-x,gr=l(ht),Pr=Mt/gr,tn=ht<x?1/0:0,pn=10;;){var Sn=Re*l(Pr),In=Re*u(Pr),Un=l(In),On=x-In,pa=(Sn-Pr*Un)/On,_a=Je(Pr,pa);if(p(tn)<1e-12||!--pn)break;Pr-=tn=(Pr*gr-pa*dr-Mt)/(gr-2*dr*(On*(In+Pr*Sn*u(In)-Un)-Sn*(Sn-Pr*Un))/(On*On))}ht=(Jt=Re+_e(_a,In,ht)*(_-Re)/_e(_a,In,_))*u(qt=tr+Pr),Mt=Jt*l(qt)}return m.geoAzimuthalEquidistantRaw.invert(ht,Mt)},dt}function Je(Re,Ve){return function(Ke){var at=Re*u(Ke);return Ke<x&&(at-=Ve),O(1+at*at)}}function _e(Re,Ve,Ke){for(var at=(Ke-Ve)/50,dt=Re(Ve)+Re(Ke),ht=1,Mt=Ve;ht<50;++ht)dt+=2*Re(Mt+=at);return .5*dt*at}function Le(Re,Ve,Ke,at,dt,ht,Mt,Wt){function Jt(qt,tr){if(!tr)return[Re*qt/_,0];var lr=tr*tr,dr=Re+lr*(Ve+lr*(Ke+lr*at)),gr=tr*(dt-1+lr*(ht-Wt+lr*Mt)),Pr=(dr*dr+gr*gr)/(2*gr),tn=qt*M(dr/Pr)/_;return[Pr*l(tn),tr*(1+lr*Wt)+Pr*(1-u(tn))]}return arguments.length<8&&(Wt=0),Jt.invert=function(qt,tr){var lr,dr,gr=_*qt/Re,Pr=tr,tn=50;do{var pn=Pr*Pr,Sn=Re+pn*(Ve+pn*(Ke+pn*at)),In=Pr*(dt-1+pn*(ht-Wt+pn*Mt)),Un=Sn*Sn+In*In,On=2*In,pa=Un/On,_a=pa*pa,Ra=M(Sn/pa)/_,Da=gr*Ra,Fa=Sn*Sn,bi=(2*Ve+pn*(4*Ke+6*pn*at))*Pr,gi=dt+pn*(3*ht+5*pn*Mt),ai=(2*(Sn*bi+In*(gi-1))*On-Un*(2*(gi-1)))/(On*On),ii=u(Da),vi=l(Da),Ri=pa*ii,Zi=pa*vi,Ji=gr/_*(1/O(1-Fa/_a))*(bi*pa-Sn*ai)/_a,Ki=Zi-qt,Qi=Pr*(1+pn*Wt)+pa-Ri-tr,Pa=ai*vi+Ri*Ji,ct=Ri*Ra,zt=1+ai-(ai*ii-Zi*Ji),ir=Zi*Ra,jt=Pa*ir-zt*ct;if(!jt)break;gr-=lr=(Qi*Pa-Ki*zt)/jt,Pr-=dr=(Ki*ir-Qi*ct)/jt}while((p(lr)>v||p(dr)>v)&&--tn>0);return[gr,Pr]},Jt}xt.invert=function(Re,Ve){var Ke=Ve/(1+$e);return[Re&&Re/($e*O(1-Ke*Ke)),2*e(Ke)]},Qt.invert=function(Re,Ve){var Ke=e(Ve/w),at=u(Ke),dt=2*Ke;return[Re*w/2/(u(dt)*at*at),dt]};var Ce=Le(2.8284,-1.6988,.75432,-.18071,1.76003,-.38914,.042555),Pe=Le(2.583819,-.835827,.170354,-.038094,1.543313,-.411435,.082742),Xe=Le(5/6*_,-.62636,-.0344,0,1.3493,-.05524,0,.045);function ut(Re,Ve){var Ke=Re*Re,at=Ve*Ve;return[Re*(1-.162388*at)*(.87-952426e-9*Ke*Ke),Ve*(1+at/12)]}ut.invert=function(Re,Ve){var Ke,at=Re,dt=Ve,ht=50;do{var Mt=dt*dt;dt-=Ke=(dt*(1+Mt/12)-Ve)/(1+Mt/4)}while(p(Ke)>v&&--ht>0);ht=50,Re/=1-.162388*Mt;do{var Wt=(Wt=at*at)*Wt;at-=Ke=(at*(.87-952426e-9*Wt)-Re)/(.87-.00476213*Wt)}while(p(Ke)>v&&--ht>0);return[at,dt]};var kt=Le(2.6516,-.76534,.19123,-.047094,1.36289,-.13965,.031762);function ft(Re){var Ve=Re(x,0)[0]-Re(-x,0)[0];function Ke(at,dt){var ht=at>0?-.5:.5,Mt=Re(at+ht*_,dt);return Mt[0]-=ht*Ve,Mt}return Re.invert&&(Ke.invert=function(at,dt){var ht=at>0?-.5:.5,Mt=Re.invert(at+ht*Ve,dt),Wt=Mt[0]-ht*_;return Wt<-_?Wt+=2*_:Wt>_&&(Wt-=2*_),Mt[0]=Wt,Mt}),Ke}function Et(Re,Ve){var Ke=d(Re),at=d(Ve),dt=u(Ve),ht=u(Re)*dt,Mt=l(Re)*dt,Wt=l(at*Ve);Re=p(f(Mt,Wt)),Ve=M(ht),p(Re-x)>v&&(Re%=x);var Jt=function(qt,tr){if(tr===x)return[0,0];var lr,dr,gr=l(tr),Pr=gr*gr,tn=Pr*Pr,pn=1+tn,Sn=1+3*tn,In=1-tn,Un=M(1/O(pn)),On=In+Pr*pn*Un,pa=(1-gr)/On,_a=O(pa),Ra=pa*pn,Da=O(Ra),Fa=_a*In;if(qt===0)return[0,-(Fa+Pr*Da)];var bi,gi=u(tr),ai=1/gi,ii=2*gr*gi,vi=(-On*gi-(-3*Pr+Un*Sn)*ii*(1-gr))/(On*On),Ri=-ai*ii,Zi=-ai*(Pr*pn*vi+pa*Sn*ii),Ji=-2*ai*(In*(.5*vi/_a)-2*Pr*_a*ii),Ki=4*qt/_;if(qt>.222*_||tr<_/4&&qt>.175*_){if(lr=(Fa+Pr*O(Ra*(1+tn)-Fa*Fa))/(1+tn),qt>_/4)return[lr,lr];var Qi=lr,Pa=.5*lr;lr=.5*(Pa+Qi),dr=50;do{var ct=O(Ra-lr*lr),zt=lr*(Ji+Ri*ct)+Zi*M(lr/Da)-Ki;if(!zt)break;zt<0?Pa=lr:Qi=lr,lr=.5*(Pa+Qi)}while(p(Qi-Pa)>v&&--dr>0)}else{lr=v,dr=25;do{var ir=lr*lr,jt=O(Ra-ir),or=Ji+Ri*jt,Er=lr*or+Zi*M(lr/Da)-Ki,Or=or+(Zi-Ri*ir)/jt;lr-=bi=jt?Er/Or:0}while(p(bi)>v&&--dr>0)}return[lr,-Fa-Pr*O(Ra-lr*lr)]}(Re>_/4?x-Re:Re,Ve);return Re>_/4&&(Wt=Jt[0],Jt[0]=-Jt[1],Jt[1]=-Wt),Jt[0]*=Ke,Jt[1]*=-at,Jt}function mt(Re,Ve){var Ke,at,dt,ht,Mt,Wt;if(Ve<v)return[(ht=l(Re))-(Ke=Ve*(Re-ht*(at=u(Re)))/4)*at,at+Ke*ht,1-Ve*ht*ht/2,Re-Ke];if(Ve>=1-v)return Ke=(1-Ve)/4,dt=1/(at=j(Re)),[(ht=((Wt=i(2*(Wt=Re)))-1)/(Wt+1))+Ke*((Mt=at*F(Re))-Re)/(at*at),dt-Ke*ht*dt*(Mt-Re),dt+Ke*ht*dt*(Mt+Re),2*e(i(Re))-x+Ke*(Mt-Re)/at];var Jt=[1,0,0,0,0,0,0,0,0],qt=[O(Ve),0,0,0,0,0,0,0,0],tr=0;for(at=O(1-Ve),Mt=1;p(qt[tr]/Jt[tr])>v&&tr<8;)Ke=Jt[tr++],qt[tr]=(Ke-at)/2,Jt[tr]=(Ke+at)/2,at=O(Ke*at),Mt*=2;dt=Mt*Jt[tr]*Re;do dt=(M(ht=qt[tr]*l(at=dt)/Jt[tr])+dt)/2;while(--tr);return[l(dt),ht=u(dt),ht/u(dt-at),dt]}function It(Re,Ve){if(!Ve)return Re;if(Ve===1)return o(y(Re/2+T));for(var Ke=1,at=O(1-Ve),dt=O(Ve),ht=0;p(dt)>v;ht++){if(Re%_){var Mt=e(at*y(Re)/Ke);Mt<0&&(Mt+=_),Re+=Mt+~~(Re/_)*_}else Re+=Re;dt=(Ke+at)/2,at=O(Ke*at),dt=((Ke=dt)-at)/2}return Re/(r(2,ht)*Ke)}function vt(Re,Ve){var Ke=(S-1)/(S+1),at=O(1-Ke*Ke),dt=It(x,at*at),ht=o(y(_/4+p(Ve)/2)),Mt=i(-1*ht)/O(Ke),Wt=function(qt,tr){var lr=qt*qt,dr=tr+1,gr=1-lr-tr*tr;return[.5*((qt>=0?x:-x)-f(gr,2*qt)),-.25*o(gr*gr+4*lr)+.5*o(dr*dr+lr)]}(Mt*u(-1*Re),Mt*l(-1*Re)),Jt=function(qt,tr,lr){var dr=p(qt),gr=F(p(tr));if(dr){var Pr=1/l(dr),tn=1/(y(dr)*y(dr)),pn=-(tn+lr*(gr*gr*Pr*Pr)-1+lr),Sn=(-pn+O(pn*pn-4*((lr-1)*tn)))/2;return[It(e(1/O(Sn)),lr)*d(qt),It(e(O((Sn/tn-1)/lr)),1-lr)*d(tr)]}return[0,It(e(gr),1-lr)*d(tr)]}(Wt[0],Wt[1],at*at);return[-Jt[1],(Ve>=0?1:-1)*(.5*dt-Jt[0])]}function nt(Re){var Ve=l(Re),Ke=u(Re),at=At(Re);function dt(ht,Mt){var Wt=at(ht,Mt);ht=Wt[0],Mt=Wt[1];var Jt=l(Mt),qt=u(Mt),tr=u(ht),lr=P(Ve*Jt+Ke*qt*tr),dr=l(lr),gr=p(dr)>v?lr/dr:1;return[gr*Ke*l(ht),(p(ht)>x?gr:-gr)*(Ve*qt-Ke*Jt*tr)]}return at.invert=At(-Re),dt.invert=function(ht,Mt){var Wt=O(ht*ht+Mt*Mt),Jt=-l(Wt),qt=u(Wt),tr=Wt*qt,lr=-Mt*Jt,dr=Wt*Ve,gr=O(tr*tr+lr*lr-dr*dr),Pr=f(tr*dr+lr*gr,lr*dr-tr*gr),tn=(Wt>x?-1:1)*f(ht*Jt,Wt*u(Pr)*qt+Mt*l(Pr)*Jt);return at.invert(tn,Pr)},dt}function At(Re){var Ve=l(Re),Ke=u(Re);return function(at,dt){var ht=u(dt),Mt=u(at)*ht,Wt=l(at)*ht,Jt=l(dt);return[f(Wt,Mt*Ke-Jt*Ve),M(Jt*Ke+Mt*Ve)]}}Et.invert=function(Re,Ve){p(Re)>1&&(Re=2*d(Re)-Re),p(Ve)>1&&(Ve=2*d(Ve)-Ve);var Ke=d(Re),at=d(Ve),dt=-Ke*Re,ht=-at*Ve,Mt=ht/dt<1,Wt=function(lr,dr){for(var gr=0,Pr=1,tn=.5,pn=50;;){var Sn=tn*tn,In=O(tn),Un=M(1/O(1+Sn)),On=1-Sn+tn*(1+Sn)*Un,pa=(1-In)/On,_a=O(pa),Ra=pa*(1+Sn),Da=_a*(1-Sn),Fa=O(Ra-lr*lr),bi=dr+Da+tn*Fa;if(p(Pr-gr)<1e-12||--pn==0||bi===0)break;bi>0?gr=tn:Pr=tn,tn=.5*(gr+Pr)}if(!pn)return null;var gi=M(In),ai=u(gi),ii=1/ai,vi=2*In*ai,Ri=(-On*ai-(-3*tn+Un*(1+3*Sn))*vi*(1-In))/(On*On);return[_/4*(lr*(-2*ii*(.5*Ri/_a*(1-Sn)-2*tn*_a*vi)+-ii*vi*Fa)+-ii*(tn*(1+Sn)*Ri+pa*(1+3*Sn)*vi)*M(lr/O(Ra))),gi]}(Mt?ht:dt,Mt?dt:ht),Jt=Wt[0],qt=Wt[1],tr=u(qt);return Mt&&(Jt=-x-Jt),[Ke*(f(l(Jt)*tr,-l(qt))+_),at*M(u(Jt)*tr)]},vt.invert=function(Re,Ve){var Ke,at,dt,ht,Mt,Wt,Jt=(S-1)/(S+1),qt=O(1-Jt*Jt),tr=It(x,qt*qt),lr=(at=-Re,dt=qt*qt,(Ke=.5*tr-Ve)?(ht=mt(Ke,dt),at?(Wt=(Mt=mt(at,1-dt))[1]*Mt[1]+dt*ht[0]*ht[0]*Mt[0]*Mt[0],[[ht[0]*Mt[2]/Wt,ht[1]*ht[2]*Mt[0]*Mt[1]/Wt],[ht[1]*Mt[1]/Wt,-ht[0]*ht[2]*Mt[0]*Mt[2]/Wt],[ht[2]*Mt[1]*Mt[2]/Wt,-dt*ht[0]*ht[1]*Mt[0]/Wt]]):[[ht[0],0],[ht[1],0],[ht[2],0]]):[[0,(Mt=mt(at,1-dt))[0]/Mt[1]],[1/Mt[1],0],[Mt[2]/Mt[1],0]]),dr=function(gr,Pr){var tn=Pr[0]*Pr[0]+Pr[1]*Pr[1];return[(gr[0]*Pr[0]+gr[1]*Pr[1])/tn,(gr[1]*Pr[0]-gr[0]*Pr[1])/tn]}(lr[0],lr[1]);return[f(dr[1],dr[0])/-1,2*e(i(-.5*o(Jt*dr[0]*dr[0]+Jt*dr[1]*dr[1])))-x]};var Ft=M(1-1/3)*k,Nt=Oe(0);function Kt(Re){var Ve=Ft*C,Ke=De(_,Ve)[0]-De(-_,Ve)[0],at=Nt(0,Ve)[1],dt=De(0,Ve)[1],ht=w-dt,Mt=L/Re,Wt=4/L,Jt=at+ht*ht*4/L;function qt(tr,lr){var dr,gr=p(lr);if(gr>Ve){var Pr=c(Re-1,a(0,s((tr+_)/Mt)));(dr=De(tr+=_*(Re-1)/Re-Pr*Mt,gr))[0]=dr[0]*L/Ke-L*(Re-1)/(2*Re)+Pr*L/Re,dr[1]=at+4*(dr[1]-dt)*ht/L,lr<0&&(dr[1]=-dr[1])}else dr=Nt(tr,lr);return dr[0]*=Wt,dr[1]/=Jt,dr}return qt.invert=function(tr,lr){tr/=Wt;var dr=p(lr*=Jt);if(dr>at){var gr=c(Re-1,a(0,s((tr+_)/Mt)));tr=(tr+_*(Re-1)/Re-gr*Mt)*Ke/L;var Pr=De.invert(tr,.25*(dr-at)*L/ht+dt);return Pr[0]-=_*(Re-1)/Re-gr*Mt,lr<0&&(Pr[1]=-Pr[1]),Pr}return Nt.invert(tr,lr)},qt}function Ie(Re,Ve){return[Re,1&Ve?90-v:Ft]}function ot(Re,Ve){return[Re,1&Ve?-90+v:-Ft]}function bt(Re){return[Re[0]*(1-v),Re[1]]}function Pt(Re){var Ve,Ke=1+Re,at=M(l(1/Ke)),dt=2*O(_/(Ve=_+4*at*Ke)),ht=.5*dt*(Ke+O(Re*(2+Re))),Mt=Re*Re,Wt=Ke*Ke;function Jt(qt,tr){var lr,dr,gr=1-l(tr);if(gr&&gr<2){var Pr,tn=x-tr,pn=25;do{var Sn=l(tn),In=u(tn),Un=at+f(Sn,Ke-In),On=1+Wt-2*Ke*In;tn-=Pr=(tn-Mt*at-Ke*Sn+On*Un-.5*gr*Ve)/(2*Ke*Sn*Un)}while(p(Pr)>1e-12&&--pn>0);lr=dt*O(On),dr=qt*Un/_}else lr=dt*(Re+gr),dr=qt*at/_;return[lr*l(dr),ht-lr*u(dr)]}return Jt.invert=function(qt,tr){var lr=qt*qt+(tr-=ht)*tr,dr=(1+Wt-lr/(dt*dt))/(2*Ke),gr=P(dr),Pr=l(gr),tn=at+f(Pr,Ke-dr);return[M(qt/O(lr))*_/tn,M(1-2*(gr-Mt*at-Ke*Pr+(1+Wt-2*Ke*dr)*tn)/Ve)]},Jt}function Vt(Re,Ve){return Ve>-.7109889596207567?((Re=ae(Re,Ve))[1]+=.0528035274542,Re):ve(Re,Ve)}function nr(Re,Ve){return p(Ve)>.7109889596207567?((Re=ae(Re,Ve))[1]-=Ve>0?.0528035274542:-.0528035274542,Re):ve(Re,Ve)}function Yt(Re,Ve,Ke,at){var dt=O(4*_/(2*Ke+(1+Re-Ve/2)*l(2*Ke)+(Re+Ve)/2*l(4*Ke)+Ve/2*l(6*Ke))),ht=O(at*l(Ke)*O((1+Re*u(2*Ke)+Ve*u(4*Ke))/(1+Re+Ve))),Mt=Ke*Jt(1);function Wt(lr){return O(1+Re*u(2*lr)+Ve*u(4*lr))}function Jt(lr){var dr=lr*Ke;return(2*dr+(1+Re-Ve/2)*l(2*dr)+(Re+Ve)/2*l(4*dr)+Ve/2*l(6*dr))/Ke}function qt(lr){return Wt(lr)*l(lr)}var tr=function(lr,dr){var gr=Ke*ee(Jt,Mt*l(dr)/Ke,dr/_);isNaN(gr)&&(gr=Ke*d(dr));var Pr=dt*Wt(gr);return[Pr*ht*lr/_*u(gr),Pr/ht*l(gr)]};return tr.invert=function(lr,dr){var gr=ee(qt,dr*ht/dt);return[lr*_/(u(gr)*dt*ht*Wt(gr)),M(Ke*Jt(gr/Ke)/Mt)]},Ke===0&&(dt=O(at/_),(tr=function(lr,dr){return[lr*dt,l(dr)/dt]}).invert=function(lr,dr){return[lr/dt,M(dr*dt)]}),tr}function Xt(Re,Ve,Ke,at,dt){at===void 0&&(at=1e-8),dt===void 0&&(dt=20);var ht=Re(Ve),Mt=Re(.5*(Ve+Ke)),Wt=Re(Ke);return function Jt(qt,tr,lr,dr,gr,Pr,tn,pn,Sn,In,Un){if(Un.nanEncountered)return NaN;var On,pa,_a,Ra,Da,Fa,bi,gi,ai,ii;if(pa=qt(tr+.25*(On=lr-tr)),_a=qt(lr-.25*On),isNaN(pa))Un.nanEncountered=!0;else{if(!isNaN(_a))return ii=((Fa=(Ra=On*(dr+4*pa+gr)/12)+(Da=On*(gr+4*_a+Pr)/12))-tn)/15,In>Sn?(Un.maxDepthCount++,Fa+ii):Math.abs(ii)<pn?Fa+ii:(gi=Jt(qt,tr,bi=tr+.5*On,dr,pa,gr,Ra,.5*pn,Sn,In+1,Un),isNaN(gi)?(Un.nanEncountered=!0,NaN):(ai=Jt(qt,bi,lr,gr,_a,Pr,Da,.5*pn,Sn,In+1,Un),isNaN(ai)?(Un.nanEncountered=!0,NaN):gi+ai));Un.nanEncountered=!0}}(Re,Ve,Ke,ht,Mt,Wt,(ht+4*Mt+Wt)*(Ke-Ve)/6,at,dt,1,{maxDepthCount:0,nanEncountered:!1})}function ar(Re,Ve,Ke){function at(gr){return Re+(1-Re)*r(1-r(gr,Ve),1/Ve)}function dt(gr){return Xt(at,0,gr,1e-4)}for(var ht=1/dt(1),Mt=1e3,Wt=(1+1e-8)*ht,Jt=[],qt=0;qt<=Mt;qt++)Jt.push(dt(qt/Mt)*Wt);function tr(gr){var Pr=0,tn=Mt,pn=500;do Jt[pn]>gr?tn=pn:Pr=pn,pn=Pr+tn>>1;while(pn>Pr);var Sn=Jt[pn+1]-Jt[pn];return Sn&&(Sn=(gr-Jt[pn+1])/Sn),(pn+1+Sn)/Mt}var lr=2*tr(1)/_*ht/Ke,dr=function(gr,Pr){var tn=tr(p(l(Pr))),pn=at(tn)*gr;return tn/=lr,[pn,Pr>=0?tn:-tn]};return dr.invert=function(gr,Pr){var tn;return p(Pr*=lr)<1&&(tn=d(Pr)*M(dt(p(Pr))*ht)),[gr/at(p(Pr)),tn]},dr}function hr(Re,Ve){return p(Re[0]-Ve[0])<v&&p(Re[1]-Ve[1])<v}function mr(Re,Ve){for(var Ke,at,dt,ht=-1,Mt=Re.length,Wt=Re[0],Jt=[];++ht<Mt;){at=((Ke=Re[ht])[0]-Wt[0])/Ve,dt=(Ke[1]-Wt[1])/Ve;for(var qt=0;qt<Ve;++qt)Jt.push([Wt[0]+qt*at,Wt[1]+qt*dt]);Wt=Ke}return Jt.push(Ke),Jt}function sr(Re){var Ve,Ke,at,dt,ht,Mt,Wt,Jt=[],qt=Re[0].length;for(Wt=0;Wt<qt;++Wt)Ke=(Ve=Re[0][Wt])[0][0],at=Ve[0][1],dt=Ve[1][1],ht=Ve[2][0],Mt=Ve[2][1],Jt.push(mr([[Ke+v,at+v],[Ke+v,dt-v],[ht-v,dt-v],[ht-v,Mt+v]],30));for(Wt=Re[1].length-1;Wt>=0;--Wt)Ke=(Ve=Re[1][Wt])[0][0],at=Ve[0][1],dt=Ve[1][1],ht=Ve[2][0],Mt=Ve[2][1],Jt.push(mr([[ht-v,Mt-v],[ht-v,dt+v],[Ke+v,dt+v],[Ke+v,at-v]],30));return{type:"Polygon",coordinates:[g.merge(Jt)]}}function fr(Re,Ve,Ke){var at,dt;function ht(Jt,qt){for(var tr=qt<0?-1:1,lr=Ve[+(qt<0)],dr=0,gr=lr.length-1;dr<gr&&Jt>lr[dr][2][0];++dr);var Pr=Re(Jt-lr[dr][1][0],qt);return Pr[0]+=Re(lr[dr][1][0],tr*qt>tr*lr[dr][0][1]?lr[dr][0][1]:qt)[0],Pr}Ke?ht.invert=Ke(ht):Re.invert&&(ht.invert=function(Jt,qt){for(var tr=dt[+(qt<0)],lr=Ve[+(qt<0)],dr=0,gr=tr.length;dr<gr;++dr){var Pr=tr[dr];if(Pr[0][0]<=Jt&&Jt<Pr[1][0]&&Pr[0][1]<=qt&&qt<Pr[1][1]){var tn=Re.invert(Jt-Re(lr[dr][1][0],0)[0],qt);return tn[0]+=lr[dr][1][0],hr(ht(tn[0],tn[1]),[Jt,qt])?tn:null}}});var Mt=m.geoProjection(ht),Wt=Mt.stream;return Mt.stream=function(Jt){var qt=Mt.rotate(),tr=Wt(Jt),lr=(Mt.rotate([0,0]),Wt(Jt));return Mt.rotate(qt),tr.sphere=function(){m.geoStream(at,lr)},tr},Mt.lobes=function(Jt){return arguments.length?(at=sr(Jt),Ve=Jt.map(function(qt){return qt.map(function(tr){return[[tr[0][0]*C,tr[0][1]*C],[tr[1][0]*C,tr[1][1]*C],[tr[2][0]*C,tr[2][1]*C]]})}),dt=Ve.map(function(qt){return qt.map(function(tr){var lr,dr=Re(tr[0][0],tr[0][1])[0],gr=Re(tr[2][0],tr[2][1])[0],Pr=Re(tr[1][0],tr[0][1])[1],tn=Re(tr[1][0],tr[1][1])[1];return Pr>tn&&(lr=Pr,Pr=tn,tn=lr),[[dr,Pr],[gr,tn]]})}),Mt):Ve.map(function(qt){return qt.map(function(tr){return[[tr[0][0]*k,tr[0][1]*k],[tr[1][0]*k,tr[1][1]*k],[tr[2][0]*k,tr[2][1]*k]]})})},Ve!=null&&Mt.lobes(Ve),Mt}Vt.invert=function(Re,Ve){return Ve>-.7109889596207567?ae.invert(Re,Ve-.0528035274542):ve.invert(Re,Ve)},nr.invert=function(Re,Ve){return p(Ve)>.7109889596207567?ae.invert(Re,Ve+(Ve>0?.0528035274542:-.0528035274542)):ve.invert(Re,Ve)};var yr=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],zr=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],xr=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],Br=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]],Jr=[[[[-180,35],[-30,90],[0,35]],[[0,35],[30,90],[180,35]]],[[[-180,-10],[-102,-90],[-65,-10]],[[-65,-10],[5,-90],[77,-10]],[[77,-10],[103,-90],[180,-10]]]],fn=[[[[-180,0],[-110,90],[-40,0]],[[-40,0],[0,90],[40,0]],[[40,0],[110,90],[180,0]]],[[[-180,0],[-110,-90],[-40,0]],[[-40,0],[0,-90],[40,0]],[[40,0],[110,-90],[180,0]]]];function Cn(Re,Ve){return[3/L*Re*O(_*_/3-Ve*Ve),Ve]}function Pn(Re){function Ve(Ke,at){if(p(p(at)-x)<v)return[0,at<0?-2:2];var dt=l(at),ht=r((1+dt)/(1-dt),Re/2),Mt=.5*(ht+1/ht)+u(Ke*=Re);return[2*l(Ke)/Mt,(ht-1/ht)/Mt]}return Ve.invert=function(Ke,at){var dt=p(at);if(p(dt-2)<v)return Ke?null:[0,d(at)*x];if(dt>2)return null;var ht=(Ke/=2)*Ke,Mt=(at/=2)*at,Wt=2*at/(1+ht+Mt);return Wt=r((1+Wt)/(1-Wt),1/Re),[f(2*Ke,1-ht-Mt)/Re,M((Wt-1)/(Wt+1))]},Ve}Cn.invert=function(Re,Ve){return[L/3*Re/O(_*_/3-Ve*Ve),Ve]};var An=_/S;function rn(Re,Ve){return[Re*(1+O(u(Ve)))/2,Ve/(u(Ve/2)*u(Re/6))]}function Fr(Re,Ve){var Ke=Re*Re,at=Ve*Ve;return[Re*(.975534+at*(-.0143059*Ke-.119161+-.0547009*at)),Ve*(1.00384+Ke*(.0802894+-.02855*at+199025e-9*Ke)+at*(.0998909+-.0491032*at))]}function Lr(Re,Ve){return[l(Re)/u(Ve),y(Ve)*u(Re)]}function Qr(Re){var Ve=u(Re),Ke=y(T+Re/2);function at(dt,ht){var Mt=ht-Re,Wt=p(Mt)<v?dt*Ve:p(Wt=T+ht/2)<v||p(p(Wt)-x)<v?0:dt*Mt/o(y(Wt)/Ke);return[Wt,Mt]}return at.invert=function(dt,ht){var Mt,Wt=ht+Re;return[p(ht)<v?dt/Ve:p(Mt=T+Wt/2)<v||p(p(Mt)-x)<v?0:dt*o(y(Mt)/Ke)/ht,Wt]},at}function $r(Re,Ve){return[Re,1.25*o(y(T+.4*Ve))]}function Kr(Re){var Ve=Re.length-1;function Ke(at,dt){for(var ht,Mt=u(dt),Wt=2/(1+Mt*u(at)),Jt=Wt*Mt*l(at),qt=Wt*l(dt),tr=Ve,lr=Re[tr],dr=lr[0],gr=lr[1];--tr>=0;)dr=(lr=Re[tr])[0]+Jt*(ht=dr)-qt*gr,gr=lr[1]+Jt*gr+qt*ht;return[dr=Jt*(ht=dr)-qt*gr,gr=Jt*gr+qt*ht]}return Ke.invert=function(at,dt){var ht=20,Mt=at,Wt=dt;do{for(var Jt,qt=Ve,tr=Re[qt],lr=tr[0],dr=tr[1],gr=0,Pr=0;--qt>=0;)gr=lr+Mt*(Jt=gr)-Wt*Pr,Pr=dr+Mt*Pr+Wt*Jt,lr=(tr=Re[qt])[0]+Mt*(Jt=lr)-Wt*dr,dr=tr[1]+Mt*dr+Wt*Jt;var tn,pn,Sn=(gr=lr+Mt*(Jt=gr)-Wt*Pr)*gr+(Pr=dr+Mt*Pr+Wt*Jt)*Pr;Mt-=tn=((lr=Mt*(Jt=lr)-Wt*dr-at)*gr+(dr=Mt*dr+Wt*Jt-dt)*Pr)/Sn,Wt-=pn=(dr*gr-lr*Pr)/Sn}while(p(tn)+p(pn)>1e-12&&--ht>0);if(ht){var In=O(Mt*Mt+Wt*Wt),Un=2*e(.5*In),On=l(Un);return[f(Mt*On,In*u(Un)),In?M(Wt*On/In):0]}},Ke}rn.invert=function(Re,Ve){var Ke=p(Re),at=p(Ve),dt=v,ht=x;at<An?ht*=at/An:dt+=6*P(An/at);for(var Mt=0;Mt<25;Mt++){var Wt=l(ht),Jt=O(u(ht)),qt=l(ht/2),tr=u(ht/2),lr=l(dt/6),dr=u(dt/6),gr=.5*dt*(1+Jt)-Ke,Pr=ht/(tr*dr)-at,tn=Jt?-.25*dt*Wt/Jt:0,pn=.5*(1+Jt),Sn=(1+.5*ht*qt/tr)/(tr*dr),In=ht/tr*(lr/6)/(dr*dr),Un=tn*In-Sn*pn,On=(gr*In-Pr*pn)/Un,pa=(Pr*tn-gr*Sn)/Un;if(ht-=On,dt-=pa,p(On)<v&&p(pa)<v)break}return[Re<0?-dt:dt,Ve<0?-ht:ht]},Fr.invert=function(Re,Ve){var Ke=d(Re)*_,at=Ve/2,dt=50;do{var ht=Ke*Ke,Mt=at*at,Wt=Ke*at,Jt=Ke*(.975534+Mt*(-.0143059*ht-.119161+-.0547009*Mt))-Re,qt=at*(1.00384+ht*(.0802894+-.02855*Mt+199025e-9*ht)+Mt*(.0998909+-.0491032*Mt))-Ve,tr=.975534-Mt*(.119161+3*ht*.0143059+.0547009*Mt),lr=-Wt*(.238322+.2188036*Mt+.0286118*ht),dr=Wt*(.1605788+7961e-7*ht+-.0571*Mt),gr=1.00384+ht*(.0802894+199025e-9*ht)+Mt*(3*(.0998909-.02855*ht)-.245516*Mt),Pr=lr*dr-gr*tr,tn=(qt*lr-Jt*gr)/Pr,pn=(Jt*dr-qt*tr)/Pr;Ke-=tn,at-=pn}while((p(tn)>v||p(pn)>v)&&--dt>0);return dt&&[Ke,at]},Lr.invert=function(Re,Ve){var Ke=Re*Re,at=Ve*Ve+1,dt=Ke+at,ht=Re?A*O((dt-O(dt*dt-4*Ke))/Ke):1/O(at);return[M(Re*ht),d(Ve)*P(ht)]},$r.invert=function(Re,Ve){return[Re,2.5*e(i(.8*Ve))-.625*_]};var en=[[.9972523,0],[.0052513,-.0041175],[.0074606,.0048125],[-.0153783,-.1968253],[.0636871,-.1408027],[.3660976,-.2937382]],Tn=[[.98879,0],[0,0],[-.050909,0],[0,0],[.075528,0]],Mn=[[.984299,0],[.0211642,.0037608],[-.1036018,-.0575102],[-.0329095,-.0320119],[.0499471,.1223335],[.026046,.0899805],[7388e-7,-.1435792],[.0075848,-.1334108],[-.0216473,.0776645],[-.0225161,.0853673]],Rn=[[.9245,0],[0,0],[.01943,0]],Zt=[[.721316,0],[0,0],[-.00881625,-.00617325]];function Ct(Re,Ve){var Ke=m.geoProjection(Kr(Re)).rotate(Ve).clipAngle(90),at=m.geoRotation(Ve),dt=Ke.center;return delete Ke.rotate,Ke.center=function(ht){return arguments.length?dt(at(ht)):at.invert(dt())},Ke}var Ht=O(6),cr=O(7);function _r(Re,Ve){var Ke=M(7*l(Ve)/(3*Ht));return[Ht*Re*(2*u(2*Ke/3)-1)/cr,9*l(Ke/3)/cr]}function Vr(Re,Ve){for(var Ke,at=(1+A)*l(Ve),dt=Ve,ht=0;ht<25&&(dt-=Ke=(l(dt/2)+l(dt)-at)/(.5*u(dt/2)+u(dt)),!(p(Ke)<v));ht++);return[Re*(1+2*u(dt)/u(dt/2))/(3*S),2*O(3)*l(dt/2)/O(2+S)]}function jr(Re,Ve){for(var Ke,at=O(6/(4+_)),dt=(1+_/4)*l(Ve),ht=Ve/2,Mt=0;Mt<25&&(ht-=Ke=(ht/2+l(ht)-dt)/(.5+u(ht)),!(p(Ke)<v));Mt++);return[at*(.5+u(ht))*Re/1.5,at*ht]}function vr(Re,Ve){var Ke=Ve*Ve,at=Ke*Ke,dt=Ke*at;return[Re*(.84719-.13063*Ke+dt*dt*(.05494*Ke-.04515-.02326*at+.00331*dt)),Ve*(1.01183+at*at*(.01926*Ke-.02625-.00396*at))]}function br(Re,Ve){return[Re*(1+u(Ve))/2,2*(Ve-y(Ve/2))]}_r.invert=function(Re,Ve){var Ke=3*M(Ve*cr/9);return[Re*cr/(Ht*(2*u(2*Ke/3)-1)),M(3*l(Ke)*Ht/7)]},Vr.invert=function(Re,Ve){var Ke=Ve*O(2+S)/(2*O(3)),at=2*M(Ke);return[3*S*Re/(1+2*u(at)/u(at/2)),M((Ke+l(at))/(1+A))]},jr.invert=function(Re,Ve){var Ke=O(6/(4+_)),at=Ve/Ke;return p(p(at)-x)<v&&(at=at<0?-x:x),[1.5*Re/(Ke*(.5+u(at))),M((at/2+l(at))/(1+_/4))]},vr.invert=function(Re,Ve){var Ke,at,dt,ht,Mt=Ve,Wt=25;do Mt-=Ke=(Mt*(1.01183+(dt=(at=Mt*Mt)*at)*dt*(.01926*at-.02625-.00396*dt))-Ve)/(1.01183+dt*dt*(.21186*at-.23625+-.05148*dt));while(p(Ke)>1e-12&&--Wt>0);return[Re/(.84719-.13063*(at=Mt*Mt)+(ht=at*(dt=at*at))*ht*(.05494*at-.04515-.02326*dt+.00331*ht)),Mt]},br.invert=function(Re,Ve){for(var Ke=Ve/2,at=0,dt=1/0;at<10&&p(dt)>v;++at){var ht=u(Ve/2);Ve-=dt=(Ve-y(Ve/2)-Ke)/(1-.5/(ht*ht))}return[2*Re/(1+u(Ve)),Ve]};var Ar=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]];function kr(Re,Ve){var Ke=l(Ve),at=u(Ve),dt=d(Re);if(Re===0||p(Ve)===x)return[0,Ve];if(Ve===0)return[Re,0];if(p(Re)===x)return[Re*at,x*Ke];var ht=_/(2*Re)-2*Re/_,Mt=2*Ve/_,Wt=(1-Mt*Mt)/(Ke-Mt),Jt=ht*ht,qt=Wt*Wt,tr=1+Jt/qt,lr=1+qt/Jt,dr=(ht*Ke/Wt-ht/2)/tr,gr=(qt*Ke/Jt+Wt/2)/lr,Pr=gr*gr-(qt*Ke*Ke/Jt+Wt*Ke-1)/lr;return[x*(dr+O(dr*dr+at*at/tr)*dt),x*(gr+O(Pr<0?0:Pr)*d(-Ve*ht)*dt)]}kr.invert=function(Re,Ve){var Ke=(Re/=x)*Re,at=Ke+(Ve/=x)*Ve,dt=_*_;return[Re?(at-1+O((1-at)*(1-at)+4*Ke))/(2*Re)*x:0,ee(function(ht){return at*(_*l(ht)-2*ht)*_+4*ht*ht*(Ve-l(ht))+2*_*ht-dt*Ve},0)]};function Cr(Re,Ve){var Ke=Ve*Ve;return[Re,Ve*(1.0148+Ke*Ke*(.23185+Ke*(.02406*Ke-.14499)))]}function Hr(Re,Ve){if(p(Ve)<v)return[Re,0];var Ke=y(Ve),at=Re*l(Ve);return[l(at)/Ke,Ve+(1-u(at))/Ke]}function ln(Re,Ve){var Ke=Zr(Re[1],Re[0]),at=Zr(Ve[1],Ve[0]),dt=function(Mt,Wt){return f(Mt[0]*Wt[1]-Mt[1]*Wt[0],Mt[0]*Wt[0]+Mt[1]*Wt[1])}(Ke,at),ht=yn(Ke)/yn(at);return xn([1,0,Re[0][0],0,1,Re[0][1]],xn([ht,0,0,0,ht,0],xn([u(dt),l(dt),0,-l(dt),u(dt),0],[1,0,-Ve[0][0],0,1,-Ve[0][1]])))}function xn(Re,Ve){return[Re[0]*Ve[0]+Re[1]*Ve[3],Re[0]*Ve[1]+Re[1]*Ve[4],Re[0]*Ve[2]+Re[1]*Ve[5]+Re[2],Re[3]*Ve[0]+Re[4]*Ve[3],Re[3]*Ve[1]+Re[4]*Ve[4],Re[3]*Ve[2]+Re[4]*Ve[5]+Re[5]]}function Zr(Re,Ve){return[Re[0]-Ve[0],Re[1]-Ve[1]]}function yn(Re){return O(Re[0]*Re[0]+Re[1]*Re[1])}function Ir(Re,Ve,Ke){function at(Mt,Wt){var Jt,qt=Ve(Mt,Wt),tr=qt.project([Mt*k,Wt*k]);return(Jt=qt.transform)?[Jt[0]*tr[0]+Jt[1]*tr[1]+Jt[2],-(Jt[3]*tr[0]+Jt[4]*tr[1]+Jt[5])]:(tr[1]=-tr[1],tr)}(function Mt(Wt,Jt){if(Wt.edges=function(Pr){for(var tn=Pr.length,pn=[],Sn=Pr[tn-1],In=0;In<tn;++In)pn.push([Sn,Sn=Pr[In]]);return pn}(Wt.face),Jt.face){var qt=Wt.shared=function(Pr,tn){for(var pn,Sn,In=Pr.length,Un=null,On=0;On<In;++On){pn=Pr[On];for(var pa=tn.length;--pa>=0;)if(Sn=tn[pa],pn[0]===Sn[0]&&pn[1]===Sn[1]){if(Un)return[Un,pn];Un=pn}}}(Wt.face,Jt.face),tr=ln(qt.map(Jt.project),qt.map(Wt.project));Wt.transform=Jt.transform?xn(Jt.transform,tr):tr;for(var lr=Jt.edges,dr=0,gr=lr.length;dr<gr;++dr)Gr(qt[0],lr[dr][1])&&Gr(qt[1],lr[dr][0])&&(lr[dr]=Wt),Gr(qt[0],lr[dr][0])&&Gr(qt[1],lr[dr][1])&&(lr[dr]=Wt);for(lr=Wt.edges,dr=0,gr=lr.length;dr<gr;++dr)Gr(qt[0],lr[dr][0])&&Gr(qt[1],lr[dr][1])&&(lr[dr]=Jt),Gr(qt[0],lr[dr][1])&&Gr(qt[1],lr[dr][0])&&(lr[dr]=Jt)}else Wt.transform=Jt.transform;return Wt.children&&Wt.children.forEach(function(Pr){Mt(Pr,Wt)}),Wt})(Re,{transform:null}),mn(Re)&&(at.invert=function(Mt,Wt){var Jt=function qt(tr,lr){var dr=tr.project.invert,gr=tr.transform,Pr=lr;if(gr&&(gr=function(Un){var On=1/(Un[0]*Un[4]-Un[1]*Un[3]);return[On*Un[4],-On*Un[1],On*(Un[1]*Un[5]-Un[2]*Un[4]),-On*Un[3],On*Un[0],On*(Un[2]*Un[3]-Un[0]*Un[5])]}(gr),Pr=[gr[0]*Pr[0]+gr[1]*Pr[1]+gr[2],gr[3]*Pr[0]+gr[4]*Pr[1]+gr[5]]),dr&&tr===function(Un){return Ve(Un[0]*C,Un[1]*C)}(tn=dr(Pr)))return tn;for(var tn,pn=tr.children,Sn=0,In=pn&&pn.length;Sn<In;++Sn)if(tn=qt(pn[Sn],lr))return tn}(Re,[Mt,-Wt]);return Jt&&(Jt[0]*=C,Jt[1]*=C,Jt)});var dt=m.geoProjection(at),ht=dt.stream;return dt.stream=function(Mt){var Wt=dt.rotate(),Jt=ht(Mt),qt=(dt.rotate([0,0]),ht(Mt));return dt.rotate(Wt),Jt.sphere=function(){qt.polygonStart(),qt.lineStart(),function tr(lr,dr,gr){var Pr,tn,pn=dr.edges,Sn=pn.length,In={type:"MultiPoint",coordinates:dr.face},Un=dr.face.filter(function(bi){return p(bi[1])!==90}),On=m.geoBounds({type:"MultiPoint",coordinates:Un}),pa=!1,_a=-1,Ra=On[1][0]-On[0][0],Da=Ra===180||Ra===360?[(On[0][0]+On[1][0])/2,(On[0][1]+On[1][1])/2]:m.geoCentroid(In);if(gr)for(;++_a<Sn&&pn[_a]!==gr;);++_a;for(var Fa=0;Fa<Sn;++Fa)tn=pn[(Fa+_a)%Sn],Array.isArray(tn)?(pa||(lr.point((Pr=m.geoInterpolate(tn[0],Da)(v))[0],Pr[1]),pa=!0),lr.point((Pr=m.geoInterpolate(tn[1],Da)(v))[0],Pr[1])):(pa=!1,tn!==gr&&tr(lr,tn,dr))}(qt,Re),qt.lineEnd(),qt.polygonEnd()},Jt},dt.angle(Ke==null?-30:Ke*k)}function Gr(Re,Ve){return Re&&Ve&&Re[0]===Ve[0]&&Re[1]===Ve[1]}function mn(Re){return Re.project.invert||Re.children&&Re.children.some(mn)}Cr.invert=function(Re,Ve){Ve>1.790857183?Ve=1.790857183:Ve<-1.790857183&&(Ve=-1.790857183);var Ke,at=Ve;do{var dt=at*at;at-=Ke=(at*(1.0148+dt*dt*(.23185+dt*(.02406*dt-.14499)))-Ve)/(1.0148+dt*dt*(5*.23185+dt*(.21654*dt-1.01493)))}while(p(Ke)>v);return[Re,at]},Hr.invert=function(Re,Ve){if(p(Ve)<v)return[Re,0];var Ke,at=Re*Re+Ve*Ve,dt=.5*Ve,ht=10;do{var Mt=y(dt),Wt=1/u(dt),Jt=at-2*Ve*dt+dt*dt;dt-=Ke=(Mt*Jt+2*(dt-Ve))/(2+Jt*Wt*Wt+2*(dt-Ve)*Mt)}while(p(Ke)>v&&--ht>0);return Mt=y(dt),[(p(Ve)<p(dt+1/Mt)?M(Re*Mt):d(Ve)*d(Re)*(P(p(Re*Mt))+x))/l(dt),dt]};var hn=[[0,90],[-90,0],[0,0],[90,0],[180,0],[0,-90]],Ln=[[0,2,1],[0,3,2],[5,1,2],[5,2,3],[0,1,4],[0,4,3],[5,4,1],[5,3,4]].map(function(Re){return Re.map(function(Ve){return hn[Ve]})}),ia=2/O(3);function qn(Re,Ve){var Ke=De(Re,Ve);return[Ke[0]*ia,Ke[1]]}function gn(Re,Ve){for(var Ke=0,at=Re.length,dt=0;Ke<at;++Ke)dt+=Re[Ke]*Ve[Ke];return dt}function ta(Re){return[f(Re[1],Re[0])*k,M(a(-1,c(1,Re[2])))*k]}function fa(Re){var Ve=Re[0]*C,Ke=Re[1]*C,at=u(Ke);return[at*u(Ve),at*l(Ve),l(Ke)]}function Za(){}function Pi(Re,Ve){return{type:"FeatureCollection",features:Re.features.map(function(Ke){return ni(Ke,Ve)})}}function ni(Re,Ve){return{type:"Feature",id:Re.id,properties:Re.properties,geometry:yi(Re.geometry,Ve)}}function yi(Re,Ve){if(!Re)return null;if(Re.type==="GeometryCollection")return function(at,dt){return{type:"GeometryCollection",geometries:at.geometries.map(function(ht){return yi(ht,dt)})}}(Re,Ve);var Ke;switch(Re.type){case"Point":case"MultiPoint":Ke=co;break;case"LineString":case"MultiLineString":Ke=Bo;break;case"Polygon":case"MultiPolygon":case"Sphere":Ke=Wo;break;default:return null}return m.geoStream(Re,Ve(Ke)),Ke.result()}qn.invert=function(Re,Ve){return De.invert(Re/ia,Ve)};var Aa=[],ja=[],co={point:function(Re,Ve){Aa.push([Re,Ve])},result:function(){var Re=Aa.length?Aa.length<2?{type:"Point",coordinates:Aa[0]}:{type:"MultiPoint",coordinates:Aa}:null;return Aa=[],Re}},Bo={lineStart:Za,point:function(Re,Ve){Aa.push([Re,Ve])},lineEnd:function(){Aa.length&&(ja.push(Aa),Aa=[])},result:function(){var Re=ja.length?ja.length<2?{type:"LineString",coordinates:ja[0]}:{type:"MultiLineString",coordinates:ja}:null;return ja=[],Re}},Wo={polygonStart:Za,lineStart:Za,point:function(Re,Ve){Aa.push([Re,Ve])},lineEnd:function(){var Re=Aa.length;if(Re){do Aa.push(Aa[0].slice());while(++Re<4);ja.push(Aa),Aa=[]}},polygonEnd:Za,result:function(){if(!ja.length)return null;var Re=[],Ve=[];return ja.forEach(function(Ke){(function(at){if((dt=at.length)<4)return!1;for(var dt,ht=0,Mt=at[dt-1][1]*at[0][0]-at[dt-1][0]*at[0][1];++ht<dt;)Mt+=at[ht-1][1]*at[ht][0]-at[ht-1][0]*at[ht][1];return Mt<=0})(Ke)?Re.push([Ke]):Ve.push(Ke)}),Ve.forEach(function(Ke){var at=Ke[0];Re.some(function(dt){if(function(ht,Mt){for(var Wt=Mt[0],Jt=Mt[1],qt=!1,tr=0,lr=ht.length,dr=lr-1;tr<lr;dr=tr++){var gr=ht[tr],Pr=gr[0],tn=gr[1],pn=ht[dr],Sn=pn[0],In=pn[1];tn>Jt^In>Jt&&Wt<(Sn-Pr)*(Jt-tn)/(In-tn)+Pr&&(qt=!qt)}return qt}(dt[0],at))return dt.push(Ke),!0})||Re.push([Ke])}),ja=[],Re.length?Re.length>1?{type:"MultiPolygon",coordinates:Re}:{type:"Polygon",coordinates:Re[0]}:null}};function qi(Re){var Ve=Re(x,0)[0]-Re(-x,0)[0];function Ke(at,dt){var ht=p(at)<x,Mt=Re(ht?at:at>0?at-_:at+_,dt),Wt=(Mt[0]-Mt[1])*A,Jt=(Mt[0]+Mt[1])*A;if(ht)return[Wt,Jt];var qt=Ve*A,tr=Wt>0^Jt>0?-1:1;return[tr*Wt-d(Jt)*qt,tr*Jt-d(Wt)*qt]}return Re.invert&&(Ke.invert=function(at,dt){var ht=(at+dt)*A,Mt=(dt-at)*A,Wt=p(ht)<.5*Ve&&p(Mt)<.5*Ve;if(!Wt){var Jt=Ve*A,qt=ht>0^Mt>0?-1:1,tr=-qt*at+(Mt>0?1:-1)*Jt,lr=-qt*dt+(ht>0?1:-1)*Jt;ht=(-tr-lr)*A,Mt=(tr-lr)*A}var dr=Re.invert(ht,Mt);return Wt||(dr[0]+=ht>0?_:-_),dr}),m.geoProjection(Ke).rotate([-90,-90,45]).clipAngle(179.999)}function Wi(){return qi(vt).scale(111.48)}function No(Re){var Ve=l(Re);function Ke(at,dt){var ht=Ve?y(at*Ve/2)/Ve:at/2;if(!dt)return[2*ht,-Re];var Mt=2*e(ht*l(dt)),Wt=1/y(dt);return[l(Mt)*Wt,dt+(1-u(Mt))*Wt-Re]}return Ke.invert=function(at,dt){if(p(dt+=Re)<v)return[Ve?2*e(Ve*at/2)/Ve:at,0];var ht,Mt=at*at+dt*dt,Wt=0,Jt=10;do{var qt=y(Wt),tr=1/u(Wt),lr=Mt-2*dt*Wt+Wt*Wt;Wt-=ht=(qt*lr+2*(Wt-dt))/(2+lr*tr*tr+2*(Wt-dt)*qt)}while(p(ht)>v&&--Jt>0);var dr=at*(qt=y(Wt)),gr=y(p(dt)<p(Wt+1/qt)?.5*M(dr):.5*P(dr)+_/4)/l(Wt);return[Ve?2*e(Ve*gr)/Ve:2*gr,Wt]},Ke}var Ha=[[.9986,-.062],[1,0],[.9986,.062],[.9954,.124],[.99,.186],[.9822,.248],[.973,.31],[.96,.372],[.9427,.434],[.9216,.4958],[.8962,.5571],[.8679,.6176],[.835,.6769],[.7986,.7346],[.7597,.7903],[.7186,.8435],[.6732,.8936],[.6213,.9394],[.5722,.9761],[.5322,1]];function ko(Re,Ve){var Ke,at=c(18,36*p(Ve)/_),dt=s(at),ht=at-dt,Mt=(Ke=Ha[dt])[0],Wt=Ke[1],Jt=(Ke=Ha[++dt])[0],qt=Ke[1],tr=(Ke=Ha[c(19,++dt)])[0],lr=Ke[1];return[Re*(Jt+ht*(tr-Mt)/2+ht*ht*(tr-2*Jt+Mt)/2),(Ve>0?x:-x)*(qt+ht*(lr-Wt)/2+ht*ht*(lr-2*qt+Wt)/2)]}function uo(Re,Ve){var Ke=function(Mt){function Wt(Jt,qt){var tr=u(qt),lr=(Mt-1)/(Mt-tr*u(Jt));return[lr*tr*l(Jt),lr*l(qt)]}return Wt.invert=function(Jt,qt){var tr=Jt*Jt+qt*qt,lr=O(tr),dr=(Mt-O(1-tr*(Mt+1)/(Mt-1)))/((Mt-1)/lr+lr/(Mt-1));return[f(Jt*dr,lr*O(1-dr*dr)),lr?M(qt*dr/lr):0]},Wt}(Re);if(!Ve)return Ke;var at=u(Ve),dt=l(Ve);function ht(Mt,Wt){var Jt=Ke(Mt,Wt),qt=Jt[1],tr=qt*dt/(Re-1)+at;return[Jt[0]*at/tr,qt/tr]}return ht.invert=function(Mt,Wt){var Jt=(Re-1)/(Re-1-Wt*dt);return Ke.invert(Jt*Mt,Jt*Wt*at)},ht}Ha.forEach(function(Re){Re[1]*=1.0144}),ko.invert=function(Re,Ve){var Ke=Ve/x,at=90*Ke,dt=c(18,p(at/5)),ht=a(0,s(dt));do{var Mt=Ha[ht][1],Wt=Ha[ht+1][1],Jt=Ha[c(19,ht+2)][1],qt=Jt-Mt,tr=Jt-2*Wt+Mt,lr=2*(p(Ke)-Wt)/qt,dr=tr/qt,gr=lr*(1-dr*lr*(1-2*dr*lr));if(gr>=0||ht===1){at=(Ve>=0?5:-5)*(gr+dt);var Pr,tn=50;do gr=(dt=c(18,p(at)/5))-(ht=s(dt)),Mt=Ha[ht][1],Wt=Ha[ht+1][1],Jt=Ha[c(19,ht+2)][1],at-=(Pr=(Ve>=0?x:-x)*(Wt+gr*(Jt-Mt)/2+gr*gr*(Jt-2*Wt+Mt)/2)-Ve)*k;while(p(Pr)>1e-12&&--tn>0);break}}while(--ht>=0);var pn=Ha[ht][0],Sn=Ha[ht+1][0],In=Ha[c(19,ht+2)][0];return[Re/(Sn+gr*(In-pn)/2+gr*gr*(In-2*Sn+pn)/2),at*C]};var xi=-179.9999,Xi=179.9999,fo=-89.9999;function _o(Re){return Re.length>0}function Di(Re){return Re===-90||Re===90?[0,Re]:[-180,(Ve=Re,Math.floor(1e4*Ve)/1e4)];var Ve}function fi(Re){var Ve=Re[0],Ke=Re[1],at=!1;return Ve<=xi?(Ve=-180,at=!0):Ve>=Xi&&(Ve=180,at=!0),Ke<=fo?(Ke=-90,at=!0):Ke>=89.9999&&(Ke=90,at=!0),at?[Ve,Ke]:Re}function Gi(Re){return Re.map(fi)}function ys(Re,Ve,Ke){for(var at=0,dt=Re.length;at<dt;++at){var ht=Re[at].slice();Ke.push({index:-1,polygon:Ve,ring:ht});for(var Mt=0,Wt=ht.length;Mt<Wt;++Mt){var Jt=ht[Mt],qt=Jt[0],tr=Jt[1];if(qt<=xi||qt>=Xi||tr<=fo||tr>=89.9999){ht[Mt]=fi(Jt);for(var lr=Mt+1;lr<Wt;++lr){var dr=ht[lr],gr=dr[0],Pr=dr[1];if(gr>xi&&gr<Xi&&Pr>fo&&Pr<89.9999)break}if(lr===Mt+1)continue;if(Mt){var tn={index:-1,polygon:Ve,ring:ht.slice(0,Mt+1)};tn.ring[tn.ring.length-1]=Di(tr),Ke[Ke.length-1]=tn}else Ke.pop();if(lr>=Wt)break;Ke.push({index:-1,polygon:Ve,ring:ht=ht.slice(lr-1)}),ht[0]=Di(ht[0][1]),Mt=-1,Wt=ht.length}}}}function ws(Re){var Ve,Ke,at,dt,ht,Mt,Wt=Re.length,Jt={},qt={};for(Ve=0;Ve<Wt;++Ve)at=(Ke=Re[Ve]).ring[0],ht=Ke.ring[Ke.ring.length-1],at[0]!==ht[0]||at[1]!==ht[1]?(Ke.index=Ve,Jt[at]=qt[ht]=Ke):(Ke.polygon.push(Ke.ring),Re[Ve]=null);for(Ve=0;Ve<Wt;++Ve)if(Ke=Re[Ve]){if(at=Ke.ring[0],ht=Ke.ring[Ke.ring.length-1],dt=qt[at],Mt=Jt[ht],delete Jt[at],delete qt[ht],at[0]===ht[0]&&at[1]===ht[1]){Ke.polygon.push(Ke.ring);continue}dt?(delete qt[at],delete Jt[dt.ring[0]],dt.ring.pop(),Re[dt.index]=null,Ke={index:-1,polygon:dt.polygon,ring:dt.ring.concat(Ke.ring)},dt===Mt?Ke.polygon.push(Ke.ring):(Ke.index=Wt++,Re.push(Jt[Ke.ring[0]]=qt[Ke.ring[Ke.ring.length-1]]=Ke))):Mt?(delete Jt[ht],delete qt[Mt.ring[Mt.ring.length-1]],Ke.ring.pop(),Ke={index:Wt++,polygon:Mt.polygon,ring:Ke.ring.concat(Mt.ring)},Re[Mt.index]=null,Re.push(Jt[Ke.ring[0]]=qt[Ke.ring[Ke.ring.length-1]]=Ke)):(Ke.ring.push(Ke.ring[0]),Ke.polygon.push(Ke.ring))}}function qa(Re){var Ve={type:"Feature",geometry:hs(Re.geometry)};return Re.id!=null&&(Ve.id=Re.id),Re.bbox!=null&&(Ve.bbox=Re.bbox),Re.properties!=null&&(Ve.properties=Re.properties),Ve}function hs(Re){if(Re==null)return Re;var Ve,Ke,at,dt;switch(Re.type){case"GeometryCollection":Ve={type:"GeometryCollection",geometries:Re.geometries.map(hs)};break;case"Point":Ve={type:"Point",coordinates:fi(Re.coordinates)};break;case"MultiPoint":case"LineString":Ve={type:Re.type,coordinates:Gi(Re.coordinates)};break;case"MultiLineString":Ve={type:"MultiLineString",coordinates:Re.coordinates.map(Gi)};break;case"Polygon":var ht=[];ys(Re.coordinates,ht,Ke=[]),ws(Ke),Ve={type:"Polygon",coordinates:ht};break;case"MultiPolygon":Ke=[],at=-1,dt=Re.coordinates.length;for(var Mt=new Array(dt);++at<dt;)ys(Re.coordinates[at],Mt[at]=[],Ke);ws(Ke),Ve={type:"MultiPolygon",coordinates:Mt.filter(_o)};break;default:return Re}return Re.bbox!=null&&(Ve.bbox=Re.bbox),Ve}function Qo(Re,Ve){var Ke=y(Ve/2),at=l(T*Ke);return[Re*(.74482-.34588*at*at),1.70711*Ke]}function Ts(Re,Ve,Ke){var at=m.geoInterpolate(Ve,Ke),dt=at(.5),ht=m.geoRotation([-dt[0],-dt[1]])(Ve),Mt=at.distance/2,Wt=-M(l(ht[1]*C)/l(Mt)),Jt=[-dt[0],-dt[1],-(ht[0]>0?_-Wt:Wt)*k],qt=m.geoProjection(Re(Mt)).rotate(Jt),tr=m.geoRotation(Jt),lr=qt.center;return delete qt.rotate,qt.center=function(dr){return arguments.length?lr(tr(dr)):tr.invert(lr())},qt.clipAngle(90)}function ks(Re){var Ve=u(Re);function Ke(at,dt){var ht=m.geoGnomonicRaw(at,dt);return ht[0]*=Ve,ht}return Ke.invert=function(at,dt){return m.geoGnomonicRaw.invert(at/Ve,dt)},Ke}function xs(Re,Ve){return Ts(ks,Re,Ve)}function As(Re){if(!(Re*=2))return m.geoAzimuthalEquidistantRaw;var Ve=-Re/2,Ke=-Ve,at=Re*Re,dt=y(Ke),ht=.5/l(Ke);function Mt(Wt,Jt){var qt=P(u(Jt)*u(Wt-Ve)),tr=P(u(Jt)*u(Wt-Ke));return[((qt*=qt)-(tr*=tr))/(2*Re),(Jt<0?-1:1)*O(4*at*tr-(at-qt+tr)*(at-qt+tr))/(2*Re)]}return Mt.invert=function(Wt,Jt){var qt,tr,lr=Jt*Jt,dr=u(O(lr+(qt=Wt+Ve)*qt)),gr=u(O(lr+(qt=Wt+Ke)*qt));return[f(tr=dr-gr,qt=(dr+gr)*dt),(Jt<0?-1:1)*P(O(qt*qt+tr*tr)*ht)]},Mt}function Ao(Re,Ve){return Ts(As,Re,Ve)}function Mo(Re,Ve){if(p(Ve)<v)return[Re,0];var Ke=p(Ve/x),at=M(Ke);if(p(Re)<v||p(p(Ve)-x)<v)return[0,d(Ve)*_*y(at/2)];var dt=u(at),ht=p(_/Re-Re/_)/2,Mt=ht*ht,Wt=dt/(Ke+dt-1),Jt=Wt*(2/Ke-1),qt=Jt*Jt,tr=qt+Mt,lr=Wt-qt,dr=Mt+Wt;return[d(Re)*_*(ht*lr+O(Mt*lr*lr-tr*(Wt*Wt-qt)))/tr,d(Ve)*_*(Jt*dr-ht*O((Mt+1)*tr-dr*dr))/tr]}function jo(Re,Ve){if(p(Ve)<v)return[Re,0];var Ke=p(Ve/x),at=M(Ke);if(p(Re)<v||p(p(Ve)-x)<v)return[0,d(Ve)*_*y(at/2)];var dt=u(at),ht=p(_/Re-Re/_)/2,Mt=ht*ht,Wt=dt*(O(1+Mt)-ht*dt)/(1+Mt*Ke*Ke);return[d(Re)*_*Wt,d(Ve)*_*O(1-Wt*(2*ht+Wt))]}function Uo(Re,Ve){if(p(Ve)<v)return[Re,0];var Ke=Ve/x,at=M(Ke);if(p(Re)<v||p(p(Ve)-x)<v)return[0,_*y(at/2)];var dt=(_/Re-Re/_)/2,ht=Ke/(1+u(at));return[_*(d(Re)*O(dt*dt+1-ht*ht)-dt),_*ht]}function Vo(Re,Ve){if(!Ve)return[Re,0];var Ke=p(Ve);if(!Re||Ke===x)return[0,Ve];var at=Ke/x,dt=at*at,ht=(8*at-dt*(dt+2)-5)/(2*dt*(at-1)),Mt=ht*ht,Wt=at*ht,Jt=dt+Mt+2*Wt,qt=at+3*ht,tr=Re/x,lr=tr+1/tr,dr=d(p(Re)-x)*O(lr*lr-4),gr=dr*dr,Pr=(dr*(Jt+Mt-1)+2*O(Jt*(dt+Mt*gr-1)+(1-dt)*(dt*(qt*qt+4*Mt)+12*Wt*Mt+4*Mt*Mt)))/(4*Jt+gr);return[d(Re)*x*Pr,d(Ve)*x*O(1+dr*p(Pr)-Pr*Pr)]}function $o(Re,Ve,Ke,at){var dt=_/3;Re=a(Re,v),Ve=a(Ve,v),Re=c(Re,x),Ve=c(Ve,_-v),Ke=a(Ke,0),Ke=c(Ke,100-v);var ht=(at=a(at,v))/100,Mt=P((Ke/100+1)*u(dt))/dt,Wt=l(Re)/l(Mt*x),Jt=Ve/_,qt=O(ht*l(Re/2)/l(Ve/2));return function(tr,lr,dr,gr,Pr){function tn(pn,Sn){var In=dr*l(gr*Sn),Un=O(1-In*In),On=O(2/(1+Un*u(pn*=Pr)));return[tr*Un*On*l(pn),lr*In*On]}return tn.invert=function(pn,Sn){var In=pn/tr,Un=Sn/lr,On=O(In*In+Un*Un),pa=2*M(On/2);return[f(pn*y(pa),tr*On)/Pr,On&&M(Sn*l(pa)/(lr*dr*On))/gr]},tn}(qt/O(Jt*Wt*Mt),1/(qt*O(Jt*Wt*Mt)),Wt,Mt,Jt)}function ho(){var Re=65*C,Ve=60*C,Ke=20,at=200,dt=m.geoProjectionMutator($o),ht=dt(Re,Ve,Ke,at);return ht.poleline=function(Mt){return arguments.length?dt(Re=+Mt*C,Ve,Ke,at):Re*k},ht.parallels=function(Mt){return arguments.length?dt(Re,Ve=+Mt*C,Ke,at):Ve*k},ht.inflation=function(Mt){return arguments.length?dt(Re,Ve,Ke=+Mt,at):Ke},ht.ratio=function(Mt){return arguments.length?dt(Re,Ve,Ke,at=+Mt):at},ht.scale(163.775)}Qo.invert=function(Re,Ve){var Ke=Ve/1.70711,at=l(T*Ke);return[Re/(.74482-.34588*at*at),2*e(Ke)]},Mo.invert=function(Re,Ve){if(p(Ve)<v)return[Re,0];if(p(Re)<v)return[0,x*l(2*e(Ve/_))];var Ke=(Re/=_)*Re,at=(Ve/=_)*Ve,dt=Ke+at,ht=dt*dt,Mt=-p(Ve)*(1+dt),Wt=Mt-2*at+Ke,Jt=-2*Mt+1+2*at+ht,qt=at/Jt+(2*Wt*Wt*Wt/(Jt*Jt*Jt)-9*Mt*Wt/(Jt*Jt))/27,tr=(Mt-Wt*Wt/(3*Jt))/Jt,lr=2*O(-tr/3),dr=P(3*qt/(tr*lr))/3;return[_*(dt-1+O(1+2*(Ke-at)+ht))/(2*Re),d(Ve)*_*(-lr*u(dr+_/3)-Wt/(3*Jt))]},jo.invert=function(Re,Ve){if(!Re)return[0,x*l(2*e(Ve/_))];var Ke=p(Re/_),at=(1-Ke*Ke-(Ve/=_)*Ve)/(2*Ke),dt=O(at*at+1);return[d(Re)*_*(dt-at),d(Ve)*x*l(2*f(O((1-2*at*Ke)*(at+dt)-Ke),O(dt+at+Ke)))]},Uo.invert=function(Re,Ve){if(!Ve)return[Re,0];var Ke=Ve/_,at=(_*_*(1-Ke*Ke)-Re*Re)/(2*_*Re);return[Re?_*(d(Re)*O(at*at+1)-at):0,x*l(2*e(Ke))]},Vo.invert=function(Re,Ve){var Ke;if(!Re||!Ve)return[Re,Ve];Ve/=_;var at=d(Re)*Re/x,dt=(at*at-1+4*Ve*Ve)/p(at),ht=dt*dt,Mt=2*Ve,Wt=50;do{var Jt=Mt*Mt,qt=(8*Mt-Jt*(Jt+2)-5)/(2*Jt*(Mt-1)),tr=(3*Mt-Jt*Mt-10)/(2*Jt*Mt),lr=qt*qt,dr=Mt*qt,gr=Mt+qt,Pr=gr*gr,tn=Mt+3*qt,pn=-2*gr*(4*dr*lr+(1-4*Jt+3*Jt*Jt)*(1+tr)+lr*(14*Jt-6-ht+(8*Jt-8-2*ht)*tr)+dr*(12*Jt-8+(10*Jt-10-ht)*tr)),Sn=O(Pr*(Jt+lr*ht-1)+(1-Jt)*(Jt*(tn*tn+4*lr)+lr*(12*dr+4*lr)));Mt-=Ke=(dt*(Pr+lr-1)+2*Sn-at*(4*Pr+ht))/(dt*(2*qt*tr+2*gr*(1+tr))+pn/Sn-8*gr*(dt*(-1+lr+Pr)+2*Sn)*(1+tr)/(ht+4*Pr))}while(Ke>v&&--Wt>0);return[d(Re)*(O(dt*dt+4)+dt)*_/4,x*Mt]};var ps=4*_+3*O(3),oo=2*O(2*_*O(3)/ps),Ho=ie(oo*O(3)/_,oo,ps/6);function ds(Re,Ve){return[Re*O(1-3*Ve*Ve/(_*_)),Ve]}function So(Re,Ve){var Ke=u(Ve),at=u(Re)*Ke,dt=1-at,ht=u(Re=f(l(Re)*Ke,-l(Ve))),Mt=l(Re);return[Mt*(Ke=O(1-at*at))-ht*dt,-ht*Ke-Mt*dt]}function Ua(Re,Ve){var Ke=Z(Re,Ve);return[(Ke[0]+Re/x)/2,(Ke[1]+Ve)/2]}ds.invert=function(Re,Ve){return[Re/O(1-3*Ve*Ve/(_*_)),Ve]},So.invert=function(Re,Ve){var Ke=(Re*Re+Ve*Ve)/-2,at=O(-Ke*(2+Ke)),dt=Ve*Ke+Re*at,ht=Re*Ke-Ve*at,Mt=O(ht*ht+dt*dt);return[f(at*dt,Mt*(1+Ke)),Mt?-M(at*ht/Mt):0]},Ua.invert=function(Re,Ve){var Ke=Re,at=Ve,dt=25;do{var ht,Mt=u(at),Wt=l(at),Jt=l(2*at),qt=Wt*Wt,tr=Mt*Mt,lr=l(Ke),dr=u(Ke/2),gr=l(Ke/2),Pr=gr*gr,tn=1-tr*dr*dr,pn=tn?P(Mt*dr)*O(ht=1/tn):ht=0,Sn=.5*(2*pn*Mt*gr+Ke/x)-Re,In=.5*(pn*Wt+at)-Ve,Un=.5*ht*(tr*Pr+pn*Mt*dr*qt)+.5/x,On=ht*(lr*Jt/4-pn*Wt*gr),pa=.125*ht*(Jt*gr-pn*Wt*tr*lr),_a=.5*ht*(qt*dr+pn*Pr*Mt)+.5,Ra=On*pa-_a*Un,Da=(In*On-Sn*_a)/Ra,Fa=(Sn*pa-In*Un)/Ra;Ke-=Da,at-=Fa}while((p(Da)>v||p(Fa)>v)&&--dt>0);return[Ke,at]},t.geoNaturalEarth=m.geoNaturalEarth1,t.geoNaturalEarthRaw=m.geoNaturalEarth1Raw,t.geoAiry=function(){var Re=x,Ve=m.geoProjectionMutator(W),Ke=Ve(Re);return Ke.radius=function(at){return arguments.length?Ve(Re=at*C):Re*k},Ke.scale(179.976).clipAngle(147)},t.geoAiryRaw=W,t.geoAitoff=function(){return m.geoProjection(Z).scale(152.63)},t.geoAitoffRaw=Z,t.geoArmadillo=function(){var Re=20*C,Ve=Re>=0?1:-1,Ke=y(Ve*Re),at=m.geoProjectionMutator(Q),dt=at(Re),ht=dt.stream;return dt.parallel=function(Mt){return arguments.length?(Ke=y((Ve=(Re=Mt*C)>=0?1:-1)*Re),at(Re)):Re*k},dt.stream=function(Mt){var Wt=dt.rotate(),Jt=ht(Mt),qt=(dt.rotate([0,0]),ht(Mt)),tr=dt.precision();return dt.rotate(Wt),Jt.sphere=function(){qt.polygonStart(),qt.lineStart();for(var lr=-180*Ve;Ve*lr<180;lr+=90*Ve)qt.point(lr,90*Ve);if(Re)for(;Ve*(lr-=3*Ve*tr)>=-180;)qt.point(lr,Ve*-f(u(lr*C/2),Ke)*k);qt.lineEnd(),qt.polygonEnd()},Jt},dt.scale(218.695).center([0,28.0974])},t.geoArmadilloRaw=Q,t.geoAugust=function(){return m.geoProjection(X).scale(66.1603)},t.geoAugustRaw=X,t.geoBaker=function(){return m.geoProjection(K).scale(112.314)},t.geoBakerRaw=K,t.geoBerghaus=function(){var Re=5,Ve=m.geoProjectionMutator(D),Ke=Ve(Re),at=Ke.stream,dt=-u(.01*C),ht=l(.01*C);return Ke.lobes=function(Mt){return arguments.length?Ve(Re=+Mt):Re},Ke.stream=function(Mt){var Wt=Ke.rotate(),Jt=at(Mt),qt=(Ke.rotate([0,0]),at(Mt));return Ke.rotate(Wt),Jt.sphere=function(){qt.polygonStart(),qt.lineStart();for(var tr=0,lr=360/Re,dr=2*_/Re,gr=90-180/Re,Pr=x;tr<Re;++tr,gr-=lr,Pr-=dr)qt.point(f(ht*u(Pr),dt)*k,M(ht*l(Pr))*k),gr<-90?(qt.point(-90,-180-gr-.01),qt.point(-90,-180-gr+.01)):(qt.point(90,gr+.01),qt.point(90,gr-.01));qt.lineEnd(),qt.polygonEnd()},Jt},Ke.scale(87.8076).center([0,17.1875]).clipAngle(179.999)},t.geoBerghausRaw=D,t.geoBertin1953=function(){return m.geoProjection($()).rotate([-16.5,-42]).scale(176.57).center([7.93,.09])},t.geoBertin1953Raw=$,t.geoBoggs=function(){return m.geoProjection(de).scale(160.857)},t.geoBoggsRaw=de,t.geoBonne=function(){return ce(ke).scale(123.082).center([0,26.1441]).parallel(45)},t.geoBonneRaw=ke,t.geoBottomley=function(){var Re=.5,Ve=m.geoProjectionMutator(Ee),Ke=Ve(Re);return Ke.fraction=function(at){return arguments.length?Ve(Re=+at):Re},Ke.scale(158.837)},t.geoBottomleyRaw=Ee,t.geoBromley=function(){return m.geoProjection(be).scale(152.63)},t.geoBromleyRaw=be,t.geoChamberlin=Se,t.geoChamberlinRaw=we,t.geoChamberlinAfrica=function(){return Se([0,22],[45,22],[22.5,-22]).scale(380).center([22.5,2])},t.geoCollignon=function(){return m.geoProjection(De).scale(95.6464).center([0,30])},t.geoCollignonRaw=De,t.geoCraig=function(){return ce(Fe).scale(249.828).clipAngle(90)},t.geoCraigRaw=Fe,t.geoCraster=function(){return m.geoProjection(et).scale(156.19)},t.geoCrasterRaw=et,t.geoCylindricalEqualArea=function(){return ce(Oe).parallel(38.58).scale(195.044)},t.geoCylindricalEqualAreaRaw=Oe,t.geoCylindricalStereographic=function(){return ce(je).scale(124.75)},t.geoCylindricalStereographicRaw=je,t.geoEckert1=function(){return m.geoProjection(We).scale(165.664)},t.geoEckert1Raw=We,t.geoEckert2=function(){return m.geoProjection(Ge).scale(165.664)},t.geoEckert2Raw=Ge,t.geoEckert3=function(){return m.geoProjection(Qe).scale(180.739)},t.geoEckert3Raw=Qe,t.geoEckert4=function(){return m.geoProjection(it).scale(180.739)},t.geoEckert4Raw=it,t.geoEckert5=function(){return m.geoProjection(lt).scale(173.044)},t.geoEckert5Raw=lt,t.geoEckert6=function(){return m.geoProjection(Lt).scale(173.044)},t.geoEckert6Raw=Lt,t.geoEisenlohr=function(){return m.geoProjection(rt).scale(62.5271)},t.geoEisenlohrRaw=rt,t.geoFahey=function(){return m.geoProjection(xt).scale(137.152)},t.geoFaheyRaw=xt,t.geoFoucaut=function(){return m.geoProjection(Qt).scale(135.264)},t.geoFoucautRaw=Qt,t.geoFoucautSinusoidal=function(){var Re=.5,Ve=m.geoProjectionMutator($t),Ke=Ve(Re);return Ke.alpha=function(at){return arguments.length?Ve(Re=+at):Re},Ke.scale(168.725)},t.geoFoucautSinusoidalRaw=$t,t.geoGilbert=function(Re){Re==null&&(Re=m.geoOrthographic);var Ve=Re(),Ke=m.geoEquirectangular().scale(k).precision(0).clipAngle(null).translate([0,0]);function at(ht){return Ve(Ue(ht))}function dt(ht){at[ht]=function(){return arguments.length?(Ve[ht].apply(Ve,arguments),at):Ve[ht]()}}return Ve.invert&&(at.invert=function(ht){return He(Ve.invert(ht))}),at.stream=function(ht){var Mt=Ve.stream(ht),Wt=Ke.stream({point:function(Jt,qt){Mt.point(Jt/2,M(y(-qt/2*C))*k)},lineStart:function(){Mt.lineStart()},lineEnd:function(){Mt.lineEnd()},polygonStart:function(){Mt.polygonStart()},polygonEnd:function(){Mt.polygonEnd()}});return Wt.sphere=Mt.sphere,Wt},at.rotate=function(ht){return arguments.length?(Ke.rotate(ht),at):Ke.rotate()},at.center=function(ht){return arguments.length?(Ve.center(Ue(ht)),at):He(Ve.center())},dt("angle"),dt("clipAngle"),dt("clipExtent"),dt("fitExtent"),dt("fitHeight"),dt("fitSize"),dt("fitWidth"),dt("scale"),dt("translate"),dt("precision"),at.scale(249.5)},t.geoGingery=function(){var Re=6,Ve=30*C,Ke=u(Ve),at=l(Ve),dt=m.geoProjectionMutator(Be),ht=dt(Ve,Re),Mt=ht.stream,Wt=-u(.01*C),Jt=l(.01*C);return ht.radius=function(qt){return arguments.length?(Ke=u(Ve=qt*C),at=l(Ve),dt(Ve,Re)):Ve*k},ht.lobes=function(qt){return arguments.length?dt(Ve,Re=+qt):Re},ht.stream=function(qt){var tr=ht.rotate(),lr=Mt(qt),dr=(ht.rotate([0,0]),Mt(qt));return ht.rotate(tr),lr.sphere=function(){dr.polygonStart(),dr.lineStart();for(var gr=0,Pr=2*_/Re,tn=0;gr<Re;++gr,tn-=Pr)dr.point(f(Jt*u(tn),Wt)*k,M(Jt*l(tn))*k),dr.point(f(at*u(tn-Pr/2),Ke)*k,M(at*l(tn-Pr/2))*k);dr.lineEnd(),dr.polygonEnd()},lr},ht.rotate([90,-40]).scale(91.7095).clipAngle(179.999)},t.geoGingeryRaw=Be,t.geoGinzburg4=function(){return m.geoProjection(Ce).scale(149.995)},t.geoGinzburg4Raw=Ce,t.geoGinzburg5=function(){return m.geoProjection(Pe).scale(153.93)},t.geoGinzburg5Raw=Pe,t.geoGinzburg6=function(){return m.geoProjection(Xe).scale(130.945)},t.geoGinzburg6Raw=Xe,t.geoGinzburg8=function(){return m.geoProjection(ut).scale(131.747)},t.geoGinzburg8Raw=ut,t.geoGinzburg9=function(){return m.geoProjection(kt).scale(131.087)},t.geoGinzburg9Raw=kt,t.geoGringorten=function(){return m.geoProjection(ft(Et)).scale(239.75)},t.geoGringortenRaw=Et,t.geoGuyou=function(){return m.geoProjection(ft(vt)).scale(151.496)},t.geoGuyouRaw=vt,t.geoHammer=function(){var Re=2,Ve=m.geoProjectionMutator(B),Ke=Ve(Re);return Ke.coefficient=function(at){return arguments.length?Ve(Re=+at):Re},Ke.scale(169.529)},t.geoHammerRaw=B,t.geoHammerRetroazimuthal=function(){var Re=0,Ve=m.geoProjectionMutator(nt),Ke=Ve(Re),at=Ke.rotate,dt=Ke.stream,ht=m.geoCircle();return Ke.parallel=function(Mt){if(!arguments.length)return Re*k;var Wt=Ke.rotate();return Ve(Re=Mt*C).rotate(Wt)},Ke.rotate=function(Mt){return arguments.length?(at.call(Ke,[Mt[0],Mt[1]-Re*k]),ht.center([-Mt[0],-Mt[1]]),Ke):((Mt=at.call(Ke))[1]+=Re*k,Mt)},Ke.stream=function(Mt){return(Mt=dt(Mt)).sphere=function(){Mt.polygonStart();var Wt,Jt=ht.radius(89.99)().coordinates[0],qt=Jt.length-1,tr=-1;for(Mt.lineStart();++tr<qt;)Mt.point((Wt=Jt[tr])[0],Wt[1]);for(Mt.lineEnd(),qt=(Jt=ht.radius(90.01)().coordinates[0]).length-1,Mt.lineStart();--tr>=0;)Mt.point((Wt=Jt[tr])[0],Wt[1]);Mt.lineEnd(),Mt.polygonEnd()},Mt},Ke.scale(79.4187).parallel(45).clipAngle(179.999)},t.geoHammerRetroazimuthalRaw=nt,t.geoHealpix=function(){var Re=4,Ve=m.geoProjectionMutator(Kt),Ke=Ve(Re),at=Ke.stream;return Ke.lobes=function(dt){return arguments.length?Ve(Re=+dt):Re},Ke.stream=function(dt){var ht=Ke.rotate(),Mt=at(dt),Wt=(Ke.rotate([0,0]),at(dt));return Ke.rotate(ht),Mt.sphere=function(){var Jt,qt;m.geoStream((Jt=180/Re,qt=[].concat(g.range(-180,180+Jt/2,Jt).map(Ie),g.range(180,-180-Jt/2,-Jt).map(ot)),{type:"Polygon",coordinates:[Jt===180?qt.map(bt):qt]}),Wt)},Mt},Ke.scale(239.75)},t.geoHealpixRaw=Kt,t.geoHill=function(){var Re=1,Ve=m.geoProjectionMutator(Pt),Ke=Ve(Re);return Ke.ratio=function(at){return arguments.length?Ve(Re=+at):Re},Ke.scale(167.774).center([0,18.67])},t.geoHillRaw=Pt,t.geoHomolosine=function(){return m.geoProjection(nr).scale(152.63)},t.geoHomolosineRaw=nr,t.geoHufnagel=function(){var Re=1,Ve=0,Ke=45*C,at=2,dt=m.geoProjectionMutator(Yt),ht=dt(Re,Ve,Ke,at);return ht.a=function(Mt){return arguments.length?dt(Re=+Mt,Ve,Ke,at):Re},ht.b=function(Mt){return arguments.length?dt(Re,Ve=+Mt,Ke,at):Ve},ht.psiMax=function(Mt){return arguments.length?dt(Re,Ve,Ke=+Mt*C,at):Ke*k},ht.ratio=function(Mt){return arguments.length?dt(Re,Ve,Ke,at=+Mt):at},ht.scale(180.739)},t.geoHufnagelRaw=Yt,t.geoHyperelliptical=function(){var Re=0,Ve=2.5,Ke=1.183136,at=m.geoProjectionMutator(ar),dt=at(Re,Ve,Ke);return dt.alpha=function(ht){return arguments.length?at(Re=+ht,Ve,Ke):Re},dt.k=function(ht){return arguments.length?at(Re,Ve=+ht,Ke):Ve},dt.gamma=function(ht){return arguments.length?at(Re,Ve,Ke=+ht):Ke},dt.scale(152.63)},t.geoHyperellipticalRaw=ar,t.geoInterrupt=fr,t.geoInterruptedBoggs=function(){return fr(de,yr).scale(160.857)},t.geoInterruptedHomolosine=function(){return fr(nr,zr).scale(152.63)},t.geoInterruptedMollweide=function(){return fr(ae,xr).scale(169.529)},t.geoInterruptedMollweideHemispheres=function(){return fr(ae,Br).scale(169.529).rotate([20,0])},t.geoInterruptedSinuMollweide=function(){return fr(Vt,Jr,J).rotate([-20,-55]).scale(164.263).center([0,-5.4036])},t.geoInterruptedSinusoidal=function(){return fr(ve,fn).scale(152.63).rotate([-20,0])},t.geoKavrayskiy7=function(){return m.geoProjection(Cn).scale(158.837)},t.geoKavrayskiy7Raw=Cn,t.geoLagrange=function(){var Re=.5,Ve=m.geoProjectionMutator(Pn),Ke=Ve(Re);return Ke.spacing=function(at){return arguments.length?Ve(Re=+at):Re},Ke.scale(124.75)},t.geoLagrangeRaw=Pn,t.geoLarrivee=function(){return m.geoProjection(rn).scale(97.2672)},t.geoLarriveeRaw=rn,t.geoLaskowski=function(){return m.geoProjection(Fr).scale(139.98)},t.geoLaskowskiRaw=Fr,t.geoLittrow=function(){return m.geoProjection(Lr).scale(144.049).clipAngle(89.999)},t.geoLittrowRaw=Lr,t.geoLoximuthal=function(){return ce(Qr).parallel(40).scale(158.837)},t.geoLoximuthalRaw=Qr,t.geoMiller=function(){return m.geoProjection($r).scale(108.318)},t.geoMillerRaw=$r,t.geoModifiedStereographic=Ct,t.geoModifiedStereographicRaw=Kr,t.geoModifiedStereographicAlaska=function(){return Ct(en,[152,-64]).scale(1400).center([-160.908,62.4864]).clipAngle(30).angle(7.8)},t.geoModifiedStereographicGs48=function(){return Ct(Tn,[95,-38]).scale(1e3).clipAngle(55).center([-96.5563,38.8675])},t.geoModifiedStereographicGs50=function(){return Ct(Mn,[120,-45]).scale(359.513).clipAngle(55).center([-117.474,53.0628])},t.geoModifiedStereographicMiller=function(){return Ct(Rn,[-20,-18]).scale(209.091).center([20,16.7214]).clipAngle(82)},t.geoModifiedStereographicLee=function(){return Ct(Zt,[165,10]).scale(250).clipAngle(130).center([-165,-10])},t.geoMollweide=function(){return m.geoProjection(ae).scale(169.529)},t.geoMollweideRaw=ae,t.geoMtFlatPolarParabolic=function(){return m.geoProjection(_r).scale(164.859)},t.geoMtFlatPolarParabolicRaw=_r,t.geoMtFlatPolarQuartic=function(){return m.geoProjection(Vr).scale(188.209)},t.geoMtFlatPolarQuarticRaw=Vr,t.geoMtFlatPolarSinusoidal=function(){return m.geoProjection(jr).scale(166.518)},t.geoMtFlatPolarSinusoidalRaw=jr,t.geoNaturalEarth2=function(){return m.geoProjection(vr).scale(175.295)},t.geoNaturalEarth2Raw=vr,t.geoNellHammer=function(){return m.geoProjection(br).scale(152.63)},t.geoNellHammerRaw=br,t.geoInterruptedQuarticAuthalic=function(){return fr(B(1/0),Ar).rotate([20,0]).scale(152.63)},t.geoNicolosi=function(){return m.geoProjection(kr).scale(127.267)},t.geoNicolosiRaw=kr,t.geoPatterson=function(){return m.geoProjection(Cr).scale(139.319)},t.geoPattersonRaw=Cr,t.geoPolyconic=function(){return m.geoProjection(Hr).scale(103.74)},t.geoPolyconicRaw=Hr,t.geoPolyhedral=Ir,t.geoPolyhedralButterfly=function(Re){Re=Re||function(Ke){var at=m.geoCentroid({type:"MultiPoint",coordinates:Ke});return m.geoGnomonic().scale(1).translate([0,0]).rotate([-at[0],-at[1]])};var Ve=Ln.map(function(Ke){return{face:Ke,project:Re(Ke)}});return[-1,0,0,1,0,1,4,5].forEach(function(Ke,at){var dt=Ve[Ke];dt&&(dt.children||(dt.children=[])).push(Ve[at])}),Ir(Ve[0],function(Ke,at){return Ve[Ke<-_/2?at<0?6:4:Ke<0?at<0?2:0:Ke<_/2?at<0?3:1:at<0?7:5]}).angle(-30).scale(101.858).center([0,45])},t.geoPolyhedralCollignon=function(Re){Re=Re||function(Ke){var at=m.geoCentroid({type:"MultiPoint",coordinates:Ke});return m.geoProjection(qn).translate([0,0]).scale(1).rotate(at[1]>0?[-at[0],0]:[180-at[0],180])};var Ve=Ln.map(function(Ke){return{face:Ke,project:Re(Ke)}});return[-1,0,0,1,0,1,4,5].forEach(function(Ke,at){var dt=Ve[Ke];dt&&(dt.children||(dt.children=[])).push(Ve[at])}),Ir(Ve[0],function(Ke,at){return Ve[Ke<-_/2?at<0?6:4:Ke<0?at<0?2:0:Ke<_/2?at<0?3:1:at<0?7:5]}).angle(-30).scale(121.906).center([0,48.5904])},t.geoPolyhedralWaterman=function(Re){Re=Re||function(ht){var Mt=ht.length===6?m.geoCentroid({type:"MultiPoint",coordinates:ht}):ht[0];return m.geoGnomonic().scale(1).translate([0,0]).rotate([-Mt[0],-Mt[1]])};var Ve=Ln.map(function(ht){for(var Mt,Wt=ht.map(fa),Jt=Wt.length,qt=Wt[Jt-1],tr=[],lr=0;lr<Jt;++lr)Mt=Wt[lr],tr.push(ta([.9486832980505138*qt[0]+.31622776601683794*Mt[0],.9486832980505138*qt[1]+.31622776601683794*Mt[1],.9486832980505138*qt[2]+.31622776601683794*Mt[2]]),ta([.9486832980505138*Mt[0]+.31622776601683794*qt[0],.9486832980505138*Mt[1]+.31622776601683794*qt[1],.9486832980505138*Mt[2]+.31622776601683794*qt[2]])),qt=Mt;return tr}),Ke=[],at=[-1,0,0,1,0,1,4,5];Ve.forEach(function(ht,Mt){for(var Wt,Jt,qt=Ln[Mt],tr=qt.length,lr=Ke[Mt]=[],dr=0;dr<tr;++dr)Ve.push([qt[dr],ht[(2*dr+2)%(2*tr)],ht[(2*dr+1)%(2*tr)]]),at.push(Mt),lr.push((Wt=fa(ht[(2*dr+2)%(2*tr)]),Jt=fa(ht[(2*dr+1)%(2*tr)]),[Wt[1]*Jt[2]-Wt[2]*Jt[1],Wt[2]*Jt[0]-Wt[0]*Jt[2],Wt[0]*Jt[1]-Wt[1]*Jt[0]]))});var dt=Ve.map(function(ht){return{project:Re(ht),face:ht}});return at.forEach(function(ht,Mt){var Wt=dt[ht];Wt&&(Wt.children||(Wt.children=[])).push(dt[Mt])}),Ir(dt[0],function(ht,Mt){var Wt=u(Mt),Jt=[Wt*u(ht),Wt*l(ht),l(Mt)],qt=ht<-_/2?Mt<0?6:4:ht<0?Mt<0?2:0:ht<_/2?Mt<0?3:1:Mt<0?7:5,tr=Ke[qt];return dt[gn(tr[0],Jt)<0?8+3*qt:gn(tr[1],Jt)<0?8+3*qt+1:gn(tr[2],Jt)<0?8+3*qt+2:qt]}).angle(-30).scale(110.625).center([0,45])},t.geoProject=function(Re,Ve){var Ke,at=Ve.stream;if(!at)throw new Error("invalid projection");switch(Re&&Re.type){case"Feature":Ke=ni;break;case"FeatureCollection":Ke=Pi;break;default:Ke=yi}return Ke(Re,at)},t.geoGringortenQuincuncial=function(){return qi(Et).scale(176.423)},t.geoPeirceQuincuncial=Wi,t.geoPierceQuincuncial=Wi,t.geoQuantize=function(Re,Ve){if(!(0<=(Ve=+Ve)&&Ve<=20))throw new Error("invalid digits");function Ke(qt){var tr=qt.length,lr=2,dr=new Array(tr);for(dr[0]=+qt[0].toFixed(Ve),dr[1]=+qt[1].toFixed(Ve);lr<tr;)dr[lr]=qt[lr],++lr;return dr}function at(qt){return qt.map(Ke)}function dt(qt){for(var tr=Ke(qt[0]),lr=[tr],dr=1;dr<qt.length;dr++){var gr=Ke(qt[dr]);(gr.length>2||gr[0]!=tr[0]||gr[1]!=tr[1])&&(lr.push(gr),tr=gr)}return lr.length===1&&qt.length>1&&lr.push(Ke(qt[qt.length-1])),lr}function ht(qt){return qt.map(dt)}function Mt(qt){if(qt==null)return qt;var tr;switch(qt.type){case"GeometryCollection":tr={type:"GeometryCollection",geometries:qt.geometries.map(Mt)};break;case"Point":tr={type:"Point",coordinates:Ke(qt.coordinates)};break;case"MultiPoint":tr={type:qt.type,coordinates:at(qt.coordinates)};break;case"LineString":tr={type:qt.type,coordinates:dt(qt.coordinates)};break;case"MultiLineString":case"Polygon":tr={type:qt.type,coordinates:ht(qt.coordinates)};break;case"MultiPolygon":tr={type:"MultiPolygon",coordinates:qt.coordinates.map(ht)};break;default:return qt}return qt.bbox!=null&&(tr.bbox=qt.bbox),tr}function Wt(qt){var tr={type:"Feature",properties:qt.properties,geometry:Mt(qt.geometry)};return qt.id!=null&&(tr.id=qt.id),qt.bbox!=null&&(tr.bbox=qt.bbox),tr}if(Re!=null)switch(Re.type){case"Feature":return Wt(Re);case"FeatureCollection":var Jt={type:"FeatureCollection",features:Re.features.map(Wt)};return Re.bbox!=null&&(Jt.bbox=Re.bbox),Jt;default:return Mt(Re)}return Re},t.geoQuincuncial=qi,t.geoRectangularPolyconic=function(){return ce(No).scale(131.215)},t.geoRectangularPolyconicRaw=No,t.geoRobinson=function(){return m.geoProjection(ko).scale(152.63)},t.geoRobinsonRaw=ko,t.geoSatellite=function(){var Re=2,Ve=0,Ke=m.geoProjectionMutator(uo),at=Ke(Re,Ve);return at.distance=function(dt){return arguments.length?Ke(Re=+dt,Ve):Re},at.tilt=function(dt){return arguments.length?Ke(Re,Ve=dt*C):Ve*k},at.scale(432.147).clipAngle(P(1/Re)*k-1e-6)},t.geoSatelliteRaw=uo,t.geoSinuMollweide=function(){return m.geoProjection(Vt).rotate([-20,-55]).scale(164.263).center([0,-5.4036])},t.geoSinuMollweideRaw=Vt,t.geoSinusoidal=function(){return m.geoProjection(ve).scale(152.63)},t.geoSinusoidalRaw=ve,t.geoStitch=function(Re){if(Re==null)return Re;switch(Re.type){case"Feature":return qa(Re);case"FeatureCollection":var Ve={type:"FeatureCollection",features:Re.features.map(qa)};return Re.bbox!=null&&(Ve.bbox=Re.bbox),Ve;default:return hs(Re)}},t.geoTimes=function(){return m.geoProjection(Qo).scale(146.153)},t.geoTimesRaw=Qo,t.geoTwoPointAzimuthal=xs,t.geoTwoPointAzimuthalRaw=ks,t.geoTwoPointAzimuthalUsa=function(){return xs([-158,21.5],[-77,39]).clipAngle(60).scale(400)},t.geoTwoPointEquidistant=Ao,t.geoTwoPointEquidistantRaw=As,t.geoTwoPointEquidistantUsa=function(){return Ao([-158,21.5],[-77,39]).clipAngle(130).scale(122.571)},t.geoVanDerGrinten=function(){return m.geoProjection(Mo).scale(79.4183)},t.geoVanDerGrintenRaw=Mo,t.geoVanDerGrinten2=function(){return m.geoProjection(jo).scale(79.4183)},t.geoVanDerGrinten2Raw=jo,t.geoVanDerGrinten3=function(){return m.geoProjection(Uo).scale(79.4183)},t.geoVanDerGrinten3Raw=Uo,t.geoVanDerGrinten4=function(){return m.geoProjection(Vo).scale(127.16)},t.geoVanDerGrinten4Raw=Vo,t.geoWagner=ho,t.geoWagner7=function(){return ho().poleline(65).parallels(60).inflation(0).ratio(200).scale(172.633)},t.geoWagnerRaw=$o,t.geoWagner4=function(){return m.geoProjection(Ho).scale(176.84)},t.geoWagner4Raw=Ho,t.geoWagner6=function(){return m.geoProjection(ds).scale(152.63)},t.geoWagner6Raw=ds,t.geoWiechel=function(){return m.geoProjection(So).rotate([0,-90,45]).scale(124.75).clipAngle(179.999)},t.geoWiechelRaw=So,t.geoWinkel3=function(){return m.geoProjection(Ua).scale(158.837)},t.geoWinkel3Raw=Ua,Object.defineProperty(t,"__esModule",{value:!0})})},{"d3-array":159,"d3-geo":166}],166:[function(h,N,H){(function(t,m){typeof H=="object"&&N!==void 0?m(H,h("d3-array")):m((t=t||self).d3=t.d3||{},t.d3)})(this,function(t,m){function g(){return new p}function p(){this.reset()}p.prototype={constructor:p,reset:function(){this.s=this.t=0},add:function(ct){f(e,ct,this.t),f(this,e.s,this.s),this.s?this.t+=e.t:this.s=e.t},valueOf:function(){return this.s}};var e=new p;function f(ct,zt,ir){var jt=ct.s=zt+ir,or=jt-zt,Er=jt-or;ct.t=zt-Er+(ir-or)}var u=1e-6,i=Math.PI,s=i/2,o=i/4,a=2*i,c=180/i,r=i/180,n=Math.abs,d=Math.atan,l=Math.atan2,y=Math.cos,v=Math.ceil,_=Math.exp,x=Math.log,T=Math.pow,A=Math.sin,S=Math.sign||function(ct){return ct>0?1:ct<0?-1:0},w=Math.sqrt,L=Math.tan;function k(ct){return ct>1?0:ct<-1?i:Math.acos(ct)}function C(ct){return ct>1?s:ct<-1?-s:Math.asin(ct)}function M(ct){return(ct=A(ct/2))*ct}function P(){}function O(ct,zt){ct&&j.hasOwnProperty(ct.type)&&j[ct.type](ct,zt)}var F={Feature:function(ct,zt){O(ct.geometry,zt)},FeatureCollection:function(ct,zt){for(var ir=ct.features,jt=-1,or=ir.length;++jt<or;)O(ir[jt].geometry,zt)}},j={Sphere:function(ct,zt){zt.sphere()},Point:function(ct,zt){ct=ct.coordinates,zt.point(ct[0],ct[1],ct[2])},MultiPoint:function(ct,zt){for(var ir=ct.coordinates,jt=-1,or=ir.length;++jt<or;)ct=ir[jt],zt.point(ct[0],ct[1],ct[2])},LineString:function(ct,zt){W(ct.coordinates,zt,0)},MultiLineString:function(ct,zt){for(var ir=ct.coordinates,jt=-1,or=ir.length;++jt<or;)W(ir[jt],zt,0)},Polygon:function(ct,zt){Z(ct.coordinates,zt)},MultiPolygon:function(ct,zt){for(var ir=ct.coordinates,jt=-1,or=ir.length;++jt<or;)Z(ir[jt],zt)},GeometryCollection:function(ct,zt){for(var ir=ct.geometries,jt=-1,or=ir.length;++jt<or;)O(ir[jt],zt)}};function W(ct,zt,ir){var jt,or=-1,Er=ct.length-ir;for(zt.lineStart();++or<Er;)jt=ct[or],zt.point(jt[0],jt[1],jt[2]);zt.lineEnd()}function Z(ct,zt){var ir=-1,jt=ct.length;for(zt.polygonStart();++ir<jt;)W(ct[ir],zt,1);zt.polygonEnd()}function Q(ct,zt){ct&&F.hasOwnProperty(ct.type)?F[ct.type](ct,zt):O(ct,zt)}var X,G,Y,K,D,B=g(),q=g(),ee={point:P,lineStart:P,lineEnd:P,polygonStart:function(){B.reset(),ee.lineStart=J,ee.lineEnd=$},polygonEnd:function(){var ct=+B;q.add(ct<0?a+ct:ct),this.lineStart=this.lineEnd=this.point=P},sphere:function(){q.add(a)}};function J(){ee.point=te}function $(){ie(X,G)}function te(ct,zt){ee.point=ie,X=ct,G=zt,Y=ct*=r,K=y(zt=(zt*=r)/2+o),D=A(zt)}function ie(ct,zt){var ir=(ct*=r)-Y,jt=ir>=0?1:-1,or=jt*ir,Er=y(zt=(zt*=r)/2+o),Or=A(zt),qr=D*Or,on=K*Er+qr*y(or),nn=qr*jt*A(or);B.add(l(nn,on)),Y=ct,K=Er,D=Or}function ae(ct){return[l(ct[1],ct[0]),C(ct[2])]}function he(ct){var zt=ct[0],ir=ct[1],jt=y(ir);return[jt*y(zt),jt*A(zt),A(ir)]}function se(ct,zt){return ct[0]*zt[0]+ct[1]*zt[1]+ct[2]*zt[2]}function de(ct,zt){return[ct[1]*zt[2]-ct[2]*zt[1],ct[2]*zt[0]-ct[0]*zt[2],ct[0]*zt[1]-ct[1]*zt[0]]}function ce(ct,zt){ct[0]+=zt[0],ct[1]+=zt[1],ct[2]+=zt[2]}function ve(ct,zt){return[ct[0]*zt,ct[1]*zt,ct[2]*zt]}function ke(ct){var zt=w(ct[0]*ct[0]+ct[1]*ct[1]+ct[2]*ct[2]);ct[0]/=zt,ct[1]/=zt,ct[2]/=zt}var Ee,be,xe,ue,me,we,Me,Se,De,Fe,Ye,et,Oe,je,We,Ge,Qe,it,lt,Lt,wt,rt,$e,xt,Qt,$t,Ue=g(),He={point:Be,lineStart:_e,lineEnd:Le,polygonStart:function(){He.point=Ce,He.lineStart=Pe,He.lineEnd=Xe,Ue.reset(),ee.polygonStart()},polygonEnd:function(){ee.polygonEnd(),He.point=Be,He.lineStart=_e,He.lineEnd=Le,B<0?(Ee=-(xe=180),be=-(ue=90)):Ue>u?ue=90:Ue<-u&&(be=-90),Fe[0]=Ee,Fe[1]=xe},sphere:function(){Ee=-(xe=180),be=-(ue=90)}};function Be(ct,zt){De.push(Fe=[Ee=ct,xe=ct]),zt<be&&(be=zt),zt>ue&&(ue=zt)}function Je(ct,zt){var ir=he([ct*r,zt*r]);if(Se){var jt=de(Se,ir),or=de([jt[1],-jt[0],0],jt);ke(or),or=ae(or);var Er,Or=ct-me,qr=Or>0?1:-1,on=or[0]*c*qr,nn=n(Or)>180;nn^(qr*me<on&&on<qr*ct)?(Er=or[1]*c)>ue&&(ue=Er):nn^(qr*me<(on=(on+360)%360-180)&&on<qr*ct)?(Er=-or[1]*c)<be&&(be=Er):(zt<be&&(be=zt),zt>ue&&(ue=zt)),nn?ct<me?ut(Ee,ct)>ut(Ee,xe)&&(xe=ct):ut(ct,xe)>ut(Ee,xe)&&(Ee=ct):xe>=Ee?(ct<Ee&&(Ee=ct),ct>xe&&(xe=ct)):ct>me?ut(Ee,ct)>ut(Ee,xe)&&(xe=ct):ut(ct,xe)>ut(Ee,xe)&&(Ee=ct)}else De.push(Fe=[Ee=ct,xe=ct]);zt<be&&(be=zt),zt>ue&&(ue=zt),Se=ir,me=ct}function _e(){He.point=Je}function Le(){Fe[0]=Ee,Fe[1]=xe,He.point=Be,Se=null}function Ce(ct,zt){if(Se){var ir=ct-me;Ue.add(n(ir)>180?ir+(ir>0?360:-360):ir)}else we=ct,Me=zt;ee.point(ct,zt),Je(ct,zt)}function Pe(){ee.lineStart()}function Xe(){Ce(we,Me),ee.lineEnd(),n(Ue)>u&&(Ee=-(xe=180)),Fe[0]=Ee,Fe[1]=xe,Se=null}function ut(ct,zt){return(zt-=ct)<0?zt+360:zt}function kt(ct,zt){return ct[0]-zt[0]}function ft(ct,zt){return ct[0]<=ct[1]?ct[0]<=zt&&zt<=ct[1]:zt<ct[0]||ct[1]<zt}var Et={sphere:P,point:mt,lineStart:vt,lineEnd:Ft,polygonStart:function(){Et.lineStart=Nt,Et.lineEnd=Kt},polygonEnd:function(){Et.lineStart=vt,Et.lineEnd=Ft}};function mt(ct,zt){ct*=r;var ir=y(zt*=r);It(ir*y(ct),ir*A(ct),A(zt))}function It(ct,zt,ir){++Ye,Oe+=(ct-Oe)/Ye,je+=(zt-je)/Ye,We+=(ir-We)/Ye}function vt(){Et.point=nt}function nt(ct,zt){ct*=r;var ir=y(zt*=r);xt=ir*y(ct),Qt=ir*A(ct),$t=A(zt),Et.point=At,It(xt,Qt,$t)}function At(ct,zt){ct*=r;var ir=y(zt*=r),jt=ir*y(ct),or=ir*A(ct),Er=A(zt),Or=l(w((Or=Qt*Er-$t*or)*Or+(Or=$t*jt-xt*Er)*Or+(Or=xt*or-Qt*jt)*Or),xt*jt+Qt*or+$t*Er);et+=Or,Ge+=Or*(xt+(xt=jt)),Qe+=Or*(Qt+(Qt=or)),it+=Or*($t+($t=Er)),It(xt,Qt,$t)}function Ft(){Et.point=mt}function Nt(){Et.point=Ie}function Kt(){ot(rt,$e),Et.point=mt}function Ie(ct,zt){rt=ct,$e=zt,ct*=r,zt*=r,Et.point=ot;var ir=y(zt);xt=ir*y(ct),Qt=ir*A(ct),$t=A(zt),It(xt,Qt,$t)}function ot(ct,zt){ct*=r;var ir=y(zt*=r),jt=ir*y(ct),or=ir*A(ct),Er=A(zt),Or=Qt*Er-$t*or,qr=$t*jt-xt*Er,on=xt*or-Qt*jt,nn=w(Or*Or+qr*qr+on*on),dn=C(nn),bn=nn&&-dn/nn;lt+=bn*Or,Lt+=bn*qr,wt+=bn*on,et+=dn,Ge+=dn*(xt+(xt=jt)),Qe+=dn*(Qt+(Qt=or)),it+=dn*($t+($t=Er)),It(xt,Qt,$t)}function bt(ct){return function(){return ct}}function Pt(ct,zt){function ir(jt,or){return jt=ct(jt,or),zt(jt[0],jt[1])}return ct.invert&&zt.invert&&(ir.invert=function(jt,or){return(jt=zt.invert(jt,or))&&ct.invert(jt[0],jt[1])}),ir}function Vt(ct,zt){return[n(ct)>i?ct+Math.round(-ct/a)*a:ct,zt]}function nr(ct,zt,ir){return(ct%=a)?zt||ir?Pt(Xt(ct),ar(zt,ir)):Xt(ct):zt||ir?ar(zt,ir):Vt}function Yt(ct){return function(zt,ir){return[(zt+=ct)>i?zt-a:zt<-i?zt+a:zt,ir]}}function Xt(ct){var zt=Yt(ct);return zt.invert=Yt(-ct),zt}function ar(ct,zt){var ir=y(ct),jt=A(ct),or=y(zt),Er=A(zt);function Or(qr,on){var nn=y(on),dn=y(qr)*nn,bn=A(qr)*nn,sn=A(on),_n=sn*ir+dn*jt;return[l(bn*or-_n*Er,dn*ir-sn*jt),C(_n*or+bn*Er)]}return Or.invert=function(qr,on){var nn=y(on),dn=y(qr)*nn,bn=A(qr)*nn,sn=A(on),_n=sn*or-bn*Er;return[l(bn*or+sn*Er,dn*ir+_n*jt),C(_n*ir-dn*jt)]},Or}function hr(ct){function zt(ir){return(ir=ct(ir[0]*r,ir[1]*r))[0]*=c,ir[1]*=c,ir}return ct=nr(ct[0]*r,ct[1]*r,ct.length>2?ct[2]*r:0),zt.invert=function(ir){return(ir=ct.invert(ir[0]*r,ir[1]*r))[0]*=c,ir[1]*=c,ir},zt}function mr(ct,zt,ir,jt,or,Er){if(ir){var Or=y(zt),qr=A(zt),on=jt*ir;or==null?(or=zt+jt*a,Er=zt-on/2):(or=sr(Or,or),Er=sr(Or,Er),(jt>0?or<Er:or>Er)&&(or+=jt*a));for(var nn,dn=or;jt>0?dn>Er:dn<Er;dn-=on)nn=ae([Or,-qr*y(dn),-qr*A(dn)]),ct.point(nn[0],nn[1])}}function sr(ct,zt){(zt=he(zt))[0]-=ct,ke(zt);var ir=k(-zt[1]);return((-zt[2]<0?-ir:ir)+a-u)%a}function fr(){var ct,zt=[];return{point:function(ir,jt,or){ct.push([ir,jt,or])},lineStart:function(){zt.push(ct=[])},lineEnd:P,rejoin:function(){zt.length>1&&zt.push(zt.pop().concat(zt.shift()))},result:function(){var ir=zt;return zt=[],ct=null,ir}}}function yr(ct,zt){return n(ct[0]-zt[0])<u&&n(ct[1]-zt[1])<u}function zr(ct,zt,ir,jt){this.x=ct,this.z=zt,this.o=ir,this.e=jt,this.v=!1,this.n=this.p=null}function xr(ct,zt,ir,jt,or){var Er,Or,qr=[],on=[];if(ct.forEach(function(zn){if(!((jn=zn.length-1)<=0)){var jn,ea,Yr=zn[0],Kn=zn[jn];if(yr(Yr,Kn)){if(!Yr[2]&&!Kn[2]){for(or.lineStart(),Er=0;Er<jn;++Er)or.point((Yr=zn[Er])[0],Yr[1]);return void or.lineEnd()}Kn[0]+=2*u}qr.push(ea=new zr(Yr,zn,null,!0)),on.push(ea.o=new zr(Yr,null,ea,!1)),qr.push(ea=new zr(Kn,zn,null,!1)),on.push(ea.o=new zr(Kn,null,ea,!0))}}),qr.length){for(on.sort(zt),Br(qr),Br(on),Er=0,Or=on.length;Er<Or;++Er)on[Er].e=ir=!ir;for(var nn,dn,bn=qr[0];;){for(var sn=bn,_n=!0;sn.v;)if((sn=sn.n)===bn)return;nn=sn.z,or.lineStart();do{if(sn.v=sn.o.v=!0,sn.e){if(_n)for(Er=0,Or=nn.length;Er<Or;++Er)or.point((dn=nn[Er])[0],dn[1]);else jt(sn.x,sn.n.x,1,or);sn=sn.n}else{if(_n)for(nn=sn.p.z,Er=nn.length-1;Er>=0;--Er)or.point((dn=nn[Er])[0],dn[1]);else jt(sn.x,sn.p.x,-1,or);sn=sn.p}nn=(sn=sn.o).z,_n=!_n}while(!sn.v);or.lineEnd()}}}function Br(ct){if(zt=ct.length){for(var zt,ir,jt=0,or=ct[0];++jt<zt;)or.n=ir=ct[jt],ir.p=or,or=ir;or.n=ir=ct[0],ir.p=or}}Vt.invert=Vt;var Jr=g();function fn(ct){return n(ct[0])<=i?ct[0]:S(ct[0])*((n(ct[0])+i)%a-i)}function Cn(ct,zt){var ir=fn(zt),jt=zt[1],or=A(jt),Er=[A(ir),-y(ir),0],Or=0,qr=0;Jr.reset(),or===1?jt=s+u:or===-1&&(jt=-s-u);for(var on=0,nn=ct.length;on<nn;++on)if(bn=(dn=ct[on]).length)for(var dn,bn,sn=dn[bn-1],_n=fn(sn),zn=sn[1]/2+o,jn=A(zn),ea=y(zn),Yr=0;Yr<bn;++Yr,_n=En,jn=Jn,ea=ba,sn=Kn){var Kn=dn[Yr],En=fn(Kn),Bn=Kn[1]/2+o,Jn=A(Bn),ba=y(Bn),Ma=En-_n,kn=Ma>=0?1:-1,Ia=kn*Ma,ka=Ia>i,ha=jn*Jn;if(Jr.add(l(ha*kn*A(Ia),ea*ba+ha*y(Ia))),Or+=ka?Ma+kn*a:Ma,ka^_n>=ir^En>=ir){var Oa=de(he(sn),he(Kn));ke(Oa);var wa=de(Er,Oa);ke(wa);var Ka=(ka^Ma>=0?-1:1)*C(wa[2]);(jt>Ka||jt===Ka&&(Oa[0]||Oa[1]))&&(qr+=ka^Ma>=0?1:-1)}}return(Or<-u||Or<u&&Jr<-u)^1&qr}function Pn(ct,zt,ir,jt){return function(or){var Er,Or,qr,on=zt(or),nn=fr(),dn=zt(nn),bn=!1,sn={point:_n,lineStart:jn,lineEnd:ea,polygonStart:function(){sn.point=Yr,sn.lineStart=Kn,sn.lineEnd=En,Or=[],Er=[]},polygonEnd:function(){sn.point=_n,sn.lineStart=jn,sn.lineEnd=ea,Or=m.merge(Or);var Bn=Cn(Er,jt);Or.length?(bn||(or.polygonStart(),bn=!0),xr(Or,rn,Bn,ir,or)):Bn&&(bn||(or.polygonStart(),bn=!0),or.lineStart(),ir(null,null,1,or),or.lineEnd()),bn&&(or.polygonEnd(),bn=!1),Or=Er=null},sphere:function(){or.polygonStart(),or.lineStart(),ir(null,null,1,or),or.lineEnd(),or.polygonEnd()}};function _n(Bn,Jn){ct(Bn,Jn)&&or.point(Bn,Jn)}function zn(Bn,Jn){on.point(Bn,Jn)}function jn(){sn.point=zn,on.lineStart()}function ea(){sn.point=_n,on.lineEnd()}function Yr(Bn,Jn){qr.push([Bn,Jn]),dn.point(Bn,Jn)}function Kn(){dn.lineStart(),qr=[]}function En(){Yr(qr[0][0],qr[0][1]),dn.lineEnd();var Bn,Jn,ba,Ma,kn=dn.clean(),Ia=nn.result(),ka=Ia.length;if(qr.pop(),Er.push(qr),qr=null,ka)if(1&kn){if((Jn=(ba=Ia[0]).length-1)>0){for(bn||(or.polygonStart(),bn=!0),or.lineStart(),Bn=0;Bn<Jn;++Bn)or.point((Ma=ba[Bn])[0],Ma[1]);or.lineEnd()}}else ka>1&&2&kn&&Ia.push(Ia.pop().concat(Ia.shift())),Or.push(Ia.filter(An))}return sn}}function An(ct){return ct.length>1}function rn(ct,zt){return((ct=ct.x)[0]<0?ct[1]-s-u:s-ct[1])-((zt=zt.x)[0]<0?zt[1]-s-u:s-zt[1])}var Fr=Pn(function(){return!0},function(ct){var zt,ir=NaN,jt=NaN,or=NaN;return{lineStart:function(){ct.lineStart(),zt=1},point:function(Er,Or){var qr=Er>0?i:-i,on=n(Er-ir);n(on-i)<u?(ct.point(ir,jt=(jt+Or)/2>0?s:-s),ct.point(or,jt),ct.lineEnd(),ct.lineStart(),ct.point(qr,jt),ct.point(Er,jt),zt=0):or!==qr&&on>=i&&(n(ir-or)<u&&(ir-=or*u),n(Er-qr)<u&&(Er-=qr*u),jt=function(nn,dn,bn,sn){var _n,zn,jn=A(nn-bn);return n(jn)>u?d((A(dn)*(zn=y(sn))*A(bn)-A(sn)*(_n=y(dn))*A(nn))/(_n*zn*jn)):(dn+sn)/2}(ir,jt,Er,Or),ct.point(or,jt),ct.lineEnd(),ct.lineStart(),ct.point(qr,jt),zt=0),ct.point(ir=Er,jt=Or),or=qr},lineEnd:function(){ct.lineEnd(),ir=jt=NaN},clean:function(){return 2-zt}}},function(ct,zt,ir,jt){var or;if(ct==null)or=ir*s,jt.point(-i,or),jt.point(0,or),jt.point(i,or),jt.point(i,0),jt.point(i,-or),jt.point(0,-or),jt.point(-i,-or),jt.point(-i,0),jt.point(-i,or);else if(n(ct[0]-zt[0])>u){var Er=ct[0]<zt[0]?i:-i;or=ir*Er/2,jt.point(-Er,or),jt.point(0,or),jt.point(Er,or)}else jt.point(zt[0],zt[1])},[-i,-s]);function Lr(ct){var zt=y(ct),ir=6*r,jt=zt>0,or=n(zt)>u;function Er(on,nn){return y(on)*y(nn)>zt}function Or(on,nn,dn){var bn=[1,0,0],sn=de(he(on),he(nn)),_n=se(sn,sn),zn=sn[0],jn=_n-zn*zn;if(!jn)return!dn&&on;var ea=zt*_n/jn,Yr=-zt*zn/jn,Kn=de(bn,sn),En=ve(bn,ea);ce(En,ve(sn,Yr));var Bn=Kn,Jn=se(En,Bn),ba=se(Bn,Bn),Ma=Jn*Jn-ba*(se(En,En)-1);if(!(Ma<0)){var kn=w(Ma),Ia=ve(Bn,(-Jn-kn)/ba);if(ce(Ia,En),Ia=ae(Ia),!dn)return Ia;var ka,ha=on[0],Oa=nn[0],wa=on[1],Ka=nn[1];Oa<ha&&(ka=ha,ha=Oa,Oa=ka);var Qn=Oa-ha,Ga=n(Qn-i)<u;if(!Ga&&Ka<wa&&(ka=wa,wa=Ka,Ka=ka),Ga||Qn<u?Ga?wa+Ka>0^Ia[1]<(n(Ia[0]-ha)<u?wa:Ka):wa<=Ia[1]&&Ia[1]<=Ka:Qn>i^(ha<=Ia[0]&&Ia[0]<=Oa)){var Fi=ve(Bn,(-Jn+kn)/ba);return ce(Fi,En),[Ia,ae(Fi)]}}}function qr(on,nn){var dn=jt?ct:i-ct,bn=0;return on<-dn?bn|=1:on>dn&&(bn|=2),nn<-dn?bn|=4:nn>dn&&(bn|=8),bn}return Pn(Er,function(on){var nn,dn,bn,sn,_n;return{lineStart:function(){sn=bn=!1,_n=1},point:function(zn,jn){var ea,Yr=[zn,jn],Kn=Er(zn,jn),En=jt?Kn?0:qr(zn,jn):Kn?qr(zn+(zn<0?i:-i),jn):0;if(!nn&&(sn=bn=Kn)&&on.lineStart(),Kn!==bn&&(!(ea=Or(nn,Yr))||yr(nn,ea)||yr(Yr,ea))&&(Yr[2]=1),Kn!==bn)_n=0,Kn?(on.lineStart(),ea=Or(Yr,nn),on.point(ea[0],ea[1])):(ea=Or(nn,Yr),on.point(ea[0],ea[1],2),on.lineEnd()),nn=ea;else if(or&&nn&&jt^Kn){var Bn;En&dn||!(Bn=Or(Yr,nn,!0))||(_n=0,jt?(on.lineStart(),on.point(Bn[0][0],Bn[0][1]),on.point(Bn[1][0],Bn[1][1]),on.lineEnd()):(on.point(Bn[1][0],Bn[1][1]),on.lineEnd(),on.lineStart(),on.point(Bn[0][0],Bn[0][1],3)))}!Kn||nn&&yr(nn,Yr)||on.point(Yr[0],Yr[1]),nn=Yr,bn=Kn,dn=En},lineEnd:function(){bn&&on.lineEnd(),nn=null},clean:function(){return _n|(sn&&bn)<<1}}},function(on,nn,dn,bn){mr(bn,ct,ir,dn,on,nn)},jt?[0,-ct]:[-i,ct-i])}function Qr(ct,zt,ir,jt){function or(nn,dn){return ct<=nn&&nn<=ir&&zt<=dn&&dn<=jt}function Er(nn,dn,bn,sn){var _n=0,zn=0;if(nn==null||(_n=Or(nn,bn))!==(zn=Or(dn,bn))||on(nn,dn)<0^bn>0)do sn.point(_n===0||_n===3?ct:ir,_n>1?jt:zt);while((_n=(_n+bn+4)%4)!==zn);else sn.point(dn[0],dn[1])}function Or(nn,dn){return n(nn[0]-ct)<u?dn>0?0:3:n(nn[0]-ir)<u?dn>0?2:1:n(nn[1]-zt)<u?dn>0?1:0:dn>0?3:2}function qr(nn,dn){return on(nn.x,dn.x)}function on(nn,dn){var bn=Or(nn,1),sn=Or(dn,1);return bn!==sn?bn-sn:bn===0?dn[1]-nn[1]:bn===1?nn[0]-dn[0]:bn===2?nn[1]-dn[1]:dn[0]-nn[0]}return function(nn){var dn,bn,sn,_n,zn,jn,ea,Yr,Kn,En,Bn,Jn=nn,ba=fr(),Ma={point:kn,lineStart:function(){Ma.point=Ia,bn&&bn.push(sn=[]),En=!0,Kn=!1,ea=Yr=NaN},lineEnd:function(){dn&&(Ia(_n,zn),jn&&Kn&&ba.rejoin(),dn.push(ba.result())),Ma.point=kn,Kn&&Jn.lineEnd()},polygonStart:function(){Jn=ba,dn=[],bn=[],Bn=!0},polygonEnd:function(){var ka=function(){for(var wa=0,Ka=0,Qn=bn.length;Ka<Qn;++Ka)for(var Ga,Fi,Xo=bn[Ka],Io=1,po=Xo.length,ma=Xo[0],hi=ma[0],mo=ma[1];Io<po;++Io)Ga=hi,Fi=mo,ma=Xo[Io],hi=ma[0],mo=ma[1],Fi<=jt?mo>jt&&(hi-Ga)*(jt-Fi)>(mo-Fi)*(ct-Ga)&&++wa:mo<=jt&&(hi-Ga)*(jt-Fi)<(mo-Fi)*(ct-Ga)&&--wa;return wa}(),ha=Bn&&ka,Oa=(dn=m.merge(dn)).length;(ha||Oa)&&(nn.polygonStart(),ha&&(nn.lineStart(),Er(null,null,1,nn),nn.lineEnd()),Oa&&xr(dn,qr,ka,Er,nn),nn.polygonEnd()),Jn=nn,dn=bn=sn=null}};function kn(ka,ha){or(ka,ha)&&Jn.point(ka,ha)}function Ia(ka,ha){var Oa=or(ka,ha);if(bn&&sn.push([ka,ha]),En)_n=ka,zn=ha,jn=Oa,En=!1,Oa&&(Jn.lineStart(),Jn.point(ka,ha));else if(Oa&&Kn)Jn.point(ka,ha);else{var wa=[ea=Math.max(-1e9,Math.min(1e9,ea)),Yr=Math.max(-1e9,Math.min(1e9,Yr))],Ka=[ka=Math.max(-1e9,Math.min(1e9,ka)),ha=Math.max(-1e9,Math.min(1e9,ha))];(function(Qn,Ga,Fi,Xo,Io,po){var ma,hi=Qn[0],mo=Qn[1],Ya=0,_i=1,Ui=Ga[0]-hi,$a=Ga[1]-mo;if(ma=Fi-hi,Ui||!(ma>0)){if(ma/=Ui,Ui<0){if(ma<Ya)return;ma<_i&&(_i=ma)}else if(Ui>0){if(ma>_i)return;ma>Ya&&(Ya=ma)}if(ma=Io-hi,Ui||!(ma<0)){if(ma/=Ui,Ui<0){if(ma>_i)return;ma>Ya&&(Ya=ma)}else if(Ui>0){if(ma<Ya)return;ma<_i&&(_i=ma)}if(ma=Xo-mo,$a||!(ma>0)){if(ma/=$a,$a<0){if(ma<Ya)return;ma<_i&&(_i=ma)}else if($a>0){if(ma>_i)return;ma>Ya&&(Ya=ma)}if(ma=po-mo,$a||!(ma<0)){if(ma/=$a,$a<0){if(ma>_i)return;ma>Ya&&(Ya=ma)}else if($a>0){if(ma<Ya)return;ma<_i&&(_i=ma)}return Ya>0&&(Qn[0]=hi+Ya*Ui,Qn[1]=mo+Ya*$a),_i<1&&(Ga[0]=hi+_i*Ui,Ga[1]=mo+_i*$a),!0}}}}})(wa,Ka,ct,zt,ir,jt)?(Kn||(Jn.lineStart(),Jn.point(wa[0],wa[1])),Jn.point(Ka[0],Ka[1]),Oa||Jn.lineEnd(),Bn=!1):Oa&&(Jn.lineStart(),Jn.point(ka,ha),Bn=!1)}ea=ka,Yr=ha,Kn=Oa}return Ma}}var $r,Kr,en,Tn=g(),Mn={sphere:P,point:P,lineStart:function(){Mn.point=Zt,Mn.lineEnd=Rn},lineEnd:P,polygonStart:P,polygonEnd:P};function Rn(){Mn.point=Mn.lineEnd=P}function Zt(ct,zt){$r=ct*=r,Kr=A(zt*=r),en=y(zt),Mn.point=Ct}function Ct(ct,zt){ct*=r;var ir=A(zt*=r),jt=y(zt),or=n(ct-$r),Er=y(or),Or=jt*A(or),qr=en*ir-Kr*jt*Er,on=Kr*ir+en*jt*Er;Tn.add(l(w(Or*Or+qr*qr),on)),$r=ct,Kr=ir,en=jt}function Ht(ct){return Tn.reset(),Q(ct,Mn),+Tn}var cr=[null,null],_r={type:"LineString",coordinates:cr};function Vr(ct,zt){return cr[0]=ct,cr[1]=zt,Ht(_r)}var jr={Feature:function(ct,zt){return br(ct.geometry,zt)},FeatureCollection:function(ct,zt){for(var ir=ct.features,jt=-1,or=ir.length;++jt<or;)if(br(ir[jt].geometry,zt))return!0;return!1}},vr={Sphere:function(){return!0},Point:function(ct,zt){return Ar(ct.coordinates,zt)},MultiPoint:function(ct,zt){for(var ir=ct.coordinates,jt=-1,or=ir.length;++jt<or;)if(Ar(ir[jt],zt))return!0;return!1},LineString:function(ct,zt){return kr(ct.coordinates,zt)},MultiLineString:function(ct,zt){for(var ir=ct.coordinates,jt=-1,or=ir.length;++jt<or;)if(kr(ir[jt],zt))return!0;return!1},Polygon:function(ct,zt){return Cr(ct.coordinates,zt)},MultiPolygon:function(ct,zt){for(var ir=ct.coordinates,jt=-1,or=ir.length;++jt<or;)if(Cr(ir[jt],zt))return!0;return!1},GeometryCollection:function(ct,zt){for(var ir=ct.geometries,jt=-1,or=ir.length;++jt<or;)if(br(ir[jt],zt))return!0;return!1}};function br(ct,zt){return!(!ct||!vr.hasOwnProperty(ct.type))&&vr[ct.type](ct,zt)}function Ar(ct,zt){return Vr(ct,zt)===0}function kr(ct,zt){for(var ir,jt,or,Er=0,Or=ct.length;Er<Or;Er++){if((jt=Vr(ct[Er],zt))===0||Er>0&&(or=Vr(ct[Er],ct[Er-1]))>0&&ir<=or&&jt<=or&&(ir+jt-or)*(1-Math.pow((ir-jt)/or,2))<1e-12*or)return!0;ir=jt}return!1}function Cr(ct,zt){return!!Cn(ct.map(Hr),ln(zt))}function Hr(ct){return(ct=ct.map(ln)).pop(),ct}function ln(ct){return[ct[0]*r,ct[1]*r]}function xn(ct,zt,ir){var jt=m.range(ct,zt-u,ir).concat(zt);return function(or){return jt.map(function(Er){return[or,Er]})}}function Zr(ct,zt,ir){var jt=m.range(ct,zt-u,ir).concat(zt);return function(or){return jt.map(function(Er){return[Er,or]})}}function yn(){var ct,zt,ir,jt,or,Er,Or,qr,on,nn,dn,bn,sn=10,_n=sn,zn=90,jn=360,ea=2.5;function Yr(){return{type:"MultiLineString",coordinates:Kn()}}function Kn(){return m.range(v(jt/zn)*zn,ir,zn).map(dn).concat(m.range(v(qr/jn)*jn,Or,jn).map(bn)).concat(m.range(v(zt/sn)*sn,ct,sn).filter(function(En){return n(En%zn)>u}).map(on)).concat(m.range(v(Er/_n)*_n,or,_n).filter(function(En){return n(En%jn)>u}).map(nn))}return Yr.lines=function(){return Kn().map(function(En){return{type:"LineString",coordinates:En}})},Yr.outline=function(){return{type:"Polygon",coordinates:[dn(jt).concat(bn(Or).slice(1),dn(ir).reverse().slice(1),bn(qr).reverse().slice(1))]}},Yr.extent=function(En){return arguments.length?Yr.extentMajor(En).extentMinor(En):Yr.extentMinor()},Yr.extentMajor=function(En){return arguments.length?(jt=+En[0][0],ir=+En[1][0],qr=+En[0][1],Or=+En[1][1],jt>ir&&(En=jt,jt=ir,ir=En),qr>Or&&(En=qr,qr=Or,Or=En),Yr.precision(ea)):[[jt,qr],[ir,Or]]},Yr.extentMinor=function(En){return arguments.length?(zt=+En[0][0],ct=+En[1][0],Er=+En[0][1],or=+En[1][1],zt>ct&&(En=zt,zt=ct,ct=En),Er>or&&(En=Er,Er=or,or=En),Yr.precision(ea)):[[zt,Er],[ct,or]]},Yr.step=function(En){return arguments.length?Yr.stepMajor(En).stepMinor(En):Yr.stepMinor()},Yr.stepMajor=function(En){return arguments.length?(zn=+En[0],jn=+En[1],Yr):[zn,jn]},Yr.stepMinor=function(En){return arguments.length?(sn=+En[0],_n=+En[1],Yr):[sn,_n]},Yr.precision=function(En){return arguments.length?(ea=+En,on=xn(Er,or,90),nn=Zr(zt,ct,ea),dn=xn(qr,Or,90),bn=Zr(jt,ir,ea),Yr):ea},Yr.extentMajor([[-180,-90+u],[180,90-u]]).extentMinor([[-180,-80-u],[180,80+u]])}function Ir(ct){return ct}var Gr,mn,hn,Ln,ia=g(),qn=g(),gn={point:P,lineStart:P,lineEnd:P,polygonStart:function(){gn.lineStart=ta,gn.lineEnd=Pi},polygonEnd:function(){gn.lineStart=gn.lineEnd=gn.point=P,ia.add(n(qn)),qn.reset()},result:function(){var ct=ia/2;return ia.reset(),ct}};function ta(){gn.point=fa}function fa(ct,zt){gn.point=Za,Gr=hn=ct,mn=Ln=zt}function Za(ct,zt){qn.add(Ln*ct-hn*zt),hn=ct,Ln=zt}function Pi(){Za(Gr,mn)}var ni=1/0,yi=ni,Aa=-ni,ja=Aa,co={point:function(ct,zt){ct<ni&&(ni=ct),ct>Aa&&(Aa=ct),zt<yi&&(yi=zt),zt>ja&&(ja=zt)},lineStart:P,lineEnd:P,polygonStart:P,polygonEnd:P,result:function(){var ct=[[ni,yi],[Aa,ja]];return Aa=ja=-(yi=ni=1/0),ct}},Bo,Wo,qi,Wi,No=0,Ha=0,ko=0,uo=0,xi=0,Xi=0,fo=0,_o=0,Di=0,fi={point:Gi,lineStart:ys,lineEnd:hs,polygonStart:function(){fi.lineStart=Qo,fi.lineEnd=Ts},polygonEnd:function(){fi.point=Gi,fi.lineStart=ys,fi.lineEnd=hs},result:function(){var ct=Di?[fo/Di,_o/Di]:Xi?[uo/Xi,xi/Xi]:ko?[No/ko,Ha/ko]:[NaN,NaN];return No=Ha=ko=uo=xi=Xi=fo=_o=Di=0,ct}};function Gi(ct,zt){No+=ct,Ha+=zt,++ko}function ys(){fi.point=ws}function ws(ct,zt){fi.point=qa,Gi(qi=ct,Wi=zt)}function qa(ct,zt){var ir=ct-qi,jt=zt-Wi,or=w(ir*ir+jt*jt);uo+=or*(qi+ct)/2,xi+=or*(Wi+zt)/2,Xi+=or,Gi(qi=ct,Wi=zt)}function hs(){fi.point=Gi}function Qo(){fi.point=ks}function Ts(){xs(Bo,Wo)}function ks(ct,zt){fi.point=xs,Gi(Bo=qi=ct,Wo=Wi=zt)}function xs(ct,zt){var ir=ct-qi,jt=zt-Wi,or=w(ir*ir+jt*jt);uo+=or*(qi+ct)/2,xi+=or*(Wi+zt)/2,Xi+=or,fo+=(or=Wi*ct-qi*zt)*(qi+ct),_o+=or*(Wi+zt),Di+=3*or,Gi(qi=ct,Wi=zt)}function As(ct){this._context=ct}As.prototype={_radius:4.5,pointRadius:function(ct){return this._radius=ct,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(ct,zt){switch(this._point){case 0:this._context.moveTo(ct,zt),this._point=1;break;case 1:this._context.lineTo(ct,zt);break;default:this._context.moveTo(ct+this._radius,zt),this._context.arc(ct,zt,this._radius,0,a)}},result:P};var Ao,Mo,jo,Uo,Vo,$o=g(),ho={point:P,lineStart:function(){ho.point=ps},lineEnd:function(){Ao&&oo(Mo,jo),ho.point=P},polygonStart:function(){Ao=!0},polygonEnd:function(){Ao=null},result:function(){var ct=+$o;return $o.reset(),ct}};function ps(ct,zt){ho.point=oo,Mo=Uo=ct,jo=Vo=zt}function oo(ct,zt){Uo-=ct,Vo-=zt,$o.add(w(Uo*Uo+Vo*Vo)),Uo=ct,Vo=zt}function Ho(){this._string=[]}function ds(ct){return"m0,"+ct+"a"+ct+","+ct+" 0 1,1 0,"+-2*ct+"a"+ct+","+ct+" 0 1,1 0,"+2*ct+"z"}function So(ct){return function(zt){var ir=new Ua;for(var jt in ct)ir[jt]=ct[jt];return ir.stream=zt,ir}}function Ua(){}function Re(ct,zt,ir){var jt=ct.clipExtent&&ct.clipExtent();return ct.scale(150).translate([0,0]),jt!=null&&ct.clipExtent(null),Q(ir,ct.stream(co)),zt(co.result()),jt!=null&&ct.clipExtent(jt),ct}function Ve(ct,zt,ir){return Re(ct,function(jt){var or=zt[1][0]-zt[0][0],Er=zt[1][1]-zt[0][1],Or=Math.min(or/(jt[1][0]-jt[0][0]),Er/(jt[1][1]-jt[0][1])),qr=+zt[0][0]+(or-Or*(jt[1][0]+jt[0][0]))/2,on=+zt[0][1]+(Er-Or*(jt[1][1]+jt[0][1]))/2;ct.scale(150*Or).translate([qr,on])},ir)}function Ke(ct,zt,ir){return Ve(ct,[[0,0],zt],ir)}function at(ct,zt,ir){return Re(ct,function(jt){var or=+zt,Er=or/(jt[1][0]-jt[0][0]),Or=(or-Er*(jt[1][0]+jt[0][0]))/2,qr=-Er*jt[0][1];ct.scale(150*Er).translate([Or,qr])},ir)}function dt(ct,zt,ir){return Re(ct,function(jt){var or=+zt,Er=or/(jt[1][1]-jt[0][1]),Or=-Er*jt[0][0],qr=(or-Er*(jt[1][1]+jt[0][1]))/2;ct.scale(150*Er).translate([Or,qr])},ir)}Ho.prototype={_radius:4.5,_circle:ds(4.5),pointRadius:function(ct){return(ct=+ct)!==this._radius&&(this._radius=ct,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(ct,zt){switch(this._point){case 0:this._string.push("M",ct,",",zt),this._point=1;break;case 1:this._string.push("L",ct,",",zt);break;default:this._circle==null&&(this._circle=ds(this._radius)),this._string.push("M",ct,",",zt,this._circle)}},result:function(){if(this._string.length){var ct=this._string.join("");return this._string=[],ct}return null}},Ua.prototype={constructor:Ua,point:function(ct,zt){this.stream.point(ct,zt)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var ht=y(30*r);function Mt(ct,zt){return+zt?function(ir,jt){function or(Er,Or,qr,on,nn,dn,bn,sn,_n,zn,jn,ea,Yr,Kn){var En=bn-Er,Bn=sn-Or,Jn=En*En+Bn*Bn;if(Jn>4*jt&&Yr--){var ba=on+zn,Ma=nn+jn,kn=dn+ea,Ia=w(ba*ba+Ma*Ma+kn*kn),ka=C(kn/=Ia),ha=n(n(kn)-1)<u||n(qr-_n)<u?(qr+_n)/2:l(Ma,ba),Oa=ir(ha,ka),wa=Oa[0],Ka=Oa[1],Qn=wa-Er,Ga=Ka-Or,Fi=Bn*Qn-En*Ga;(Fi*Fi/Jn>jt||n((En*Qn+Bn*Ga)/Jn-.5)>.3||on*zn+nn*jn+dn*ea<ht)&&(or(Er,Or,qr,on,nn,dn,wa,Ka,ha,ba/=Ia,Ma/=Ia,kn,Yr,Kn),Kn.point(wa,Ka),or(wa,Ka,ha,ba,Ma,kn,bn,sn,_n,zn,jn,ea,Yr,Kn))}}return function(Er){var Or,qr,on,nn,dn,bn,sn,_n,zn,jn,ea,Yr,Kn={point:En,lineStart:Bn,lineEnd:ba,polygonStart:function(){Er.polygonStart(),Kn.lineStart=Ma},polygonEnd:function(){Er.polygonEnd(),Kn.lineStart=Bn}};function En(ka,ha){ka=ir(ka,ha),Er.point(ka[0],ka[1])}function Bn(){_n=NaN,Kn.point=Jn,Er.lineStart()}function Jn(ka,ha){var Oa=he([ka,ha]),wa=ir(ka,ha);or(_n,zn,sn,jn,ea,Yr,_n=wa[0],zn=wa[1],sn=ka,jn=Oa[0],ea=Oa[1],Yr=Oa[2],16,Er),Er.point(_n,zn)}function ba(){Kn.point=En,Er.lineEnd()}function Ma(){Bn(),Kn.point=kn,Kn.lineEnd=Ia}function kn(ka,ha){Jn(Or=ka,ha),qr=_n,on=zn,nn=jn,dn=ea,bn=Yr,Kn.point=Jn}function Ia(){or(_n,zn,sn,jn,ea,Yr,qr,on,Or,nn,dn,bn,16,Er),Kn.lineEnd=ba,ba()}return Kn}}(ct,zt):function(ir){return So({point:function(jt,or){jt=ir(jt,or),this.stream.point(jt[0],jt[1])}})}(ct)}var Wt=So({point:function(ct,zt){this.stream.point(ct*r,zt*r)}});function Jt(ct,zt,ir,jt,or){function Er(Or,qr){return[zt+ct*(Or*=jt),ir-ct*(qr*=or)]}return Er.invert=function(Or,qr){return[(Or-zt)/ct*jt,(ir-qr)/ct*or]},Er}function qt(ct,zt,ir,jt,or,Er){var Or=y(Er),qr=A(Er),on=Or*ct,nn=qr*ct,dn=Or/ct,bn=qr/ct,sn=(qr*ir-Or*zt)/ct,_n=(qr*zt+Or*ir)/ct;function zn(jn,ea){return[on*(jn*=jt)-nn*(ea*=or)+zt,ir-nn*jn-on*ea]}return zn.invert=function(jn,ea){return[jt*(dn*jn-bn*ea+sn),or*(_n-bn*jn-dn*ea)]},zn}function tr(ct){return lr(function(){return ct})()}function lr(ct){var zt,ir,jt,or,Er,Or,qr,on,nn,dn,bn=150,sn=480,_n=250,zn=0,jn=0,ea=0,Yr=0,Kn=0,En=0,Bn=1,Jn=1,ba=null,Ma=Fr,kn=null,Ia=Ir,ka=.5;function ha(Qn){return on(Qn[0]*r,Qn[1]*r)}function Oa(Qn){return(Qn=on.invert(Qn[0],Qn[1]))&&[Qn[0]*c,Qn[1]*c]}function wa(){var Qn=qt(bn,0,0,Bn,Jn,En).apply(null,zt(zn,jn)),Ga=(En?qt:Jt)(bn,sn-Qn[0],_n-Qn[1],Bn,Jn,En);return ir=nr(ea,Yr,Kn),qr=Pt(zt,Ga),on=Pt(ir,qr),Or=Mt(qr,ka),Ka()}function Ka(){return nn=dn=null,ha}return ha.stream=function(Qn){return nn&&dn===Qn?nn:nn=Wt(function(Ga){return So({point:function(Fi,Xo){var Io=Ga(Fi,Xo);return this.stream.point(Io[0],Io[1])}})}(ir)(Ma(Or(Ia(dn=Qn)))))},ha.preclip=function(Qn){return arguments.length?(Ma=Qn,ba=void 0,Ka()):Ma},ha.postclip=function(Qn){return arguments.length?(Ia=Qn,kn=jt=or=Er=null,Ka()):Ia},ha.clipAngle=function(Qn){return arguments.length?(Ma=+Qn?Lr(ba=Qn*r):(ba=null,Fr),Ka()):ba*c},ha.clipExtent=function(Qn){return arguments.length?(Ia=Qn==null?(kn=jt=or=Er=null,Ir):Qr(kn=+Qn[0][0],jt=+Qn[0][1],or=+Qn[1][0],Er=+Qn[1][1]),Ka()):kn==null?null:[[kn,jt],[or,Er]]},ha.scale=function(Qn){return arguments.length?(bn=+Qn,wa()):bn},ha.translate=function(Qn){return arguments.length?(sn=+Qn[0],_n=+Qn[1],wa()):[sn,_n]},ha.center=function(Qn){return arguments.length?(zn=Qn[0]%360*r,jn=Qn[1]%360*r,wa()):[zn*c,jn*c]},ha.rotate=function(Qn){return arguments.length?(ea=Qn[0]%360*r,Yr=Qn[1]%360*r,Kn=Qn.length>2?Qn[2]%360*r:0,wa()):[ea*c,Yr*c,Kn*c]},ha.angle=function(Qn){return arguments.length?(En=Qn%360*r,wa()):En*c},ha.reflectX=function(Qn){return arguments.length?(Bn=Qn?-1:1,wa()):Bn<0},ha.reflectY=function(Qn){return arguments.length?(Jn=Qn?-1:1,wa()):Jn<0},ha.precision=function(Qn){return arguments.length?(Or=Mt(qr,ka=Qn*Qn),Ka()):w(ka)},ha.fitExtent=function(Qn,Ga){return Ve(ha,Qn,Ga)},ha.fitSize=function(Qn,Ga){return Ke(ha,Qn,Ga)},ha.fitWidth=function(Qn,Ga){return at(ha,Qn,Ga)},ha.fitHeight=function(Qn,Ga){return dt(ha,Qn,Ga)},function(){return zt=ct.apply(this,arguments),ha.invert=zt.invert&&Oa,wa()}}function dr(ct){var zt=0,ir=i/3,jt=lr(ct),or=jt(zt,ir);return or.parallels=function(Er){return arguments.length?jt(zt=Er[0]*r,ir=Er[1]*r):[zt*c,ir*c]},or}function gr(ct,zt){var ir=A(ct),jt=(ir+A(zt))/2;if(n(jt)<u)return function(qr){var on=y(qr);function nn(dn,bn){return[dn*on,A(bn)/on]}return nn.invert=function(dn,bn){return[dn/on,C(bn*on)]},nn}(ct);var or=1+ir*(2*jt-ir),Er=w(or)/jt;function Or(qr,on){var nn=w(or-2*jt*A(on))/jt;return[nn*A(qr*=jt),Er-nn*y(qr)]}return Or.invert=function(qr,on){var nn=Er-on,dn=l(qr,n(nn))*S(nn);return nn*jt<0&&(dn-=i*S(qr)*S(nn)),[dn/jt,C((or-(qr*qr+nn*nn)*jt*jt)/(2*jt))]},Or}function Pr(){return dr(gr).scale(155.424).center([0,33.6442])}function tn(){return Pr().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function pn(ct){return function(zt,ir){var jt=y(zt),or=y(ir),Er=ct(jt*or);return[Er*or*A(zt),Er*A(ir)]}}function Sn(ct){return function(zt,ir){var jt=w(zt*zt+ir*ir),or=ct(jt),Er=A(or),Or=y(or);return[l(zt*Er,jt*Or),C(jt&&ir*Er/jt)]}}var In=pn(function(ct){return w(2/(1+ct))});In.invert=Sn(function(ct){return 2*C(ct/2)});var Un=pn(function(ct){return(ct=k(ct))&&ct/A(ct)});function On(ct,zt){return[ct,x(L((s+zt)/2))]}function pa(ct){var zt,ir,jt,or=tr(ct),Er=or.center,Or=or.scale,qr=or.translate,on=or.clipExtent,nn=null;function dn(){var bn=i*Or(),sn=or(hr(or.rotate()).invert([0,0]));return on(nn==null?[[sn[0]-bn,sn[1]-bn],[sn[0]+bn,sn[1]+bn]]:ct===On?[[Math.max(sn[0]-bn,nn),zt],[Math.min(sn[0]+bn,ir),jt]]:[[nn,Math.max(sn[1]-bn,zt)],[ir,Math.min(sn[1]+bn,jt)]])}return or.scale=function(bn){return arguments.length?(Or(bn),dn()):Or()},or.translate=function(bn){return arguments.length?(qr(bn),dn()):qr()},or.center=function(bn){return arguments.length?(Er(bn),dn()):Er()},or.clipExtent=function(bn){return arguments.length?(bn==null?nn=zt=ir=jt=null:(nn=+bn[0][0],zt=+bn[0][1],ir=+bn[1][0],jt=+bn[1][1]),dn()):nn==null?null:[[nn,zt],[ir,jt]]},dn()}function _a(ct){return L((s+ct)/2)}function Ra(ct,zt){var ir=y(ct),jt=ct===zt?A(ct):x(ir/y(zt))/x(_a(zt)/_a(ct)),or=ir*T(_a(ct),jt)/jt;if(!jt)return On;function Er(Or,qr){or>0?qr<-s+u&&(qr=-s+u):qr>s-u&&(qr=s-u);var on=or/T(_a(qr),jt);return[on*A(jt*Or),or-on*y(jt*Or)]}return Er.invert=function(Or,qr){var on=or-qr,nn=S(jt)*w(Or*Or+on*on),dn=l(Or,n(on))*S(on);return on*jt<0&&(dn-=i*S(Or)*S(on)),[dn/jt,2*d(T(or/nn,1/jt))-s]},Er}function Da(ct,zt){return[ct,zt]}function Fa(ct,zt){var ir=y(ct),jt=ct===zt?A(ct):(ir-y(zt))/(zt-ct),or=ir/jt+ct;if(n(jt)<u)return Da;function Er(Or,qr){var on=or-qr,nn=jt*Or;return[on*A(nn),or-on*y(nn)]}return Er.invert=function(Or,qr){var on=or-qr,nn=l(Or,n(on))*S(on);return on*jt<0&&(nn-=i*S(Or)*S(on)),[nn/jt,or-S(jt)*w(Or*Or+on*on)]},Er}Un.invert=Sn(function(ct){return ct}),On.invert=function(ct,zt){return[ct,2*d(_(zt))-s]},Da.invert=Da;var bi=1.340264,gi=-.081106,ai=893e-6,ii=.003796,vi=w(3)/2;function Ri(ct,zt){var ir=C(vi*A(zt)),jt=ir*ir,or=jt*jt*jt;return[ct*y(ir)/(vi*(bi+3*gi*jt+or*(7*ai+9*ii*jt))),ir*(bi+gi*jt+or*(ai+ii*jt))]}function Zi(ct,zt){var ir=y(zt),jt=y(ct)*ir;return[ir*A(ct)/jt,A(zt)/jt]}function Ji(ct,zt){var ir=zt*zt,jt=ir*ir;return[ct*(.8707-.131979*ir+jt*(jt*(.003971*ir-.001529*jt)-.013791)),zt*(1.007226+ir*(.015085+jt*(.028874*ir-.044475-.005916*jt)))]}function Ki(ct,zt){return[y(zt)*A(ct),A(zt)]}function Qi(ct,zt){var ir=y(zt),jt=1+y(ct)*ir;return[ir*A(ct)/jt,A(zt)/jt]}function Pa(ct,zt){return[x(L((s+zt)/2)),-ct]}Ri.invert=function(ct,zt){for(var ir,jt=zt,or=jt*jt,Er=or*or*or,Or=0;Or<12&&(Er=(or=(jt-=ir=(jt*(bi+gi*or+Er*(ai+ii*or))-zt)/(bi+3*gi*or+Er*(7*ai+9*ii*or)))*jt)*or*or,!(n(ir)<1e-12));++Or);return[vi*ct*(bi+3*gi*or+Er*(7*ai+9*ii*or))/y(jt),C(A(jt)/vi)]},Zi.invert=Sn(d),Ji.invert=function(ct,zt){var ir,jt=zt,or=25;do{var Er=jt*jt,Or=Er*Er;jt-=ir=(jt*(1.007226+Er*(.015085+Or*(.028874*Er-.044475-.005916*Or)))-zt)/(1.007226+Er*(.045255+Or*(.259866*Er-.311325-.005916*11*Or)))}while(n(ir)>u&&--or>0);return[ct/(.8707+(Er=jt*jt)*(Er*(Er*Er*Er*(.003971-.001529*Er)-.013791)-.131979)),jt]},Ki.invert=Sn(C),Qi.invert=Sn(function(ct){return 2*d(ct)}),Pa.invert=function(ct,zt){return[-zt,2*d(_(ct))-s]},t.geoAlbers=tn,t.geoAlbersUsa=function(){var ct,zt,ir,jt,or,Er,Or=tn(),qr=Pr().rotate([154,0]).center([-2,58.5]).parallels([55,65]),on=Pr().rotate([157,0]).center([-3,19.9]).parallels([8,18]),nn={point:function(sn,_n){Er=[sn,_n]}};function dn(sn){var _n=sn[0],zn=sn[1];return Er=null,ir.point(_n,zn),Er||(jt.point(_n,zn),Er)||(or.point(_n,zn),Er)}function bn(){return ct=zt=null,dn}return dn.invert=function(sn){var _n=Or.scale(),zn=Or.translate(),jn=(sn[0]-zn[0])/_n,ea=(sn[1]-zn[1])/_n;return(ea>=.12&&ea<.234&&jn>=-.425&&jn<-.214?qr:ea>=.166&&ea<.234&&jn>=-.214&&jn<-.115?on:Or).invert(sn)},dn.stream=function(sn){return ct&&zt===sn?ct:(_n=[Or.stream(zt=sn),qr.stream(sn),on.stream(sn)],zn=_n.length,ct={point:function(jn,ea){for(var Yr=-1;++Yr<zn;)_n[Yr].point(jn,ea)},sphere:function(){for(var jn=-1;++jn<zn;)_n[jn].sphere()},lineStart:function(){for(var jn=-1;++jn<zn;)_n[jn].lineStart()},lineEnd:function(){for(var jn=-1;++jn<zn;)_n[jn].lineEnd()},polygonStart:function(){for(var jn=-1;++jn<zn;)_n[jn].polygonStart()},polygonEnd:function(){for(var jn=-1;++jn<zn;)_n[jn].polygonEnd()}});var _n,zn},dn.precision=function(sn){return arguments.length?(Or.precision(sn),qr.precision(sn),on.precision(sn),bn()):Or.precision()},dn.scale=function(sn){return arguments.length?(Or.scale(sn),qr.scale(.35*sn),on.scale(sn),dn.translate(Or.translate())):Or.scale()},dn.translate=function(sn){if(!arguments.length)return Or.translate();var _n=Or.scale(),zn=+sn[0],jn=+sn[1];return ir=Or.translate(sn).clipExtent([[zn-.455*_n,jn-.238*_n],[zn+.455*_n,jn+.238*_n]]).stream(nn),jt=qr.translate([zn-.307*_n,jn+.201*_n]).clipExtent([[zn-.425*_n+u,jn+.12*_n+u],[zn-.214*_n-u,jn+.234*_n-u]]).stream(nn),or=on.translate([zn-.205*_n,jn+.212*_n]).clipExtent([[zn-.214*_n+u,jn+.166*_n+u],[zn-.115*_n-u,jn+.234*_n-u]]).stream(nn),bn()},dn.fitExtent=function(sn,_n){return Ve(dn,sn,_n)},dn.fitSize=function(sn,_n){return Ke(dn,sn,_n)},dn.fitWidth=function(sn,_n){return at(dn,sn,_n)},dn.fitHeight=function(sn,_n){return dt(dn,sn,_n)},dn.scale(1070)},t.geoArea=function(ct){return q.reset(),Q(ct,ee),2*q},t.geoAzimuthalEqualArea=function(){return tr(In).scale(124.75).clipAngle(179.999)},t.geoAzimuthalEqualAreaRaw=In,t.geoAzimuthalEquidistant=function(){return tr(Un).scale(79.4188).clipAngle(179.999)},t.geoAzimuthalEquidistantRaw=Un,t.geoBounds=function(ct){var zt,ir,jt,or,Er,Or,qr;if(ue=xe=-(Ee=be=1/0),De=[],Q(ct,He),ir=De.length){for(De.sort(kt),zt=1,Er=[jt=De[0]];zt<ir;++zt)ft(jt,(or=De[zt])[0])||ft(jt,or[1])?(ut(jt[0],or[1])>ut(jt[0],jt[1])&&(jt[1]=or[1]),ut(or[0],jt[1])>ut(jt[0],jt[1])&&(jt[0]=or[0])):Er.push(jt=or);for(Or=-1/0,zt=0,jt=Er[ir=Er.length-1];zt<=ir;jt=or,++zt)or=Er[zt],(qr=ut(jt[1],or[0]))>Or&&(Or=qr,Ee=or[0],xe=jt[1])}return De=Fe=null,Ee===1/0||be===1/0?[[NaN,NaN],[NaN,NaN]]:[[Ee,be],[xe,ue]]},t.geoCentroid=function(ct){Ye=et=Oe=je=We=Ge=Qe=it=lt=Lt=wt=0,Q(ct,Et);var zt=lt,ir=Lt,jt=wt,or=zt*zt+ir*ir+jt*jt;return or<1e-12&&(zt=Ge,ir=Qe,jt=it,et<u&&(zt=Oe,ir=je,jt=We),(or=zt*zt+ir*ir+jt*jt)<1e-12)?[NaN,NaN]:[l(ir,zt)*c,C(jt/w(or))*c]},t.geoCircle=function(){var ct,zt,ir=bt([0,0]),jt=bt(90),or=bt(6),Er={point:function(qr,on){ct.push(qr=zt(qr,on)),qr[0]*=c,qr[1]*=c}};function Or(){var qr=ir.apply(this,arguments),on=jt.apply(this,arguments)*r,nn=or.apply(this,arguments)*r;return ct=[],zt=nr(-qr[0]*r,-qr[1]*r,0).invert,mr(Er,on,nn,1),qr={type:"Polygon",coordinates:[ct]},ct=zt=null,qr}return Or.center=function(qr){return arguments.length?(ir=typeof qr=="function"?qr:bt([+qr[0],+qr[1]]),Or):ir},Or.radius=function(qr){return arguments.length?(jt=typeof qr=="function"?qr:bt(+qr),Or):jt},Or.precision=function(qr){return arguments.length?(or=typeof qr=="function"?qr:bt(+qr),Or):or},Or},t.geoClipAntimeridian=Fr,t.geoClipCircle=Lr,t.geoClipExtent=function(){var ct,zt,ir,jt=0,or=0,Er=960,Or=500;return ir={stream:function(qr){return ct&&zt===qr?ct:ct=Qr(jt,or,Er,Or)(zt=qr)},extent:function(qr){return arguments.length?(jt=+qr[0][0],or=+qr[0][1],Er=+qr[1][0],Or=+qr[1][1],ct=zt=null,ir):[[jt,or],[Er,Or]]}}},t.geoClipRectangle=Qr,t.geoConicConformal=function(){return dr(Ra).scale(109.5).parallels([30,30])},t.geoConicConformalRaw=Ra,t.geoConicEqualArea=Pr,t.geoConicEqualAreaRaw=gr,t.geoConicEquidistant=function(){return dr(Fa).scale(131.154).center([0,13.9389])},t.geoConicEquidistantRaw=Fa,t.geoContains=function(ct,zt){return(ct&&jr.hasOwnProperty(ct.type)?jr[ct.type]:br)(ct,zt)},t.geoDistance=Vr,t.geoEqualEarth=function(){return tr(Ri).scale(177.158)},t.geoEqualEarthRaw=Ri,t.geoEquirectangular=function(){return tr(Da).scale(152.63)},t.geoEquirectangularRaw=Da,t.geoGnomonic=function(){return tr(Zi).scale(144.049).clipAngle(60)},t.geoGnomonicRaw=Zi,t.geoGraticule=yn,t.geoGraticule10=function(){return yn()()},t.geoIdentity=function(){var ct,zt,ir,jt,or,Er,Or,qr=1,on=0,nn=0,dn=1,bn=1,sn=0,_n=null,zn=1,jn=1,ea=So({point:function(Bn,Jn){var ba=En([Bn,Jn]);this.stream.point(ba[0],ba[1])}}),Yr=Ir;function Kn(){return zn=qr*dn,jn=qr*bn,Er=Or=null,En}function En(Bn){var Jn=Bn[0]*zn,ba=Bn[1]*jn;if(sn){var Ma=ba*ct-Jn*zt;Jn=Jn*ct+ba*zt,ba=Ma}return[Jn+on,ba+nn]}return En.invert=function(Bn){var Jn=Bn[0]-on,ba=Bn[1]-nn;if(sn){var Ma=ba*ct+Jn*zt;Jn=Jn*ct-ba*zt,ba=Ma}return[Jn/zn,ba/jn]},En.stream=function(Bn){return Er&&Or===Bn?Er:Er=ea(Yr(Or=Bn))},En.postclip=function(Bn){return arguments.length?(Yr=Bn,_n=ir=jt=or=null,Kn()):Yr},En.clipExtent=function(Bn){return arguments.length?(Yr=Bn==null?(_n=ir=jt=or=null,Ir):Qr(_n=+Bn[0][0],ir=+Bn[0][1],jt=+Bn[1][0],or=+Bn[1][1]),Kn()):_n==null?null:[[_n,ir],[jt,or]]},En.scale=function(Bn){return arguments.length?(qr=+Bn,Kn()):qr},En.translate=function(Bn){return arguments.length?(on=+Bn[0],nn=+Bn[1],Kn()):[on,nn]},En.angle=function(Bn){return arguments.length?(zt=A(sn=Bn%360*r),ct=y(sn),Kn()):sn*c},En.reflectX=function(Bn){return arguments.length?(dn=Bn?-1:1,Kn()):dn<0},En.reflectY=function(Bn){return arguments.length?(bn=Bn?-1:1,Kn()):bn<0},En.fitExtent=function(Bn,Jn){return Ve(En,Bn,Jn)},En.fitSize=function(Bn,Jn){return Ke(En,Bn,Jn)},En.fitWidth=function(Bn,Jn){return at(En,Bn,Jn)},En.fitHeight=function(Bn,Jn){return dt(En,Bn,Jn)},En},t.geoInterpolate=function(ct,zt){var ir=ct[0]*r,jt=ct[1]*r,or=zt[0]*r,Er=zt[1]*r,Or=y(jt),qr=A(jt),on=y(Er),nn=A(Er),dn=Or*y(ir),bn=Or*A(ir),sn=on*y(or),_n=on*A(or),zn=2*C(w(M(Er-jt)+Or*on*M(or-ir))),jn=A(zn),ea=zn?function(Yr){var Kn=A(Yr*=zn)/jn,En=A(zn-Yr)/jn,Bn=En*dn+Kn*sn,Jn=En*bn+Kn*_n,ba=En*qr+Kn*nn;return[l(Jn,Bn)*c,l(ba,w(Bn*Bn+Jn*Jn))*c]}:function(){return[ir*c,jt*c]};return ea.distance=zn,ea},t.geoLength=Ht,t.geoMercator=function(){return pa(On).scale(961/a)},t.geoMercatorRaw=On,t.geoNaturalEarth1=function(){return tr(Ji).scale(175.295)},t.geoNaturalEarth1Raw=Ji,t.geoOrthographic=function(){return tr(Ki).scale(249.5).clipAngle(90+u)},t.geoOrthographicRaw=Ki,t.geoPath=function(ct,zt){var ir,jt,or=4.5;function Er(Or){return Or&&(typeof or=="function"&&jt.pointRadius(+or.apply(this,arguments)),Q(Or,ir(jt))),jt.result()}return Er.area=function(Or){return Q(Or,ir(gn)),gn.result()},Er.measure=function(Or){return Q(Or,ir(ho)),ho.result()},Er.bounds=function(Or){return Q(Or,ir(co)),co.result()},Er.centroid=function(Or){return Q(Or,ir(fi)),fi.result()},Er.projection=function(Or){return arguments.length?(ir=Or==null?(ct=null,Ir):(ct=Or).stream,Er):ct},Er.context=function(Or){return arguments.length?(jt=Or==null?(zt=null,new Ho):new As(zt=Or),typeof or!="function"&&jt.pointRadius(or),Er):zt},Er.pointRadius=function(Or){return arguments.length?(or=typeof Or=="function"?Or:(jt.pointRadius(+Or),+Or),Er):or},Er.projection(ct).context(zt)},t.geoProjection=tr,t.geoProjectionMutator=lr,t.geoRotation=hr,t.geoStereographic=function(){return tr(Qi).scale(250).clipAngle(142)},t.geoStereographicRaw=Qi,t.geoStream=Q,t.geoTransform=function(ct){return{stream:So(ct)}},t.geoTransverseMercator=function(){var ct=pa(Pa),zt=ct.center,ir=ct.rotate;return ct.center=function(jt){return arguments.length?zt([-jt[1],jt[0]]):[(jt=zt())[1],-jt[0]]},ct.rotate=function(jt){return arguments.length?ir([jt[0],jt[1],jt.length>2?jt[2]+90:90]):[(jt=ir())[0],jt[1],jt[2]-90]},ir([0,0,90]).scale(159.155)},t.geoTransverseMercatorRaw=Pa,Object.defineProperty(t,"__esModule",{value:!0})})},{"d3-array":159}],167:[function(h,N,H){(function(t,m){m(typeof H=="object"&&N!==void 0?H:(t=t||self).d3=t.d3||{})})(this,function(t){function m(se,de){return se.parent===de.parent?1:2}function g(se,de){return se+de.x}function p(se,de){return Math.max(se,de.y)}function e(se){var de=0,ce=se.children,ve=ce&&ce.length;if(ve)for(;--ve>=0;)de+=ce[ve].value;else de=1;se.value=de}function f(se,de){var ce,ve,ke,Ee,be,xe=new o(se),ue=+se.value&&(xe.value=se.value),me=[xe];for(de==null&&(de=u);ce=me.pop();)if(ue&&(ce.value=+ce.data.value),(ke=de(ce.data))&&(be=ke.length))for(ce.children=new Array(be),Ee=be-1;Ee>=0;--Ee)me.push(ve=ce.children[Ee]=new o(ke[Ee])),ve.parent=ce,ve.depth=ce.depth+1;return xe.eachBefore(s)}function u(se){return se.children}function i(se){se.data=se.data.data}function s(se){var de=0;do se.height=de;while((se=se.parent)&&se.height<++de)}function o(se){this.data=se,this.depth=this.height=0,this.parent=null}o.prototype=f.prototype={constructor:o,count:function(){return this.eachAfter(e)},each:function(se){var de,ce,ve,ke,Ee=this,be=[Ee];do for(de=be.reverse(),be=[];Ee=de.pop();)if(se(Ee),ce=Ee.children)for(ve=0,ke=ce.length;ve<ke;++ve)be.push(ce[ve]);while(be.length);return this},eachAfter:function(se){for(var de,ce,ve,ke=this,Ee=[ke],be=[];ke=Ee.pop();)if(be.push(ke),de=ke.children)for(ce=0,ve=de.length;ce<ve;++ce)Ee.push(de[ce]);for(;ke=be.pop();)se(ke);return this},eachBefore:function(se){for(var de,ce,ve=this,ke=[ve];ve=ke.pop();)if(se(ve),de=ve.children)for(ce=de.length-1;ce>=0;--ce)ke.push(de[ce]);return this},sum:function(se){return this.eachAfter(function(de){for(var ce=+se(de.data)||0,ve=de.children,ke=ve&&ve.length;--ke>=0;)ce+=ve[ke].value;de.value=ce})},sort:function(se){return this.eachBefore(function(de){de.children&&de.children.sort(se)})},path:function(se){for(var de=this,ce=function(Ee,be){if(Ee===be)return Ee;var xe=Ee.ancestors(),ue=be.ancestors(),me=null;for(Ee=xe.pop(),be=ue.pop();Ee===be;)me=Ee,Ee=xe.pop(),be=ue.pop();return me}(de,se),ve=[de];de!==ce;)de=de.parent,ve.push(de);for(var ke=ve.length;se!==ce;)ve.splice(ke,0,se),se=se.parent;return ve},ancestors:function(){for(var se=this,de=[se];se=se.parent;)de.push(se);return de},descendants:function(){var se=[];return this.each(function(de){se.push(de)}),se},leaves:function(){var se=[];return this.eachBefore(function(de){de.children||se.push(de)}),se},links:function(){var se=this,de=[];return se.each(function(ce){ce!==se&&de.push({source:ce.parent,target:ce})}),de},copy:function(){return f(this).eachBefore(i)}};var a=Array.prototype.slice;function c(se){for(var de,ce,ve=0,ke=(se=function(be){for(var xe,ue,me=be.length;me;)ue=Math.random()*me--|0,xe=be[me],be[me]=be[ue],be[ue]=xe;return be}(a.call(se))).length,Ee=[];ve<ke;)de=se[ve],ce&&d(ce,de)?++ve:(ce=y(Ee=r(Ee,de)),ve=0);return ce}function r(se,de){var ce,ve;if(l(de,se))return[de];for(ce=0;ce<se.length;++ce)if(n(de,se[ce])&&l(v(se[ce],de),se))return[se[ce],de];for(ce=0;ce<se.length-1;++ce)for(ve=ce+1;ve<se.length;++ve)if(n(v(se[ce],se[ve]),de)&&n(v(se[ce],de),se[ve])&&n(v(se[ve],de),se[ce])&&l(_(se[ce],se[ve],de),se))return[se[ce],se[ve],de];throw new Error}function n(se,de){var ce=se.r-de.r,ve=de.x-se.x,ke=de.y-se.y;return ce<0||ce*ce<ve*ve+ke*ke}function d(se,de){var ce=se.r-de.r+1e-6,ve=de.x-se.x,ke=de.y-se.y;return ce>0&&ce*ce>ve*ve+ke*ke}function l(se,de){for(var ce=0;ce<de.length;++ce)if(!d(se,de[ce]))return!1;return!0}function y(se){switch(se.length){case 1:return{x:(de=se[0]).x,y:de.y,r:de.r};case 2:return v(se[0],se[1]);case 3:return _(se[0],se[1],se[2])}var de}function v(se,de){var ce=se.x,ve=se.y,ke=se.r,Ee=de.x,be=de.y,xe=de.r,ue=Ee-ce,me=be-ve,we=xe-ke,Me=Math.sqrt(ue*ue+me*me);return{x:(ce+Ee+ue/Me*we)/2,y:(ve+be+me/Me*we)/2,r:(Me+ke+xe)/2}}function _(se,de,ce){var ve=se.x,ke=se.y,Ee=se.r,be=de.x,xe=de.y,ue=de.r,me=ce.x,we=ce.y,Me=ce.r,Se=ve-be,De=ve-me,Fe=ke-xe,Ye=ke-we,et=ue-Ee,Oe=Me-Ee,je=ve*ve+ke*ke-Ee*Ee,We=je-be*be-xe*xe+ue*ue,Ge=je-me*me-we*we+Me*Me,Qe=De*Fe-Se*Ye,it=(Fe*Ge-Ye*We)/(2*Qe)-ve,lt=(Ye*et-Fe*Oe)/Qe,Lt=(De*We-Se*Ge)/(2*Qe)-ke,wt=(Se*Oe-De*et)/Qe,rt=lt*lt+wt*wt-1,$e=2*(Ee+it*lt+Lt*wt),xt=it*it+Lt*Lt-Ee*Ee,Qt=-(rt?($e+Math.sqrt($e*$e-4*rt*xt))/(2*rt):xt/$e);return{x:ve+it+lt*Qt,y:ke+Lt+wt*Qt,r:Qt}}function x(se,de,ce){var ve,ke,Ee,be,xe=se.x-de.x,ue=se.y-de.y,me=xe*xe+ue*ue;me?(ke=de.r+ce.r,ke*=ke,be=se.r+ce.r,ke>(be*=be)?(ve=(me+be-ke)/(2*me),Ee=Math.sqrt(Math.max(0,be/me-ve*ve)),ce.x=se.x-ve*xe-Ee*ue,ce.y=se.y-ve*ue+Ee*xe):(ve=(me+ke-be)/(2*me),Ee=Math.sqrt(Math.max(0,ke/me-ve*ve)),ce.x=de.x+ve*xe-Ee*ue,ce.y=de.y+ve*ue+Ee*xe)):(ce.x=de.x+ce.r,ce.y=de.y)}function T(se,de){var ce=se.r+de.r-1e-6,ve=de.x-se.x,ke=de.y-se.y;return ce>0&&ce*ce>ve*ve+ke*ke}function A(se){var de=se._,ce=se.next._,ve=de.r+ce.r,ke=(de.x*ce.r+ce.x*de.r)/ve,Ee=(de.y*ce.r+ce.y*de.r)/ve;return ke*ke+Ee*Ee}function S(se){this._=se,this.next=null,this.previous=null}function w(se){if(!(ke=se.length))return 0;var de,ce,ve,ke,Ee,be,xe,ue,me,we,Me;if((de=se[0]).x=0,de.y=0,!(ke>1))return de.r;if(ce=se[1],de.x=-ce.r,ce.x=de.r,ce.y=0,!(ke>2))return de.r+ce.r;x(ce,de,ve=se[2]),de=new S(de),ce=new S(ce),ve=new S(ve),de.next=ve.previous=ce,ce.next=de.previous=ve,ve.next=ce.previous=de;e:for(xe=3;xe<ke;++xe){x(de._,ce._,ve=se[xe]),ve=new S(ve),ue=ce.next,me=de.previous,we=ce._.r,Me=de._.r;do if(we<=Me){if(T(ue._,ve._)){ce=ue,de.next=ce,ce.previous=de,--xe;continue e}we+=ue._.r,ue=ue.next}else{if(T(me._,ve._)){(de=me).next=ce,ce.previous=de,--xe;continue e}Me+=me._.r,me=me.previous}while(ue!==me.next);for(ve.previous=de,ve.next=ce,de.next=ce.previous=ce=ve,Ee=A(de);(ve=ve.next)!==ce;)(be=A(ve))<Ee&&(de=ve,Ee=be);ce=de.next}for(de=[ce._],ve=ce;(ve=ve.next)!==ce;)de.push(ve._);for(ve=c(de),xe=0;xe<ke;++xe)(de=se[xe]).x-=ve.x,de.y-=ve.y;return ve.r}function L(se){return se==null?null:k(se)}function k(se){if(typeof se!="function")throw new Error;return se}function C(){return 0}function M(se){return function(){return se}}function P(se){return Math.sqrt(se.value)}function O(se){return function(de){de.children||(de.r=Math.max(0,+se(de)||0))}}function F(se,de){return function(ce){if(ve=ce.children){var ve,ke,Ee,be=ve.length,xe=se(ce)*de||0;if(xe)for(ke=0;ke<be;++ke)ve[ke].r+=xe;if(Ee=w(ve),xe)for(ke=0;ke<be;++ke)ve[ke].r-=xe;ce.r=Ee+xe}}}function j(se){return function(de){var ce=de.parent;de.r*=se,ce&&(de.x=ce.x+se*de.x,de.y=ce.y+se*de.y)}}function W(se){se.x0=Math.round(se.x0),se.y0=Math.round(se.y0),se.x1=Math.round(se.x1),se.y1=Math.round(se.y1)}function Z(se,de,ce,ve,ke){for(var Ee,be=se.children,xe=-1,ue=be.length,me=se.value&&(ve-de)/se.value;++xe<ue;)(Ee=be[xe]).y0=ce,Ee.y1=ke,Ee.x0=de,Ee.x1=de+=Ee.value*me}var Q={depth:-1},X={};function G(se){return se.id}function Y(se){return se.parentId}function K(se,de){return se.parent===de.parent?1:2}function D(se){var de=se.children;return de?de[0]:se.t}function B(se){var de=se.children;return de?de[de.length-1]:se.t}function q(se,de,ce){var ve=ce/(de.i-se.i);de.c-=ve,de.s+=ce,se.c+=ve,de.z+=ce,de.m+=ce}function ee(se,de,ce){return se.a.parent===de.parent?se.a:ce}function J(se,de){this._=se,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=de}function $(se,de,ce,ve,ke){for(var Ee,be=se.children,xe=-1,ue=be.length,me=se.value&&(ke-ce)/se.value;++xe<ue;)(Ee=be[xe]).x0=de,Ee.x1=ve,Ee.y0=ce,Ee.y1=ce+=Ee.value*me}J.prototype=Object.create(o.prototype);var te=(1+Math.sqrt(5))/2;function ie(se,de,ce,ve,ke,Ee){for(var be,xe,ue,me,we,Me,Se,De,Fe,Ye,et,Oe=[],je=de.children,We=0,Ge=0,Qe=je.length,it=de.value;We<Qe;){ue=ke-ce,me=Ee-ve;do we=je[Ge++].value;while(!we&&Ge<Qe);for(Me=Se=we,et=we*we*(Ye=Math.max(me/ue,ue/me)/(it*se)),Fe=Math.max(Se/et,et/Me);Ge<Qe;++Ge){if(we+=xe=je[Ge].value,xe<Me&&(Me=xe),xe>Se&&(Se=xe),et=we*we*Ye,(De=Math.max(Se/et,et/Me))>Fe){we-=xe;break}Fe=De}Oe.push(be={value:we,dice:ue<me,children:je.slice(We,Ge)}),be.dice?Z(be,ce,ve,ke,it?ve+=me*we/it:Ee):$(be,ce,ve,it?ce+=ue*we/it:ke,Ee),it-=we,We=Ge}return Oe}var ae=function se(de){function ce(ve,ke,Ee,be,xe){ie(de,ve,ke,Ee,be,xe)}return ce.ratio=function(ve){return se((ve=+ve)>1?ve:1)},ce}(te),he=function se(de){function ce(ve,ke,Ee,be,xe){if((ue=ve._squarify)&&ue.ratio===de)for(var ue,me,we,Me,Se,De=-1,Fe=ue.length,Ye=ve.value;++De<Fe;){for(we=(me=ue[De]).children,Me=me.value=0,Se=we.length;Me<Se;++Me)me.value+=we[Me].value;me.dice?Z(me,ke,Ee,be,Ee+=(xe-Ee)*me.value/Ye):$(me,ke,Ee,ke+=(be-ke)*me.value/Ye,xe),Ye-=me.value}else ve._squarify=ue=ie(de,ve,ke,Ee,be,xe),ue.ratio=de}return ce.ratio=function(ve){return se((ve=+ve)>1?ve:1)},ce}(te);t.cluster=function(){var se=m,de=1,ce=1,ve=!1;function ke(Ee){var be,xe=0;Ee.eachAfter(function(Se){var De=Se.children;De?(Se.x=function(Fe){return Fe.reduce(g,0)/Fe.length}(De),Se.y=function(Fe){return 1+Fe.reduce(p,0)}(De)):(Se.x=be?xe+=se(Se,be):0,Se.y=0,be=Se)});var ue=function(Se){for(var De;De=Se.children;)Se=De[0];return Se}(Ee),me=function(Se){for(var De;De=Se.children;)Se=De[De.length-1];return Se}(Ee),we=ue.x-se(ue,me)/2,Me=me.x+se(me,ue)/2;return Ee.eachAfter(ve?function(Se){Se.x=(Se.x-Ee.x)*de,Se.y=(Ee.y-Se.y)*ce}:function(Se){Se.x=(Se.x-we)/(Me-we)*de,Se.y=(1-(Ee.y?Se.y/Ee.y:1))*ce})}return ke.separation=function(Ee){return arguments.length?(se=Ee,ke):se},ke.size=function(Ee){return arguments.length?(ve=!1,de=+Ee[0],ce=+Ee[1],ke):ve?null:[de,ce]},ke.nodeSize=function(Ee){return arguments.length?(ve=!0,de=+Ee[0],ce=+Ee[1],ke):ve?[de,ce]:null},ke},t.hierarchy=f,t.pack=function(){var se=null,de=1,ce=1,ve=C;function ke(Ee){return Ee.x=de/2,Ee.y=ce/2,se?Ee.eachBefore(O(se)).eachAfter(F(ve,.5)).eachBefore(j(1)):Ee.eachBefore(O(P)).eachAfter(F(C,1)).eachAfter(F(ve,Ee.r/Math.min(de,ce))).eachBefore(j(Math.min(de,ce)/(2*Ee.r))),Ee}return ke.radius=function(Ee){return arguments.length?(se=L(Ee),ke):se},ke.size=function(Ee){return arguments.length?(de=+Ee[0],ce=+Ee[1],ke):[de,ce]},ke.padding=function(Ee){return arguments.length?(ve=typeof Ee=="function"?Ee:M(+Ee),ke):ve},ke},t.packEnclose=c,t.packSiblings=function(se){return w(se),se},t.partition=function(){var se=1,de=1,ce=0,ve=!1;function ke(Ee){var be=Ee.height+1;return Ee.x0=Ee.y0=ce,Ee.x1=se,Ee.y1=de/be,Ee.eachBefore(function(xe,ue){return function(me){me.children&&Z(me,me.x0,xe*(me.depth+1)/ue,me.x1,xe*(me.depth+2)/ue);var we=me.x0,Me=me.y0,Se=me.x1-ce,De=me.y1-ce;Se<we&&(we=Se=(we+Se)/2),De<Me&&(Me=De=(Me+De)/2),me.x0=we,me.y0=Me,me.x1=Se,me.y1=De}}(de,be)),ve&&Ee.eachBefore(W),Ee}return ke.round=function(Ee){return arguments.length?(ve=!!Ee,ke):ve},ke.size=function(Ee){return arguments.length?(se=+Ee[0],de=+Ee[1],ke):[se,de]},ke.padding=function(Ee){return arguments.length?(ce=+Ee,ke):ce},ke},t.stratify=function(){var se=G,de=Y;function ce(ve){var ke,Ee,be,xe,ue,me,we,Me=ve.length,Se=new Array(Me),De={};for(Ee=0;Ee<Me;++Ee)ke=ve[Ee],ue=Se[Ee]=new o(ke),(me=se(ke,Ee,ve))!=null&&(me+="")&&(De[we="$"+(ue.id=me)]=we in De?X:ue);for(Ee=0;Ee<Me;++Ee)if(ue=Se[Ee],(me=de(ve[Ee],Ee,ve))!=null&&(me+="")){if(!(xe=De["$"+me]))throw new Error("missing: "+me);if(xe===X)throw new Error("ambiguous: "+me);xe.children?xe.children.push(ue):xe.children=[ue],ue.parent=xe}else{if(be)throw new Error("multiple roots");be=ue}if(!be)throw new Error("no root");if(be.parent=Q,be.eachBefore(function(Fe){Fe.depth=Fe.parent.depth+1,--Me}).eachBefore(s),be.parent=null,Me>0)throw new Error("cycle");return be}return ce.id=function(ve){return arguments.length?(se=k(ve),ce):se},ce.parentId=function(ve){return arguments.length?(de=k(ve),ce):de},ce},t.tree=function(){var se=K,de=1,ce=1,ve=null;function ke(ue){var me=function(Oe){for(var je,We,Ge,Qe,it,lt=new J(Oe,0),Lt=[lt];je=Lt.pop();)if(Ge=je._.children)for(je.children=new Array(it=Ge.length),Qe=it-1;Qe>=0;--Qe)Lt.push(We=je.children[Qe]=new J(Ge[Qe],Qe)),We.parent=je;return(lt.parent=new J(null,0)).children=[lt],lt}(ue);if(me.eachAfter(Ee),me.parent.m=-me.z,me.eachBefore(be),ve)ue.eachBefore(xe);else{var we=ue,Me=ue,Se=ue;ue.eachBefore(function(Oe){Oe.x<we.x&&(we=Oe),Oe.x>Me.x&&(Me=Oe),Oe.depth>Se.depth&&(Se=Oe)});var De=we===Me?1:se(we,Me)/2,Fe=De-we.x,Ye=de/(Me.x+De+Fe),et=ce/(Se.depth||1);ue.eachBefore(function(Oe){Oe.x=(Oe.x+Fe)*Ye,Oe.y=Oe.depth*et})}return ue}function Ee(ue){var me=ue.children,we=ue.parent.children,Me=ue.i?we[ue.i-1]:null;if(me){(function(De){for(var Fe,Ye=0,et=0,Oe=De.children,je=Oe.length;--je>=0;)(Fe=Oe[je]).z+=Ye,Fe.m+=Ye,Ye+=Fe.s+(et+=Fe.c)})(ue);var Se=(me[0].z+me[me.length-1].z)/2;Me?(ue.z=Me.z+se(ue._,Me._),ue.m=ue.z-Se):ue.z=Se}else Me&&(ue.z=Me.z+se(ue._,Me._));ue.parent.A=function(De,Fe,Ye){if(Fe){for(var et,Oe=De,je=De,We=Fe,Ge=Oe.parent.children[0],Qe=Oe.m,it=je.m,lt=We.m,Lt=Ge.m;We=B(We),Oe=D(Oe),We&&Oe;)Ge=D(Ge),(je=B(je)).a=De,(et=We.z+lt-Oe.z-Qe+se(We._,Oe._))>0&&(q(ee(We,De,Ye),De,et),Qe+=et,it+=et),lt+=We.m,Qe+=Oe.m,Lt+=Ge.m,it+=je.m;We&&!B(je)&&(je.t=We,je.m+=lt-it),Oe&&!D(Ge)&&(Ge.t=Oe,Ge.m+=Qe-Lt,Ye=De)}return Ye}(ue,Me,ue.parent.A||we[0])}function be(ue){ue._.x=ue.z+ue.parent.m,ue.m+=ue.parent.m}function xe(ue){ue.x*=de,ue.y=ue.depth*ce}return ke.separation=function(ue){return arguments.length?(se=ue,ke):se},ke.size=function(ue){return arguments.length?(ve=!1,de=+ue[0],ce=+ue[1],ke):ve?null:[de,ce]},ke.nodeSize=function(ue){return arguments.length?(ve=!0,de=+ue[0],ce=+ue[1],ke):ve?[de,ce]:null},ke},t.treemap=function(){var se=ae,de=!1,ce=1,ve=1,ke=[0],Ee=C,be=C,xe=C,ue=C,me=C;function we(Se){return Se.x0=Se.y0=0,Se.x1=ce,Se.y1=ve,Se.eachBefore(Me),ke=[0],de&&Se.eachBefore(W),Se}function Me(Se){var De=ke[Se.depth],Fe=Se.x0+De,Ye=Se.y0+De,et=Se.x1-De,Oe=Se.y1-De;et<Fe&&(Fe=et=(Fe+et)/2),Oe<Ye&&(Ye=Oe=(Ye+Oe)/2),Se.x0=Fe,Se.y0=Ye,Se.x1=et,Se.y1=Oe,Se.children&&(De=ke[Se.depth+1]=Ee(Se)/2,Fe+=me(Se)-De,Ye+=be(Se)-De,(et-=xe(Se)-De)<Fe&&(Fe=et=(Fe+et)/2),(Oe-=ue(Se)-De)<Ye&&(Ye=Oe=(Ye+Oe)/2),se(Se,Fe,Ye,et,Oe))}return we.round=function(Se){return arguments.length?(de=!!Se,we):de},we.size=function(Se){return arguments.length?(ce=+Se[0],ve=+Se[1],we):[ce,ve]},we.tile=function(Se){return arguments.length?(se=k(Se),we):se},we.padding=function(Se){return arguments.length?we.paddingInner(Se).paddingOuter(Se):we.paddingInner()},we.paddingInner=function(Se){return arguments.length?(Ee=typeof Se=="function"?Se:M(+Se),we):Ee},we.paddingOuter=function(Se){return arguments.length?we.paddingTop(Se).paddingRight(Se).paddingBottom(Se).paddingLeft(Se):we.paddingTop()},we.paddingTop=function(Se){return arguments.length?(be=typeof Se=="function"?Se:M(+Se),we):be},we.paddingRight=function(Se){return arguments.length?(xe=typeof Se=="function"?Se:M(+Se),we):xe},we.paddingBottom=function(Se){return arguments.length?(ue=typeof Se=="function"?Se:M(+Se),we):ue},we.paddingLeft=function(Se){return arguments.length?(me=typeof Se=="function"?Se:M(+Se),we):me},we},t.treemapBinary=function(se,de,ce,ve,ke){var Ee,be,xe=se.children,ue=xe.length,me=new Array(ue+1);for(me[0]=be=Ee=0;Ee<ue;++Ee)me[Ee+1]=be+=xe[Ee].value;(function we(Me,Se,De,Fe,Ye,et,Oe){if(Me>=Se-1){var je=xe[Me];return je.x0=Fe,je.y0=Ye,je.x1=et,void(je.y1=Oe)}for(var We=me[Me],Ge=De/2+We,Qe=Me+1,it=Se-1;Qe<it;){var lt=Qe+it>>>1;me[lt]<Ge?Qe=lt+1:it=lt}Ge-me[Qe-1]<me[Qe]-Ge&&Me+1<Qe&&--Qe;var Lt=me[Qe]-We,wt=De-Lt;if(et-Fe>Oe-Ye){var rt=(Fe*wt+et*Lt)/De;we(Me,Qe,Lt,Fe,Ye,rt,Oe),we(Qe,Se,wt,rt,Ye,et,Oe)}else{var $e=(Ye*wt+Oe*Lt)/De;we(Me,Qe,Lt,Fe,Ye,et,$e),we(Qe,Se,wt,Fe,$e,et,Oe)}})(0,ue,se.value,de,ce,ve,ke)},t.treemapDice=Z,t.treemapResquarify=he,t.treemapSlice=$,t.treemapSliceDice=function(se,de,ce,ve,ke){(1&se.depth?$:Z)(se,de,ce,ve,ke)},t.treemapSquarify=ae,Object.defineProperty(t,"__esModule",{value:!0})})},{}],168:[function(h,N,H){(function(t,m){typeof H=="object"&&N!==void 0?m(H,h("d3-color")):m((t=t||self).d3=t.d3||{},t.d3)})(this,function(t,m){function g(te,ie,ae,he,se){var de=te*te,ce=de*te;return((1-3*te+3*de-ce)*ie+(4-6*de+3*ce)*ae+(1+3*te+3*de-3*ce)*he+ce*se)/6}function p(te){var ie=te.length-1;return function(ae){var he=ae<=0?ae=0:ae>=1?(ae=1,ie-1):Math.floor(ae*ie),se=te[he],de=te[he+1],ce=he>0?te[he-1]:2*se-de,ve=he<ie-1?te[he+2]:2*de-se;return g((ae-he/ie)*ie,ce,se,de,ve)}}function e(te){var ie=te.length;return function(ae){var he=Math.floor(((ae%=1)<0?++ae:ae)*ie),se=te[(he+ie-1)%ie],de=te[he%ie],ce=te[(he+1)%ie],ve=te[(he+2)%ie];return g((ae-he/ie)*ie,se,de,ce,ve)}}function f(te){return function(){return te}}function u(te,ie){return function(ae){return te+ae*ie}}function i(te,ie){var ae=ie-te;return ae?u(te,ae>180||ae<-180?ae-360*Math.round(ae/360):ae):f(isNaN(te)?ie:te)}function s(te){return(te=+te)==1?o:function(ie,ae){return ae-ie?function(he,se,de){return he=Math.pow(he,de),se=Math.pow(se,de)-he,de=1/de,function(ce){return Math.pow(he+ce*se,de)}}(ie,ae,te):f(isNaN(ie)?ae:ie)}}function o(te,ie){var ae=ie-te;return ae?u(te,ae):f(isNaN(te)?ie:te)}var a=function te(ie){var ae=s(ie);function he(se,de){var ce=ae((se=m.rgb(se)).r,(de=m.rgb(de)).r),ve=ae(se.g,de.g),ke=ae(se.b,de.b),Ee=o(se.opacity,de.opacity);return function(be){return se.r=ce(be),se.g=ve(be),se.b=ke(be),se.opacity=Ee(be),se+""}}return he.gamma=te,he}(1);function c(te){return function(ie){var ae,he,se=ie.length,de=new Array(se),ce=new Array(se),ve=new Array(se);for(ae=0;ae<se;++ae)he=m.rgb(ie[ae]),de[ae]=he.r||0,ce[ae]=he.g||0,ve[ae]=he.b||0;return de=te(de),ce=te(ce),ve=te(ve),he.opacity=1,function(ke){return he.r=de(ke),he.g=ce(ke),he.b=ve(ke),he+""}}}var r=c(p),n=c(e);function d(te,ie){ie||(ie=[]);var ae,he=te?Math.min(ie.length,te.length):0,se=ie.slice();return function(de){for(ae=0;ae<he;++ae)se[ae]=te[ae]*(1-de)+ie[ae]*de;return se}}function l(te){return ArrayBuffer.isView(te)&&!(te instanceof DataView)}function y(te,ie){var ae,he=ie?ie.length:0,se=te?Math.min(he,te.length):0,de=new Array(se),ce=new Array(he);for(ae=0;ae<se;++ae)de[ae]=w(te[ae],ie[ae]);for(;ae<he;++ae)ce[ae]=ie[ae];return function(ve){for(ae=0;ae<se;++ae)ce[ae]=de[ae](ve);return ce}}function v(te,ie){var ae=new Date;return te=+te,ie=+ie,function(he){return ae.setTime(te*(1-he)+ie*he),ae}}function _(te,ie){return te=+te,ie=+ie,function(ae){return te*(1-ae)+ie*ae}}function x(te,ie){var ae,he={},se={};for(ae in te!==null&&typeof te=="object"||(te={}),ie!==null&&typeof ie=="object"||(ie={}),ie)ae in te?he[ae]=w(te[ae],ie[ae]):se[ae]=ie[ae];return function(de){for(ae in he)se[ae]=he[ae](de);return se}}var T=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,A=new RegExp(T.source,"g");function S(te,ie){var ae,he,se,de=T.lastIndex=A.lastIndex=0,ce=-1,ve=[],ke=[];for(te+="",ie+="";(ae=T.exec(te))&&(he=A.exec(ie));)(se=he.index)>de&&(se=ie.slice(de,se),ve[ce]?ve[ce]+=se:ve[++ce]=se),(ae=ae[0])===(he=he[0])?ve[ce]?ve[ce]+=he:ve[++ce]=he:(ve[++ce]=null,ke.push({i:ce,x:_(ae,he)})),de=A.lastIndex;return de<ie.length&&(se=ie.slice(de),ve[ce]?ve[ce]+=se:ve[++ce]=se),ve.length<2?ke[0]?function(Ee){return function(be){return Ee(be)+""}}(ke[0].x):function(Ee){return function(){return Ee}}(ie):(ie=ke.length,function(Ee){for(var be,xe=0;xe<ie;++xe)ve[(be=ke[xe]).i]=be.x(Ee);return ve.join("")})}function w(te,ie){var ae,he=typeof ie;return ie==null||he==="boolean"?f(ie):(he==="number"?_:he==="string"?(ae=m.color(ie))?(ie=ae,a):S:ie instanceof m.color?a:ie instanceof Date?v:l(ie)?d:Array.isArray(ie)?y:typeof ie.valueOf!="function"&&typeof ie.toString!="function"||isNaN(ie)?x:_)(te,ie)}var L,k,C,M,P=180/Math.PI,O={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function F(te,ie,ae,he,se,de){var ce,ve,ke;return(ce=Math.sqrt(te*te+ie*ie))&&(te/=ce,ie/=ce),(ke=te*ae+ie*he)&&(ae-=te*ke,he-=ie*ke),(ve=Math.sqrt(ae*ae+he*he))&&(ae/=ve,he/=ve,ke/=ve),te*he<ie*ae&&(te=-te,ie=-ie,ke=-ke,ce=-ce),{translateX:se,translateY:de,rotate:Math.atan2(ie,te)*P,skewX:Math.atan(ke)*P,scaleX:ce,scaleY:ve}}function j(te,ie,ae,he){function se(de){return de.length?de.pop()+" ":""}return function(de,ce){var ve=[],ke=[];return de=te(de),ce=te(ce),function(Ee,be,xe,ue,me,we){if(Ee!==xe||be!==ue){var Me=me.push("translate(",null,ie,null,ae);we.push({i:Me-4,x:_(Ee,xe)},{i:Me-2,x:_(be,ue)})}else(xe||ue)&&me.push("translate("+xe+ie+ue+ae)}(de.translateX,de.translateY,ce.translateX,ce.translateY,ve,ke),function(Ee,be,xe,ue){Ee!==be?(Ee-be>180?be+=360:be-Ee>180&&(Ee+=360),ue.push({i:xe.push(se(xe)+"rotate(",null,he)-2,x:_(Ee,be)})):be&&xe.push(se(xe)+"rotate("+be+he)}(de.rotate,ce.rotate,ve,ke),function(Ee,be,xe,ue){Ee!==be?ue.push({i:xe.push(se(xe)+"skewX(",null,he)-2,x:_(Ee,be)}):be&&xe.push(se(xe)+"skewX("+be+he)}(de.skewX,ce.skewX,ve,ke),function(Ee,be,xe,ue,me,we){if(Ee!==xe||be!==ue){var Me=me.push(se(me)+"scale(",null,",",null,")");we.push({i:Me-4,x:_(Ee,xe)},{i:Me-2,x:_(be,ue)})}else xe===1&&ue===1||me.push(se(me)+"scale("+xe+","+ue+")")}(de.scaleX,de.scaleY,ce.scaleX,ce.scaleY,ve,ke),de=ce=null,function(Ee){for(var be,xe=-1,ue=ke.length;++xe<ue;)ve[(be=ke[xe]).i]=be.x(Ee);return ve.join("")}}}var W=j(function(te){return te==="none"?O:(L||(L=document.createElement("DIV"),k=document.documentElement,C=document.defaultView),L.style.transform=te,te=C.getComputedStyle(k.appendChild(L),null).getPropertyValue("transform"),k.removeChild(L),F(+(te=te.slice(7,-1).split(","))[0],+te[1],+te[2],+te[3],+te[4],+te[5]))},"px, ","px)","deg)"),Z=j(function(te){return te==null?O:(M||(M=document.createElementNS("http://www.w3.org/2000/svg","g")),M.setAttribute("transform",te),(te=M.transform.baseVal.consolidate())?F((te=te.matrix).a,te.b,te.c,te.d,te.e,te.f):O)},", ",")",")"),Q=Math.SQRT2;function X(te){return((te=Math.exp(te))+1/te)/2}function G(te){return function(ie,ae){var he=te((ie=m.hsl(ie)).h,(ae=m.hsl(ae)).h),se=o(ie.s,ae.s),de=o(ie.l,ae.l),ce=o(ie.opacity,ae.opacity);return function(ve){return ie.h=he(ve),ie.s=se(ve),ie.l=de(ve),ie.opacity=ce(ve),ie+""}}}var Y=G(i),K=G(o);function D(te){return function(ie,ae){var he=te((ie=m.hcl(ie)).h,(ae=m.hcl(ae)).h),se=o(ie.c,ae.c),de=o(ie.l,ae.l),ce=o(ie.opacity,ae.opacity);return function(ve){return ie.h=he(ve),ie.c=se(ve),ie.l=de(ve),ie.opacity=ce(ve),ie+""}}}var B=D(i),q=D(o);function ee(te){return function ie(ae){function he(se,de){var ce=te((se=m.cubehelix(se)).h,(de=m.cubehelix(de)).h),ve=o(se.s,de.s),ke=o(se.l,de.l),Ee=o(se.opacity,de.opacity);return function(be){return se.h=ce(be),se.s=ve(be),se.l=ke(Math.pow(be,ae)),se.opacity=Ee(be),se+""}}return ae=+ae,he.gamma=ie,he}(1)}var J=ee(i),$=ee(o);t.interpolate=w,t.interpolateArray=function(te,ie){return(l(ie)?d:y)(te,ie)},t.interpolateBasis=p,t.interpolateBasisClosed=e,t.interpolateCubehelix=J,t.interpolateCubehelixLong=$,t.interpolateDate=v,t.interpolateDiscrete=function(te){var ie=te.length;return function(ae){return te[Math.max(0,Math.min(ie-1,Math.floor(ae*ie)))]}},t.interpolateHcl=B,t.interpolateHclLong=q,t.interpolateHsl=Y,t.interpolateHslLong=K,t.interpolateHue=function(te,ie){var ae=i(+te,+ie);return function(he){var se=ae(he);return se-360*Math.floor(se/360)}},t.interpolateLab=function(te,ie){var ae=o((te=m.lab(te)).l,(ie=m.lab(ie)).l),he=o(te.a,ie.a),se=o(te.b,ie.b),de=o(te.opacity,ie.opacity);return function(ce){return te.l=ae(ce),te.a=he(ce),te.b=se(ce),te.opacity=de(ce),te+""}},t.interpolateNumber=_,t.interpolateNumberArray=d,t.interpolateObject=x,t.interpolateRgb=a,t.interpolateRgbBasis=r,t.interpolateRgbBasisClosed=n,t.interpolateRound=function(te,ie){return te=+te,ie=+ie,function(ae){return Math.round(te*(1-ae)+ie*ae)}},t.interpolateString=S,t.interpolateTransformCss=W,t.interpolateTransformSvg=Z,t.interpolateZoom=function(te,ie){var ae,he,se=te[0],de=te[1],ce=te[2],ve=ie[0],ke=ie[1],Ee=ie[2],be=ve-se,xe=ke-de,ue=be*be+xe*xe;if(ue<1e-12)he=Math.log(Ee/ce)/Q,ae=function(Fe){return[se+Fe*be,de+Fe*xe,ce*Math.exp(Q*Fe*he)]};else{var me=Math.sqrt(ue),we=(Ee*Ee-ce*ce+4*ue)/(2*ce*2*me),Me=(Ee*Ee-ce*ce-4*ue)/(2*Ee*2*me),Se=Math.log(Math.sqrt(we*we+1)-we),De=Math.log(Math.sqrt(Me*Me+1)-Me);he=(De-Se)/Q,ae=function(Fe){var Ye,et=Fe*he,Oe=X(Se),je=ce/(2*me)*(Oe*(Ye=Q*et+Se,((Ye=Math.exp(2*Ye))-1)/(Ye+1))-function(We){return((We=Math.exp(We))-1/We)/2}(Se));return[se+je*be,de+je*xe,ce*Oe/X(Q*et+Se)]}}return ae.duration=1e3*he,ae},t.piecewise=function(te,ie){for(var ae=0,he=ie.length-1,se=ie[0],de=new Array(he<0?0:he);ae<he;)de[ae]=te(se,se=ie[++ae]);return function(ce){var ve=Math.max(0,Math.min(he-1,Math.floor(ce*=he)));return de[ve](ce-ve)}},t.quantize=function(te,ie){for(var ae=new Array(ie),he=0;he<ie;++he)ae[he]=te(he/(ie-1));return ae},Object.defineProperty(t,"__esModule",{value:!0})})},{"d3-color":161}],169:[function(h,N,H){(function(t,m){m(typeof H=="object"&&N!==void 0?H:(t=t||self).d3=t.d3||{})})(this,function(t){var m=Math.PI,g=2*m,p=g-1e-6;function e(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function f(){return new e}e.prototype=f.prototype={constructor:e,moveTo:function(u,i){this._+="M"+(this._x0=this._x1=+u)+","+(this._y0=this._y1=+i)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(u,i){this._+="L"+(this._x1=+u)+","+(this._y1=+i)},quadraticCurveTo:function(u,i,s,o){this._+="Q"+ +u+","+ +i+","+(this._x1=+s)+","+(this._y1=+o)},bezierCurveTo:function(u,i,s,o,a,c){this._+="C"+ +u+","+ +i+","+ +s+","+ +o+","+(this._x1=+a)+","+(this._y1=+c)},arcTo:function(u,i,s,o,a){u=+u,i=+i,s=+s,o=+o,a=+a;var c=this._x1,r=this._y1,n=s-u,d=o-i,l=c-u,y=r-i,v=l*l+y*y;if(a<0)throw new Error("negative radius: "+a);if(this._x1===null)this._+="M"+(this._x1=u)+","+(this._y1=i);else if(v>1e-6)if(Math.abs(y*n-d*l)>1e-6&&a){var _=s-c,x=o-r,T=n*n+d*d,A=_*_+x*x,S=Math.sqrt(T),w=Math.sqrt(v),L=a*Math.tan((m-Math.acos((T+v-A)/(2*S*w)))/2),k=L/w,C=L/S;Math.abs(k-1)>1e-6&&(this._+="L"+(u+k*l)+","+(i+k*y)),this._+="A"+a+","+a+",0,0,"+ +(y*_>l*x)+","+(this._x1=u+C*n)+","+(this._y1=i+C*d)}else this._+="L"+(this._x1=u)+","+(this._y1=i)},arc:function(u,i,s,o,a,c){u=+u,i=+i,c=!!c;var r=(s=+s)*Math.cos(o),n=s*Math.sin(o),d=u+r,l=i+n,y=1^c,v=c?o-a:a-o;if(s<0)throw new Error("negative radius: "+s);this._x1===null?this._+="M"+d+","+l:(Math.abs(this._x1-d)>1e-6||Math.abs(this._y1-l)>1e-6)&&(this._+="L"+d+","+l),s&&(v<0&&(v=v%g+g),v>p?this._+="A"+s+","+s+",0,1,"+y+","+(u-r)+","+(i-n)+"A"+s+","+s+",0,1,"+y+","+(this._x1=d)+","+(this._y1=l):v>1e-6&&(this._+="A"+s+","+s+",0,"+ +(v>=m)+","+y+","+(this._x1=u+s*Math.cos(a))+","+(this._y1=i+s*Math.sin(a))))},rect:function(u,i,s,o){this._+="M"+(this._x0=this._x1=+u)+","+(this._y0=this._y1=+i)+"h"+ +s+"v"+ +o+"h"+-s+"Z"},toString:function(){return this._}},t.path=f,Object.defineProperty(t,"__esModule",{value:!0})})},{}],170:[function(h,N,H){(function(t,m){m(typeof H=="object"&&N!==void 0?H:(t=t||self).d3=t.d3||{})})(this,function(t){function m(o,a,c,r){if(isNaN(a)||isNaN(c))return o;var n,d,l,y,v,_,x,T,A,S=o._root,w={data:r},L=o._x0,k=o._y0,C=o._x1,M=o._y1;if(!S)return o._root=w,o;for(;S.length;)if((_=a>=(d=(L+C)/2))?L=d:C=d,(x=c>=(l=(k+M)/2))?k=l:M=l,n=S,!(S=S[T=x<<1|_]))return n[T]=w,o;if(y=+o._x.call(null,S.data),v=+o._y.call(null,S.data),a===y&&c===v)return w.next=S,n?n[T]=w:o._root=w,o;do n=n?n[T]=new Array(4):o._root=new Array(4),(_=a>=(d=(L+C)/2))?L=d:C=d,(x=c>=(l=(k+M)/2))?k=l:M=l;while((T=x<<1|_)==(A=(v>=l)<<1|y>=d));return n[A]=S,n[T]=w,o}function g(o,a,c,r,n){this.node=o,this.x0=a,this.y0=c,this.x1=r,this.y1=n}function p(o){return o[0]}function e(o){return o[1]}function f(o,a,c){var r=new u(a==null?p:a,c==null?e:c,NaN,NaN,NaN,NaN);return o==null?r:r.addAll(o)}function u(o,a,c,r,n,d){this._x=o,this._y=a,this._x0=c,this._y0=r,this._x1=n,this._y1=d,this._root=void 0}function i(o){for(var a={data:o.data},c=a;o=o.next;)c=c.next={data:o.data};return a}var s=f.prototype=u.prototype;s.copy=function(){var o,a,c=new u(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return c;if(!r.length)return c._root=i(r),c;for(o=[{source:r,target:c._root=new Array(4)}];r=o.pop();)for(var n=0;n<4;++n)(a=r.source[n])&&(a.length?o.push({source:a,target:r.target[n]=new Array(4)}):r.target[n]=i(a));return c},s.add=function(o){var a=+this._x.call(null,o),c=+this._y.call(null,o);return m(this.cover(a,c),a,c,o)},s.addAll=function(o){var a,c,r,n,d=o.length,l=new Array(d),y=new Array(d),v=1/0,_=1/0,x=-1/0,T=-1/0;for(c=0;c<d;++c)isNaN(r=+this._x.call(null,a=o[c]))||isNaN(n=+this._y.call(null,a))||(l[c]=r,y[c]=n,r<v&&(v=r),r>x&&(x=r),n<_&&(_=n),n>T&&(T=n));if(v>x||_>T)return this;for(this.cover(v,_).cover(x,T),c=0;c<d;++c)m(this,l[c],y[c],o[c]);return this},s.cover=function(o,a){if(isNaN(o=+o)||isNaN(a=+a))return this;var c=this._x0,r=this._y0,n=this._x1,d=this._y1;if(isNaN(c))n=(c=Math.floor(o))+1,d=(r=Math.floor(a))+1;else{for(var l,y,v=n-c,_=this._root;c>o||o>=n||r>a||a>=d;)switch(y=(a<r)<<1|o<c,(l=new Array(4))[y]=_,_=l,v*=2,y){case 0:n=c+v,d=r+v;break;case 1:c=n-v,d=r+v;break;case 2:n=c+v,r=d-v;break;case 3:c=n-v,r=d-v}this._root&&this._root.length&&(this._root=_)}return this._x0=c,this._y0=r,this._x1=n,this._y1=d,this},s.data=function(){var o=[];return this.visit(function(a){if(!a.length)do o.push(a.data);while(a=a.next)}),o},s.extent=function(o){return arguments.length?this.cover(+o[0][0],+o[0][1]).cover(+o[1][0],+o[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},s.find=function(o,a,c){var r,n,d,l,y,v,_,x=this._x0,T=this._y0,A=this._x1,S=this._y1,w=[],L=this._root;for(L&&w.push(new g(L,x,T,A,S)),c==null?c=1/0:(x=o-c,T=a-c,A=o+c,S=a+c,c*=c);v=w.pop();)if(!(!(L=v.node)||(n=v.x0)>A||(d=v.y0)>S||(l=v.x1)<x||(y=v.y1)<T))if(L.length){var k=(n+l)/2,C=(d+y)/2;w.push(new g(L[3],k,C,l,y),new g(L[2],n,C,k,y),new g(L[1],k,d,l,C),new g(L[0],n,d,k,C)),(_=(a>=C)<<1|o>=k)&&(v=w[w.length-1],w[w.length-1]=w[w.length-1-_],w[w.length-1-_]=v)}else{var M=o-+this._x.call(null,L.data),P=a-+this._y.call(null,L.data),O=M*M+P*P;if(O<c){var F=Math.sqrt(c=O);x=o-F,T=a-F,A=o+F,S=a+F,r=L.data}}return r},s.remove=function(o){if(isNaN(d=+this._x.call(null,o))||isNaN(l=+this._y.call(null,o)))return this;var a,c,r,n,d,l,y,v,_,x,T,A,S=this._root,w=this._x0,L=this._y0,k=this._x1,C=this._y1;if(!S)return this;if(S.length)for(;;){if((_=d>=(y=(w+k)/2))?w=y:k=y,(x=l>=(v=(L+C)/2))?L=v:C=v,a=S,!(S=S[T=x<<1|_]))return this;if(!S.length)break;(a[T+1&3]||a[T+2&3]||a[T+3&3])&&(c=a,A=T)}for(;S.data!==o;)if(r=S,!(S=S.next))return this;return(n=S.next)&&delete S.next,r?(n?r.next=n:delete r.next,this):a?(n?a[T]=n:delete a[T],(S=a[0]||a[1]||a[2]||a[3])&&S===(a[3]||a[2]||a[1]||a[0])&&!S.length&&(c?c[A]=S:this._root=S),this):(this._root=n,this)},s.removeAll=function(o){for(var a=0,c=o.length;a<c;++a)this.remove(o[a]);return this},s.root=function(){return this._root},s.size=function(){var o=0;return this.visit(function(a){if(!a.length)do++o;while(a=a.next)}),o},s.visit=function(o){var a,c,r,n,d,l,y=[],v=this._root;for(v&&y.push(new g(v,this._x0,this._y0,this._x1,this._y1));a=y.pop();)if(!o(v=a.node,r=a.x0,n=a.y0,d=a.x1,l=a.y1)&&v.length){var _=(r+d)/2,x=(n+l)/2;(c=v[3])&&y.push(new g(c,_,x,d,l)),(c=v[2])&&y.push(new g(c,r,x,_,l)),(c=v[1])&&y.push(new g(c,_,n,d,x)),(c=v[0])&&y.push(new g(c,r,n,_,x))}return this},s.visitAfter=function(o){var a,c=[],r=[];for(this._root&&c.push(new g(this._root,this._x0,this._y0,this._x1,this._y1));a=c.pop();){var n=a.node;if(n.length){var d,l=a.x0,y=a.y0,v=a.x1,_=a.y1,x=(l+v)/2,T=(y+_)/2;(d=n[0])&&c.push(new g(d,l,y,x,T)),(d=n[1])&&c.push(new g(d,x,y,v,T)),(d=n[2])&&c.push(new g(d,l,T,x,_)),(d=n[3])&&c.push(new g(d,x,T,v,_))}r.push(a)}for(;a=r.pop();)o(a.node,a.x0,a.y0,a.x1,a.y1);return this},s.x=function(o){return arguments.length?(this._x=o,this):this._x},s.y=function(o){return arguments.length?(this._y=o,this):this._y},t.quadtree=f,Object.defineProperty(t,"__esModule",{value:!0})})},{}],171:[function(h,N,H){(function(t,m){typeof H=="object"&&N!==void 0?m(H,h("d3-path")):m((t=t||self).d3=t.d3||{},t.d3)})(this,function(t,m){function g(Ie){return function(){return Ie}}var p=Math.abs,e=Math.atan2,f=Math.cos,u=Math.max,i=Math.min,s=Math.sin,o=Math.sqrt,a=Math.PI,c=a/2,r=2*a;function n(Ie){return Ie>1?0:Ie<-1?a:Math.acos(Ie)}function d(Ie){return Ie>=1?c:Ie<=-1?-c:Math.asin(Ie)}function l(Ie){return Ie.innerRadius}function y(Ie){return Ie.outerRadius}function v(Ie){return Ie.startAngle}function _(Ie){return Ie.endAngle}function x(Ie){return Ie&&Ie.padAngle}function T(Ie,ot,bt,Pt,Vt,nr,Yt,Xt){var ar=bt-Ie,hr=Pt-ot,mr=Yt-Vt,sr=Xt-nr,fr=sr*ar-mr*hr;if(!(fr*fr<1e-12))return[Ie+(fr=(mr*(ot-nr)-sr*(Ie-Vt))/fr)*ar,ot+fr*hr]}function A(Ie,ot,bt,Pt,Vt,nr,Yt){var Xt=Ie-bt,ar=ot-Pt,hr=(Yt?nr:-nr)/o(Xt*Xt+ar*ar),mr=hr*ar,sr=-hr*Xt,fr=Ie+mr,yr=ot+sr,zr=bt+mr,xr=Pt+sr,Br=(fr+zr)/2,Jr=(yr+xr)/2,fn=zr-fr,Cn=xr-yr,Pn=fn*fn+Cn*Cn,An=Vt-nr,rn=fr*xr-zr*yr,Fr=(Cn<0?-1:1)*o(u(0,An*An*Pn-rn*rn)),Lr=(rn*Cn-fn*Fr)/Pn,Qr=(-rn*fn-Cn*Fr)/Pn,$r=(rn*Cn+fn*Fr)/Pn,Kr=(-rn*fn+Cn*Fr)/Pn,en=Lr-Br,Tn=Qr-Jr,Mn=$r-Br,Rn=Kr-Jr;return en*en+Tn*Tn>Mn*Mn+Rn*Rn&&(Lr=$r,Qr=Kr),{cx:Lr,cy:Qr,x01:-mr,y01:-sr,x11:Lr*(Vt/An-1),y11:Qr*(Vt/An-1)}}function S(Ie){this._context=Ie}function w(Ie){return new S(Ie)}function L(Ie){return Ie[0]}function k(Ie){return Ie[1]}function C(){var Ie=L,ot=k,bt=g(!0),Pt=null,Vt=w,nr=null;function Yt(Xt){var ar,hr,mr,sr=Xt.length,fr=!1;for(Pt==null&&(nr=Vt(mr=m.path())),ar=0;ar<=sr;++ar)!(ar<sr&&bt(hr=Xt[ar],ar,Xt))===fr&&((fr=!fr)?nr.lineStart():nr.lineEnd()),fr&&nr.point(+Ie(hr,ar,Xt),+ot(hr,ar,Xt));if(mr)return nr=null,mr+""||null}return Yt.x=function(Xt){return arguments.length?(Ie=typeof Xt=="function"?Xt:g(+Xt),Yt):Ie},Yt.y=function(Xt){return arguments.length?(ot=typeof Xt=="function"?Xt:g(+Xt),Yt):ot},Yt.defined=function(Xt){return arguments.length?(bt=typeof Xt=="function"?Xt:g(!!Xt),Yt):bt},Yt.curve=function(Xt){return arguments.length?(Vt=Xt,Pt!=null&&(nr=Vt(Pt)),Yt):Vt},Yt.context=function(Xt){return arguments.length?(Xt==null?Pt=nr=null:nr=Vt(Pt=Xt),Yt):Pt},Yt}function M(){var Ie=L,ot=null,bt=g(0),Pt=k,Vt=g(!0),nr=null,Yt=w,Xt=null;function ar(mr){var sr,fr,yr,zr,xr,Br=mr.length,Jr=!1,fn=new Array(Br),Cn=new Array(Br);for(nr==null&&(Xt=Yt(xr=m.path())),sr=0;sr<=Br;++sr){if(!(sr<Br&&Vt(zr=mr[sr],sr,mr))===Jr)if(Jr=!Jr)fr=sr,Xt.areaStart(),Xt.lineStart();else{for(Xt.lineEnd(),Xt.lineStart(),yr=sr-1;yr>=fr;--yr)Xt.point(fn[yr],Cn[yr]);Xt.lineEnd(),Xt.areaEnd()}Jr&&(fn[sr]=+Ie(zr,sr,mr),Cn[sr]=+bt(zr,sr,mr),Xt.point(ot?+ot(zr,sr,mr):fn[sr],Pt?+Pt(zr,sr,mr):Cn[sr]))}if(xr)return Xt=null,xr+""||null}function hr(){return C().defined(Vt).curve(Yt).context(nr)}return ar.x=function(mr){return arguments.length?(Ie=typeof mr=="function"?mr:g(+mr),ot=null,ar):Ie},ar.x0=function(mr){return arguments.length?(Ie=typeof mr=="function"?mr:g(+mr),ar):Ie},ar.x1=function(mr){return arguments.length?(ot=mr==null?null:typeof mr=="function"?mr:g(+mr),ar):ot},ar.y=function(mr){return arguments.length?(bt=typeof mr=="function"?mr:g(+mr),Pt=null,ar):bt},ar.y0=function(mr){return arguments.length?(bt=typeof mr=="function"?mr:g(+mr),ar):bt},ar.y1=function(mr){return arguments.length?(Pt=mr==null?null:typeof mr=="function"?mr:g(+mr),ar):Pt},ar.lineX0=ar.lineY0=function(){return hr().x(Ie).y(bt)},ar.lineY1=function(){return hr().x(Ie).y(Pt)},ar.lineX1=function(){return hr().x(ot).y(bt)},ar.defined=function(mr){return arguments.length?(Vt=typeof mr=="function"?mr:g(!!mr),ar):Vt},ar.curve=function(mr){return arguments.length?(Yt=mr,nr!=null&&(Xt=Yt(nr)),ar):Yt},ar.context=function(mr){return arguments.length?(mr==null?nr=Xt=null:Xt=Yt(nr=mr),ar):nr},ar}function P(Ie,ot){return ot<Ie?-1:ot>Ie?1:ot>=Ie?0:NaN}function O(Ie){return Ie}S.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(Ie,ot){switch(Ie=+Ie,ot=+ot,this._point){case 0:this._point=1,this._line?this._context.lineTo(Ie,ot):this._context.moveTo(Ie,ot);break;case 1:this._point=2;default:this._context.lineTo(Ie,ot)}}};var F=W(w);function j(Ie){this._curve=Ie}function W(Ie){function ot(bt){return new j(Ie(bt))}return ot._curve=Ie,ot}function Z(Ie){var ot=Ie.curve;return Ie.angle=Ie.x,delete Ie.x,Ie.radius=Ie.y,delete Ie.y,Ie.curve=function(bt){return arguments.length?ot(W(bt)):ot()._curve},Ie}function Q(){return Z(C().curve(F))}function X(){var Ie=M().curve(F),ot=Ie.curve,bt=Ie.lineX0,Pt=Ie.lineX1,Vt=Ie.lineY0,nr=Ie.lineY1;return Ie.angle=Ie.x,delete Ie.x,Ie.startAngle=Ie.x0,delete Ie.x0,Ie.endAngle=Ie.x1,delete Ie.x1,Ie.radius=Ie.y,delete Ie.y,Ie.innerRadius=Ie.y0,delete Ie.y0,Ie.outerRadius=Ie.y1,delete Ie.y1,Ie.lineStartAngle=function(){return Z(bt())},delete Ie.lineX0,Ie.lineEndAngle=function(){return Z(Pt())},delete Ie.lineX1,Ie.lineInnerRadius=function(){return Z(Vt())},delete Ie.lineY0,Ie.lineOuterRadius=function(){return Z(nr())},delete Ie.lineY1,Ie.curve=function(Yt){return arguments.length?ot(W(Yt)):ot()._curve},Ie}function G(Ie,ot){return[(ot=+ot)*Math.cos(Ie-=Math.PI/2),ot*Math.sin(Ie)]}j.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(Ie,ot){this._curve.point(ot*Math.sin(Ie),ot*-Math.cos(Ie))}};var Y=Array.prototype.slice;function K(Ie){return Ie.source}function D(Ie){return Ie.target}function B(Ie){var ot=K,bt=D,Pt=L,Vt=k,nr=null;function Yt(){var Xt,ar=Y.call(arguments),hr=ot.apply(this,ar),mr=bt.apply(this,ar);if(nr||(nr=Xt=m.path()),Ie(nr,+Pt.apply(this,(ar[0]=hr,ar)),+Vt.apply(this,ar),+Pt.apply(this,(ar[0]=mr,ar)),+Vt.apply(this,ar)),Xt)return nr=null,Xt+""||null}return Yt.source=function(Xt){return arguments.length?(ot=Xt,Yt):ot},Yt.target=function(Xt){return arguments.length?(bt=Xt,Yt):bt},Yt.x=function(Xt){return arguments.length?(Pt=typeof Xt=="function"?Xt:g(+Xt),Yt):Pt},Yt.y=function(Xt){return arguments.length?(Vt=typeof Xt=="function"?Xt:g(+Xt),Yt):Vt},Yt.context=function(Xt){return arguments.length?(nr=Xt==null?null:Xt,Yt):nr},Yt}function q(Ie,ot,bt,Pt,Vt){Ie.moveTo(ot,bt),Ie.bezierCurveTo(ot=(ot+Pt)/2,bt,ot,Vt,Pt,Vt)}function ee(Ie,ot,bt,Pt,Vt){Ie.moveTo(ot,bt),Ie.bezierCurveTo(ot,bt=(bt+Vt)/2,Pt,bt,Pt,Vt)}function J(Ie,ot,bt,Pt,Vt){var nr=G(ot,bt),Yt=G(ot,bt=(bt+Vt)/2),Xt=G(Pt,bt),ar=G(Pt,Vt);Ie.moveTo(nr[0],nr[1]),Ie.bezierCurveTo(Yt[0],Yt[1],Xt[0],Xt[1],ar[0],ar[1])}var $={draw:function(Ie,ot){var bt=Math.sqrt(ot/a);Ie.moveTo(bt,0),Ie.arc(0,0,bt,0,r)}},te={draw:function(Ie,ot){var bt=Math.sqrt(ot/5)/2;Ie.moveTo(-3*bt,-bt),Ie.lineTo(-bt,-bt),Ie.lineTo(-bt,-3*bt),Ie.lineTo(bt,-3*bt),Ie.lineTo(bt,-bt),Ie.lineTo(3*bt,-bt),Ie.lineTo(3*bt,bt),Ie.lineTo(bt,bt),Ie.lineTo(bt,3*bt),Ie.lineTo(-bt,3*bt),Ie.lineTo(-bt,bt),Ie.lineTo(-3*bt,bt),Ie.closePath()}},ie=Math.sqrt(1/3),ae=2*ie,he={draw:function(Ie,ot){var bt=Math.sqrt(ot/ae),Pt=bt*ie;Ie.moveTo(0,-bt),Ie.lineTo(Pt,0),Ie.lineTo(0,bt),Ie.lineTo(-Pt,0),Ie.closePath()}},se=Math.sin(a/10)/Math.sin(7*a/10),de=Math.sin(r/10)*se,ce=-Math.cos(r/10)*se,ve={draw:function(Ie,ot){var bt=Math.sqrt(.8908130915292852*ot),Pt=de*bt,Vt=ce*bt;Ie.moveTo(0,-bt),Ie.lineTo(Pt,Vt);for(var nr=1;nr<5;++nr){var Yt=r*nr/5,Xt=Math.cos(Yt),ar=Math.sin(Yt);Ie.lineTo(ar*bt,-Xt*bt),Ie.lineTo(Xt*Pt-ar*Vt,ar*Pt+Xt*Vt)}Ie.closePath()}},ke={draw:function(Ie,ot){var bt=Math.sqrt(ot),Pt=-bt/2;Ie.rect(Pt,Pt,bt,bt)}},Ee=Math.sqrt(3),be={draw:function(Ie,ot){var bt=-Math.sqrt(ot/(3*Ee));Ie.moveTo(0,2*bt),Ie.lineTo(-Ee*bt,-bt),Ie.lineTo(Ee*bt,-bt),Ie.closePath()}},xe=-.5,ue=Math.sqrt(3)/2,me=1/Math.sqrt(12),we=3*(me/2+1),Me={draw:function(Ie,ot){var bt=Math.sqrt(ot/we),Pt=bt/2,Vt=bt*me,nr=Pt,Yt=bt*me+bt,Xt=-nr,ar=Yt;Ie.moveTo(Pt,Vt),Ie.lineTo(nr,Yt),Ie.lineTo(Xt,ar),Ie.lineTo(xe*Pt-ue*Vt,ue*Pt+xe*Vt),Ie.lineTo(xe*nr-ue*Yt,ue*nr+xe*Yt),Ie.lineTo(xe*Xt-ue*ar,ue*Xt+xe*ar),Ie.lineTo(xe*Pt+ue*Vt,xe*Vt-ue*Pt),Ie.lineTo(xe*nr+ue*Yt,xe*Yt-ue*nr),Ie.lineTo(xe*Xt+ue*ar,xe*ar-ue*Xt),Ie.closePath()}},Se=[$,te,he,ke,ve,be,Me];function De(){}function Fe(Ie,ot,bt){Ie._context.bezierCurveTo((2*Ie._x0+Ie._x1)/3,(2*Ie._y0+Ie._y1)/3,(Ie._x0+2*Ie._x1)/3,(Ie._y0+2*Ie._y1)/3,(Ie._x0+4*Ie._x1+ot)/6,(Ie._y0+4*Ie._y1+bt)/6)}function Ye(Ie){this._context=Ie}function et(Ie){this._context=Ie}function Oe(Ie){this._context=Ie}function je(Ie,ot){this._basis=new Ye(Ie),this._beta=ot}Ye.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Fe(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(Ie,ot){switch(Ie=+Ie,ot=+ot,this._point){case 0:this._point=1,this._line?this._context.lineTo(Ie,ot):this._context.moveTo(Ie,ot);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Fe(this,Ie,ot)}this._x0=this._x1,this._x1=Ie,this._y0=this._y1,this._y1=ot}},et.prototype={areaStart:De,areaEnd:De,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(Ie,ot){switch(Ie=+Ie,ot=+ot,this._point){case 0:this._point=1,this._x2=Ie,this._y2=ot;break;case 1:this._point=2,this._x3=Ie,this._y3=ot;break;case 2:this._point=3,this._x4=Ie,this._y4=ot,this._context.moveTo((this._x0+4*this._x1+Ie)/6,(this._y0+4*this._y1+ot)/6);break;default:Fe(this,Ie,ot)}this._x0=this._x1,this._x1=Ie,this._y0=this._y1,this._y1=ot}},Oe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(Ie,ot){switch(Ie=+Ie,ot=+ot,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var bt=(this._x0+4*this._x1+Ie)/6,Pt=(this._y0+4*this._y1+ot)/6;this._line?this._context.lineTo(bt,Pt):this._context.moveTo(bt,Pt);break;case 3:this._point=4;default:Fe(this,Ie,ot)}this._x0=this._x1,this._x1=Ie,this._y0=this._y1,this._y1=ot}},je.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var Ie=this._x,ot=this._y,bt=Ie.length-1;if(bt>0)for(var Pt,Vt=Ie[0],nr=ot[0],Yt=Ie[bt]-Vt,Xt=ot[bt]-nr,ar=-1;++ar<=bt;)Pt=ar/bt,this._basis.point(this._beta*Ie[ar]+(1-this._beta)*(Vt+Pt*Yt),this._beta*ot[ar]+(1-this._beta)*(nr+Pt*Xt));this._x=this._y=null,this._basis.lineEnd()},point:function(Ie,ot){this._x.push(+Ie),this._y.push(+ot)}};var We=function Ie(ot){function bt(Pt){return ot===1?new Ye(Pt):new je(Pt,ot)}return bt.beta=function(Pt){return Ie(+Pt)},bt}(.85);function Ge(Ie,ot,bt){Ie._context.bezierCurveTo(Ie._x1+Ie._k*(Ie._x2-Ie._x0),Ie._y1+Ie._k*(Ie._y2-Ie._y0),Ie._x2+Ie._k*(Ie._x1-ot),Ie._y2+Ie._k*(Ie._y1-bt),Ie._x2,Ie._y2)}function Qe(Ie,ot){this._context=Ie,this._k=(1-ot)/6}Qe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Ge(this,this._x1,this._y1)}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(Ie,ot){switch(Ie=+Ie,ot=+ot,this._point){case 0:this._point=1,this._line?this._context.lineTo(Ie,ot):this._context.moveTo(Ie,ot);break;case 1:this._point=2,this._x1=Ie,this._y1=ot;break;case 2:this._point=3;default:Ge(this,Ie,ot)}this._x0=this._x1,this._x1=this._x2,this._x2=Ie,this._y0=this._y1,this._y1=this._y2,this._y2=ot}};var it=function Ie(ot){function bt(Pt){return new Qe(Pt,ot)}return bt.tension=function(Pt){return Ie(+Pt)},bt}(0);function lt(Ie,ot){this._context=Ie,this._k=(1-ot)/6}lt.prototype={areaStart:De,areaEnd:De,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(Ie,ot){switch(Ie=+Ie,ot=+ot,this._point){case 0:this._point=1,this._x3=Ie,this._y3=ot;break;case 1:this._point=2,this._context.moveTo(this._x4=Ie,this._y4=ot);break;case 2:this._point=3,this._x5=Ie,this._y5=ot;break;default:Ge(this,Ie,ot)}this._x0=this._x1,this._x1=this._x2,this._x2=Ie,this._y0=this._y1,this._y1=this._y2,this._y2=ot}};var Lt=function Ie(ot){function bt(Pt){return new lt(Pt,ot)}return bt.tension=function(Pt){return Ie(+Pt)},bt}(0);function wt(Ie,ot){this._context=Ie,this._k=(1-ot)/6}wt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(Ie,ot){switch(Ie=+Ie,ot=+ot,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Ge(this,Ie,ot)}this._x0=this._x1,this._x1=this._x2,this._x2=Ie,this._y0=this._y1,this._y1=this._y2,this._y2=ot}};var rt=function Ie(ot){function bt(Pt){return new wt(Pt,ot)}return bt.tension=function(Pt){return Ie(+Pt)},bt}(0);function $e(Ie,ot,bt){var Pt=Ie._x1,Vt=Ie._y1,nr=Ie._x2,Yt=Ie._y2;if(Ie._l01_a>1e-12){var Xt=2*Ie._l01_2a+3*Ie._l01_a*Ie._l12_a+Ie._l12_2a,ar=3*Ie._l01_a*(Ie._l01_a+Ie._l12_a);Pt=(Pt*Xt-Ie._x0*Ie._l12_2a+Ie._x2*Ie._l01_2a)/ar,Vt=(Vt*Xt-Ie._y0*Ie._l12_2a+Ie._y2*Ie._l01_2a)/ar}if(Ie._l23_a>1e-12){var hr=2*Ie._l23_2a+3*Ie._l23_a*Ie._l12_a+Ie._l12_2a,mr=3*Ie._l23_a*(Ie._l23_a+Ie._l12_a);nr=(nr*hr+Ie._x1*Ie._l23_2a-ot*Ie._l12_2a)/mr,Yt=(Yt*hr+Ie._y1*Ie._l23_2a-bt*Ie._l12_2a)/mr}Ie._context.bezierCurveTo(Pt,Vt,nr,Yt,Ie._x2,Ie._y2)}function xt(Ie,ot){this._context=Ie,this._alpha=ot}xt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(Ie,ot){if(Ie=+Ie,ot=+ot,this._point){var bt=this._x2-Ie,Pt=this._y2-ot;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(bt*bt+Pt*Pt,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(Ie,ot):this._context.moveTo(Ie,ot);break;case 1:this._point=2;break;case 2:this._point=3;default:$e(this,Ie,ot)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=Ie,this._y0=this._y1,this._y1=this._y2,this._y2=ot}};var Qt=function Ie(ot){function bt(Pt){return ot?new xt(Pt,ot):new Qe(Pt,0)}return bt.alpha=function(Pt){return Ie(+Pt)},bt}(.5);function $t(Ie,ot){this._context=Ie,this._alpha=ot}$t.prototype={areaStart:De,areaEnd:De,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(Ie,ot){if(Ie=+Ie,ot=+ot,this._point){var bt=this._x2-Ie,Pt=this._y2-ot;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(bt*bt+Pt*Pt,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=Ie,this._y3=ot;break;case 1:this._point=2,this._context.moveTo(this._x4=Ie,this._y4=ot);break;case 2:this._point=3,this._x5=Ie,this._y5=ot;break;default:$e(this,Ie,ot)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=Ie,this._y0=this._y1,this._y1=this._y2,this._y2=ot}};var Ue=function Ie(ot){function bt(Pt){return ot?new $t(Pt,ot):new lt(Pt,0)}return bt.alpha=function(Pt){return Ie(+Pt)},bt}(.5);function He(Ie,ot){this._context=Ie,this._alpha=ot}He.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(Ie,ot){if(Ie=+Ie,ot=+ot,this._point){var bt=this._x2-Ie,Pt=this._y2-ot;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(bt*bt+Pt*Pt,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:$e(this,Ie,ot)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=Ie,this._y0=this._y1,this._y1=this._y2,this._y2=ot}};var Be=function Ie(ot){function bt(Pt){return ot?new He(Pt,ot):new wt(Pt,0)}return bt.alpha=function(Pt){return Ie(+Pt)},bt}(.5);function Je(Ie){this._context=Ie}function _e(Ie){return Ie<0?-1:1}function Le(Ie,ot,bt){var Pt=Ie._x1-Ie._x0,Vt=ot-Ie._x1,nr=(Ie._y1-Ie._y0)/(Pt||Vt<0&&-0),Yt=(bt-Ie._y1)/(Vt||Pt<0&&-0),Xt=(nr*Vt+Yt*Pt)/(Pt+Vt);return(_e(nr)+_e(Yt))*Math.min(Math.abs(nr),Math.abs(Yt),.5*Math.abs(Xt))||0}function Ce(Ie,ot){var bt=Ie._x1-Ie._x0;return bt?(3*(Ie._y1-Ie._y0)/bt-ot)/2:ot}function Pe(Ie,ot,bt){var Pt=Ie._x0,Vt=Ie._y0,nr=Ie._x1,Yt=Ie._y1,Xt=(nr-Pt)/3;Ie._context.bezierCurveTo(Pt+Xt,Vt+Xt*ot,nr-Xt,Yt-Xt*bt,nr,Yt)}function Xe(Ie){this._context=Ie}function ut(Ie){this._context=new kt(Ie)}function kt(Ie){this._context=Ie}function ft(Ie){this._context=Ie}function Et(Ie){var ot,bt,Pt=Ie.length-1,Vt=new Array(Pt),nr=new Array(Pt),Yt=new Array(Pt);for(Vt[0]=0,nr[0]=2,Yt[0]=Ie[0]+2*Ie[1],ot=1;ot<Pt-1;++ot)Vt[ot]=1,nr[ot]=4,Yt[ot]=4*Ie[ot]+2*Ie[ot+1];for(Vt[Pt-1]=2,nr[Pt-1]=7,Yt[Pt-1]=8*Ie[Pt-1]+Ie[Pt],ot=1;ot<Pt;++ot)bt=Vt[ot]/nr[ot-1],nr[ot]-=bt,Yt[ot]-=bt*Yt[ot-1];for(Vt[Pt-1]=Yt[Pt-1]/nr[Pt-1],ot=Pt-2;ot>=0;--ot)Vt[ot]=(Yt[ot]-Vt[ot+1])/nr[ot];for(nr[Pt-1]=(Ie[Pt]+Vt[Pt-1])/2,ot=0;ot<Pt-1;++ot)nr[ot]=2*Ie[ot+1]-Vt[ot+1];return[Vt,nr]}function mt(Ie,ot){this._context=Ie,this._t=ot}function It(Ie,ot){if((Vt=Ie.length)>1)for(var bt,Pt,Vt,nr=1,Yt=Ie[ot[0]],Xt=Yt.length;nr<Vt;++nr)for(Pt=Yt,Yt=Ie[ot[nr]],bt=0;bt<Xt;++bt)Yt[bt][1]+=Yt[bt][0]=isNaN(Pt[bt][1])?Pt[bt][0]:Pt[bt][1]}function vt(Ie){for(var ot=Ie.length,bt=new Array(ot);--ot>=0;)bt[ot]=ot;return bt}function nt(Ie,ot){return Ie[ot]}function At(Ie){var ot=Ie.map(Ft);return vt(Ie).sort(function(bt,Pt){return ot[bt]-ot[Pt]})}function Ft(Ie){for(var ot,bt=-1,Pt=0,Vt=Ie.length,nr=-1/0;++bt<Vt;)(ot=+Ie[bt][1])>nr&&(nr=ot,Pt=bt);return Pt}function Nt(Ie){var ot=Ie.map(Kt);return vt(Ie).sort(function(bt,Pt){return ot[bt]-ot[Pt]})}function Kt(Ie){for(var ot,bt=0,Pt=-1,Vt=Ie.length;++Pt<Vt;)(ot=+Ie[Pt][1])&&(bt+=ot);return bt}Je.prototype={areaStart:De,areaEnd:De,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(Ie,ot){Ie=+Ie,ot=+ot,this._point?this._context.lineTo(Ie,ot):(this._point=1,this._context.moveTo(Ie,ot))}},Xe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Pe(this,this._t0,Ce(this,this._t0))}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(Ie,ot){var bt=NaN;if(ot=+ot,(Ie=+Ie)!==this._x1||ot!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(Ie,ot):this._context.moveTo(Ie,ot);break;case 1:this._point=2;break;case 2:this._point=3,Pe(this,Ce(this,bt=Le(this,Ie,ot)),bt);break;default:Pe(this,this._t0,bt=Le(this,Ie,ot))}this._x0=this._x1,this._x1=Ie,this._y0=this._y1,this._y1=ot,this._t0=bt}}},(ut.prototype=Object.create(Xe.prototype)).point=function(Ie,ot){Xe.prototype.point.call(this,ot,Ie)},kt.prototype={moveTo:function(Ie,ot){this._context.moveTo(ot,Ie)},closePath:function(){this._context.closePath()},lineTo:function(Ie,ot){this._context.lineTo(ot,Ie)},bezierCurveTo:function(Ie,ot,bt,Pt,Vt,nr){this._context.bezierCurveTo(ot,Ie,Pt,bt,nr,Vt)}},ft.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var Ie=this._x,ot=this._y,bt=Ie.length;if(bt)if(this._line?this._context.lineTo(Ie[0],ot[0]):this._context.moveTo(Ie[0],ot[0]),bt===2)this._context.lineTo(Ie[1],ot[1]);else for(var Pt=Et(Ie),Vt=Et(ot),nr=0,Yt=1;Yt<bt;++nr,++Yt)this._context.bezierCurveTo(Pt[0][nr],Vt[0][nr],Pt[1][nr],Vt[1][nr],Ie[Yt],ot[Yt]);(this._line||this._line!==0&&bt===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(Ie,ot){this._x.push(+Ie),this._y.push(+ot)}},mt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(Ie,ot){switch(Ie=+Ie,ot=+ot,this._point){case 0:this._point=1,this._line?this._context.lineTo(Ie,ot):this._context.moveTo(Ie,ot);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,ot),this._context.lineTo(Ie,ot);else{var bt=this._x*(1-this._t)+Ie*this._t;this._context.lineTo(bt,this._y),this._context.lineTo(bt,ot)}}this._x=Ie,this._y=ot}},t.arc=function(){var Ie=l,ot=y,bt=g(0),Pt=null,Vt=v,nr=_,Yt=x,Xt=null;function ar(){var hr,mr,sr=+Ie.apply(this,arguments),fr=+ot.apply(this,arguments),yr=Vt.apply(this,arguments)-c,zr=nr.apply(this,arguments)-c,xr=p(zr-yr),Br=zr>yr;if(Xt||(Xt=hr=m.path()),fr<sr&&(mr=fr,fr=sr,sr=mr),fr>1e-12)if(xr>r-1e-12)Xt.moveTo(fr*f(yr),fr*s(yr)),Xt.arc(0,0,fr,yr,zr,!Br),sr>1e-12&&(Xt.moveTo(sr*f(zr),sr*s(zr)),Xt.arc(0,0,sr,zr,yr,Br));else{var Jr,fn,Cn=yr,Pn=zr,An=yr,rn=zr,Fr=xr,Lr=xr,Qr=Yt.apply(this,arguments)/2,$r=Qr>1e-12&&(Pt?+Pt.apply(this,arguments):o(sr*sr+fr*fr)),Kr=i(p(fr-sr)/2,+bt.apply(this,arguments)),en=Kr,Tn=Kr;if($r>1e-12){var Mn=d($r/sr*s(Qr)),Rn=d($r/fr*s(Qr));(Fr-=2*Mn)>1e-12?(An+=Mn*=Br?1:-1,rn-=Mn):(Fr=0,An=rn=(yr+zr)/2),(Lr-=2*Rn)>1e-12?(Cn+=Rn*=Br?1:-1,Pn-=Rn):(Lr=0,Cn=Pn=(yr+zr)/2)}var Zt=fr*f(Cn),Ct=fr*s(Cn),Ht=sr*f(rn),cr=sr*s(rn);if(Kr>1e-12){var _r,Vr=fr*f(Pn),jr=fr*s(Pn),vr=sr*f(An),br=sr*s(An);if(xr<a&&(_r=T(Zt,Ct,vr,br,Vr,jr,Ht,cr))){var Ar=Zt-_r[0],kr=Ct-_r[1],Cr=Vr-_r[0],Hr=jr-_r[1],ln=1/s(n((Ar*Cr+kr*Hr)/(o(Ar*Ar+kr*kr)*o(Cr*Cr+Hr*Hr)))/2),xn=o(_r[0]*_r[0]+_r[1]*_r[1]);en=i(Kr,(sr-xn)/(ln-1)),Tn=i(Kr,(fr-xn)/(ln+1))}}Lr>1e-12?Tn>1e-12?(Jr=A(vr,br,Zt,Ct,fr,Tn,Br),fn=A(Vr,jr,Ht,cr,fr,Tn,Br),Xt.moveTo(Jr.cx+Jr.x01,Jr.cy+Jr.y01),Tn<Kr?Xt.arc(Jr.cx,Jr.cy,Tn,e(Jr.y01,Jr.x01),e(fn.y01,fn.x01),!Br):(Xt.arc(Jr.cx,Jr.cy,Tn,e(Jr.y01,Jr.x01),e(Jr.y11,Jr.x11),!Br),Xt.arc(0,0,fr,e(Jr.cy+Jr.y11,Jr.cx+Jr.x11),e(fn.cy+fn.y11,fn.cx+fn.x11),!Br),Xt.arc(fn.cx,fn.cy,Tn,e(fn.y11,fn.x11),e(fn.y01,fn.x01),!Br))):(Xt.moveTo(Zt,Ct),Xt.arc(0,0,fr,Cn,Pn,!Br)):Xt.moveTo(Zt,Ct),sr>1e-12&&Fr>1e-12?en>1e-12?(Jr=A(Ht,cr,Vr,jr,sr,-en,Br),fn=A(Zt,Ct,vr,br,sr,-en,Br),Xt.lineTo(Jr.cx+Jr.x01,Jr.cy+Jr.y01),en<Kr?Xt.arc(Jr.cx,Jr.cy,en,e(Jr.y01,Jr.x01),e(fn.y01,fn.x01),!Br):(Xt.arc(Jr.cx,Jr.cy,en,e(Jr.y01,Jr.x01),e(Jr.y11,Jr.x11),!Br),Xt.arc(0,0,sr,e(Jr.cy+Jr.y11,Jr.cx+Jr.x11),e(fn.cy+fn.y11,fn.cx+fn.x11),Br),Xt.arc(fn.cx,fn.cy,en,e(fn.y11,fn.x11),e(fn.y01,fn.x01),!Br))):Xt.arc(0,0,sr,rn,An,Br):Xt.lineTo(Ht,cr)}else Xt.moveTo(0,0);if(Xt.closePath(),hr)return Xt=null,hr+""||null}return ar.centroid=function(){var hr=(+Ie.apply(this,arguments)+ +ot.apply(this,arguments))/2,mr=(+Vt.apply(this,arguments)+ +nr.apply(this,arguments))/2-a/2;return[f(mr)*hr,s(mr)*hr]},ar.innerRadius=function(hr){return arguments.length?(Ie=typeof hr=="function"?hr:g(+hr),ar):Ie},ar.outerRadius=function(hr){return arguments.length?(ot=typeof hr=="function"?hr:g(+hr),ar):ot},ar.cornerRadius=function(hr){return arguments.length?(bt=typeof hr=="function"?hr:g(+hr),ar):bt},ar.padRadius=function(hr){return arguments.length?(Pt=hr==null?null:typeof hr=="function"?hr:g(+hr),ar):Pt},ar.startAngle=function(hr){return arguments.length?(Vt=typeof hr=="function"?hr:g(+hr),ar):Vt},ar.endAngle=function(hr){return arguments.length?(nr=typeof hr=="function"?hr:g(+hr),ar):nr},ar.padAngle=function(hr){return arguments.length?(Yt=typeof hr=="function"?hr:g(+hr),ar):Yt},ar.context=function(hr){return arguments.length?(Xt=hr==null?null:hr,ar):Xt},ar},t.area=M,t.areaRadial=X,t.curveBasis=function(Ie){return new Ye(Ie)},t.curveBasisClosed=function(Ie){return new et(Ie)},t.curveBasisOpen=function(Ie){return new Oe(Ie)},t.curveBundle=We,t.curveCardinal=it,t.curveCardinalClosed=Lt,t.curveCardinalOpen=rt,t.curveCatmullRom=Qt,t.curveCatmullRomClosed=Ue,t.curveCatmullRomOpen=Be,t.curveLinear=w,t.curveLinearClosed=function(Ie){return new Je(Ie)},t.curveMonotoneX=function(Ie){return new Xe(Ie)},t.curveMonotoneY=function(Ie){return new ut(Ie)},t.curveNatural=function(Ie){return new ft(Ie)},t.curveStep=function(Ie){return new mt(Ie,.5)},t.curveStepAfter=function(Ie){return new mt(Ie,1)},t.curveStepBefore=function(Ie){return new mt(Ie,0)},t.line=C,t.lineRadial=Q,t.linkHorizontal=function(){return B(q)},t.linkRadial=function(){var Ie=B(J);return Ie.angle=Ie.x,delete Ie.x,Ie.radius=Ie.y,delete Ie.y,Ie},t.linkVertical=function(){return B(ee)},t.pie=function(){var Ie=O,ot=P,bt=null,Pt=g(0),Vt=g(r),nr=g(0);function Yt(Xt){var ar,hr,mr,sr,fr,yr=Xt.length,zr=0,xr=new Array(yr),Br=new Array(yr),Jr=+Pt.apply(this,arguments),fn=Math.min(r,Math.max(-r,Vt.apply(this,arguments)-Jr)),Cn=Math.min(Math.abs(fn)/yr,nr.apply(this,arguments)),Pn=Cn*(fn<0?-1:1);for(ar=0;ar<yr;++ar)(fr=Br[xr[ar]=ar]=+Ie(Xt[ar],ar,Xt))>0&&(zr+=fr);for(ot!=null?xr.sort(function(An,rn){return ot(Br[An],Br[rn])}):bt!=null&&xr.sort(function(An,rn){return bt(Xt[An],Xt[rn])}),ar=0,mr=zr?(fn-yr*Pn)/zr:0;ar<yr;++ar,Jr=sr)hr=xr[ar],sr=Jr+((fr=Br[hr])>0?fr*mr:0)+Pn,Br[hr]={data:Xt[hr],index:ar,value:fr,startAngle:Jr,endAngle:sr,padAngle:Cn};return Br}return Yt.value=function(Xt){return arguments.length?(Ie=typeof Xt=="function"?Xt:g(+Xt),Yt):Ie},Yt.sortValues=function(Xt){return arguments.length?(ot=Xt,bt=null,Yt):ot},Yt.sort=function(Xt){return arguments.length?(bt=Xt,ot=null,Yt):bt},Yt.startAngle=function(Xt){return arguments.length?(Pt=typeof Xt=="function"?Xt:g(+Xt),Yt):Pt},Yt.endAngle=function(Xt){return arguments.length?(Vt=typeof Xt=="function"?Xt:g(+Xt),Yt):Vt},Yt.padAngle=function(Xt){return arguments.length?(nr=typeof Xt=="function"?Xt:g(+Xt),Yt):nr},Yt},t.pointRadial=G,t.radialArea=X,t.radialLine=Q,t.stack=function(){var Ie=g([]),ot=vt,bt=It,Pt=nt;function Vt(nr){var Yt,Xt,ar=Ie.apply(this,arguments),hr=nr.length,mr=ar.length,sr=new Array(mr);for(Yt=0;Yt<mr;++Yt){for(var fr,yr=ar[Yt],zr=sr[Yt]=new Array(hr),xr=0;xr<hr;++xr)zr[xr]=fr=[0,+Pt(nr[xr],yr,xr,nr)],fr.data=nr[xr];zr.key=yr}for(Yt=0,Xt=ot(sr);Yt<mr;++Yt)sr[Xt[Yt]].index=Yt;return bt(sr,Xt),sr}return Vt.keys=function(nr){return arguments.length?(Ie=typeof nr=="function"?nr:g(Y.call(nr)),Vt):Ie},Vt.value=function(nr){return arguments.length?(Pt=typeof nr=="function"?nr:g(+nr),Vt):Pt},Vt.order=function(nr){return arguments.length?(ot=nr==null?vt:typeof nr=="function"?nr:g(Y.call(nr)),Vt):ot},Vt.offset=function(nr){return arguments.length?(bt=nr==null?It:nr,Vt):bt},Vt},t.stackOffsetDiverging=function(Ie,ot){if((Xt=Ie.length)>0)for(var bt,Pt,Vt,nr,Yt,Xt,ar=0,hr=Ie[ot[0]].length;ar<hr;++ar)for(nr=Yt=0,bt=0;bt<Xt;++bt)(Vt=(Pt=Ie[ot[bt]][ar])[1]-Pt[0])>0?(Pt[0]=nr,Pt[1]=nr+=Vt):Vt<0?(Pt[1]=Yt,Pt[0]=Yt+=Vt):(Pt[0]=0,Pt[1]=Vt)},t.stackOffsetExpand=function(Ie,ot){if((Pt=Ie.length)>0){for(var bt,Pt,Vt,nr=0,Yt=Ie[0].length;nr<Yt;++nr){for(Vt=bt=0;bt<Pt;++bt)Vt+=Ie[bt][nr][1]||0;if(Vt)for(bt=0;bt<Pt;++bt)Ie[bt][nr][1]/=Vt}It(Ie,ot)}},t.stackOffsetNone=It,t.stackOffsetSilhouette=function(Ie,ot){if((bt=Ie.length)>0){for(var bt,Pt=0,Vt=Ie[ot[0]],nr=Vt.length;Pt<nr;++Pt){for(var Yt=0,Xt=0;Yt<bt;++Yt)Xt+=Ie[Yt][Pt][1]||0;Vt[Pt][1]+=Vt[Pt][0]=-Xt/2}It(Ie,ot)}},t.stackOffsetWiggle=function(Ie,ot){if((Vt=Ie.length)>0&&(Pt=(bt=Ie[ot[0]]).length)>0){for(var bt,Pt,Vt,nr=0,Yt=1;Yt<Pt;++Yt){for(var Xt=0,ar=0,hr=0;Xt<Vt;++Xt){for(var mr=Ie[ot[Xt]],sr=mr[Yt][1]||0,fr=(sr-(mr[Yt-1][1]||0))/2,yr=0;yr<Xt;++yr){var zr=Ie[ot[yr]];fr+=(zr[Yt][1]||0)-(zr[Yt-1][1]||0)}ar+=sr,hr+=fr*sr}bt[Yt-1][1]+=bt[Yt-1][0]=nr,ar&&(nr-=hr/ar)}bt[Yt-1][1]+=bt[Yt-1][0]=nr,It(Ie,ot)}},t.stackOrderAppearance=At,t.stackOrderAscending=Nt,t.stackOrderDescending=function(Ie){return Nt(Ie).reverse()},t.stackOrderInsideOut=function(Ie){var ot,bt,Pt=Ie.length,Vt=Ie.map(Kt),nr=At(Ie),Yt=0,Xt=0,ar=[],hr=[];for(ot=0;ot<Pt;++ot)bt=nr[ot],Yt<Xt?(Yt+=Vt[bt],ar.push(bt)):(Xt+=Vt[bt],hr.push(bt));return hr.reverse().concat(ar)},t.stackOrderNone=vt,t.stackOrderReverse=function(Ie){return vt(Ie).reverse()},t.symbol=function(){var Ie=g($),ot=g(64),bt=null;function Pt(){var Vt;if(bt||(bt=Vt=m.path()),Ie.apply(this,arguments).draw(bt,+ot.apply(this,arguments)),Vt)return bt=null,Vt+""||null}return Pt.type=function(Vt){return arguments.length?(Ie=typeof Vt=="function"?Vt:g(Vt),Pt):Ie},Pt.size=function(Vt){return arguments.length?(ot=typeof Vt=="function"?Vt:g(+Vt),Pt):ot},Pt.context=function(Vt){return arguments.length?(bt=Vt==null?null:Vt,Pt):bt},Pt},t.symbolCircle=$,t.symbolCross=te,t.symbolDiamond=he,t.symbolSquare=ke,t.symbolStar=ve,t.symbolTriangle=be,t.symbolWye=Me,t.symbols=Se,Object.defineProperty(t,"__esModule",{value:!0})})},{"d3-path":169}],172:[function(h,N,H){(function(t,m){typeof H=="object"&&N!==void 0?m(H,h("d3-time")):m((t=t||self).d3=t.d3||{},t.d3)})(this,function(t,m){function g(rt){if(0<=rt.y&&rt.y<100){var $e=new Date(-1,rt.m,rt.d,rt.H,rt.M,rt.S,rt.L);return $e.setFullYear(rt.y),$e}return new Date(rt.y,rt.m,rt.d,rt.H,rt.M,rt.S,rt.L)}function p(rt){if(0<=rt.y&&rt.y<100){var $e=new Date(Date.UTC(-1,rt.m,rt.d,rt.H,rt.M,rt.S,rt.L));return $e.setUTCFullYear(rt.y),$e}return new Date(Date.UTC(rt.y,rt.m,rt.d,rt.H,rt.M,rt.S,rt.L))}function e(rt,$e,xt){return{y:rt,m:$e,d:xt,H:0,M:0,S:0,L:0}}function f(rt){var $e=rt.dateTime,xt=rt.date,Qt=rt.time,$t=rt.periods,Ue=rt.days,He=rt.shortDays,Be=rt.months,Je=rt.shortMonths,_e=n($t),Le=d($t),Ce=n(Ue),Pe=d(Ue),Xe=n(He),ut=d(He),kt=n(Be),ft=d(Be),Et=n(Je),mt=d(Je),It={a:function(Kt){return He[Kt.getDay()]},A:function(Kt){return Ue[Kt.getDay()]},b:function(Kt){return Je[Kt.getMonth()]},B:function(Kt){return Be[Kt.getMonth()]},c:null,d:X,e:X,f:B,H:G,I:Y,j:K,L:D,m:q,M:ee,p:function(Kt){return $t[+(Kt.getHours()>=12)]},q:function(Kt){return 1+~~(Kt.getMonth()/3)},Q:Qe,s:it,S:J,u:$,U:te,V:ie,w:ae,W:he,x:null,X:null,y:se,Y:de,Z:ce,"%":Ge},vt={a:function(Kt){return He[Kt.getUTCDay()]},A:function(Kt){return Ue[Kt.getUTCDay()]},b:function(Kt){return Je[Kt.getUTCMonth()]},B:function(Kt){return Be[Kt.getUTCMonth()]},c:null,d:ve,e:ve,f:ue,H:ke,I:Ee,j:be,L:xe,m:me,M:we,p:function(Kt){return $t[+(Kt.getUTCHours()>=12)]},q:function(Kt){return 1+~~(Kt.getUTCMonth()/3)},Q:Qe,s:it,S:Me,u:Se,U:De,V:Fe,w:Ye,W:et,x:null,X:null,y:Oe,Y:je,Z:We,"%":Ge},nt={a:function(Kt,Ie,ot){var bt=Xe.exec(Ie.slice(ot));return bt?(Kt.w=ut[bt[0].toLowerCase()],ot+bt[0].length):-1},A:function(Kt,Ie,ot){var bt=Ce.exec(Ie.slice(ot));return bt?(Kt.w=Pe[bt[0].toLowerCase()],ot+bt[0].length):-1},b:function(Kt,Ie,ot){var bt=Et.exec(Ie.slice(ot));return bt?(Kt.m=mt[bt[0].toLowerCase()],ot+bt[0].length):-1},B:function(Kt,Ie,ot){var bt=kt.exec(Ie.slice(ot));return bt?(Kt.m=ft[bt[0].toLowerCase()],ot+bt[0].length):-1},c:function(Kt,Ie,ot){return Nt(Kt,$e,Ie,ot)},d:k,e:k,f:j,H:M,I:M,j:C,L:F,m:L,M:P,p:function(Kt,Ie,ot){var bt=_e.exec(Ie.slice(ot));return bt?(Kt.p=Le[bt[0].toLowerCase()],ot+bt[0].length):-1},q:w,Q:Z,s:Q,S:O,u:y,U:v,V:_,w:l,W:x,x:function(Kt,Ie,ot){return Nt(Kt,xt,Ie,ot)},X:function(Kt,Ie,ot){return Nt(Kt,Qt,Ie,ot)},y:A,Y:T,Z:S,"%":W};function At(Kt,Ie){return function(ot){var bt,Pt,Vt,nr=[],Yt=-1,Xt=0,ar=Kt.length;for(ot instanceof Date||(ot=new Date(+ot));++Yt<ar;)Kt.charCodeAt(Yt)===37&&(nr.push(Kt.slice(Xt,Yt)),(Pt=i[bt=Kt.charAt(++Yt)])!=null?bt=Kt.charAt(++Yt):Pt=bt==="e"?" ":"0",(Vt=Ie[bt])&&(bt=Vt(ot,Pt)),nr.push(bt),Xt=Yt+1);return nr.push(Kt.slice(Xt,Yt)),nr.join("")}}function Ft(Kt,Ie){return function(ot){var bt,Pt,Vt=e(1900,void 0,1);if(Nt(Vt,Kt,ot+="",0)!=ot.length)return null;if("Q"in Vt)return new Date(Vt.Q);if("s"in Vt)return new Date(1e3*Vt.s+("L"in Vt?Vt.L:0));if(Ie&&!("Z"in Vt)&&(Vt.Z=0),"p"in Vt&&(Vt.H=Vt.H%12+12*Vt.p),Vt.m===void 0&&(Vt.m="q"in Vt?Vt.q:0),"V"in Vt){if(Vt.V<1||Vt.V>53)return null;"w"in Vt||(Vt.w=1),"Z"in Vt?(Pt=(bt=p(e(Vt.y,0,1))).getUTCDay(),bt=Pt>4||Pt===0?m.utcMonday.ceil(bt):m.utcMonday(bt),bt=m.utcDay.offset(bt,7*(Vt.V-1)),Vt.y=bt.getUTCFullYear(),Vt.m=bt.getUTCMonth(),Vt.d=bt.getUTCDate()+(Vt.w+6)%7):(Pt=(bt=g(e(Vt.y,0,1))).getDay(),bt=Pt>4||Pt===0?m.timeMonday.ceil(bt):m.timeMonday(bt),bt=m.timeDay.offset(bt,7*(Vt.V-1)),Vt.y=bt.getFullYear(),Vt.m=bt.getMonth(),Vt.d=bt.getDate()+(Vt.w+6)%7)}else("W"in Vt||"U"in Vt)&&("w"in Vt||(Vt.w="u"in Vt?Vt.u%7:"W"in Vt?1:0),Pt="Z"in Vt?p(e(Vt.y,0,1)).getUTCDay():g(e(Vt.y,0,1)).getDay(),Vt.m=0,Vt.d="W"in Vt?(Vt.w+6)%7+7*Vt.W-(Pt+5)%7:Vt.w+7*Vt.U-(Pt+6)%7);return"Z"in Vt?(Vt.H+=Vt.Z/100|0,Vt.M+=Vt.Z%100,p(Vt)):g(Vt)}}function Nt(Kt,Ie,ot,bt){for(var Pt,Vt,nr=0,Yt=Ie.length,Xt=ot.length;nr<Yt;){if(bt>=Xt)return-1;if((Pt=Ie.charCodeAt(nr++))===37){if(Pt=Ie.charAt(nr++),!(Vt=nt[Pt in i?Ie.charAt(nr++):Pt])||(bt=Vt(Kt,ot,bt))<0)return-1}else if(Pt!=ot.charCodeAt(bt++))return-1}return bt}return It.x=At(xt,It),It.X=At(Qt,It),It.c=At($e,It),vt.x=At(xt,vt),vt.X=At(Qt,vt),vt.c=At($e,vt),{format:function(Kt){var Ie=At(Kt+="",It);return Ie.toString=function(){return Kt},Ie},parse:function(Kt){var Ie=Ft(Kt+="",!1);return Ie.toString=function(){return Kt},Ie},utcFormat:function(Kt){var Ie=At(Kt+="",vt);return Ie.toString=function(){return Kt},Ie},utcParse:function(Kt){var Ie=Ft(Kt+="",!0);return Ie.toString=function(){return Kt},Ie}}}var u,i={"-":"",_:" ",0:"0"},s=/^\s*\d+/,o=/^%/,a=/[\\^$*+?|[\]().{}]/g;function c(rt,$e,xt){var Qt=rt<0?"-":"",$t=(Qt?-rt:rt)+"",Ue=$t.length;return Qt+(Ue<xt?new Array(xt-Ue+1).join($e)+$t:$t)}function r(rt){return rt.replace(a,"\\$&")}function n(rt){return new RegExp("^(?:"+rt.map(r).join("|")+")","i")}function d(rt){for(var $e={},xt=-1,Qt=rt.length;++xt<Qt;)$e[rt[xt].toLowerCase()]=xt;return $e}function l(rt,$e,xt){var Qt=s.exec($e.slice(xt,xt+1));return Qt?(rt.w=+Qt[0],xt+Qt[0].length):-1}function y(rt,$e,xt){var Qt=s.exec($e.slice(xt,xt+1));return Qt?(rt.u=+Qt[0],xt+Qt[0].length):-1}function v(rt,$e,xt){var Qt=s.exec($e.slice(xt,xt+2));return Qt?(rt.U=+Qt[0],xt+Qt[0].length):-1}function _(rt,$e,xt){var Qt=s.exec($e.slice(xt,xt+2));return Qt?(rt.V=+Qt[0],xt+Qt[0].length):-1}function x(rt,$e,xt){var Qt=s.exec($e.slice(xt,xt+2));return Qt?(rt.W=+Qt[0],xt+Qt[0].length):-1}function T(rt,$e,xt){var Qt=s.exec($e.slice(xt,xt+4));return Qt?(rt.y=+Qt[0],xt+Qt[0].length):-1}function A(rt,$e,xt){var Qt=s.exec($e.slice(xt,xt+2));return Qt?(rt.y=+Qt[0]+(+Qt[0]>68?1900:2e3),xt+Qt[0].length):-1}function S(rt,$e,xt){var Qt=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec($e.slice(xt,xt+6));return Qt?(rt.Z=Qt[1]?0:-(Qt[2]+(Qt[3]||"00")),xt+Qt[0].length):-1}function w(rt,$e,xt){var Qt=s.exec($e.slice(xt,xt+1));return Qt?(rt.q=3*Qt[0]-3,xt+Qt[0].length):-1}function L(rt,$e,xt){var Qt=s.exec($e.slice(xt,xt+2));return Qt?(rt.m=Qt[0]-1,xt+Qt[0].length):-1}function k(rt,$e,xt){var Qt=s.exec($e.slice(xt,xt+2));return Qt?(rt.d=+Qt[0],xt+Qt[0].length):-1}function C(rt,$e,xt){var Qt=s.exec($e.slice(xt,xt+3));return Qt?(rt.m=0,rt.d=+Qt[0],xt+Qt[0].length):-1}function M(rt,$e,xt){var Qt=s.exec($e.slice(xt,xt+2));return Qt?(rt.H=+Qt[0],xt+Qt[0].length):-1}function P(rt,$e,xt){var Qt=s.exec($e.slice(xt,xt+2));return Qt?(rt.M=+Qt[0],xt+Qt[0].length):-1}function O(rt,$e,xt){var Qt=s.exec($e.slice(xt,xt+2));return Qt?(rt.S=+Qt[0],xt+Qt[0].length):-1}function F(rt,$e,xt){var Qt=s.exec($e.slice(xt,xt+3));return Qt?(rt.L=+Qt[0],xt+Qt[0].length):-1}function j(rt,$e,xt){var Qt=s.exec($e.slice(xt,xt+6));return Qt?(rt.L=Math.floor(Qt[0]/1e3),xt+Qt[0].length):-1}function W(rt,$e,xt){var Qt=o.exec($e.slice(xt,xt+1));return Qt?xt+Qt[0].length:-1}function Z(rt,$e,xt){var Qt=s.exec($e.slice(xt));return Qt?(rt.Q=+Qt[0],xt+Qt[0].length):-1}function Q(rt,$e,xt){var Qt=s.exec($e.slice(xt));return Qt?(rt.s=+Qt[0],xt+Qt[0].length):-1}function X(rt,$e){return c(rt.getDate(),$e,2)}function G(rt,$e){return c(rt.getHours(),$e,2)}function Y(rt,$e){return c(rt.getHours()%12||12,$e,2)}function K(rt,$e){return c(1+m.timeDay.count(m.timeYear(rt),rt),$e,3)}function D(rt,$e){return c(rt.getMilliseconds(),$e,3)}function B(rt,$e){return D(rt,$e)+"000"}function q(rt,$e){return c(rt.getMonth()+1,$e,2)}function ee(rt,$e){return c(rt.getMinutes(),$e,2)}function J(rt,$e){return c(rt.getSeconds(),$e,2)}function $(rt){var $e=rt.getDay();return $e===0?7:$e}function te(rt,$e){return c(m.timeSunday.count(m.timeYear(rt)-1,rt),$e,2)}function ie(rt,$e){var xt=rt.getDay();return rt=xt>=4||xt===0?m.timeThursday(rt):m.timeThursday.ceil(rt),c(m.timeThursday.count(m.timeYear(rt),rt)+(m.timeYear(rt).getDay()===4),$e,2)}function ae(rt){return rt.getDay()}function he(rt,$e){return c(m.timeMonday.count(m.timeYear(rt)-1,rt),$e,2)}function se(rt,$e){return c(rt.getFullYear()%100,$e,2)}function de(rt,$e){return c(rt.getFullYear()%1e4,$e,4)}function ce(rt){var $e=rt.getTimezoneOffset();return($e>0?"-":($e*=-1,"+"))+c($e/60|0,"0",2)+c($e%60,"0",2)}function ve(rt,$e){return c(rt.getUTCDate(),$e,2)}function ke(rt,$e){return c(rt.getUTCHours(),$e,2)}function Ee(rt,$e){return c(rt.getUTCHours()%12||12,$e,2)}function be(rt,$e){return c(1+m.utcDay.count(m.utcYear(rt),rt),$e,3)}function xe(rt,$e){return c(rt.getUTCMilliseconds(),$e,3)}function ue(rt,$e){return xe(rt,$e)+"000"}function me(rt,$e){return c(rt.getUTCMonth()+1,$e,2)}function we(rt,$e){return c(rt.getUTCMinutes(),$e,2)}function Me(rt,$e){return c(rt.getUTCSeconds(),$e,2)}function Se(rt){var $e=rt.getUTCDay();return $e===0?7:$e}function De(rt,$e){return c(m.utcSunday.count(m.utcYear(rt)-1,rt),$e,2)}function Fe(rt,$e){var xt=rt.getUTCDay();return rt=xt>=4||xt===0?m.utcThursday(rt):m.utcThursday.ceil(rt),c(m.utcThursday.count(m.utcYear(rt),rt)+(m.utcYear(rt).getUTCDay()===4),$e,2)}function Ye(rt){return rt.getUTCDay()}function et(rt,$e){return c(m.utcMonday.count(m.utcYear(rt)-1,rt),$e,2)}function Oe(rt,$e){return c(rt.getUTCFullYear()%100,$e,2)}function je(rt,$e){return c(rt.getUTCFullYear()%1e4,$e,4)}function We(){return"+0000"}function Ge(){return"%"}function Qe(rt){return+rt}function it(rt){return Math.floor(+rt/1e3)}function lt(rt){return u=f(rt),t.timeFormat=u.format,t.timeParse=u.parse,t.utcFormat=u.utcFormat,t.utcParse=u.utcParse,u}lt({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var Lt=Date.prototype.toISOString?function(rt){return rt.toISOString()}:t.utcFormat("%Y-%m-%dT%H:%M:%S.%LZ"),wt=+new Date("2000-01-01T00:00:00.000Z")?function(rt){var $e=new Date(rt);return isNaN($e)?null:$e}:t.utcParse("%Y-%m-%dT%H:%M:%S.%LZ");t.isoFormat=Lt,t.isoParse=wt,t.timeFormatDefaultLocale=lt,t.timeFormatLocale=f,Object.defineProperty(t,"__esModule",{value:!0})})},{"d3-time":173}],173:[function(h,N,H){(function(t,m){m(typeof H=="object"&&N!==void 0?H:(t=t||self).d3=t.d3||{})})(this,function(t){var m=new Date,g=new Date;function p(me,we,Me,Se){function De(Fe){return me(Fe=arguments.length===0?new Date:new Date(+Fe)),Fe}return De.floor=function(Fe){return me(Fe=new Date(+Fe)),Fe},De.ceil=function(Fe){return me(Fe=new Date(Fe-1)),we(Fe,1),me(Fe),Fe},De.round=function(Fe){var Ye=De(Fe),et=De.ceil(Fe);return Fe-Ye<et-Fe?Ye:et},De.offset=function(Fe,Ye){return we(Fe=new Date(+Fe),Ye==null?1:Math.floor(Ye)),Fe},De.range=function(Fe,Ye,et){var Oe,je=[];if(Fe=De.ceil(Fe),et=et==null?1:Math.floor(et),!(Fe<Ye&&et>0))return je;do je.push(Oe=new Date(+Fe)),we(Fe,et),me(Fe);while(Oe<Fe&&Fe<Ye);return je},De.filter=function(Fe){return p(function(Ye){if(Ye>=Ye)for(;me(Ye),!Fe(Ye);)Ye.setTime(Ye-1)},function(Ye,et){if(Ye>=Ye)if(et<0)for(;++et<=0;)for(;we(Ye,-1),!Fe(Ye););else for(;--et>=0;)for(;we(Ye,1),!Fe(Ye););})},Me&&(De.count=function(Fe,Ye){return m.setTime(+Fe),g.setTime(+Ye),me(m),me(g),Math.floor(Me(m,g))},De.every=function(Fe){return Fe=Math.floor(Fe),isFinite(Fe)&&Fe>0?Fe>1?De.filter(Se?function(Ye){return Se(Ye)%Fe==0}:function(Ye){return De.count(0,Ye)%Fe==0}):De:null}),De}var e=p(function(){},function(me,we){me.setTime(+me+we)},function(me,we){return we-me});e.every=function(me){return me=Math.floor(me),isFinite(me)&&me>0?me>1?p(function(we){we.setTime(Math.floor(we/me)*me)},function(we,Me){we.setTime(+we+Me*me)},function(we,Me){return(Me-we)/me}):e:null};var f=e.range,u=p(function(me){me.setTime(me-me.getMilliseconds())},function(me,we){me.setTime(+me+1e3*we)},function(me,we){return(we-me)/1e3},function(me){return me.getUTCSeconds()}),i=u.range,s=p(function(me){me.setTime(me-me.getMilliseconds()-1e3*me.getSeconds())},function(me,we){me.setTime(+me+6e4*we)},function(me,we){return(we-me)/6e4},function(me){return me.getMinutes()}),o=s.range,a=p(function(me){me.setTime(me-me.getMilliseconds()-1e3*me.getSeconds()-6e4*me.getMinutes())},function(me,we){me.setTime(+me+36e5*we)},function(me,we){return(we-me)/36e5},function(me){return me.getHours()}),c=a.range,r=p(function(me){me.setHours(0,0,0,0)},function(me,we){me.setDate(me.getDate()+we)},function(me,we){return(we-me-6e4*(we.getTimezoneOffset()-me.getTimezoneOffset()))/864e5},function(me){return me.getDate()-1}),n=r.range;function d(me){return p(function(we){we.setDate(we.getDate()-(we.getDay()+7-me)%7),we.setHours(0,0,0,0)},function(we,Me){we.setDate(we.getDate()+7*Me)},function(we,Me){return(Me-we-6e4*(Me.getTimezoneOffset()-we.getTimezoneOffset()))/6048e5})}var l=d(0),y=d(1),v=d(2),_=d(3),x=d(4),T=d(5),A=d(6),S=l.range,w=y.range,L=v.range,k=_.range,C=x.range,M=T.range,P=A.range,O=p(function(me){me.setDate(1),me.setHours(0,0,0,0)},function(me,we){me.setMonth(me.getMonth()+we)},function(me,we){return we.getMonth()-me.getMonth()+12*(we.getFullYear()-me.getFullYear())},function(me){return me.getMonth()}),F=O.range,j=p(function(me){me.setMonth(0,1),me.setHours(0,0,0,0)},function(me,we){me.setFullYear(me.getFullYear()+we)},function(me,we){return we.getFullYear()-me.getFullYear()},function(me){return me.getFullYear()});j.every=function(me){return isFinite(me=Math.floor(me))&&me>0?p(function(we){we.setFullYear(Math.floor(we.getFullYear()/me)*me),we.setMonth(0,1),we.setHours(0,0,0,0)},function(we,Me){we.setFullYear(we.getFullYear()+Me*me)}):null};var W=j.range,Z=p(function(me){me.setUTCSeconds(0,0)},function(me,we){me.setTime(+me+6e4*we)},function(me,we){return(we-me)/6e4},function(me){return me.getUTCMinutes()}),Q=Z.range,X=p(function(me){me.setUTCMinutes(0,0,0)},function(me,we){me.setTime(+me+36e5*we)},function(me,we){return(we-me)/36e5},function(me){return me.getUTCHours()}),G=X.range,Y=p(function(me){me.setUTCHours(0,0,0,0)},function(me,we){me.setUTCDate(me.getUTCDate()+we)},function(me,we){return(we-me)/864e5},function(me){return me.getUTCDate()-1}),K=Y.range;function D(me){return p(function(we){we.setUTCDate(we.getUTCDate()-(we.getUTCDay()+7-me)%7),we.setUTCHours(0,0,0,0)},function(we,Me){we.setUTCDate(we.getUTCDate()+7*Me)},function(we,Me){return(Me-we)/6048e5})}var B=D(0),q=D(1),ee=D(2),J=D(3),$=D(4),te=D(5),ie=D(6),ae=B.range,he=q.range,se=ee.range,de=J.range,ce=$.range,ve=te.range,ke=ie.range,Ee=p(function(me){me.setUTCDate(1),me.setUTCHours(0,0,0,0)},function(me,we){me.setUTCMonth(me.getUTCMonth()+we)},function(me,we){return we.getUTCMonth()-me.getUTCMonth()+12*(we.getUTCFullYear()-me.getUTCFullYear())},function(me){return me.getUTCMonth()}),be=Ee.range,xe=p(function(me){me.setUTCMonth(0,1),me.setUTCHours(0,0,0,0)},function(me,we){me.setUTCFullYear(me.getUTCFullYear()+we)},function(me,we){return we.getUTCFullYear()-me.getUTCFullYear()},function(me){return me.getUTCFullYear()});xe.every=function(me){return isFinite(me=Math.floor(me))&&me>0?p(function(we){we.setUTCFullYear(Math.floor(we.getUTCFullYear()/me)*me),we.setUTCMonth(0,1),we.setUTCHours(0,0,0,0)},function(we,Me){we.setUTCFullYear(we.getUTCFullYear()+Me*me)}):null};var ue=xe.range;t.timeDay=r,t.timeDays=n,t.timeFriday=T,t.timeFridays=M,t.timeHour=a,t.timeHours=c,t.timeInterval=p,t.timeMillisecond=e,t.timeMilliseconds=f,t.timeMinute=s,t.timeMinutes=o,t.timeMonday=y,t.timeMondays=w,t.timeMonth=O,t.timeMonths=F,t.timeSaturday=A,t.timeSaturdays=P,t.timeSecond=u,t.timeSeconds=i,t.timeSunday=l,t.timeSundays=S,t.timeThursday=x,t.timeThursdays=C,t.timeTuesday=v,t.timeTuesdays=L,t.timeWednesday=_,t.timeWednesdays=k,t.timeWeek=l,t.timeWeeks=S,t.timeYear=j,t.timeYears=W,t.utcDay=Y,t.utcDays=K,t.utcFriday=te,t.utcFridays=ve,t.utcHour=X,t.utcHours=G,t.utcMillisecond=e,t.utcMilliseconds=f,t.utcMinute=Z,t.utcMinutes=Q,t.utcMonday=q,t.utcMondays=he,t.utcMonth=Ee,t.utcMonths=be,t.utcSaturday=ie,t.utcSaturdays=ke,t.utcSecond=u,t.utcSeconds=i,t.utcSunday=B,t.utcSundays=ae,t.utcThursday=$,t.utcThursdays=ce,t.utcTuesday=ee,t.utcTuesdays=se,t.utcWednesday=J,t.utcWednesdays=de,t.utcWeek=B,t.utcWeeks=ae,t.utcYear=xe,t.utcYears=ue,Object.defineProperty(t,"__esModule",{value:!0})})},{}],174:[function(h,N,H){arguments[4][173][0].apply(H,arguments)},{dup:173}],175:[function(h,N,H){(function(t,m){m(typeof H=="object"&&N!==void 0?H:(t=t||self).d3=t.d3||{})})(this,function(t){var m,g,p=0,e=0,f=0,u=0,i=0,s=0,o=typeof performance=="object"&&performance.now?performance:Date,a=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(x){setTimeout(x,17)};function c(){return i||(a(r),i=o.now()+s)}function r(){i=0}function n(){this._call=this._time=this._next=null}function d(x,T,A){var S=new n;return S.restart(x,T,A),S}function l(){c(),++p;for(var x,T=m;T;)(x=i-T._time)>=0&&T._call.call(null,x),T=T._next;--p}function y(){i=(u=o.now())+s,p=e=0;try{l()}finally{p=0,function(){for(var x,T,A=m,S=1/0;A;)A._call?(S>A._time&&(S=A._time),x=A,A=A._next):(T=A._next,A._next=null,A=x?x._next=T:m=T);g=x,_(S)}(),i=0}}function v(){var x=o.now(),T=x-u;T>1e3&&(s-=T,u=x)}function _(x){p||(e&&(e=clearTimeout(e)),x-i>24?(x<1/0&&(e=setTimeout(y,x-o.now()-s)),f&&(f=clearInterval(f))):(f||(u=o.now(),f=setInterval(v,1e3)),p=1,a(y)))}n.prototype=d.prototype={constructor:n,restart:function(x,T,A){if(typeof x!="function")throw new TypeError("callback is not a function");A=(A==null?c():+A)+(T==null?0:+T),this._next||g===this||(g?g._next=this:m=this,g=this),this._call=x,this._time=A,_()},stop:function(){this._call&&(this._call=null,this._time=1/0,_())}},t.interval=function(x,T,A){var S=new n,w=T;return T==null?(S.restart(x,T,A),S):(T=+T,A=A==null?c():+A,S.restart(function L(k){k+=w,S.restart(L,w+=T,A),x(k)},T,A),S)},t.now=c,t.timeout=function(x,T,A){var S=new n;return T=T==null?0:+T,S.restart(function(w){S.stop(),x(w+T)},T,A),S},t.timer=d,t.timerFlush=l,Object.defineProperty(t,"__esModule",{value:!0})})},{}],176:[function(h,N,H){N.exports=function(){for(var t=0;t<arguments.length;t++)if(arguments[t]!==void 0)return arguments[t]}},{}],177:[function(h,N,H){var t=h("incremental-convex-hull"),m=h("uniq");function g(e,f){this.point=e,this.index=f}function p(e,f){for(var u=e.point,i=f.point,s=u.length,o=0;o<s;++o){var a=i[o]-u[o];if(a)return a}return 0}N.exports=function(e,f){var u=e.length;if(u===0)return[];var i=e[0].length;if(i<1)return[];if(i===1)return function(S,w,L){if(S===1)return L?[[-1,0]]:[];var k=w.map(function(F,j){return[F[0],j]});k.sort(function(F,j){return F[0]-j[0]});for(var C=new Array(S-1),M=1;M<S;++M){var P=k[M-1],O=k[M];C[M-1]=[P[1],O[1]]}return L&&C.push([-1,C[0][1]],[C[S-1][1],-1]),C}(u,e,f);for(var s=new Array(u),o=1,a=0;a<u;++a){for(var c=e[a],r=new Array(i+1),n=0,d=0;d<i;++d){var l=c[d];r[d]=l,n+=l*l}r[i]=n,s[a]=new g(r,a),o=Math.max(n,o)}m(s,p),u=s.length;var y=new Array(u+i+1),v=new Array(u+i+1),_=(i+1)*(i+1)*o,x=new Array(i+1);for(a=0;a<=i;++a)x[a]=0;for(x[i]=_,y[0]=x.slice(),v[0]=-1,a=0;a<=i;++a)(r=x.slice())[a]=1,y[a+1]=r,v[a+1]=-1;for(a=0;a<u;++a){var T=s[a];y[a+i+1]=T.point,v[a+i+1]=T.index}var A=t(y,!1);if(A=f?A.filter(function(S){for(var w=0,L=0;L<=i;++L){var k=v[S[L]];if(k<0&&++w>=2)return!1;S[L]=k}return!0}):A.filter(function(S){for(var w=0;w<=i;++w){var L=v[S[w]];if(L<0)return!1;S[w]=L}return!0}),1&i)for(a=0;a<A.length;++a)r=(T=A[a])[0],T[0]=T[1],T[1]=r;return A}},{"incremental-convex-hull":438,uniq:603}],178:[function(h,N,H){N.exports=g;var t=(g.canvas=document.createElement("canvas")).getContext("2d"),m=p([32,126]);function g(e,f){Array.isArray(e)&&(e=e.join(", "));var u,i={},s=16,o=.05;f&&(f.length===2&&typeof f[0]=="number"?u=p(f):Array.isArray(f)?u=f:(f.o?u=p(f.o):f.pairs&&(u=f.pairs),f.fontSize&&(s=f.fontSize),f.threshold!=null&&(o=f.threshold))),u||(u=m),t.font=s+"px "+e;for(var a=0;a<u.length;a++){var c=u[a],r=t.measureText(c[0]).width+t.measureText(c[1]).width,n=t.measureText(c).width;if(Math.abs(r-n)>s*o){var d=(n-r)/s;i[c]=1e3*d}}return i}function p(e){for(var f=[],u=e[0];u<=e[1];u++)for(var i=String.fromCharCode(u),s=e[0];s<e[1];s++){var o=i+String.fromCharCode(s);f.push(o)}return f}g.createPairs=p,g.ascii=m},{}],179:[function(h,N,H){(function(t){(function(){var m=!1;if(typeof Float64Array!="undefined"){var g=new Float64Array(1),p=new Uint32Array(g.buffer);g[0]=1,m=!0,p[1]===1072693248?(N.exports=function(f){return g[0]=f,[p[0],p[1]]},N.exports.pack=function(f,u){return p[0]=f,p[1]=u,g[0]},N.exports.lo=function(f){return g[0]=f,p[0]},N.exports.hi=function(f){return g[0]=f,p[1]}):p[0]===1072693248?(N.exports=function(f){return g[0]=f,[p[1],p[0]]},N.exports.pack=function(f,u){return p[1]=f,p[0]=u,g[0]},N.exports.lo=function(f){return g[0]=f,p[1]},N.exports.hi=function(f){return g[0]=f,p[0]}):m=!1}if(!m){var e=new t(8);N.exports=function(f){return e.writeDoubleLE(f,0,!0),[e.readUInt32LE(0,!0),e.readUInt32LE(4,!0)]},N.exports.pack=function(f,u){return e.writeUInt32LE(f,0,!0),e.writeUInt32LE(u,4,!0),e.readDoubleLE(0,!0)},N.exports.lo=function(f){return e.writeDoubleLE(f,0,!0),e.readUInt32LE(0,!0)},N.exports.hi=function(f){return e.writeDoubleLE(f,0,!0),e.readUInt32LE(4,!0)}}N.exports.sign=function(f){return N.exports.hi(f)>>>31},N.exports.exponent=function(f){return(N.exports.hi(f)<<1>>>21)-1023},N.exports.fraction=function(f){var u=N.exports.lo(f),i=N.exports.hi(f),s=1048575&i;return 2146435072&i&&(s+=1<<20),[u,s]},N.exports.denormalized=function(f){return!(2146435072&N.exports.hi(f))}}).call(this)}).call(this,h("buffer").Buffer)},{buffer:117}],180:[function(h,N,H){var t=h("abs-svg-path"),m=h("normalize-svg-path"),g={M:"moveTo",C:"bezierCurveTo"};N.exports=function(p,e){p.beginPath(),m(t(e)).forEach(function(f){var u=f[0],i=f.slice(1);p[g[u]].apply(p,i)}),p.closePath()}},{"abs-svg-path":71,"normalize-svg-path":474}],181:[function(h,N,H){N.exports=function(t){switch(t){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},{}],182:[function(h,N,H){N.exports=function(t,m){switch(m===void 0&&(m=0),typeof t){case"number":if(t>0)return function(g,p){var e,f;for(e=new Array(g),f=0;f<g;++f)e[f]=p;return e}(0|t,m);break;case"object":if(typeof t.length=="number")return function g(p,e,f){var u=0|p[f];if(u<=0)return[];var i,s=new Array(u);if(f===p.length-1)for(i=0;i<u;++i)s[i]=e;else for(i=0;i<u;++i)s[i]=g(p,e,f+1);return s}(t,m,0)}return[]}},{}],183:[function(h,N,H){function t(C,M,P){P=P||2;var O,F,j,W,Z,Q,X,G=M&&M.length,Y=G?M[0]*P:C.length,K=m(C,0,Y,P,!0),D=[];if(!K||K.next===K.prev)return D;if(G&&(K=function(q,ee,J,$){var te,ie,ae,he,se,de=[];for(te=0,ie=ee.length;te<ie;te++)ae=ee[te]*$,he=te<ie-1?ee[te+1]*$:q.length,(se=m(q,ae,he,$,!1))===se.next&&(se.steiner=!0),de.push(r(se));for(de.sort(s),te=0;te<de.length;te++)o(de[te],J),J=g(J,J.next);return J}(C,M,K,P)),C.length>80*P){O=j=C[0],F=W=C[1];for(var B=P;B<Y;B+=P)(Z=C[B])<O&&(O=Z),(Q=C[B+1])<F&&(F=Q),Z>j&&(j=Z),Q>W&&(W=Q);X=(X=Math.max(j-O,W-F))!==0?1/X:0}return p(K,D,P,O,F,X),D}function m(C,M,P,O,F){var j,W;if(F===k(C,M,P,O)>0)for(j=M;j<P;j+=O)W=S(j,C[j],C[j+1],W);else for(j=P-O;j>=M;j-=O)W=S(j,C[j],C[j+1],W);return W&&y(W,W.next)&&(w(W),W=W.next),W}function g(C,M){if(!C)return C;M||(M=C);var P,O=C;do if(P=!1,O.steiner||!y(O,O.next)&&l(O.prev,O,O.next)!==0)O=O.next;else{if(w(O),(O=M=O.prev)===O.next)break;P=!0}while(P||O!==M);return M}function p(C,M,P,O,F,j,W){if(C){!W&&j&&function(G,Y,K,D){var B=G;do B.z===null&&(B.z=c(B.x,B.y,Y,K,D)),B.prevZ=B.prev,B.nextZ=B.next,B=B.next;while(B!==G);B.prevZ.nextZ=null,B.prevZ=null,function(q){var ee,J,$,te,ie,ae,he,se,de=1;do{for(J=q,q=null,ie=null,ae=0;J;){for(ae++,$=J,he=0,ee=0;ee<de&&(he++,$=$.nextZ);ee++);for(se=de;he>0||se>0&&$;)he!==0&&(se===0||!$||J.z<=$.z)?(te=J,J=J.nextZ,he--):(te=$,$=$.nextZ,se--),ie?ie.nextZ=te:q=te,te.prevZ=ie,ie=te;J=$}ie.nextZ=null,de*=2}while(ae>1)}(B)}(C,O,F,j);for(var Z,Q,X=C;C.prev!==C.next;)if(Z=C.prev,Q=C.next,j?f(C,O,F,j):e(C))M.push(Z.i/P),M.push(C.i/P),M.push(Q.i/P),w(C),C=Q.next,X=Q.next;else if((C=Q)===X){W?W===1?p(C=u(g(C),M,P),M,P,O,F,j,2):W===2&&i(C,M,P,O,F,j):p(g(C),M,P,O,F,j,1);break}}}function e(C){var M=C.prev,P=C,O=C.next;if(l(M,P,O)>=0)return!1;for(var F=C.next.next;F!==C.prev;){if(n(M.x,M.y,P.x,P.y,O.x,O.y,F.x,F.y)&&l(F.prev,F,F.next)>=0)return!1;F=F.next}return!0}function f(C,M,P,O){var F=C.prev,j=C,W=C.next;if(l(F,j,W)>=0)return!1;for(var Z=F.x<j.x?F.x<W.x?F.x:W.x:j.x<W.x?j.x:W.x,Q=F.y<j.y?F.y<W.y?F.y:W.y:j.y<W.y?j.y:W.y,X=F.x>j.x?F.x>W.x?F.x:W.x:j.x>W.x?j.x:W.x,G=F.y>j.y?F.y>W.y?F.y:W.y:j.y>W.y?j.y:W.y,Y=c(Z,Q,M,P,O),K=c(X,G,M,P,O),D=C.prevZ,B=C.nextZ;D&&D.z>=Y&&B&&B.z<=K;){if(D!==C.prev&&D!==C.next&&n(F.x,F.y,j.x,j.y,W.x,W.y,D.x,D.y)&&l(D.prev,D,D.next)>=0||(D=D.prevZ,B!==C.prev&&B!==C.next&&n(F.x,F.y,j.x,j.y,W.x,W.y,B.x,B.y)&&l(B.prev,B,B.next)>=0))return!1;B=B.nextZ}for(;D&&D.z>=Y;){if(D!==C.prev&&D!==C.next&&n(F.x,F.y,j.x,j.y,W.x,W.y,D.x,D.y)&&l(D.prev,D,D.next)>=0)return!1;D=D.prevZ}for(;B&&B.z<=K;){if(B!==C.prev&&B!==C.next&&n(F.x,F.y,j.x,j.y,W.x,W.y,B.x,B.y)&&l(B.prev,B,B.next)>=0)return!1;B=B.nextZ}return!0}function u(C,M,P){var O=C;do{var F=O.prev,j=O.next.next;!y(F,j)&&v(F,O,O.next,j)&&T(F,j)&&T(j,F)&&(M.push(F.i/P),M.push(O.i/P),M.push(j.i/P),w(O),w(O.next),O=C=j),O=O.next}while(O!==C);return g(O)}function i(C,M,P,O,F,j){var W=C;do{for(var Z=W.next.next;Z!==W.prev;){if(W.i!==Z.i&&d(W,Z)){var Q=A(W,Z);return W=g(W,W.next),Q=g(Q,Q.next),p(W,M,P,O,F,j),void p(Q,M,P,O,F,j)}Z=Z.next}W=W.next}while(W!==C)}function s(C,M){return C.x-M.x}function o(C,M){if(M=function(O,F){var j,W=F,Z=O.x,Q=O.y,X=-1/0;do{if(Q<=W.y&&Q>=W.next.y&&W.next.y!==W.y){var G=W.x+(Q-W.y)*(W.next.x-W.x)/(W.next.y-W.y);if(G<=Z&&G>X){if(X=G,G===Z){if(Q===W.y)return W;if(Q===W.next.y)return W.next}j=W.x<W.next.x?W:W.next}}W=W.next}while(W!==F);if(!j)return null;if(Z===X)return j;var Y,K=j,D=j.x,B=j.y,q=1/0;W=j;do Z>=W.x&&W.x>=D&&Z!==W.x&&n(Q<B?Z:X,Q,D,B,Q<B?X:Z,Q,W.x,W.y)&&(Y=Math.abs(Q-W.y)/(Z-W.x),T(W,O)&&(Y<q||Y===q&&(W.x>j.x||W.x===j.x&&a(j,W)))&&(j=W,q=Y)),W=W.next;while(W!==K);return j}(C,M)){var P=A(M,C);g(M,M.next),g(P,P.next)}}function a(C,M){return l(C.prev,C,M.prev)<0&&l(M.next,C,C.next)<0}function c(C,M,P,O,F){return(C=1431655765&((C=858993459&((C=252645135&((C=16711935&((C=32767*(C-P)*F)|C<<8))|C<<4))|C<<2))|C<<1))|(M=1431655765&((M=858993459&((M=252645135&((M=16711935&((M=32767*(M-O)*F)|M<<8))|M<<4))|M<<2))|M<<1))<<1}function r(C){var M=C,P=C;do(M.x<P.x||M.x===P.x&&M.y<P.y)&&(P=M),M=M.next;while(M!==C);return P}function n(C,M,P,O,F,j,W,Z){return(F-W)*(M-Z)-(C-W)*(j-Z)>=0&&(C-W)*(O-Z)-(P-W)*(M-Z)>=0&&(P-W)*(j-Z)-(F-W)*(O-Z)>=0}function d(C,M){return C.next.i!==M.i&&C.prev.i!==M.i&&!function(P,O){var F=P;do{if(F.i!==P.i&&F.next.i!==P.i&&F.i!==O.i&&F.next.i!==O.i&&v(F,F.next,P,O))return!0;F=F.next}while(F!==P);return!1}(C,M)&&(T(C,M)&&T(M,C)&&function(P,O){var F=P,j=!1,W=(P.x+O.x)/2,Z=(P.y+O.y)/2;do F.y>Z!=F.next.y>Z&&F.next.y!==F.y&&W<(F.next.x-F.x)*(Z-F.y)/(F.next.y-F.y)+F.x&&(j=!j),F=F.next;while(F!==P);return j}(C,M)&&(l(C.prev,C,M.prev)||l(C,M.prev,M))||y(C,M)&&l(C.prev,C,C.next)>0&&l(M.prev,M,M.next)>0)}function l(C,M,P){return(M.y-C.y)*(P.x-M.x)-(M.x-C.x)*(P.y-M.y)}function y(C,M){return C.x===M.x&&C.y===M.y}function v(C,M,P,O){var F=x(l(C,M,P)),j=x(l(C,M,O)),W=x(l(P,O,C)),Z=x(l(P,O,M));return F!==j&&W!==Z||!(F!==0||!_(C,P,M))||!(j!==0||!_(C,O,M))||!(W!==0||!_(P,C,O))||!(Z!==0||!_(P,M,O))}function _(C,M,P){return M.x<=Math.max(C.x,P.x)&&M.x>=Math.min(C.x,P.x)&&M.y<=Math.max(C.y,P.y)&&M.y>=Math.min(C.y,P.y)}function x(C){return C>0?1:C<0?-1:0}function T(C,M){return l(C.prev,C,C.next)<0?l(C,M,C.next)>=0&&l(C,C.prev,M)>=0:l(C,M,C.prev)<0||l(C,C.next,M)<0}function A(C,M){var P=new L(C.i,C.x,C.y),O=new L(M.i,M.x,M.y),F=C.next,j=M.prev;return C.next=M,M.prev=C,P.next=F,F.prev=P,O.next=P,P.prev=O,j.next=O,O.prev=j,O}function S(C,M,P,O){var F=new L(C,M,P);return O?(F.next=O.next,F.prev=O,O.next.prev=F,O.next=F):(F.prev=F,F.next=F),F}function w(C){C.next.prev=C.prev,C.prev.next=C.next,C.prevZ&&(C.prevZ.nextZ=C.nextZ),C.nextZ&&(C.nextZ.prevZ=C.prevZ)}function L(C,M,P){this.i=C,this.x=M,this.y=P,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function k(C,M,P,O){for(var F=0,j=M,W=P-O;j<P;j+=O)F+=(C[W]-C[j])*(C[j+1]+C[W+1]),W=j;return F}N.exports=t,N.exports.default=t,t.deviation=function(C,M,P,O){var F=M&&M.length,j=F?M[0]*P:C.length,W=Math.abs(k(C,0,j,P));if(F)for(var Z=0,Q=M.length;Z<Q;Z++){var X=M[Z]*P,G=Z<Q-1?M[Z+1]*P:C.length;W-=Math.abs(k(C,X,G,P))}var Y=0;for(Z=0;Z<O.length;Z+=3){var K=O[Z]*P,D=O[Z+1]*P,B=O[Z+2]*P;Y+=Math.abs((C[K]-C[B])*(C[D+1]-C[K+1])-(C[K]-C[D])*(C[B+1]-C[K+1]))}return W===0&&Y===0?0:Math.abs((Y-W)/W)},t.flatten=function(C){for(var M=C[0][0].length,P={vertices:[],holes:[],dimensions:M},O=0,F=0;F<C.length;F++){for(var j=0;j<C[F].length;j++)for(var W=0;W<M;W++)P.vertices.push(C[F][j][W]);F>0&&(O+=C[F-1].length,P.holes.push(O))}return P}},{}],184:[function(h,N,H){N.exports=function(m,g){var p=m.length;if(typeof g!="number"){g=0;for(var e=0;e<p;++e){var f=m[e];g=Math.max(g,f[0],f[1])}g=1+(0|g)}g|=0;var u=new Array(g);for(e=0;e<g;++e)u[e]=[];for(e=0;e<p;++e)f=m[e],u[f[0]].push(f[1]),u[f[1]].push(f[0]);for(var i=0;i<g;++i)t(u[i],function(s,o){return s-o});return u};var t=h("uniq")},{uniq:603}],185:[function(h,N,H){var t=h("strongly-connected-components");N.exports=function(m,g){var p,e=[],f=[],u=[],i={},s=[];function o(v){var _,x,T=!1;for(f.push(v),u[v]=!0,_=0;_<s[v].length;_++)(x=s[v][_])===p?(a(p,f),T=!0):u[x]||(T=o(x));if(T)(function S(w){u[w]=!1,i.hasOwnProperty(w)&&Object.keys(i[w]).forEach(function(L){delete i[w][L],u[L]&&S(L)})})(v);else for(_=0;_<s[v].length;_++){x=s[v][_];var A=i[x];A||(A={},i[x]=A),A[x]=!0}return f.pop(),T}function a(v,_){var x=[].concat(_).concat(v);g?g(o):e.push(x)}function c(v){(function(L){for(var k=0;k<m.length;k++)k<L&&(m[k]=[]),m[k]=m[k].filter(function(C){return C>=L})})(v);for(var _,x=t(m).components.filter(function(L){return L.length>1}),T=1/0,A=0;A<x.length;A++)for(var S=0;S<x[A].length;S++)x[A][S]<T&&(T=x[A][S],_=A);var w=x[_];return!!w&&{leastVertex:T,adjList:m.map(function(L,k){return w.indexOf(k)===-1?[]:L.filter(function(C){return w.indexOf(C)!==-1})})}}p=0;for(var r=m.length;p<r;){var n=c(p);if(p=n.leastVertex,s=n.adjList){for(var d=0;d<s.length;d++)for(var l=0;l<s[d].length;l++){var y=s[d][l];u[+y]=!1,i[y]={}}o(p),p+=1}else p=r}return g?void 0:e}},{"strongly-connected-components":575}],186:[function(h,N,H){var t=h("../../object/valid-value");N.exports=function(){return t(this).length=0,this}},{"../../object/valid-value":217}],187:[function(h,N,H){N.exports=h("./is-implemented")()?Array.from:h("./shim")},{"./is-implemented":188,"./shim":189}],188:[function(h,N,H){N.exports=function(){var t,m,g=Array.from;return typeof g=="function"&&(m=g(t=["raz","dwa"]),Boolean(m&&m!==t&&m[1]==="dwa"))}},{}],189:[function(h,N,H){var t=h("es6-symbol").iterator,m=h("../../function/is-arguments"),g=h("../../function/is-function"),p=h("../../number/to-pos-integer"),e=h("../../object/valid-callable"),f=h("../../object/valid-value"),u=h("../../object/is-value"),i=h("../../string/is-string"),s=Array.isArray,o=Function.prototype.call,a={configurable:!0,enumerable:!0,writable:!0,value:null},c=Object.defineProperty;N.exports=function(r){var n,d,l,y,v,_,x,T,A,S,w=arguments[1],L=arguments[2];if(r=Object(f(r)),u(w)&&e(w),this&&this!==Array&&g(this))n=this;else{if(!w){if(m(r))return(v=r.length)!==1?Array.apply(null,r):((y=new Array(1))[0]=r[0],y);if(s(r)){for(y=new Array(v=r.length),d=0;d<v;++d)y[d]=r[d];return y}}y=[]}if(!s(r)){if((A=r[t])!==void 0){for(x=e(A).call(r),n&&(y=new n),T=x.next(),d=0;!T.done;)S=w?o.call(w,L,T.value,d):T.value,n?(a.value=S,c(y,d,a)):y[d]=S,T=x.next(),++d;v=d}else if(i(r)){for(v=r.length,n&&(y=new n),d=0,l=0;d<v;++d)S=r[d],d+1<v&&(_=S.charCodeAt(0))>=55296&&_<=56319&&(S+=r[++d]),S=w?o.call(w,L,S,l):S,n?(a.value=S,c(y,l,a)):y[l]=S,++l;v=l}}if(v===void 0)for(v=p(r.length),n&&(y=new n(v)),d=0;d<v;++d)S=w?o.call(w,L,r[d],d):r[d],n?(a.value=S,c(y,d,a)):y[d]=S;return n&&(a.value=null,y.length=v),y}},{"../../function/is-arguments":190,"../../function/is-function":191,"../../number/to-pos-integer":197,"../../object/is-value":206,"../../object/valid-callable":215,"../../object/valid-value":217,"../../string/is-string":221,"es6-symbol":230}],190:[function(h,N,H){var t=Object.prototype.toString,m=t.call(function(){return arguments}());N.exports=function(g){return t.call(g)===m}},{}],191:[function(h,N,H){var t=Object.prototype.toString,m=RegExp.prototype.test.bind(/^[object [A-Za-z0-9]*Function]$/);N.exports=function(g){return typeof g=="function"&&m(t.call(g))}},{}],192:[function(h,N,H){N.exports=function(){}},{}],193:[function(h,N,H){N.exports=h("./is-implemented")()?Math.sign:h("./shim")},{"./is-implemented":194,"./shim":195}],194:[function(h,N,H){N.exports=function(){var t=Math.sign;return typeof t=="function"&&t(10)===1&&t(-20)===-1}},{}],195:[function(h,N,H){N.exports=function(t){return t=Number(t),isNaN(t)||t===0?t:t>0?1:-1}},{}],196:[function(h,N,H){var t=h("../math/sign"),m=Math.abs,g=Math.floor;N.exports=function(p){return isNaN(p)?0:(p=Number(p))!==0&&isFinite(p)?t(p)*g(m(p)):p}},{"../math/sign":193}],197:[function(h,N,H){var t=h("./to-integer"),m=Math.max;N.exports=function(g){return m(0,t(g))}},{"./to-integer":196}],198:[function(h,N,H){var t=h("./valid-callable"),m=h("./valid-value"),g=Function.prototype.bind,p=Function.prototype.call,e=Object.keys,f=Object.prototype.propertyIsEnumerable;N.exports=function(u,i){return function(s,o){var a,c=arguments[2],r=arguments[3];return s=Object(m(s)),t(o),a=e(s),r&&a.sort(typeof r=="function"?g.call(r,s):void 0),typeof u!="function"&&(u=a[u]),p.call(u,a,function(n,d){return f.call(s,n)?p.call(o,c,s[n],n,s,d):i})}}},{"./valid-callable":215,"./valid-value":217}],199:[function(h,N,H){N.exports=h("./is-implemented")()?Object.assign:h("./shim")},{"./is-implemented":200,"./shim":201}],200:[function(h,N,H){N.exports=function(){var t,m=Object.assign;return typeof m=="function"&&(m(t={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),t.foo+t.bar+t.trzy==="razdwatrzy")}},{}],201:[function(h,N,H){var t=h("../keys"),m=h("../valid-value"),g=Math.max;N.exports=function(p,e){var f,u,i,s=g(arguments.length,2);for(p=Object(m(p)),i=function(o){try{p[o]=e[o]}catch(a){f||(f=a)}},u=1;u<s;++u)t(e=arguments[u]).forEach(i);if(f!==void 0)throw f;return p}},{"../keys":207,"../valid-value":217}],202:[function(h,N,H){var t=h("../array/from"),m=h("./assign"),g=h("./valid-value");N.exports=function(p){var e=Object(g(p)),f=arguments[1],u=Object(arguments[2]);if(e!==p&&!f)return e;var i={};return f?t(f,function(s){(u.ensure||s in p)&&(i[s]=p[s])}):m(i,p),i}},{"../array/from":187,"./assign":199,"./valid-value":217}],203:[function(h,N,H){var t,m,g,p,e=Object.create;h("./set-prototype-of/is-implemented")()||(t=h("./set-prototype-of/shim")),N.exports=t?t.level!==1?e:(m={},g={},p={configurable:!1,enumerable:!1,writable:!0,value:void 0},Object.getOwnPropertyNames(Object.prototype).forEach(function(f){g[f]=f!=="__proto__"?p:{configurable:!0,enumerable:!1,writable:!0,value:void 0}}),Object.defineProperties(m,g),Object.defineProperty(t,"nullPolyfill",{configurable:!1,enumerable:!1,writable:!1,value:m}),function(f,u){return e(f===null?m:f,u)}):e},{"./set-prototype-of/is-implemented":213,"./set-prototype-of/shim":214}],204:[function(h,N,H){N.exports=h("./_iterate")("forEach")},{"./_iterate":198}],205:[function(h,N,H){var t=h("./is-value"),m={function:!0,object:!0};N.exports=function(g){return t(g)&&m[typeof g]||!1}},{"./is-value":206}],206:[function(h,N,H){var t=h("../function/noop")();N.exports=function(m){return m!==t&&m!==null}},{"../function/noop":192}],207:[function(h,N,H){N.exports=h("./is-implemented")()?Object.keys:h("./shim")},{"./is-implemented":208,"./shim":209}],208:[function(h,N,H){N.exports=function(){try{return Object.keys("primitive"),!0}catch(t){return!1}}},{}],209:[function(h,N,H){var t=h("../is-value"),m=Object.keys;N.exports=function(g){return m(t(g)?Object(g):g)}},{"../is-value":206}],210:[function(h,N,H){var t=h("./valid-callable"),m=h("./for-each"),g=Function.prototype.call;N.exports=function(p,e){var f={},u=arguments[2];return t(e),m(p,function(i,s,o,a){f[s]=g.call(e,u,i,s,o,a)}),f}},{"./for-each":204,"./valid-callable":215}],211:[function(h,N,H){var t=h("./is-value"),m=Array.prototype.forEach,g=Object.create,p=function(e,f){var u;for(u in e)f[u]=e[u]};N.exports=function(e){var f=g(null);return m.call(arguments,function(u){t(u)&&p(Object(u),f)}),f}},{"./is-value":206}],212:[function(h,N,H){N.exports=h("./is-implemented")()?Object.setPrototypeOf:h("./shim")},{"./is-implemented":213,"./shim":214}],213:[function(h,N,H){var t=Object.create,m=Object.getPrototypeOf,g={};N.exports=function(){var p=Object.setPrototypeOf,e=arguments[0]||t;return typeof p=="function"&&m(p(e(null),g))===g}},{}],214:[function(h,N,H){var t,m=h("../is-object"),g=h("../valid-value"),p=Object.prototype.isPrototypeOf,e=Object.defineProperty,f={configurable:!0,enumerable:!1,writable:!0,value:void 0};t=function(u,i){if(g(u),i===null||m(i))return u;throw new TypeError("Prototype must be null or an object")},N.exports=function(u){var i,s;return u?(u.level===2?u.set?(s=u.set,i=function(o,a){return s.call(t(o,a),a),o}):i=function(o,a){return t(o,a).__proto__=a,o}:i=function o(a,c){var r;return t(a,c),(r=p.call(o.nullPolyfill,a))&&delete o.nullPolyfill.__proto__,c===null&&(c=o.nullPolyfill),a.__proto__=c,r&&e(o.nullPolyfill,"__proto__",f),a},Object.defineProperty(i,"level",{configurable:!1,enumerable:!1,writable:!1,value:u.level})):null}(function(){var u,i=Object.create(null),s={},o=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__");if(o){try{(u=o.set).call(i,s)}catch(a){}if(Object.getPrototypeOf(i)===s)return{set:u,level:2}}return i.__proto__=s,Object.getPrototypeOf(i)===s?{level:2}:((i={}).__proto__=s,Object.getPrototypeOf(i)===s&&{level:1})}()),h("../create")},{"../create":203,"../is-object":205,"../valid-value":217}],215:[function(h,N,H){N.exports=function(t){if(typeof t!="function")throw new TypeError(t+" is not a function");return t}},{}],216:[function(h,N,H){var t=h("./is-object");N.exports=function(m){if(!t(m))throw new TypeError(m+" is not an Object");return m}},{"./is-object":205}],217:[function(h,N,H){var t=h("./is-value");N.exports=function(m){if(!t(m))throw new TypeError("Cannot use null or undefined");return m}},{"./is-value":206}],218:[function(h,N,H){N.exports=h("./is-implemented")()?String.prototype.contains:h("./shim")},{"./is-implemented":219,"./shim":220}],219:[function(h,N,H){var t="razdwatrzy";N.exports=function(){return typeof t.contains=="function"&&t.contains("dwa")===!0&&t.contains("foo")===!1}},{}],220:[function(h,N,H){var t=String.prototype.indexOf;N.exports=function(m){return t.call(this,m,arguments[1])>-1}},{}],221:[function(h,N,H){var t=Object.prototype.toString,m=t.call("");N.exports=function(g){return typeof g=="string"||g&&typeof g=="object"&&(g instanceof String||t.call(g)===m)||!1}},{}],222:[function(h,N,H){var t=Object.create(null),m=Math.random;N.exports=function(){var g;do g=m().toString(36).slice(2);while(t[g]);return g}},{}],223:[function(h,N,H){var t,m=h("es5-ext/object/set-prototype-of"),g=h("es5-ext/string/#/contains"),p=h("d"),e=h("es6-symbol"),f=h("./"),u=Object.defineProperty;t=N.exports=function(i,s){if(!(this instanceof t))throw new TypeError("Constructor requires 'new'");f.call(this,i),s=s?g.call(s,"key+value")?"key+value":g.call(s,"key")?"key":"value":"value",u(this,"__kind__",p("",s))},m&&m(t,f),delete t.prototype.constructor,t.prototype=Object.create(f.prototype,{_resolve:p(function(i){return this.__kind__==="value"?this.__list__[i]:this.__kind__==="key+value"?[i,this.__list__[i]]:i})}),u(t.prototype,e.toStringTag,p("c","Array Iterator"))},{"./":226,d:158,"es5-ext/object/set-prototype-of":212,"es5-ext/string/#/contains":218,"es6-symbol":230}],224:[function(h,N,H){var t=h("es5-ext/function/is-arguments"),m=h("es5-ext/object/valid-callable"),g=h("es5-ext/string/is-string"),p=h("./get"),e=Array.isArray,f=Function.prototype.call,u=Array.prototype.some;N.exports=function(i,s){var o,a,c,r,n,d,l,y,v=arguments[2];if(e(i)||t(i)?o="array":g(i)?o="string":i=p(i),m(s),c=function(){r=!0},o!=="array")if(o!=="string")for(a=i.next();!a.done;){if(f.call(s,v,a.value,c),r)return;a=i.next()}else for(d=i.length,n=0;n<d&&(l=i[n],n+1<d&&(y=l.charCodeAt(0))>=55296&&y<=56319&&(l+=i[++n]),f.call(s,v,l,c),!r);++n);else u.call(i,function(_){return f.call(s,v,_,c),r})}},{"./get":225,"es5-ext/function/is-arguments":190,"es5-ext/object/valid-callable":215,"es5-ext/string/is-string":221}],225:[function(h,N,H){var t=h("es5-ext/function/is-arguments"),m=h("es5-ext/string/is-string"),g=h("./array"),p=h("./string"),e=h("./valid-iterable"),f=h("es6-symbol").iterator;N.exports=function(u){return typeof e(u)[f]=="function"?u[f]():t(u)?new g(u):m(u)?new p(u):new g(u)}},{"./array":223,"./string":228,"./valid-iterable":229,"es5-ext/function/is-arguments":190,"es5-ext/string/is-string":221,"es6-symbol":230}],226:[function(h,N,H){var t,m=h("es5-ext/array/#/clear"),g=h("es5-ext/object/assign"),p=h("es5-ext/object/valid-callable"),e=h("es5-ext/object/valid-value"),f=h("d"),u=h("d/auto-bind"),i=h("es6-symbol"),s=Object.defineProperty,o=Object.defineProperties;N.exports=t=function(a,c){if(!(this instanceof t))throw new TypeError("Constructor requires 'new'");o(this,{__list__:f("w",e(a)),__context__:f("w",c),__nextIndex__:f("w",0)}),c&&(p(c.on),c.on("_add",this._onAdd),c.on("_delete",this._onDelete),c.on("_clear",this._onClear))},delete t.prototype.constructor,o(t.prototype,g({_next:f(function(){var a;if(this.__list__)return this.__redo__&&(a=this.__redo__.shift())!==void 0?a:this.__nextIndex__<this.__list__.length?this.__nextIndex__++:void this._unBind()}),next:f(function(){return this._createResult(this._next())}),_createResult:f(function(a){return a===void 0?{done:!0,value:void 0}:{done:!1,value:this._resolve(a)}}),_resolve:f(function(a){return this.__list__[a]}),_unBind:f(function(){this.__list__=null,delete this.__redo__,this.__context__&&(this.__context__.off("_add",this._onAdd),this.__context__.off("_delete",this._onDelete),this.__context__.off("_clear",this._onClear),this.__context__=null)}),toString:f(function(){return"[object "+(this[i.toStringTag]||"Object")+"]"})},u({_onAdd:f(function(a){a>=this.__nextIndex__||(++this.__nextIndex__,this.__redo__?(this.__redo__.forEach(function(c,r){c>=a&&(this.__redo__[r]=++c)},this),this.__redo__.push(a)):s(this,"__redo__",f("c",[a])))}),_onDelete:f(function(a){var c;a>=this.__nextIndex__||(--this.__nextIndex__,this.__redo__&&((c=this.__redo__.indexOf(a))!==-1&&this.__redo__.splice(c,1),this.__redo__.forEach(function(r,n){r>a&&(this.__redo__[n]=--r)},this)))}),_onClear:f(function(){this.__redo__&&m.call(this.__redo__),this.__nextIndex__=0})}))),s(t.prototype,i.iterator,f(function(){return this}))},{d:158,"d/auto-bind":157,"es5-ext/array/#/clear":186,"es5-ext/object/assign":199,"es5-ext/object/valid-callable":215,"es5-ext/object/valid-value":217,"es6-symbol":230}],227:[function(h,N,H){var t=h("es5-ext/function/is-arguments"),m=h("es5-ext/object/is-value"),g=h("es5-ext/string/is-string"),p=h("es6-symbol").iterator,e=Array.isArray;N.exports=function(f){return!!m(f)&&(!!e(f)||!!g(f)||!!t(f)||typeof f[p]=="function")}},{"es5-ext/function/is-arguments":190,"es5-ext/object/is-value":206,"es5-ext/string/is-string":221,"es6-symbol":230}],228:[function(h,N,H){var t,m=h("es5-ext/object/set-prototype-of"),g=h("d"),p=h("es6-symbol"),e=h("./"),f=Object.defineProperty;t=N.exports=function(u){if(!(this instanceof t))throw new TypeError("Constructor requires 'new'");u=String(u),e.call(this,u),f(this,"__length__",g("",u.length))},m&&m(t,e),delete t.prototype.constructor,t.prototype=Object.create(e.prototype,{_next:g(function(){if(this.__list__)return this.__nextIndex__<this.__length__?this.__nextIndex__++:void this._unBind()}),_resolve:g(function(u){var i,s=this.__list__[u];return this.__nextIndex__===this.__length__?s:(i=s.charCodeAt(0))>=55296&&i<=56319?s+this.__list__[this.__nextIndex__++]:s})}),f(t.prototype,p.toStringTag,g("c","String Iterator"))},{"./":226,d:158,"es5-ext/object/set-prototype-of":212,"es6-symbol":230}],229:[function(h,N,H){var t=h("./is-iterable");N.exports=function(m){if(!t(m))throw new TypeError(m+" is not iterable");return m}},{"./is-iterable":227}],230:[function(h,N,H){N.exports=h("./is-implemented")()?h("ext/global-this").Symbol:h("./polyfill")},{"./is-implemented":231,"./polyfill":236,"ext/global-this":243}],231:[function(h,N,H){var t=h("ext/global-this"),m={object:!0,symbol:!0};N.exports=function(){var g,p=t.Symbol;if(typeof p!="function")return!1;g=p("test symbol");try{String(g)}catch(e){return!1}return!!m[typeof p.iterator]&&!!m[typeof p.toPrimitive]&&!!m[typeof p.toStringTag]}},{"ext/global-this":243}],232:[function(h,N,H){N.exports=function(t){return!!t&&(typeof t=="symbol"||!!t.constructor&&t.constructor.name==="Symbol"&&t[t.constructor.toStringTag]==="Symbol")}},{}],233:[function(h,N,H){var t=h("d"),m=Object.create,g=Object.defineProperty,p=Object.prototype,e=m(null);N.exports=function(f){for(var u,i,s=0;e[f+(s||"")];)++s;return e[f+=s||""]=!0,g(p,u="@@"+f,t.gs(null,function(o){i||(i=!0,g(this,u,t(o)),i=!1)})),u}},{d:158}],234:[function(h,N,H){var t=h("d"),m=h("ext/global-this").Symbol;N.exports=function(g){return Object.defineProperties(g,{hasInstance:t("",m&&m.hasInstance||g("hasInstance")),isConcatSpreadable:t("",m&&m.isConcatSpreadable||g("isConcatSpreadable")),iterator:t("",m&&m.iterator||g("iterator")),match:t("",m&&m.match||g("match")),replace:t("",m&&m.replace||g("replace")),search:t("",m&&m.search||g("search")),species:t("",m&&m.species||g("species")),split:t("",m&&m.split||g("split")),toPrimitive:t("",m&&m.toPrimitive||g("toPrimitive")),toStringTag:t("",m&&m.toStringTag||g("toStringTag")),unscopables:t("",m&&m.unscopables||g("unscopables"))})}},{d:158,"ext/global-this":243}],235:[function(h,N,H){var t=h("d"),m=h("../../../validate-symbol"),g=Object.create(null);N.exports=function(p){return Object.defineProperties(p,{for:t(function(e){return g[e]?g[e]:g[e]=p(String(e))}),keyFor:t(function(e){var f;for(f in m(e),g)if(g[f]===e)return f})})}},{"../../../validate-symbol":237,d:158}],236:[function(h,N,H){var t,m,g,p=h("d"),e=h("./validate-symbol"),f=h("ext/global-this").Symbol,u=h("./lib/private/generate-name"),i=h("./lib/private/setup/standard-symbols"),s=h("./lib/private/setup/symbol-registry"),o=Object.create,a=Object.defineProperties,c=Object.defineProperty;if(typeof f=="function")try{String(f()),g=!0}catch(r){}else f=null;m=function(r){if(this instanceof m)throw new TypeError("Symbol is not a constructor");return t(r)},N.exports=t=function r(n){var d;if(this instanceof r)throw new TypeError("Symbol is not a constructor");return g?f(n):(d=o(m.prototype),n=n===void 0?"":String(n),a(d,{__description__:p("",n),__name__:p("",u(n))}))},i(t),s(t),a(m.prototype,{constructor:p(t),toString:p("",function(){return this.__name__})}),a(t.prototype,{toString:p(function(){return"Symbol ("+e(this).__description__+")"}),valueOf:p(function(){return e(this)})}),c(t.prototype,t.toPrimitive,p("",function(){var r=e(this);return typeof r=="symbol"?r:r.toString()})),c(t.prototype,t.toStringTag,p("c","Symbol")),c(m.prototype,t.toStringTag,p("c",t.prototype[t.toStringTag])),c(m.prototype,t.toPrimitive,p("c",t.prototype[t.toPrimitive]))},{"./lib/private/generate-name":233,"./lib/private/setup/standard-symbols":234,"./lib/private/setup/symbol-registry":235,"./validate-symbol":237,d:158,"ext/global-this":243}],237:[function(h,N,H){var t=h("./is-symbol");N.exports=function(m){if(!t(m))throw new TypeError(m+" is not a symbol");return m}},{"./is-symbol":232}],238:[function(h,N,H){N.exports=h("./is-implemented")()?WeakMap:h("./polyfill")},{"./is-implemented":239,"./polyfill":241}],239:[function(h,N,H){N.exports=function(){var t,m;if(typeof WeakMap!="function")return!1;try{t=new WeakMap([[m={},"one"],[{},"two"],[{},"three"]])}catch(g){return!1}return String(t)==="[object WeakMap]"&&typeof t.set=="function"&&t.set({},1)===t&&typeof t.delete=="function"&&typeof t.has=="function"&&t.get(m)==="one"}},{}],240:[function(h,N,H){N.exports=typeof WeakMap=="function"&&Object.prototype.toString.call(new WeakMap)==="[object WeakMap]"},{}],241:[function(h,N,H){var t,m=h("es5-ext/object/is-value"),g=h("es5-ext/object/set-prototype-of"),p=h("es5-ext/object/valid-object"),e=h("es5-ext/object/valid-value"),f=h("es5-ext/string/random-uniq"),u=h("d"),i=h("es6-iterator/get"),s=h("es6-iterator/for-of"),o=h("es6-symbol").toStringTag,a=h("./is-native-implemented"),c=Array.isArray,r=Object.defineProperty,n=Object.prototype.hasOwnProperty,d=Object.getPrototypeOf;N.exports=t=function(){var l,y=arguments[0];if(!(this instanceof t))throw new TypeError("Constructor requires 'new'");return l=a&&g&&WeakMap!==t?g(new WeakMap,d(this)):this,m(y)&&(c(y)||(y=i(y))),r(l,"__weakMapData__",u("c","$weakMap$"+f())),y&&s(y,function(v){e(v),l.set(v[0],v[1])}),l},a&&(g&&g(t,WeakMap),t.prototype=Object.create(WeakMap.prototype,{constructor:u(t)})),Object.defineProperties(t.prototype,{delete:u(function(l){return!!n.call(p(l),this.__weakMapData__)&&(delete l[this.__weakMapData__],!0)}),get:u(function(l){if(n.call(p(l),this.__weakMapData__))return l[this.__weakMapData__]}),has:u(function(l){return n.call(p(l),this.__weakMapData__)}),set:u(function(l,y){return r(p(l),this.__weakMapData__,u("c",y)),this}),toString:u(function(){return"[object WeakMap]"})}),r(t.prototype,o,u("c","WeakMap"))},{"./is-native-implemented":240,d:158,"es5-ext/object/is-value":206,"es5-ext/object/set-prototype-of":212,"es5-ext/object/valid-object":216,"es5-ext/object/valid-value":217,"es5-ext/string/random-uniq":222,"es6-iterator/for-of":224,"es6-iterator/get":225,"es6-symbol":230}],242:[function(h,N,H){var t=function(){if(typeof self=="object"&&self)return self;if(typeof window=="object"&&window)return window;throw new Error("Unable to resolve global `this`")};N.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(m){return t()}try{return __global__||t()}finally{delete Object.prototype.__global__}}()},{}],243:[function(h,N,H){N.exports=h("./is-implemented")()?globalThis:h("./implementation")},{"./implementation":242,"./is-implemented":244}],244:[function(h,N,H){N.exports=function(){return typeof globalThis=="object"&&!!globalThis&&globalThis.Array===Array}},{}],245:[function(h,N,H){N.exports=function(t,m,g){var p=m||0,e=g||1;return[[t[12]+t[0],t[13]+t[1],t[14]+t[2],t[15]+t[3]],[t[12]-t[0],t[13]-t[1],t[14]-t[2],t[15]-t[3]],[t[12]+t[4],t[13]+t[5],t[14]+t[6],t[15]+t[7]],[t[12]-t[4],t[13]-t[5],t[14]-t[6],t[15]-t[7]],[p*t[12]+t[8],p*t[13]+t[9],p*t[14]+t[10],p*t[15]+t[11]],[e*t[12]-t[8],e*t[13]-t[9],e*t[14]-t[10],e*t[15]-t[11]]]}},{}],246:[function(h,N,H){var t=h("is-string-blank");N.exports=function(m){var g=typeof m;if(g==="string"){var p=m;if((m=+m)==0&&t(p))return!1}else if(g!=="number")return!1;return m-m<1}},{"is-string-blank":448}],247:[function(h,N,H){N.exports=function(u,i,s){switch(arguments.length){case 0:return new p([0],[0],0);case 1:return typeof u=="number"?new p(o=f(u),o,0):new p(u,f(u.length),0);case 2:if(typeof i=="number"){var o=f(u.length);return new p(u,o,+i)}s=0;case 3:if(u.length!==i.length)throw new Error("state and velocity lengths must match");return new p(u,i,s)}};var t=h("cubic-hermite"),m=h("binary-search-bounds");function g(u,i,s){return Math.min(i,Math.max(u,s))}function p(u,i,s){this.dimension=u.length,this.bounds=[new Array(this.dimension),new Array(this.dimension)];for(var o=0;o<this.dimension;++o)this.bounds[0][o]=-1/0,this.bounds[1][o]=1/0;this._state=u.slice().reverse(),this._velocity=i.slice().reverse(),this._time=[s],this._scratch=[u.slice(),u.slice(),u.slice(),u.slice(),u.slice()]}var e=p.prototype;function f(u){for(var i=new Array(u),s=0;s<u;++s)i[s]=0;return i}e.flush=function(u){var i=m.gt(this._time,u)-1;i<=0||(this._time.splice(0,i),this._state.splice(0,i*this.dimension),this._velocity.splice(0,i*this.dimension))},e.curve=function(u){var i=this._time,s=i.length,o=m.le(i,u),a=this._scratch[0],c=this._state,r=this._velocity,n=this.dimension,d=this.bounds;if(o<0)for(var l=n-1,y=0;y<n;++y,--l)a[y]=c[l];else if(o>=s-1){l=c.length-1;var v=u-i[s-1];for(y=0;y<n;++y,--l)a[y]=c[l]+v*r[l]}else{l=n*(o+1)-1;var _=i[o],x=i[o+1]-_||1,T=this._scratch[1],A=this._scratch[2],S=this._scratch[3],w=this._scratch[4],L=!0;for(y=0;y<n;++y,--l)T[y]=c[l],S[y]=r[l]*x,A[y]=c[l+n],w[y]=r[l+n]*x,L=L&&T[y]===A[y]&&S[y]===w[y]&&S[y]===0;if(L)for(y=0;y<n;++y)a[y]=T[y];else t(T,S,A,w,(u-_)/x,a)}var k=d[0],C=d[1];for(y=0;y<n;++y)a[y]=g(k[y],C[y],a[y]);return a},e.dcurve=function(u){var i=this._time,s=i.length,o=m.le(i,u),a=this._scratch[0],c=this._state,r=this._velocity,n=this.dimension;if(o>=s-1)for(var d=c.length-1,l=(i[s-1],0);l<n;++l,--d)a[l]=r[d];else{d=n*(o+1)-1;var y=i[o],v=i[o+1]-y||1,_=this._scratch[1],x=this._scratch[2],T=this._scratch[3],A=this._scratch[4],S=!0;for(l=0;l<n;++l,--d)_[l]=c[d],T[l]=r[d]*v,x[l]=c[d+n],A[l]=r[d+n]*v,S=S&&_[l]===x[l]&&T[l]===A[l]&&T[l]===0;if(S)for(l=0;l<n;++l)a[l]=0;else for(t.derivative(_,T,x,A,(u-y)/v,a),l=0;l<n;++l)a[l]/=v}return a},e.lastT=function(){var u=this._time;return u[u.length-1]},e.stable=function(){for(var u=this._velocity,i=u.length,s=this.dimension-1;s>=0;--s)if(u[--i])return!1;return!0},e.jump=function(u){var i=this.lastT(),s=this.dimension;if(!(u<i||arguments.length!==s+1)){var o=this._state,a=this._velocity,c=o.length-this.dimension,r=this.bounds,n=r[0],d=r[1];this._time.push(i,u);for(var l=0;l<2;++l)for(var y=0;y<s;++y)o.push(o[c++]),a.push(0);for(this._time.push(u),y=s;y>0;--y)o.push(g(n[y-1],d[y-1],arguments[y])),a.push(0)}},e.push=function(u){var i=this.lastT(),s=this.dimension;if(!(u<i||arguments.length!==s+1)){var o=this._state,a=this._velocity,c=o.length-this.dimension,r=u-i,n=this.bounds,d=n[0],l=n[1],y=r>1e-6?1/r:0;this._time.push(u);for(var v=s;v>0;--v){var _=g(d[v-1],l[v-1],arguments[v]);o.push(_),a.push((_-o[c++])*y)}}},e.set=function(u){var i=this.dimension;if(!(u<this.lastT()||arguments.length!==i+1)){var s=this._state,o=this._velocity,a=this.bounds,c=a[0],r=a[1];this._time.push(u);for(var n=i;n>0;--n)s.push(g(c[n-1],r[n-1],arguments[n])),o.push(0)}},e.move=function(u){var i=this.lastT(),s=this.dimension;if(!(u<=i||arguments.length!==s+1)){var o=this._state,a=this._velocity,c=o.length-this.dimension,r=this.bounds,n=r[0],d=r[1],l=u-i,y=l>1e-6?1/l:0;this._time.push(u);for(var v=s;v>0;--v){var _=arguments[v];o.push(g(n[v-1],d[v-1],o[c++]+_)),a.push(_*y)}}},e.idle=function(u){var i=this.lastT();if(!(u<i)){var s=this.dimension,o=this._state,a=this._velocity,c=o.length-s,r=this.bounds,n=r[0],d=r[1],l=u-i;this._time.push(u);for(var y=s-1;y>=0;--y)o.push(g(n[y],d[y],o[c]+l*a[c])),a.push(0),c+=1}}},{"binary-search-bounds":103,"cubic-hermite":156}],248:[function(h,N,H){var t=h("dtype");N.exports=function(m,g,p){if(!m)throw new TypeError("must specify data as first parameter");if(p=0|+(p||0),Array.isArray(m)&&m[0]&&typeof m[0][0]=="number"){var e,f,u,i,s=m[0].length,o=m.length*s;g&&typeof g!="string"||(g=new(t(g||"float32"))(o+p));var a=g.length-p;if(o!==a)throw new Error("source length "+o+" ("+s+"x"+m.length+") does not match destination length "+a);for(e=0,u=p;e<m.length;e++)for(f=0;f<s;f++)g[u++]=m[e][f]===null?NaN:m[e][f]}else if(g&&typeof g!="string")g.set(m,p);else{var c=t(g||"float32");if(Array.isArray(m)||g==="array")for(g=new c(m.length+p),e=0,u=p,i=g.length;u<i;u++,e++)g[u]=m[e]===null?NaN:m[e];else p===0?g=new c(m):(g=new c(m.length+p)).set(m,p)}return g}},{dtype:181}],249:[function(h,N,H){var t=h("css-font/stringify"),m=[32,126];N.exports=function(g){var p=(g=g||{}).shape?g.shape:g.canvas?[g.canvas.width,g.canvas.height]:[512,512],e=g.canvas||document.createElement("canvas"),f=g.font,u=typeof g.step=="number"?[g.step,g.step]:g.step||[32,32],i=g.chars||m;if(f&&typeof f!="string"&&(f=t(f)),Array.isArray(i)){if(i.length===2&&typeof i[0]=="number"&&typeof i[1]=="number"){for(var s=[],o=i[0],a=0;o<=i[1];o++)s[a++]=String.fromCharCode(o);i=s}}else i=String(i).split("");p=p.slice(),e.width=p[0],e.height=p[1];var c=e.getContext("2d");c.fillStyle="#000",c.fillRect(0,0,e.width,e.height),c.font=f,c.textAlign="center",c.textBaseline="middle",c.fillStyle="#fff";var r=u[0]/2,n=u[1]/2;for(o=0;o<i.length;o++)c.fillText(i[o],r,n),(r+=u[0])>p[0]-u[0]/2&&(r=u[0]/2,n+=u[1]);return e}},{"css-font/stringify":153}],250:[function(h,N,H){function t(e,f){f||(f={}),(typeof e=="string"||Array.isArray(e))&&(f.family=e);var u=Array.isArray(f.family)?f.family.join(", "):f.family;if(!u)throw Error("`family` must be defined");var i=f.size||f.fontSize||f.em||48,s=f.weight||f.fontWeight||"",o=(e=[f.style||f.fontStyle||"",s,i].join(" ")+"px "+u,f.origin||"top");if(t.cache[u]&&i<=t.cache[u].em)return m(t.cache[u],o);var a=f.canvas||t.canvas,c=a.getContext("2d"),r={upper:f.upper!==void 0?f.upper:"H",lower:f.lower!==void 0?f.lower:"x",descent:f.descent!==void 0?f.descent:"p",ascent:f.ascent!==void 0?f.ascent:"h",tittle:f.tittle!==void 0?f.tittle:"i",overshoot:f.overshoot!==void 0?f.overshoot:"O"},n=Math.ceil(1.5*i);a.height=n,a.width=.5*n,c.font=e;var d={top:0};c.clearRect(0,0,n,n),c.textBaseline="top",c.fillStyle="black",c.fillText("H",0,0);var l=g(c.getImageData(0,0,n,n));c.clearRect(0,0,n,n),c.textBaseline="bottom",c.fillText("H",0,n);var y=g(c.getImageData(0,0,n,n));d.lineHeight=d.bottom=n-y+l,c.clearRect(0,0,n,n),c.textBaseline="alphabetic",c.fillText("H",0,n);var v=n-g(c.getImageData(0,0,n,n))-1+l;d.baseline=d.alphabetic=v,c.clearRect(0,0,n,n),c.textBaseline="middle",c.fillText("H",0,.5*n);var _=g(c.getImageData(0,0,n,n));d.median=d.middle=n-_-1+l-.5*n,c.clearRect(0,0,n,n),c.textBaseline="hanging",c.fillText("H",0,.5*n);var x=g(c.getImageData(0,0,n,n));d.hanging=n-x-1+l-.5*n,c.clearRect(0,0,n,n),c.textBaseline="ideographic",c.fillText("H",0,n);var T=g(c.getImageData(0,0,n,n));if(d.ideographic=n-T-1+l,r.upper&&(c.clearRect(0,0,n,n),c.textBaseline="top",c.fillText(r.upper,0,0),d.upper=g(c.getImageData(0,0,n,n)),d.capHeight=d.baseline-d.upper),r.lower&&(c.clearRect(0,0,n,n),c.textBaseline="top",c.fillText(r.lower,0,0),d.lower=g(c.getImageData(0,0,n,n)),d.xHeight=d.baseline-d.lower),r.tittle&&(c.clearRect(0,0,n,n),c.textBaseline="top",c.fillText(r.tittle,0,0),d.tittle=g(c.getImageData(0,0,n,n))),r.ascent&&(c.clearRect(0,0,n,n),c.textBaseline="top",c.fillText(r.ascent,0,0),d.ascent=g(c.getImageData(0,0,n,n))),r.descent&&(c.clearRect(0,0,n,n),c.textBaseline="top",c.fillText(r.descent,0,0),d.descent=p(c.getImageData(0,0,n,n))),r.overshoot){c.clearRect(0,0,n,n),c.textBaseline="top",c.fillText(r.overshoot,0,0);var A=p(c.getImageData(0,0,n,n));d.overshoot=A-v}for(var S in d)d[S]/=i;return d.em=i,t.cache[u]=d,m(d,o)}function m(e,f){var u={};for(var i in typeof f=="string"&&(f=e[f]),e)i!=="em"&&(u[i]=e[i]-f);return u}function g(e){for(var f=e.height,u=e.data,i=3;i<u.length;i+=4)if(u[i]!==0)return Math.floor(.25*(i-3)/f)}function p(e){for(var f=e.height,u=e.data,i=u.length-1;i>0;i-=4)if(u[i]!==0)return Math.floor(.25*(i-3)/f)}N.exports=t,t.canvas=document.createElement("canvas"),t.cache={}},{}],251:[function(h,N,H){N.exports=function(n){return new e(n||r,null)};function t(n,d,l,y,v,_){this._color=n,this.key=d,this.value=l,this.left=y,this.right=v,this._count=_}function m(n){return new t(n._color,n.key,n.value,n.left,n.right,n._count)}function g(n,d){return new t(n,d.key,d.value,d.left,d.right,d._count)}function p(n){n._count=1+(n.left?n.left._count:0)+(n.right?n.right._count:0)}function e(n,d){this._compare=n,this.root=d}var f=e.prototype;function u(n,d){var l;return d.left&&(l=u(n,d.left))?l:(l=n(d.key,d.value))||(d.right?u(n,d.right):void 0)}function i(n,d,l,y){if(d(n,y.key)<=0){var v;if(y.left&&(v=i(n,d,l,y.left))||(v=l(y.key,y.value)))return v}if(y.right)return i(n,d,l,y.right)}function s(n,d,l,y,v){var _,x=l(n,v.key),T=l(d,v.key);if(x<=0&&(v.left&&(_=s(n,d,l,y,v.left))||T>0&&(_=y(v.key,v.value))))return _;if(T>0&&v.right)return s(n,d,l,y,v.right)}function o(n,d){this.tree=n,this._stack=d}Object.defineProperty(f,"keys",{get:function(){var n=[];return this.forEach(function(d,l){n.push(d)}),n}}),Object.defineProperty(f,"values",{get:function(){var n=[];return this.forEach(function(d,l){n.push(l)}),n}}),Object.defineProperty(f,"length",{get:function(){return this.root?this.root._count:0}}),f.insert=function(n,d){for(var l=this._compare,y=this.root,v=[],_=[];y;){var x=l(n,y.key);v.push(y),_.push(x),y=x<=0?y.left:y.right}v.push(new t(0,n,d,null,null,1));for(var T=v.length-2;T>=0;--T)y=v[T],_[T]<=0?v[T]=new t(y._color,y.key,y.value,v[T+1],y.right,y._count+1):v[T]=new t(y._color,y.key,y.value,y.left,v[T+1],y._count+1);for(T=v.length-1;T>1;--T){var A=v[T-1];if(y=v[T],A._color===1||y._color===1)break;var S=v[T-2];if(S.left===A)if(A.left===y){if(!(w=S.right)||w._color!==0){S._color=0,S.left=A.right,A._color=1,A.right=S,v[T-2]=A,v[T-1]=y,p(S),p(A),T>=3&&((L=v[T-3]).left===S?L.left=A:L.right=A);break}A._color=1,S.right=g(1,w),S._color=0,T-=1}else{if(!(w=S.right)||w._color!==0){A.right=y.left,S._color=0,S.left=y.right,y._color=1,y.left=A,y.right=S,v[T-2]=y,v[T-1]=A,p(S),p(A),p(y),T>=3&&((L=v[T-3]).left===S?L.left=y:L.right=y);break}A._color=1,S.right=g(1,w),S._color=0,T-=1}else if(A.right===y){if(!(w=S.left)||w._color!==0){S._color=0,S.right=A.left,A._color=1,A.left=S,v[T-2]=A,v[T-1]=y,p(S),p(A),T>=3&&((L=v[T-3]).right===S?L.right=A:L.left=A);break}A._color=1,S.left=g(1,w),S._color=0,T-=1}else{var w;if(!(w=S.left)||w._color!==0){var L;A.left=y.right,S._color=0,S.right=y.left,y._color=1,y.right=A,y.left=S,v[T-2]=y,v[T-1]=A,p(S),p(A),p(y),T>=3&&((L=v[T-3]).right===S?L.right=y:L.left=y);break}A._color=1,S.left=g(1,w),S._color=0,T-=1}}return v[0]._color=1,new e(l,v[0])},f.forEach=function(n,d,l){if(this.root)switch(arguments.length){case 1:return u(n,this.root);case 2:return i(d,this._compare,n,this.root);case 3:return this._compare(d,l)>=0?void 0:s(d,l,this._compare,n,this.root)}},Object.defineProperty(f,"begin",{get:function(){for(var n=[],d=this.root;d;)n.push(d),d=d.left;return new o(this,n)}}),Object.defineProperty(f,"end",{get:function(){for(var n=[],d=this.root;d;)n.push(d),d=d.right;return new o(this,n)}}),f.at=function(n){if(n<0)return new o(this,[]);for(var d=this.root,l=[];;){if(l.push(d),d.left){if(n<d.left._count){d=d.left;continue}n-=d.left._count}if(!n)return new o(this,l);if(n-=1,!d.right||n>=d.right._count)break;d=d.right}return new o(this,[])},f.ge=function(n){for(var d=this._compare,l=this.root,y=[],v=0;l;){var _=d(n,l.key);y.push(l),_<=0&&(v=y.length),l=_<=0?l.left:l.right}return y.length=v,new o(this,y)},f.gt=function(n){for(var d=this._compare,l=this.root,y=[],v=0;l;){var _=d(n,l.key);y.push(l),_<0&&(v=y.length),l=_<0?l.left:l.right}return y.length=v,new o(this,y)},f.lt=function(n){for(var d=this._compare,l=this.root,y=[],v=0;l;){var _=d(n,l.key);y.push(l),_>0&&(v=y.length),l=_<=0?l.left:l.right}return y.length=v,new o(this,y)},f.le=function(n){for(var d=this._compare,l=this.root,y=[],v=0;l;){var _=d(n,l.key);y.push(l),_>=0&&(v=y.length),l=_<0?l.left:l.right}return y.length=v,new o(this,y)},f.find=function(n){for(var d=this._compare,l=this.root,y=[];l;){var v=d(n,l.key);if(y.push(l),v===0)return new o(this,y);l=v<=0?l.left:l.right}return new o(this,[])},f.remove=function(n){var d=this.find(n);return d?d.remove():this},f.get=function(n){for(var d=this._compare,l=this.root;l;){var y=d(n,l.key);if(y===0)return l.value;l=y<=0?l.left:l.right}};var a=o.prototype;function c(n,d){n.key=d.key,n.value=d.value,n.left=d.left,n.right=d.right,n._color=d._color,n._count=d._count}function r(n,d){return n<d?-1:n>d?1:0}Object.defineProperty(a,"valid",{get:function(){return this._stack.length>0}}),Object.defineProperty(a,"node",{get:function(){return this._stack.length>0?this._stack[this._stack.length-1]:null},enumerable:!0}),a.clone=function(){return new o(this.tree,this._stack.slice())},a.remove=function(){var n=this._stack;if(n.length===0)return this.tree;var d=new Array(n.length),l=n[n.length-1];d[d.length-1]=new t(l._color,l.key,l.value,l.left,l.right,l._count);for(var y=n.length-2;y>=0;--y)(l=n[y]).left===n[y+1]?d[y]=new t(l._color,l.key,l.value,d[y+1],l.right,l._count):d[y]=new t(l._color,l.key,l.value,l.left,d[y+1],l._count);if((l=d[d.length-1]).left&&l.right){var v=d.length;for(l=l.left;l.right;)d.push(l),l=l.right;var _=d[v-1];for(d.push(new t(l._color,_.key,_.value,l.left,l.right,l._count)),d[v-1].key=l.key,d[v-1].value=l.value,y=d.length-2;y>=v;--y)l=d[y],d[y]=new t(l._color,l.key,l.value,l.left,d[y+1],l._count);d[v-1].left=d[v]}if((l=d[d.length-1])._color===0){var x=d[d.length-2];for(x.left===l?x.left=null:x.right===l&&(x.right=null),d.pop(),y=0;y<d.length;++y)d[y]._count--;return new e(this.tree._compare,d[0])}if(l.left||l.right){for(l.left?c(l,l.left):l.right&&c(l,l.right),l._color=1,y=0;y<d.length-1;++y)d[y]._count--;return new e(this.tree._compare,d[0])}if(d.length===1)return new e(this.tree._compare,null);for(y=0;y<d.length;++y)d[y]._count--;var T=d[d.length-2];return function(A){for(var S,w,L,k,C=A.length-1;C>=0;--C){if(S=A[C],C===0)return void(S._color=1);if((w=A[C-1]).left===S){if((L=w.right).right&&L.right._color===0)return k=(L=w.right=m(L)).right=m(L.right),w.right=L.left,L.left=w,L.right=k,L._color=w._color,S._color=1,w._color=1,k._color=1,p(w),p(L),C>1&&((M=A[C-2]).left===w?M.left=L:M.right=L),void(A[C-1]=L);if(L.left&&L.left._color===0)return k=(L=w.right=m(L)).left=m(L.left),w.right=k.left,L.left=k.right,k.left=w,k.right=L,k._color=w._color,w._color=1,L._color=1,S._color=1,p(w),p(L),p(k),C>1&&((M=A[C-2]).left===w?M.left=k:M.right=k),void(A[C-1]=k);if(L._color===1){if(w._color===0)return w._color=1,void(w.right=g(0,L));w.right=g(0,L);continue}L=m(L),w.right=L.left,L.left=w,L._color=w._color,w._color=0,p(w),p(L),C>1&&((M=A[C-2]).left===w?M.left=L:M.right=L),A[C-1]=L,A[C]=w,C+1<A.length?A[C+1]=S:A.push(S),C+=2}else{if((L=w.left).left&&L.left._color===0)return k=(L=w.left=m(L)).left=m(L.left),w.left=L.right,L.right=w,L.left=k,L._color=w._color,S._color=1,w._color=1,k._color=1,p(w),p(L),C>1&&((M=A[C-2]).right===w?M.right=L:M.left=L),void(A[C-1]=L);if(L.right&&L.right._color===0)return k=(L=w.left=m(L)).right=m(L.right),w.left=k.right,L.right=k.left,k.right=w,k.left=L,k._color=w._color,w._color=1,L._color=1,S._color=1,p(w),p(L),p(k),C>1&&((M=A[C-2]).right===w?M.right=k:M.left=k),void(A[C-1]=k);if(L._color===1){if(w._color===0)return w._color=1,void(w.left=g(0,L));w.left=g(0,L);continue}var M;L=m(L),w.left=L.right,L.right=w,L._color=w._color,w._color=0,p(w),p(L),C>1&&((M=A[C-2]).right===w?M.right=L:M.left=L),A[C-1]=L,A[C]=w,C+1<A.length?A[C+1]=S:A.push(S),C+=2}}}(d),T.left===l?T.left=null:T.right=null,new e(this.tree._compare,d[0])},Object.defineProperty(a,"key",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].key},enumerable:!0}),Object.defineProperty(a,"value",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].value},enumerable:!0}),Object.defineProperty(a,"index",{get:function(){var n=0,d=this._stack;if(d.length===0){var l=this.tree.root;return l?l._count:0}d[d.length-1].left&&(n=d[d.length-1].left._count);for(var y=d.length-2;y>=0;--y)d[y+1]===d[y].right&&(++n,d[y].left&&(n+=d[y].left._count));return n},enumerable:!0}),a.next=function(){var n=this._stack;if(n.length!==0){var d=n[n.length-1];if(d.right)for(d=d.right;d;)n.push(d),d=d.left;else for(n.pop();n.length>0&&n[n.length-1].right===d;)d=n[n.length-1],n.pop()}},Object.defineProperty(a,"hasNext",{get:function(){var n=this._stack;if(n.length===0)return!1;if(n[n.length-1].right)return!0;for(var d=n.length-1;d>0;--d)if(n[d-1].left===n[d])return!0;return!1}}),a.update=function(n){var d=this._stack;if(d.length===0)throw new Error("Can't update empty node!");var l=new Array(d.length),y=d[d.length-1];l[l.length-1]=new t(y._color,y.key,n,y.left,y.right,y._count);for(var v=d.length-2;v>=0;--v)(y=d[v]).left===d[v+1]?l[v]=new t(y._color,y.key,y.value,l[v+1],y.right,y._count):l[v]=new t(y._color,y.key,y.value,y.left,l[v+1],y._count);return new e(this.tree._compare,l[0])},a.prev=function(){var n=this._stack;if(n.length!==0){var d=n[n.length-1];if(d.left)for(d=d.left;d;)n.push(d),d=d.right;else for(n.pop();n.length>0&&n[n.length-1].left===d;)d=n[n.length-1],n.pop()}},Object.defineProperty(a,"hasPrev",{get:function(){var n=this._stack;if(n.length===0)return!1;if(n[n.length-1].left)return!0;for(var d=n.length-1;d>0;--d)if(n[d-1].right===n[d])return!0;return!1}})},{}],252:[function(h,N,H){N.exports=function(t,m){if(typeof t!="string")throw new TypeError("must specify type string");if(m=m||{},typeof document=="undefined"&&!m.canvas)return null;var g=m.canvas||document.createElement("canvas");typeof m.width=="number"&&(g.width=m.width),typeof m.height=="number"&&(g.height=m.height);var p,e=m;try{var f=[t];t.indexOf("webgl")===0&&f.push("experimental-"+t);for(var u=0;u<f.length;u++)if(p=g.getContext(f[u],e))return p}catch(i){p=null}return p||null}},{}],253:[function(h,N,H){N.exports=function(v,_){var x=new i(v);return x.update(_),x};var t=h("./lib/text.js"),m=h("./lib/lines.js"),g=h("./lib/background.js"),p=h("./lib/cube.js"),e=h("./lib/ticks.js"),f=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);function u(v,_){return v[0]=_[0],v[1]=_[1],v[2]=_[2],v}function i(v){this.gl=v,this.pixelRatio=1,this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.autoTicks=!0,this.tickSpacing=[1,1,1],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickAlign=["auto","auto","auto"],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[10,10,10],this.lastCubeProps={cubeEdges:[0,0,0],axis:[0,0,0]},this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont="sans-serif",this.labelSize=[20,20,20],this.labelAngle=[0,0,0],this.labelAlign=["auto","auto","auto"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[10,10,10],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[0,0,0],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!1,!1,!1],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._firstInit=!0,this._text=null,this._lines=null,this._background=g(v)}var s=i.prototype;function o(){this.primalOffset=[0,0,0],this.primalMinor=[0,0,0],this.mirrorOffset=[0,0,0],this.mirrorMinor=[0,0,0]}s.update=function(v){function _(F,j,W){if(W in v){var Z,Q=v[W],X=this[W];(F?Array.isArray(Q)&&Array.isArray(Q[0]):Array.isArray(Q))?this[W]=Z=[j(Q[0]),j(Q[1]),j(Q[2])]:this[W]=Z=[j(Q),j(Q),j(Q)];for(var G=0;G<3;++G)if(Z[G]!==X[G])return!0}return!1}v=v||{};var x,T=_.bind(this,!1,Number),A=_.bind(this,!1,Boolean),S=_.bind(this,!1,String),w=_.bind(this,!0,function(F){if(Array.isArray(F)){if(F.length===3)return[+F[0],+F[1],+F[2],1];if(F.length===4)return[+F[0],+F[1],+F[2],+F[3]]}return[0,0,0,1]}),L=!1,k=!1;if("bounds"in v)for(var C=v.bounds,M=0;M<2;++M)for(var P=0;P<3;++P)C[M][P]!==this.bounds[M][P]&&(k=!0),this.bounds[M][P]=C[M][P];if("ticks"in v)for(x=v.ticks,L=!0,this.autoTicks=!1,M=0;M<3;++M)this.tickSpacing[M]=0;else T("tickSpacing")&&(this.autoTicks=!0,k=!0);if(this._firstInit&&("ticks"in v||"tickSpacing"in v||(this.autoTicks=!0),k=!0,L=!0,this._firstInit=!1),k&&this.autoTicks&&(x=e.create(this.bounds,this.tickSpacing),L=!0),L){for(M=0;M<3;++M)x[M].sort(function(F,j){return F.x-j.x});e.equal(x,this.ticks)?L=!1:this.ticks=x}A("tickEnable"),S("tickFont")&&(L=!0),T("tickSize"),T("tickAngle"),T("tickPad"),w("tickColor");var O=S("labels");S("labelFont")&&(O=!0),A("labelEnable"),T("labelSize"),T("labelPad"),w("labelColor"),A("lineEnable"),A("lineMirror"),T("lineWidth"),w("lineColor"),A("lineTickEnable"),A("lineTickMirror"),T("lineTickLength"),T("lineTickWidth"),w("lineTickColor"),A("gridEnable"),T("gridWidth"),w("gridColor"),A("zeroEnable"),w("zeroLineColor"),T("zeroLineWidth"),A("backgroundEnable"),w("backgroundColor"),this._text?this._text&&(O||L)&&this._text.update(this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont):this._text=t(this.gl,this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont),this._lines&&L&&(this._lines.dispose(),this._lines=null),this._lines||(this._lines=m(this.gl,this.bounds,this.ticks))};var a=[new o,new o,new o];function c(v,_,x,T,A){for(var S=v.primalOffset,w=v.primalMinor,L=v.mirrorOffset,k=v.mirrorMinor,C=T[_],M=0;M<3;++M)if(_!==M){var P=S,O=L,F=w,j=k;C&1<<M&&(P=L,O=S,F=k,j=w),P[M]=x[0][M],O[M]=x[1][M],A[M]>0?(F[M]=-1,j[M]=0):(F[M]=0,j[M]=1)}}var r=[0,0,0],n={model:f,view:f,projection:f,_ortho:!1};s.isOpaque=function(){return!0},s.isTransparent=function(){return!1},s.drawTransparent=function(v){};var d=[0,0,0],l=[0,0,0],y=[0,0,0];s.draw=function(v){v=v||n;for(var _=this.gl,x=v.model||f,T=v.view||f,A=v.projection||f,S=this.bounds,w=v._ortho||!1,L=p(x,T,A,S,w),k=L.cubeEdges,C=L.axis,M=T[12],P=T[13],O=T[14],F=T[15],j=(w?2:1)*this.pixelRatio*(A[3]*M+A[7]*P+A[11]*O+A[15]*F)/_.drawingBufferHeight,W=0;W<3;++W)this.lastCubeProps.cubeEdges[W]=k[W],this.lastCubeProps.axis[W]=C[W];var Z=a;for(W=0;W<3;++W)c(a[W],W,this.bounds,k,C);_=this.gl;var Q,X=r;for(W=0;W<3;++W)this.backgroundEnable[W]?X[W]=C[W]:X[W]=0;for(this._background.draw(x,T,A,S,X,this.backgroundColor),this._lines.bind(x,T,A,this),W=0;W<3;++W){var G=[0,0,0];C[W]>0?G[W]=S[1][W]:G[W]=S[0][W];for(var Y=0;Y<2;++Y){var K=(W+1+Y)%3,D=(W+1+(1^Y))%3;this.gridEnable[K]&&this._lines.drawGrid(K,D,this.bounds,G,this.gridColor[K],this.gridWidth[K]*this.pixelRatio)}for(Y=0;Y<2;++Y)K=(W+1+Y)%3,D=(W+1+(1^Y))%3,this.zeroEnable[D]&&Math.min(S[0][D],S[1][D])<=0&&Math.max(S[0][D],S[1][D])>=0&&this._lines.drawZero(K,D,this.bounds,G,this.zeroLineColor[D],this.zeroLineWidth[D]*this.pixelRatio)}for(W=0;W<3;++W){this.lineEnable[W]&&this._lines.drawAxisLine(W,this.bounds,Z[W].primalOffset,this.lineColor[W],this.lineWidth[W]*this.pixelRatio),this.lineMirror[W]&&this._lines.drawAxisLine(W,this.bounds,Z[W].mirrorOffset,this.lineColor[W],this.lineWidth[W]*this.pixelRatio);var B=u(d,Z[W].primalMinor),q=u(l,Z[W].mirrorMinor),ee=this.lineTickLength;for(Y=0;Y<3;++Y){var J=j/x[5*Y];B[Y]*=ee[Y]*J,q[Y]*=ee[Y]*J}this.lineTickEnable[W]&&this._lines.drawAxisTicks(W,Z[W].primalOffset,B,this.lineTickColor[W],this.lineTickWidth[W]*this.pixelRatio),this.lineTickMirror[W]&&this._lines.drawAxisTicks(W,Z[W].mirrorOffset,q,this.lineTickColor[W],this.lineTickWidth[W]*this.pixelRatio)}this._lines.unbind(),this._text.bind(x,T,A,this.pixelRatio);var $,te;function ie(ve){(te=[0,0,0])[ve]=1}function ae(ve,ke,Ee){var be=(ve+1)%3,xe=(ve+2)%3,ue=ke[be],me=ke[xe],we=Ee[be],Me=Ee[xe];ue>0&&Me>0||ue>0&&Me<0||ue<0&&Me>0||ue<0&&Me<0?ie(be):(me>0&&we>0||me>0&&we<0||me<0&&we>0||me<0&&we<0)&&ie(xe)}for(W=0;W<3;++W){var he=Z[W].primalMinor,se=Z[W].mirrorMinor,de=u(y,Z[W].primalOffset);for(Y=0;Y<3;++Y)this.lineTickEnable[W]&&(de[Y]+=j*he[Y]*Math.max(this.lineTickLength[Y],0)/x[5*Y]);var ce=[0,0,0];if(ce[W]=1,this.tickEnable[W]){for(this.tickAngle[W]===-3600?(this.tickAngle[W]=0,this.tickAlign[W]="auto"):this.tickAlign[W]=-1,$=1,(Q=[this.tickAlign[W],.5,$])[0]==="auto"?Q[0]=0:Q[0]=parseInt(""+Q[0]),te=[0,0,0],ae(W,he,se),Y=0;Y<3;++Y)de[Y]+=j*he[Y]*this.tickPad[Y]/x[5*Y];this._text.drawTicks(W,this.tickSize[W],this.tickAngle[W],de,this.tickColor[W],ce,te,Q)}if(this.labelEnable[W]){for($=0,te=[0,0,0],this.labels[W].length>4&&(ie(W),$=1),(Q=[this.labelAlign[W],.5,$])[0]==="auto"?Q[0]=0:Q[0]=parseInt(""+Q[0]),Y=0;Y<3;++Y)de[Y]+=j*he[Y]*this.labelPad[Y]/x[5*Y];de[W]+=.5*(S[0][W]+S[1][W]),this._text.drawLabel(W,this.labelSize[W],this.labelAngle[W],de,this.labelColor[W],[0,0,0],te,Q)}}this._text.unbind()},s.dispose=function(){this._text.dispose(),this._lines.dispose(),this._background.dispose(),this._lines=null,this._text=null,this._background=null,this.gl=null}},{"./lib/background.js":254,"./lib/cube.js":255,"./lib/lines.js":256,"./lib/text.js":258,"./lib/ticks.js":259}],254:[function(h,N,H){N.exports=function(f){for(var u=[],i=[],s=0,o=0;o<3;++o)for(var a=(o+1)%3,c=(o+2)%3,r=[0,0,0],n=[0,0,0],d=-1;d<=1;d+=2){i.push(s,s+2,s+1,s+1,s+2,s+3),r[o]=d,n[o]=d;for(var l=-1;l<=1;l+=2){r[a]=l;for(var y=-1;y<=1;y+=2)r[c]=y,u.push(r[0],r[1],r[2],n[0],n[1],n[2]),s+=1}var v=a;a=c,c=v}var _=t(f,new Float32Array(u)),x=t(f,new Uint16Array(i),f.ELEMENT_ARRAY_BUFFER),T=m(f,[{buffer:_,type:f.FLOAT,size:3,offset:0,stride:24},{buffer:_,type:f.FLOAT,size:3,offset:12,stride:24}],x),A=g(f);return A.attributes.position.location=0,A.attributes.normal.location=1,new p(f,_,T,A)};var t=h("gl-buffer"),m=h("gl-vao"),g=h("./shaders").bg;function p(f,u,i,s){this.gl=f,this.buffer=u,this.vao=i,this.shader=s}var e=p.prototype;e.draw=function(f,u,i,s,o,a){for(var c=!1,r=0;r<3;++r)c=c||o[r];if(c){var n=this.gl;n.enable(n.POLYGON_OFFSET_FILL),n.polygonOffset(1,2),this.shader.bind(),this.shader.uniforms={model:f,view:u,projection:i,bounds:s,enable:o,colors:a},this.vao.bind(),this.vao.draw(this.gl.TRIANGLES,36),this.vao.unbind(),n.disable(n.POLYGON_OFFSET_FILL)}},e.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()}},{"./shaders":257,"gl-buffer":261,"gl-vao":353}],255:[function(h,N,H){N.exports=function(l,y,v,_,x){m(e,y,l),m(e,v,e);for(var T=0,A=0;A<2;++A){i[2]=_[A][2];for(var S=0;S<2;++S){i[1]=_[S][1];for(var w=0;w<2;++w)i[0]=_[w][0],o(f[T],i,e),T+=1}}var L=-1;for(A=0;A<8;++A){for(var k=f[A][3],C=0;C<3;++C)u[A][C]=f[A][C]/k;x&&(u[A][2]*=-1),k<0&&(L<0||u[A][2]<u[L][2])&&(L=A)}if(L<0){L=0;for(var M=0;M<3;++M){for(var P=(M+2)%3,O=(M+1)%3,F=-1,j=-1,W=0;W<2;++W){var Z=(X=W<<M)+(W<<P)+(1-W<<O),Q=X+(1-W<<P)+(W<<O);p(u[X],u[Z],u[Q],s)<0||(W?F=1:j=1)}if(F<0||j<0)j>F&&(L|=1<<M);else{for(W=0;W<2;++W){Z=(X=W<<M)+(W<<P)+(1-W<<O),Q=X+(1-W<<P)+(W<<O);var X,G=c([f[X],f[Z],f[Q],f[X+(1<<P)+(1<<O)]]);W?F=G:j=G}j>F&&(L|=1<<M)}}}var Y=7^L,K=-1;for(A=0;A<8;++A)A!==L&&A!==Y&&(K<0||u[K][1]>u[A][1])&&(K=A);var D=-1;for(A=0;A<3;++A)(q=K^1<<A)!==L&&q!==Y&&(D<0&&(D=q),(O=u[q])[0]<u[D][0]&&(D=q));var B=-1;for(A=0;A<3;++A){var q;(q=K^1<<A)!==L&&q!==Y&&q!==D&&(B<0&&(B=q),(O=u[q])[0]>u[B][0]&&(B=q))}var ee=r;ee[0]=ee[1]=ee[2]=0,ee[t.log2(D^K)]=K&D,ee[t.log2(K^B)]=K&B;var J=7^B;J===L||J===Y?(J=7^D,ee[t.log2(B^J)]=J&B):ee[t.log2(D^J)]=J&D;var $=n,te=L;for(M=0;M<3;++M)$[M]=te&1<<M?-1:1;return d};var t=h("bit-twiddle"),m=h("gl-mat4/multiply"),g=h("split-polygon"),p=h("robust-orientation"),e=new Array(16),f=new Array(8),u=new Array(8),i=new Array(3),s=[0,0,0];function o(l,y,v){for(var _=0;_<4;++_){l[_]=v[12+_];for(var x=0;x<3;++x)l[_]+=y[x]*v[4*x+_]}}(function(){for(var l=0;l<8;++l)f[l]=[1,1,1,1],u[l]=[1,1,1]})();var a=[[0,0,1,0,0],[0,0,-1,1,0],[0,-1,0,1,0],[0,1,0,1,0],[-1,0,0,1,0],[1,0,0,1,0]];function c(l){for(var y=0;y<a.length;++y)if((l=g.positive(l,a[y])).length<3)return 0;var v=l[0],_=v[0]/v[3],x=v[1]/v[3],T=0;for(y=1;y+1<l.length;++y){var A=l[y],S=l[y+1],w=A[0]/A[3]-_,L=A[1]/A[3]-x,k=S[0]/S[3]-_,C=S[1]/S[3]-x;T+=Math.abs(w*C-L*k)}return T}var r=[1,1,1],n=[0,0,0],d={cubeEdges:r,axis:n}},{"bit-twiddle":104,"gl-mat4/multiply":295,"robust-orientation":534,"split-polygon":552}],256:[function(h,N,H){N.exports=function(r,n,d){var l=[],y=[0,0,0],v=[0,0,0],_=[0,0,0],x=[0,0,0];l.push(0,0,1,0,1,1,0,0,-1,0,0,-1,0,1,1,0,1,-1);for(var T=0;T<3;++T){for(var A=l.length/3|0,S=0;S<d[T].length;++S){var w=+d[T][S].x;l.push(w,0,1,w,1,1,w,0,-1,w,0,-1,w,1,1,w,1,-1)}var L=l.length/3|0;y[T]=A,v[T]=L-A,A=l.length/3|0;for(var k=0;k<d[T].length;++k)w=+d[T][k].x,l.push(w,0,1,w,1,1,w,0,-1,w,0,-1,w,1,1,w,1,-1);L=l.length/3|0,_[T]=A,x[T]=L-A}var C=t(r,new Float32Array(l)),M=m(r,[{buffer:C,type:r.FLOAT,size:3,stride:0,offset:0}]),P=g(r);return P.attributes.position.location=0,new a(r,C,M,P,v,y,x,_)};var t=h("gl-buffer"),m=h("gl-vao"),g=h("./shaders").line,p=[0,0,0],e=[0,0,0],f=[0,0,0],u=[0,0,0],i=[1,1];function s(r){return r[0]=r[1]=r[2]=0,r}function o(r,n){return r[0]=n[0],r[1]=n[1],r[2]=n[2],r}function a(r,n,d,l,y,v,_,x){this.gl=r,this.vertBuffer=n,this.vao=d,this.shader=l,this.tickCount=y,this.tickOffset=v,this.gridCount=_,this.gridOffset=x}var c=a.prototype;c.bind=function(r,n,d){this.shader.bind(),this.shader.uniforms.model=r,this.shader.uniforms.view=n,this.shader.uniforms.projection=d,i[0]=this.gl.drawingBufferWidth,i[1]=this.gl.drawingBufferHeight,this.shader.uniforms.screenShape=i,this.vao.bind()},c.unbind=function(){this.vao.unbind()},c.drawAxisLine=function(r,n,d,l,y){var v=s(e);this.shader.uniforms.majorAxis=e,v[r]=n[1][r]-n[0][r],this.shader.uniforms.minorAxis=v;var _,x=o(u,d);x[r]+=n[0][r],this.shader.uniforms.offset=x,this.shader.uniforms.lineWidth=y,this.shader.uniforms.color=l,(_=s(f))[(r+2)%3]=1,this.shader.uniforms.screenAxis=_,this.vao.draw(this.gl.TRIANGLES,6),(_=s(f))[(r+1)%3]=1,this.shader.uniforms.screenAxis=_,this.vao.draw(this.gl.TRIANGLES,6)},c.drawAxisTicks=function(r,n,d,l,y){if(this.tickCount[r]){var v=s(p);v[r]=1,this.shader.uniforms.majorAxis=v,this.shader.uniforms.offset=n,this.shader.uniforms.minorAxis=d,this.shader.uniforms.color=l,this.shader.uniforms.lineWidth=y;var _=s(f);_[r]=1,this.shader.uniforms.screenAxis=_,this.vao.draw(this.gl.TRIANGLES,this.tickCount[r],this.tickOffset[r])}},c.drawGrid=function(r,n,d,l,y,v){if(this.gridCount[r]){var _=s(e);_[n]=d[1][n]-d[0][n],this.shader.uniforms.minorAxis=_;var x=o(u,l);x[n]+=d[0][n],this.shader.uniforms.offset=x;var T=s(p);T[r]=1,this.shader.uniforms.majorAxis=T;var A=s(f);A[r]=1,this.shader.uniforms.screenAxis=A,this.shader.uniforms.lineWidth=v,this.shader.uniforms.color=y,this.vao.draw(this.gl.TRIANGLES,this.gridCount[r],this.gridOffset[r])}},c.drawZero=function(r,n,d,l,y,v){var _=s(e);this.shader.uniforms.majorAxis=_,_[r]=d[1][r]-d[0][r],this.shader.uniforms.minorAxis=_;var x=o(u,l);x[r]+=d[0][r],this.shader.uniforms.offset=x;var T=s(f);T[n]=1,this.shader.uniforms.screenAxis=T,this.shader.uniforms.lineWidth=v,this.shader.uniforms.color=y,this.vao.draw(this.gl.TRIANGLES,6)},c.dispose=function(){this.vao.dispose(),this.vertBuffer.dispose(),this.shader.dispose()}},{"./shaders":257,"gl-buffer":261,"gl-vao":353}],257:[function(h,N,H){var t=h("glslify"),m=h("gl-shader"),g=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;
uniform vec3 offset, majorAxis, minorAxis, screenAxis;
uniform float lineWidth;
uniform vec2 screenShape;

vec3 project(vec3 p) {
  vec4 pp = projection * view * model * vec4(p, 1.0);
  return pp.xyz / max(pp.w, 0.0001);
}

void main() {
  vec3 major = position.x * majorAxis;
  vec3 minor = position.y * minorAxis;

  vec3 vPosition = major + minor + offset;
  vec3 pPosition = project(vPosition);
  vec3 offset = project(vPosition + screenAxis * position.z);

  vec2 screen = normalize((offset - pPosition).xy * screenShape) / screenShape;

  gl_Position = vec4(pPosition + vec3(0.5 * screen * lineWidth, 0), 1.0);
}
`]),p=t([`precision highp float;
#define GLSLIFY 1

uniform vec4 color;
void main() {
  gl_FragColor = color;
}`]);H.line=function(s){return m(s,g,p,null,[{name:"position",type:"vec3"}])};var e=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;
uniform vec3 offset, axis, alignDir, alignOpt;
uniform float scale, angle, pixelScale;
uniform vec2 resolution;

vec3 project(vec3 p) {
  vec4 pp = projection * view * model * vec4(p, 1.0);
  return pp.xyz / max(pp.w, 0.0001);
}

float computeViewAngle(vec3 a, vec3 b) {
  vec3 A = project(a);
  vec3 B = project(b);

  return atan(
    (B.y - A.y) * resolution.y,
    (B.x - A.x) * resolution.x
  );
}

const float PI = 3.141592;
const float TWO_PI = 2.0 * PI;
const float HALF_PI = 0.5 * PI;
const float ONE_AND_HALF_PI = 1.5 * PI;

int option = int(floor(alignOpt.x + 0.001));
float hv_ratio =       alignOpt.y;
bool enableAlign =    (alignOpt.z != 0.0);

float mod_angle(float a) {
  return mod(a, PI);
}

float positive_angle(float a) {
  return mod_angle((a < 0.0) ?
    a + TWO_PI :
    a
  );
}

float look_upwards(float a) {
  float b = positive_angle(a);
  return ((b > HALF_PI) && (b <= ONE_AND_HALF_PI)) ?
    b - PI :
    b;
}

float look_horizontal_or_vertical(float a, float ratio) {
  // ratio controls the ratio between being horizontal to (vertical + horizontal)
  // if ratio is set to 0.5 then it is 50%, 50%.
  // when using a higher ratio e.g. 0.75 the result would
  // likely be more horizontal than vertical.

  float b = positive_angle(a);

  return
    (b < (      ratio) * HALF_PI) ? 0.0 :
    (b < (2.0 - ratio) * HALF_PI) ? -HALF_PI :
    (b < (2.0 + ratio) * HALF_PI) ? 0.0 :
    (b < (4.0 - ratio) * HALF_PI) ? HALF_PI :
                                    0.0;
}

float roundTo(float a, float b) {
  return float(b * floor((a + 0.5 * b) / b));
}

float look_round_n_directions(float a, int n) {
  float b = positive_angle(a);
  float div = TWO_PI / float(n);
  float c = roundTo(b, div);
  return look_upwards(c);
}

float applyAlignOption(float rawAngle, float delta) {
  return
    (option >  2) ? look_round_n_directions(rawAngle + delta, option) :       // option 3-n: round to n directions
    (option == 2) ? look_horizontal_or_vertical(rawAngle + delta, hv_ratio) : // horizontal or vertical
    (option == 1) ? rawAngle + delta :       // use free angle, and flip to align with one direction of the axis
    (option == 0) ? look_upwards(rawAngle) : // use free angle, and stay upwards
    (option ==-1) ? 0.0 :                    // useful for backward compatibility, all texts remains horizontal
                    rawAngle;                // otherwise return back raw input angle
}

bool isAxisTitle = (axis.x == 0.0) &&
                   (axis.y == 0.0) &&
                   (axis.z == 0.0);

void main() {
  //Compute world offset
  float axisDistance = position.z;
  vec3 dataPosition = axisDistance * axis + offset;

  float beta = angle; // i.e. user defined attributes for each tick

  float axisAngle;
  float clipAngle;
  float flip;

  if (enableAlign) {
    axisAngle = (isAxisTitle) ? HALF_PI :
                      computeViewAngle(dataPosition, dataPosition + axis);
    clipAngle = computeViewAngle(dataPosition, dataPosition + alignDir);

    axisAngle += (sin(axisAngle) < 0.0) ? PI : 0.0;
    clipAngle += (sin(clipAngle) < 0.0) ? PI : 0.0;

    flip = (dot(vec2(cos(axisAngle), sin(axisAngle)),
                vec2(sin(clipAngle),-cos(clipAngle))) > 0.0) ? 1.0 : 0.0;

    beta += applyAlignOption(clipAngle, flip * PI);
  }

  //Compute plane offset
  vec2 planeCoord = position.xy * pixelScale;

  mat2 planeXform = scale * mat2(
     cos(beta), sin(beta),
    -sin(beta), cos(beta)
  );

  vec2 viewOffset = 2.0 * planeXform * planeCoord / resolution;

  //Compute clip position
  vec3 clipPosition = project(dataPosition);

  //Apply text offset in clip coordinates
  clipPosition += vec3(viewOffset, 0.0);

  //Done
  gl_Position = vec4(clipPosition, 1.0);
}`]),f=t([`precision highp float;
#define GLSLIFY 1

uniform vec4 color;
void main() {
  gl_FragColor = color;
}`]);H.text=function(s){return m(s,e,f,null,[{name:"position",type:"vec3"}])};var u=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec3 normal;

uniform mat4 model, view, projection;
uniform vec3 enable;
uniform vec3 bounds[2];

varying vec3 colorChannel;

void main() {

  vec3 signAxis = sign(bounds[1] - bounds[0]);

  vec3 realNormal = signAxis * normal;

  if(dot(realNormal, enable) > 0.0) {
    vec3 minRange = min(bounds[0], bounds[1]);
    vec3 maxRange = max(bounds[0], bounds[1]);
    vec3 nPosition = mix(minRange, maxRange, 0.5 * (position + 1.0));
    gl_Position = projection * view * model * vec4(nPosition, 1.0);
  } else {
    gl_Position = vec4(0,0,0,0);
  }

  colorChannel = abs(realNormal);
}`]),i=t([`precision highp float;
#define GLSLIFY 1

uniform vec4 colors[3];

varying vec3 colorChannel;

void main() {
  gl_FragColor = colorChannel.x * colors[0] +
                 colorChannel.y * colors[1] +
                 colorChannel.z * colors[2];
}`]);H.bg=function(s){return m(s,u,i,null,[{name:"position",type:"vec3"},{name:"normal",type:"vec3"}])}},{"gl-shader":332,glslify:434}],258:[function(h,N,H){(function(t){(function(){N.exports=function(a,c,r,n,d,l){var y=m(a),v=g(a,[{buffer:y,size:3}]),_=e(a);_.attributes.position.location=0;var x=new i(a,_,y,v);return x.update(c,r,n,d,l),x};var m=h("gl-buffer"),g=h("gl-vao"),p=h("vectorize-text"),e=h("./shaders").text,f=window||t.global||{},u=f.__TEXT_CACHE||{};f.__TEXT_CACHE={};function i(a,c,r,n){this.gl=a,this.shader=c,this.buffer=r,this.vao=n,this.tickOffset=this.tickCount=this.labelOffset=this.labelCount=null}var s=i.prototype,o=[0,0];s.bind=function(a,c,r,n){this.vao.bind(),this.shader.bind();var d=this.shader.uniforms;d.model=a,d.view=c,d.projection=r,d.pixelScale=n,o[0]=this.gl.drawingBufferWidth,o[1]=this.gl.drawingBufferHeight,this.shader.uniforms.resolution=o},s.unbind=function(){this.vao.unbind()},s.update=function(a,c,r,n,d){var l=[];function y(L,k,C,M,P,O){var F=u[C];F||(F=u[C]={});var j=F[k];j||(j=F[k]=function(B,q){try{return p(B,q)}catch(ee){return console.warn('error vectorizing text:"'+B+'" error:',ee),{cells:[],positions:[]}}}(k,{triangles:!0,font:C,textAlign:"center",textBaseline:"middle",lineSpacing:P,styletags:O}));for(var W=(M||12)/12,Z=j.positions,Q=j.cells,X=0,G=Q.length;X<G;++X)for(var Y=Q[X],K=2;K>=0;--K){var D=Z[Y[K]];l.push(W*D[0],-W*D[1],L)}}for(var v=[0,0,0],_=[0,0,0],x=[0,0,0],T=[0,0,0],A={breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0},S=0;S<3;++S){x[S]=l.length/3|0,y(.5*(a[0][S]+a[1][S]),c[S],r[S],12,1.25,A),T[S]=(l.length/3|0)-x[S],v[S]=l.length/3|0;for(var w=0;w<n[S].length;++w)n[S][w].text&&y(n[S][w].x,n[S][w].text,n[S][w].font||d,n[S][w].fontSize||12,1.25,A);_[S]=(l.length/3|0)-v[S]}this.buffer.update(l),this.tickOffset=v,this.tickCount=_,this.labelOffset=x,this.labelCount=T},s.drawTicks=function(a,c,r,n,d,l,y,v){this.tickCount[a]&&(this.shader.uniforms.axis=l,this.shader.uniforms.color=d,this.shader.uniforms.angle=r,this.shader.uniforms.scale=c,this.shader.uniforms.offset=n,this.shader.uniforms.alignDir=y,this.shader.uniforms.alignOpt=v,this.vao.draw(this.gl.TRIANGLES,this.tickCount[a],this.tickOffset[a]))},s.drawLabel=function(a,c,r,n,d,l,y,v){this.labelCount[a]&&(this.shader.uniforms.axis=l,this.shader.uniforms.color=d,this.shader.uniforms.angle=r,this.shader.uniforms.scale=c,this.shader.uniforms.offset=n,this.shader.uniforms.alignDir=y,this.shader.uniforms.alignOpt=v,this.vao.draw(this.gl.TRIANGLES,this.labelCount[a],this.labelOffset[a]))},s.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()}}).call(this)}).call(this,h("_process"))},{"./shaders":257,_process:514,"gl-buffer":261,"gl-vao":353,"vectorize-text":607}],259:[function(h,N,H){function t(m,g){var p=m+"",e=p.indexOf("."),f=0;e>=0&&(f=p.length-e-1);var u=Math.pow(10,f),i=Math.round(m*g*u),s=i+"";if(s.indexOf("e")>=0)return s;var o=i/u,a=i%u;i<0?(o=0|-Math.ceil(o),a=0|-a):(o=0|Math.floor(o),a|=0);var c=""+o;if(i<0&&(c="-"+c),f){for(var r=""+a;r.length<f;)r="0"+r;return c+"."+r}return c}H.create=function(m,g){for(var p=[],e=0;e<3;++e){for(var f=[],u=(m[0][e],m[1][e],0);u*g[e]<=m[1][e];++u)f.push({x:u*g[e],text:t(g[e],u)});for(u=-1;u*g[e]>=m[0][e];--u)f.push({x:u*g[e],text:t(g[e],u)});p.push(f)}return p},H.equal=function(m,g){for(var p=0;p<3;++p){if(m[p].length!==g[p].length)return!1;for(var e=0;e<m[p].length;++e){var f=m[p][e],u=g[p][e];if(f.x!==u.x||f.text!==u.text||f.font!==u.font||f.fontColor!==u.fontColor||f.fontSize!==u.fontSize||f.dx!==u.dx||f.dy!==u.dy)return!1}}return!0}},{}],260:[function(h,N,H){N.exports=function(d,l,y,v,_){var x=l.model||u,T=l.view||u,A=l.projection||u,S=l._ortho||!1,w=d.bounds,L=(_=_||g(x,T,A,w,S)).axis;p(i,T,x),p(i,A,i);for(var k=r,C=0;C<3;++C)k[C].lo=1/0,k[C].hi=-1/0,k[C].pixelsPerDataUnit=1/0;var M=t(e(i,i));e(i,i);for(var P=0;P<3;++P){var O=(P+1)%3,F=(P+2)%3,j=n;e:for(C=0;C<2;++C){var W=[];if(L[P]<0!=!!C){j[P]=w[C][P];for(var Z=0;Z<2;++Z){j[O]=w[Z^C][O];for(var Q=0;Q<2;++Q)j[F]=w[Q^Z^C][F],W.push(j.slice())}var X=S?5:4;for(Z=X;Z===X;++Z){if(W.length===0)continue e;W=m.positive(W,M[Z])}for(Z=0;Z<W.length;++Z){F=W[Z];var G=c(n,i,F,y,v);for(Q=0;Q<3;++Q)k[Q].lo=Math.min(k[Q].lo,F[Q]),k[Q].hi=Math.max(k[Q].hi,F[Q]),Q!==P&&(k[Q].pixelsPerDataUnit=Math.min(k[Q].pixelsPerDataUnit,Math.abs(G[Q])))}}}}return k};var t=h("extract-frustum-planes"),m=h("split-polygon"),g=h("./lib/cube.js"),p=h("gl-mat4/multiply"),e=h("gl-mat4/transpose"),f=h("gl-vec4/transformMat4"),u=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),i=new Float32Array(16);function s(d,l,y){this.lo=d,this.hi=l,this.pixelsPerDataUnit=y}var o=[0,0,0,1],a=[0,0,0,1];function c(d,l,y,v,_){for(var x=0;x<3;++x){for(var T=o,A=a,S=0;S<3;++S)A[S]=T[S]=y[S];A[3]=T[3]=1,A[x]+=1,f(A,A,l),A[3]<0&&(d[x]=1/0),T[x]-=1,f(T,T,l),T[3]<0&&(d[x]=1/0);var w=(T[0]/T[3]-A[0]/A[3])*v,L=(T[1]/T[3]-A[1]/A[3])*_;d[x]=.25*Math.sqrt(w*w+L*L)}return d}var r=[new s(1/0,-1/0,1/0),new s(1/0,-1/0,1/0),new s(1/0,-1/0,1/0)],n=[0,0,0]},{"./lib/cube.js":255,"extract-frustum-planes":245,"gl-mat4/multiply":295,"gl-mat4/transpose":306,"gl-vec4/transformMat4":424,"split-polygon":552}],261:[function(h,N,H){var t=h("typedarray-pool"),m=h("ndarray-ops"),g=h("ndarray"),p=["uint8","uint8_clamped","uint16","uint32","int8","int16","int32","float32"];function e(s,o,a,c,r){this.gl=s,this.type=o,this.handle=a,this.length=c,this.usage=r}var f=e.prototype;function u(s,o,a,c,r,n){var d=r.length*r.BYTES_PER_ELEMENT;if(n<0)return s.bufferData(o,r,c),d;if(d+n>a)throw new Error("gl-buffer: If resizing buffer, must not specify offset");return s.bufferSubData(o,n,r),a}function i(s,o){for(var a=t.malloc(s.length,o),c=s.length,r=0;r<c;++r)a[r]=s[r];return a}f.bind=function(){this.gl.bindBuffer(this.type,this.handle)},f.unbind=function(){this.gl.bindBuffer(this.type,null)},f.dispose=function(){this.gl.deleteBuffer(this.handle)},f.update=function(s,o){if(typeof o!="number"&&(o=-1),this.bind(),typeof s=="object"&&s.shape!==void 0){var a=s.dtype;if(p.indexOf(a)<0&&(a="float32"),this.type===this.gl.ELEMENT_ARRAY_BUFFER&&(a=gl.getExtension("OES_element_index_uint")&&a!=="uint16"?"uint32":"uint16"),a===s.dtype&&function(d,l){for(var y=1,v=l.length-1;v>=0;--v){if(l[v]!==y)return!1;y*=d[v]}return!0}(s.shape,s.stride))s.offset===0&&s.data.length===s.shape[0]?this.length=u(this.gl,this.type,this.length,this.usage,s.data,o):this.length=u(this.gl,this.type,this.length,this.usage,s.data.subarray(s.offset,s.shape[0]),o);else{var c=t.malloc(s.size,a),r=g(c,s.shape);m.assign(r,s),this.length=u(this.gl,this.type,this.length,this.usage,o<0?c:c.subarray(0,s.size),o),t.free(c)}}else if(Array.isArray(s)){var n;n=this.type===this.gl.ELEMENT_ARRAY_BUFFER?i(s,"uint16"):i(s,"float32"),this.length=u(this.gl,this.type,this.length,this.usage,o<0?n:n.subarray(0,s.length),o),t.free(n)}else if(typeof s=="object"&&typeof s.length=="number")this.length=u(this.gl,this.type,this.length,this.usage,s,o);else{if(typeof s!="number"&&s!==void 0)throw new Error("gl-buffer: Invalid data type");if(o>=0)throw new Error("gl-buffer: Cannot specify offset when resizing buffer");(s|=0)<=0&&(s=1),this.gl.bufferData(this.type,0|s,this.usage),this.length=s}},N.exports=function(s,o,a,c){if(a=a||s.ARRAY_BUFFER,c=c||s.DYNAMIC_DRAW,a!==s.ARRAY_BUFFER&&a!==s.ELEMENT_ARRAY_BUFFER)throw new Error("gl-buffer: Invalid type for webgl buffer, must be either gl.ARRAY_BUFFER or gl.ELEMENT_ARRAY_BUFFER");if(c!==s.DYNAMIC_DRAW&&c!==s.STATIC_DRAW&&c!==s.STREAM_DRAW)throw new Error("gl-buffer: Invalid usage for buffer, must be either gl.DYNAMIC_DRAW, gl.STATIC_DRAW or gl.STREAM_DRAW");var r=s.createBuffer(),n=new e(s,a,r,0,c);return n.update(o),n}},{ndarray:472,"ndarray-ops":467,"typedarray-pool":601}],262:[function(h,N,H){var t=h("gl-vec3");N.exports=function(g,p){var e=g.positions,f=g.vectors,u={positions:[],vertexIntensity:[],vertexIntensityBounds:g.vertexIntensityBounds,vectors:[],cells:[],coneOffset:g.coneOffset,colormap:g.colormap};if(g.positions.length===0)return p&&(p[0]=[0,0,0],p[1]=[0,0,0]),u;for(var i=0,s=1/0,o=-1/0,a=1/0,c=-1/0,r=1/0,n=-1/0,d=null,l=null,y=[],v=1/0,_=!1,x=0;x<e.length;x++){var T=e[x];s=Math.min(T[0],s),o=Math.max(T[0],o),a=Math.min(T[1],a),c=Math.max(T[1],c),r=Math.min(T[2],r),n=Math.max(T[2],n);var A=f[x];if(t.length(A)>i&&(i=t.length(A)),x){var S=2*t.distance(d,T)/(t.length(l)+t.length(A));S?(v=Math.min(v,S),_=!1):_=!0}_||(d=T,l=A),y.push(A)}var w=[s,a,r],L=[o,c,n];p&&(p[0]=w,p[1]=L),i===0&&(i=1);var k=1/i;isFinite(v)||(v=1),u.vectorScale=v;var C=g.coneSize||.5;g.absoluteConeSize&&(C=g.absoluteConeSize*k),u.coneScale=C,x=0;for(var M=0;x<e.length;x++)for(var P=(T=e[x])[0],O=T[1],F=T[2],j=y[x],W=t.length(j)*k,Z=0;Z<8;Z++){u.positions.push([P,O,F,M++]),u.positions.push([P,O,F,M++]),u.positions.push([P,O,F,M++]),u.positions.push([P,O,F,M++]),u.positions.push([P,O,F,M++]),u.positions.push([P,O,F,M++]),u.vectors.push(j),u.vectors.push(j),u.vectors.push(j),u.vectors.push(j),u.vectors.push(j),u.vectors.push(j),u.vertexIntensity.push(W,W,W),u.vertexIntensity.push(W,W,W);var Q=u.positions.length;u.cells.push([Q-6,Q-5,Q-4],[Q-3,Q-2,Q-1])}return u};var m=h("./lib/shaders");N.exports.createMesh=h("./create_mesh"),N.exports.createConeMesh=function(g,p){return N.exports.createMesh(g,p,{shaders:m,traceType:"cone"})}},{"./create_mesh":263,"./lib/shaders":264,"gl-vec3":372}],263:[function(h,N,H){var t=h("gl-shader"),m=h("gl-buffer"),g=h("gl-vao"),p=h("gl-texture2d"),e=h("gl-mat4/multiply"),f=h("gl-mat4/invert"),u=h("ndarray"),i=h("colormap"),s=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function o(n,d,l,y,v,_,x,T,A,S,w){this.gl=n,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=d,this.dirty=!0,this.triShader=l,this.pickShader=y,this.trianglePositions=v,this.triangleVectors=_,this.triangleColors=T,this.triangleUVs=A,this.triangleIds=x,this.triangleVAO=S,this.triangleCount=0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.traceType=w,this.tubeScale=1,this.coneScale=2,this.vectorScale=1,this.coneOffset=.25,this._model=s,this._view=s,this._projection=s,this._resolution=[1,1]}var a=o.prototype;function c(n,d){var l=t(n,d.meshShader.vertex,d.meshShader.fragment,null,d.meshShader.attributes);return l.attributes.position.location=0,l.attributes.color.location=2,l.attributes.uv.location=3,l.attributes.vector.location=4,l}function r(n,d){var l=t(n,d.pickShader.vertex,d.pickShader.fragment,null,d.pickShader.attributes);return l.attributes.position.location=0,l.attributes.id.location=1,l.attributes.vector.location=4,l}a.isOpaque=function(){return this.opacity>=1},a.isTransparent=function(){return this.opacity<1},a.pickSlots=1,a.setPickBase=function(n){this.pickId=n},a.update=function(n){n=n||{};var d=this.gl;this.dirty=!0,"lightPosition"in n&&(this.lightPosition=n.lightPosition),"opacity"in n&&(this.opacity=n.opacity),"ambient"in n&&(this.ambientLight=n.ambient),"diffuse"in n&&(this.diffuseLight=n.diffuse),"specular"in n&&(this.specularLight=n.specular),"roughness"in n&&(this.roughness=n.roughness),"fresnel"in n&&(this.fresnel=n.fresnel),n.tubeScale!==void 0&&(this.tubeScale=n.tubeScale),n.vectorScale!==void 0&&(this.vectorScale=n.vectorScale),n.coneScale!==void 0&&(this.coneScale=n.coneScale),n.coneOffset!==void 0&&(this.coneOffset=n.coneOffset),n.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=d.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=d.LINEAR,this.texture.setPixels(function(K){for(var D=i({colormap:K,nshades:256,format:"rgba"}),B=new Uint8Array(1024),q=0;q<256;++q){for(var ee=D[q],J=0;J<3;++J)B[4*q+J]=ee[J];B[4*q+3]=255*ee[3]}return u(B,[256,256,4],[4,0,1])}(n.colormap)),this.texture.generateMipmap());var l=n.cells,y=n.positions,v=n.vectors;if(y&&l&&v){var _=[],x=[],T=[],A=[],S=[];this.cells=l,this.positions=y,this.vectors=v;var w=n.meshColor||[1,1,1,1],L=n.vertexIntensity,k=1/0,C=-1/0;if(L)if(n.vertexIntensityBounds)k=+n.vertexIntensityBounds[0],C=+n.vertexIntensityBounds[1];else for(var M=0;M<L.length;++M){var P=L[M];k=Math.min(k,P),C=Math.max(C,P)}else for(M=0;M<y.length;++M)P=y[M][2],k=Math.min(k,P),C=Math.max(C,P);for(this.intensity=L||function(K){for(var D=K.length,B=new Array(D),q=0;q<D;++q)B[q]=K[q][2];return B}(y),this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],M=0;M<y.length;++M)for(var O=y[M],F=0;F<3;++F)!isNaN(O[F])&&isFinite(O[F])&&(this.bounds[0][F]=Math.min(this.bounds[0][F],O[F]),this.bounds[1][F]=Math.max(this.bounds[1][F],O[F]));var j=0;e:for(M=0;M<l.length;++M){var W=l[M];switch(W.length){case 3:for(F=0;F<3;++F){O=y[Q=W[F]];for(var Z=0;Z<3;++Z)if(isNaN(O[Z])||!isFinite(O[Z]))continue e}for(F=0;F<3;++F){var Q;O=y[Q=W[2-F]],_.push(O[0],O[1],O[2],O[3]);var X=v[Q];x.push(X[0],X[1],X[2],X[3]||0);var G,Y=w;Y.length===3?T.push(Y[0],Y[1],Y[2],1):T.push(Y[0],Y[1],Y[2],Y[3]),G=L?[(L[Q]-k)/(C-k),0]:[(O[2]-k)/(C-k),0],A.push(G[0],G[1]),S.push(M)}j+=1}}this.triangleCount=j,this.trianglePositions.update(_),this.triangleVectors.update(x),this.triangleColors.update(T),this.triangleUVs.update(A),this.triangleIds.update(new Uint32Array(S))}},a.drawTransparent=a.draw=function(n){n=n||{};for(var d=this.gl,l=n.model||s,y=n.view||s,v=n.projection||s,_=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],x=0;x<3;++x)_[0][x]=Math.max(_[0][x],this.clipBounds[0][x]),_[1][x]=Math.min(_[1][x],this.clipBounds[1][x]);var T={model:l,view:y,projection:v,inverseModel:s.slice(),clipBounds:_,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],opacity:this.opacity,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,texture:0};T.inverseModel=f(T.inverseModel,T.model),d.disable(d.CULL_FACE),this.texture.bind(0);var A=new Array(16);for(e(A,T.view,T.model),e(A,T.projection,A),f(A,A),x=0;x<3;++x)T.eyePosition[x]=A[12+x]/A[15];var S=A[15];for(x=0;x<3;++x)S+=this.lightPosition[x]*A[4*x+3];for(x=0;x<3;++x){for(var w=A[12+x],L=0;L<3;++L)w+=A[4*L+x]*this.lightPosition[L];T.lightPosition[x]=w/S}if(this.triangleCount>0){var k=this.triShader;k.bind(),k.uniforms=T,this.triangleVAO.bind(),d.drawArrays(d.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()}},a.drawPick=function(n){n=n||{};for(var d=this.gl,l=n.model||s,y=n.view||s,v=n.projection||s,_=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],x=0;x<3;++x)_[0][x]=Math.max(_[0][x],this.clipBounds[0][x]),_[1][x]=Math.min(_[1][x],this.clipBounds[1][x]);this._model=[].slice.call(l),this._view=[].slice.call(y),this._projection=[].slice.call(v),this._resolution=[d.drawingBufferWidth,d.drawingBufferHeight];var T={model:l,view:y,projection:v,clipBounds:_,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,pickId:this.pickId/255},A=this.pickShader;A.bind(),A.uniforms=T,this.triangleCount>0&&(this.triangleVAO.bind(),d.drawArrays(d.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind())},a.pick=function(n){if(!n||n.id!==this.pickId)return null;var d=n.value[0]+256*n.value[1]+65536*n.value[2],l=this.cells[d],y=this.positions[l[1]].slice(0,3),v={position:y,dataCoordinate:y,index:Math.floor(l[1]/48)};return this.traceType==="cone"?v.index=Math.floor(l[1]/48):this.traceType==="streamtube"&&(v.intensity=this.intensity[l[1]],v.velocity=this.vectors[l[1]].slice(0,3),v.divergence=this.vectors[l[1]][3],v.index=d),v},a.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.pickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleVectors.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleIds.dispose()},N.exports=function(n,d,l){var y=l.shaders;arguments.length===1&&(n=(d=n).gl);var v=c(n,y),_=r(n,y),x=p(n,u(new Uint8Array([255,255,255,255]),[1,1,4]));x.generateMipmap(),x.minFilter=n.LINEAR_MIPMAP_LINEAR,x.magFilter=n.LINEAR;var T=m(n),A=m(n),S=m(n),w=m(n),L=m(n),k=g(n,[{buffer:T,type:n.FLOAT,size:4},{buffer:L,type:n.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:S,type:n.FLOAT,size:4},{buffer:w,type:n.FLOAT,size:2},{buffer:A,type:n.FLOAT,size:4}]),C=new o(n,x,v,_,T,A,L,S,w,k,l.traceType||"cone");return C.update(d),C}},{colormap:137,"gl-buffer":261,"gl-mat4/invert":293,"gl-mat4/multiply":295,"gl-shader":332,"gl-texture2d":348,"gl-vao":353,ndarray:472}],264:[function(h,N,H){var t=h("glslify"),m=t([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the cone vertex and normal at the given index.
//
// The returned vertex is for a cone with its top at origin and height of 1.0,
// pointing in the direction of the vector attribute.
//
// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.
// These vertices are used to make up the triangles of the cone by the following:
//   segment + 0 top vertex
//   segment + 1 perimeter vertex a+1
//   segment + 2 perimeter vertex a
//   segment + 3 center base vertex
//   segment + 4 perimeter vertex a
//   segment + 5 perimeter vertex a+1
// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.
// To go from index to segment, floor(index / 6)
// To go from segment to angle, 2*pi * (segment/segmentCount)
// To go from index to segment index, index - (segment*6)
//
vec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {

  const float segmentCount = 8.0;

  float index = rawIndex - floor(rawIndex /
    (segmentCount * 6.0)) *
    (segmentCount * 6.0);

  float segment = floor(0.001 + index/6.0);
  float segmentIndex = index - (segment*6.0);

  normal = -normalize(d);

  if (segmentIndex > 2.99 && segmentIndex < 3.01) {
    return mix(vec3(0.0), -d, coneOffset);
  }

  float nextAngle = (
    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||
    (segmentIndex > 4.99 &&  segmentIndex < 5.01)
  ) ? 1.0 : 0.0;
  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);

  vec3 v1 = mix(d, vec3(0.0), coneOffset);
  vec3 v2 = v1 - d;

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d)*0.25;
  vec3 y = v * sin(angle) * length(d)*0.25;
  vec3 v3 = v2 + x + y;
  if (segmentIndex < 3.0) {
    vec3 tx = u * sin(angle);
    vec3 ty = v * -cos(angle);
    vec3 tangent = tx + ty;
    normal = normalize(cross(v3 - v1, tangent));
  }

  if (segmentIndex == 0.0) {
    return mix(d, vec3(0.0), coneOffset);
  }
  return v3;
}

attribute vec3 vector;
attribute vec4 color, position;
attribute vec2 uv;

uniform float vectorScale, coneScale, coneOffset;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 eyePosition, lightPosition;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  // Scale the vector magnitude to stay constant with
  // model & view changes.
  vec3 normal;
  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector), position.w, coneOffset, normal);
  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * conePosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  // vec4 m_position  = model * vec4(conePosition, 1.0);
  vec4 t_position  = view * conePosition;
  gl_Position      = projection * t_position;

  f_color          = color;
  f_data           = conePosition.xyz;
  f_position       = position.xyz;
  f_uv             = uv;
}
`]),g=t([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform sampler2D texture;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;
  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = f_color * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * opacity;
}
`]),p=t([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the cone vertex and normal at the given index.
//
// The returned vertex is for a cone with its top at origin and height of 1.0,
// pointing in the direction of the vector attribute.
//
// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.
// These vertices are used to make up the triangles of the cone by the following:
//   segment + 0 top vertex
//   segment + 1 perimeter vertex a+1
//   segment + 2 perimeter vertex a
//   segment + 3 center base vertex
//   segment + 4 perimeter vertex a
//   segment + 5 perimeter vertex a+1
// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.
// To go from index to segment, floor(index / 6)
// To go from segment to angle, 2*pi * (segment/segmentCount)
// To go from index to segment index, index - (segment*6)
//
vec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {

  const float segmentCount = 8.0;

  float index = rawIndex - floor(rawIndex /
    (segmentCount * 6.0)) *
    (segmentCount * 6.0);

  float segment = floor(0.001 + index/6.0);
  float segmentIndex = index - (segment*6.0);

  normal = -normalize(d);

  if (segmentIndex > 2.99 && segmentIndex < 3.01) {
    return mix(vec3(0.0), -d, coneOffset);
  }

  float nextAngle = (
    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||
    (segmentIndex > 4.99 &&  segmentIndex < 5.01)
  ) ? 1.0 : 0.0;
  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);

  vec3 v1 = mix(d, vec3(0.0), coneOffset);
  vec3 v2 = v1 - d;

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d)*0.25;
  vec3 y = v * sin(angle) * length(d)*0.25;
  vec3 v3 = v2 + x + y;
  if (segmentIndex < 3.0) {
    vec3 tx = u * sin(angle);
    vec3 ty = v * -cos(angle);
    vec3 tangent = tx + ty;
    normal = normalize(cross(v3 - v1, tangent));
  }

  if (segmentIndex == 0.0) {
    return mix(d, vec3(0.0), coneOffset);
  }
  return v3;
}

attribute vec4 vector;
attribute vec4 position;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform float vectorScale, coneScale, coneOffset;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  vec3 normal;
  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector.xyz), position.w, coneOffset, normal);
  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);
  gl_Position = projection * view * conePosition;
  f_id        = id;
  f_position  = position.xyz;
}
`]),e=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]);H.meshShader={vertex:m,fragment:g,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec3"}]},H.pickShader={vertex:p,fragment:e,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec3"}]}},{glslify:434}],265:[function(h,N,H){N.exports={0:"NONE",1:"ONE",2:"LINE_LOOP",3:"LINE_STRIP",4:"TRIANGLES",5:"TRIANGLE_STRIP",6:"TRIANGLE_FAN",256:"DEPTH_BUFFER_BIT",512:"NEVER",513:"LESS",514:"EQUAL",515:"LEQUAL",516:"GREATER",517:"NOTEQUAL",518:"GEQUAL",519:"ALWAYS",768:"SRC_COLOR",769:"ONE_MINUS_SRC_COLOR",770:"SRC_ALPHA",771:"ONE_MINUS_SRC_ALPHA",772:"DST_ALPHA",773:"ONE_MINUS_DST_ALPHA",774:"DST_COLOR",775:"ONE_MINUS_DST_COLOR",776:"SRC_ALPHA_SATURATE",1024:"STENCIL_BUFFER_BIT",1028:"FRONT",1029:"BACK",1032:"FRONT_AND_BACK",1280:"INVALID_ENUM",1281:"INVALID_VALUE",1282:"INVALID_OPERATION",1285:"OUT_OF_MEMORY",1286:"INVALID_FRAMEBUFFER_OPERATION",2304:"CW",2305:"CCW",2849:"LINE_WIDTH",2884:"CULL_FACE",2885:"CULL_FACE_MODE",2886:"FRONT_FACE",2928:"DEPTH_RANGE",2929:"DEPTH_TEST",2930:"DEPTH_WRITEMASK",2931:"DEPTH_CLEAR_VALUE",2932:"DEPTH_FUNC",2960:"STENCIL_TEST",2961:"STENCIL_CLEAR_VALUE",2962:"STENCIL_FUNC",2963:"STENCIL_VALUE_MASK",2964:"STENCIL_FAIL",2965:"STENCIL_PASS_DEPTH_FAIL",2966:"STENCIL_PASS_DEPTH_PASS",2967:"STENCIL_REF",2968:"STENCIL_WRITEMASK",2978:"VIEWPORT",3024:"DITHER",3042:"BLEND",3088:"SCISSOR_BOX",3089:"SCISSOR_TEST",3106:"COLOR_CLEAR_VALUE",3107:"COLOR_WRITEMASK",3317:"UNPACK_ALIGNMENT",3333:"PACK_ALIGNMENT",3379:"MAX_TEXTURE_SIZE",3386:"MAX_VIEWPORT_DIMS",3408:"SUBPIXEL_BITS",3410:"RED_BITS",3411:"GREEN_BITS",3412:"BLUE_BITS",3413:"ALPHA_BITS",3414:"DEPTH_BITS",3415:"STENCIL_BITS",3553:"TEXTURE_2D",4352:"DONT_CARE",4353:"FASTEST",4354:"NICEST",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT",5386:"INVERT",5890:"TEXTURE",6401:"STENCIL_INDEX",6402:"DEPTH_COMPONENT",6406:"ALPHA",6407:"RGB",6408:"RGBA",6409:"LUMINANCE",6410:"LUMINANCE_ALPHA",7680:"KEEP",7681:"REPLACE",7682:"INCR",7683:"DECR",7936:"VENDOR",7937:"RENDERER",7938:"VERSION",9728:"NEAREST",9729:"LINEAR",9984:"NEAREST_MIPMAP_NEAREST",9985:"LINEAR_MIPMAP_NEAREST",9986:"NEAREST_MIPMAP_LINEAR",9987:"LINEAR_MIPMAP_LINEAR",10240:"TEXTURE_MAG_FILTER",10241:"TEXTURE_MIN_FILTER",10242:"TEXTURE_WRAP_S",10243:"TEXTURE_WRAP_T",10497:"REPEAT",10752:"POLYGON_OFFSET_UNITS",16384:"COLOR_BUFFER_BIT",32769:"CONSTANT_COLOR",32770:"ONE_MINUS_CONSTANT_COLOR",32771:"CONSTANT_ALPHA",32772:"ONE_MINUS_CONSTANT_ALPHA",32773:"BLEND_COLOR",32774:"FUNC_ADD",32777:"BLEND_EQUATION_RGB",32778:"FUNC_SUBTRACT",32779:"FUNC_REVERSE_SUBTRACT",32819:"UNSIGNED_SHORT_4_4_4_4",32820:"UNSIGNED_SHORT_5_5_5_1",32823:"POLYGON_OFFSET_FILL",32824:"POLYGON_OFFSET_FACTOR",32854:"RGBA4",32855:"RGB5_A1",32873:"TEXTURE_BINDING_2D",32926:"SAMPLE_ALPHA_TO_COVERAGE",32928:"SAMPLE_COVERAGE",32936:"SAMPLE_BUFFERS",32937:"SAMPLES",32938:"SAMPLE_COVERAGE_VALUE",32939:"SAMPLE_COVERAGE_INVERT",32968:"BLEND_DST_RGB",32969:"BLEND_SRC_RGB",32970:"BLEND_DST_ALPHA",32971:"BLEND_SRC_ALPHA",33071:"CLAMP_TO_EDGE",33170:"GENERATE_MIPMAP_HINT",33189:"DEPTH_COMPONENT16",33306:"DEPTH_STENCIL_ATTACHMENT",33635:"UNSIGNED_SHORT_5_6_5",33648:"MIRRORED_REPEAT",33901:"ALIASED_POINT_SIZE_RANGE",33902:"ALIASED_LINE_WIDTH_RANGE",33984:"TEXTURE0",33985:"TEXTURE1",33986:"TEXTURE2",33987:"TEXTURE3",33988:"TEXTURE4",33989:"TEXTURE5",33990:"TEXTURE6",33991:"TEXTURE7",33992:"TEXTURE8",33993:"TEXTURE9",33994:"TEXTURE10",33995:"TEXTURE11",33996:"TEXTURE12",33997:"TEXTURE13",33998:"TEXTURE14",33999:"TEXTURE15",34e3:"TEXTURE16",34001:"TEXTURE17",34002:"TEXTURE18",34003:"TEXTURE19",34004:"TEXTURE20",34005:"TEXTURE21",34006:"TEXTURE22",34007:"TEXTURE23",34008:"TEXTURE24",34009:"TEXTURE25",34010:"TEXTURE26",34011:"TEXTURE27",34012:"TEXTURE28",34013:"TEXTURE29",34014:"TEXTURE30",34015:"TEXTURE31",34016:"ACTIVE_TEXTURE",34024:"MAX_RENDERBUFFER_SIZE",34041:"DEPTH_STENCIL",34055:"INCR_WRAP",34056:"DECR_WRAP",34067:"TEXTURE_CUBE_MAP",34068:"TEXTURE_BINDING_CUBE_MAP",34069:"TEXTURE_CUBE_MAP_POSITIVE_X",34070:"TEXTURE_CUBE_MAP_NEGATIVE_X",34071:"TEXTURE_CUBE_MAP_POSITIVE_Y",34072:"TEXTURE_CUBE_MAP_NEGATIVE_Y",34073:"TEXTURE_CUBE_MAP_POSITIVE_Z",34074:"TEXTURE_CUBE_MAP_NEGATIVE_Z",34076:"MAX_CUBE_MAP_TEXTURE_SIZE",34338:"VERTEX_ATTRIB_ARRAY_ENABLED",34339:"VERTEX_ATTRIB_ARRAY_SIZE",34340:"VERTEX_ATTRIB_ARRAY_STRIDE",34341:"VERTEX_ATTRIB_ARRAY_TYPE",34342:"CURRENT_VERTEX_ATTRIB",34373:"VERTEX_ATTRIB_ARRAY_POINTER",34466:"NUM_COMPRESSED_TEXTURE_FORMATS",34467:"COMPRESSED_TEXTURE_FORMATS",34660:"BUFFER_SIZE",34661:"BUFFER_USAGE",34816:"STENCIL_BACK_FUNC",34817:"STENCIL_BACK_FAIL",34818:"STENCIL_BACK_PASS_DEPTH_FAIL",34819:"STENCIL_BACK_PASS_DEPTH_PASS",34877:"BLEND_EQUATION_ALPHA",34921:"MAX_VERTEX_ATTRIBS",34922:"VERTEX_ATTRIB_ARRAY_NORMALIZED",34930:"MAX_TEXTURE_IMAGE_UNITS",34962:"ARRAY_BUFFER",34963:"ELEMENT_ARRAY_BUFFER",34964:"ARRAY_BUFFER_BINDING",34965:"ELEMENT_ARRAY_BUFFER_BINDING",34975:"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",35040:"STREAM_DRAW",35044:"STATIC_DRAW",35048:"DYNAMIC_DRAW",35632:"FRAGMENT_SHADER",35633:"VERTEX_SHADER",35660:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",35661:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",35663:"SHADER_TYPE",35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",35712:"DELETE_STATUS",35713:"COMPILE_STATUS",35714:"LINK_STATUS",35715:"VALIDATE_STATUS",35716:"INFO_LOG_LENGTH",35717:"ATTACHED_SHADERS",35718:"ACTIVE_UNIFORMS",35719:"ACTIVE_UNIFORM_MAX_LENGTH",35720:"SHADER_SOURCE_LENGTH",35721:"ACTIVE_ATTRIBUTES",35722:"ACTIVE_ATTRIBUTE_MAX_LENGTH",35724:"SHADING_LANGUAGE_VERSION",35725:"CURRENT_PROGRAM",36003:"STENCIL_BACK_REF",36004:"STENCIL_BACK_VALUE_MASK",36005:"STENCIL_BACK_WRITEMASK",36006:"FRAMEBUFFER_BINDING",36007:"RENDERBUFFER_BINDING",36048:"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",36049:"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",36050:"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",36051:"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",36053:"FRAMEBUFFER_COMPLETE",36054:"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",36055:"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",36057:"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",36061:"FRAMEBUFFER_UNSUPPORTED",36064:"COLOR_ATTACHMENT0",36096:"DEPTH_ATTACHMENT",36128:"STENCIL_ATTACHMENT",36160:"FRAMEBUFFER",36161:"RENDERBUFFER",36162:"RENDERBUFFER_WIDTH",36163:"RENDERBUFFER_HEIGHT",36164:"RENDERBUFFER_INTERNAL_FORMAT",36168:"STENCIL_INDEX8",36176:"RENDERBUFFER_RED_SIZE",36177:"RENDERBUFFER_GREEN_SIZE",36178:"RENDERBUFFER_BLUE_SIZE",36179:"RENDERBUFFER_ALPHA_SIZE",36180:"RENDERBUFFER_DEPTH_SIZE",36181:"RENDERBUFFER_STENCIL_SIZE",36194:"RGB565",36336:"LOW_FLOAT",36337:"MEDIUM_FLOAT",36338:"HIGH_FLOAT",36339:"LOW_INT",36340:"MEDIUM_INT",36341:"HIGH_INT",36346:"SHADER_COMPILER",36347:"MAX_VERTEX_UNIFORM_VECTORS",36348:"MAX_VARYING_VECTORS",36349:"MAX_FRAGMENT_UNIFORM_VECTORS",37440:"UNPACK_FLIP_Y_WEBGL",37441:"UNPACK_PREMULTIPLY_ALPHA_WEBGL",37442:"CONTEXT_LOST_WEBGL",37443:"UNPACK_COLORSPACE_CONVERSION_WEBGL",37444:"BROWSER_DEFAULT_WEBGL"}},{}],266:[function(h,N,H){var t=h("./1.0/numbers");N.exports=function(m){return t[m]}},{"./1.0/numbers":265}],267:[function(h,N,H){N.exports=function(o){var a=o.gl,c=t(a),r=m(a,[{buffer:c,type:a.FLOAT,size:3,offset:0,stride:40},{buffer:c,type:a.FLOAT,size:4,offset:12,stride:40},{buffer:c,type:a.FLOAT,size:3,offset:28,stride:40}]),n=g(a);n.attributes.position.location=0,n.attributes.color.location=1,n.attributes.offset.location=2;var d=new e(a,c,r,n);return d.update(o),d};var t=h("gl-buffer"),m=h("gl-vao"),g=h("./shaders/index"),p=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function e(o,a,c,r){this.gl=o,this.shader=r,this.buffer=a,this.vao=c,this.pixelRatio=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lineWidth=[1,1,1],this.capSize=[10,10,10],this.lineCount=[0,0,0],this.lineOffset=[0,0,0],this.opacity=1,this.hasAlpha=!1}var f=e.prototype;function u(o,a){for(var c=0;c<3;++c)o[0][c]=Math.min(o[0][c],a[c]),o[1][c]=Math.max(o[1][c],a[c])}f.isOpaque=function(){return!this.hasAlpha},f.isTransparent=function(){return this.hasAlpha},f.drawTransparent=f.draw=function(o){var a=this.gl,c=this.shader.uniforms;this.shader.bind();var r=c.view=o.view||p,n=c.projection=o.projection||p;c.model=o.model||p,c.clipBounds=this.clipBounds,c.opacity=this.opacity;var d=r[12],l=r[13],y=r[14],v=r[15],_=(o._ortho?2:1)*this.pixelRatio*(n[3]*d+n[7]*l+n[11]*y+n[15]*v)/a.drawingBufferHeight;this.vao.bind();for(var x=0;x<3;++x)a.lineWidth(this.lineWidth[x]*this.pixelRatio),c.capSize=this.capSize[x]*_,this.lineCount[x]&&a.drawArrays(a.LINES,this.lineOffset[x],this.lineCount[x]);this.vao.unbind()};var i=function(){for(var o=new Array(3),a=0;a<3;++a){for(var c=[],r=1;r<=2;++r)for(var n=-1;n<=1;n+=2){var d=[0,0,0];d[(r+a)%3]=n,c.push(d)}o[a]=c}return o}();function s(o,a,c,r){for(var n=i[r],d=0;d<n.length;++d){var l=n[d];o.push(a[0],a[1],a[2],c[0],c[1],c[2],c[3],l[0],l[1],l[2])}return n.length}f.update=function(o){"lineWidth"in(o=o||{})&&(this.lineWidth=o.lineWidth,Array.isArray(this.lineWidth)||(this.lineWidth=[this.lineWidth,this.lineWidth,this.lineWidth])),"capSize"in o&&(this.capSize=o.capSize,Array.isArray(this.capSize)||(this.capSize=[this.capSize,this.capSize,this.capSize])),this.hasAlpha=!1,"opacity"in o&&(this.opacity=+o.opacity,this.opacity<1&&(this.hasAlpha=!0));var a=o.color||[[0,0,0],[0,0,0],[0,0,0]],c=o.position,r=o.error;if(Array.isArray(a[0])||(a=[a,a,a]),c&&r){var n=[],d=c.length,l=0;this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.lineCount=[0,0,0];for(var y=0;y<3;++y){this.lineOffset[y]=l;e:for(var v=0;v<d;++v){for(var _=c[v],x=0;x<3;++x)if(isNaN(_[x])||!isFinite(_[x]))continue e;var T=r[v],A=a[y];if(Array.isArray(A[0])&&(A=a[v]),A.length===3?A=[A[0],A[1],A[2],1]:A.length===4&&(A=[A[0],A[1],A[2],A[3]],!this.hasAlpha&&A[3]<1&&(this.hasAlpha=!0)),!isNaN(T[0][y])&&!isNaN(T[1][y])){var S;T[0][y]<0&&((S=_.slice())[y]+=T[0][y],n.push(_[0],_[1],_[2],A[0],A[1],A[2],A[3],0,0,0,S[0],S[1],S[2],A[0],A[1],A[2],A[3],0,0,0),u(this.bounds,S),l+=2+s(n,S,A,y)),T[1][y]>0&&((S=_.slice())[y]+=T[1][y],n.push(_[0],_[1],_[2],A[0],A[1],A[2],A[3],0,0,0,S[0],S[1],S[2],A[0],A[1],A[2],A[3],0,0,0),u(this.bounds,S),l+=2+s(n,S,A,y))}}this.lineCount[y]=l-this.lineOffset[y]}this.buffer.update(n)}},f.dispose=function(){this.shader.dispose(),this.buffer.dispose(),this.vao.dispose()}},{"./shaders/index":269,"gl-buffer":261,"gl-vao":353}],268:[function(h,N,H){N.exports=function(t){typeof t=="string"&&(t=[t]);for(var m=[].slice.call(arguments,1),g=[],p=0;p<t.length-1;p++)g.push(t[p],m[p]||"");return g.push(t[p]),g.join("")}},{}],269:[function(h,N,H){var t=h("glslify"),m=h("gl-shader"),g=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, offset;
attribute vec4 color;
uniform mat4 model, view, projection;
uniform float capSize;
varying vec4 fragColor;
varying vec3 fragPosition;

void main() {
  vec4 worldPosition  = model * vec4(position, 1.0);
  worldPosition       = (worldPosition / worldPosition.w) + vec4(capSize * offset, 0.0);
  gl_Position         = projection * view * worldPosition;
  fragColor           = color;
  fragPosition        = position;
}`]),p=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float opacity;
varying vec3 fragPosition;
varying vec4 fragColor;

void main() {
  if (
    outOfRange(clipBounds[0], clipBounds[1], fragPosition) ||
    fragColor.a * opacity == 0.
  ) discard;

  gl_FragColor = opacity * fragColor;
}`]);N.exports=function(e){return m(e,g,p,null,[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"offset",type:"vec3"}])}},{"gl-shader":332,glslify:268}],270:[function(h,N,H){var t=h("gl-texture2d");N.exports=function(d,l,y,v){m||(m=d.FRAMEBUFFER_UNSUPPORTED,g=d.FRAMEBUFFER_INCOMPLETE_ATTACHMENT,p=d.FRAMEBUFFER_INCOMPLETE_DIMENSIONS,e=d.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT);var _=d.getExtension("WEBGL_draw_buffers");if(!f&&_&&function(k,C){var M=k.getParameter(C.MAX_COLOR_ATTACHMENTS_WEBGL);f=new Array(M+1);for(var P=0;P<=M;++P){for(var O=new Array(M),F=0;F<P;++F)O[F]=k.COLOR_ATTACHMENT0+F;for(F=P;F<M;++F)O[F]=k.NONE;f[P]=O}}(d,_),Array.isArray(l)&&(v=y,y=0|l[1],l=0|l[0]),typeof l!="number")throw new Error("gl-fbo: Missing shape parameter");var x=d.getParameter(d.MAX_RENDERBUFFER_SIZE);if(l<0||l>x||y<0||y>x)throw new Error("gl-fbo: Parameters are too large for FBO");var T=1;if("color"in(v=v||{})){if((T=Math.max(0|v.color,0))<0)throw new Error("gl-fbo: Must specify a nonnegative number of colors");if(T>1){if(!_)throw new Error("gl-fbo: Multiple draw buffer extension not supported");if(T>d.getParameter(_.MAX_COLOR_ATTACHMENTS_WEBGL))throw new Error("gl-fbo: Context does not support "+T+" draw buffers")}}var A=d.UNSIGNED_BYTE,S=d.getExtension("OES_texture_float");if(v.float&&T>0){if(!S)throw new Error("gl-fbo: Context does not support floating point textures");A=d.FLOAT}else v.preferFloat&&T>0&&S&&(A=d.FLOAT);var w=!0;"depth"in v&&(w=!!v.depth);var L=!1;return"stencil"in v&&(L=!!v.stencil),new c(d,l,y,A,T,w,L,_)};var m,g,p,e,f=null;function u(d){return[d.getParameter(d.FRAMEBUFFER_BINDING),d.getParameter(d.RENDERBUFFER_BINDING),d.getParameter(d.TEXTURE_BINDING_2D)]}function i(d,l){d.bindFramebuffer(d.FRAMEBUFFER,l[0]),d.bindRenderbuffer(d.RENDERBUFFER,l[1]),d.bindTexture(d.TEXTURE_2D,l[2])}function s(d){switch(d){case m:throw new Error("gl-fbo: Framebuffer unsupported");case g:throw new Error("gl-fbo: Framebuffer incomplete attachment");case p:throw new Error("gl-fbo: Framebuffer incomplete dimensions");case e:throw new Error("gl-fbo: Framebuffer incomplete missing attachment");default:throw new Error("gl-fbo: Framebuffer failed for unspecified reason")}}function o(d,l,y,v,_,x){if(!v)return null;var T=t(d,l,y,_,v);return T.magFilter=d.NEAREST,T.minFilter=d.NEAREST,T.mipSamples=1,T.bind(),d.framebufferTexture2D(d.FRAMEBUFFER,x,d.TEXTURE_2D,T.handle,0),T}function a(d,l,y,v,_){var x=d.createRenderbuffer();return d.bindRenderbuffer(d.RENDERBUFFER,x),d.renderbufferStorage(d.RENDERBUFFER,v,l,y),d.framebufferRenderbuffer(d.FRAMEBUFFER,_,d.RENDERBUFFER,x),x}function c(d,l,y,v,_,x,T,A){this.gl=d,this._shape=[0|l,0|y],this._destroyed=!1,this._ext=A,this.color=new Array(_);for(var S=0;S<_;++S)this.color[S]=null;this._color_rb=null,this.depth=null,this._depth_rb=null,this._colorType=v,this._useDepth=x,this._useStencil=T;var w=this,L=[0|l,0|y];Object.defineProperties(L,{0:{get:function(){return w._shape[0]},set:function(k){return w.width=k}},1:{get:function(){return w._shape[1]},set:function(k){return w.height=k}}}),this._shapeVector=L,function(k){var C=u(k.gl),M=k.gl,P=k.handle=M.createFramebuffer(),O=k._shape[0],F=k._shape[1],j=k.color.length,W=k._ext,Z=k._useStencil,Q=k._useDepth,X=k._colorType;M.bindFramebuffer(M.FRAMEBUFFER,P);for(var G=0;G<j;++G)k.color[G]=o(M,O,F,X,M.RGBA,M.COLOR_ATTACHMENT0+G);j===0?(k._color_rb=a(M,O,F,M.RGBA4,M.COLOR_ATTACHMENT0),W&&W.drawBuffersWEBGL(f[0])):j>1&&W.drawBuffersWEBGL(f[j]);var Y=M.getExtension("WEBGL_depth_texture");Y?Z?k.depth=o(M,O,F,Y.UNSIGNED_INT_24_8_WEBGL,M.DEPTH_STENCIL,M.DEPTH_STENCIL_ATTACHMENT):Q&&(k.depth=o(M,O,F,M.UNSIGNED_SHORT,M.DEPTH_COMPONENT,M.DEPTH_ATTACHMENT)):Q&&Z?k._depth_rb=a(M,O,F,M.DEPTH_STENCIL,M.DEPTH_STENCIL_ATTACHMENT):Q?k._depth_rb=a(M,O,F,M.DEPTH_COMPONENT16,M.DEPTH_ATTACHMENT):Z&&(k._depth_rb=a(M,O,F,M.STENCIL_INDEX,M.STENCIL_ATTACHMENT));var K=M.checkFramebufferStatus(M.FRAMEBUFFER);if(K!==M.FRAMEBUFFER_COMPLETE){for(k._destroyed=!0,M.bindFramebuffer(M.FRAMEBUFFER,null),M.deleteFramebuffer(k.handle),k.handle=null,k.depth&&(k.depth.dispose(),k.depth=null),k._depth_rb&&(M.deleteRenderbuffer(k._depth_rb),k._depth_rb=null),G=0;G<k.color.length;++G)k.color[G].dispose(),k.color[G]=null;k._color_rb&&(M.deleteRenderbuffer(k._color_rb),k._color_rb=null),i(M,C),s(K)}i(M,C)}(this)}var r=c.prototype;function n(d,l,y){if(d._destroyed)throw new Error("gl-fbo: Can't resize destroyed FBO");if(d._shape[0]!==l||d._shape[1]!==y){var v=d.gl,_=v.getParameter(v.MAX_RENDERBUFFER_SIZE);if(l<0||l>_||y<0||y>_)throw new Error("gl-fbo: Can't resize FBO, invalid dimensions");d._shape[0]=l,d._shape[1]=y;for(var x=u(v),T=0;T<d.color.length;++T)d.color[T].shape=d._shape;d._color_rb&&(v.bindRenderbuffer(v.RENDERBUFFER,d._color_rb),v.renderbufferStorage(v.RENDERBUFFER,v.RGBA4,d._shape[0],d._shape[1])),d.depth&&(d.depth.shape=d._shape),d._depth_rb&&(v.bindRenderbuffer(v.RENDERBUFFER,d._depth_rb),d._useDepth&&d._useStencil?v.renderbufferStorage(v.RENDERBUFFER,v.DEPTH_STENCIL,d._shape[0],d._shape[1]):d._useDepth?v.renderbufferStorage(v.RENDERBUFFER,v.DEPTH_COMPONENT16,d._shape[0],d._shape[1]):d._useStencil&&v.renderbufferStorage(v.RENDERBUFFER,v.STENCIL_INDEX,d._shape[0],d._shape[1])),v.bindFramebuffer(v.FRAMEBUFFER,d.handle);var A=v.checkFramebufferStatus(v.FRAMEBUFFER);A!==v.FRAMEBUFFER_COMPLETE&&(d.dispose(),i(v,x),s(A)),i(v,x)}}Object.defineProperties(r,{shape:{get:function(){return this._destroyed?[0,0]:this._shapeVector},set:function(d){if(Array.isArray(d)||(d=[0|d,0|d]),d.length!==2)throw new Error("gl-fbo: Shape vector must be length 2");var l=0|d[0],y=0|d[1];return n(this,l,y),[l,y]},enumerable:!1},width:{get:function(){return this._destroyed?0:this._shape[0]},set:function(d){return n(this,d|=0,this._shape[1]),d},enumerable:!1},height:{get:function(){return this._destroyed?0:this._shape[1]},set:function(d){return d|=0,n(this,this._shape[0],d),d},enumerable:!1}}),r.bind=function(){if(!this._destroyed){var d=this.gl;d.bindFramebuffer(d.FRAMEBUFFER,this.handle),d.viewport(0,0,this._shape[0],this._shape[1])}},r.dispose=function(){if(!this._destroyed){this._destroyed=!0;var d=this.gl;d.deleteFramebuffer(this.handle),this.handle=null,this.depth&&(this.depth.dispose(),this.depth=null),this._depth_rb&&(d.deleteRenderbuffer(this._depth_rb),this._depth_rb=null);for(var l=0;l<this.color.length;++l)this.color[l].dispose(),this.color[l]=null;this._color_rb&&(d.deleteRenderbuffer(this._color_rb),this._color_rb=null)}}},{"gl-texture2d":348}],271:[function(h,N,H){var t=h("sprintf-js").sprintf,m=h("gl-constants/lookup"),g=h("glsl-shader-name"),p=h("add-line-numbers");N.exports=function(e,f,u){var i=g(f)||"of unknown name (see npm glsl-shader-name)",s="unknown type";u!==void 0&&(s=u===m.FRAGMENT_SHADER?"fragment":"vertex");for(var o=t(`Error compiling %s shader %s:
`,s,i),a=t("%s%s",o,e),c=e.split(`
`),r={},n=0;n<c.length;n++){var d=c[n];if(d!==""&&d!=="\0"){var l=parseInt(d.split(":")[2]);if(isNaN(l))throw new Error(t("Could not parse error: %s",d));r[l]=d}}var y=p(f).split(`
`);for(n=0;n<y.length;n++)if(r[n+3]||r[n+2]||r[n+1]){var v=y[n];if(o+=v+`
`,r[n+1]){var _=r[n+1];_=_.substr(_.split(":",3).join(":").length+1).trim(),o+=t(`^^^ %s

`,_)}}return{long:o.trim(),short:a.trim()}}},{"add-line-numbers":72,"gl-constants/lookup":266,"glsl-shader-name":426,"sprintf-js":553}],272:[function(h,N,H){N.exports=function(a,c){var r=a.gl,n=p(r,f.vertex,f.fragment),d=p(r,f.pickVertex,f.pickFragment),l=e(r),y=e(r),v=e(r),_=e(r),x=new u(a,n,d,l,y,v,_);return x.update(c),a.addObject(x),x};var t=h("binary-search-bounds"),m=h("iota-array"),g=h("typedarray-pool"),p=h("gl-shader"),e=h("gl-buffer"),f=h("./lib/shaders");function u(a,c,r,n,d,l,y){this.plot=a,this.shader=c,this.pickShader=r,this.positionBuffer=n,this.weightBuffer=d,this.colorBuffer=l,this.idBuffer=y,this.xData=[],this.yData=[],this.shape=[0,0],this.bounds=[1/0,1/0,-1/0,-1/0],this.pickOffset=0}var i,s=u.prototype,o=[0,0,1,0,0,1,1,0,1,1,0,1];s.draw=(i=[1,0,0,0,1,0,0,0,1],function(){var a=this.plot,c=this.shader,r=this.bounds,n=this.numVertices;if(!(n<=0)){var d=a.gl,l=a.dataBox,y=r[2]-r[0],v=r[3]-r[1],_=l[2]-l[0],x=l[3]-l[1];i[0]=2*y/_,i[4]=2*v/x,i[6]=2*(r[0]-l[0])/_-1,i[7]=2*(r[1]-l[1])/x-1,c.bind();var T=c.uniforms;T.viewTransform=i,T.shape=this.shape;var A=c.attributes;this.positionBuffer.bind(),A.position.pointer(),this.weightBuffer.bind(),A.weight.pointer(d.UNSIGNED_BYTE,!1),this.colorBuffer.bind(),A.color.pointer(d.UNSIGNED_BYTE,!0),d.drawArrays(d.TRIANGLES,0,n)}}),s.drawPick=function(){var a=[1,0,0,0,1,0,0,0,1],c=[0,0,0,0];return function(r){var n=this.plot,d=this.pickShader,l=this.bounds,y=this.numVertices;if(!(y<=0)){var v=n.gl,_=n.dataBox,x=l[2]-l[0],T=l[3]-l[1],A=_[2]-_[0],S=_[3]-_[1];a[0]=2*x/A,a[4]=2*T/S,a[6]=2*(l[0]-_[0])/A-1,a[7]=2*(l[1]-_[1])/S-1;for(var w=0;w<4;++w)c[w]=r>>8*w&255;this.pickOffset=r,d.bind();var L=d.uniforms;L.viewTransform=a,L.pickOffset=c,L.shape=this.shape;var k=d.attributes;return this.positionBuffer.bind(),k.position.pointer(),this.weightBuffer.bind(),k.weight.pointer(v.UNSIGNED_BYTE,!1),this.idBuffer.bind(),k.pickId.pointer(v.UNSIGNED_BYTE,!1),v.drawArrays(v.TRIANGLES,0,y),r+this.shape[0]*this.shape[1]}}}(),s.pick=function(a,c,r){var n=this.pickOffset,d=this.shape[0]*this.shape[1];if(r<n||r>=n+d)return null;var l=r-n,y=this.xData,v=this.yData;return{object:this,pointId:l,dataCoord:[y[l%this.shape[0]],v[l/this.shape[0]|0]]}},s.update=function(a){var c=(a=a||{}).shape||[0,0],r=a.x||m(c[0]),n=a.y||m(c[1]),d=a.z||new Float32Array(c[0]*c[1]),l=a.zsmooth!==!1;this.xData=r,this.yData=n;var y,v,_,x,T=a.colorLevels||[0],A=a.colorValues||[0,0,0,1],S=T.length,w=this.bounds;l?(y=w[0]=r[0],v=w[1]=n[0],_=w[2]=r[r.length-1],x=w[3]=n[n.length-1]):(y=w[0]=r[0]+(r[1]-r[0])/2,v=w[1]=n[0]+(n[1]-n[0])/2,_=w[2]=r[r.length-1]+(r[r.length-1]-r[r.length-2])/2,x=w[3]=n[n.length-1]+(n[n.length-1]-n[n.length-2])/2);var L=1/(_-y),k=1/(x-v),C=c[0],M=c[1];this.shape=[C,M];var P=(l?(C-1)*(M-1):C*M)*(o.length>>>1);this.numVertices=P;for(var O=g.mallocUint8(4*P),F=g.mallocFloat32(2*P),j=g.mallocUint8(2*P),W=g.mallocUint32(P),Z=0,Q=l?C-1:C,X=l?M-1:M,G=0;G<X;++G){var Y,K;l?(Y=k*(n[G]-v),K=k*(n[G+1]-v)):(Y=G<M-1?k*(n[G]-(n[G+1]-n[G])/2-v):k*(n[G]-(n[G]-n[G-1])/2-v),K=G<M-1?k*(n[G]+(n[G+1]-n[G])/2-v):k*(n[G]+(n[G]-n[G-1])/2-v));for(var D=0;D<Q;++D){var B,q;l?(B=L*(r[D]-y),q=L*(r[D+1]-y)):(B=D<C-1?L*(r[D]-(r[D+1]-r[D])/2-y):L*(r[D]-(r[D]-r[D-1])/2-y),q=D<C-1?L*(r[D]+(r[D+1]-r[D])/2-y):L*(r[D]+(r[D]-r[D-1])/2-y));for(var ee=0;ee<o.length;ee+=2){var J,$,te,ie,ae=o[ee],he=o[ee+1],se=d[l?(G+he)*C+(D+ae):G*C+D],de=t.le(T,se);if(de<0)J=A[0],$=A[1],te=A[2],ie=A[3];else if(de===S-1)J=A[4*S-4],$=A[4*S-3],te=A[4*S-2],ie=A[4*S-1];else{var ce=(se-T[de])/(T[de+1]-T[de]),ve=1-ce,ke=4*de,Ee=4*(de+1);J=ve*A[ke]+ce*A[Ee],$=ve*A[ke+1]+ce*A[Ee+1],te=ve*A[ke+2]+ce*A[Ee+2],ie=ve*A[ke+3]+ce*A[Ee+3]}O[4*Z]=255*J,O[4*Z+1]=255*$,O[4*Z+2]=255*te,O[4*Z+3]=255*ie,F[2*Z]=.5*B+.5*q,F[2*Z+1]=.5*Y+.5*K,j[2*Z]=ae,j[2*Z+1]=he,W[Z]=G*C+D,Z+=1}}}this.positionBuffer.update(F),this.weightBuffer.update(j),this.colorBuffer.update(O),this.idBuffer.update(W),g.free(F),g.free(O),g.free(j),g.free(W)},s.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.positionBuffer.dispose(),this.weightBuffer.dispose(),this.colorBuffer.dispose(),this.idBuffer.dispose(),this.plot.removeObject(this)}},{"./lib/shaders":273,"binary-search-bounds":103,"gl-buffer":261,"gl-shader":332,"iota-array":441,"typedarray-pool":601}],273:[function(h,N,H){var t=h("glslify");N.exports={fragment:t([`precision lowp float;
#define GLSLIFY 1
varying vec4 fragColor;
void main() {
  gl_FragColor = vec4(fragColor.rgb * fragColor.a, fragColor.a);
}
`]),vertex:t([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 color;
attribute vec2 weight;

uniform vec2 shape;
uniform mat3 viewTransform;

varying vec4 fragColor;

void main() {
  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);
  fragColor = color;
  gl_Position = vec4(vPosition.xy, 0, vPosition.z);
}
`]),pickFragment:t([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragId;
varying vec2 vWeight;

uniform vec2 shape;
uniform vec4 pickOffset;

void main() {
  vec2 d = step(.5, vWeight);
  vec4 id = fragId + pickOffset;
  id.x += d.x + d.y*shape.x;

  id.y += floor(id.x / 256.0);
  id.x -= floor(id.x / 256.0) * 256.0;

  id.z += floor(id.y / 256.0);
  id.y -= floor(id.y / 256.0) * 256.0;

  id.w += floor(id.z / 256.0);
  id.z -= floor(id.z / 256.0) * 256.0;

  gl_FragColor = id/255.;
}
`]),pickVertex:t([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 pickId;
attribute vec2 weight;

uniform vec2 shape;
uniform mat3 viewTransform;

varying vec4 fragId;
varying vec2 vWeight;

void main() {
  vWeight = weight;

  fragId = pickId;

  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);
  gl_Position = vec4(vPosition.xy, 0, vPosition.z);
}
`])}},{glslify:434}],274:[function(h,N,H){var t=h("glslify"),m=h("gl-shader"),g=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, nextPosition;
attribute float arcLength, lineWidth;
attribute vec4 color;

uniform vec2 screenShape;
uniform float pixelRatio;
uniform mat4 model, view, projection;

varying vec4 fragColor;
varying vec3 worldPosition;
varying float pixelArcLength;

vec4 project(vec3 p) {
  return projection * view * model * vec4(p, 1.0);
}

void main() {
  vec4 startPoint = project(position);
  vec4 endPoint   = project(nextPosition);

  vec2 A = startPoint.xy / startPoint.w;
  vec2 B =   endPoint.xy /   endPoint.w;

  float clipAngle = atan(
    (B.y - A.y) * screenShape.y,
    (B.x - A.x) * screenShape.x
  );

  vec2 offset = 0.5 * pixelRatio * lineWidth * vec2(
    sin(clipAngle),
    -cos(clipAngle)
  ) / screenShape;

  gl_Position = vec4(startPoint.xy + startPoint.w * offset, startPoint.zw);

  worldPosition = position;
  pixelArcLength = arcLength;
  fragColor = color;
}
`]),p=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3      clipBounds[2];
uniform sampler2D dashTexture;
uniform float     dashScale;
uniform float     opacity;

varying vec3    worldPosition;
varying float   pixelArcLength;
varying vec4    fragColor;

void main() {
  if (
    outOfRange(clipBounds[0], clipBounds[1], worldPosition) ||
    fragColor.a * opacity == 0.
  ) discard;

  float dashWeight = texture2D(dashTexture, vec2(dashScale * pixelArcLength, 0)).r;
  if(dashWeight < 0.5) {
    discard;
  }
  gl_FragColor = fragColor * opacity;
}
`]),e=t([`precision highp float;
#define GLSLIFY 1

#define FLOAT_MAX  1.70141184e38
#define FLOAT_MIN  1.17549435e-38

// https://github.com/mikolalysenko/glsl-read-float/blob/master/index.glsl
vec4 packFloat(float v) {
  float av = abs(v);

  //Handle special cases
  if(av < FLOAT_MIN) {
    return vec4(0.0, 0.0, 0.0, 0.0);
  } else if(v > FLOAT_MAX) {
    return vec4(127.0, 128.0, 0.0, 0.0) / 255.0;
  } else if(v < -FLOAT_MAX) {
    return vec4(255.0, 128.0, 0.0, 0.0) / 255.0;
  }

  vec4 c = vec4(0,0,0,0);

  //Compute exponent and mantissa
  float e = floor(log2(av));
  float m = av * pow(2.0, -e) - 1.0;

  //Unpack mantissa
  c[1] = floor(128.0 * m);
  m -= c[1] / 128.0;
  c[2] = floor(32768.0 * m);
  m -= c[2] / 32768.0;
  c[3] = floor(8388608.0 * m);

  //Unpack exponent
  float ebias = e + 127.0;
  c[0] = floor(ebias / 2.0);
  ebias -= c[0] * 2.0;
  c[1] += floor(ebias) * 128.0;

  //Unpack sign bit
  c[0] += 128.0 * step(0.0, -v);

  //Scale back to range
  return c / 255.0;
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform float pickId;
uniform vec3 clipBounds[2];

varying vec3 worldPosition;
varying float pixelArcLength;
varying vec4 fragColor;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], worldPosition)) discard;

  gl_FragColor = vec4(pickId/255.0, packFloat(pixelArcLength).xyz);
}`]),f=[{name:"position",type:"vec3"},{name:"nextPosition",type:"vec3"},{name:"arcLength",type:"float"},{name:"lineWidth",type:"float"},{name:"color",type:"vec4"}];H.createShader=function(u){return m(u,g,p,null,f)},H.createPickShader=function(u){return m(u,g,e,null,f)}},{"gl-shader":332,glslify:276}],275:[function(h,N,H){N.exports=function(y){var v=y.gl||y.scene&&y.scene.gl,_=s(v);_.attributes.position.location=0,_.attributes.nextPosition.location=1,_.attributes.arcLength.location=2,_.attributes.lineWidth.location=3,_.attributes.color.location=4;var x=o(v);x.attributes.position.location=0,x.attributes.nextPosition.location=1,x.attributes.arcLength.location=2,x.attributes.lineWidth.location=3,x.attributes.color.location=4;for(var T=t(v),A=m(v,[{buffer:T,size:3,offset:0,stride:48},{buffer:T,size:3,offset:12,stride:48},{buffer:T,size:1,offset:24,stride:48},{buffer:T,size:1,offset:28,stride:48},{buffer:T,size:4,offset:32,stride:48}]),S=u(new Array(1024),[256,1,4]),w=0;w<1024;++w)S.data[w]=255;var L=g(v,S);L.wrap=v.REPEAT;var k=new d(v,_,x,T,A,L);return k.update(y),k};var t=h("gl-buffer"),m=h("gl-vao"),g=h("gl-texture2d"),p=new Uint8Array(4),e=new Float32Array(p.buffer),f=h("binary-search-bounds"),u=h("ndarray"),i=h("./lib/shaders"),s=i.createShader,o=i.createPickShader,a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function c(y,v){for(var _=0,x=0;x<3;++x){var T=y[x]-v[x];_+=T*T}return Math.sqrt(_)}function r(y){for(var v=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],_=0;_<3;++_)v[0][_]=Math.max(y[0][_],v[0][_]),v[1][_]=Math.min(y[1][_],v[1][_]);return v}function n(y,v,_,x){this.arcLength=y,this.position=v,this.index=_,this.dataCoordinate=x}function d(y,v,_,x,T,A){this.gl=y,this.shader=v,this.pickShader=_,this.buffer=x,this.vao=T,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.points=[],this.arcLength=[],this.vertexCount=0,this.bounds=[[0,0,0],[0,0,0]],this.pickId=0,this.lineWidth=1,this.texture=A,this.dashScale=1,this.opacity=1,this.hasAlpha=!1,this.dirty=!0,this.pixelRatio=1}var l=d.prototype;l.isTransparent=function(){return this.hasAlpha},l.isOpaque=function(){return!this.hasAlpha},l.pickSlots=1,l.setPickBase=function(y){this.pickId=y},l.drawTransparent=l.draw=function(y){if(this.vertexCount){var v=this.gl,_=this.shader,x=this.vao;_.bind(),_.uniforms={model:y.model||a,view:y.view||a,projection:y.projection||a,clipBounds:r(this.clipBounds),dashTexture:this.texture.bind(),dashScale:this.dashScale/this.arcLength[this.arcLength.length-1],opacity:this.opacity,screenShape:[v.drawingBufferWidth,v.drawingBufferHeight],pixelRatio:this.pixelRatio},x.bind(),x.draw(v.TRIANGLE_STRIP,this.vertexCount),x.unbind()}},l.drawPick=function(y){if(this.vertexCount){var v=this.gl,_=this.pickShader,x=this.vao;_.bind(),_.uniforms={model:y.model||a,view:y.view||a,projection:y.projection||a,pickId:this.pickId,clipBounds:r(this.clipBounds),screenShape:[v.drawingBufferWidth,v.drawingBufferHeight],pixelRatio:this.pixelRatio},x.bind(),x.draw(v.TRIANGLE_STRIP,this.vertexCount),x.unbind()}},l.update=function(y){var v,_;this.dirty=!0;var x=!!y.connectGaps;"dashScale"in y&&(this.dashScale=y.dashScale),this.hasAlpha=!1,"opacity"in y&&(this.opacity=+y.opacity,this.opacity<1&&(this.hasAlpha=!0));var T=[],A=[],S=[],w=0,L=0,k=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],C=y.position||y.positions;if(C){var M=y.color||y.colors||[0,0,0,1],P=y.lineWidth||1,O=!1;e:for(v=1;v<C.length;++v){var F,j,W,Z=C[v-1],Q=C[v];for(A.push(w),S.push(Z.slice()),_=0;_<3;++_){if(isNaN(Z[_])||isNaN(Q[_])||!isFinite(Z[_])||!isFinite(Q[_])){if(!x&&T.length>0){for(var X=0;X<24;++X)T.push(T[T.length-12]);L+=2,O=!0}continue e}k[0][_]=Math.min(k[0][_],Z[_],Q[_]),k[1][_]=Math.max(k[1][_],Z[_],Q[_])}Array.isArray(M[0])?(F=M.length>v-1?M[v-1]:M.length>0?M[M.length-1]:[0,0,0,1],j=M.length>v?M[v]:M.length>0?M[M.length-1]:[0,0,0,1]):F=j=M,F.length===3&&(F=[F[0],F[1],F[2],1]),j.length===3&&(j=[j[0],j[1],j[2],1]),!this.hasAlpha&&F[3]<1&&(this.hasAlpha=!0),W=Array.isArray(P)?P.length>v-1?P[v-1]:P.length>0?P[P.length-1]:[0,0,0,1]:P;var G=w;if(w+=c(Z,Q),O){for(_=0;_<2;++_)T.push(Z[0],Z[1],Z[2],Q[0],Q[1],Q[2],G,W,F[0],F[1],F[2],F[3]);L+=2,O=!1}T.push(Z[0],Z[1],Z[2],Q[0],Q[1],Q[2],G,W,F[0],F[1],F[2],F[3],Z[0],Z[1],Z[2],Q[0],Q[1],Q[2],G,-W,F[0],F[1],F[2],F[3],Q[0],Q[1],Q[2],Z[0],Z[1],Z[2],w,-W,j[0],j[1],j[2],j[3],Q[0],Q[1],Q[2],Z[0],Z[1],Z[2],w,W,j[0],j[1],j[2],j[3]),L+=4}}if(this.buffer.update(T),A.push(w),S.push(C[C.length-1].slice()),this.bounds=k,this.vertexCount=L,this.points=S,this.arcLength=A,"dashes"in y){var Y=y.dashes.slice();for(Y.unshift(0),v=1;v<Y.length;++v)Y[v]=Y[v-1]+Y[v];var K=u(new Array(1024),[256,1,4]);for(v=0;v<256;++v){for(_=0;_<4;++_)K.set(v,0,_,0);1&f.le(Y,Y[Y.length-1]*v/255)?K.set(v,0,0,0):K.set(v,0,0,255)}this.texture.setPixels(K)}},l.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()},l.pick=function(y){if(!y||y.id!==this.pickId)return null;var v=function(C,M,P,O){return p[0]=O,p[1]=P,p[2]=M,p[3]=C,e[0]}(y.value[0],y.value[1],y.value[2],0),_=f.le(this.arcLength,v);if(_<0)return null;if(_===this.arcLength.length-1)return new n(this.arcLength[this.arcLength.length-1],this.points[this.points.length-1].slice(),_);for(var x=this.points[_],T=this.points[Math.min(_+1,this.points.length-1)],A=(v-this.arcLength[_])/(this.arcLength[_+1]-this.arcLength[_]),S=1-A,w=[0,0,0],L=0;L<3;++L)w[L]=S*x[L]+A*T[L];var k=Math.min(A<.5?_:_+1,this.points.length-1);return new n(v,w,k,this.points[k])}},{"./lib/shaders":274,"binary-search-bounds":103,"gl-buffer":261,"gl-texture2d":348,"gl-vao":353,ndarray:472}],276:[function(h,N,H){arguments[4][268][0].apply(H,arguments)},{dup:268}],277:[function(h,N,H){N.exports=function(t,m){var g=m[0],p=m[1],e=m[2],f=m[3],u=m[4],i=m[5],s=m[6],o=m[7],a=m[8],c=m[9],r=m[10],n=m[11],d=m[12],l=m[13],y=m[14],v=m[15];return t[0]=i*(r*v-n*y)-c*(s*v-o*y)+l*(s*n-o*r),t[1]=-(p*(r*v-n*y)-c*(e*v-f*y)+l*(e*n-f*r)),t[2]=p*(s*v-o*y)-i*(e*v-f*y)+l*(e*o-f*s),t[3]=-(p*(s*n-o*r)-i*(e*n-f*r)+c*(e*o-f*s)),t[4]=-(u*(r*v-n*y)-a*(s*v-o*y)+d*(s*n-o*r)),t[5]=g*(r*v-n*y)-a*(e*v-f*y)+d*(e*n-f*r),t[6]=-(g*(s*v-o*y)-u*(e*v-f*y)+d*(e*o-f*s)),t[7]=g*(s*n-o*r)-u*(e*n-f*r)+a*(e*o-f*s),t[8]=u*(c*v-n*l)-a*(i*v-o*l)+d*(i*n-o*c),t[9]=-(g*(c*v-n*l)-a*(p*v-f*l)+d*(p*n-f*c)),t[10]=g*(i*v-o*l)-u*(p*v-f*l)+d*(p*o-f*i),t[11]=-(g*(i*n-o*c)-u*(p*n-f*c)+a*(p*o-f*i)),t[12]=-(u*(c*y-r*l)-a*(i*y-s*l)+d*(i*r-s*c)),t[13]=g*(c*y-r*l)-a*(p*y-e*l)+d*(p*r-e*c),t[14]=-(g*(i*y-s*l)-u*(p*y-e*l)+d*(p*s-e*i)),t[15]=g*(i*r-s*c)-u*(p*r-e*c)+a*(p*s-e*i),t}},{}],278:[function(h,N,H){N.exports=function(t){var m=new Float32Array(16);return m[0]=t[0],m[1]=t[1],m[2]=t[2],m[3]=t[3],m[4]=t[4],m[5]=t[5],m[6]=t[6],m[7]=t[7],m[8]=t[8],m[9]=t[9],m[10]=t[10],m[11]=t[11],m[12]=t[12],m[13]=t[13],m[14]=t[14],m[15]=t[15],m}},{}],279:[function(h,N,H){N.exports=function(t,m){return t[0]=m[0],t[1]=m[1],t[2]=m[2],t[3]=m[3],t[4]=m[4],t[5]=m[5],t[6]=m[6],t[7]=m[7],t[8]=m[8],t[9]=m[9],t[10]=m[10],t[11]=m[11],t[12]=m[12],t[13]=m[13],t[14]=m[14],t[15]=m[15],t}},{}],280:[function(h,N,H){N.exports=function(){var t=new Float32Array(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{}],281:[function(h,N,H){N.exports=function(t){var m=t[0],g=t[1],p=t[2],e=t[3],f=t[4],u=t[5],i=t[6],s=t[7],o=t[8],a=t[9],c=t[10],r=t[11],n=t[12],d=t[13],l=t[14],y=t[15];return(m*u-g*f)*(c*y-r*l)-(m*i-p*f)*(a*y-r*d)+(m*s-e*f)*(a*l-c*d)+(g*i-p*u)*(o*y-r*n)-(g*s-e*u)*(o*l-c*n)+(p*s-e*i)*(o*d-a*n)}},{}],282:[function(h,N,H){N.exports=function(t,m){var g=m[0],p=m[1],e=m[2],f=m[3],u=g+g,i=p+p,s=e+e,o=g*u,a=p*u,c=p*i,r=e*u,n=e*i,d=e*s,l=f*u,y=f*i,v=f*s;return t[0]=1-c-d,t[1]=a+v,t[2]=r-y,t[3]=0,t[4]=a-v,t[5]=1-o-d,t[6]=n+l,t[7]=0,t[8]=r+y,t[9]=n-l,t[10]=1-o-c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{}],283:[function(h,N,H){N.exports=function(t,m,g){var p,e,f,u=g[0],i=g[1],s=g[2],o=Math.sqrt(u*u+i*i+s*s);return Math.abs(o)<1e-6?null:(u*=o=1/o,i*=o,s*=o,p=Math.sin(m),e=Math.cos(m),f=1-e,t[0]=u*u*f+e,t[1]=i*u*f+s*p,t[2]=s*u*f-i*p,t[3]=0,t[4]=u*i*f-s*p,t[5]=i*i*f+e,t[6]=s*i*f+u*p,t[7]=0,t[8]=u*s*f+i*p,t[9]=i*s*f-u*p,t[10]=s*s*f+e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}},{}],284:[function(h,N,H){N.exports=function(t,m,g){var p=m[0],e=m[1],f=m[2],u=m[3],i=p+p,s=e+e,o=f+f,a=p*i,c=p*s,r=p*o,n=e*s,d=e*o,l=f*o,y=u*i,v=u*s,_=u*o;return t[0]=1-(n+l),t[1]=c+_,t[2]=r-v,t[3]=0,t[4]=c-_,t[5]=1-(a+l),t[6]=d+y,t[7]=0,t[8]=r+v,t[9]=d-y,t[10]=1-(a+n),t[11]=0,t[12]=g[0],t[13]=g[1],t[14]=g[2],t[15]=1,t}},{}],285:[function(h,N,H){N.exports=function(t,m){return t[0]=m[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=m[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=m[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{}],286:[function(h,N,H){N.exports=function(t,m){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=m[0],t[13]=m[1],t[14]=m[2],t[15]=1,t}},{}],287:[function(h,N,H){N.exports=function(t,m){var g=Math.sin(m),p=Math.cos(m);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=p,t[6]=g,t[7]=0,t[8]=0,t[9]=-g,t[10]=p,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{}],288:[function(h,N,H){N.exports=function(t,m){var g=Math.sin(m),p=Math.cos(m);return t[0]=p,t[1]=0,t[2]=-g,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=g,t[9]=0,t[10]=p,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{}],289:[function(h,N,H){N.exports=function(t,m){var g=Math.sin(m),p=Math.cos(m);return t[0]=p,t[1]=g,t[2]=0,t[3]=0,t[4]=-g,t[5]=p,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{}],290:[function(h,N,H){N.exports=function(t,m,g,p,e,f,u){var i=1/(g-m),s=1/(e-p),o=1/(f-u);return t[0]=2*f*i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*f*s,t[6]=0,t[7]=0,t[8]=(g+m)*i,t[9]=(e+p)*s,t[10]=(u+f)*o,t[11]=-1,t[12]=0,t[13]=0,t[14]=u*f*2*o,t[15]=0,t}},{}],291:[function(h,N,H){N.exports=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{}],292:[function(h,N,H){N.exports={create:h("./create"),clone:h("./clone"),copy:h("./copy"),identity:h("./identity"),transpose:h("./transpose"),invert:h("./invert"),adjoint:h("./adjoint"),determinant:h("./determinant"),multiply:h("./multiply"),translate:h("./translate"),scale:h("./scale"),rotate:h("./rotate"),rotateX:h("./rotateX"),rotateY:h("./rotateY"),rotateZ:h("./rotateZ"),fromRotation:h("./fromRotation"),fromRotationTranslation:h("./fromRotationTranslation"),fromScaling:h("./fromScaling"),fromTranslation:h("./fromTranslation"),fromXRotation:h("./fromXRotation"),fromYRotation:h("./fromYRotation"),fromZRotation:h("./fromZRotation"),fromQuat:h("./fromQuat"),frustum:h("./frustum"),perspective:h("./perspective"),perspectiveFromFieldOfView:h("./perspectiveFromFieldOfView"),ortho:h("./ortho"),lookAt:h("./lookAt"),str:h("./str")}},{"./adjoint":277,"./clone":278,"./copy":279,"./create":280,"./determinant":281,"./fromQuat":282,"./fromRotation":283,"./fromRotationTranslation":284,"./fromScaling":285,"./fromTranslation":286,"./fromXRotation":287,"./fromYRotation":288,"./fromZRotation":289,"./frustum":290,"./identity":291,"./invert":293,"./lookAt":294,"./multiply":295,"./ortho":296,"./perspective":297,"./perspectiveFromFieldOfView":298,"./rotate":299,"./rotateX":300,"./rotateY":301,"./rotateZ":302,"./scale":303,"./str":304,"./translate":305,"./transpose":306}],293:[function(h,N,H){N.exports=function(t,m){var g=m[0],p=m[1],e=m[2],f=m[3],u=m[4],i=m[5],s=m[6],o=m[7],a=m[8],c=m[9],r=m[10],n=m[11],d=m[12],l=m[13],y=m[14],v=m[15],_=g*i-p*u,x=g*s-e*u,T=g*o-f*u,A=p*s-e*i,S=p*o-f*i,w=e*o-f*s,L=a*l-c*d,k=a*y-r*d,C=a*v-n*d,M=c*y-r*l,P=c*v-n*l,O=r*v-n*y,F=_*O-x*P+T*M+A*C-S*k+w*L;return F?(F=1/F,t[0]=(i*O-s*P+o*M)*F,t[1]=(e*P-p*O-f*M)*F,t[2]=(l*w-y*S+v*A)*F,t[3]=(r*S-c*w-n*A)*F,t[4]=(s*C-u*O-o*k)*F,t[5]=(g*O-e*C+f*k)*F,t[6]=(y*T-d*w-v*x)*F,t[7]=(a*w-r*T+n*x)*F,t[8]=(u*P-i*C+o*L)*F,t[9]=(p*C-g*P-f*L)*F,t[10]=(d*S-l*T+v*_)*F,t[11]=(c*T-a*S-n*_)*F,t[12]=(i*k-u*M-s*L)*F,t[13]=(g*M-p*k+e*L)*F,t[14]=(l*x-d*A-y*_)*F,t[15]=(a*A-c*x+r*_)*F,t):null}},{}],294:[function(h,N,H){var t=h("./identity");N.exports=function(m,g,p,e){var f,u,i,s,o,a,c,r,n,d,l=g[0],y=g[1],v=g[2],_=e[0],x=e[1],T=e[2],A=p[0],S=p[1],w=p[2];return Math.abs(l-A)<1e-6&&Math.abs(y-S)<1e-6&&Math.abs(v-w)<1e-6?t(m):(c=l-A,r=y-S,n=v-w,d=1/Math.sqrt(c*c+r*r+n*n),f=x*(n*=d)-T*(r*=d),u=T*(c*=d)-_*n,i=_*r-x*c,(d=Math.sqrt(f*f+u*u+i*i))?(f*=d=1/d,u*=d,i*=d):(f=0,u=0,i=0),s=r*i-n*u,o=n*f-c*i,a=c*u-r*f,(d=Math.sqrt(s*s+o*o+a*a))?(s*=d=1/d,o*=d,a*=d):(s=0,o=0,a=0),m[0]=f,m[1]=s,m[2]=c,m[3]=0,m[4]=u,m[5]=o,m[6]=r,m[7]=0,m[8]=i,m[9]=a,m[10]=n,m[11]=0,m[12]=-(f*l+u*y+i*v),m[13]=-(s*l+o*y+a*v),m[14]=-(c*l+r*y+n*v),m[15]=1,m)}},{"./identity":291}],295:[function(h,N,H){N.exports=function(t,m,g){var p=m[0],e=m[1],f=m[2],u=m[3],i=m[4],s=m[5],o=m[6],a=m[7],c=m[8],r=m[9],n=m[10],d=m[11],l=m[12],y=m[13],v=m[14],_=m[15],x=g[0],T=g[1],A=g[2],S=g[3];return t[0]=x*p+T*i+A*c+S*l,t[1]=x*e+T*s+A*r+S*y,t[2]=x*f+T*o+A*n+S*v,t[3]=x*u+T*a+A*d+S*_,x=g[4],T=g[5],A=g[6],S=g[7],t[4]=x*p+T*i+A*c+S*l,t[5]=x*e+T*s+A*r+S*y,t[6]=x*f+T*o+A*n+S*v,t[7]=x*u+T*a+A*d+S*_,x=g[8],T=g[9],A=g[10],S=g[11],t[8]=x*p+T*i+A*c+S*l,t[9]=x*e+T*s+A*r+S*y,t[10]=x*f+T*o+A*n+S*v,t[11]=x*u+T*a+A*d+S*_,x=g[12],T=g[13],A=g[14],S=g[15],t[12]=x*p+T*i+A*c+S*l,t[13]=x*e+T*s+A*r+S*y,t[14]=x*f+T*o+A*n+S*v,t[15]=x*u+T*a+A*d+S*_,t}},{}],296:[function(h,N,H){N.exports=function(t,m,g,p,e,f,u){var i=1/(m-g),s=1/(p-e),o=1/(f-u);return t[0]=-2*i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*o,t[11]=0,t[12]=(m+g)*i,t[13]=(e+p)*s,t[14]=(u+f)*o,t[15]=1,t}},{}],297:[function(h,N,H){N.exports=function(t,m,g,p,e){var f=1/Math.tan(m/2),u=1/(p-e);return t[0]=f/g,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=f,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(e+p)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*e*p*u,t[15]=0,t}},{}],298:[function(h,N,H){N.exports=function(t,m,g,p){var e=Math.tan(m.upDegrees*Math.PI/180),f=Math.tan(m.downDegrees*Math.PI/180),u=Math.tan(m.leftDegrees*Math.PI/180),i=Math.tan(m.rightDegrees*Math.PI/180),s=2/(u+i),o=2/(e+f);return t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=-(u-i)*s*.5,t[9]=(e-f)*o*.5,t[10]=p/(g-p),t[11]=-1,t[12]=0,t[13]=0,t[14]=p*g/(g-p),t[15]=0,t}},{}],299:[function(h,N,H){N.exports=function(t,m,g,p){var e,f,u,i,s,o,a,c,r,n,d,l,y,v,_,x,T,A,S,w,L,k,C,M,P=p[0],O=p[1],F=p[2],j=Math.sqrt(P*P+O*O+F*F);return Math.abs(j)<1e-6?null:(P*=j=1/j,O*=j,F*=j,e=Math.sin(g),f=Math.cos(g),u=1-f,i=m[0],s=m[1],o=m[2],a=m[3],c=m[4],r=m[5],n=m[6],d=m[7],l=m[8],y=m[9],v=m[10],_=m[11],x=P*P*u+f,T=O*P*u+F*e,A=F*P*u-O*e,S=P*O*u-F*e,w=O*O*u+f,L=F*O*u+P*e,k=P*F*u+O*e,C=O*F*u-P*e,M=F*F*u+f,t[0]=i*x+c*T+l*A,t[1]=s*x+r*T+y*A,t[2]=o*x+n*T+v*A,t[3]=a*x+d*T+_*A,t[4]=i*S+c*w+l*L,t[5]=s*S+r*w+y*L,t[6]=o*S+n*w+v*L,t[7]=a*S+d*w+_*L,t[8]=i*k+c*C+l*M,t[9]=s*k+r*C+y*M,t[10]=o*k+n*C+v*M,t[11]=a*k+d*C+_*M,m!==t&&(t[12]=m[12],t[13]=m[13],t[14]=m[14],t[15]=m[15]),t)}},{}],300:[function(h,N,H){N.exports=function(t,m,g){var p=Math.sin(g),e=Math.cos(g),f=m[4],u=m[5],i=m[6],s=m[7],o=m[8],a=m[9],c=m[10],r=m[11];return m!==t&&(t[0]=m[0],t[1]=m[1],t[2]=m[2],t[3]=m[3],t[12]=m[12],t[13]=m[13],t[14]=m[14],t[15]=m[15]),t[4]=f*e+o*p,t[5]=u*e+a*p,t[6]=i*e+c*p,t[7]=s*e+r*p,t[8]=o*e-f*p,t[9]=a*e-u*p,t[10]=c*e-i*p,t[11]=r*e-s*p,t}},{}],301:[function(h,N,H){N.exports=function(t,m,g){var p=Math.sin(g),e=Math.cos(g),f=m[0],u=m[1],i=m[2],s=m[3],o=m[8],a=m[9],c=m[10],r=m[11];return m!==t&&(t[4]=m[4],t[5]=m[5],t[6]=m[6],t[7]=m[7],t[12]=m[12],t[13]=m[13],t[14]=m[14],t[15]=m[15]),t[0]=f*e-o*p,t[1]=u*e-a*p,t[2]=i*e-c*p,t[3]=s*e-r*p,t[8]=f*p+o*e,t[9]=u*p+a*e,t[10]=i*p+c*e,t[11]=s*p+r*e,t}},{}],302:[function(h,N,H){N.exports=function(t,m,g){var p=Math.sin(g),e=Math.cos(g),f=m[0],u=m[1],i=m[2],s=m[3],o=m[4],a=m[5],c=m[6],r=m[7];return m!==t&&(t[8]=m[8],t[9]=m[9],t[10]=m[10],t[11]=m[11],t[12]=m[12],t[13]=m[13],t[14]=m[14],t[15]=m[15]),t[0]=f*e+o*p,t[1]=u*e+a*p,t[2]=i*e+c*p,t[3]=s*e+r*p,t[4]=o*e-f*p,t[5]=a*e-u*p,t[6]=c*e-i*p,t[7]=r*e-s*p,t}},{}],303:[function(h,N,H){N.exports=function(t,m,g){var p=g[0],e=g[1],f=g[2];return t[0]=m[0]*p,t[1]=m[1]*p,t[2]=m[2]*p,t[3]=m[3]*p,t[4]=m[4]*e,t[5]=m[5]*e,t[6]=m[6]*e,t[7]=m[7]*e,t[8]=m[8]*f,t[9]=m[9]*f,t[10]=m[10]*f,t[11]=m[11]*f,t[12]=m[12],t[13]=m[13],t[14]=m[14],t[15]=m[15],t}},{}],304:[function(h,N,H){N.exports=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}},{}],305:[function(h,N,H){N.exports=function(t,m,g){var p,e,f,u,i,s,o,a,c,r,n,d,l=g[0],y=g[1],v=g[2];return m===t?(t[12]=m[0]*l+m[4]*y+m[8]*v+m[12],t[13]=m[1]*l+m[5]*y+m[9]*v+m[13],t[14]=m[2]*l+m[6]*y+m[10]*v+m[14],t[15]=m[3]*l+m[7]*y+m[11]*v+m[15]):(p=m[0],e=m[1],f=m[2],u=m[3],i=m[4],s=m[5],o=m[6],a=m[7],c=m[8],r=m[9],n=m[10],d=m[11],t[0]=p,t[1]=e,t[2]=f,t[3]=u,t[4]=i,t[5]=s,t[6]=o,t[7]=a,t[8]=c,t[9]=r,t[10]=n,t[11]=d,t[12]=p*l+i*y+c*v+m[12],t[13]=e*l+s*y+r*v+m[13],t[14]=f*l+o*y+n*v+m[14],t[15]=u*l+a*y+d*v+m[15]),t}},{}],306:[function(h,N,H){N.exports=function(t,m){if(t===m){var g=m[1],p=m[2],e=m[3],f=m[6],u=m[7],i=m[11];t[1]=m[4],t[2]=m[8],t[3]=m[12],t[4]=g,t[6]=m[9],t[7]=m[13],t[8]=p,t[9]=f,t[11]=m[14],t[12]=e,t[13]=u,t[14]=i}else t[0]=m[0],t[1]=m[4],t[2]=m[8],t[3]=m[12],t[4]=m[1],t[5]=m[5],t[6]=m[9],t[7]=m[13],t[8]=m[2],t[9]=m[6],t[10]=m[10],t[11]=m[14],t[12]=m[3],t[13]=m[7],t[14]=m[11],t[15]=m[15];return t}},{}],307:[function(h,N,H){var t=h("barycentric"),m=h("polytope-closest-point/lib/closest_point_2d.js");function g(f,u){for(var i=[0,0,0,0],s=0;s<4;++s)for(var o=0;o<4;++o)i[o]+=f[4*s+o]*u[s];return i}function p(f,u,i,s,o){for(var a=g(s,g(i,g(u,[f[0],f[1],f[2],1]))),c=0;c<3;++c)a[c]/=a[3];return[.5*o[0]*(1+a[0]),.5*o[1]*(1-a[1])]}function e(f,u){for(var i=[0,0,0],s=0;s<f.length;++s)for(var o=f[s],a=u[s],c=0;c<3;++c)i[c]+=a*o[c];return i}N.exports=function(f,u,i,s,o,a){if(f.length===1)return[0,f[0].slice()];for(var c=new Array(f.length),r=0;r<f.length;++r)c[r]=p(f[r],i,s,o,a);var n=0,d=1/0;for(r=0;r<c.length;++r){for(var l=0,y=0;y<2;++y)l+=Math.pow(c[r][y]-u[y],2);l<d&&(d=l,n=r)}var v=function(x,T){if(x.length===2){for(var A=0,S=0,w=0;w<2;++w)A+=Math.pow(T[w]-x[0][w],2),S+=Math.pow(T[w]-x[1][w],2);return A=Math.sqrt(A),S=Math.sqrt(S),A+S<1e-6?[1,0]:[S/(A+S),A/(S+A)]}if(x.length===3){var L=[0,0];return m(x[0],x[1],x[2],T,L),t(x,L)}return[]}(c,u),_=0;for(r=0;r<3;++r){if(v[r]<-.001||v[r]>1.0001)return null;_+=v[r]}return Math.abs(_-1)>.001?null:[n,e(f,v),v]}},{barycentric:85,"polytope-closest-point/lib/closest_point_2d.js":498}],308:[function(h,N,H){var t=h("glslify"),m=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, normal;
attribute vec4 color;
attribute vec2 uv;

uniform mat4 model
           , view
           , projection
           , inverseModel;
uniform vec3 eyePosition
           , lightPosition;

varying vec3 f_normal
           , f_lightDirection
           , f_eyeDirection
           , f_data;
varying vec4 f_color;
varying vec2 f_uv;

vec4 project(vec3 p) {
  return projection * view * model * vec4(p, 1.0);
}

void main() {
  gl_Position      = project(position);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * vec4(position , 1.0);
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal  = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  f_color          = color;
  f_data           = position;
  f_uv             = uv;
}
`]),g=t([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

//#pragma glslify: beckmann = require(glsl-specular-beckmann) // used in gl-surface3d

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness
            , fresnel
            , kambient
            , kdiffuse
            , kspecular;
uniform sampler2D texture;

varying vec3 f_normal
           , f_lightDirection
           , f_eyeDirection
           , f_data;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (f_color.a == 0.0 ||
    outOfRange(clipBounds[0], clipBounds[1], f_data)
  ) discard;

  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  //float specular = max(0.0, beckmann(L, V, N, roughness)); // used in gl-surface3d

  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = vec4(f_color.rgb, 1.0) * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * f_color.a;
}
`]),p=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec4 color;
attribute vec2 uv;

uniform mat4 model, view, projection;

varying vec4 f_color;
varying vec3 f_data;
varying vec2 f_uv;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
  f_color = color;
  f_data  = position;
  f_uv    = uv;
}`]),e=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform sampler2D texture;
uniform float opacity;

varying vec4 f_color;
varying vec3 f_data;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_data)) discard;

  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;
}`]),f=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 uv;
attribute float pointSize;

uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0.0, 0.0 ,0.0 ,0.0);
  } else {
    gl_Position = projection * view * model * vec4(position, 1.0);
  }
  gl_PointSize = pointSize;
  f_color = color;
  f_uv = uv;
}`]),u=t([`precision highp float;
#define GLSLIFY 1

uniform sampler2D texture;
uniform float opacity;

varying vec4 f_color;
varying vec2 f_uv;

void main() {
  vec2 pointR = gl_PointCoord.xy - vec2(0.5, 0.5);
  if(dot(pointR, pointR) > 0.25) {
    discard;
  }
  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;
}`]),i=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec4 id;

uniform mat4 model, view, projection;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
  f_id        = id;
  f_position  = position;
}`]),s=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]),o=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3  position;
attribute float pointSize;
attribute vec4  id;

uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0.0, 0.0, 0.0, 0.0);
  } else {
    gl_Position  = projection * view * model * vec4(position, 1.0);
    gl_PointSize = pointSize;
  }
  f_id         = id;
  f_position   = position;
}`]),a=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
}`]),c=t([`precision highp float;
#define GLSLIFY 1

uniform vec3 contourColor;

void main() {
  gl_FragColor = vec4(contourColor, 1.0);
}
`]);H.meshShader={vertex:m,fragment:g,attributes:[{name:"position",type:"vec3"},{name:"normal",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},H.wireShader={vertex:p,fragment:e,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},H.pointShader={vertex:f,fragment:u,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"pointSize",type:"float"}]},H.pickShader={vertex:i,fragment:s,attributes:[{name:"position",type:"vec3"},{name:"id",type:"vec4"}]},H.pointPickShader={vertex:o,fragment:s,attributes:[{name:"position",type:"vec3"},{name:"pointSize",type:"float"},{name:"id",type:"vec4"}]},H.contourShader={vertex:a,fragment:c,attributes:[{name:"position",type:"vec3"}]}},{glslify:434}],309:[function(h,N,H){var t=h("gl-shader"),m=h("gl-buffer"),g=h("gl-vao"),p=h("gl-texture2d"),e=h("normals"),f=h("gl-mat4/multiply"),u=h("gl-mat4/invert"),i=h("ndarray"),s=h("colormap"),o=h("simplicial-complex-contour"),a=h("typedarray-pool"),c=h("./lib/shaders"),r=h("./lib/closest-point"),n=c.meshShader,d=c.wireShader,l=c.pointShader,y=c.pickShader,v=c.pointPickShader,_=c.contourShader,x=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function T(O,F,j,W,Z,Q,X,G,Y,K,D,B,q,ee,J,$,te,ie,ae,he,se,de,ce,ve,ke,Ee,be){this.gl=O,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=F,this.dirty=!0,this.triShader=j,this.lineShader=W,this.pointShader=Z,this.pickShader=Q,this.pointPickShader=X,this.contourShader=G,this.trianglePositions=Y,this.triangleColors=D,this.triangleNormals=q,this.triangleUVs=B,this.triangleIds=K,this.triangleVAO=ee,this.triangleCount=0,this.lineWidth=1,this.edgePositions=J,this.edgeColors=te,this.edgeUVs=ie,this.edgeIds=$,this.edgeVAO=ae,this.edgeCount=0,this.pointPositions=he,this.pointColors=de,this.pointUVs=ce,this.pointSizes=ve,this.pointIds=se,this.pointVAO=ke,this.pointCount=0,this.contourLineWidth=1,this.contourPositions=Ee,this.contourVAO=be,this.contourCount=0,this.contourColor=[0,0,0],this.contourEnable=!0,this.pickVertex=!0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.hasAlpha=!1,this.opacityscale=!1,this._model=x,this._view=x,this._projection=x,this._resolution=[1,1]}var A=T.prototype;function S(O,F){if(!F||!F.length)return 1;for(var j=0;j<F.length;++j){if(F.length<2)return 1;if(F[j][0]===O)return F[j][1];if(F[j][0]>O&&j>0){var W=(F[j][0]-O)/(F[j][0]-F[j-1][0]);return F[j][1]*(1-W)+W*F[j-1][1]}}return 1}function w(O){var F=t(O,n.vertex,n.fragment);return F.attributes.position.location=0,F.attributes.color.location=2,F.attributes.uv.location=3,F.attributes.normal.location=4,F}function L(O){var F=t(O,d.vertex,d.fragment);return F.attributes.position.location=0,F.attributes.color.location=2,F.attributes.uv.location=3,F}function k(O){var F=t(O,l.vertex,l.fragment);return F.attributes.position.location=0,F.attributes.color.location=2,F.attributes.uv.location=3,F.attributes.pointSize.location=4,F}function C(O){var F=t(O,y.vertex,y.fragment);return F.attributes.position.location=0,F.attributes.id.location=1,F}function M(O){var F=t(O,v.vertex,v.fragment);return F.attributes.position.location=0,F.attributes.id.location=1,F.attributes.pointSize.location=4,F}function P(O){var F=t(O,_.vertex,_.fragment);return F.attributes.position.location=0,F}A.isOpaque=function(){return!this.hasAlpha},A.isTransparent=function(){return this.hasAlpha},A.pickSlots=1,A.setPickBase=function(O){this.pickId=O},A.highlight=function(O){if(O&&this.contourEnable){for(var F=o(this.cells,this.intensity,O.intensity),j=F.cells,W=F.vertexIds,Z=F.vertexWeights,Q=j.length,X=a.mallocFloat32(6*Q),G=0,Y=0;Y<Q;++Y)for(var K=j[Y],D=0;D<2;++D){var B=K[0];K.length===2&&(B=K[D]);for(var q=W[B][0],ee=W[B][1],J=Z[B],$=1-J,te=this.positions[q],ie=this.positions[ee],ae=0;ae<3;++ae)X[G++]=J*te[ae]+$*ie[ae]}this.contourCount=G/3|0,this.contourPositions.update(X.subarray(0,G)),a.free(X)}else this.contourCount=0},A.update=function(O){O=O||{};var F=this.gl;this.dirty=!0,"contourEnable"in O&&(this.contourEnable=O.contourEnable),"contourColor"in O&&(this.contourColor=O.contourColor),"lineWidth"in O&&(this.lineWidth=O.lineWidth),"lightPosition"in O&&(this.lightPosition=O.lightPosition),this.hasAlpha=!1,"opacity"in O&&(this.opacity=O.opacity,this.opacity<1&&(this.hasAlpha=!0)),"opacityscale"in O&&(this.opacityscale=O.opacityscale,this.hasAlpha=!0),"ambient"in O&&(this.ambientLight=O.ambient),"diffuse"in O&&(this.diffuseLight=O.diffuse),"specular"in O&&(this.specularLight=O.specular),"roughness"in O&&(this.roughness=O.roughness),"fresnel"in O&&(this.fresnel=O.fresnel),O.texture?(this.texture.dispose(),this.texture=p(F,O.texture)):O.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=F.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=F.LINEAR,this.texture.setPixels(function(rt,$e){for(var xt=s({colormap:rt,nshades:256,format:"rgba"}),Qt=new Uint8Array(1024),$t=0;$t<256;++$t){for(var Ue=xt[$t],He=0;He<3;++He)Qt[4*$t+He]=Ue[He];Qt[4*$t+3]=$e?255*S($t/255,$e):255*Ue[3]}return i(Qt,[256,256,4],[4,0,1])}(O.colormap,this.opacityscale)),this.texture.generateMipmap());var j=O.cells,W=O.positions;if(W&&j){var Z=[],Q=[],X=[],G=[],Y=[],K=[],D=[],B=[],q=[],ee=[],J=[],$=[],te=[],ie=[];this.cells=j,this.positions=W;var ae=O.vertexNormals,he=O.cellNormals,se=O.vertexNormalsEpsilon===void 0?1e-6:O.vertexNormalsEpsilon,de=O.faceNormalsEpsilon===void 0?1e-6:O.faceNormalsEpsilon;O.useFacetNormals&&!he&&(he=e.faceNormals(j,W,de)),he||ae||(ae=e.vertexNormals(j,W,se));var ce=O.vertexColors,ve=O.cellColors,ke=O.meshColor||[1,1,1,1],Ee=O.vertexUVs,be=O.vertexIntensity,xe=O.cellUVs,ue=O.cellIntensity,me=1/0,we=-1/0;if(!Ee&&!xe)if(be)if(O.vertexIntensityBounds)me=+O.vertexIntensityBounds[0],we=+O.vertexIntensityBounds[1];else for(var Me=0;Me<be.length;++Me){var Se=be[Me];me=Math.min(me,Se),we=Math.max(we,Se)}else if(ue)if(O.cellIntensityBounds)me=+O.cellIntensityBounds[0],we=+O.cellIntensityBounds[1];else for(Me=0;Me<ue.length;++Me)Se=ue[Me],me=Math.min(me,Se),we=Math.max(we,Se);else for(Me=0;Me<W.length;++Me)Se=W[Me][2],me=Math.min(me,Se),we=Math.max(we,Se);this.intensity=be||ue||function(rt){for(var $e=rt.length,xt=new Array($e),Qt=0;Qt<$e;++Qt)xt[Qt]=rt[Qt][2];return xt}(W),this.pickVertex=!(ue||ve);var De=O.pointSizes,Fe=O.pointSize||1;for(this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],Me=0;Me<W.length;++Me)for(var Ye=W[Me],et=0;et<3;++et)!isNaN(Ye[et])&&isFinite(Ye[et])&&(this.bounds[0][et]=Math.min(this.bounds[0][et],Ye[et]),this.bounds[1][et]=Math.max(this.bounds[1][et],Ye[et]));var Oe=0,je=0,We=0;e:for(Me=0;Me<j.length;++Me){var Ge=j[Me];switch(Ge.length){case 1:for(Ye=W[it=Ge[0]],et=0;et<3;++et)if(isNaN(Ye[et])||!isFinite(Ye[et]))continue e;ee.push(Ye[0],Ye[1],Ye[2]),lt=ce?ce[it]:ve?ve[Me]:ke,this.opacityscale&&be?Q.push(lt[0],lt[1],lt[2],this.opacity*S((be[it]-me)/(we-me),this.opacityscale)):lt.length===3?J.push(lt[0],lt[1],lt[2],this.opacity):(J.push(lt[0],lt[1],lt[2],lt[3]*this.opacity),lt[3]<1&&(this.hasAlpha=!0)),Lt=Ee?Ee[it]:be?[(be[it]-me)/(we-me),0]:xe?xe[Me]:ue?[(ue[Me]-me)/(we-me),0]:[(Ye[2]-me)/(we-me),0],$.push(Lt[0],Lt[1]),De?te.push(De[it]):te.push(Fe),ie.push(Me),We+=1;break;case 2:for(et=0;et<2;++et){Ye=W[it=Ge[et]];for(var Qe=0;Qe<3;++Qe)if(isNaN(Ye[Qe])||!isFinite(Ye[Qe]))continue e}for(et=0;et<2;++et)Ye=W[it=Ge[et]],K.push(Ye[0],Ye[1],Ye[2]),lt=ce?ce[it]:ve?ve[Me]:ke,this.opacityscale&&be?Q.push(lt[0],lt[1],lt[2],this.opacity*S((be[it]-me)/(we-me),this.opacityscale)):lt.length===3?D.push(lt[0],lt[1],lt[2],this.opacity):(D.push(lt[0],lt[1],lt[2],lt[3]*this.opacity),lt[3]<1&&(this.hasAlpha=!0)),Lt=Ee?Ee[it]:be?[(be[it]-me)/(we-me),0]:xe?xe[Me]:ue?[(ue[Me]-me)/(we-me),0]:[(Ye[2]-me)/(we-me),0],B.push(Lt[0],Lt[1]),q.push(Me);je+=1;break;case 3:for(et=0;et<3;++et)for(Ye=W[it=Ge[et]],Qe=0;Qe<3;++Qe)if(isNaN(Ye[Qe])||!isFinite(Ye[Qe]))continue e;for(et=0;et<3;++et){var it,lt,Lt,wt;Ye=W[it=Ge[2-et]],Z.push(Ye[0],Ye[1],Ye[2]),(lt=ce?ce[it]:ve?ve[Me]:ke)?this.opacityscale&&be?Q.push(lt[0],lt[1],lt[2],this.opacity*S((be[it]-me)/(we-me),this.opacityscale)):lt.length===3?Q.push(lt[0],lt[1],lt[2],this.opacity):(Q.push(lt[0],lt[1],lt[2],lt[3]*this.opacity),lt[3]<1&&(this.hasAlpha=!0)):Q.push(.5,.5,.5,1),Lt=Ee?Ee[it]:be?[(be[it]-me)/(we-me),0]:xe?xe[Me]:ue?[(ue[Me]-me)/(we-me),0]:[(Ye[2]-me)/(we-me),0],G.push(Lt[0],Lt[1]),wt=ae?ae[it]:he[Me],X.push(wt[0],wt[1],wt[2]),Y.push(Me)}Oe+=1}}this.pointCount=We,this.edgeCount=je,this.triangleCount=Oe,this.pointPositions.update(ee),this.pointColors.update(J),this.pointUVs.update($),this.pointSizes.update(te),this.pointIds.update(new Uint32Array(ie)),this.edgePositions.update(K),this.edgeColors.update(D),this.edgeUVs.update(B),this.edgeIds.update(new Uint32Array(q)),this.trianglePositions.update(Z),this.triangleColors.update(Q),this.triangleUVs.update(G),this.triangleNormals.update(X),this.triangleIds.update(new Uint32Array(Y))}},A.drawTransparent=A.draw=function(O){O=O||{};for(var F=this.gl,j=O.model||x,W=O.view||x,Z=O.projection||x,Q=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],X=0;X<3;++X)Q[0][X]=Math.max(Q[0][X],this.clipBounds[0][X]),Q[1][X]=Math.min(Q[1][X],this.clipBounds[1][X]);var G={model:j,view:W,projection:Z,inverseModel:x.slice(),clipBounds:Q,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],contourColor:this.contourColor,texture:0};G.inverseModel=u(G.inverseModel,G.model),F.disable(F.CULL_FACE),this.texture.bind(0);var Y=new Array(16);for(f(Y,G.view,G.model),f(Y,G.projection,Y),u(Y,Y),X=0;X<3;++X)G.eyePosition[X]=Y[12+X]/Y[15];var K,D=Y[15];for(X=0;X<3;++X)D+=this.lightPosition[X]*Y[4*X+3];for(X=0;X<3;++X){for(var B=Y[12+X],q=0;q<3;++q)B+=Y[4*q+X]*this.lightPosition[q];G.lightPosition[X]=B/D}this.triangleCount>0&&((K=this.triShader).bind(),K.uniforms=G,this.triangleVAO.bind(),F.drawArrays(F.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()),this.edgeCount>0&&this.lineWidth>0&&((K=this.lineShader).bind(),K.uniforms=G,this.edgeVAO.bind(),F.lineWidth(this.lineWidth*this.pixelRatio),F.drawArrays(F.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()),this.pointCount>0&&((K=this.pointShader).bind(),K.uniforms=G,this.pointVAO.bind(),F.drawArrays(F.POINTS,0,this.pointCount),this.pointVAO.unbind()),this.contourEnable&&this.contourCount>0&&this.contourLineWidth>0&&((K=this.contourShader).bind(),K.uniforms=G,this.contourVAO.bind(),F.drawArrays(F.LINES,0,this.contourCount),this.contourVAO.unbind())},A.drawPick=function(O){O=O||{};for(var F=this.gl,j=O.model||x,W=O.view||x,Z=O.projection||x,Q=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],X=0;X<3;++X)Q[0][X]=Math.max(Q[0][X],this.clipBounds[0][X]),Q[1][X]=Math.min(Q[1][X],this.clipBounds[1][X]);this._model=[].slice.call(j),this._view=[].slice.call(W),this._projection=[].slice.call(Z),this._resolution=[F.drawingBufferWidth,F.drawingBufferHeight];var G,Y={model:j,view:W,projection:Z,clipBounds:Q,pickId:this.pickId/255};(G=this.pickShader).bind(),G.uniforms=Y,this.triangleCount>0&&(this.triangleVAO.bind(),F.drawArrays(F.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()),this.edgeCount>0&&(this.edgeVAO.bind(),F.lineWidth(this.lineWidth*this.pixelRatio),F.drawArrays(F.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()),this.pointCount>0&&((G=this.pointPickShader).bind(),G.uniforms=Y,this.pointVAO.bind(),F.drawArrays(F.POINTS,0,this.pointCount),this.pointVAO.unbind())},A.pick=function(O){if(!O||O.id!==this.pickId)return null;for(var F=O.value[0]+256*O.value[1]+65536*O.value[2],j=this.cells[F],W=this.positions,Z=new Array(j.length),Q=0;Q<j.length;++Q)Z[Q]=W[j[Q]];var X=O.coord[0],G=O.coord[1];if(!this.pickVertex){var Y=this.positions[j[0]],K=this.positions[j[1]],D=this.positions[j[2]],B=[(Y[0]+K[0]+D[0])/3,(Y[1]+K[1]+D[1])/3,(Y[2]+K[2]+D[2])/3];return{_cellCenter:!0,position:[X,G],index:F,cell:j,cellId:F,intensity:this.intensity[F],dataCoordinate:B}}var q=r(Z,[X*this.pixelRatio,this._resolution[1]-G*this.pixelRatio],this._model,this._view,this._projection,this._resolution);if(!q)return null;var ee=q[2],J=0;for(Q=0;Q<j.length;++Q)J+=ee[Q]*this.intensity[j[Q]];return{position:q[1],index:j[q[0]],cell:j,cellId:F,intensity:J,dataCoordinate:this.positions[j[q[0]]]}},A.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.lineShader.dispose(),this.pointShader.dispose(),this.pickShader.dispose(),this.pointPickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleNormals.dispose(),this.triangleIds.dispose(),this.edgeVAO.dispose(),this.edgePositions.dispose(),this.edgeColors.dispose(),this.edgeUVs.dispose(),this.edgeIds.dispose(),this.pointVAO.dispose(),this.pointPositions.dispose(),this.pointColors.dispose(),this.pointUVs.dispose(),this.pointSizes.dispose(),this.pointIds.dispose(),this.contourVAO.dispose(),this.contourPositions.dispose(),this.contourShader.dispose()},N.exports=function(O,F){arguments.length===1&&(O=(F=O).gl);var j=O.getExtension("OES_standard_derivatives")||O.getExtension("MOZ_OES_standard_derivatives")||O.getExtension("WEBKIT_OES_standard_derivatives");if(!j)throw new Error("derivatives not supported");var W=w(O),Z=L(O),Q=k(O),X=C(O),G=M(O),Y=P(O),K=p(O,i(new Uint8Array([255,255,255,255]),[1,1,4]));K.generateMipmap(),K.minFilter=O.LINEAR_MIPMAP_LINEAR,K.magFilter=O.LINEAR;var D=m(O),B=m(O),q=m(O),ee=m(O),J=m(O),$=g(O,[{buffer:D,type:O.FLOAT,size:3},{buffer:J,type:O.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:B,type:O.FLOAT,size:4},{buffer:q,type:O.FLOAT,size:2},{buffer:ee,type:O.FLOAT,size:3}]),te=m(O),ie=m(O),ae=m(O),he=m(O),se=g(O,[{buffer:te,type:O.FLOAT,size:3},{buffer:he,type:O.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:ie,type:O.FLOAT,size:4},{buffer:ae,type:O.FLOAT,size:2}]),de=m(O),ce=m(O),ve=m(O),ke=m(O),Ee=m(O),be=g(O,[{buffer:de,type:O.FLOAT,size:3},{buffer:Ee,type:O.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:ce,type:O.FLOAT,size:4},{buffer:ve,type:O.FLOAT,size:2},{buffer:ke,type:O.FLOAT,size:1}]),xe=m(O),ue=g(O,[{buffer:xe,type:O.FLOAT,size:3}]),me=new T(O,K,W,Z,Q,X,G,Y,D,J,B,q,ee,$,te,he,ie,ae,se,de,Ee,ce,ve,ke,be,xe,ue);return me.update(F),me}},{"./lib/closest-point":307,"./lib/shaders":308,colormap:137,"gl-buffer":261,"gl-mat4/invert":293,"gl-mat4/multiply":295,"gl-shader":332,"gl-texture2d":348,"gl-vao":353,ndarray:472,normals:475,"simplicial-complex-contour":543,"typedarray-pool":601}],310:[function(h,N,H){N.exports=function(i){var s=i.gl,o=t(s,[0,0,0,1,1,0,1,1]),a=m(s,g.boxVert,g.lineFrag);return new p(i,o,a)};var t=h("gl-buffer"),m=h("gl-shader"),g=h("./shaders");function p(i,s,o){this.plot=i,this.vbo=s,this.shader=o}var e,f,u=p.prototype;u.bind=function(){var i=this.shader;this.vbo.bind(),this.shader.bind(),i.attributes.coord.pointer(),i.uniforms.screenBox=this.plot.screenBox},u.drawBox=(e=[0,0],f=[0,0],function(i,s,o,a,c){var r=this.plot,n=this.shader,d=r.gl;e[0]=i,e[1]=s,f[0]=o,f[1]=a,n.uniforms.lo=e,n.uniforms.hi=f,n.uniforms.color=c,d.drawArrays(d.TRIANGLE_STRIP,0,4)}),u.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":313,"gl-buffer":261,"gl-shader":332}],311:[function(h,N,H){N.exports=function(r){var n=r.gl,d=t(n),l=m(n,p.gridVert,p.gridFrag),y=m(n,p.tickVert,p.gridFrag);return new e(r,d,l,y)};var t=h("gl-buffer"),m=h("gl-shader"),g=h("binary-search-bounds"),p=h("./shaders");function e(r,n,d,l){this.plot=r,this.vbo=n,this.shader=d,this.tickShader=l,this.ticks=[[],[]]}function f(r,n){return r-n}var u,i,s,o,a,c=e.prototype;c.draw=(u=[0,0],i=[0,0],s=[0,0],function(){for(var r=this.plot,n=this.vbo,d=this.shader,l=this.ticks,y=r.gl,v=r._tickBounds,_=r.dataBox,x=r.viewBox,T=r.gridLineWidth,A=r.gridLineColor,S=r.gridLineEnable,w=r.pixelRatio,L=0;L<2;++L){var k=v[L],C=v[L+2]-k,M=.5*(_[L+2]+_[L]),P=_[L+2]-_[L];i[L]=2*C/P,u[L]=2*(k-M)/P}d.bind(),n.bind(),d.attributes.dataCoord.pointer(),d.uniforms.dataShift=u,d.uniforms.dataScale=i;var O=0;for(L=0;L<2;++L){s[0]=s[1]=0,s[L]=1,d.uniforms.dataAxis=s,d.uniforms.lineWidth=T[L]/(x[L+2]-x[L])*w,d.uniforms.color=A[L];var F=6*l[L].length;S[L]&&F&&y.drawArrays(y.TRIANGLES,O,F),O+=F}}),c.drawTickMarks=function(){var r=[0,0],n=[0,0],d=[1,0],l=[0,1],y=[0,0],v=[0,0];return function(){for(var _=this.plot,x=this.vbo,T=this.tickShader,A=this.ticks,S=_.gl,w=_._tickBounds,L=_.dataBox,k=_.viewBox,C=_.pixelRatio,M=_.screenBox,P=M[2]-M[0],O=M[3]-M[1],F=k[2]-k[0],j=k[3]-k[1],W=0;W<2;++W){var Z=w[W],Q=w[W+2]-Z,X=.5*(L[W+2]+L[W]),G=L[W+2]-L[W];n[W]=2*Q/G,r[W]=2*(Z-X)/G}n[0]*=F/P,r[0]*=F/P,n[1]*=j/O,r[1]*=j/O,T.bind(),x.bind(),T.attributes.dataCoord.pointer();var Y=T.uniforms;Y.dataShift=r,Y.dataScale=n;var K=_.tickMarkLength,D=_.tickMarkWidth,B=_.tickMarkColor,q=6*A[0].length,ee=Math.min(g.ge(A[0],(L[0]-w[0])/(w[2]-w[0]),f),A[0].length),J=Math.min(g.gt(A[0],(L[2]-w[0])/(w[2]-w[0]),f),A[0].length),$=0+6*ee,te=6*Math.max(0,J-ee),ie=Math.min(g.ge(A[1],(L[1]-w[1])/(w[3]-w[1]),f),A[1].length),ae=Math.min(g.gt(A[1],(L[3]-w[1])/(w[3]-w[1]),f),A[1].length),he=q+6*ie,se=6*Math.max(0,ae-ie);y[0]=2*(k[0]-K[1])/P-1,y[1]=(k[3]+k[1])/O-1,v[0]=K[1]*C/P,v[1]=D[1]*C/O,se&&(Y.color=B[1],Y.tickScale=v,Y.dataAxis=l,Y.screenOffset=y,S.drawArrays(S.TRIANGLES,he,se)),y[0]=(k[2]+k[0])/P-1,y[1]=2*(k[1]-K[0])/O-1,v[0]=D[0]*C/P,v[1]=K[0]*C/O,te&&(Y.color=B[0],Y.tickScale=v,Y.dataAxis=d,Y.screenOffset=y,S.drawArrays(S.TRIANGLES,$,te)),y[0]=2*(k[2]+K[3])/P-1,y[1]=(k[3]+k[1])/O-1,v[0]=K[3]*C/P,v[1]=D[3]*C/O,se&&(Y.color=B[3],Y.tickScale=v,Y.dataAxis=l,Y.screenOffset=y,S.drawArrays(S.TRIANGLES,he,se)),y[0]=(k[2]+k[0])/P-1,y[1]=2*(k[3]+K[2])/O-1,v[0]=D[2]*C/P,v[1]=K[2]*C/O,te&&(Y.color=B[2],Y.tickScale=v,Y.dataAxis=d,Y.screenOffset=y,S.drawArrays(S.TRIANGLES,$,te))}}(),c.update=(o=[1,1,-1,-1,1,-1],a=[1,-1,1,1,-1,-1],function(r){for(var n=r.ticks,d=r.bounds,l=new Float32Array(18*(n[0].length+n[1].length)),y=(this.plot.zeroLineEnable,0),v=[[],[]],_=0;_<2;++_)for(var x=v[_],T=n[_],A=d[_],S=d[_+2],w=0;w<T.length;++w){var L=(T[w].x-A)/(S-A);x.push(L);for(var k=0;k<6;++k)l[y++]=L,l[y++]=o[k],l[y++]=a[k]}this.ticks=v,this.vbo.update(l)}),c.dispose=function(){this.vbo.dispose(),this.shader.dispose(),this.tickShader.dispose()}},{"./shaders":313,"binary-search-bounds":103,"gl-buffer":261,"gl-shader":332}],312:[function(h,N,H){N.exports=function(i){var s=i.gl,o=t(s,[-1,-1,-1,1,1,-1,1,1]),a=m(s,g.lineVert,g.lineFrag);return new p(i,o,a)};var t=h("gl-buffer"),m=h("gl-shader"),g=h("./shaders");function p(i,s,o){this.plot=i,this.vbo=s,this.shader=o}var e,f,u=p.prototype;u.bind=function(){var i=this.shader;this.vbo.bind(),this.shader.bind(),i.attributes.coord.pointer(),i.uniforms.screenBox=this.plot.screenBox},u.drawLine=(e=[0,0],f=[0,0],function(i,s,o,a,c,r){var n=this.plot,d=this.shader,l=n.gl;e[0]=i,e[1]=s,f[0]=o,f[1]=a,d.uniforms.start=e,d.uniforms.end=f,d.uniforms.width=c*n.pixelRatio,d.uniforms.color=r,l.drawArrays(l.TRIANGLE_STRIP,0,4)}),u.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":313,"gl-buffer":261,"gl-shader":332}],313:[function(h,N,H){var t=h("glslify"),m=t([`precision lowp float;
#define GLSLIFY 1
uniform vec4 color;
void main() {
  gl_FragColor = vec4(color.xyz * color.w, color.w);
}
`]);N.exports={lineVert:t([`precision mediump float;
#define GLSLIFY 1

attribute vec2 coord;

uniform vec4 screenBox;
uniform vec2 start, end;
uniform float width;

vec2 perp(vec2 v) {
  return vec2(v.y, -v.x);
}

vec2 screen(vec2 v) {
  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;
}

void main() {
  vec2 delta = normalize(perp(start - end));
  vec2 offset = mix(start, end, 0.5 * (coord.y+1.0));
  gl_Position = vec4(screen(offset + 0.5 * width * delta * coord.x), 0, 1);
}
`]),lineFrag:m,textVert:t([`#define GLSLIFY 1
attribute vec3 textCoordinate;

uniform vec2 dataScale, dataShift, dataAxis, screenOffset, textScale;
uniform float angle;

void main() {
  float dataOffset  = textCoordinate.z;
  vec2 glyphOffset  = textCoordinate.xy;
  mat2 glyphMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));
  vec2 screenCoordinate = dataAxis * (dataScale * dataOffset + dataShift) +
    glyphMatrix * glyphOffset * textScale + screenOffset;
  gl_Position = vec4(screenCoordinate, 0, 1);
}
`]),textFrag:m,gridVert:t([`precision mediump float;
#define GLSLIFY 1

attribute vec3 dataCoord;

uniform vec2 dataAxis, dataShift, dataScale;
uniform float lineWidth;

void main() {
  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);
  pos += 10.0 * dataCoord.y * vec2(dataAxis.y, -dataAxis.x) + dataCoord.z * lineWidth;
  gl_Position = vec4(pos, 0, 1);
}
`]),gridFrag:m,boxVert:t([`precision mediump float;
#define GLSLIFY 1

attribute vec2 coord;

uniform vec4 screenBox;
uniform vec2 lo, hi;

vec2 screen(vec2 v) {
  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;
}

void main() {
  gl_Position = vec4(screen(mix(lo, hi, coord)), 0, 1);
}
`]),tickVert:t([`precision mediump float;
#define GLSLIFY 1

attribute vec3 dataCoord;

uniform vec2 dataAxis, dataShift, dataScale, screenOffset, tickScale;

void main() {
  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);
  gl_Position = vec4(pos + tickScale*dataCoord.yz + screenOffset, 0, 1);
}
`])}},{glslify:315}],314:[function(h,N,H){N.exports=function(n){var d=n.gl,l=t(d),y=m(d,e.textVert,e.textFrag);return new f(n,l,y)};var t=h("gl-buffer"),m=h("gl-shader"),g=h("text-cache"),p=h("binary-search-bounds"),e=h("./shaders");function f(n,d,l){this.plot=n,this.vbo=d,this.shader=l,this.tickOffset=[[],[]],this.tickX=[[],[]],this.labelOffset=[0,0],this.labelCount=[0,0]}var u,i,s,o,a,c,r=f.prototype;r.drawTicks=(u=[0,0],i=[0,0],s=[0,0],function(n){var d=this.plot,l=this.shader,y=this.tickX[n],v=this.tickOffset[n],_=d.gl,x=d.viewBox,T=d.dataBox,A=d.screenBox,S=d.pixelRatio,w=d.tickEnable,L=d.tickPad,k=d.tickColor,C=d.tickAngle,M=d.labelEnable,P=d.labelPad,O=d.labelColor,F=d.labelAngle,j=this.labelOffset[n],W=this.labelCount[n],Z=p.lt(y,T[n]),Q=p.le(y,T[n+2]);u[0]=u[1]=0,u[n]=1,i[n]=(x[2+n]+x[n])/(A[2+n]-A[n])-1;var X=2/A[2+(1^n)]-A[1^n];i[1^n]=X*x[1^n]-1,w[n]&&(i[1^n]-=X*S*L[n],Z<Q&&v[Q]>v[Z]&&(l.uniforms.dataAxis=u,l.uniforms.screenOffset=i,l.uniforms.color=k[n],l.uniforms.angle=C[n],_.drawArrays(_.TRIANGLES,v[Z],v[Q]-v[Z]))),M[n]&&W&&(i[1^n]-=X*S*P[n],l.uniforms.dataAxis=s,l.uniforms.screenOffset=i,l.uniforms.color=O[n],l.uniforms.angle=F[n],_.drawArrays(_.TRIANGLES,j,W)),i[1^n]=X*x[2+(1^n)]-1,w[n+2]&&(i[1^n]+=X*S*L[n+2],Z<Q&&v[Q]>v[Z]&&(l.uniforms.dataAxis=u,l.uniforms.screenOffset=i,l.uniforms.color=k[n+2],l.uniforms.angle=C[n+2],_.drawArrays(_.TRIANGLES,v[Z],v[Q]-v[Z]))),M[n+2]&&W&&(i[1^n]+=X*S*P[n+2],l.uniforms.dataAxis=s,l.uniforms.screenOffset=i,l.uniforms.color=O[n+2],l.uniforms.angle=F[n+2],_.drawArrays(_.TRIANGLES,j,W))}),r.drawTitle=function(){var n=[0,0],d=[0,0];return function(){var l=this.plot,y=this.shader,v=l.gl,_=l.screenBox,x=l.titleCenter,T=l.titleAngle,A=l.titleColor,S=l.pixelRatio;if(this.titleCount){for(var w=0;w<2;++w)d[w]=2*(x[w]*S-_[w])/(_[2+w]-_[w])-1;y.bind(),y.uniforms.dataAxis=n,y.uniforms.screenOffset=d,y.uniforms.angle=T,y.uniforms.color=A,v.drawArrays(v.TRIANGLES,this.titleOffset,this.titleCount)}}}(),r.bind=(o=[0,0],a=[0,0],c=[0,0],function(){var n=this.plot,d=this.shader,l=n._tickBounds,y=n.dataBox,v=n.screenBox,_=n.viewBox;d.bind();for(var x=0;x<2;++x){var T=l[x],A=l[x+2]-T,S=.5*(y[x+2]+y[x]),w=y[x+2]-y[x],L=_[x],k=_[x+2]-L,C=v[x],M=v[x+2]-C;a[x]=2*A/w*k/M,o[x]=2*(T-S)/w*k/M}c[1]=2*n.pixelRatio/(v[3]-v[1]),c[0]=c[1]*(v[3]-v[1])/(v[2]-v[0]),d.uniforms.dataScale=a,d.uniforms.dataShift=o,d.uniforms.textScale=c,this.vbo.bind(),d.attributes.textCoordinate.pointer()}),r.update=function(n){var d,l,y,v,_,x=[],T=n.ticks,A=n.bounds;for(_=0;_<2;++_){var S=[Math.floor(x.length/3)],w=[-1/0],L=T[_];for(d=0;d<L.length;++d){var k=L[d],C=k.x,M=k.text,P=k.font||"sans-serif";v=k.fontSize||12;for(var O=1/(A[_+2]-A[_]),F=A[_],j=M.split(`
`),W=0;W<j.length;W++)for(y=g(P,j[W]).data,l=0;l<y.length;l+=2)x.push(y[l]*v,-y[l+1]*v-W*v*1.2,(C-F)*O);S.push(Math.floor(x.length/3)),w.push(C)}this.tickOffset[_]=S,this.tickX[_]=w}for(_=0;_<2;++_){for(this.labelOffset[_]=Math.floor(x.length/3),y=g(n.labelFont[_],n.labels[_],{textAlign:"center"}).data,v=n.labelSize[_],d=0;d<y.length;d+=2)x.push(y[d]*v,-y[d+1]*v,0);this.labelCount[_]=Math.floor(x.length/3)-this.labelOffset[_]}for(this.titleOffset=Math.floor(x.length/3),y=g(n.titleFont,n.title).data,v=n.titleSize,d=0;d<y.length;d+=2)x.push(y[d]*v,-y[d+1]*v,0);this.titleCount=Math.floor(x.length/3)-this.titleOffset,this.vbo.update(x)},r.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":313,"binary-search-bounds":103,"gl-buffer":261,"gl-shader":332,"text-cache":581}],315:[function(h,N,H){arguments[4][268][0].apply(H,arguments)},{dup:268}],316:[function(h,N,H){N.exports=function(o){var a=o.gl,c=t(a,[a.drawingBufferWidth,a.drawingBufferHeight]),r=new f(a,c);return r.grid=m(r),r.text=g(r),r.line=p(r),r.box=e(r),r.update(o),r};var t=h("gl-select-static"),m=h("./lib/grid"),g=h("./lib/text"),p=h("./lib/line"),e=h("./lib/box");function f(o,a){this.gl=o,this.pickBuffer=a,this.screenBox=[0,0,o.drawingBufferWidth,o.drawingBufferHeight],this.viewBox=[0,0,0,0],this.dataBox=[-10,-10,10,10],this.gridLineEnable=[!0,!0],this.gridLineWidth=[1,1],this.gridLineColor=[[0,0,0,1],[0,0,0,1]],this.pixelRatio=1,this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickEnable=[!0,!0,!0,!0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[15,15,15,15],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelEnable=[!0,!0,!0,!0],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.titleCenter=[0,0],this.titleEnable=!0,this.titleAngle=0,this.titleColor=[0,0,0,1],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[4,4],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderLineEnable=[!0,!0,!0,!0],this.borderLineWidth=[2,2,2,2],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.grid=null,this.text=null,this.line=null,this.box=null,this.objects=[],this.overlays=[],this._tickBounds=[1/0,1/0,-1/0,-1/0],this.static=!1,this.dirty=!1,this.pickDirty=!1,this.pickDelay=120,this.pickRadius=10,this._pickTimeout=null,this._drawPick=this.drawPick.bind(this),this._depthCounter=0}var u=f.prototype;function i(o){for(var a=o.slice(),c=0;c<a.length;++c)a[c]=a[c].slice();return a}function s(o,a){return o.x-a.x}u.setDirty=function(){this.dirty=this.pickDirty=!0},u.setOverlayDirty=function(){this.dirty=!0},u.nextDepthValue=function(){return this._depthCounter++/65536},u.draw=function(){var o=this.gl,a=this.screenBox,c=this.viewBox,r=this.dataBox,n=this.pixelRatio,d=this.grid,l=this.line,y=this.text,v=this.objects;if(this._depthCounter=0,this.pickDirty&&(this._pickTimeout&&clearTimeout(this._pickTimeout),this.pickDirty=!1,this._pickTimeout=setTimeout(this._drawPick,this.pickDelay)),this.dirty){if(this.dirty=!1,o.bindFramebuffer(o.FRAMEBUFFER,null),o.enable(o.SCISSOR_TEST),o.disable(o.DEPTH_TEST),o.depthFunc(o.LESS),o.depthMask(!1),o.enable(o.BLEND),o.blendEquation(o.FUNC_ADD,o.FUNC_ADD),o.blendFunc(o.ONE,o.ONE_MINUS_SRC_ALPHA),this.borderColor){o.scissor(a[0],a[1],a[2]-a[0],a[3]-a[1]);var _=this.borderColor;o.clearColor(_[0]*_[3],_[1]*_[3],_[2]*_[3],_[3]),o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT)}o.scissor(c[0],c[1],c[2]-c[0],c[3]-c[1]),o.viewport(c[0],c[1],c[2]-c[0],c[3]-c[1]);var x=this.backgroundColor;o.clearColor(x[0]*x[3],x[1]*x[3],x[2]*x[3],x[3]),o.clear(o.COLOR_BUFFER_BIT),d.draw();var T=this.zeroLineEnable,A=this.zeroLineColor,S=this.zeroLineWidth;if(T[0]||T[1]){l.bind();for(var w=0;w<2;++w)if(T[w]&&r[w]<=0&&r[w+2]>=0){var L=a[w]-r[w]*(a[w+2]-a[w])/(r[w+2]-r[w]);w===0?l.drawLine(L,a[1],L,a[3],S[w],A[w]):l.drawLine(a[0],L,a[2],L,S[w],A[w])}}for(w=0;w<v.length;++w)v[w].draw();o.viewport(a[0],a[1],a[2]-a[0],a[3]-a[1]),o.scissor(a[0],a[1],a[2]-a[0],a[3]-a[1]),this.grid.drawTickMarks(),l.bind();var k=this.borderLineEnable,C=this.borderLineWidth,M=this.borderLineColor;for(k[1]&&l.drawLine(c[0],c[1]-.5*C[1]*n,c[0],c[3]+.5*C[3]*n,C[1],M[1]),k[0]&&l.drawLine(c[0]-.5*C[0]*n,c[1],c[2]+.5*C[2]*n,c[1],C[0],M[0]),k[3]&&l.drawLine(c[2],c[1]-.5*C[1]*n,c[2],c[3]+.5*C[3]*n,C[3],M[3]),k[2]&&l.drawLine(c[0]-.5*C[0]*n,c[3],c[2]+.5*C[2]*n,c[3],C[2],M[2]),y.bind(),w=0;w<2;++w)y.drawTicks(w);this.titleEnable&&y.drawTitle();var P=this.overlays;for(w=0;w<P.length;++w)P[w].draw();o.disable(o.SCISSOR_TEST),o.disable(o.BLEND),o.depthMask(!0)}},u.drawPick=function(){if(!this.static){var o=this.pickBuffer;this.gl,this._pickTimeout=null,o.begin();for(var a=1,c=this.objects,r=0;r<c.length;++r)a=c[r].drawPick(a);o.end()}},u.pick=function(o,a){if(!this.static){var c=this.pixelRatio,r=this.pickPixelRatio,n=this.viewBox,d=0|Math.round((o-n[0]/c)*r),l=0|Math.round((a-n[1]/c)*r),y=this.pickBuffer.query(d,l,this.pickRadius);if(!y)return null;for(var v=y.id+(y.value[0]<<8)+(y.value[1]<<16)+(y.value[2]<<24),_=this.objects,x=0;x<_.length;++x){var T=_[x].pick(d,l,v);if(T)return T}return null}},u.setScreenBox=function(o){var a=this.screenBox,c=this.pixelRatio;a[0]=0|Math.round(o[0]*c),a[1]=0|Math.round(o[1]*c),a[2]=0|Math.round(o[2]*c),a[3]=0|Math.round(o[3]*c),this.setDirty()},u.setDataBox=function(o){var a=this.dataBox;(a[0]!==o[0]||a[1]!==o[1]||a[2]!==o[2]||a[3]!==o[3])&&(a[0]=o[0],a[1]=o[1],a[2]=o[2],a[3]=o[3],this.setDirty())},u.setViewBox=function(o){var a=this.pixelRatio,c=this.viewBox;c[0]=0|Math.round(o[0]*a),c[1]=0|Math.round(o[1]*a),c[2]=0|Math.round(o[2]*a),c[3]=0|Math.round(o[3]*a);var r=this.pickPixelRatio;this.pickBuffer.shape=[0|Math.round((o[2]-o[0])*r),0|Math.round((o[3]-o[1])*r)],this.setDirty()},u.update=function(o){o=o||{};var a=this.gl;this.pixelRatio=o.pixelRatio||1;var c=this.pixelRatio;this.pickPixelRatio=Math.max(c,1),this.setScreenBox(o.screenBox||[0,0,a.drawingBufferWidth/c,a.drawingBufferHeight/c]),this.screenBox,this.setViewBox(o.viewBox||[.125*(this.screenBox[2]-this.screenBox[0])/c,.125*(this.screenBox[3]-this.screenBox[1])/c,.875*(this.screenBox[2]-this.screenBox[0])/c,.875*(this.screenBox[3]-this.screenBox[1])/c]);var r=this.viewBox,n=(r[2]-r[0])/(r[3]-r[1]);this.setDataBox(o.dataBox||[-10,-10/n,10,10/n]),this.borderColor=o.borderColor!==!1&&(o.borderColor||[0,0,0,0]).slice(),this.backgroundColor=(o.backgroundColor||[0,0,0,0]).slice(),this.gridLineEnable=(o.gridLineEnable||[!0,!0]).slice(),this.gridLineWidth=(o.gridLineWidth||[1,1]).slice(),this.gridLineColor=i(o.gridLineColor||[[.5,.5,.5,1],[.5,.5,.5,1]]),this.zeroLineEnable=(o.zeroLineEnable||[!0,!0]).slice(),this.zeroLineWidth=(o.zeroLineWidth||[4,4]).slice(),this.zeroLineColor=i(o.zeroLineColor||[[0,0,0,1],[0,0,0,1]]),this.tickMarkLength=(o.tickMarkLength||[0,0,0,0]).slice(),this.tickMarkWidth=(o.tickMarkWidth||[0,0,0,0]).slice(),this.tickMarkColor=i(o.tickMarkColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.titleCenter=(o.titleCenter||[.5*(r[0]+r[2])/c,(r[3]+120)/c]).slice(),this.titleEnable=!("titleEnable"in o)||!!o.titleEnable,this.titleAngle=o.titleAngle||0,this.titleColor=(o.titleColor||[0,0,0,1]).slice(),this.labelPad=(o.labelPad||[15,15,15,15]).slice(),this.labelAngle=(o.labelAngle||[0,Math.PI/2,0,3*Math.PI/2]).slice(),this.labelEnable=(o.labelEnable||[!0,!0,!0,!0]).slice(),this.labelColor=i(o.labelColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.tickPad=(o.tickPad||[15,15,15,15]).slice(),this.tickAngle=(o.tickAngle||[0,0,0,0]).slice(),this.tickEnable=(o.tickEnable||[!0,!0,!0,!0]).slice(),this.tickColor=i(o.tickColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.borderLineEnable=(o.borderLineEnable||[!0,!0,!0,!0]).slice(),this.borderLineWidth=(o.borderLineWidth||[2,2,2,2]).slice(),this.borderLineColor=i(o.borderLineColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]);var d=o.ticks||[[],[]],l=this._tickBounds;l[0]=l[1]=1/0,l[2]=l[3]=-1/0;for(var y=0;y<2;++y){var v=d[y].slice(0);v.length!==0&&(v.sort(s),l[y]=Math.min(l[y],v[0].x),l[y+2]=Math.max(l[y+2],v[v.length-1].x))}this.grid.update({bounds:l,ticks:d}),this.text.update({bounds:l,ticks:d,labels:o.labels||["x","y"],labelSize:o.labelSize||[12,12],labelFont:o.labelFont||["sans-serif","sans-serif"],title:o.title||"",titleSize:o.titleSize||18,titleFont:o.titleFont||"sans-serif"}),this.static=!!o.static,this.setDirty()},u.dispose=function(){this.box.dispose(),this.grid.dispose(),this.text.dispose(),this.line.dispose();for(var o=this.objects.length-1;o>=0;--o)this.objects[o].dispose();for(this.objects.length=0,o=this.overlays.length-1;o>=0;--o)this.overlays[o].dispose();this.overlays.length=0,this.gl=null},u.addObject=function(o){this.objects.indexOf(o)<0&&(this.objects.push(o),this.setDirty())},u.removeObject=function(o){for(var a=this.objects,c=0;c<a.length;++c)if(a[c]===o){a.splice(c,1),this.setDirty();break}},u.addOverlay=function(o){this.overlays.indexOf(o)<0&&(this.overlays.push(o),this.setOverlayDirty())},u.removeOverlay=function(o){for(var a=this.overlays,c=0;c<a.length;++c)if(a[c]===o){a.splice(c,1),this.setOverlayDirty();break}}},{"./lib/box":310,"./lib/grid":311,"./lib/line":312,"./lib/text":314,"gl-select-static":331}],317:[function(h,N,H){N.exports=function(u,i){u=u||document.body,i=i||{};var s=[.01,1/0];"distanceLimits"in i&&(s[0]=i.distanceLimits[0],s[1]=i.distanceLimits[1]),"zoomMin"in i&&(s[0]=i.zoomMin),"zoomMax"in i&&(s[1]=i.zoomMax);var o=m({center:i.center||[0,0,0],up:i.up||[0,1,0],eye:i.eye||[0,0,10],mode:i.mode||"orbit",distanceLimits:s}),a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],c=0,r=u.clientWidth,n=u.clientHeight,d={keyBindingMode:"rotate",enableWheel:!0,view:o,element:u,delay:i.delay||16,rotateSpeed:i.rotateSpeed||1,zoomSpeed:i.zoomSpeed||1,translateSpeed:i.translateSpeed||1,flipX:!!i.flipX,flipY:!!i.flipY,modes:o.modes,_ortho:i._ortho||i.projection&&i.projection.type==="orthographic"||!1,tick:function(){var l=t(),y=this.delay,v=l-2*y;o.idle(l-y),o.recalcMatrix(v),o.flush(l-(100+2*y));for(var _=!0,x=o.computedMatrix,T=0;T<16;++T)_=_&&a[T]===x[T],a[T]=x[T];var A=u.clientWidth===r&&u.clientHeight===n;return r=u.clientWidth,n=u.clientHeight,_?!A:(c=Math.exp(o.computedRadius[0]),!0)},lookAt:function(l,y,v){o.lookAt(o.lastT(),l,y,v)},rotate:function(l,y,v){o.rotate(o.lastT(),l,y,v)},pan:function(l,y,v){o.pan(o.lastT(),l,y,v)},translate:function(l,y,v){o.translate(o.lastT(),l,y,v)}};return Object.defineProperties(d,{matrix:{get:function(){return o.computedMatrix},set:function(l){return o.setMatrix(o.lastT(),l),o.computedMatrix},enumerable:!0},mode:{get:function(){return o.getMode()},set:function(l){var y=o.computedUp.slice(),v=o.computedEye.slice(),_=o.computedCenter.slice();if(o.setMode(l),l==="turntable"){var x=t();o._active.lookAt(x,v,_,y),o._active.lookAt(x+500,v,_,[0,0,1]),o._active.flush(x)}return o.getMode()},enumerable:!0},center:{get:function(){return o.computedCenter},set:function(l){return o.lookAt(o.lastT(),null,l),o.computedCenter},enumerable:!0},eye:{get:function(){return o.computedEye},set:function(l){return o.lookAt(o.lastT(),l),o.computedEye},enumerable:!0},up:{get:function(){return o.computedUp},set:function(l){return o.lookAt(o.lastT(),null,null,l),o.computedUp},enumerable:!0},distance:{get:function(){return c},set:function(l){return o.setDistance(o.lastT(),l),l},enumerable:!0},distanceLimits:{get:function(){return o.getDistanceLimits(s)},set:function(l){return o.setDistanceLimits(l),l},enumerable:!0}}),u.addEventListener("contextmenu",function(l){return l.preventDefault(),!1}),d._lastX=-1,d._lastY=-1,d._lastMods={shift:!1,control:!1,alt:!1,meta:!1},d.enableMouseListeners=function(){function l(y,v,_,x){var T=d.keyBindingMode;if(T!==!1){var A=T==="rotate",S=T==="pan",w=T==="zoom",L=!!x.control,k=!!x.alt,C=!!x.shift,M=!!(1&y),P=!!(2&y),O=!!(4&y),F=1/u.clientHeight,j=F*(v-d._lastX),W=F*(_-d._lastY),Z=d.flipX?1:-1,Q=d.flipY?1:-1,X=Math.PI*d.rotateSpeed,G=t();if(d._lastX!==-1&&d._lastY!==-1&&((A&&M&&!L&&!k&&!C||M&&!L&&!k&&C)&&o.rotate(G,Z*X*j,-Q*X*W,0),(S&&M&&!L&&!k&&!C||P||M&&L&&!k&&!C)&&o.pan(G,-d.translateSpeed*j*c,d.translateSpeed*W*c,0),w&&M&&!L&&!k&&!C||O||M&&!L&&k&&!C)){var Y=-d.zoomSpeed*W/window.innerHeight*(G-o.lastT())*100;o.pan(G,0,0,c*(Math.exp(Y)-1))}return d._lastX=v,d._lastY=_,d._lastMods=x,!0}}d.mouseListener=g(u,l),u.addEventListener("touchstart",function(y){var v=e(y.changedTouches[0],u);l(0,v[0],v[1],d._lastMods),l(1,v[0],v[1],d._lastMods)},!!f&&{passive:!0}),u.addEventListener("touchmove",function(y){var v=e(y.changedTouches[0],u);l(1,v[0],v[1],d._lastMods),y.preventDefault()},!!f&&{passive:!1}),u.addEventListener("touchend",function(y){l(0,d._lastX,d._lastY,d._lastMods)},!!f&&{passive:!0}),d.wheelListener=p(u,function(y,v){if(d.keyBindingMode!==!1&&d.enableWheel){var _=d.flipX?1:-1,x=d.flipY?1:-1,T=t();if(Math.abs(y)>Math.abs(v))o.rotate(T,0,0,-y*_*Math.PI*d.rotateSpeed/window.innerWidth);else if(!d._ortho){var A=-d.zoomSpeed*x*v/window.innerHeight*(T-o.lastT())/20;o.pan(T,0,0,c*(Math.exp(A)-1))}}},!0)},d.enableMouseListeners(),d};var t=h("right-now"),m=h("3d-view"),g=h("mouse-change"),p=h("mouse-wheel"),e=h("mouse-event-offset"),f=h("has-passive-events")},{"3d-view":55,"has-passive-events":436,"mouse-change":459,"mouse-event-offset":460,"mouse-wheel":462,"right-now":528}],318:[function(h,N,H){var t=h("glslify"),m=h("gl-shader"),g=t([`precision mediump float;
#define GLSLIFY 1
attribute vec2 position;
varying vec2 uv;
void main() {
  uv = position;
  gl_Position = vec4(position, 0, 1);
}`]),p=t([`precision mediump float;
#define GLSLIFY 1

uniform sampler2D accumBuffer;
varying vec2 uv;

void main() {
  vec4 accum = texture2D(accumBuffer, 0.5 * (uv + 1.0));
  gl_FragColor = min(vec4(1,1,1,1), accum);
}`]);N.exports=function(e){return m(e,g,p,null,[{name:"position",type:"vec2"}])}},{"gl-shader":332,glslify:434}],319:[function(h,N,H){var t=h("./camera.js"),m=h("gl-axes3d"),g=h("gl-axes3d/properties"),p=h("gl-spikes3d"),e=h("gl-select-static"),f=h("gl-fbo"),u=h("a-big-triangle"),i=h("mouse-change"),s=h("gl-mat4/perspective"),o=h("gl-mat4/ortho"),a=h("./lib/shader"),c=h("is-mobile")({tablet:!0,featureDetect:!0});function r(){this.mouse=[-1,-1],this.screen=null,this.distance=1/0,this.index=null,this.dataCoordinate=null,this.dataPosition=null,this.object=null,this.data=null}function n(l){var y=Math.round(Math.log(Math.abs(l))/Math.log(10));if(y<0){var v=Math.round(Math.pow(10,-y));return Math.ceil(l*v)/v}return y>0?(v=Math.round(Math.pow(10,y)),Math.ceil(l/v)*v):Math.ceil(l)}function d(l){return typeof l!="boolean"||l}N.exports={createScene:function(l){(l=l||{}).camera=l.camera||{};var y=l.canvas;y||(y=document.createElement("canvas"),l.container?l.container.appendChild(y):document.body.appendChild(y));var v=l.gl;if(v||(l.glOptions&&(c=!!l.glOptions.preserveDrawingBuffer),v=function(ae,he){var se=null;try{(se=ae.getContext("webgl",he))||(se=ae.getContext("experimental-webgl",he))}catch(de){return null}return se}(y,l.glOptions||{premultipliedAlpha:!0,antialias:!0,preserveDrawingBuffer:c})),!v)throw new Error("webgl not supported");var _=l.bounds||[[-10,-10,-10],[10,10,10]],x=new r,T=f(v,v.drawingBufferWidth,v.drawingBufferHeight,{preferFloat:!c}),A=a(v),S=l.cameraObject&&l.cameraObject._ortho===!0||l.camera.projection&&l.camera.projection.type==="orthographic"||!1,w={eye:l.camera.eye||[2,0,0],center:l.camera.center||[0,0,0],up:l.camera.up||[0,1,0],zoomMin:l.camera.zoomMax||.1,zoomMax:l.camera.zoomMin||100,mode:l.camera.mode||"turntable",_ortho:S},L=l.axes||{},k=m(v,L);k.enable=!L.disable;var C=l.spikes||{},M=p(v,C),P=[],O=[],F=[],j=[],W=!0,Z=!0,Q=new Array(16),X=new Array(16),G={view:null,projection:Q,model:X,_ortho:!1},Y=(Z=!0,[v.drawingBufferWidth,v.drawingBufferHeight]),K=l.cameraObject||t(y,w),D={gl:v,contextLost:!1,pixelRatio:l.pixelRatio||1,canvas:y,selection:x,camera:K,axes:k,axesPixels:null,spikes:M,bounds:_,objects:P,shape:Y,aspect:l.aspectRatio||[1,1,1],pickRadius:l.pickRadius||10,zNear:l.zNear||.01,zFar:l.zFar||1e3,fovy:l.fovy||Math.PI/4,clearColor:l.clearColor||[0,0,0,0],autoResize:d(l.autoResize),autoBounds:d(l.autoBounds),autoScale:!!l.autoScale,autoCenter:d(l.autoCenter),clipToBounds:d(l.clipToBounds),snapToData:!!l.snapToData,onselect:l.onselect||null,onrender:l.onrender||null,onclick:l.onclick||null,cameraParams:G,oncontextloss:null,mouseListener:null,_stopped:!1,getAspectratio:function(){return{x:this.aspect[0],y:this.aspect[1],z:this.aspect[2]}},setAspectratio:function(ae){this.aspect[0]=ae.x,this.aspect[1]=ae.y,this.aspect[2]=ae.z,Z=!0},setBounds:function(ae,he){this.bounds[0][ae]=he.min,this.bounds[1][ae]=he.max},setClearColor:function(ae){this.clearColor=ae},clearRGBA:function(){this.gl.clearColor(this.clearColor[0],this.clearColor[1],this.clearColor[2],this.clearColor[3]),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}},B=[v.drawingBufferWidth/D.pixelRatio|0,v.drawingBufferHeight/D.pixelRatio|0];function q(){if(!D._stopped&&D.autoResize){var ae=y.parentNode,he=1,se=1;ae&&ae!==document.body?(he=ae.clientWidth,se=ae.clientHeight):(he=window.innerWidth,se=window.innerHeight);var de=0|Math.ceil(he*D.pixelRatio),ce=0|Math.ceil(se*D.pixelRatio);if(de!==y.width||ce!==y.height){y.width=de,y.height=ce;var ve=y.style;ve.position=ve.position||"absolute",ve.left="0px",ve.top="0px",ve.width=he+"px",ve.height=se+"px",W=!0}}}D.autoResize&&q();function ee(){for(var ae=P.length,he=j.length,se=0;se<he;++se)F[se]=0;e:for(se=0;se<ae;++se){var de=P[se],ce=de.pickSlots;if(ce){for(var ve=0;ve<he;++ve)if(F[ve]+ce<255){O[se]=ve,de.setPickBase(F[ve]+1),F[ve]+=ce;continue e}var ke=e(v,Y);O[se]=he,j.push(ke),F.push(ce),de.setPickBase(1),he+=1}else O[se]=-1}for(;he>0&&F[he-1]===0;)F.pop(),j.pop().dispose()}function J(){if(D.contextLost)return!0;v.isContextLost()&&(D.contextLost=!0,D.mouseListener.enabled=!1,D.selection.object=null,D.oncontextloss&&D.oncontextloss())}window.addEventListener("resize",q),D.update=function(ae){D._stopped||(W=!0,Z=!0)},D.add=function(ae){D._stopped||(ae.axes=k,P.push(ae),O.push(-1),W=!0,Z=!0,ee())},D.remove=function(ae){if(!D._stopped){var he=P.indexOf(ae);he<0||(P.splice(he,1),O.pop(),W=!0,Z=!0,ee())}},D.dispose=function(){if(!D._stopped&&(D._stopped=!0,window.removeEventListener("resize",q),y.removeEventListener("webglcontextlost",J),D.mouseListener.enabled=!1,!D.contextLost)){k.dispose(),M.dispose();for(var ae=0;ae<P.length;++ae)P[ae].dispose();for(T.dispose(),ae=0;ae<j.length;++ae)j[ae].dispose();A.dispose(),v=null,k=null,M=null,P=[]}},D._mouseRotating=!1,D._prevButtons=0,D.enableMouseListeners=function(){D.mouseListener=i(y,function(ae,he,se){if(!D._stopped){var de=j.length,ce=P.length,ve=x.object;x.distance=1/0,x.mouse[0]=he,x.mouse[1]=se,x.object=null,x.screen=null,x.dataCoordinate=x.dataPosition=null;var ke=!1;if(ae&&D._prevButtons)D._mouseRotating=!0;else{D._mouseRotating&&(Z=!0),D._mouseRotating=!1;for(var Ee=0;Ee<de;++Ee){var be=j[Ee].query(he,B[1]-se-1,D.pickRadius);if(be){if(be.distance>x.distance)continue;for(var xe=0;xe<ce;++xe){var ue=P[xe];if(O[xe]===Ee){var me=ue.pick(be);me&&(x.buttons=ae,x.screen=be.coord,x.distance=be.distance,x.object=ue,x.index=me.distance,x.dataPosition=me.position,x.dataCoordinate=me.dataCoordinate,x.data=me,ke=!0)}}}}}ve&&ve!==x.object&&(ve.highlight&&ve.highlight(null),W=!0),x.object&&(x.object.highlight&&x.object.highlight(x.data),W=!0),(ke=ke||x.object!==ve)&&D.onselect&&D.onselect(x),1&ae&&!(1&D._prevButtons)&&D.onclick&&D.onclick(x),D._prevButtons=ae}})},y.addEventListener("webglcontextlost",J);var $=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],te=[$[0].slice(),$[1].slice()];function ie(){if(!J()){q();var ae=D.camera.tick();G.view=D.camera.matrix,W=W||ae,Z=Z||ae,k.pixelRatio=D.pixelRatio,M.pixelRatio=D.pixelRatio;var he=P.length,se=$[0],de=$[1];se[0]=se[1]=se[2]=1/0,de[0]=de[1]=de[2]=-1/0;for(var ce=0;ce<he;++ce){(Fe=P[ce]).pixelRatio=D.pixelRatio,Fe.axes=D.axes,W=W||!!Fe.dirty,Z=Z||!!Fe.dirty;var ve=Fe.bounds;if(ve)for(var ke=ve[0],Ee=ve[1],be=0;be<3;++be)se[be]=Math.min(se[be],ke[be]),de[be]=Math.max(de[be],Ee[be])}var xe=D.bounds;if(D.autoBounds)for(be=0;be<3;++be){if(de[be]<se[be])se[be]=-1,de[be]=1;else{se[be]===de[be]&&(se[be]-=1,de[be]+=1);var ue=.05*(de[be]-se[be]);se[be]=se[be]-ue,de[be]=de[be]+ue}xe[0][be]=se[be],xe[1][be]=de[be]}var me=!1;for(be=0;be<3;++be)me=me||te[0][be]!==xe[0][be]||te[1][be]!==xe[1][be],te[0][be]=xe[0][be],te[1][be]=xe[1][be];if(Z=Z||me,W=W||me){if(me){var we=[0,0,0];for(ce=0;ce<3;++ce)we[ce]=n((xe[1][ce]-xe[0][ce])/10);k.autoTicks?k.update({bounds:xe,tickSpacing:we}):k.update({bounds:xe})}var Me=v.drawingBufferWidth,Se=v.drawingBufferHeight;for(Y[0]=Me,Y[1]=Se,B[0]=0|Math.max(Me/D.pixelRatio,1),B[1]=0|Math.max(Se/D.pixelRatio,1),function(Ye,et){var Oe=Ye.bounds,je=Ye.cameraParams,We=je.projection,Ge=je.model,Qe=Ye.gl.drawingBufferWidth,it=Ye.gl.drawingBufferHeight,lt=Ye.zNear,Lt=Ye.zFar,wt=Ye.fovy,rt=Qe/it;et?(o(We,-rt,rt,-1,1,lt,Lt),je._ortho=!0):(s(We,wt,rt,lt,Lt),je._ortho=!1);for(var $e=0;$e<16;++$e)Ge[$e]=0;Ge[15]=1;var xt=0;for($e=0;$e<3;++$e)xt=Math.max(xt,Oe[1][$e]-Oe[0][$e]);for($e=0;$e<3;++$e)Ye.autoScale?Ge[5*$e]=Ye.aspect[$e]/(Oe[1][$e]-Oe[0][$e]):Ge[5*$e]=1/xt,Ye.autoCenter&&(Ge[12+$e]=.5*-Ge[5*$e]*(Oe[0][$e]+Oe[1][$e]))}(D,S),ce=0;ce<he;++ce)(Fe=P[ce]).axesBounds=xe,D.clipToBounds&&(Fe.clipBounds=xe);x.object&&(D.snapToData?M.position=x.dataCoordinate:M.position=x.dataPosition,M.bounds=xe),Z&&(Z=!1,function(){if(!J()){v.colorMask(!0,!0,!0,!0),v.depthMask(!0),v.disable(v.BLEND),v.enable(v.DEPTH_TEST),v.depthFunc(v.LEQUAL);for(var Ye=P.length,et=j.length,Oe=0;Oe<et;++Oe){var je=j[Oe];je.shape=B,je.begin();for(var We=0;We<Ye;++We)if(O[We]===Oe){var Ge=P[We];Ge.drawPick&&(Ge.pixelRatio=1,Ge.drawPick(G))}je.end()}}}()),D.axesPixels=g(D.axes,G,Me,Se),D.onrender&&D.onrender(),v.bindFramebuffer(v.FRAMEBUFFER,null),v.viewport(0,0,Me,Se),D.clearRGBA(),v.depthMask(!0),v.colorMask(!0,!0,!0,!0),v.enable(v.DEPTH_TEST),v.depthFunc(v.LEQUAL),v.disable(v.BLEND),v.disable(v.CULL_FACE);var De=!1;for(k.enable&&(De=De||k.isTransparent(),k.draw(G)),M.axes=k,x.object&&M.draw(G),v.disable(v.CULL_FACE),ce=0;ce<he;++ce)(Fe=P[ce]).axes=k,Fe.pixelRatio=D.pixelRatio,Fe.isOpaque&&Fe.isOpaque()&&Fe.draw(G),Fe.isTransparent&&Fe.isTransparent()&&(De=!0);if(De){for(T.shape=Y,T.bind(),v.clear(v.DEPTH_BUFFER_BIT),v.colorMask(!1,!1,!1,!1),v.depthMask(!0),v.depthFunc(v.LESS),k.enable&&k.isTransparent()&&k.drawTransparent(G),ce=0;ce<he;++ce)(Fe=P[ce]).isOpaque&&Fe.isOpaque()&&Fe.draw(G);for(v.enable(v.BLEND),v.blendEquation(v.FUNC_ADD),v.blendFunc(v.ONE,v.ONE_MINUS_SRC_ALPHA),v.colorMask(!0,!0,!0,!0),v.depthMask(!1),v.clearColor(0,0,0,0),v.clear(v.COLOR_BUFFER_BIT),k.isTransparent()&&k.drawTransparent(G),ce=0;ce<he;++ce){var Fe;(Fe=P[ce]).isTransparent&&Fe.isTransparent()&&Fe.drawTransparent(G)}v.bindFramebuffer(v.FRAMEBUFFER,null),v.blendFunc(v.ONE,v.ONE_MINUS_SRC_ALPHA),v.disable(v.DEPTH_TEST),A.bind(),T.color[0].bind(0),A.uniforms.accumBuffer=0,u(v),v.disable(v.BLEND)}for(W=!1,ce=0;ce<he;++ce)P[ce].dirty=!1}}}return D.enableMouseListeners(),function ae(){D._stopped||D.contextLost||(ie(),requestAnimationFrame(ae))}(),D.redraw=function(){D._stopped||(W=!0,ie())},D},createCamera:t}},{"./camera.js":317,"./lib/shader":318,"a-big-triangle":70,"gl-axes3d":253,"gl-axes3d/properties":260,"gl-fbo":270,"gl-mat4/ortho":296,"gl-mat4/perspective":297,"gl-select-static":331,"gl-spikes3d":341,"is-mobile":445,"mouse-change":459}],320:[function(h,N,H){var t=h("glslify");H.pointVertex=t([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;

uniform mat3 matrix;
uniform float pointSize;
uniform float pointCloud;

highp float rand(vec2 co) {
  highp float a = 12.9898;
  highp float b = 78.233;
  highp float c = 43758.5453;
  highp float d = dot(co.xy, vec2(a, b));
  highp float e = mod(d, 3.14);
  return fract(sin(e) * c);
}

void main() {
  vec3 hgPosition = matrix * vec3(position, 1);
  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);
    // if we don't jitter the point size a bit, overall point cloud
    // saturation 'jumps' on zooming, which is disturbing and confusing
  gl_PointSize = pointSize * ((19.5 + rand(position)) / 20.0);
  if(pointCloud != 0.0) { // pointCloud is truthy
    // get the same square surface as circle would be
    gl_PointSize *= 0.886;
  }
}`]),H.pointFragment=t([`precision mediump float;
#define GLSLIFY 1

uniform vec4 color, borderColor;
uniform float centerFraction;
uniform float pointCloud;

void main() {
  float radius;
  vec4 baseColor;
  if(pointCloud != 0.0) { // pointCloud is truthy
    if(centerFraction == 1.0) {
      gl_FragColor = color;
    } else {
      gl_FragColor = mix(borderColor, color, centerFraction);
    }
  } else {
    radius = length(2.0 * gl_PointCoord.xy - 1.0);
    if(radius > 1.0) {
      discard;
    }
    baseColor = mix(borderColor, color, step(radius, centerFraction));
    gl_FragColor = vec4(baseColor.rgb * baseColor.a, baseColor.a);
  }
}
`]),H.pickVertex=t([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 pickId;

uniform mat3 matrix;
uniform float pointSize;
uniform vec4 pickOffset;

varying vec4 fragId;

void main() {
  vec3 hgPosition = matrix * vec3(position, 1);
  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);
  gl_PointSize = pointSize;

  vec4 id = pickId + pickOffset;
  id.y += floor(id.x / 256.0);
  id.x -= floor(id.x / 256.0) * 256.0;

  id.z += floor(id.y / 256.0);
  id.y -= floor(id.y / 256.0) * 256.0;

  id.w += floor(id.z / 256.0);
  id.z -= floor(id.z / 256.0) * 256.0;

  fragId = id;
}
`]),H.pickFragment=t([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragId;

void main() {
  float radius = length(2.0 * gl_PointCoord.xy - 1.0);
  if(radius > 1.0) {
    discard;
  }
  gl_FragColor = fragId / 255.0;
}
`])},{glslify:434}],321:[function(h,N,H){var t=h("gl-shader"),m=h("gl-buffer"),g=h("typedarray-pool"),p=h("./lib/shader");function e(s,o,a,c,r){this.plot=s,this.offsetBuffer=o,this.pickBuffer=a,this.shader=c,this.pickShader=r,this.sizeMin=.5,this.sizeMinCap=2,this.sizeMax=20,this.areaRatio=1,this.pointCount=0,this.color=[1,0,0,1],this.borderColor=[0,0,0,1],this.blend=!1,this.pickOffset=0,this.points=null}N.exports=function(s,o){var a=s.gl,c=m(a),r=m(a),n=t(a,p.pointVertex,p.pointFragment),d=t(a,p.pickVertex,p.pickFragment),l=new e(s,c,r,n,d);return l.update(o),s.addObject(l),l};var f,u,i=e.prototype;i.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.offsetBuffer.dispose(),this.pickBuffer.dispose(),this.plot.removeObject(this)},i.update=function(s){var o;function a(v,_){return v in s?s[v]:_}s=s||{},this.sizeMin=a("sizeMin",.5),this.sizeMax=a("sizeMax",20),this.color=a("color",[1,0,0,1]).slice(),this.areaRatio=a("areaRatio",1),this.borderColor=a("borderColor",[0,0,0,1]).slice(),this.blend=a("blend",!1);var c=s.positions.length>>>1,r=s.positions instanceof Float32Array,n=s.idToIndex instanceof Int32Array&&s.idToIndex.length>=c,d=s.positions,l=r?d:g.mallocFloat32(d.length),y=n?s.idToIndex:g.mallocInt32(c);if(r||l.set(d),!n)for(l.set(d),o=0;o<c;o++)y[o]=o;this.points=d,this.offsetBuffer.update(l),this.pickBuffer.update(y),r||g.free(l),n||g.free(y),this.pointCount=c,this.pickOffset=0},i.unifiedDraw=(f=[1,0,0,0,1,0,0,0,1],u=[0,0,0,0],function(s){var o=s!==void 0,a=o?this.pickShader:this.shader,c=this.plot.gl,r=this.plot.dataBox;if(this.pointCount===0)return s;var n=r[2]-r[0],d=r[3]-r[1],l=function(x,T){var A,S=0,w=x.length>>>1;for(A=0;A<w;A++){var L=x[2*A],k=x[2*A+1];L>=T[0]&&L<=T[2]&&k>=T[1]&&k<=T[3]&&S++}return S}(this.points,r),y=this.plot.pickPixelRatio*Math.max(Math.min(this.sizeMinCap,this.sizeMin),Math.min(this.sizeMax,this.sizeMax/Math.pow(l,.33333)));f[0]=2/n,f[4]=2/d,f[6]=-2*r[0]/n-1,f[7]=-2*r[1]/d-1,this.offsetBuffer.bind(),a.bind(),a.attributes.position.pointer(),a.uniforms.matrix=f,a.uniforms.color=this.color,a.uniforms.borderColor=this.borderColor,a.uniforms.pointCloud=y<5,a.uniforms.pointSize=y,a.uniforms.centerFraction=Math.min(1,Math.max(0,Math.sqrt(1-this.areaRatio))),o&&(u[0]=255&s,u[1]=s>>8&255,u[2]=s>>16&255,u[3]=s>>24&255,this.pickBuffer.bind(),a.attributes.pickId.pointer(c.UNSIGNED_BYTE),a.uniforms.pickOffset=u,this.pickOffset=s);var v=c.getParameter(c.BLEND),_=c.getParameter(c.DITHER);return v&&!this.blend&&c.disable(c.BLEND),_&&c.disable(c.DITHER),c.drawArrays(c.POINTS,0,this.pointCount),v&&!this.blend&&c.enable(c.BLEND),_&&c.enable(c.DITHER),s+this.pointCount}),i.draw=i.unifiedDraw,i.drawPick=i.unifiedDraw,i.pick=function(s,o,a){var c=this.pickOffset,r=this.pointCount;if(a<c||a>=c+r)return null;var n=a-c,d=this.points;return{object:this,pointId:n,dataCoord:[d[2*n],d[2*n+1]]}}},{"./lib/shader":320,"gl-buffer":261,"gl-shader":332,"typedarray-pool":601}],322:[function(h,N,H){N.exports=function(t,m,g,p){var e,f,u,i,s,o=m[0],a=m[1],c=m[2],r=m[3],n=g[0],d=g[1],l=g[2],y=g[3];return(f=o*n+a*d+c*l+r*y)<0&&(f=-f,n=-n,d=-d,l=-l,y=-y),1-f>1e-6?(e=Math.acos(f),u=Math.sin(e),i=Math.sin((1-p)*e)/u,s=Math.sin(p*e)/u):(i=1-p,s=p),t[0]=i*o+s*n,t[1]=i*a+s*d,t[2]=i*c+s*l,t[3]=i*r+s*y,t}},{}],323:[function(h,N,H){N.exports=function(t){return t||t===0?t.toString():""}},{}],324:[function(h,N,H){var t=h("vectorize-text");N.exports=function(g,p,e){var f=m[p];if(f||(f=m[p]={}),g in f)return f[g];var u={textAlign:"center",textBaseline:"middle",lineHeight:1,font:p,lineSpacing:1.25,styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0},triangles:!0},i=t(g,u);u.triangles=!1;var s,o,a=t(g,u);if(e&&e!==1){for(s=0;s<i.positions.length;++s)for(o=0;o<i.positions[s].length;++o)i.positions[s][o]/=e;for(s=0;s<a.positions.length;++s)for(o=0;o<a.positions[s].length;++o)a.positions[s][o]/=e}var c=[[1/0,1/0],[-1/0,-1/0]],r=a.positions.length;for(s=0;s<r;++s){var n=a.positions[s];for(o=0;o<2;++o)c[0][o]=Math.min(c[0][o],n[o]),c[1][o]=Math.max(c[1][o],n[o])}return f[g]=[i,a,c]};var m={}},{"vectorize-text":607}],325:[function(h,N,H){var t=h("gl-shader"),m=h("glslify"),g=m([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform vec4 highlightId;
uniform float highlightScale;
uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float scale = 1.0;
    if(distance(highlightId, id) < 0.0001) {
      scale = highlightScale;
    }

    vec4 worldPosition = model * vec4(position, 1);
    vec4 viewPosition = view * worldPosition;
    viewPosition = viewPosition / viewPosition.w;
    vec4 clipPosition = projection * (viewPosition + scale * vec4(glyph.x, -glyph.y, 0, 0));

    gl_Position = clipPosition;
    interpColor = color;
    pickId = id;
    dataCoordinate = position;
  }
}`]),p=m([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform vec2 screenSize;
uniform vec3 clipBounds[2];
uniform float highlightScale, pixelRatio;
uniform vec4 highlightId;

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float scale = pixelRatio;
    if(distance(highlightId.bgr, id.bgr) < 0.001) {
      scale *= highlightScale;
    }

    vec4 worldPosition = model * vec4(position, 1.0);
    vec4 viewPosition = view * worldPosition;
    vec4 clipPosition = projection * viewPosition;
    clipPosition /= clipPosition.w;

    gl_Position = clipPosition + vec4(screenSize * scale * vec2(glyph.x, -glyph.y), 0.0, 0.0);
    interpColor = color;
    pickId = id;
    dataCoordinate = position;
  }
}`]),e=m([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform float highlightScale;
uniform vec4 highlightId;
uniform vec3 axes[2];
uniform mat4 model, view, projection;
uniform vec2 screenSize;
uniform vec3 clipBounds[2];
uniform float scale, pixelRatio;

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float lscale = pixelRatio * scale;
    if(distance(highlightId, id) < 0.0001) {
      lscale *= highlightScale;
    }

    vec4 clipCenter   = projection * view * model * vec4(position, 1);
    vec3 dataPosition = position + 0.5*lscale*(axes[0] * glyph.x + axes[1] * glyph.y) * clipCenter.w * screenSize.y;
    vec4 clipPosition = projection * view * model * vec4(dataPosition, 1);

    gl_Position = clipPosition;
    interpColor = color;
    pickId = id;
    dataCoordinate = dataPosition;
  }
}
`]),f=m([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 fragClipBounds[2];
uniform float opacity;

varying vec4 interpColor;
varying vec3 dataCoordinate;

void main() {
  if (
    outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate) ||
    interpColor.a * opacity == 0.
  ) discard;
  gl_FragColor = interpColor * opacity;
}
`]),u=m([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 fragClipBounds[2];
uniform float pickGroup;

varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate)) discard;

  gl_FragColor = vec4(pickGroup, pickId.bgr);
}`]),i=[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"glyph",type:"vec2"},{name:"id",type:"vec4"}],s={vertex:g,fragment:f,attributes:i},o={vertex:p,fragment:f,attributes:i},a={vertex:e,fragment:f,attributes:i},c={vertex:g,fragment:u,attributes:i},r={vertex:p,fragment:u,attributes:i},n={vertex:e,fragment:u,attributes:i};function d(l,y){var v=t(l,y),_=v.attributes;return _.position.location=0,_.color.location=1,_.glyph.location=2,_.id.location=3,v}H.createPerspective=function(l){return d(l,s)},H.createOrtho=function(l){return d(l,o)},H.createProject=function(l){return d(l,a)},H.createPickPerspective=function(l){return d(l,c)},H.createPickOrtho=function(l){return d(l,r)},H.createPickProject=function(l){return d(l,n)}},{"gl-shader":332,glslify:326}],326:[function(h,N,H){arguments[4][268][0].apply(H,arguments)},{dup:268}],327:[function(h,N,H){var t=h("is-string-blank"),m=h("gl-buffer"),g=h("gl-vao"),p=h("typedarray-pool"),e=h("gl-mat4/multiply"),f=h("./lib/shaders"),u=h("./lib/glyphs"),i=h("./lib/get-simple-string"),s=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function o(F,j){var W=F[0],Z=F[1],Q=F[2],X=F[3];return F[0]=j[0]*W+j[4]*Z+j[8]*Q+j[12]*X,F[1]=j[1]*W+j[5]*Z+j[9]*Q+j[13]*X,F[2]=j[2]*W+j[6]*Z+j[10]*Q+j[14]*X,F[3]=j[3]*W+j[7]*Z+j[11]*Q+j[15]*X,F}function a(F,j,W,Z){return o(Z,Z),o(Z,Z),o(Z,Z)}function c(F,j){this.index=F,this.dataCoordinate=this.position=j}function r(F){return F===!0||F>1?1:F}function n(F,j,W,Z,Q,X,G,Y,K,D,B,q){this.gl=F,this.pixelRatio=1,this.shader=j,this.orthoShader=W,this.projectShader=Z,this.pointBuffer=Q,this.colorBuffer=X,this.glyphBuffer=G,this.idBuffer=Y,this.vao=K,this.vertexCount=0,this.lineVertexCount=0,this.opacity=1,this.hasAlpha=!1,this.lineWidth=0,this.projectScale=[2/3,2/3,2/3],this.projectOpacity=[1,1,1],this.projectHasAlpha=!1,this.pickId=0,this.pickPerspectiveShader=D,this.pickOrthoShader=B,this.pickProjectShader=q,this.points=[],this._selectResult=new c(0,[0,0,0]),this.useOrtho=!0,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.axesProject=[!0,!0,!0],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.highlightId=[1,1,1,1],this.highlightScale=2,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.dirty=!0}N.exports=function(F){var j=F.gl,W=f.createPerspective(j),Z=f.createOrtho(j),Q=f.createProject(j),X=f.createPickPerspective(j),G=f.createPickOrtho(j),Y=f.createPickProject(j),K=m(j),D=m(j),B=m(j),q=m(j),ee=g(j,[{buffer:K,size:3,type:j.FLOAT},{buffer:D,size:4,type:j.FLOAT},{buffer:B,size:2,type:j.FLOAT},{buffer:q,size:4,type:j.UNSIGNED_BYTE,normalized:!0}]),J=new n(j,W,Z,Q,K,D,B,q,ee,X,G,Y);return J.update(F),J};var d=n.prototype;d.pickSlots=1,d.setPickBase=function(F){this.pickId=F},d.isTransparent=function(){if(this.hasAlpha)return!0;for(var F=0;F<3;++F)if(this.axesProject[F]&&this.projectHasAlpha)return!0;return!1},d.isOpaque=function(){if(!this.hasAlpha)return!0;for(var F=0;F<3;++F)if(this.axesProject[F]&&!this.projectHasAlpha)return!0;return!1};var l=[0,0],y=[0,0,0],v=[0,0,0],_=[0,0,0,1],x=[0,0,0,1],T=s.slice(),A=[0,0,0],S=[[0,0,0],[0,0,0]];function w(F){return F[0]=F[1]=F[2]=0,F}function L(F,j){return F[0]=j[0],F[1]=j[1],F[2]=j[2],F[3]=1,F}function k(F,j,W,Z){return F[0]=j[0],F[1]=j[1],F[2]=j[2],F[W]=Z,F}function C(F,j,W,Z){var Q,X=j.axesProject,G=j.gl,Y=F.uniforms,K=W.model||s,D=W.view||s,B=W.projection||s,q=j.axesBounds,ee=function(xe){for(var ue=S,me=0;me<2;++me)for(var we=0;we<3;++we)ue[me][we]=Math.max(Math.min(xe[me][we],1e8),-1e8);return ue}(j.clipBounds);Q=j.axes&&j.axes.lastCubeProps?j.axes.lastCubeProps.axis:[1,1,1],l[0]=2/G.drawingBufferWidth,l[1]=2/G.drawingBufferHeight,F.bind(),Y.view=D,Y.projection=B,Y.screenSize=l,Y.highlightId=j.highlightId,Y.highlightScale=j.highlightScale,Y.clipBounds=ee,Y.pickGroup=j.pickId/255,Y.pixelRatio=Z;for(var J=0;J<3;++J)if(X[J]){Y.scale=j.projectScale[J],Y.opacity=j.projectOpacity[J];for(var $=T,te=0;te<16;++te)$[te]=0;for(te=0;te<4;++te)$[5*te]=1;$[5*J]=0,Q[J]<0?$[12+J]=q[0][J]:$[12+J]=q[1][J],e($,K,$),Y.model=$;var ie=(J+1)%3,ae=(J+2)%3,he=w(y),se=w(v);he[ie]=1,se[ae]=1;var de=a(0,0,0,L(_,he)),ce=a(0,0,0,L(x,se));if(Math.abs(de[1])>Math.abs(ce[1])){var ve=de;de=ce,ce=ve,ve=he,he=se,se=ve;var ke=ie;ie=ae,ae=ke}de[0]<0&&(he[ie]=-1),ce[1]>0&&(se[ae]=-1);var Ee=0,be=0;for(te=0;te<4;++te)Ee+=Math.pow(K[4*ie+te],2),be+=Math.pow(K[4*ae+te],2);he[ie]/=Math.sqrt(Ee),se[ae]/=Math.sqrt(be),Y.axes[0]=he,Y.axes[1]=se,Y.fragClipBounds[0]=k(A,ee[0],J,-1e8),Y.fragClipBounds[1]=k(A,ee[1],J,1e8),j.vao.bind(),j.vao.draw(G.TRIANGLES,j.vertexCount),j.lineWidth>0&&(G.lineWidth(j.lineWidth*Z),j.vao.draw(G.LINES,j.lineVertexCount,j.vertexCount)),j.vao.unbind()}}var M=[[-1e8,-1e8,-1e8],[1e8,1e8,1e8]];function P(F,j,W,Z,Q,X,G){var Y=W.gl;if((X===W.projectHasAlpha||G)&&C(j,W,Z,Q),X===W.hasAlpha||G){F.bind();var K=F.uniforms;K.model=Z.model||s,K.view=Z.view||s,K.projection=Z.projection||s,l[0]=2/Y.drawingBufferWidth,l[1]=2/Y.drawingBufferHeight,K.screenSize=l,K.highlightId=W.highlightId,K.highlightScale=W.highlightScale,K.fragClipBounds=M,K.clipBounds=W.axes.bounds,K.opacity=W.opacity,K.pickGroup=W.pickId/255,K.pixelRatio=Q,W.vao.bind(),W.vao.draw(Y.TRIANGLES,W.vertexCount),W.lineWidth>0&&(Y.lineWidth(W.lineWidth*Q),W.vao.draw(Y.LINES,W.lineVertexCount,W.vertexCount)),W.vao.unbind()}}function O(F,j,W,Z){var Q;Q=Array.isArray(F)?j<F.length?F[j]:void 0:F,Q=i(Q);var X=!0;t(Q)&&(Q="\u25BC",X=!1);var G=u(Q,W,Z);return{mesh:G[0],lines:G[1],bounds:G[2],visible:X}}d.draw=function(F){P(this.useOrtho?this.orthoShader:this.shader,this.projectShader,this,F,this.pixelRatio,!1,!1)},d.drawTransparent=function(F){P(this.useOrtho?this.orthoShader:this.shader,this.projectShader,this,F,this.pixelRatio,!0,!1)},d.drawPick=function(F){P(this.useOrtho?this.pickOrthoShader:this.pickPerspectiveShader,this.pickProjectShader,this,F,1,!0,!0)},d.pick=function(F){if(!F||F.id!==this.pickId)return null;var j=F.value[2]+(F.value[1]<<8)+(F.value[0]<<16);if(j>=this.pointCount||j<0)return null;var W=this.points[j],Z=this._selectResult;Z.index=j;for(var Q=0;Q<3;++Q)Z.position[Q]=Z.dataCoordinate[Q]=W[Q];return Z},d.highlight=function(F){if(F){var j=F.index,W=255&j,Z=j>>8&255,Q=j>>16&255;this.highlightId=[W/255,Z/255,Q/255,0]}else this.highlightId=[1,1,1,1]},d.update=function(F){if("perspective"in(F=F||{})&&(this.useOrtho=!F.perspective),"orthographic"in F&&(this.useOrtho=!!F.orthographic),"lineWidth"in F&&(this.lineWidth=F.lineWidth),"project"in F)if(Array.isArray(F.project))this.axesProject=F.project;else{var j=!!F.project;this.axesProject=[j,j,j]}if("projectScale"in F)if(Array.isArray(F.projectScale))this.projectScale=F.projectScale.slice();else{var W=+F.projectScale;this.projectScale=[W,W,W]}if(this.projectHasAlpha=!1,"projectOpacity"in F){Array.isArray(F.projectOpacity)?this.projectOpacity=F.projectOpacity.slice():(W=+F.projectOpacity,this.projectOpacity=[W,W,W]);for(var Z=0;Z<3;++Z)this.projectOpacity[Z]=r(this.projectOpacity[Z]),this.projectOpacity[Z]<1&&(this.projectHasAlpha=!0)}this.hasAlpha=!1,"opacity"in F&&(this.opacity=r(F.opacity),this.opacity<1&&(this.hasAlpha=!0)),this.dirty=!0;var Q,X,G=F.position,Y=F.font||"normal",K=F.alignment||[0,0];if(K.length===2)Q=K[0],X=K[1];else for(Q=[],X=[],Z=0;Z<K.length;++Z)Q[Z]=K[Z][0],X[Z]=K[Z][1];var D=[1/0,1/0,1/0],B=[-1/0,-1/0,-1/0],q=F.glyph,ee=F.color,J=F.size,$=F.angle,te=F.lineColor,ie=-1,ae=0,he=0,se=0;if(G.length){se=G.length;e:for(Z=0;Z<se;++Z){for(var de=G[Z],ce=0;ce<3;++ce)if(isNaN(de[ce])||!isFinite(de[ce]))continue e;var ve=(Oe=O(q,Z,Y,this.pixelRatio)).mesh,ke=Oe.lines,Ee=Oe.bounds;ae+=3*ve.cells.length,he+=2*ke.edges.length}}var be=ae+he,xe=p.mallocFloat(3*be),ue=p.mallocFloat(4*be),me=p.mallocFloat(2*be),we=p.mallocUint32(be);if(be>0){var Me=0,Se=ae,De=[0,0,0,1],Fe=[0,0,0,1],Ye=Array.isArray(ee)&&Array.isArray(ee[0]),et=Array.isArray(te)&&Array.isArray(te[0]);e:for(Z=0;Z<se;++Z){for(ie+=1,de=G[Z],ce=0;ce<3;++ce){if(isNaN(de[ce])||!isFinite(de[ce]))continue e;B[ce]=Math.max(B[ce],de[ce]),D[ce]=Math.min(D[ce],de[ce])}ve=(Oe=O(q,Z,Y,this.pixelRatio)).mesh,ke=Oe.lines,Ee=Oe.bounds;var Oe,je=Oe.visible;if(je)if(Array.isArray(ee)){if((We=Ye?Z<ee.length?ee[Z]:[0,0,0,0]:ee).length===3){for(ce=0;ce<3;++ce)De[ce]=We[ce];De[3]=1}else if(We.length===4){for(ce=0;ce<4;++ce)De[ce]=We[ce];!this.hasAlpha&&We[3]<1&&(this.hasAlpha=!0)}}else De[0]=De[1]=De[2]=0,De[3]=1;else De=[1,1,1,0];if(je)if(Array.isArray(te)){var We;if((We=et?Z<te.length?te[Z]:[0,0,0,0]:te).length===3){for(ce=0;ce<3;++ce)Fe[ce]=We[ce];Fe[ce]=1}else if(We.length===4){for(ce=0;ce<4;++ce)Fe[ce]=We[ce];!this.hasAlpha&&We[3]<1&&(this.hasAlpha=!0)}}else Fe[0]=Fe[1]=Fe[2]=0,Fe[3]=1;else Fe=[1,1,1,0];var Ge=.5;je?Array.isArray(J)?Ge=Z<J.length?+J[Z]:12:J?Ge=+J:this.useOrtho&&(Ge=12):Ge=0;var Qe=0;Array.isArray($)?Qe=Z<$.length?+$[Z]:0:$&&(Qe=+$);var it=Math.cos(Qe),lt=Math.sin(Qe);for(de=G[Z],ce=0;ce<3;++ce)B[ce]=Math.max(B[ce],de[ce]),D[ce]=Math.min(D[ce],de[ce]);var Lt=Q,wt=X;Lt=0,Array.isArray(Q)?Lt=Z<Q.length?Q[Z]:0:Q&&(Lt=Q),wt=0,Array.isArray(X)?wt=Z<X.length?X[Z]:0:X&&(wt=X);var rt=[Lt*=Lt>0?1-Ee[0][0]:Lt<0?1+Ee[1][0]:1,wt*=wt>0?1-Ee[0][1]:wt<0?1+Ee[1][1]:1],$e=ve.cells||[],xt=ve.positions||[];for(ce=0;ce<$e.length;++ce)for(var Qt=$e[ce],$t=0;$t<3;++$t){for(var Ue=0;Ue<3;++Ue)xe[3*Me+Ue]=de[Ue];for(Ue=0;Ue<4;++Ue)ue[4*Me+Ue]=De[Ue];we[Me]=ie;var He=xt[Qt[$t]];me[2*Me]=Ge*(it*He[0]-lt*He[1]+rt[0]),me[2*Me+1]=Ge*(lt*He[0]+it*He[1]+rt[1]),Me+=1}for($e=ke.edges,xt=ke.positions,ce=0;ce<$e.length;++ce)for(Qt=$e[ce],$t=0;$t<2;++$t){for(Ue=0;Ue<3;++Ue)xe[3*Se+Ue]=de[Ue];for(Ue=0;Ue<4;++Ue)ue[4*Se+Ue]=Fe[Ue];we[Se]=ie,He=xt[Qt[$t]],me[2*Se]=Ge*(it*He[0]-lt*He[1]+rt[0]),me[2*Se+1]=Ge*(lt*He[0]+it*He[1]+rt[1]),Se+=1}}}this.bounds=[D,B],this.points=G,this.pointCount=G.length,this.vertexCount=ae,this.lineVertexCount=he,this.pointBuffer.update(xe),this.colorBuffer.update(ue),this.glyphBuffer.update(me),this.idBuffer.update(we),p.free(xe),p.free(ue),p.free(me),p.free(we)},d.dispose=function(){this.shader.dispose(),this.orthoShader.dispose(),this.pickPerspectiveShader.dispose(),this.pickOrthoShader.dispose(),this.vao.dispose(),this.pointBuffer.dispose(),this.colorBuffer.dispose(),this.glyphBuffer.dispose(),this.idBuffer.dispose()}},{"./lib/get-simple-string":323,"./lib/glyphs":324,"./lib/shaders":325,"gl-buffer":261,"gl-mat4/multiply":295,"gl-vao":353,"is-string-blank":448,"typedarray-pool":601}],328:[function(h,N,H){var t=h("glslify");H.boxVertex=t([`precision mediump float;
#define GLSLIFY 1

attribute vec2 vertex;

uniform vec2 cornerA, cornerB;

void main() {
  gl_Position = vec4(mix(cornerA, cornerB, vertex), 0, 1);
}
`]),H.boxFragment=t([`precision mediump float;
#define GLSLIFY 1

uniform vec4 color;

void main() {
  gl_FragColor = color;
}
`])},{glslify:329}],329:[function(h,N,H){arguments[4][268][0].apply(H,arguments)},{dup:268}],330:[function(h,N,H){var t=h("gl-shader"),m=h("gl-buffer"),g=h("./lib/shaders");function p(f,u,i){this.plot=f,this.boxBuffer=u,this.boxShader=i,this.enabled=!0,this.selectBox=[1/0,1/0,-1/0,-1/0],this.borderColor=[0,0,0,1],this.innerFill=!1,this.innerColor=[0,0,0,.25],this.outerFill=!0,this.outerColor=[0,0,0,.5],this.borderWidth=10}N.exports=function(f,u){var i=f.gl,s=m(i,[0,0,0,1,1,0,1,1]),o=t(i,g.boxVertex,g.boxFragment),a=new p(f,s,o);return a.update(u),f.addOverlay(a),a};var e=p.prototype;e.draw=function(){if(this.enabled){var f=this.plot,u=this.selectBox,i=this.borderWidth,s=(this.innerFill,this.innerColor),o=(this.outerFill,this.outerColor),a=this.borderColor,c=f.box,r=f.screenBox,n=f.dataBox,d=f.viewBox,l=f.pixelRatio,y=(u[0]-n[0])*(d[2]-d[0])/(n[2]-n[0])+d[0],v=(u[1]-n[1])*(d[3]-d[1])/(n[3]-n[1])+d[1],_=(u[2]-n[0])*(d[2]-d[0])/(n[2]-n[0])+d[0],x=(u[3]-n[1])*(d[3]-d[1])/(n[3]-n[1])+d[1];if(y=Math.max(y,d[0]),v=Math.max(v,d[1]),_=Math.min(_,d[2]),x=Math.min(x,d[3]),!(_<y||x<v)){c.bind();var T=r[2]-r[0],A=r[3]-r[1];if(this.outerFill&&(c.drawBox(0,0,T,v,o),c.drawBox(0,v,y,x,o),c.drawBox(0,x,T,A,o),c.drawBox(_,v,T,x,o)),this.innerFill&&c.drawBox(y,v,_,x,s),i>0){var S=i*l;c.drawBox(y-S,v-S,_+S,v+S,a),c.drawBox(y-S,x-S,_+S,x+S,a),c.drawBox(y-S,v-S,y+S,x+S,a),c.drawBox(_-S,v-S,_+S,x+S,a)}}}},e.update=function(f){f=f||{},this.innerFill=!!f.innerFill,this.outerFill=!!f.outerFill,this.innerColor=(f.innerColor||[0,0,0,.5]).slice(),this.outerColor=(f.outerColor||[0,0,0,.5]).slice(),this.borderColor=(f.borderColor||[0,0,0,1]).slice(),this.borderWidth=f.borderWidth||0,this.selectBox=(f.selectBox||this.selectBox).slice()},e.dispose=function(){this.boxBuffer.dispose(),this.boxShader.dispose(),this.plot.removeOverlay(this)}},{"./lib/shaders":328,"gl-buffer":261,"gl-shader":332}],331:[function(h,N,H){N.exports=function(i,s){var o=s[0],a=s[1],c=t(i,o,a,{}),r=m.mallocUint8(o*a*4);return new f(i,c,r)};var t=h("gl-fbo"),m=h("typedarray-pool"),g=h("ndarray"),p=h("bit-twiddle").nextPow2;function e(i,s,o,a,c){this.coord=[i,s],this.id=o,this.value=a,this.distance=c}function f(i,s,o){this.gl=i,this.fbo=s,this.buffer=o,this._readTimeout=null;var a=this;this._readCallback=function(){a.gl&&(s.bind(),i.readPixels(0,0,s.shape[0],s.shape[1],i.RGBA,i.UNSIGNED_BYTE,a.buffer),a._readTimeout=null)}}var u=f.prototype;Object.defineProperty(u,"shape",{get:function(){return this.gl?this.fbo.shape.slice():[0,0]},set:function(i){if(this.gl){this.fbo.shape=i;var s=this.fbo.shape[0],o=this.fbo.shape[1];if(o*s*4>this.buffer.length){m.free(this.buffer);for(var a=this.buffer=m.mallocUint8(p(o*s*4)),c=0;c<o*s*4;++c)a[c]=255}return i}}}),u.begin=function(){var i=this.gl;this.shape,i&&(this.fbo.bind(),i.clearColor(1,1,1,1),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT))},u.end=function(){var i=this.gl;i&&(i.bindFramebuffer(i.FRAMEBUFFER,null),this._readTimeout||clearTimeout(this._readTimeout),this._readTimeout=setTimeout(this._readCallback,1))},u.query=function(i,s,o){if(!this.gl)return null;var a=this.fbo.shape.slice();i|=0,s|=0,typeof o!="number"&&(o=1);var c=0|Math.min(Math.max(i-o,0),a[0]),r=0|Math.min(Math.max(i+o,0),a[0]),n=0|Math.min(Math.max(s-o,0),a[1]),d=0|Math.min(Math.max(s+o,0),a[1]);if(r<=c||d<=n)return null;var l=[r-c,d-n],y=g(this.buffer,[l[0],l[1],4],[4,4*a[0],1],4*(c+a[0]*n)),v=function(T,A,S){for(var w=1e8,L=-1,k=-1,C=T.shape[0],M=T.shape[1],P=0;P<C;P++)for(var O=0;O<M;O++){var F=T.get(P,O,0),j=T.get(P,O,1),W=T.get(P,O,2),Z=T.get(P,O,3);if(F<255||j<255||W<255||Z<255){var Q=A-P,X=S-O,G=Q*Q+X*X;G<w&&(w=G,L=P,k=O)}}return[L,k,w]}(y.hi(l[0],l[1],1),o,o),_=v[0],x=v[1];return _<0||Math.pow(this.radius,2)<v[2]?null:new e(_+c|0,x+n|0,y.get(_,x,0),[y.get(_,x,1),y.get(_,x,2),y.get(_,x,3)],Math.sqrt(v[2]))},u.dispose=function(){this.gl&&(this.fbo.dispose(),m.free(this.buffer),this.gl=null,this._readTimeout&&clearTimeout(this._readTimeout))}},{"bit-twiddle":104,"gl-fbo":270,ndarray:472,"typedarray-pool":601}],332:[function(h,N,H){var t=h("./lib/create-uniforms"),m=h("./lib/create-attributes"),g=h("./lib/reflect"),p=h("./lib/shader-cache"),e=h("./lib/runtime-reflect"),f=h("./lib/GLError");function u(o){this.gl=o,this.gl.lastAttribCount=0,this._vref=this._fref=this._relink=this.vertShader=this.fragShader=this.program=this.attributes=this.uniforms=this.types=null}var i=u.prototype;function s(o,a){return o.name<a.name?-1:1}i.bind=function(){var o;this.program||this._relink();var a=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES),c=this.gl.lastAttribCount;if(a>c)for(o=c;o<a;o++)this.gl.enableVertexAttribArray(o);else if(c>a)for(o=a;o<c;o++)this.gl.disableVertexAttribArray(o);this.gl.lastAttribCount=a,this.gl.useProgram(this.program)},i.dispose=function(){for(var o=this.gl.lastAttribCount,a=0;a<o;a++)this.gl.disableVertexAttribArray(a);this.gl.lastAttribCount=0,this._fref&&this._fref.dispose(),this._vref&&this._vref.dispose(),this.attributes=this.types=this.vertShader=this.fragShader=this.program=this._relink=this._fref=this._vref=null},i.update=function(o,a,c,r){if(!a||arguments.length===1){var n=o;o=n.vertex,a=n.fragment,c=n.uniforms,r=n.attributes}var d=this,l=d.gl,y=d._vref;d._vref=p.shader(l,l.VERTEX_SHADER,o),y&&y.dispose(),d.vertShader=d._vref.shader;var v=this._fref;if(d._fref=p.shader(l,l.FRAGMENT_SHADER,a),v&&v.dispose(),d.fragShader=d._fref.shader,!c||!r){var _=l.createProgram();if(l.attachShader(_,d.fragShader),l.attachShader(_,d.vertShader),l.linkProgram(_),!l.getProgramParameter(_,l.LINK_STATUS)){var x=l.getProgramInfoLog(_);throw new f(x,"Error linking program:"+x)}c=c||e.uniforms(l,_),r=r||e.attributes(l,_),l.deleteProgram(_)}(r=r.slice()).sort(s);var T,A=[],S=[],w=[];for(T=0;T<r.length;++T){var L=r[T];if(L.type.indexOf("mat")>=0){for(var k=0|L.type.charAt(L.type.length-1),C=new Array(k),M=0;M<k;++M)C[M]=w.length,S.push(L.name+"["+M+"]"),typeof L.location=="number"?w.push(L.location+M):Array.isArray(L.location)&&L.location.length===k&&typeof L.location[M]=="number"?w.push(0|L.location[M]):w.push(-1);A.push({name:L.name,type:L.type,locations:C})}else A.push({name:L.name,type:L.type,locations:[w.length]}),S.push(L.name),typeof L.location=="number"?w.push(0|L.location):w.push(-1)}var P=0;for(T=0;T<w.length;++T)if(w[T]<0){for(;w.indexOf(P)>=0;)P+=1;w[T]=P}var O=new Array(c.length);function F(){d.program=p.program(l,d._vref,d._fref,S,w);for(var j=0;j<c.length;++j)O[j]=l.getUniformLocation(d.program,c[j].name)}F(),d._relink=F,d.types={uniforms:g(c),attributes:g(r)},d.attributes=m(l,d,A,w),Object.defineProperty(d,"uniforms",t(l,d,c,O))},N.exports=function(o,a,c,r,n){var d=new u(o);return d.update(a,c,r,n),d}},{"./lib/GLError":333,"./lib/create-attributes":334,"./lib/create-uniforms":335,"./lib/reflect":336,"./lib/runtime-reflect":337,"./lib/shader-cache":338}],333:[function(h,N,H){function t(m,g,p){this.shortMessage=g||"",this.longMessage=p||"",this.rawError=m||"",this.message="gl-shader: "+(g||m||"")+(p?`
`+p:""),this.stack=new Error().stack}t.prototype=new Error,t.prototype.name="GLError",t.prototype.constructor=t,N.exports=t},{}],334:[function(h,N,H){N.exports=function(u,i,s,o){for(var a={},c=0,r=s.length;c<r;++c){var n=s[c],d=n.name,l=n.type,y=n.locations;switch(l){case"bool":case"int":case"float":e(u,i,y[0],o,1,a,d);break;default:if(l.indexOf("vec")>=0){if((v=l.charCodeAt(l.length-1)-48)<2||v>4)throw new t("","Invalid data type for attribute "+d+": "+l);e(u,i,y[0],o,v,a,d)}else{if(!(l.indexOf("mat")>=0))throw new t("","Unknown data type for attribute "+d+": "+l);var v;if((v=l.charCodeAt(l.length-1)-48)<2||v>4)throw new t("","Invalid data type for attribute "+d+": "+l);f(u,i,y,o,v,a,d)}}}return a};var t=h("./GLError");function m(u,i,s,o,a,c){this._gl=u,this._wrapper=i,this._index=s,this._locations=o,this._dimension=a,this._constFunc=c}var g=m.prototype;g.pointer=function(u,i,s,o){var a=this._gl,c=this._locations[this._index];a.vertexAttribPointer(c,this._dimension,u||a.FLOAT,!!i,s||0,o||0),a.enableVertexAttribArray(c)},g.set=function(u,i,s,o){return this._constFunc(this._locations[this._index],u,i,s,o)},Object.defineProperty(g,"location",{get:function(){return this._locations[this._index]},set:function(u){return u!==this._locations[this._index]&&(this._locations[this._index]=0|u,this._wrapper.program=null),0|u}});var p=[function(u,i,s){return s.length===void 0?u.vertexAttrib1f(i,s):u.vertexAttrib1fv(i,s)},function(u,i,s,o){return s.length===void 0?u.vertexAttrib2f(i,s,o):u.vertexAttrib2fv(i,s)},function(u,i,s,o,a){return s.length===void 0?u.vertexAttrib3f(i,s,o,a):u.vertexAttrib3fv(i,s)},function(u,i,s,o,a,c){return s.length===void 0?u.vertexAttrib4f(i,s,o,a,c):u.vertexAttrib4fv(i,s)}];function e(u,i,s,o,a,c,r){var n=p[a],d=new m(u,i,s,o,a,n);Object.defineProperty(c,r,{set:function(l){return u.disableVertexAttribArray(o[s]),n(u,o[s],l),l},get:function(){return d},enumerable:!0})}function f(u,i,s,o,a,c,r){for(var n=new Array(a),d=new Array(a),l=0;l<a;++l)e(u,i,s[l],o,a,n,l),d[l]=n[l];Object.defineProperty(n,"location",{set:function(_){if(Array.isArray(_))for(var x=0;x<a;++x)d[x].location=_[x];else for(x=0;x<a;++x)d[x].location=_+x;return _},get:function(){for(var _=new Array(a),x=0;x<a;++x)_[x]=o[s[x]];return _},enumerable:!0}),n.pointer=function(_,x,T,A){_=_||u.FLOAT,x=!!x,T=T||a*a,A=A||0;for(var S=0;S<a;++S){var w=o[s[S]];u.vertexAttribPointer(w,a,_,x,T,A+S*a),u.enableVertexAttribArray(w)}};var y=new Array(a),v=u["vertexAttrib"+a+"fv"];Object.defineProperty(c,r,{set:function(_){for(var x=0;x<a;++x){var T=o[s[x]];if(u.disableVertexAttribArray(T),Array.isArray(_[0]))v.call(u,T,_[x]);else{for(var A=0;A<a;++A)y[A]=_[a*x+A];v.call(u,T,y)}}return _},get:function(){return n},enumerable:!0})}},{"./GLError":333}],335:[function(h,N,H){var t=h("./reflect"),m=h("./GLError");function g(e){return function(){return e}}function p(e,f){for(var u=new Array(e),i=0;i<e;++i)u[i]=f;return u}N.exports=function(e,f,u,i){function s(r){return function(n){for(var d=function M(P,O){if(typeof O!="object")return[[P,O]];var F=[];for(var j in O){var W=O[j],Z=P;parseInt(j)+""===j?Z+="["+j+"]":Z+="."+j,typeof W=="object"?F.push.apply(F,M(Z,W)):F.push([Z,W])}return F}("",r),l=0;l<d.length;++l){var y=d[l],v=y[0],_=y[1];if(i[_]){var x=n;if(typeof v=="string"&&(v.indexOf(".")===0||v.indexOf("[")===0)){var T=v;if(v.indexOf(".")===0&&(T=v.slice(1)),T.indexOf("]")===T.length-1){var A=T.indexOf("["),S=T.slice(0,A),w=T.slice(A+1,T.length-1);x=S?n[S][w]:n[w]}else x=n[T]}var L,k=u[_].type;switch(k){case"bool":case"int":case"sampler2D":case"samplerCube":e.uniform1i(i[_],x);break;case"float":e.uniform1f(i[_],x);break;default:var C=k.indexOf("vec");if(!(0<=C&&C<=1&&k.length===4+C)){if(k.indexOf("mat")===0&&k.length===4){if((L=k.charCodeAt(k.length-1)-48)<2||L>4)throw new m("","Invalid uniform dimension type for matrix "+name+": "+k);e["uniformMatrix"+L+"fv"](i[_],!1,x);break}throw new m("","Unknown uniform data type for "+name+": "+k)}if((L=k.charCodeAt(k.length-1)-48)<2||L>4)throw new m("","Invalid data type");switch(k.charAt(0)){case"b":case"i":e["uniform"+L+"iv"](i[_],x);break;case"v":e["uniform"+L+"fv"](i[_],x);break;default:throw new m("","Unrecognized data type for vector "+name+": "+k)}}}}}}function o(r,n,d){if(typeof d=="object"){var l=a(d);Object.defineProperty(r,n,{get:g(l),set:s(d),enumerable:!0,configurable:!1})}else i[d]?Object.defineProperty(r,n,{get:(y=d,function(v,_,x){return v.getUniform(_.program,x[y])}),set:s(d),enumerable:!0,configurable:!1}):r[n]=function(v){switch(v){case"bool":return!1;case"int":case"sampler2D":case"samplerCube":case"float":return 0;default:var _=v.indexOf("vec");if(0<=_&&_<=1&&v.length===4+_){if((x=v.charCodeAt(v.length-1)-48)<2||x>4)throw new m("","Invalid data type");return v.charAt(0)==="b"?p(x,!1):p(x,0)}if(v.indexOf("mat")===0&&v.length===4){var x;if((x=v.charCodeAt(v.length-1)-48)<2||x>4)throw new m("","Invalid uniform dimension type for matrix "+name+": "+v);return p(x*x,0)}throw new m("","Unknown uniform data type for "+name+": "+v)}}(u[d].type);var y}function a(r){var n;if(Array.isArray(r)){n=new Array(r.length);for(var d=0;d<r.length;++d)o(n,d,r[d])}else for(var l in n={},r)o(n,l,r[l]);return n}var c=t(u,!0);return{get:g(a(c)),set:s(c),enumerable:!0,configurable:!0}}},{"./GLError":333,"./reflect":336}],336:[function(h,N,H){N.exports=function(t,m){for(var g={},p=0;p<t.length;++p)for(var e=t[p].name.split("."),f=g,u=0;u<e.length;++u){var i=e[u].split("[");if(i.length>1){i[0]in f||(f[i[0]]=[]),f=f[i[0]];for(var s=1;s<i.length;++s){var o=parseInt(i[s]);s<i.length-1||u<e.length-1?(o in f||(s<i.length-1?f[o]=[]:f[o]={}),f=f[o]):f[o]=m?p:t[p].type}}else u<e.length-1?(i[0]in f||(f[i[0]]={}),f=f[i[0]]):f[i[0]]=m?p:t[p].type}return g}},{}],337:[function(h,N,H){H.uniforms=function(p,e){for(var f=p.getProgramParameter(e,p.ACTIVE_UNIFORMS),u=[],i=0;i<f;++i){var s=p.getActiveUniform(e,i);if(s){var o=g(p,s.type);if(s.size>1)for(var a=0;a<s.size;++a)u.push({name:s.name.replace("[0]","["+a+"]"),type:o});else u.push({name:s.name,type:o})}}return u},H.attributes=function(p,e){for(var f=p.getProgramParameter(e,p.ACTIVE_ATTRIBUTES),u=[],i=0;i<f;++i){var s=p.getActiveAttrib(e,i);s&&u.push({name:s.name,type:g(p,s.type)})}return u};var t={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube"},m=null;function g(p,e){if(!m){var f=Object.keys(t);m={};for(var u=0;u<f.length;++u){var i=f[u];m[p[i]]=t[i]}}return m[e]}},{}],338:[function(h,N,H){H.shader=function(s,o,a){return i(s).getShaderReference(o,a)},H.program=function(s,o,a,c,r){return i(s).getProgram(o,a,c,r)};var t=h("./GLError"),m=h("gl-format-compiler-error"),g=new(typeof WeakMap=="undefined"?h("weakmap-shim"):WeakMap),p=0;function e(s,o,a,c,r,n,d){this.id=s,this.src=o,this.type=a,this.shader=c,this.count=n,this.programs=[],this.cache=d}function f(s){this.gl=s,this.shaders=[{},{}],this.programs={}}e.prototype.dispose=function(){if(--this.count==0){for(var s=this.cache,o=s.gl,a=this.programs,c=0,r=a.length;c<r;++c){var n=s.programs[a[c]];n&&(delete s.programs[c],o.deleteProgram(n))}o.deleteShader(this.shader),delete s.shaders[this.type===o.FRAGMENT_SHADER|0][this.src]}};var u=f.prototype;function i(s){var o=g.get(s);return o||(o=new f(s),g.set(s,o)),o}u.getShaderReference=function(s,o){var a=this.gl,c=this.shaders[s===a.FRAGMENT_SHADER|0],r=c[o];if(r&&a.isShader(r.shader))r.count+=1;else{var n=function(d,l,y){var v=d.createShader(l);if(d.shaderSource(v,y),d.compileShader(v),!d.getShaderParameter(v,d.COMPILE_STATUS)){var _=d.getShaderInfoLog(v);try{var x=m(_,y,l)}catch(T){throw console.warn("Failed to format compiler error: "+T),new t(_,`Error compiling shader:
`+_)}throw new t(_,x.short,x.long)}return v}(a,s,o);r=c[o]=new e(p++,o,s,n,[],1,this)}return r},u.getProgram=function(s,o,a,c){var r=[s.id,o.id,a.join(":"),c.join(":")].join("@"),n=this.programs[r];return n&&this.gl.isProgram(n)||(this.programs[r]=n=function(d,l,y,v,_){var x=d.createProgram();d.attachShader(x,l),d.attachShader(x,y);for(var T=0;T<v.length;++T)d.bindAttribLocation(x,_[T],v[T]);if(d.linkProgram(x),!d.getProgramParameter(x,d.LINK_STATUS)){var A=d.getProgramInfoLog(x);throw new t(A,"Error linking program: "+A)}return x}(this.gl,s.shader,o.shader,a,c),s.programs.push(r),o.programs.push(r)),n}},{"./GLError":333,"gl-format-compiler-error":271,"weakmap-shim":612}],339:[function(h,N,H){function t(g){this.plot=g,this.enable=[!0,!0,!1,!1],this.width=[1,1,1,1],this.color=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.center=[1/0,1/0]}N.exports=function(g,p){var e=new t(g);return e.update(p),g.addOverlay(e),e};var m=t.prototype;m.update=function(g){g=g||{},this.enable=(g.enable||[!0,!0,!1,!1]).slice(),this.width=(g.width||[1,1,1,1]).slice(),this.color=(g.color||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]).map(function(p){return p.slice()}),this.center=(g.center||[1/0,1/0]).slice(),this.plot.setOverlayDirty()},m.draw=function(){var g=this.enable,p=this.width,e=this.color,f=this.center,u=this.plot,i=u.line,s=u.dataBox,o=u.viewBox;if(i.bind(),s[0]<=f[0]&&f[0]<=s[2]&&s[1]<=f[1]&&f[1]<=s[3]){var a=o[0]+(f[0]-s[0])/(s[2]-s[0])*(o[2]-o[0]),c=o[1]+(f[1]-s[1])/(s[3]-s[1])*(o[3]-o[1]);g[0]&&i.drawLine(a,c,o[0],c,p[0],e[0]),g[1]&&i.drawLine(a,c,a,o[1],p[1],e[1]),g[2]&&i.drawLine(a,c,o[2],c,p[2],e[2]),g[3]&&i.drawLine(a,c,a,o[3],p[3],e[3])}},m.dispose=function(){this.plot.removeOverlay(this)}},{}],340:[function(h,N,H){var t=h("glslify"),m=h("gl-shader"),g=t([`precision mediump float;
#define GLSLIFY 1

attribute vec3 position, color;
attribute float weight;

uniform mat4 model, view, projection;
uniform vec3 coordinates[3];
uniform vec4 colors[3];
uniform vec2 screenShape;
uniform float lineWidth;

varying vec4 fragColor;

void main() {
  vec3 vertexPosition = mix(coordinates[0],
    mix(coordinates[2], coordinates[1], 0.5 * (position + 1.0)), abs(position));

  vec4 clipPos = projection * view * model * vec4(vertexPosition, 1.0);
  vec2 clipOffset = (projection * view * model * vec4(color, 0.0)).xy;
  vec2 delta = weight * clipOffset * screenShape;
  vec2 lineOffset = normalize(vec2(delta.y, -delta.x)) / screenShape;

  gl_Position   = vec4(clipPos.xy + clipPos.w * 0.5 * lineWidth * lineOffset, clipPos.z, clipPos.w);
  fragColor     = color.x * colors[0] + color.y * colors[1] + color.z * colors[2];
}
`]),p=t([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
  gl_FragColor = fragColor;
}`]);N.exports=function(e){return m(e,g,p,null,[{name:"position",type:"vec3"},{name:"color",type:"vec3"},{name:"weight",type:"float"}])}},{"gl-shader":332,glslify:434}],341:[function(h,N,H){var t=h("gl-buffer"),m=h("gl-vao"),g=h("./shaders/index");N.exports=function(o,a){var c=[];function r(v,_,x,T,A,S){var w=[v,_,x,0,0,0,1];w[T+3]=1,w[T]=A,c.push.apply(c,w),w[6]=-1,c.push.apply(c,w),w[T]=S,c.push.apply(c,w),c.push.apply(c,w),w[6]=1,c.push.apply(c,w),w[T]=A,c.push.apply(c,w)}r(0,0,0,0,0,1),r(0,0,0,1,0,1),r(0,0,0,2,0,1),r(1,0,0,1,-1,1),r(1,0,0,2,-1,1),r(0,1,0,0,-1,1),r(0,1,0,2,-1,1),r(0,0,1,0,-1,1),r(0,0,1,1,-1,1);var n=t(o,c),d=m(o,[{type:o.FLOAT,buffer:n,size:3,offset:0,stride:28},{type:o.FLOAT,buffer:n,size:3,offset:12,stride:28},{type:o.FLOAT,buffer:n,size:1,offset:24,stride:28}]),l=g(o);l.attributes.position.location=0,l.attributes.color.location=1,l.attributes.weight.location=2;var y=new e(o,n,d,l);return y.update(a),y};var p=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function e(o,a,c,r){this.gl=o,this.buffer=a,this.vao=c,this.shader=r,this.pixelRatio=1,this.bounds=[[-1e3,-1e3,-1e3],[1e3,1e3,1e3]],this.position=[0,0,0],this.lineWidth=[2,2,2],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.enabled=[!0,!0,!0],this.drawSides=[!0,!0,!0],this.axes=null}var f=e.prototype,u=[0,0,0],i=[0,0,0],s=[0,0];f.isTransparent=function(){return!1},f.drawTransparent=function(o){},f.draw=function(o){var a=this.gl,c=this.vao,r=this.shader;c.bind(),r.bind();var n,d=o.model||p,l=o.view||p,y=o.projection||p;this.axes&&(n=this.axes.lastCubeProps.axis);for(var v=u,_=i,x=0;x<3;++x)n&&n[x]<0?(v[x]=this.bounds[0][x],_[x]=this.bounds[1][x]):(v[x]=this.bounds[1][x],_[x]=this.bounds[0][x]);for(s[0]=a.drawingBufferWidth,s[1]=a.drawingBufferHeight,r.uniforms.model=d,r.uniforms.view=l,r.uniforms.projection=y,r.uniforms.coordinates=[this.position,v,_],r.uniforms.colors=this.colors,r.uniforms.screenShape=s,x=0;x<3;++x)r.uniforms.lineWidth=this.lineWidth[x]*this.pixelRatio,this.enabled[x]&&(c.draw(a.TRIANGLES,6,6*x),this.drawSides[x]&&c.draw(a.TRIANGLES,12,18+12*x));c.unbind()},f.update=function(o){o&&("bounds"in o&&(this.bounds=o.bounds),"position"in o&&(this.position=o.position),"lineWidth"in o&&(this.lineWidth=o.lineWidth),"colors"in o&&(this.colors=o.colors),"enabled"in o&&(this.enabled=o.enabled),"drawSides"in o&&(this.drawSides=o.drawSides))},f.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()}},{"./shaders/index":340,"gl-buffer":261,"gl-vao":353}],342:[function(h,N,H){var t=h("glslify"),m=t([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the tube vertex and normal at the given index.
//
// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.
//
// Each tube segment is made up of a ring of vertices.
// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.
// The indexes of tube segments run from 0 to 8.
//
vec3 getTubePosition(vec3 d, float index, out vec3 normal) {
  float segmentCount = 8.0;

  float angle = 2.0 * 3.14159 * (index / segmentCount);

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d);
  vec3 y = v * sin(angle) * length(d);
  vec3 v3 = x + y;

  normal = normalize(v3);

  return v3;
}

attribute vec4 vector;
attribute vec4 color, position;
attribute vec2 uv;

uniform float vectorScale, tubeScale;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 eyePosition, lightPosition;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  // Scale the vector magnitude to stay constant with
  // model & view changes.
  vec3 normal;
  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);
  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * tubePosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  // vec4 m_position  = model * vec4(tubePosition, 1.0);
  vec4 t_position  = view * tubePosition;
  gl_Position      = projection * t_position;

  f_color          = color;
  f_data           = tubePosition.xyz;
  f_position       = position.xyz;
  f_uv             = uv;
}
`]),g=t([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform sampler2D texture;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;
  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = f_color * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * opacity;
}
`]),p=t([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the tube vertex and normal at the given index.
//
// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.
//
// Each tube segment is made up of a ring of vertices.
// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.
// The indexes of tube segments run from 0 to 8.
//
vec3 getTubePosition(vec3 d, float index, out vec3 normal) {
  float segmentCount = 8.0;

  float angle = 2.0 * 3.14159 * (index / segmentCount);

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d);
  vec3 y = v * sin(angle) * length(d);
  vec3 v3 = x + y;

  normal = normalize(v3);

  return v3;
}

attribute vec4 vector;
attribute vec4 position;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform float tubeScale;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  vec3 normal;
  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);
  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  gl_Position = projection * view * tubePosition;
  f_id        = id;
  f_position  = position.xyz;
}
`]),e=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]);H.meshShader={vertex:m,fragment:g,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec4"}]},H.pickShader={vertex:p,fragment:e,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec4"}]}},{glslify:343}],343:[function(h,N,H){arguments[4][268][0].apply(H,arguments)},{dup:268}],344:[function(h,N,H){var t=h("gl-vec3"),m=h("gl-vec4"),g=["xyz","xzy","yxz","yzx","zxy","zyx"],p=function(o,a,c,r){for(var n=0,d=0;d<o.length;d++)for(var l=o[d].velocities,y=0;y<l.length;y++)n=Math.max(n,t.length(l[y]));var v=o.map(function(M){return function(P,O,F,j){for(var W=P.points,Z=P.velocities,Q=P.divergences,X=[],G=[],Y=[],K=[],D=[],B=[],q=0,ee=0,J=m.create(),$=m.create(),te=0;te<W.length;te++){var ie=W[te],ae=Z[te],he=Q[te];O===0&&(he=.05*F),ee=t.length(ae)/j,J=m.create(),t.copy(J,ae),J[3]=he;for(var se=0;se<8;se++)D[se]=[ie[0],ie[1],ie[2],se];if(K.length>0)for(se=0;se<8;se++){var de=(se+1)%8;X.push(K[se],D[se],D[de],D[de],K[de],K[se]),Y.push($,J,J,J,$,$),B.push(q,ee,ee,ee,q,q);var ce=X.length;G.push([ce-6,ce-5,ce-4],[ce-3,ce-2,ce-1])}var ve=K;K=D,D=ve;var ke=$;$=J,J=ke;var Ee=q;q=ee,ee=Ee}return{positions:X,cells:G,vectors:Y,vertexIntensity:B}}(M,c,r,n)}),_=[],x=[],T=[],A=[];for(d=0;d<v.length;d++){var S=v[d],w=_.length;for(_=_.concat(S.positions),T=T.concat(S.vectors),A=A.concat(S.vertexIntensity),y=0;y<S.cells.length;y++){var L=S.cells[y],k=[];x.push(k);for(var C=0;C<L.length;C++)k.push(L[C]+w)}}return{positions:_,cells:x,vectors:T,vertexIntensity:A,colormap:a}},e=function(o,a){var c,r=o.length;for(c=0;c<r;c++){var n=o[c];if(n===a)return c;if(n>a)return c-1}return c},f=function(o,a,c){return o<a?a:o>c?c:o},u=function(o){var a=1/0;o.sort(function(d,l){return d-l});for(var c=o.length,r=1;r<c;r++){var n=Math.abs(o[r]-o[r-1]);n<a&&(a=n)}return a};N.exports=function(o,a){var c=o.startingPositions,r=o.maxLength||1e3,n=o.tubeSize||1,d=o.absoluteTubeSize,l=o.gridFill||"+x+y+z",y={};l.indexOf("-x")!==-1&&(y.reversedX=!0),l.indexOf("-y")!==-1&&(y.reversedY=!0),l.indexOf("-z")!==-1&&(y.reversedZ=!0),y.filled=g.indexOf(l.replace(/-/g,"").replace(/\+/g,""));var v=o.getVelocity||function(te){return function(ie,ae,he){var se=ae.vectors,de=ae.meshgrid,ce=ie[0],ve=ie[1],ke=ie[2],Ee=de[0].length,be=de[1].length,xe=de[2].length,ue=e(de[0],ce),me=e(de[1],ve),we=e(de[2],ke),Me=ue+1,Se=me+1,De=we+1;if(ue=f(ue,0,Ee-1),Me=f(Me,0,Ee-1),me=f(me,0,be-1),Se=f(Se,0,be-1),we=f(we,0,xe-1),De=f(De,0,xe-1),ue<0||me<0||we<0||Me>Ee-1||Se>be-1||De>xe-1)return t.create();var Fe,Ye,et,Oe,je,We,Ge=de[0][ue],Qe=de[0][Me],it=de[1][me],lt=de[1][Se],Lt=de[2][we],wt=(ce-Ge)/(Qe-Ge),rt=(ve-it)/(lt-it),$e=(ke-Lt)/(de[2][De]-Lt);switch(isFinite(wt)||(wt=.5),isFinite(rt)||(rt=.5),isFinite($e)||($e=.5),he.reversedX&&(ue=Ee-1-ue,Me=Ee-1-Me),he.reversedY&&(me=be-1-me,Se=be-1-Se),he.reversedZ&&(we=xe-1-we,De=xe-1-De),he.filled){case 5:je=we,We=De,et=me*xe,Oe=Se*xe,Fe=ue*xe*be,Ye=Me*xe*be;break;case 4:je=we,We=De,Fe=ue*xe,Ye=Me*xe,et=me*xe*Ee,Oe=Se*xe*Ee;break;case 3:et=me,Oe=Se,je=we*be,We=De*be,Fe=ue*be*xe,Ye=Me*be*xe;break;case 2:et=me,Oe=Se,Fe=ue*be,Ye=Me*be,je=we*be*Ee,We=De*be*Ee;break;case 1:Fe=ue,Ye=Me,je=we*Ee,We=De*Ee,et=me*Ee*xe,Oe=Se*Ee*xe;break;default:Fe=ue,Ye=Me,et=me*Ee,Oe=Se*Ee,je=we*Ee*be,We=De*Ee*be}var xt=se[Fe+et+je],Qt=se[Fe+et+We],$t=se[Fe+Oe+je],Ue=se[Fe+Oe+We],He=se[Ye+et+je],Be=se[Ye+et+We],Je=se[Ye+Oe+je],_e=se[Ye+Oe+We],Le=t.create(),Ce=t.create(),Pe=t.create(),Xe=t.create();t.lerp(Le,xt,He,wt),t.lerp(Ce,Qt,Be,wt),t.lerp(Pe,$t,Je,wt),t.lerp(Xe,Ue,_e,wt);var ut=t.create(),kt=t.create();t.lerp(ut,Le,Pe,rt),t.lerp(kt,Ce,Xe,rt);var ft=t.create();return t.lerp(ft,ut,kt,$e),ft}(te,o,y)},_=o.getDivergence||function(te,ie){var ae=t.create(),he=1e-4;t.add(ae,te,[he,0,0]);var se=v(ae);t.subtract(se,se,ie),t.scale(se,se,1/he),t.add(ae,te,[0,he,0]);var de=v(ae);t.subtract(de,de,ie),t.scale(de,de,1/he),t.add(ae,te,[0,0,he]);var ce=v(ae);return t.subtract(ce,ce,ie),t.scale(ce,ce,1/he),t.add(ae,se,de),t.add(ae,ae,ce),ae},x=[],T=a[0][0],A=a[0][1],S=a[0][2],w=a[1][0],L=a[1][1],k=a[1][2],C=function(te){var ie=te[0],ae=te[1],he=te[2];return!(ie<T||ie>w||ae<A||ae>L||he<S||he>k)},M=10*t.distance(a[0],a[1])/r,P=M*M,O=1,F=0,j=c.length;j>1&&(O=function(te){for(var ie=[],ae=[],he=[],se={},de={},ce={},ve=te.length,ke=0;ke<ve;ke++){var Ee=te[ke],be=Ee[0],xe=Ee[1],ue=Ee[2];se[be]||(ie.push(be),se[be]=!0),de[xe]||(ae.push(xe),de[xe]=!0),ce[ue]||(he.push(ue),ce[ue]=!0)}var me=u(ie),we=u(ae),Me=u(he),Se=Math.min(me,we,Me);return isFinite(Se)?Se:1}(c));for(var W=0;W<j;W++){var Z=t.create();t.copy(Z,c[W]);var Q=[Z],X=[],G=v(Z),Y=Z;X.push(G);var K=[],D=_(Z,G),B=t.length(D);isFinite(B)&&B>F&&(F=B),K.push(B),x.push({points:Q,velocities:X,divergences:K});for(var q=0;q<100*r&&Q.length<r&&C(Z);){q++;var ee=t.clone(G),J=t.squaredLength(ee);if(J===0)break;J>P&&t.scale(ee,ee,M/Math.sqrt(J)),t.add(ee,ee,Z),G=v(ee),t.squaredDistance(Y,ee)-P>-1e-4*P&&(Q.push(ee),Y=ee,X.push(G),D=_(ee,G),B=t.length(D),isFinite(B)&&B>F&&(F=B),K.push(B)),Z=ee}}var $=p(x,o.colormap,F,O);return d?$.tubeScale=d:(F===0&&(F=1),$.tubeScale=.5*n*O/F),$};var i=h("./lib/shaders"),s=h("gl-cone3d").createMesh;N.exports.createTubeMesh=function(o,a){return s(o,a,{shaders:i,traceType:"streamtube"})}},{"./lib/shaders":342,"gl-cone3d":262,"gl-vec3":372,"gl-vec4":408}],345:[function(h,N,H){var t=h("gl-shader"),m=h("glslify"),g=m([`precision highp float;
#define GLSLIFY 1

attribute vec4 uv;
attribute vec3 f;
attribute vec3 normal;

uniform vec3 objectOffset;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 lightPosition, eyePosition;
uniform sampler2D colormap;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  vec3 localCoordinate = vec3(uv.zw, f.x);
  worldCoordinate = objectOffset + localCoordinate;
  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);
  vec4 clipPosition = projection * view * worldPosition;
  gl_Position = clipPosition;
  kill = f.y;
  value = f.z;
  planeCoordinate = uv.xy;

  vColor = texture2D(colormap, vec2(value, value));

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * worldPosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  lightDirection = lightPosition - cameraCoordinate.xyz;
  eyeDirection   = eyePosition - cameraCoordinate.xyz;
  surfaceNormal  = normalize((vec4(normal,0) * inverseModel).xyz);
}
`]),p=m([`precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float beckmannSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness) {
  return beckmannDistribution(dot(surfaceNormal, normalize(lightDirection + viewDirection)), roughness);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 lowerBound, upperBound;
uniform float contourTint;
uniform vec4 contourColor;
uniform sampler2D colormap;
uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform float vertexColor;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  if (
    kill > 0.0 ||
    vColor.a == 0.0 ||
    outOfRange(clipBounds[0], clipBounds[1], worldCoordinate)
  ) discard;

  vec3 N = normalize(surfaceNormal);
  vec3 V = normalize(eyeDirection);
  vec3 L = normalize(lightDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = max(beckmannSpecular(L, V, N, roughness), 0.);
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  //decide how to interpolate color \u2014 in vertex or in fragment
  vec4 surfaceColor =
    step(vertexColor, .5) * texture2D(colormap, vec2(value, value)) +
    step(.5, vertexColor) * vColor;

  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = mix(litColor, contourColor, contourTint) * opacity;
}
`]),e=m([`precision highp float;
#define GLSLIFY 1

attribute vec4 uv;
attribute float f;

uniform vec3 objectOffset;
uniform mat3 permutation;
uniform mat4 model, view, projection;
uniform float height, zOffset;
uniform sampler2D colormap;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  vec3 dataCoordinate = permutation * vec3(uv.xy, height);
  worldCoordinate = objectOffset + dataCoordinate;
  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);

  vec4 clipPosition = projection * view * worldPosition;
  clipPosition.z += zOffset;

  gl_Position = clipPosition;
  value = f + objectOffset.z;
  kill = -1.0;
  planeCoordinate = uv.zw;

  vColor = texture2D(colormap, vec2(value, value));

  //Don't do lighting for contours
  surfaceNormal   = vec3(1,0,0);
  eyeDirection    = vec3(0,1,0);
  lightDirection  = vec3(0,0,1);
}
`]),f=m([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec2 shape;
uniform vec3 clipBounds[2];
uniform float pickId;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 surfaceNormal;

vec2 splitFloat(float v) {
  float vh = 255.0 * v;
  float upper = floor(vh);
  float lower = fract(vh);
  return vec2(upper / 255.0, floor(lower * 16.0) / 16.0);
}

void main() {
  if ((kill > 0.0) ||
      (outOfRange(clipBounds[0], clipBounds[1], worldCoordinate))) discard;

  vec2 ux = splitFloat(planeCoordinate.x / shape.x);
  vec2 uy = splitFloat(planeCoordinate.y / shape.y);
  gl_FragColor = vec4(pickId, ux.x, uy.x, ux.y + (uy.y/16.0));
}
`]);H.createShader=function(u){var i=t(u,g,p,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return i.attributes.uv.location=0,i.attributes.f.location=1,i.attributes.normal.location=2,i},H.createPickShader=function(u){var i=t(u,g,f,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return i.attributes.uv.location=0,i.attributes.f.location=1,i.attributes.normal.location=2,i},H.createContourShader=function(u){var i=t(u,e,p,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return i.attributes.uv.location=0,i.attributes.f.location=1,i},H.createPickContourShader=function(u){var i=t(u,e,f,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return i.attributes.uv.location=0,i.attributes.f.location=1,i}},{"gl-shader":332,glslify:434}],346:[function(h,N,H){N.exports=function(G){var Y=G.gl,K=l(Y),D=v(Y),B=y(Y),q=_(Y),ee=m(Y),J=g(Y,[{buffer:ee,size:4,stride:40,offset:0},{buffer:ee,size:3,stride:40,offset:16},{buffer:ee,size:3,stride:40,offset:28}]),$=m(Y),te=g(Y,[{buffer:$,size:4,stride:20,offset:0},{buffer:$,size:1,stride:20,offset:16}]),ie=m(Y),ae=g(Y,[{buffer:ie,size:2,type:Y.FLOAT}]),he=p(Y,1,256,Y.RGBA,Y.UNSIGNED_BYTE);he.minFilter=Y.LINEAR,he.magFilter=Y.LINEAR;var se=new w(Y,[0,0],[[0,0,0],[0,0,0]],K,D,ee,J,he,B,q,$,te,ie,ae,[0,0,0]),de={levels:[[],[],[]]};for(var ce in G)de[ce]=G[ce];return de.colormap=de.colormap||"jet",se.update(de),se};var t=h("bit-twiddle"),m=h("gl-buffer"),g=h("gl-vao"),p=h("gl-texture2d"),e=h("typedarray-pool"),f=h("colormap"),u=h("ndarray-ops"),i=h("ndarray-pack"),s=h("ndarray"),o=h("surface-nets"),a=h("gl-mat4/multiply"),c=h("gl-mat4/invert"),r=h("binary-search-bounds"),n=h("ndarray-gradient"),d=h("./lib/shaders"),l=d.createShader,y=d.createContourShader,v=d.createPickShader,_=d.createPickContourShader,x=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],T=[[0,0],[0,1],[1,0],[1,1],[1,0],[0,1]],A=[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]];function S(G,Y,K,D,B){this.position=G,this.index=Y,this.uv=K,this.level=D,this.dataCoordinate=B}(function(){for(var G=0;G<3;++G){var Y=A[G],K=(G+2)%3;Y[(G+1)%3+0]=1,Y[K+3]=1,Y[G+6]=1}})();function w(G,Y,K,D,B,q,ee,J,$,te,ie,ae,he,se,de){this.gl=G,this.shape=Y,this.bounds=K,this.objectOffset=de,this.intensityBounds=[],this._shader=D,this._pickShader=B,this._coordinateBuffer=q,this._vao=ee,this._colorMap=J,this._contourShader=$,this._contourPickShader=te,this._contourBuffer=ie,this._contourVAO=ae,this._contourOffsets=[[],[],[]],this._contourCounts=[[],[],[]],this._vertexCount=0,this._pickResult=new S([0,0,0],[0,0],[0,0],[0,0,0],[0,0,0]),this._dynamicBuffer=he,this._dynamicVAO=se,this._dynamicOffsets=[0,0,0],this._dynamicCounts=[0,0,0],this.contourWidth=[1,1,1],this.contourLevels=[[1],[1],[1]],this.contourTint=[0,0,0],this.contourColor=[[.5,.5,.5,1],[.5,.5,.5,1],[.5,.5,.5,1]],this.showContour=!0,this.showSurface=!0,this.enableHighlight=[!0,!0,!0],this.highlightColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.highlightTint=[1,1,1],this.highlightLevel=[-1,-1,-1],this.enableDynamic=[!0,!0,!0],this.dynamicLevel=[NaN,NaN,NaN],this.dynamicColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.dynamicTint=[1,1,1],this.dynamicWidth=[1,1,1],this.axesBounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.surfaceProject=[!1,!1,!1],this.contourProject=[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],this.colorBounds=[!1,!1],this._field=[s(e.mallocFloat(1024),[0,0]),s(e.mallocFloat(1024),[0,0]),s(e.mallocFloat(1024),[0,0])],this.pickId=1,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.snapToData=!1,this.pixelRatio=1,this.opacity=1,this.lightPosition=[10,1e4,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.vertexColor=0,this.dirty=!0}var L=w.prototype;L.genColormap=function(G,Y){var K=!1,D=i([f({colormap:G,nshades:256,format:"rgba"}).map(function(B,q){var ee=Y?function(J,$){if(!$||!$.length)return 1;for(var te=0;te<$.length;++te){if($.length<2)return 1;if($[te][0]===J)return $[te][1];if($[te][0]>J&&te>0){var ie=($[te][0]-J)/($[te][0]-$[te-1][0]);return $[te][1]*(1-ie)+ie*$[te-1][1]}}return 1}(q/255,Y):B[3];return ee<1&&(K=!0),[B[0],B[1],B[2],255*ee]})]);return u.divseq(D,255),this.hasAlphaScale=K,D},L.isTransparent=function(){return this.opacity<1||this.hasAlphaScale},L.isOpaque=function(){return!this.isTransparent()},L.pickSlots=1,L.setPickBase=function(G){this.pickId=G};var k=[0,0,0],C={showSurface:!1,showContour:!1,projections:[x.slice(),x.slice(),x.slice()],clipBounds:[[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]]]};function M(G,Y){var K,D,B,q=Y.axes&&Y.axes.lastCubeProps.axis||k,ee=Y.showSurface,J=Y.showContour;for(K=0;K<3;++K)for(ee=ee||Y.surfaceProject[K],D=0;D<3;++D)J=J||Y.contourProject[K][D];for(K=0;K<3;++K){var $=C.projections[K];for(D=0;D<16;++D)$[D]=0;for(D=0;D<4;++D)$[5*D]=1;$[5*K]=0,$[12+K]=Y.axesBounds[+(q[K]>0)][K],a($,G.model,$);var te=C.clipBounds[K];for(B=0;B<2;++B)for(D=0;D<3;++D)te[B][D]=G.clipBounds[B][D];te[0][K]=-1e8,te[1][K]=1e8}return C.showSurface=ee,C.showContour=J,C}var P={model:x,view:x,projection:x,inverseModel:x.slice(),lowerBound:[0,0,0],upperBound:[0,0,0],colorMap:0,clipBounds:[[0,0,0],[0,0,0]],height:0,contourTint:0,contourColor:[0,0,0,1],permutation:[1,0,0,0,1,0,0,0,1],zOffset:-1e-4,objectOffset:[0,0,0],kambient:1,kdiffuse:1,kspecular:1,lightPosition:[1e3,1e3,1e3],eyePosition:[0,0,0],roughness:1,fresnel:1,opacity:1,vertexColor:0},O=x.slice(),F=[1,0,0,0,1,0,0,0,1];function j(G,Y){G=G||{};var K=this.gl;K.disable(K.CULL_FACE),this._colorMap.bind(0);var D=P;D.model=G.model||x,D.view=G.view||x,D.projection=G.projection||x,D.lowerBound=[this.bounds[0][0],this.bounds[0][1],this.colorBounds[0]||this.bounds[0][2]],D.upperBound=[this.bounds[1][0],this.bounds[1][1],this.colorBounds[1]||this.bounds[1][2]],D.objectOffset=this.objectOffset,D.contourColor=this.contourColor[0],D.inverseModel=c(D.inverseModel,D.model);for(var B=0;B<2;++B)for(var q=D.clipBounds[B],ee=0;ee<3;++ee)q[ee]=Math.min(Math.max(this.clipBounds[B][ee],-1e8),1e8);D.kambient=this.ambientLight,D.kdiffuse=this.diffuseLight,D.kspecular=this.specularLight,D.roughness=this.roughness,D.fresnel=this.fresnel,D.opacity=this.opacity,D.height=0,D.permutation=F,D.vertexColor=this.vertexColor;var J=O;for(a(J,D.view,D.model),a(J,D.projection,J),c(J,J),B=0;B<3;++B)D.eyePosition[B]=J[12+B]/J[15];var $=J[15];for(B=0;B<3;++B)$+=this.lightPosition[B]*J[4*B+3];for(B=0;B<3;++B){var te=J[12+B];for(ee=0;ee<3;++ee)te+=J[4*ee+B]*this.lightPosition[ee];D.lightPosition[B]=te/$}var ie=M(D,this);if(ie.showSurface){for(this._shader.bind(),this._shader.uniforms=D,this._vao.bind(),this.showSurface&&this._vertexCount&&this._vao.draw(K.TRIANGLES,this._vertexCount),B=0;B<3;++B)this.surfaceProject[B]&&this.vertexCount&&(this._shader.uniforms.model=ie.projections[B],this._shader.uniforms.clipBounds=ie.clipBounds[B],this._vao.draw(K.TRIANGLES,this._vertexCount));this._vao.unbind()}if(ie.showContour){var ae=this._contourShader;D.kambient=1,D.kdiffuse=0,D.kspecular=0,D.opacity=1,ae.bind(),ae.uniforms=D;var he=this._contourVAO;for(he.bind(),B=0;B<3;++B)for(ae.uniforms.permutation=A[B],K.lineWidth(this.contourWidth[B]*this.pixelRatio),ee=0;ee<this.contourLevels[B].length;++ee)ee===this.highlightLevel[B]?(ae.uniforms.contourColor=this.highlightColor[B],ae.uniforms.contourTint=this.highlightTint[B]):ee!==0&&ee-1!==this.highlightLevel[B]||(ae.uniforms.contourColor=this.contourColor[B],ae.uniforms.contourTint=this.contourTint[B]),this._contourCounts[B][ee]&&(ae.uniforms.height=this.contourLevels[B][ee],he.draw(K.LINES,this._contourCounts[B][ee],this._contourOffsets[B][ee]));for(B=0;B<3;++B)for(ae.uniforms.model=ie.projections[B],ae.uniforms.clipBounds=ie.clipBounds[B],ee=0;ee<3;++ee)if(this.contourProject[B][ee]){ae.uniforms.permutation=A[ee],K.lineWidth(this.contourWidth[ee]*this.pixelRatio);for(var se=0;se<this.contourLevels[ee].length;++se)se===this.highlightLevel[ee]?(ae.uniforms.contourColor=this.highlightColor[ee],ae.uniforms.contourTint=this.highlightTint[ee]):se!==0&&se-1!==this.highlightLevel[ee]||(ae.uniforms.contourColor=this.contourColor[ee],ae.uniforms.contourTint=this.contourTint[ee]),this._contourCounts[ee][se]&&(ae.uniforms.height=this.contourLevels[ee][se],he.draw(K.LINES,this._contourCounts[ee][se],this._contourOffsets[ee][se]))}for(he.unbind(),(he=this._dynamicVAO).bind(),B=0;B<3;++B)if(this._dynamicCounts[B]!==0)for(ae.uniforms.model=D.model,ae.uniforms.clipBounds=D.clipBounds,ae.uniforms.permutation=A[B],K.lineWidth(this.dynamicWidth[B]*this.pixelRatio),ae.uniforms.contourColor=this.dynamicColor[B],ae.uniforms.contourTint=this.dynamicTint[B],ae.uniforms.height=this.dynamicLevel[B],he.draw(K.LINES,this._dynamicCounts[B],this._dynamicOffsets[B]),ee=0;ee<3;++ee)this.contourProject[ee][B]&&(ae.uniforms.model=ie.projections[ee],ae.uniforms.clipBounds=ie.clipBounds[ee],he.draw(K.LINES,this._dynamicCounts[B],this._dynamicOffsets[B]));he.unbind()}}L.draw=function(G){return j.call(this,G,!1)},L.drawTransparent=function(G){return j.call(this,G,!0)};var W={model:x,view:x,projection:x,inverseModel:x,clipBounds:[[0,0,0],[0,0,0]],height:0,shape:[0,0],pickId:0,lowerBound:[0,0,0],upperBound:[0,0,0],zOffset:0,objectOffset:[0,0,0],permutation:[1,0,0,0,1,0,0,0,1],lightPosition:[0,0,0],eyePosition:[0,0,0]};function Z(G,Y){return Array.isArray(G)?[Y(G[0]),Y(G[1]),Y(G[2])]:[Y(G),Y(G),Y(G)]}function Q(G){return Array.isArray(G)?G.length===3?[G[0],G[1],G[2],1]:[G[0],G[1],G[2],G[3]]:[0,0,0,1]}function X(G){if(Array.isArray(G)){if(Array.isArray(G))return[Q(G[0]),Q(G[1]),Q(G[2])];var Y=Q(G);return[Y.slice(),Y.slice(),Y.slice()]}}L.drawPick=function(G){G=G||{};var Y=this.gl;Y.disable(Y.CULL_FACE);var K=W;K.model=G.model||x,K.view=G.view||x,K.projection=G.projection||x,K.shape=this._field[2].shape,K.pickId=this.pickId/255,K.lowerBound=this.bounds[0],K.upperBound=this.bounds[1],K.objectOffset=this.objectOffset,K.permutation=F;for(var D=0;D<2;++D)for(var B=K.clipBounds[D],q=0;q<3;++q)B[q]=Math.min(Math.max(this.clipBounds[D][q],-1e8),1e8);var ee=M(K,this);if(ee.showSurface){for(this._pickShader.bind(),this._pickShader.uniforms=K,this._vao.bind(),this._vao.draw(Y.TRIANGLES,this._vertexCount),D=0;D<3;++D)this.surfaceProject[D]&&(this._pickShader.uniforms.model=ee.projections[D],this._pickShader.uniforms.clipBounds=ee.clipBounds[D],this._vao.draw(Y.TRIANGLES,this._vertexCount));this._vao.unbind()}if(ee.showContour){var J=this._contourPickShader;J.bind(),J.uniforms=K;var $=this._contourVAO;for($.bind(),q=0;q<3;++q)for(Y.lineWidth(this.contourWidth[q]*this.pixelRatio),J.uniforms.permutation=A[q],D=0;D<this.contourLevels[q].length;++D)this._contourCounts[q][D]&&(J.uniforms.height=this.contourLevels[q][D],$.draw(Y.LINES,this._contourCounts[q][D],this._contourOffsets[q][D]));for(D=0;D<3;++D)for(J.uniforms.model=ee.projections[D],J.uniforms.clipBounds=ee.clipBounds[D],q=0;q<3;++q)if(this.contourProject[D][q]){J.uniforms.permutation=A[q],Y.lineWidth(this.contourWidth[q]*this.pixelRatio);for(var te=0;te<this.contourLevels[q].length;++te)this._contourCounts[q][te]&&(J.uniforms.height=this.contourLevels[q][te],$.draw(Y.LINES,this._contourCounts[q][te],this._contourOffsets[q][te]))}$.unbind()}},L.pick=function(G){if(!G||G.id!==this.pickId)return null;var Y=this._field[2].shape,K=this._pickResult,D=Y[0]*(G.value[0]+(G.value[2]>>4)/16)/255,B=Math.floor(D),q=D-B,ee=Y[1]*(G.value[1]+(15&G.value[2])/16)/255,J=Math.floor(ee),$=ee-J;B+=1,J+=1;var te=K.position;te[0]=te[1]=te[2]=0;for(var ie=0;ie<2;++ie)for(var ae=ie?q:1-q,he=0;he<2;++he)for(var se=B+ie,de=J+he,ce=ae*(he?$:1-$),ve=0;ve<3;++ve)te[ve]+=this._field[ve].get(se,de)*ce;for(var ke=this._pickResult.level,Ee=0;Ee<3;++Ee)if(ke[Ee]=r.le(this.contourLevels[Ee],te[Ee]),ke[Ee]<0)this.contourLevels[Ee].length>0&&(ke[Ee]=0);else if(ke[Ee]<this.contourLevels[Ee].length-1){var be=this.contourLevels[Ee][ke[Ee]],xe=this.contourLevels[Ee][ke[Ee]+1];Math.abs(be-te[Ee])>Math.abs(xe-te[Ee])&&(ke[Ee]+=1)}for(K.index[0]=q<.5?B:B+1,K.index[1]=$<.5?J:J+1,K.uv[0]=D/Y[0],K.uv[1]=ee/Y[1],ve=0;ve<3;++ve)K.dataCoordinate[ve]=this._field[ve].get(K.index[0],K.index[1]);return K},L.padField=function(G,Y){var K=Y.shape.slice(),D=G.shape.slice();u.assign(G.lo(1,1).hi(K[0],K[1]),Y),u.assign(G.lo(1).hi(K[0],1),Y.hi(K[0],1)),u.assign(G.lo(1,D[1]-1).hi(K[0],1),Y.lo(0,K[1]-1).hi(K[0],1)),u.assign(G.lo(0,1).hi(1,K[1]),Y.hi(1)),u.assign(G.lo(D[0]-1,1).hi(1,K[1]),Y.lo(K[0]-1)),G.set(0,0,Y.get(0,0)),G.set(0,D[1]-1,Y.get(0,K[1]-1)),G.set(D[0]-1,0,Y.get(K[0]-1,0)),G.set(D[0]-1,D[1]-1,Y.get(K[0]-1,K[1]-1))},L.update=function(G){G=G||{},this.objectOffset=G.objectOffset||this.objectOffset,this.dirty=!0,"contourWidth"in G&&(this.contourWidth=Z(G.contourWidth,Number)),"showContour"in G&&(this.showContour=Z(G.showContour,Boolean)),"showSurface"in G&&(this.showSurface=!!G.showSurface),"contourTint"in G&&(this.contourTint=Z(G.contourTint,Boolean)),"contourColor"in G&&(this.contourColor=X(G.contourColor)),"contourProject"in G&&(this.contourProject=Z(G.contourProject,function(bt){return Z(bt,Boolean)})),"surfaceProject"in G&&(this.surfaceProject=G.surfaceProject),"dynamicColor"in G&&(this.dynamicColor=X(G.dynamicColor)),"dynamicTint"in G&&(this.dynamicTint=Z(G.dynamicTint,Number)),"dynamicWidth"in G&&(this.dynamicWidth=Z(G.dynamicWidth,Number)),"opacity"in G&&(this.opacity=G.opacity),"opacityscale"in G&&(this.opacityscale=G.opacityscale),"colorBounds"in G&&(this.colorBounds=G.colorBounds),"vertexColor"in G&&(this.vertexColor=G.vertexColor?1:0),"colormap"in G&&this._colorMap.setPixels(this.genColormap(G.colormap,this.opacityscale));var Y=G.field||G.coords&&G.coords[2]||null,K=!1;if(Y||(Y=this._field[2].shape[0]||this._field[2].shape[2]?this._field[2].lo(1,1).hi(this._field[2].shape[0]-2,this._field[2].shape[1]-2):this._field[2].hi(0,0)),"field"in G||"coords"in G){var D=(Y.shape[0]+2)*(Y.shape[1]+2);D>this._field[2].data.length&&(e.freeFloat(this._field[2].data),this._field[2].data=e.mallocFloat(t.nextPow2(D))),this._field[2]=s(this._field[2].data,[Y.shape[0]+2,Y.shape[1]+2]),this.padField(this._field[2],Y),this.shape=Y.shape.slice();for(var B=this.shape,q=0;q<2;++q)this._field[2].size>this._field[q].data.length&&(e.freeFloat(this._field[q].data),this._field[q].data=e.mallocFloat(this._field[2].size)),this._field[q]=s(this._field[q].data,[B[0]+2,B[1]+2]);if(G.coords){var ee=G.coords;if(!Array.isArray(ee)||ee.length!==3)throw new Error("gl-surface: invalid coordinates for x/y");for(q=0;q<2;++q){var J=ee[q];for(he=0;he<2;++he)if(J.shape[he]!==B[he])throw new Error("gl-surface: coords have incorrect shape");this.padField(this._field[q],J)}}else if(G.ticks){var $=G.ticks;if(!Array.isArray($)||$.length!==2)throw new Error("gl-surface: invalid ticks");for(q=0;q<2;++q){var te=$[q];if((Array.isArray(te)||te.length)&&(te=s(te)),te.shape[0]!==B[q])throw new Error("gl-surface: invalid tick length");var ie=s(te.data,B);ie.stride[q]=te.stride[0],ie.stride[1^q]=0,this.padField(this._field[q],ie)}}else{for(q=0;q<2;++q){var ae=[0,0];ae[q]=1,this._field[q]=s(this._field[q].data,[B[0]+2,B[1]+2],ae,0)}this._field[0].set(0,0,0);for(var he=0;he<B[0];++he)this._field[0].set(he+1,0,he);for(this._field[0].set(B[0]+1,0,B[0]-1),this._field[1].set(0,0,0),he=0;he<B[1];++he)this._field[1].set(0,he+1,he);this._field[1].set(0,B[1]+1,B[1]-1)}var se=this._field,de=s(e.mallocFloat(3*se[2].size*2),[3,B[0]+2,B[1]+2,2]);for(q=0;q<3;++q)n(de.pick(q),se[q],"mirror");var ce=s(e.mallocFloat(3*se[2].size),[B[0]+2,B[1]+2,3]);for(q=0;q<B[0]+2;++q)for(he=0;he<B[1]+2;++he){var ve=de.get(0,q,he,0),ke=de.get(0,q,he,1),Ee=de.get(1,q,he,0),be=de.get(1,q,he,1),xe=de.get(2,q,he,0),ue=de.get(2,q,he,1),me=Ee*ue-be*xe,we=xe*ke-ue*ve,Me=ve*be-ke*Ee,Se=Math.sqrt(me*me+we*we+Me*Me);Se<1e-8?(Se=Math.max(Math.abs(me),Math.abs(we),Math.abs(Me)))<1e-8?(Me=1,we=me=0,Se=1):Se=1/Se:Se=1/Math.sqrt(Se),ce.set(q,he,0,me*Se),ce.set(q,he,1,we*Se),ce.set(q,he,2,Me*Se)}e.free(de.data);var De=[1/0,1/0,1/0],Fe=[-1/0,-1/0,-1/0],Ye=1/0,et=-1/0,Oe=(B[0]-1)*(B[1]-1)*6,je=e.mallocFloat(t.nextPow2(10*Oe)),We=0,Ge=0;for(q=0;q<B[0]-1;++q)e:for(he=0;he<B[1]-1;++he){for(var Qe=0;Qe<2;++Qe)for(var it=0;it<2;++it)for(var lt=0;lt<3;++lt){var Lt=this._field[lt].get(1+q+Qe,1+he+it);if(isNaN(Lt)||!isFinite(Lt))continue e}for(lt=0;lt<6;++lt){var wt=q+T[lt][0],rt=he+T[lt][1],$e=this._field[0].get(wt+1,rt+1),xt=this._field[1].get(wt+1,rt+1);Lt=this._field[2].get(wt+1,rt+1),me=ce.get(wt+1,rt+1,0),we=ce.get(wt+1,rt+1,1),Me=ce.get(wt+1,rt+1,2),G.intensity&&(Qt=G.intensity.get(wt,rt));var Qt=G.intensity?G.intensity.get(wt,rt):Lt+this.objectOffset[2];je[We++]=wt,je[We++]=rt,je[We++]=$e,je[We++]=xt,je[We++]=Lt,je[We++]=0,je[We++]=Qt,je[We++]=me,je[We++]=we,je[We++]=Me,De[0]=Math.min(De[0],$e+this.objectOffset[0]),De[1]=Math.min(De[1],xt+this.objectOffset[1]),De[2]=Math.min(De[2],Lt+this.objectOffset[2]),Ye=Math.min(Ye,Qt),Fe[0]=Math.max(Fe[0],$e+this.objectOffset[0]),Fe[1]=Math.max(Fe[1],xt+this.objectOffset[1]),Fe[2]=Math.max(Fe[2],Lt+this.objectOffset[2]),et=Math.max(et,Qt),Ge+=1}}for(G.intensityBounds&&(Ye=+G.intensityBounds[0],et=+G.intensityBounds[1]),q=6;q<We;q+=10)je[q]=(je[q]-Ye)/(et-Ye);this._vertexCount=Ge,this._coordinateBuffer.update(je.subarray(0,We)),e.freeFloat(je),e.free(ce.data),this.bounds=[De,Fe],this.intensity=G.intensity||this._field[2],this.intensityBounds[0]===Ye&&this.intensityBounds[1]===et||(K=!0),this.intensityBounds=[Ye,et]}if("levels"in G){var $t=G.levels;for($t=Array.isArray($t[0])?$t.slice():[[],[],$t],q=0;q<3;++q)$t[q]=$t[q].slice(),$t[q].sort(function(bt,Pt){return bt-Pt});for(q=0;q<3;++q)for(he=0;he<$t[q].length;++he)$t[q][he]-=this.objectOffset[q];e:for(q=0;q<3;++q){if($t[q].length!==this.contourLevels[q].length){K=!0;break}for(he=0;he<$t[q].length;++he)if($t[q][he]!==this.contourLevels[q][he]){K=!0;break e}}this.contourLevels=$t}if(K){se=this._field,B=this.shape;for(var Ue=[],He=0;He<3;++He){var Be=this.contourLevels[He],Je=[],_e=[],Le=[0,0,0];for(q=0;q<Be.length;++q){var Ce=o(this._field[He],Be[q]);Je.push(Ue.length/5|0),Ge=0;e:for(he=0;he<Ce.cells.length;++he){var Pe=Ce.cells[he];for(lt=0;lt<2;++lt){var Xe=Ce.positions[Pe[lt]],ut=Xe[0],kt=0|Math.floor(ut),ft=ut-kt,Et=Xe[1],mt=0|Math.floor(Et),It=Et-mt,vt=!1;t:for(var nt=0;nt<3;++nt){Le[nt]=0;var At=(He+nt+1)%3;for(Qe=0;Qe<2;++Qe){var Ft=Qe?ft:1-ft;for(wt=0|Math.min(Math.max(kt+Qe,0),B[0]),it=0;it<2;++it){var Nt=it?It:1-It;if(rt=0|Math.min(Math.max(mt+it,0),B[1]),Lt=nt<2?this._field[At].get(wt,rt):(this.intensity.get(wt,rt)-this.intensityBounds[0])/(this.intensityBounds[1]-this.intensityBounds[0]),!isFinite(Lt)||isNaN(Lt)){vt=!0;break t}var Kt=Ft*Nt;Le[nt]+=Kt*Lt}}}if(vt){if(lt>0){for(var Ie=0;Ie<5;++Ie)Ue.pop();Ge-=1}continue e}Ue.push(Le[0],Le[1],Xe[0],Xe[1],Le[2]),Ge+=1}}_e.push(Ge)}this._contourOffsets[He]=Je,this._contourCounts[He]=_e}var ot=e.mallocFloat(Ue.length);for(q=0;q<Ue.length;++q)ot[q]=Ue[q];this._contourBuffer.update(ot),e.freeFloat(ot)}},L.dispose=function(){this._shader.dispose(),this._vao.dispose(),this._coordinateBuffer.dispose(),this._colorMap.dispose(),this._contourBuffer.dispose(),this._contourVAO.dispose(),this._contourShader.dispose(),this._contourPickShader.dispose(),this._dynamicBuffer.dispose(),this._dynamicVAO.dispose();for(var G=0;G<3;++G)e.freeFloat(this._field[G].data)},L.highlight=function(G){var Y,K;if(!G)return this._dynamicCounts=[0,0,0],this.dyanamicLevel=[NaN,NaN,NaN],void(this.highlightLevel=[-1,-1,-1]);for(Y=0;Y<3;++Y)this.enableHighlight[Y]?this.highlightLevel[Y]=G.level[Y]:this.highlightLevel[Y]=-1;for(K=this.snapToData?G.dataCoordinate:G.position,Y=0;Y<3;++Y)K[Y]-=this.objectOffset[Y];if(this.enableDynamic[0]&&K[0]!==this.dynamicLevel[0]||this.enableDynamic[1]&&K[1]!==this.dynamicLevel[1]||this.enableDynamic[2]&&K[2]!==this.dynamicLevel[2]){for(var D=0,B=this.shape,q=e.mallocFloat(12*B[0]*B[1]),ee=0;ee<3;++ee)if(this.enableDynamic[ee]){this.dynamicLevel[ee]=K[ee];var J=(ee+1)%3,$=(ee+2)%3,te=this._field[ee],ie=this._field[J],ae=this._field[$],he=o(te,K[ee]),se=he.cells,de=he.positions;for(this._dynamicOffsets[ee]=D,Y=0;Y<se.length;++Y)for(var ce=se[Y],ve=0;ve<2;++ve){var ke=de[ce[ve]],Ee=+ke[0],be=0|Ee,xe=0|Math.min(be+1,B[0]),ue=Ee-be,me=1-ue,we=+ke[1],Me=0|we,Se=0|Math.min(Me+1,B[1]),De=we-Me,Fe=1-De,Ye=me*Fe,et=me*De,Oe=ue*Fe,je=ue*De,We=Ye*ie.get(be,Me)+et*ie.get(be,Se)+Oe*ie.get(xe,Me)+je*ie.get(xe,Se),Ge=Ye*ae.get(be,Me)+et*ae.get(be,Se)+Oe*ae.get(xe,Me)+je*ae.get(xe,Se);if(isNaN(We)||isNaN(Ge)){ve&&(D-=1);break}q[2*D+0]=We,q[2*D+1]=Ge,D+=1}this._dynamicCounts[ee]=D-this._dynamicOffsets[ee]}else this.dynamicLevel[ee]=NaN,this._dynamicCounts[ee]=0;this._dynamicBuffer.update(q.subarray(0,2*D)),e.freeFloat(q)}}},{"./lib/shaders":345,"binary-search-bounds":103,"bit-twiddle":104,colormap:137,"gl-buffer":261,"gl-mat4/invert":293,"gl-mat4/multiply":295,"gl-texture2d":348,"gl-vao":353,ndarray:472,"ndarray-gradient":465,"ndarray-ops":467,"ndarray-pack":468,"surface-nets":576,"typedarray-pool":601}],347:[function(h,N,H){var t=h("css-font"),m=h("pick-by-alias"),g=h("regl"),p=h("gl-util/context"),e=h("es6-weak-map"),f=h("color-normalize"),u=h("font-atlas"),i=h("typedarray-pool"),s=h("parse-rect"),o=h("is-plain-obj"),a=h("parse-unit"),c=h("to-px"),r=h("detect-kerning"),n=h("object-assign"),d=h("font-measure"),l=h("flatten-vertex-data"),y=h("bit-twiddle").nextPow2,v=new e,_=!1;if(document.body){var x=document.body.appendChild(document.createElement("div"));x.style.font="italic small-caps bold condensed 16px/2 cursive",getComputedStyle(x).fontStretch&&(_=!0),document.body.removeChild(x)}var T=function(A){(function(S){return typeof S=="function"&&S._gl&&S.prop&&S.texture&&S.buffer})(A)?(A={regl:A},this.gl=A.regl._gl):this.gl=p(A),this.shader=v.get(this.gl),this.shader?this.regl=this.shader.regl:this.regl=A.regl||g({gl:this.gl}),this.charBuffer=this.regl.buffer({type:"uint8",usage:"stream"}),this.sizeBuffer=this.regl.buffer({type:"float",usage:"stream"}),this.shader||(this.shader=this.createShader(),v.set(this.gl,this.shader)),this.batch=[],this.fontSize=[],this.font=[],this.fontAtlas=[],this.draw=this.shader.draw.bind(this),this.render=function(){this.regl._refresh(),this.draw(this.batch)},this.canvas=this.gl.canvas,this.update(o(A)?A:{})};T.prototype.createShader=function(){var A=this.regl,S=A({blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},stencil:{enable:!1},depth:{enable:!1},count:A.prop("count"),offset:A.prop("offset"),attributes:{charOffset:{offset:4,stride:8,buffer:A.this("sizeBuffer")},width:{offset:0,stride:8,buffer:A.this("sizeBuffer")},char:A.this("charBuffer"),position:A.this("position")},uniforms:{atlasSize:function(w,L){return[L.atlas.width,L.atlas.height]},atlasDim:function(w,L){return[L.atlas.cols,L.atlas.rows]},atlas:function(w,L){return L.atlas.texture},charStep:function(w,L){return L.atlas.step},em:function(w,L){return L.atlas.em},color:A.prop("color"),opacity:A.prop("opacity"),viewport:A.this("viewportArray"),scale:A.this("scale"),align:A.prop("align"),baseline:A.prop("baseline"),translate:A.this("translate"),positionOffset:A.prop("positionOffset")},primitive:"points",viewport:A.this("viewport"),vert:`
			precision highp float;
			attribute float width, charOffset, char;
			attribute vec2 position;
			uniform float fontSize, charStep, em, align, baseline;
			uniform vec4 viewport;
			uniform vec4 color;
			uniform vec2 atlasSize, atlasDim, scale, translate, positionOffset;
			varying vec2 charCoord, charId;
			varying float charWidth;
			varying vec4 fontColor;
			void main () {
				vec2 offset = floor(em * (vec2(align + charOffset, baseline)
					+ vec2(positionOffset.x, -positionOffset.y)))
					/ (viewport.zw * scale.xy);

				vec2 position = (position + translate) * scale;
				position += offset * scale;

				charCoord = position * viewport.zw + viewport.xy;

				gl_Position = vec4(position * 2. - 1., 0, 1);

				gl_PointSize = charStep;

				charId.x = mod(char, atlasDim.x);
				charId.y = floor(char / atlasDim.x);

				charWidth = width * em;

				fontColor = color / 255.;
			}`,frag:`
			precision highp float;
			uniform float fontSize, charStep, opacity;
			uniform vec2 atlasSize;
			uniform vec4 viewport;
			uniform sampler2D atlas;
			varying vec4 fontColor;
			varying vec2 charCoord, charId;
			varying float charWidth;

			float lightness(vec4 color) {
				return color.r * 0.299 + color.g * 0.587 + color.b * 0.114;
			}

			void main () {
				vec2 uv = gl_FragCoord.xy - charCoord + charStep * .5;
				float halfCharStep = floor(charStep * .5 + .5);

				// invert y and shift by 1px (FF expecially needs that)
				uv.y = charStep - uv.y;

				// ignore points outside of character bounding box
				float halfCharWidth = ceil(charWidth * .5);
				if (floor(uv.x) > halfCharStep + halfCharWidth ||
					floor(uv.x) < halfCharStep - halfCharWidth) return;

				uv += charId * charStep;
				uv = uv / atlasSize;

				vec4 color = fontColor;
				vec4 mask = texture2D(atlas, uv);

				float maskY = lightness(mask);
				// float colorY = lightness(color);
				color.a *= maskY;
				color.a *= opacity;

				// color.a += .1;

				// antialiasing, see yiq color space y-channel formula
				// color.rgb += (1. - color.rgb) * (1. - mask.rgb);

				gl_FragColor = color;
			}`});return{regl:A,draw:S,atlas:{}}},T.prototype.update=function(A){var S=this;if(typeof A=="string")A={text:A};else if(!A)return;(A=m(A,{position:"position positions coord coords coordinates",font:"font fontFace fontface typeface cssFont css-font family fontFamily",fontSize:"fontSize fontsize size font-size",text:"text texts chars characters value values symbols",align:"align alignment textAlign textbaseline",baseline:"baseline textBaseline textbaseline",direction:"dir direction textDirection",color:"color colour fill fill-color fillColor textColor textcolor",kerning:"kerning kern",range:"range dataBox",viewport:"vp viewport viewBox viewbox viewPort",opacity:"opacity alpha transparency visible visibility opaque",offset:"offset positionOffset padding shift indent indentation"},!0)).opacity!=null&&(Array.isArray(A.opacity)?this.opacity=A.opacity.map(function(me){return parseFloat(me)}):this.opacity=parseFloat(A.opacity)),A.viewport!=null&&(this.viewport=s(A.viewport),this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),this.viewport==null&&(this.viewport={x:0,y:0,width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight},this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),A.kerning!=null&&(this.kerning=A.kerning),A.offset!=null&&(typeof A.offset=="number"&&(A.offset=[A.offset,0]),this.positionOffset=l(A.offset)),A.direction&&(this.direction=A.direction),A.range&&(this.range=A.range,this.scale=[1/(A.range[2]-A.range[0]),1/(A.range[3]-A.range[1])],this.translate=[-A.range[0],-A.range[1]]),A.scale&&(this.scale=A.scale),A.translate&&(this.translate=A.translate),this.scale||(this.scale=[1/this.viewport.width,1/this.viewport.height]),this.translate||(this.translate=[0,0]),this.font.length||A.font||(A.font=T.baseFontSize+"px sans-serif");var w,L=!1,k=!1;if(A.font&&(Array.isArray(A.font)?A.font:[A.font]).forEach(function(me,we){if(typeof me=="string")try{me=t.parse(me)}catch(et){me=t.parse(T.baseFontSize+"px "+me)}else me=t.parse(t.stringify(me));var Me=t.stringify({size:T.baseFontSize,family:me.family,stretch:_?me.stretch:void 0,variant:me.variant,weight:me.weight,style:me.style}),Se=a(me.size),De=Math.round(Se[0]*c(Se[1]));if(De!==S.fontSize[we]&&(k=!0,S.fontSize[we]=De),!(S.font[we]&&Me==S.font[we].baseString||(L=!0,S.font[we]=T.fonts[Me],S.font[we]))){var Fe=me.family.join(", "),Ye=[me.style];me.style!=me.variant&&Ye.push(me.variant),me.variant!=me.weight&&Ye.push(me.weight),_&&me.weight!=me.stretch&&Ye.push(me.stretch),S.font[we]={baseString:Me,family:Fe,weight:me.weight,stretch:me.stretch,style:me.style,variant:me.variant,width:{},kerning:{},metrics:d(Fe,{origin:"top",fontSize:T.baseFontSize,fontStyle:Ye.join(" ")})},T.fonts[Me]=S.font[we]}}),(L||k)&&this.font.forEach(function(me,we){var Me=t.stringify({size:S.fontSize[we],family:me.family,stretch:_?me.stretch:void 0,variant:me.variant,weight:me.weight,style:me.style});if(S.fontAtlas[we]=S.shader.atlas[Me],!S.fontAtlas[we]){var Se=me.metrics;S.shader.atlas[Me]=S.fontAtlas[we]={fontString:Me,step:2*Math.ceil(S.fontSize[we]*Se.bottom*.5),em:S.fontSize[we],cols:0,rows:0,height:0,width:0,chars:[],ids:{},texture:S.regl.texture()}}A.text==null&&(A.text=S.text)}),typeof A.text=="string"&&A.position&&A.position.length>2){for(var C=Array(.5*A.position.length),M=0;M<C.length;M++)C[M]=A.text;A.text=C}if(A.text!=null||L){if(this.textOffsets=[0],Array.isArray(A.text)){this.count=A.text[0].length,this.counts=[this.count];for(var P=1;P<A.text.length;P++)this.textOffsets[P]=this.textOffsets[P-1]+A.text[P-1].length,this.count+=A.text[P].length,this.counts.push(A.text[P].length);this.text=A.text.join("")}else this.text=A.text,this.count=this.text.length,this.counts=[this.count];w=[],this.font.forEach(function(me,we){T.atlasContext.font=me.baseString;for(var Me=S.fontAtlas[we],Se=0;Se<S.text.length;Se++){var De=S.text.charAt(Se);if(Me.ids[De]==null&&(Me.ids[De]=Me.chars.length,Me.chars.push(De),w.push(De)),me.width[De]==null&&(me.width[De]=T.atlasContext.measureText(De).width/T.baseFontSize,S.kerning)){var Fe=[];for(var Ye in me.width)Fe.push(Ye+De,De+Ye);n(me.kerning,r(me.family,{pairs:Fe}))}}})}if(A.position)if(A.position.length>2){for(var O=!A.position[0].length,F=i.mallocFloat(2*this.count),j=0,W=0;j<this.counts.length;j++){var Z=this.counts[j];if(O)for(var Q=0;Q<Z;Q++)F[W++]=A.position[2*j],F[W++]=A.position[2*j+1];else for(var X=0;X<Z;X++)F[W++]=A.position[j][0],F[W++]=A.position[j][1]}this.position.call?this.position({type:"float",data:F}):this.position=this.regl.buffer({type:"float",data:F}),i.freeFloat(F)}else this.position.destroy&&this.position.destroy(),this.position={constant:A.position};if(A.text||L){var G=i.mallocUint8(this.count),Y=i.mallocFloat(2*this.count);this.textWidth=[];for(var K=0,D=0;K<this.counts.length;K++){for(var B=this.counts[K],q=this.font[K]||this.font[0],ee=this.fontAtlas[K]||this.fontAtlas[0],J=0;J<B;J++){var $=this.text.charAt(D),te=this.text.charAt(D-1);if(G[D]=ee.ids[$],Y[2*D]=q.width[$],J){var ie=Y[2*D-2],ae=Y[2*D],he=Y[2*D-1]+.5*ie+.5*ae;if(this.kerning){var se=q.kerning[te+$];se&&(he+=.001*se)}Y[2*D+1]=he}else Y[2*D+1]=.5*Y[2*D];D++}this.textWidth.push(Y.length?.5*Y[2*D-2]+Y[2*D-1]:0)}A.align||(A.align=this.align),this.charBuffer({data:G,type:"uint8",usage:"stream"}),this.sizeBuffer({data:Y,type:"float",usage:"stream"}),i.freeUint8(G),i.freeFloat(Y),w.length&&this.font.forEach(function(me,we){var Me=S.fontAtlas[we],Se=Me.step,De=Math.floor(T.maxAtlasSize/Se),Fe=Math.min(De,Me.chars.length),Ye=Math.ceil(Me.chars.length/Fe),et=y(Fe*Se),Oe=y(Ye*Se);Me.width=et,Me.height=Oe,Me.rows=Ye,Me.cols=Fe,Me.em&&Me.texture({data:u({canvas:T.atlasCanvas,font:Me.fontString,chars:Me.chars,shape:[et,Oe],step:[Se,Se]})})})}if(A.align&&(this.align=A.align,this.alignOffset=this.textWidth.map(function(me,we){var Me=Array.isArray(S.align)?S.align.length>1?S.align[we]:S.align[0]:S.align;if(typeof Me=="number")return Me;switch(Me){case"right":case"end":return-me;case"center":case"centre":case"middle":return .5*-me}return 0})),this.baseline==null&&A.baseline==null&&(A.baseline=0),A.baseline!=null&&(this.baseline=A.baseline,Array.isArray(this.baseline)||(this.baseline=[this.baseline]),this.baselineOffset=this.baseline.map(function(me,we){var Me=(S.font[we]||S.font[0]).metrics,Se=0;return Se+=.5*Me.bottom,Se+=typeof me=="number"?me-Me.baseline:-Me[me],Se*=-1})),A.color!=null)if(A.color||(A.color="transparent"),typeof A.color!="string"&&isNaN(A.color)){var de;if(typeof A.color[0]=="number"&&A.color.length>this.counts.length){var ce=A.color.length;de=i.mallocUint8(ce);for(var ve=(A.color.subarray||A.color.slice).bind(A.color),ke=0;ke<ce;ke+=4)de.set(f(ve(ke,ke+4),"uint8"),ke)}else{var Ee=A.color.length;de=i.mallocUint8(4*Ee);for(var be=0;be<Ee;be++)de.set(f(A.color[be]||0,"uint8"),4*be)}this.color=de}else this.color=f(A.color,"uint8");if(A.position||A.text||A.color||A.baseline||A.align||A.font||A.offset||A.opacity)if(this.color.length>4||this.baselineOffset.length>1||this.align&&this.align.length>1||this.fontAtlas.length>1||this.positionOffset.length>2){var xe=Math.max(.5*this.position.length||0,.25*this.color.length||0,this.baselineOffset.length||0,this.alignOffset.length||0,this.font.length||0,this.opacity.length||0,.5*this.positionOffset.length||0);this.batch=Array(xe);for(var ue=0;ue<this.batch.length;ue++)this.batch[ue]={count:this.counts.length>1?this.counts[ue]:this.counts[0],offset:this.textOffsets.length>1?this.textOffsets[ue]:this.textOffsets[0],color:this.color?this.color.length<=4?this.color:this.color.subarray(4*ue,4*ue+4):[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[ue]:this.opacity,baseline:this.baselineOffset[ue]!=null?this.baselineOffset[ue]:this.baselineOffset[0],align:this.align?this.alignOffset[ue]!=null?this.alignOffset[ue]:this.alignOffset[0]:0,atlas:this.fontAtlas[ue]||this.fontAtlas[0],positionOffset:this.positionOffset.length>2?this.positionOffset.subarray(2*ue,2*ue+2):this.positionOffset}}else this.count?this.batch=[{count:this.count,offset:0,color:this.color||[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[0]:this.opacity,baseline:this.baselineOffset[0],align:this.alignOffset?this.alignOffset[0]:0,atlas:this.fontAtlas[0],positionOffset:this.positionOffset}]:this.batch=[]},T.prototype.destroy=function(){},T.prototype.kerning=!0,T.prototype.position={constant:new Float32Array(2)},T.prototype.translate=null,T.prototype.scale=null,T.prototype.font=null,T.prototype.text="",T.prototype.positionOffset=[0,0],T.prototype.opacity=1,T.prototype.color=new Uint8Array([0,0,0,255]),T.prototype.alignOffset=[0,0],T.maxAtlasSize=1024,T.atlasCanvas=document.createElement("canvas"),T.atlasContext=T.atlasCanvas.getContext("2d",{alpha:!1}),T.baseFontSize=64,T.fonts={},N.exports=T},{"bit-twiddle":104,"color-normalize":131,"css-font":150,"detect-kerning":178,"es6-weak-map":238,"flatten-vertex-data":248,"font-atlas":249,"font-measure":250,"gl-util/context":349,"is-plain-obj":447,"object-assign":476,"parse-rect":481,"parse-unit":483,"pick-by-alias":485,regl:526,"to-px":585,"typedarray-pool":601}],348:[function(h,N,H){var t=h("ndarray"),m=h("ndarray-ops"),g=h("typedarray-pool");N.exports=function(v){if(arguments.length<=1)throw new Error("gl-texture2d: Missing arguments for texture2d constructor");if(p||u(v),typeof arguments[1]=="number")return d(v,arguments[1],arguments[2],arguments[3]||v.RGBA,arguments[4]||v.UNSIGNED_BYTE);if(Array.isArray(arguments[1]))return d(v,0|arguments[1][0],0|arguments[1][1],arguments[2]||v.RGBA,arguments[3]||v.UNSIGNED_BYTE);if(typeof arguments[1]=="object"){var _=arguments[1],x=i(_)?_:_.raw;if(x)return l(v,x,0|_.width,0|_.height,arguments[2]||v.RGBA,arguments[3]||v.UNSIGNED_BYTE);if(_.shape&&_.data&&_.stride)return y(v,_)}throw new Error("gl-texture2d: Invalid arguments for texture2d constructor")};var p=null,e=null,f=null;function u(v){p=[v.LINEAR,v.NEAREST_MIPMAP_LINEAR,v.LINEAR_MIPMAP_NEAREST,v.LINEAR_MIPMAP_NEAREST],e=[v.NEAREST,v.LINEAR,v.NEAREST_MIPMAP_NEAREST,v.NEAREST_MIPMAP_LINEAR,v.LINEAR_MIPMAP_NEAREST,v.LINEAR_MIPMAP_LINEAR],f=[v.REPEAT,v.CLAMP_TO_EDGE,v.MIRRORED_REPEAT]}function i(v){return typeof HTMLCanvasElement!="undefined"&&v instanceof HTMLCanvasElement||typeof HTMLImageElement!="undefined"&&v instanceof HTMLImageElement||typeof HTMLVideoElement!="undefined"&&v instanceof HTMLVideoElement||typeof ImageData!="undefined"&&v instanceof ImageData}var s=function(v,_){m.muls(v,_,255)};function o(v,_,x){var T=v.gl,A=T.getParameter(T.MAX_TEXTURE_SIZE);if(_<0||_>A||x<0||x>A)throw new Error("gl-texture2d: Invalid texture size");return v._shape=[_,x],v.bind(),T.texImage2D(T.TEXTURE_2D,0,v.format,_,x,0,v.format,v.type,null),v._mipLevels=[0],v}function a(v,_,x,T,A,S){this.gl=v,this.handle=_,this.format=A,this.type=S,this._shape=[x,T],this._mipLevels=[0],this._magFilter=v.NEAREST,this._minFilter=v.NEAREST,this._wrapS=v.CLAMP_TO_EDGE,this._wrapT=v.CLAMP_TO_EDGE,this._anisoSamples=1;var w=this,L=[this._wrapS,this._wrapT];Object.defineProperties(L,[{get:function(){return w._wrapS},set:function(C){return w.wrapS=C}},{get:function(){return w._wrapT},set:function(C){return w.wrapT=C}}]),this._wrapVector=L;var k=[this._shape[0],this._shape[1]];Object.defineProperties(k,[{get:function(){return w._shape[0]},set:function(C){return w.width=C}},{get:function(){return w._shape[1]},set:function(C){return w.height=C}}]),this._shapeVector=k}var c=a.prototype;function r(v,_){return v.length===3?_[2]===1&&_[1]===v[0]*v[2]&&_[0]===v[2]:_[0]===1&&_[1]===v[0]}function n(v){var _=v.createTexture();return v.bindTexture(v.TEXTURE_2D,_),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,v.NEAREST),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,v.NEAREST),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,v.CLAMP_TO_EDGE),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,v.CLAMP_TO_EDGE),_}function d(v,_,x,T,A){var S=v.getParameter(v.MAX_TEXTURE_SIZE);if(_<0||_>S||x<0||x>S)throw new Error("gl-texture2d: Invalid texture shape");if(A===v.FLOAT&&!v.getExtension("OES_texture_float"))throw new Error("gl-texture2d: Floating point textures not supported on this platform");var w=n(v);return v.texImage2D(v.TEXTURE_2D,0,T,_,x,0,T,A,null),new a(v,w,_,x,T,A)}function l(v,_,x,T,A,S){var w=n(v);return v.texImage2D(v.TEXTURE_2D,0,A,A,S,_),new a(v,w,x,T,A,S)}function y(v,_){var x=_.dtype,T=_.shape.slice(),A=v.getParameter(v.MAX_TEXTURE_SIZE);if(T[0]<0||T[0]>A||T[1]<0||T[1]>A)throw new Error("gl-texture2d: Invalid texture size");var S=r(T,_.stride.slice()),w=0;x==="float32"?w=v.FLOAT:x==="float64"?(w=v.FLOAT,S=!1,x="float32"):x==="uint8"?w=v.UNSIGNED_BYTE:(w=v.UNSIGNED_BYTE,S=!1,x="uint8");var L,k,C=0;if(T.length===2)C=v.LUMINANCE,T=[T[0],T[1],1],_=t(_.data,T,[_.stride[0],_.stride[1],1],_.offset);else{if(T.length!==3)throw new Error("gl-texture2d: Invalid shape for texture");if(T[2]===1)C=v.ALPHA;else if(T[2]===2)C=v.LUMINANCE_ALPHA;else if(T[2]===3)C=v.RGB;else{if(T[2]!==4)throw new Error("gl-texture2d: Invalid shape for pixel coords");C=v.RGBA}}w!==v.FLOAT||v.getExtension("OES_texture_float")||(w=v.UNSIGNED_BYTE,S=!1);var M=_.size;if(S)L=_.offset===0&&_.data.length===M?_.data:_.data.subarray(_.offset,_.offset+M);else{var P=[T[2],T[2]*T[0],1];k=g.malloc(M,x);var O=t(k,T,P,0);x!=="float32"&&x!=="float64"||w!==v.UNSIGNED_BYTE?m.assign(O,_):s(O,_),L=k.subarray(0,M)}var F=n(v);return v.texImage2D(v.TEXTURE_2D,0,C,T[0],T[1],0,C,w,L),S||g.free(k),new a(v,F,T[0],T[1],C,w)}Object.defineProperties(c,{minFilter:{get:function(){return this._minFilter},set:function(v){this.bind();var _=this.gl;if(this.type===_.FLOAT&&p.indexOf(v)>=0&&(_.getExtension("OES_texture_float_linear")||(v=_.NEAREST)),e.indexOf(v)<0)throw new Error("gl-texture2d: Unknown filter mode "+v);return _.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,v),this._minFilter=v}},magFilter:{get:function(){return this._magFilter},set:function(v){this.bind();var _=this.gl;if(this.type===_.FLOAT&&p.indexOf(v)>=0&&(_.getExtension("OES_texture_float_linear")||(v=_.NEAREST)),e.indexOf(v)<0)throw new Error("gl-texture2d: Unknown filter mode "+v);return _.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,v),this._magFilter=v}},mipSamples:{get:function(){return this._anisoSamples},set:function(v){var _=this._anisoSamples;if(this._anisoSamples=0|Math.max(v,1),_!==this._anisoSamples){var x=this.gl.getExtension("EXT_texture_filter_anisotropic");x&&this.gl.texParameterf(this.gl.TEXTURE_2D,x.TEXTURE_MAX_ANISOTROPY_EXT,this._anisoSamples)}return this._anisoSamples}},wrapS:{get:function(){return this._wrapS},set:function(v){if(this.bind(),f.indexOf(v)<0)throw new Error("gl-texture2d: Unknown wrap mode "+v);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,v),this._wrapS=v}},wrapT:{get:function(){return this._wrapT},set:function(v){if(this.bind(),f.indexOf(v)<0)throw new Error("gl-texture2d: Unknown wrap mode "+v);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,v),this._wrapT=v}},wrap:{get:function(){return this._wrapVector},set:function(v){if(Array.isArray(v)||(v=[v,v]),v.length!==2)throw new Error("gl-texture2d: Must specify wrap mode for rows and columns");for(var _=0;_<2;++_)if(f.indexOf(v[_])<0)throw new Error("gl-texture2d: Unknown wrap mode "+v);this._wrapS=v[0],this._wrapT=v[1];var x=this.gl;return this.bind(),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,this._wrapS),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,this._wrapT),v}},shape:{get:function(){return this._shapeVector},set:function(v){if(Array.isArray(v)){if(v.length!==2)throw new Error("gl-texture2d: Invalid texture shape")}else v=[0|v,0|v];return o(this,0|v[0],0|v[1]),[0|v[0],0|v[1]]}},width:{get:function(){return this._shape[0]},set:function(v){return o(this,v|=0,this._shape[1]),v}},height:{get:function(){return this._shape[1]},set:function(v){return v|=0,o(this,this._shape[0],v),v}}}),c.bind=function(v){var _=this.gl;return v!==void 0&&_.activeTexture(_.TEXTURE0+(0|v)),_.bindTexture(_.TEXTURE_2D,this.handle),v!==void 0?0|v:_.getParameter(_.ACTIVE_TEXTURE)-_.TEXTURE0},c.dispose=function(){this.gl.deleteTexture(this.handle)},c.generateMipmap=function(){this.bind(),this.gl.generateMipmap(this.gl.TEXTURE_2D);for(var v=Math.min(this._shape[0],this._shape[1]),_=0;v>0;++_,v>>>=1)this._mipLevels.indexOf(_)<0&&this._mipLevels.push(_)},c.setPixels=function(v,_,x,T){var A=this.gl;this.bind(),Array.isArray(_)?(T=x,x=0|_[1],_=0|_[0]):(_=_||0,x=x||0),T=T||0;var S=i(v)?v:v.raw;if(S)this._mipLevels.indexOf(T)<0?(A.texImage2D(A.TEXTURE_2D,0,this.format,this.format,this.type,S),this._mipLevels.push(T)):A.texSubImage2D(A.TEXTURE_2D,T,_,x,this.format,this.type,S);else{if(!(v.shape&&v.stride&&v.data))throw new Error("gl-texture2d: Unsupported data type");if(v.shape.length<2||_+v.shape[1]>this._shape[1]>>>T||x+v.shape[0]>this._shape[0]>>>T||_<0||x<0)throw new Error("gl-texture2d: Texture dimensions are out of bounds");(function(w,L,k,C,M,P,O,F){var j=F.dtype,W=F.shape.slice();if(W.length<2||W.length>3)throw new Error("gl-texture2d: Invalid ndarray, must be 2d or 3d");var Z=0,Q=0,X=r(W,F.stride.slice());if(j==="float32"?Z=w.FLOAT:j==="float64"?(Z=w.FLOAT,X=!1,j="float32"):j==="uint8"?Z=w.UNSIGNED_BYTE:(Z=w.UNSIGNED_BYTE,X=!1,j="uint8"),W.length===2)Q=w.LUMINANCE,W=[W[0],W[1],1],F=t(F.data,W,[F.stride[0],F.stride[1],1],F.offset);else{if(W.length!==3)throw new Error("gl-texture2d: Invalid shape for texture");if(W[2]===1)Q=w.ALPHA;else if(W[2]===2)Q=w.LUMINANCE_ALPHA;else if(W[2]===3)Q=w.RGB;else{if(W[2]!==4)throw new Error("gl-texture2d: Invalid shape for pixel coords");Q=w.RGBA}W[2]}if(Q!==w.LUMINANCE&&Q!==w.ALPHA||M!==w.LUMINANCE&&M!==w.ALPHA||(Q=M),Q!==M)throw new Error("gl-texture2d: Incompatible texture format for setPixels");var G=F.size,Y=O.indexOf(C)<0;if(Y&&O.push(C),Z===P&&X)F.offset===0&&F.data.length===G?Y?w.texImage2D(w.TEXTURE_2D,C,M,W[0],W[1],0,M,P,F.data):w.texSubImage2D(w.TEXTURE_2D,C,L,k,W[0],W[1],M,P,F.data):Y?w.texImage2D(w.TEXTURE_2D,C,M,W[0],W[1],0,M,P,F.data.subarray(F.offset,F.offset+G)):w.texSubImage2D(w.TEXTURE_2D,C,L,k,W[0],W[1],M,P,F.data.subarray(F.offset,F.offset+G));else{var K;K=P===w.FLOAT?g.mallocFloat32(G):g.mallocUint8(G);var D=t(K,W,[W[2],W[2]*W[0],1]);Z===w.FLOAT&&P===w.UNSIGNED_BYTE?s(D,F):m.assign(D,F),Y?w.texImage2D(w.TEXTURE_2D,C,M,W[0],W[1],0,M,P,K.subarray(0,G)):w.texSubImage2D(w.TEXTURE_2D,C,L,k,W[0],W[1],M,P,K.subarray(0,G)),P===w.FLOAT?g.freeFloat32(K):g.freeUint8(K)}})(A,_,x,T,this.format,this.type,this._mipLevels,v)}}},{ndarray:472,"ndarray-ops":467,"typedarray-pool":601}],349:[function(h,N,H){(function(t){(function(){var m=h("pick-by-alias");function g(f){if(f.container)if(f.container==document.body)document.body.style.width||(f.canvas.width=f.width||f.pixelRatio*t.innerWidth),document.body.style.height||(f.canvas.height=f.height||f.pixelRatio*t.innerHeight);else{var u=f.container.getBoundingClientRect();f.canvas.width=f.width||u.right-u.left,f.canvas.height=f.height||u.bottom-u.top}}function p(f){return typeof f.getContext=="function"&&"width"in f&&"height"in f}function e(){var f=document.createElement("canvas");return f.style.position="absolute",f.style.top=0,f.style.left=0,f}N.exports=function(f){var u;if(f?typeof f=="string"&&(f={container:f}):f={},p(f)?f={container:f}:f=typeof(u=f).nodeName=="string"&&typeof u.appendChild=="function"&&typeof u.getBoundingClientRect=="function"?{container:f}:function(s){return typeof s.drawArrays=="function"||typeof s.drawElements=="function"}(f)?{gl:f}:m(f,{container:"container target element el canvas holder parent parentNode wrapper use ref root node",gl:"gl context webgl glContext",attrs:"attributes attrs contextAttributes",pixelRatio:"pixelRatio pxRatio px ratio pxratio pixelratio",width:"w width",height:"h height"},!0),f.pixelRatio||(f.pixelRatio=t.pixelRatio||1),f.gl)return f.gl;if(f.canvas&&(f.container=f.canvas.parentNode),f.container){if(typeof f.container=="string"){var i=document.querySelector(f.container);if(!i)throw Error("Element "+f.container+" is not found");f.container=i}p(f.container)?(f.canvas=f.container,f.container=f.canvas.parentNode):f.canvas||(f.canvas=e(),f.container.appendChild(f.canvas),g(f))}else if(!f.canvas){if(typeof document=="undefined")throw Error("Not DOM environment. Use headless-gl.");f.container=document.body||document.documentElement,f.canvas=e(),f.container.appendChild(f.canvas),g(f)}return f.gl||["webgl","experimental-webgl","webgl-experimental"].some(function(s){try{f.gl=f.canvas.getContext(s,f.attrs)}catch(o){}return f.gl}),f.gl}}).call(this)}).call(this,typeof La!="undefined"?La:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"pick-by-alias":485}],350:[function(h,N,H){N.exports=function(t,m,g){m?m.bind():t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null);var p=0|t.getParameter(t.MAX_VERTEX_ATTRIBS);if(g){if(g.length>p)throw new Error("gl-vao: Too many vertex attributes");for(var e=0;e<g.length;++e){var f=g[e];if(f.buffer){var u=f.buffer,i=f.size||4,s=f.type||t.FLOAT,o=!!f.normalized,a=f.stride||0,c=f.offset||0;u.bind(),t.enableVertexAttribArray(e),t.vertexAttribPointer(e,i,s,o,a,c)}else{if(typeof f=="number")t.vertexAttrib1f(e,f);else if(f.length===1)t.vertexAttrib1f(e,f[0]);else if(f.length===2)t.vertexAttrib2f(e,f[0],f[1]);else if(f.length===3)t.vertexAttrib3f(e,f[0],f[1],f[2]);else{if(f.length!==4)throw new Error("gl-vao: Invalid vertex attribute");t.vertexAttrib4f(e,f[0],f[1],f[2],f[3])}t.disableVertexAttribArray(e)}}for(;e<p;++e)t.disableVertexAttribArray(e)}else for(t.bindBuffer(t.ARRAY_BUFFER,null),e=0;e<p;++e)t.disableVertexAttribArray(e)}},{}],351:[function(h,N,H){var t=h("./do-bind.js");function m(g){this.gl=g,this._elements=null,this._attributes=null,this._elementsType=g.UNSIGNED_SHORT}m.prototype.bind=function(){t(this.gl,this._elements,this._attributes)},m.prototype.update=function(g,p,e){this._elements=p,this._attributes=g,this._elementsType=e||this.gl.UNSIGNED_SHORT},m.prototype.dispose=function(){},m.prototype.unbind=function(){},m.prototype.draw=function(g,p,e){e=e||0;var f=this.gl;this._elements?f.drawElements(g,p,this._elementsType,e):f.drawArrays(g,e,p)},N.exports=function(g){return new m(g)}},{"./do-bind.js":350}],352:[function(h,N,H){var t=h("./do-bind.js");function m(p,e,f,u,i,s){this.location=p,this.dimension=e,this.a=f,this.b=u,this.c=i,this.d=s}function g(p,e,f){this.gl=p,this._ext=e,this.handle=f,this._attribs=[],this._useElements=!1,this._elementsType=p.UNSIGNED_SHORT}m.prototype.bind=function(p){switch(this.dimension){case 1:p.vertexAttrib1f(this.location,this.a);break;case 2:p.vertexAttrib2f(this.location,this.a,this.b);break;case 3:p.vertexAttrib3f(this.location,this.a,this.b,this.c);break;case 4:p.vertexAttrib4f(this.location,this.a,this.b,this.c,this.d)}},g.prototype.bind=function(){this._ext.bindVertexArrayOES(this.handle);for(var p=0;p<this._attribs.length;++p)this._attribs[p].bind(this.gl)},g.prototype.unbind=function(){this._ext.bindVertexArrayOES(null)},g.prototype.dispose=function(){this._ext.deleteVertexArrayOES(this.handle)},g.prototype.update=function(p,e,f){if(this.bind(),t(this.gl,e,p),this.unbind(),this._attribs.length=0,p)for(var u=0;u<p.length;++u){var i=p[u];typeof i=="number"?this._attribs.push(new m(u,1,i)):Array.isArray(i)&&this._attribs.push(new m(u,i.length,i[0],i[1],i[2],i[3]))}this._useElements=!!e,this._elementsType=f||this.gl.UNSIGNED_SHORT},g.prototype.draw=function(p,e,f){f=f||0;var u=this.gl;this._useElements?u.drawElements(p,e,this._elementsType,f):u.drawArrays(p,f,e)},N.exports=function(p,e){return new g(p,e,e.createVertexArrayOES())}},{"./do-bind.js":350}],353:[function(h,N,H){var t=h("./lib/vao-native.js"),m=h("./lib/vao-emulated.js");function g(p){this.bindVertexArrayOES=p.bindVertexArray.bind(p),this.createVertexArrayOES=p.createVertexArray.bind(p),this.deleteVertexArrayOES=p.deleteVertexArray.bind(p)}N.exports=function(p,e,f,u){var i,s=p.createVertexArray?new g(p):p.getExtension("OES_vertex_array_object");return(i=s?t(p,s):m(p)).update(e,f,u),i}},{"./lib/vao-emulated.js":351,"./lib/vao-native.js":352}],354:[function(h,N,H){N.exports=function(t,m,g){return t[0]=m[0]+g[0],t[1]=m[1]+g[1],t[2]=m[2]+g[2],t}},{}],355:[function(h,N,H){N.exports=function(p,e){var f=t(p[0],p[1],p[2]),u=t(e[0],e[1],e[2]);m(f,f),m(u,u);var i=g(f,u);return i>1?0:Math.acos(i)};var t=h("./fromValues"),m=h("./normalize"),g=h("./dot")},{"./dot":365,"./fromValues":371,"./normalize":382}],356:[function(h,N,H){N.exports=function(t,m){return t[0]=Math.ceil(m[0]),t[1]=Math.ceil(m[1]),t[2]=Math.ceil(m[2]),t}},{}],357:[function(h,N,H){N.exports=function(t){var m=new Float32Array(3);return m[0]=t[0],m[1]=t[1],m[2]=t[2],m}},{}],358:[function(h,N,H){N.exports=function(t,m){return t[0]=m[0],t[1]=m[1],t[2]=m[2],t}},{}],359:[function(h,N,H){N.exports=function(){var t=new Float32Array(3);return t[0]=0,t[1]=0,t[2]=0,t}},{}],360:[function(h,N,H){N.exports=function(t,m,g){var p=m[0],e=m[1],f=m[2],u=g[0],i=g[1],s=g[2];return t[0]=e*s-f*i,t[1]=f*u-p*s,t[2]=p*i-e*u,t}},{}],361:[function(h,N,H){N.exports=h("./distance")},{"./distance":362}],362:[function(h,N,H){N.exports=function(t,m){var g=m[0]-t[0],p=m[1]-t[1],e=m[2]-t[2];return Math.sqrt(g*g+p*p+e*e)}},{}],363:[function(h,N,H){N.exports=h("./divide")},{"./divide":364}],364:[function(h,N,H){N.exports=function(t,m,g){return t[0]=m[0]/g[0],t[1]=m[1]/g[1],t[2]=m[2]/g[2],t}},{}],365:[function(h,N,H){N.exports=function(t,m){return t[0]*m[0]+t[1]*m[1]+t[2]*m[2]}},{}],366:[function(h,N,H){N.exports=1e-6},{}],367:[function(h,N,H){N.exports=function(m,g){var p=m[0],e=m[1],f=m[2],u=g[0],i=g[1],s=g[2];return Math.abs(p-u)<=t*Math.max(1,Math.abs(p),Math.abs(u))&&Math.abs(e-i)<=t*Math.max(1,Math.abs(e),Math.abs(i))&&Math.abs(f-s)<=t*Math.max(1,Math.abs(f),Math.abs(s))};var t=h("./epsilon")},{"./epsilon":366}],368:[function(h,N,H){N.exports=function(t,m){return t[0]===m[0]&&t[1]===m[1]&&t[2]===m[2]}},{}],369:[function(h,N,H){N.exports=function(t,m){return t[0]=Math.floor(m[0]),t[1]=Math.floor(m[1]),t[2]=Math.floor(m[2]),t}},{}],370:[function(h,N,H){N.exports=function(m,g,p,e,f,u){var i,s;for(g||(g=3),p||(p=0),s=e?Math.min(e*g+p,m.length):m.length,i=p;i<s;i+=g)t[0]=m[i],t[1]=m[i+1],t[2]=m[i+2],f(t,t,u),m[i]=t[0],m[i+1]=t[1],m[i+2]=t[2];return m};var t=h("./create")()},{"./create":359}],371:[function(h,N,H){N.exports=function(t,m,g){var p=new Float32Array(3);return p[0]=t,p[1]=m,p[2]=g,p}},{}],372:[function(h,N,H){N.exports={EPSILON:h("./epsilon"),create:h("./create"),clone:h("./clone"),angle:h("./angle"),fromValues:h("./fromValues"),copy:h("./copy"),set:h("./set"),equals:h("./equals"),exactEquals:h("./exactEquals"),add:h("./add"),subtract:h("./subtract"),sub:h("./sub"),multiply:h("./multiply"),mul:h("./mul"),divide:h("./divide"),div:h("./div"),min:h("./min"),max:h("./max"),floor:h("./floor"),ceil:h("./ceil"),round:h("./round"),scale:h("./scale"),scaleAndAdd:h("./scaleAndAdd"),distance:h("./distance"),dist:h("./dist"),squaredDistance:h("./squaredDistance"),sqrDist:h("./sqrDist"),length:h("./length"),len:h("./len"),squaredLength:h("./squaredLength"),sqrLen:h("./sqrLen"),negate:h("./negate"),inverse:h("./inverse"),normalize:h("./normalize"),dot:h("./dot"),cross:h("./cross"),lerp:h("./lerp"),random:h("./random"),transformMat4:h("./transformMat4"),transformMat3:h("./transformMat3"),transformQuat:h("./transformQuat"),rotateX:h("./rotateX"),rotateY:h("./rotateY"),rotateZ:h("./rotateZ"),forEach:h("./forEach")}},{"./add":354,"./angle":355,"./ceil":356,"./clone":357,"./copy":358,"./create":359,"./cross":360,"./dist":361,"./distance":362,"./div":363,"./divide":364,"./dot":365,"./epsilon":366,"./equals":367,"./exactEquals":368,"./floor":369,"./forEach":370,"./fromValues":371,"./inverse":373,"./len":374,"./length":375,"./lerp":376,"./max":377,"./min":378,"./mul":379,"./multiply":380,"./negate":381,"./normalize":382,"./random":383,"./rotateX":384,"./rotateY":385,"./rotateZ":386,"./round":387,"./scale":388,"./scaleAndAdd":389,"./set":390,"./sqrDist":391,"./sqrLen":392,"./squaredDistance":393,"./squaredLength":394,"./sub":395,"./subtract":396,"./transformMat3":397,"./transformMat4":398,"./transformQuat":399}],373:[function(h,N,H){N.exports=function(t,m){return t[0]=1/m[0],t[1]=1/m[1],t[2]=1/m[2],t}},{}],374:[function(h,N,H){N.exports=h("./length")},{"./length":375}],375:[function(h,N,H){N.exports=function(t){var m=t[0],g=t[1],p=t[2];return Math.sqrt(m*m+g*g+p*p)}},{}],376:[function(h,N,H){N.exports=function(t,m,g,p){var e=m[0],f=m[1],u=m[2];return t[0]=e+p*(g[0]-e),t[1]=f+p*(g[1]-f),t[2]=u+p*(g[2]-u),t}},{}],377:[function(h,N,H){N.exports=function(t,m,g){return t[0]=Math.max(m[0],g[0]),t[1]=Math.max(m[1],g[1]),t[2]=Math.max(m[2],g[2]),t}},{}],378:[function(h,N,H){N.exports=function(t,m,g){return t[0]=Math.min(m[0],g[0]),t[1]=Math.min(m[1],g[1]),t[2]=Math.min(m[2],g[2]),t}},{}],379:[function(h,N,H){N.exports=h("./multiply")},{"./multiply":380}],380:[function(h,N,H){N.exports=function(t,m,g){return t[0]=m[0]*g[0],t[1]=m[1]*g[1],t[2]=m[2]*g[2],t}},{}],381:[function(h,N,H){N.exports=function(t,m){return t[0]=-m[0],t[1]=-m[1],t[2]=-m[2],t}},{}],382:[function(h,N,H){N.exports=function(t,m){var g=m[0],p=m[1],e=m[2],f=g*g+p*p+e*e;return f>0&&(f=1/Math.sqrt(f),t[0]=m[0]*f,t[1]=m[1]*f,t[2]=m[2]*f),t}},{}],383:[function(h,N,H){N.exports=function(t,m){m=m||1;var g=2*Math.random()*Math.PI,p=2*Math.random()-1,e=Math.sqrt(1-p*p)*m;return t[0]=Math.cos(g)*e,t[1]=Math.sin(g)*e,t[2]=p*m,t}},{}],384:[function(h,N,H){N.exports=function(t,m,g,p){var e=g[1],f=g[2],u=m[1]-e,i=m[2]-f,s=Math.sin(p),o=Math.cos(p);return t[0]=m[0],t[1]=e+u*o-i*s,t[2]=f+u*s+i*o,t}},{}],385:[function(h,N,H){N.exports=function(t,m,g,p){var e=g[0],f=g[2],u=m[0]-e,i=m[2]-f,s=Math.sin(p),o=Math.cos(p);return t[0]=e+i*s+u*o,t[1]=m[1],t[2]=f+i*o-u*s,t}},{}],386:[function(h,N,H){N.exports=function(t,m,g,p){var e=g[0],f=g[1],u=m[0]-e,i=m[1]-f,s=Math.sin(p),o=Math.cos(p);return t[0]=e+u*o-i*s,t[1]=f+u*s+i*o,t[2]=m[2],t}},{}],387:[function(h,N,H){N.exports=function(t,m){return t[0]=Math.round(m[0]),t[1]=Math.round(m[1]),t[2]=Math.round(m[2]),t}},{}],388:[function(h,N,H){N.exports=function(t,m,g){return t[0]=m[0]*g,t[1]=m[1]*g,t[2]=m[2]*g,t}},{}],389:[function(h,N,H){N.exports=function(t,m,g,p){return t[0]=m[0]+g[0]*p,t[1]=m[1]+g[1]*p,t[2]=m[2]+g[2]*p,t}},{}],390:[function(h,N,H){N.exports=function(t,m,g,p){return t[0]=m,t[1]=g,t[2]=p,t}},{}],391:[function(h,N,H){N.exports=h("./squaredDistance")},{"./squaredDistance":393}],392:[function(h,N,H){N.exports=h("./squaredLength")},{"./squaredLength":394}],393:[function(h,N,H){N.exports=function(t,m){var g=m[0]-t[0],p=m[1]-t[1],e=m[2]-t[2];return g*g+p*p+e*e}},{}],394:[function(h,N,H){N.exports=function(t){var m=t[0],g=t[1],p=t[2];return m*m+g*g+p*p}},{}],395:[function(h,N,H){N.exports=h("./subtract")},{"./subtract":396}],396:[function(h,N,H){N.exports=function(t,m,g){return t[0]=m[0]-g[0],t[1]=m[1]-g[1],t[2]=m[2]-g[2],t}},{}],397:[function(h,N,H){N.exports=function(t,m,g){var p=m[0],e=m[1],f=m[2];return t[0]=p*g[0]+e*g[3]+f*g[6],t[1]=p*g[1]+e*g[4]+f*g[7],t[2]=p*g[2]+e*g[5]+f*g[8],t}},{}],398:[function(h,N,H){N.exports=function(t,m,g){var p=m[0],e=m[1],f=m[2],u=g[3]*p+g[7]*e+g[11]*f+g[15];return u=u||1,t[0]=(g[0]*p+g[4]*e+g[8]*f+g[12])/u,t[1]=(g[1]*p+g[5]*e+g[9]*f+g[13])/u,t[2]=(g[2]*p+g[6]*e+g[10]*f+g[14])/u,t}},{}],399:[function(h,N,H){N.exports=function(t,m,g){var p=m[0],e=m[1],f=m[2],u=g[0],i=g[1],s=g[2],o=g[3],a=o*p+i*f-s*e,c=o*e+s*p-u*f,r=o*f+u*e-i*p,n=-u*p-i*e-s*f;return t[0]=a*o+n*-u+c*-s-r*-i,t[1]=c*o+n*-i+r*-u-a*-s,t[2]=r*o+n*-s+a*-i-c*-u,t}},{}],400:[function(h,N,H){N.exports=function(t,m,g){return t[0]=m[0]+g[0],t[1]=m[1]+g[1],t[2]=m[2]+g[2],t[3]=m[3]+g[3],t}},{}],401:[function(h,N,H){N.exports=function(t){var m=new Float32Array(4);return m[0]=t[0],m[1]=t[1],m[2]=t[2],m[3]=t[3],m}},{}],402:[function(h,N,H){N.exports=function(t,m){return t[0]=m[0],t[1]=m[1],t[2]=m[2],t[3]=m[3],t}},{}],403:[function(h,N,H){N.exports=function(){var t=new Float32Array(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}},{}],404:[function(h,N,H){N.exports=function(t,m){var g=m[0]-t[0],p=m[1]-t[1],e=m[2]-t[2],f=m[3]-t[3];return Math.sqrt(g*g+p*p+e*e+f*f)}},{}],405:[function(h,N,H){N.exports=function(t,m,g){return t[0]=m[0]/g[0],t[1]=m[1]/g[1],t[2]=m[2]/g[2],t[3]=m[3]/g[3],t}},{}],406:[function(h,N,H){N.exports=function(t,m){return t[0]*m[0]+t[1]*m[1]+t[2]*m[2]+t[3]*m[3]}},{}],407:[function(h,N,H){N.exports=function(t,m,g,p){var e=new Float32Array(4);return e[0]=t,e[1]=m,e[2]=g,e[3]=p,e}},{}],408:[function(h,N,H){N.exports={create:h("./create"),clone:h("./clone"),fromValues:h("./fromValues"),copy:h("./copy"),set:h("./set"),add:h("./add"),subtract:h("./subtract"),multiply:h("./multiply"),divide:h("./divide"),min:h("./min"),max:h("./max"),scale:h("./scale"),scaleAndAdd:h("./scaleAndAdd"),distance:h("./distance"),squaredDistance:h("./squaredDistance"),length:h("./length"),squaredLength:h("./squaredLength"),negate:h("./negate"),inverse:h("./inverse"),normalize:h("./normalize"),dot:h("./dot"),lerp:h("./lerp"),random:h("./random"),transformMat4:h("./transformMat4"),transformQuat:h("./transformQuat")}},{"./add":400,"./clone":401,"./copy":402,"./create":403,"./distance":404,"./divide":405,"./dot":406,"./fromValues":407,"./inverse":409,"./length":410,"./lerp":411,"./max":412,"./min":413,"./multiply":414,"./negate":415,"./normalize":416,"./random":417,"./scale":418,"./scaleAndAdd":419,"./set":420,"./squaredDistance":421,"./squaredLength":422,"./subtract":423,"./transformMat4":424,"./transformQuat":425}],409:[function(h,N,H){N.exports=function(t,m){return t[0]=1/m[0],t[1]=1/m[1],t[2]=1/m[2],t[3]=1/m[3],t}},{}],410:[function(h,N,H){N.exports=function(t){var m=t[0],g=t[1],p=t[2],e=t[3];return Math.sqrt(m*m+g*g+p*p+e*e)}},{}],411:[function(h,N,H){N.exports=function(t,m,g,p){var e=m[0],f=m[1],u=m[2],i=m[3];return t[0]=e+p*(g[0]-e),t[1]=f+p*(g[1]-f),t[2]=u+p*(g[2]-u),t[3]=i+p*(g[3]-i),t}},{}],412:[function(h,N,H){N.exports=function(t,m,g){return t[0]=Math.max(m[0],g[0]),t[1]=Math.max(m[1],g[1]),t[2]=Math.max(m[2],g[2]),t[3]=Math.max(m[3],g[3]),t}},{}],413:[function(h,N,H){N.exports=function(t,m,g){return t[0]=Math.min(m[0],g[0]),t[1]=Math.min(m[1],g[1]),t[2]=Math.min(m[2],g[2]),t[3]=Math.min(m[3],g[3]),t}},{}],414:[function(h,N,H){N.exports=function(t,m,g){return t[0]=m[0]*g[0],t[1]=m[1]*g[1],t[2]=m[2]*g[2],t[3]=m[3]*g[3],t}},{}],415:[function(h,N,H){N.exports=function(t,m){return t[0]=-m[0],t[1]=-m[1],t[2]=-m[2],t[3]=-m[3],t}},{}],416:[function(h,N,H){N.exports=function(t,m){var g=m[0],p=m[1],e=m[2],f=m[3],u=g*g+p*p+e*e+f*f;return u>0&&(u=1/Math.sqrt(u),t[0]=g*u,t[1]=p*u,t[2]=e*u,t[3]=f*u),t}},{}],417:[function(h,N,H){var t=h("./normalize"),m=h("./scale");N.exports=function(g,p){return p=p||1,g[0]=Math.random(),g[1]=Math.random(),g[2]=Math.random(),g[3]=Math.random(),t(g,g),m(g,g,p),g}},{"./normalize":416,"./scale":418}],418:[function(h,N,H){N.exports=function(t,m,g){return t[0]=m[0]*g,t[1]=m[1]*g,t[2]=m[2]*g,t[3]=m[3]*g,t}},{}],419:[function(h,N,H){N.exports=function(t,m,g,p){return t[0]=m[0]+g[0]*p,t[1]=m[1]+g[1]*p,t[2]=m[2]+g[2]*p,t[3]=m[3]+g[3]*p,t}},{}],420:[function(h,N,H){N.exports=function(t,m,g,p,e){return t[0]=m,t[1]=g,t[2]=p,t[3]=e,t}},{}],421:[function(h,N,H){N.exports=function(t,m){var g=m[0]-t[0],p=m[1]-t[1],e=m[2]-t[2],f=m[3]-t[3];return g*g+p*p+e*e+f*f}},{}],422:[function(h,N,H){N.exports=function(t){var m=t[0],g=t[1],p=t[2],e=t[3];return m*m+g*g+p*p+e*e}},{}],423:[function(h,N,H){N.exports=function(t,m,g){return t[0]=m[0]-g[0],t[1]=m[1]-g[1],t[2]=m[2]-g[2],t[3]=m[3]-g[3],t}},{}],424:[function(h,N,H){N.exports=function(t,m,g){var p=m[0],e=m[1],f=m[2],u=m[3];return t[0]=g[0]*p+g[4]*e+g[8]*f+g[12]*u,t[1]=g[1]*p+g[5]*e+g[9]*f+g[13]*u,t[2]=g[2]*p+g[6]*e+g[10]*f+g[14]*u,t[3]=g[3]*p+g[7]*e+g[11]*f+g[15]*u,t}},{}],425:[function(h,N,H){N.exports=function(t,m,g){var p=m[0],e=m[1],f=m[2],u=g[0],i=g[1],s=g[2],o=g[3],a=o*p+i*f-s*e,c=o*e+s*p-u*f,r=o*f+u*e-i*p,n=-u*p-i*e-s*f;return t[0]=a*o+n*-u+c*-s-r*-i,t[1]=c*o+n*-i+r*-u-a*-s,t[2]=r*o+n*-s+a*-i-c*-u,t[3]=m[3],t}},{}],426:[function(h,N,H){var t=h("glsl-tokenizer"),m=h("atob-lite");N.exports=function(g){for(var p=Array.isArray(g)?g:t(g),e=0;e<p.length;e++){var f=p[e];if(f.type==="preprocessor"){var u=f.data.match(/\#define\s+SHADER_NAME(_B64)?\s+(.+)$/);if(u&&u[2]){var i=u[1],s=u[2];return(i?m(s):s).trim()}}}}},{"atob-lite":84,"glsl-tokenizer":433}],427:[function(h,N,H){N.exports=function(u){var i,s,o,a=0,c=0,r=999,n=[],d=[],l=1,y=0,v=0,_=!1,x=!1,T="",A=g,S=t;(u=u||{}).version==="300 es"&&(A=e,S=p);var w={},L={};for(a=0;a<A.length;a++)w[A[a]]=!0;for(a=0;a<S.length;a++)L[S[a]]=!0;return function(G){return d=[],G!==null?function(Y){a=0,Y.toString&&(Y=Y.toString());var K;for(T+=Y.replace(/\r\n/g,`
`),o=T.length;i=T[a],a<o;){switch(K=a,r){case 0:a=O();break;case 1:case 2:a=P();break;case 3:a=F();break;case 4:a=Z();break;case 11:a=W();break;case 5:a=Q();break;case 9999:a=X();break;case 9:a=M();break;case 999:a=C()}if(K!==a)switch(T[K]){case`
`:y=0,++l;break;default:++y}}return c+=a,T=T.slice(a),d}(G):function(Y){return n.length&&k(n.join("")),r=10,k("(eof)"),d}()};function k(G){G.length&&d.push({type:f[r],data:G,position:v,line:l,column:y})}function C(){return n=n.length?[]:n,s==="/"&&i==="*"?(v=c+a-1,r=0,s=i,a+1):s==="/"&&i==="/"?(v=c+a-1,r=1,s=i,a+1):i==="#"?(r=2,v=c+a,a):/\s/.test(i)?(r=9,v=c+a,a):(_=/\d/.test(i),x=/[^\w_]/.test(i),v=c+a,r=_?4:x?3:9999,a)}function M(){return/[^\s]/g.test(i)?(k(n.join("")),r=999,a):(n.push(i),s=i,a+1)}function P(){return i!=="\r"&&i!==`
`||s==="\\"?(n.push(i),s=i,a+1):(k(n.join("")),r=999,a)}function O(){return i==="/"&&s==="*"?(n.push(i),k(n.join("")),r=999,a+1):(n.push(i),s=i,a+1)}function F(){if(s==="."&&/\d/.test(i))return r=5,a;if(s==="/"&&i==="*")return r=0,a;if(s==="/"&&i==="/")return r=1,a;if(i==="."&&n.length){for(;j(n););return r=5,a}if(i===";"||i===")"||i==="("){if(n.length)for(;j(n););return k(i),r=999,a+1}var G=n.length===2&&i!=="=";if(/[\w_\d\s]/.test(i)||G){for(;j(n););return r=999,a}return n.push(i),s=i,a+1}function j(G){for(var Y,K,D=0;;){if(Y=m.indexOf(G.slice(0,G.length+D).join("")),K=m[Y],Y===-1){if(D--+G.length>0)continue;K=G.slice(0,1).join("")}return k(K),v+=K.length,(n=n.slice(K.length)).length}}function W(){return/[^a-fA-F0-9]/.test(i)?(k(n.join("")),r=999,a):(n.push(i),s=i,a+1)}function Z(){return i==="."||/[eE]/.test(i)?(n.push(i),r=5,s=i,a+1):i==="x"&&n.length===1&&n[0]==="0"?(r=11,n.push(i),s=i,a+1):/[^\d]/.test(i)?(k(n.join("")),r=999,a):(n.push(i),s=i,a+1)}function Q(){return i==="f"&&(n.push(i),s=i,a+=1),/[eE]/.test(i)?(n.push(i),s=i,a+1):(i!=="-"&&i!=="+"||!/[eE]/.test(s))&&/[^\d]/.test(i)?(k(n.join("")),r=999,a):(n.push(i),s=i,a+1)}function X(){if(/[^\d\w_]/.test(i)){var G=n.join("");return r=L[G]?8:w[G]?7:6,k(n.join("")),r=999,a}return n.push(i),s=i,a+1}};var t=h("./lib/literals"),m=h("./lib/operators"),g=h("./lib/builtins"),p=h("./lib/literals-300es"),e=h("./lib/builtins-300es"),f=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"]},{"./lib/builtins":429,"./lib/builtins-300es":428,"./lib/literals":431,"./lib/literals-300es":430,"./lib/operators":432}],428:[function(h,N,H){var t=h("./builtins");t=t.slice().filter(function(m){return!/^(gl\_|texture)/.test(m)}),N.exports=t.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])},{"./builtins":429}],429:[function(h,N,H){N.exports=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]},{}],430:[function(h,N,H){var t=h("./literals");N.exports=t.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])},{"./literals":431}],431:[function(h,N,H){N.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","uint","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},{}],432:[function(h,N,H){N.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},{}],433:[function(h,N,H){var t=h("./index");N.exports=function(m,g){var p=t(g),e=[];return e=(e=e.concat(p(m))).concat(p(null))}},{"./index":427}],434:[function(h,N,H){arguments[4][268][0].apply(H,arguments)},{dup:268}],435:[function(h,N,H){(function(t){(function(){var m,g=h("is-browser");m=typeof t.matchMedia=="function"?!t.matchMedia("(hover: none)").matches:g,N.exports=m}).call(this)}).call(this,typeof La!="undefined"?La:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"is-browser":442}],436:[function(h,N,H){var t=h("is-browser");N.exports=t&&function(){var m=!1;try{var g=Object.defineProperty({},"passive",{get:function(){m=!0}});window.addEventListener("test",null,g),window.removeEventListener("test",null,g)}catch(p){m=!1}return m}()},{"is-browser":442}],437:[function(h,N,H){H.read=function(t,m,g,p,e){var f,u,i=8*e-p-1,s=(1<<i)-1,o=s>>1,a=-7,c=g?e-1:0,r=g?-1:1,n=t[m+c];for(c+=r,f=n&(1<<-a)-1,n>>=-a,a+=i;a>0;f=256*f+t[m+c],c+=r,a-=8);for(u=f&(1<<-a)-1,f>>=-a,a+=p;a>0;u=256*u+t[m+c],c+=r,a-=8);if(f===0)f=1-o;else{if(f===s)return u?NaN:1/0*(n?-1:1);u+=Math.pow(2,p),f-=o}return(n?-1:1)*u*Math.pow(2,f-p)},H.write=function(t,m,g,p,e,f){var u,i,s,o=8*f-e-1,a=(1<<o)-1,c=a>>1,r=e===23?Math.pow(2,-24)-Math.pow(2,-77):0,n=p?0:f-1,d=p?1:-1,l=m<0||m===0&&1/m<0?1:0;for(m=Math.abs(m),isNaN(m)||m===1/0?(i=isNaN(m)?1:0,u=a):(u=Math.floor(Math.log(m)/Math.LN2),m*(s=Math.pow(2,-u))<1&&(u--,s*=2),(m+=u+c>=1?r/s:r*Math.pow(2,1-c))*s>=2&&(u++,s/=2),u+c>=a?(i=0,u=a):u+c>=1?(i=(m*s-1)*Math.pow(2,e),u+=c):(i=m*Math.pow(2,c-1)*Math.pow(2,e),u=0));e>=8;t[g+n]=255&i,n+=d,i/=256,e-=8);for(u=u<<e|i,o+=e;o>0;t[g+n]=255&u,n+=d,u/=256,o-=8);t[g+n-d]|=128*l}},{}],438:[function(h,N,H){N.exports=function(s,o){var a=s.length;if(a===0)throw new Error("Must have at least d+1 points");var c=s[0].length;if(a<=c)throw new Error("Must input at least d+1 points");var r=s.slice(0,c+1),n=t.apply(void 0,r);if(n===0)throw new Error("Input not in general position");for(var d=new Array(c+1),l=0;l<=c;++l)d[l]=l;n<0&&(d[0]=1,d[1]=0);var y=new g(d,new Array(c+1),!1),v=y.adjacent,_=new Array(c+2);for(l=0;l<=c;++l){for(var x=d.slice(),T=0;T<=c;++T)T===l&&(x[T]=-1);var A=x[0];x[0]=x[1],x[1]=A;var S=new g(x,new Array(c+1),!0);v[l]=S,_[l]=S}for(_[c+1]=y,l=0;l<=c;++l){x=v[l].vertices;var w=v[l].adjacent;for(T=0;T<=c;++T){var L=x[T];if(L<0)w[T]=y;else for(var k=0;k<=c;++k)v[k].vertices.indexOf(L)<0&&(w[T]=v[k])}}var C=new u(c,r,_),M=!!o;for(l=c+1;l<a;++l)C.insert(s[l],M);return C.boundary()};var t=h("robust-orientation"),m=h("simplicial-complex").compareCells;function g(s,o,a){this.vertices=s,this.adjacent=o,this.boundary=a,this.lastVisited=-1}function p(s,o,a){this.vertices=s,this.cell=o,this.index=a}function e(s,o){return m(s.vertices,o.vertices)}g.prototype.flip=function(){var s=this.vertices[0];this.vertices[0]=this.vertices[1],this.vertices[1]=s;var o=this.adjacent[0];this.adjacent[0]=this.adjacent[1],this.adjacent[1]=o};var f=[];function u(s,o,a){this.dimension=s,this.vertices=o,this.simplices=a,this.interior=a.filter(function(d){return!d.boundary}),this.tuple=new Array(s+1);for(var c=0;c<=s;++c)this.tuple[c]=this.vertices[c];var r,n=f[s];n||(n=f[s]=((r=t[s+1])||(r=t),function(d){return function(){var l=this.tuple;return d.apply(this,l)}}(r))),this.orient=n}var i=u.prototype;i.handleBoundaryDegeneracy=function(s,o){var a=this.dimension,c=this.vertices.length-1,r=this.tuple,n=this.vertices,d=[s];for(s.lastVisited=-c;d.length>0;)for(var l=(s=d.pop()).adjacent,y=0;y<=a;++y){var v=l[y];if(v.boundary&&!(v.lastVisited<=-c)){for(var _=v.vertices,x=0;x<=a;++x){var T=_[x];r[x]=T<0?o:n[T]}var A=this.orient();if(A>0)return v;v.lastVisited=-c,A===0&&d.push(v)}}return null},i.walk=function(s,o){var a=this.vertices.length-1,c=this.dimension,r=this.vertices,n=this.tuple,d=o?this.interior.length*Math.random()|0:this.interior.length-1,l=this.interior[d];e:for(;!l.boundary;){for(var y=l.vertices,v=l.adjacent,_=0;_<=c;++_)n[_]=r[y[_]];for(l.lastVisited=a,_=0;_<=c;++_){var x=v[_];if(!(x.lastVisited>=a)){var T=n[_];n[_]=s;var A=this.orient();if(n[_]=T,A<0){l=x;continue e}x.boundary?x.lastVisited=-a:x.lastVisited=a}}return}return l},i.addPeaks=function(s,o){var a=this.vertices.length-1,c=this.dimension,r=this.vertices,n=this.tuple,d=this.interior,l=this.simplices,y=[o];o.lastVisited=a,o.vertices[o.vertices.indexOf(-1)]=a,o.boundary=!1,d.push(o);for(var v=[];y.length>0;){var _=(o=y.pop()).vertices,x=o.adjacent,T=_.indexOf(a);if(!(T<0)){for(var A=0;A<=c;++A)if(A!==T){var S=x[A];if(S.boundary&&!(S.lastVisited>=a)){var w=S.vertices;if(S.lastVisited!==-a){for(var L=0,k=0;k<=c;++k)w[k]<0?(L=k,n[k]=s):n[k]=r[w[k]];if(this.orient()>0){w[L]=a,S.boundary=!1,d.push(S),y.push(S),S.lastVisited=a;continue}S.lastVisited=-a}var C=S.adjacent,M=_.slice(),P=x.slice(),O=new g(M,P,!0);l.push(O);var F=C.indexOf(o);if(!(F<0))for(C[F]=O,P[T]=S,M[A]=-1,P[A]=o,x[A]=O,O.flip(),k=0;k<=c;++k){var j=M[k];if(!(j<0||j===a)){for(var W=new Array(c-1),Z=0,Q=0;Q<=c;++Q){var X=M[Q];X<0||Q===k||(W[Z++]=X)}v.push(new p(W,O,k))}}}}}}for(v.sort(e),A=0;A+1<v.length;A+=2){var G=v[A],Y=v[A+1],K=G.index,D=Y.index;K<0||D<0||(G.cell.adjacent[G.index]=Y.cell,Y.cell.adjacent[Y.index]=G.cell)}},i.insert=function(s,o){var a=this.vertices;a.push(s);var c=this.walk(s,o);if(c){for(var r=this.dimension,n=this.tuple,d=0;d<=r;++d){var l=c.vertices[d];n[d]=l<0?s:a[l]}var y=this.orient(n);y<0||(y!==0||(c=this.handleBoundaryDegeneracy(c,s)))&&this.addPeaks(s,c)}},i.boundary=function(){for(var s=this.dimension,o=[],a=this.simplices,c=a.length,r=0;r<c;++r){var n=a[r];if(n.boundary){for(var d=new Array(s),l=n.vertices,y=0,v=0,_=0;_<=s;++_)l[_]>=0?d[y++]=l[_]:v=1&_;if(v===(1&s)){var x=d[0];d[0]=d[1],d[1]=x}o.push(d)}}return o}},{"robust-orientation":534,"simplicial-complex":545}],439:[function(h,N,H){typeof Object.create=="function"?N.exports=function(t,m){m&&(t.super_=m,t.prototype=Object.create(m.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:N.exports=function(t,m){if(m){t.super_=m;var g=function(){};g.prototype=m.prototype,t.prototype=new g,t.prototype.constructor=t}}},{}],440:[function(h,N,H){var t=h("binary-search-bounds");function m(y,v,_,x,T){this.mid=y,this.left=v,this.right=_,this.leftPoints=x,this.rightPoints=T,this.count=(v?v.count:0)+(_?_.count:0)+x.length}N.exports=function(y){return!y||y.length===0?new d(null):new d(n(y))};var g=m.prototype;function p(y,v){y.mid=v.mid,y.left=v.left,y.right=v.right,y.leftPoints=v.leftPoints,y.rightPoints=v.rightPoints,y.count=v.count}function e(y,v){var _=n(v);y.mid=_.mid,y.left=_.left,y.right=_.right,y.leftPoints=_.leftPoints,y.rightPoints=_.rightPoints,y.count=_.count}function f(y,v){var _=y.intervals([]);_.push(v),e(y,_)}function u(y,v){var _=y.intervals([]),x=_.indexOf(v);return x<0?0:(_.splice(x,1),e(y,_),1)}function i(y,v,_){for(var x=0;x<y.length&&y[x][0]<=v;++x){var T=_(y[x]);if(T)return T}}function s(y,v,_){for(var x=y.length-1;x>=0&&y[x][1]>=v;--x){var T=_(y[x]);if(T)return T}}function o(y,v){for(var _=0;_<y.length;++_){var x=v(y[_]);if(x)return x}}function a(y,v){return y-v}function c(y,v){var _=y[0]-v[0];return _||y[1]-v[1]}function r(y,v){var _=y[1]-v[1];return _||y[0]-v[0]}function n(y){if(y.length===0)return null;for(var v=[],_=0;_<y.length;++_)v.push(y[_][0],y[_][1]);v.sort(a);var x=v[v.length>>1],T=[],A=[],S=[];for(_=0;_<y.length;++_){var w=y[_];w[1]<x?T.push(w):x<w[0]?A.push(w):S.push(w)}var L=S,k=S.slice();return L.sort(c),k.sort(r),new m(x,n(T),n(A),L,k)}function d(y){this.root=y}g.intervals=function(y){return y.push.apply(y,this.leftPoints),this.left&&this.left.intervals(y),this.right&&this.right.intervals(y),y},g.insert=function(y){var v=this.count-this.leftPoints.length;if(this.count+=1,y[1]<this.mid)this.left?4*(this.left.count+1)>3*(v+1)?f(this,y):this.left.insert(y):this.left=n([y]);else if(y[0]>this.mid)this.right?4*(this.right.count+1)>3*(v+1)?f(this,y):this.right.insert(y):this.right=n([y]);else{var _=t.ge(this.leftPoints,y,c),x=t.ge(this.rightPoints,y,r);this.leftPoints.splice(_,0,y),this.rightPoints.splice(x,0,y)}},g.remove=function(y){var v=this.count-this.leftPoints;if(y[1]<this.mid)return this.left?4*(this.right?this.right.count:0)>3*(v-1)?u(this,y):(A=this.left.remove(y))===2?(this.left=null,this.count-=1,1):(A===1&&(this.count-=1),A):0;if(y[0]>this.mid)return this.right?4*(this.left?this.left.count:0)>3*(v-1)?u(this,y):(A=this.right.remove(y))===2?(this.right=null,this.count-=1,1):(A===1&&(this.count-=1),A):0;if(this.count===1)return this.leftPoints[0]===y?2:0;if(this.leftPoints.length===1&&this.leftPoints[0]===y){if(this.left&&this.right){for(var _=this,x=this.left;x.right;)_=x,x=x.right;if(_===this)x.right=this.right;else{var T=this.left,A=this.right;_.count-=x.count,_.right=x.left,x.left=T,x.right=A}p(this,x),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?p(this,this.left):p(this,this.right);return 1}for(T=t.ge(this.leftPoints,y,c);T<this.leftPoints.length&&this.leftPoints[T][0]===y[0];++T)if(this.leftPoints[T]===y){for(this.count-=1,this.leftPoints.splice(T,1),A=t.ge(this.rightPoints,y,r);A<this.rightPoints.length&&this.rightPoints[A][1]===y[1];++A)if(this.rightPoints[A]===y)return this.rightPoints.splice(A,1),1}return 0},g.queryPoint=function(y,v){if(y<this.mid)return this.left&&(_=this.left.queryPoint(y,v))?_:i(this.leftPoints,y,v);if(y>this.mid){var _;return this.right&&(_=this.right.queryPoint(y,v))?_:s(this.rightPoints,y,v)}return o(this.leftPoints,v)},g.queryInterval=function(y,v,_){var x;return y<this.mid&&this.left&&(x=this.left.queryInterval(y,v,_))||v>this.mid&&this.right&&(x=this.right.queryInterval(y,v,_))?x:v<this.mid?i(this.leftPoints,v,_):y>this.mid?s(this.rightPoints,y,_):o(this.leftPoints,_)};var l=d.prototype;l.insert=function(y){this.root?this.root.insert(y):this.root=new m(y[0],null,null,[y],[y])},l.remove=function(y){if(this.root){var v=this.root.remove(y);return v===2&&(this.root=null),v!==0}return!1},l.queryPoint=function(y,v){if(this.root)return this.root.queryPoint(y,v)},l.queryInterval=function(y,v,_){if(y<=v&&this.root)return this.root.queryInterval(y,v,_)},Object.defineProperty(l,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(l,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}})},{"binary-search-bounds":103}],441:[function(h,N,H){N.exports=function(t){for(var m=new Array(t),g=0;g<t;++g)m[g]=g;return m}},{}],442:[function(h,N,H){N.exports=!0},{}],443:[function(h,N,H){function t(m){return!!m.constructor&&typeof m.constructor.isBuffer=="function"&&m.constructor.isBuffer(m)}/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */N.exports=function(m){return m!=null&&(t(m)||function(g){return typeof g.readFloatLE=="function"&&typeof g.slice=="function"&&t(g.slice(0,0))}(m)||!!m._isBuffer)}},{}],444:[function(h,N,H){N.exports=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion))},{}],445:[function(h,N,H){N.exports=g,N.exports.isMobile=g,N.exports.default=g;var t=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,m=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i;function g(p){p||(p={});var e=p.ua;if(e||typeof navigator=="undefined"||(e=navigator.userAgent),e&&e.headers&&typeof e.headers["user-agent"]=="string"&&(e=e.headers["user-agent"]),typeof e!="string")return!1;var f=p.tablet?m.test(e):t.test(e);return!f&&p.tablet&&p.featureDetect&&navigator&&navigator.maxTouchPoints>1&&e.indexOf("Macintosh")!==-1&&e.indexOf("Safari")!==-1&&(f=!0),f}},{}],446:[function(h,N,H){N.exports=function(t){var m=typeof t;return t!==null&&(m==="object"||m==="function")}},{}],447:[function(h,N,H){var t=Object.prototype.toString;N.exports=function(m){var g;return t.call(m)==="[object Object]"&&((g=Object.getPrototypeOf(m))===null||g===Object.getPrototypeOf({}))}},{}],448:[function(h,N,H){N.exports=function(t){for(var m,g=t.length,p=0;p<g;p++)if(((m=t.charCodeAt(p))<9||m>13)&&m!==32&&m!==133&&m!==160&&m!==5760&&m!==6158&&(m<8192||m>8205)&&m!==8232&&m!==8233&&m!==8239&&m!==8287&&m!==8288&&m!==12288&&m!==65279)return!1;return!0}},{}],449:[function(h,N,H){N.exports=function(t){return typeof t=="string"&&(t=t.trim(),!!(/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(t)&&/[\dz]$/i.test(t)&&t.length>4))}},{}],450:[function(h,N,H){N.exports=function(t,m,g){return t*(1-g)+m*g}},{}],451:[function(h,N,H){(function(t,m){typeof H=="object"&&N!==void 0?N.exports=m():(t=t||self).mapboxgl=m()})(this,function(){var t,m,g;function p(e,f){if(t)if(m){var u="var sharedChunk = {}; ("+t+")(sharedChunk); ("+m+")(sharedChunk);",i={};t(i),(g=f(i)).workerUrl=window.URL.createObjectURL(new Blob([u],{type:"text/javascript"}))}else m=f;else t=f}return p(0,function(e){function f(b,I){return b(I={exports:{}},I.exports),I.exports}var u=i;function i(b,I,V,re){this.cx=3*b,this.bx=3*(V-b)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*I,this.by=3*(re-I)-this.cy,this.ay=1-this.cy-this.by,this.p1x=b,this.p1y=re,this.p2x=V,this.p2y=re}i.prototype.sampleCurveX=function(b){return((this.ax*b+this.bx)*b+this.cx)*b},i.prototype.sampleCurveY=function(b){return((this.ay*b+this.by)*b+this.cy)*b},i.prototype.sampleCurveDerivativeX=function(b){return(3*this.ax*b+2*this.bx)*b+this.cx},i.prototype.solveCurveX=function(b,I){var V,re,fe,ge,Ae;for(I===void 0&&(I=1e-6),fe=b,Ae=0;Ae<8;Ae++){if(ge=this.sampleCurveX(fe)-b,Math.abs(ge)<I)return fe;var ze=this.sampleCurveDerivativeX(fe);if(Math.abs(ze)<1e-6)break;fe-=ge/ze}if((fe=b)<(V=0))return V;if(fe>(re=1))return re;for(;V<re;){if(ge=this.sampleCurveX(fe),Math.abs(ge-b)<I)return fe;b>ge?V=fe:re=fe,fe=.5*(re-V)+V}return fe},i.prototype.solve=function(b,I){return this.sampleCurveY(this.solveCurveX(b,I))};var s=o;function o(b,I){this.x=b,this.y=I}function a(b,I,V,re){var fe=new u(b,I,V,re);return function(ge){return fe.solve(ge)}}o.prototype={clone:function(){return new o(this.x,this.y)},add:function(b){return this.clone()._add(b)},sub:function(b){return this.clone()._sub(b)},multByPoint:function(b){return this.clone()._multByPoint(b)},divByPoint:function(b){return this.clone()._divByPoint(b)},mult:function(b){return this.clone()._mult(b)},div:function(b){return this.clone()._div(b)},rotate:function(b){return this.clone()._rotate(b)},rotateAround:function(b,I){return this.clone()._rotateAround(b,I)},matMult:function(b){return this.clone()._matMult(b)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(b){return this.x===b.x&&this.y===b.y},dist:function(b){return Math.sqrt(this.distSqr(b))},distSqr:function(b){var I=b.x-this.x,V=b.y-this.y;return I*I+V*V},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(b){return Math.atan2(this.y-b.y,this.x-b.x)},angleWith:function(b){return this.angleWithSep(b.x,b.y)},angleWithSep:function(b,I){return Math.atan2(this.x*I-this.y*b,this.x*b+this.y*I)},_matMult:function(b){var I=b[0]*this.x+b[1]*this.y,V=b[2]*this.x+b[3]*this.y;return this.x=I,this.y=V,this},_add:function(b){return this.x+=b.x,this.y+=b.y,this},_sub:function(b){return this.x-=b.x,this.y-=b.y,this},_mult:function(b){return this.x*=b,this.y*=b,this},_div:function(b){return this.x/=b,this.y/=b,this},_multByPoint:function(b){return this.x*=b.x,this.y*=b.y,this},_divByPoint:function(b){return this.x/=b.x,this.y/=b.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var b=this.y;return this.y=this.x,this.x=-b,this},_rotate:function(b){var I=Math.cos(b),V=Math.sin(b),re=I*this.x-V*this.y,fe=V*this.x+I*this.y;return this.x=re,this.y=fe,this},_rotateAround:function(b,I){var V=Math.cos(b),re=Math.sin(b),fe=I.x+V*(this.x-I.x)-re*(this.y-I.y),ge=I.y+re*(this.x-I.x)+V*(this.y-I.y);return this.x=fe,this.y=ge,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},o.convert=function(b){return b instanceof o?b:Array.isArray(b)?new o(b[0],b[1]):b};var c=a(.25,.1,.25,1);function r(b,I,V){return Math.min(V,Math.max(I,b))}function n(b,I,V){var re=V-I,fe=((b-I)%re+re)%re+I;return fe===I?V:fe}function d(b){for(var I=[],V=arguments.length-1;V-- >0;)I[V]=arguments[V+1];for(var re=0,fe=I;re<fe.length;re+=1){var ge=fe[re];for(var Ae in ge)b[Ae]=ge[Ae]}return b}var l=1;function y(){return l++}function v(){return function b(I){return I?(I^16*Math.random()>>I/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,b)}()}function _(b){return!!b&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(b)}function x(b,I){b.forEach(function(V){I[V]&&(I[V]=I[V].bind(I))})}function T(b,I){return b.indexOf(I,b.length-I.length)!==-1}function A(b,I,V){var re={};for(var fe in b)re[fe]=I.call(V||this,b[fe],fe,b);return re}function S(b,I,V){var re={};for(var fe in b)I.call(V||this,b[fe],fe,b)&&(re[fe]=b[fe]);return re}function w(b){return Array.isArray(b)?b.map(w):typeof b=="object"&&b?A(b,w):b}var L={};function k(b){L[b]||(typeof console!="undefined"&&console.warn(b),L[b]=!0)}function C(b,I,V){return(V.y-b.y)*(I.x-b.x)>(I.y-b.y)*(V.x-b.x)}function M(b){for(var I=0,V=0,re=b.length,fe=re-1,ge=void 0,Ae=void 0;V<re;fe=V++)ge=b[V],I+=((Ae=b[fe]).x-ge.x)*(ge.y+Ae.y);return I}function P(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function O(b){var I={};if(b.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(re,fe,ge,Ae){var ze=ge||Ae;return I[fe]=!ze||ze.toLowerCase(),""}),I["max-age"]){var V=parseInt(I["max-age"],10);isNaN(V)?delete I["max-age"]:I["max-age"]=V}return I}var F=null;function j(b){if(F==null){var I=b.navigator?b.navigator.userAgent:null;F=!!b.safari||!(!I||!(/\b(iPad|iPhone|iPod)\b/.test(I)||I.match("Safari")&&!I.match("Chrome")))}return F}function W(b){try{var I=self[b];return I.setItem("_mapbox_test_",1),I.removeItem("_mapbox_test_"),!0}catch(V){return!1}}var Z,Q,X,G,Y=self.performance&&self.performance.now?self.performance.now.bind(self.performance):Date.now.bind(Date),K=self.requestAnimationFrame||self.mozRequestAnimationFrame||self.webkitRequestAnimationFrame||self.msRequestAnimationFrame,D=self.cancelAnimationFrame||self.mozCancelAnimationFrame||self.webkitCancelAnimationFrame||self.msCancelAnimationFrame,B={now:Y,frame:function(b){var I=K(b);return{cancel:function(){return D(I)}}},getImageData:function(b,I){I===void 0&&(I=0);var V=self.document.createElement("canvas"),re=V.getContext("2d");if(!re)throw new Error("failed to create canvas 2d context");return V.width=b.width,V.height=b.height,re.drawImage(b,0,0,b.width,b.height),re.getImageData(-I,-I,b.width+2*I,b.height+2*I)},resolveURL:function(b){return Z||(Z=self.document.createElement("a")),Z.href=b,Z.href},hardwareConcurrency:self.navigator.hardwareConcurrency||4,get devicePixelRatio(){return self.devicePixelRatio},get prefersReducedMotion(){return!!self.matchMedia&&(Q==null&&(Q=self.matchMedia("(prefers-reduced-motion: reduce)")),Q.matches)}},q={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},ee={supported:!1,testSupport:function(b){J||!G||($?te(b):X=b)}},J=!1,$=!1;function te(b){var I=b.createTexture();b.bindTexture(b.TEXTURE_2D,I);try{if(b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,G),b.isContextLost())return;ee.supported=!0}catch(V){}b.deleteTexture(I),J=!0}self.document&&((G=self.document.createElement("img")).onload=function(){X&&te(X),X=null,$=!0},G.onerror=function(){J=!0,X=null},G.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var ie="01",ae=function(b,I){this._transformRequestFn=b,this._customAccessToken=I,this._createSkuToken()};function he(b){return b.indexOf("mapbox:")===0}ae.prototype._createSkuToken=function(){var b=function(){for(var I="",V=0;V<10;V++)I+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ie,I].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=b.token,this._skuTokenExpiresAt=b.tokenExpiresAt},ae.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},ae.prototype.transformRequest=function(b,I){return this._transformRequestFn&&this._transformRequestFn(b,I)||{url:b}},ae.prototype.normalizeStyleURL=function(b,I){if(!he(b))return b;var V=ve(b);return V.path="/styles/v1"+V.path,this._makeAPIURL(V,this._customAccessToken||I)},ae.prototype.normalizeGlyphsURL=function(b,I){if(!he(b))return b;var V=ve(b);return V.path="/fonts/v1"+V.path,this._makeAPIURL(V,this._customAccessToken||I)},ae.prototype.normalizeSourceURL=function(b,I){if(!he(b))return b;var V=ve(b);return V.path="/v4/"+V.authority+".json",V.params.push("secure"),this._makeAPIURL(V,this._customAccessToken||I)},ae.prototype.normalizeSpriteURL=function(b,I,V,re){var fe=ve(b);return he(b)?(fe.path="/styles/v1"+fe.path+"/sprite"+I+V,this._makeAPIURL(fe,this._customAccessToken||re)):(fe.path+=""+I+V,ke(fe))},ae.prototype.normalizeTileURL=function(b,I){if(this._isSkuTokenExpired()&&this._createSkuToken(),b&&!he(b))return b;var V=ve(b),re=B.devicePixelRatio>=2||I===512?"@2x":"",fe=ee.supported?".webp":"$1";V.path=V.path.replace(/(\.(png|jpg)\d*)(?=$)/,""+re+fe),V.path=V.path.replace(/^.+\/v4\//,"/"),V.path="/v4"+V.path;var ge=this._customAccessToken||function(Ae){for(var ze=0,Ze=Ae;ze<Ze.length;ze+=1){var st=Ze[ze].match(/^access_token=(.*)$/);if(st)return st[1]}return null}(V.params)||q.ACCESS_TOKEN;return q.REQUIRE_ACCESS_TOKEN&&ge&&this._skuToken&&V.params.push("sku="+this._skuToken),this._makeAPIURL(V,ge)},ae.prototype.canonicalizeTileURL=function(b,I){var V=ve(b);if(!V.path.match(/(^\/v4\/)/)||!V.path.match(/\.[\w]+$/))return b;var re="mapbox://tiles/";re+=V.path.replace("/v4/","");var fe=V.params;return I&&(fe=fe.filter(function(ge){return!ge.match(/^access_token=/)})),fe.length&&(re+="?"+fe.join("&")),re},ae.prototype.canonicalizeTileset=function(b,I){for(var V=!!I&&he(I),re=[],fe=0,ge=b.tiles||[];fe<ge.length;fe+=1){var Ae=ge[fe];de(Ae)?re.push(this.canonicalizeTileURL(Ae,V)):re.push(Ae)}return re},ae.prototype._makeAPIURL=function(b,I){var V="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",re=ve(q.API_URL);if(b.protocol=re.protocol,b.authority=re.authority,re.path!=="/"&&(b.path=""+re.path+b.path),!q.REQUIRE_ACCESS_TOKEN)return ke(b);if(!(I=I||q.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+V);if(I[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+V);return b.params=b.params.filter(function(fe){return fe.indexOf("access_token")===-1}),b.params.push("access_token="+I),ke(b)};var se=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function de(b){return se.test(b)}var ce=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function ve(b){var I=b.match(ce);if(!I)throw new Error("Unable to parse URL object");return{protocol:I[1],authority:I[2],path:I[3]||"/",params:I[4]?I[4].split("&"):[]}}function ke(b){var I=b.params.length?"?"+b.params.join("&"):"";return b.protocol+"://"+b.authority+b.path+I}function Ee(b){if(!b)return null;var I,V=b.split(".");if(!V||V.length!==3)return null;try{return JSON.parse((I=V[1],decodeURIComponent(self.atob(I).split("").map(function(re){return"%"+("00"+re.charCodeAt(0).toString(16)).slice(-2)}).join(""))))}catch(re){return null}}var be=function(b){this.type=b,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};be.prototype.getStorageKey=function(b){var I,V=Ee(q.ACCESS_TOKEN),re="";return V&&V.u?(I=V.u,re=self.btoa(encodeURIComponent(I).replace(/%([0-9A-F]{2})/g,function(fe,ge){return String.fromCharCode(Number("0x"+ge))}))):re=q.ACCESS_TOKEN||"",b?"mapbox.eventData."+b+":"+re:"mapbox.eventData:"+re},be.prototype.fetchEventData=function(){var b=W("localStorage"),I=this.getStorageKey(),V=this.getStorageKey("uuid");if(b)try{var re=self.localStorage.getItem(I);re&&(this.eventData=JSON.parse(re));var fe=self.localStorage.getItem(V);fe&&(this.anonId=fe)}catch(ge){k("Unable to read from LocalStorage")}},be.prototype.saveEventData=function(){var b=W("localStorage"),I=this.getStorageKey(),V=this.getStorageKey("uuid");if(b)try{self.localStorage.setItem(V,this.anonId),Object.keys(this.eventData).length>=1&&self.localStorage.setItem(I,JSON.stringify(this.eventData))}catch(re){k("Unable to write to LocalStorage")}},be.prototype.processRequests=function(b){},be.prototype.postEvent=function(b,I,V,re){var fe=this;if(q.EVENTS_URL){var ge=ve(q.EVENTS_URL);ge.params.push("access_token="+(re||q.ACCESS_TOKEN||""));var Ae={event:this.type,created:new Date(b).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.10.1",skuId:ie,userId:this.anonId},ze=I?d(Ae,I):Ae,Ze={url:ke(ge),headers:{"Content-Type":"text/plain"},body:JSON.stringify([ze])};this.pendingRequest=Qt(Ze,function(st){fe.pendingRequest=null,V(st),fe.saveEventData(),fe.processRequests(re)})}},be.prototype.queueRequest=function(b,I){this.queue.push(b),this.processRequests(I)};var xe,ue,me=function(b){function I(){b.call(this,"map.load"),this.success={},this.skuToken=""}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.postMapLoadEvent=function(V,re,fe,ge){this.skuToken=fe,(q.EVENTS_URL&&ge||q.ACCESS_TOKEN&&Array.isArray(V)&&V.some(function(Ae){return he(Ae)||de(Ae)}))&&this.queueRequest({id:re,timestamp:Date.now()},ge)},I.prototype.processRequests=function(V){var re=this;if(!this.pendingRequest&&this.queue.length!==0){var fe=this.queue.shift(),ge=fe.id,Ae=fe.timestamp;ge&&this.success[ge]||(this.anonId||this.fetchEventData(),_(this.anonId)||(this.anonId=v()),this.postEvent(Ae,{skuToken:this.skuToken},function(ze){ze||ge&&(re.success[ge]=!0)},V))}},I}(be),we=new(function(b){function I(V){b.call(this,"appUserTurnstile"),this._customAccessToken=V}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.postTurnstileEvent=function(V,re){q.EVENTS_URL&&q.ACCESS_TOKEN&&Array.isArray(V)&&V.some(function(fe){return he(fe)||de(fe)})&&this.queueRequest(Date.now(),re)},I.prototype.processRequests=function(V){var re=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var fe=Ee(q.ACCESS_TOKEN),ge=fe?fe.u:q.ACCESS_TOKEN,Ae=ge!==this.eventData.tokenU;_(this.anonId)||(this.anonId=v(),Ae=!0);var ze=this.queue.shift();if(this.eventData.lastSuccess){var Ze=new Date(this.eventData.lastSuccess),st=new Date(ze),pt=(ze-this.eventData.lastSuccess)/864e5;Ae=Ae||pt>=1||pt<-1||Ze.getDate()!==st.getDate()}else Ae=!0;if(!Ae)return this.processRequests();this.postEvent(ze,{"enabled.telemetry":!1},function(Rt){Rt||(re.eventData.lastSuccess=ze,re.eventData.tokenU=ge)},V)}},I}(be)),Me=we.postTurnstileEvent.bind(we),Se=new me,De=Se.postMapLoadEvent.bind(Se),Fe=500,Ye=50;function et(){self.caches&&!xe&&(xe=self.caches.open("mapbox-tiles"))}function Oe(b,I,V){if(et(),xe){var re={status:I.status,statusText:I.statusText,headers:new self.Headers};I.headers.forEach(function(ge,Ae){return re.headers.set(Ae,ge)});var fe=O(I.headers.get("Cache-Control")||"");fe["no-store"]||(fe["max-age"]&&re.headers.set("Expires",new Date(V+1e3*fe["max-age"]).toUTCString()),new Date(re.headers.get("Expires")).getTime()-V<42e4||function(ge,Ae){if(ue===void 0)try{new Response(new ReadableStream),ue=!0}catch(ze){ue=!1}ue?Ae(ge.body):ge.blob().then(Ae)}(I,function(ge){var Ae=new self.Response(ge,re);et(),xe&&xe.then(function(ze){return ze.put(je(b.url),Ae)}).catch(function(ze){return k(ze.message)})}))}}function je(b){var I=b.indexOf("?");return I<0?b:b.slice(0,I)}function We(b,I){if(et(),!xe)return I(null);var V=je(b.url);xe.then(function(re){re.match(V).then(function(fe){var ge=function(Ae){if(!Ae)return!1;var ze=new Date(Ae.headers.get("Expires")||0),Ze=O(Ae.headers.get("Cache-Control")||"");return ze>Date.now()&&!Ze["no-cache"]}(fe);re.delete(V),ge&&re.put(V,fe.clone()),I(null,fe,ge)}).catch(I)}).catch(I)}var Ge,Qe=1/0;function it(){return Ge==null&&(Ge=self.OffscreenCanvas&&new self.OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),Ge}var lt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(lt);var Lt=function(b){function I(V,re,fe){re===401&&de(fe)&&(V+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),b.call(this,V),this.status=re,this.url=fe,this.name=this.constructor.name,this.message=V}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},I}(Error),wt=P()?function(){return self.worker&&self.worker.referrer}:function(){return(self.location.protocol==="blob:"?self.parent:self).location.href};function rt(b,I){var V,re=new self.AbortController,fe=new self.Request(b.url,{method:b.method||"GET",body:b.body,credentials:b.credentials,headers:b.headers,referrer:wt(),signal:re.signal}),ge=!1,Ae=!1,ze=(V=fe.url).indexOf("sku=")>0&&de(V);b.type==="json"&&fe.headers.set("Accept","application/json");var Ze=function(pt,Rt,Gt){if(!Ae){if(pt&&pt.message!=="SecurityError"&&k(pt),Rt&&Gt)return st(Rt);var Ut=Date.now();self.fetch(fe).then(function(rr){if(rr.ok){var pr=ze?rr.clone():null;return st(rr,pr,Ut)}return I(new Lt(rr.statusText,rr.status,b.url))}).catch(function(rr){rr.code!==20&&I(new Error(rr.message))})}},st=function(pt,Rt,Gt){(b.type==="arrayBuffer"?pt.arrayBuffer():b.type==="json"?pt.json():pt.text()).then(function(Ut){Ae||(Rt&&Gt&&Oe(fe,Rt,Gt),ge=!0,I(null,Ut,pt.headers.get("Cache-Control"),pt.headers.get("Expires")))}).catch(function(Ut){Ae||I(new Error(Ut.message))})};return ze?We(fe,Ze):Ze(null,null),{cancel:function(){Ae=!0,ge||re.abort()}}}var $e=function(b,I){if(V=b.url,!(/^file:/.test(V)||/^file:/.test(wt())&&!/^\w+:/.test(V))){if(self.fetch&&self.Request&&self.AbortController&&self.Request.prototype.hasOwnProperty("signal"))return rt(b,I);if(P()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",b,I,void 0,!0)}var V;return function(re,fe){var ge=new self.XMLHttpRequest;for(var Ae in ge.open(re.method||"GET",re.url,!0),re.type==="arrayBuffer"&&(ge.responseType="arraybuffer"),re.headers)ge.setRequestHeader(Ae,re.headers[Ae]);return re.type==="json"&&(ge.responseType="text",ge.setRequestHeader("Accept","application/json")),ge.withCredentials=re.credentials==="include",ge.onerror=function(){fe(new Error(ge.statusText))},ge.onload=function(){if((ge.status>=200&&ge.status<300||ge.status===0)&&ge.response!==null){var ze=ge.response;if(re.type==="json")try{ze=JSON.parse(ge.response)}catch(Ze){return fe(Ze)}fe(null,ze,ge.getResponseHeader("Cache-Control"),ge.getResponseHeader("Expires"))}else fe(new Lt(ge.statusText,ge.status,re.url))},ge.send(re.body),{cancel:function(){return ge.abort()}}}(b,I)},xt=function(b,I){return $e(d(b,{type:"arrayBuffer"}),I)},Qt=function(b,I){return $e(d(b,{method:"POST"}),I)},$t,Ue;$t=[],Ue=0;var He=function(b,I){if(ee.supported&&(b.headers||(b.headers={}),b.headers.accept="image/webp,*/*"),Ue>=q.MAX_PARALLEL_IMAGE_REQUESTS){var V={requestParameters:b,callback:I,cancelled:!1,cancel:function(){this.cancelled=!0}};return $t.push(V),V}Ue++;var re=!1,fe=function(){if(!re)for(re=!0,Ue--;$t.length&&Ue<q.MAX_PARALLEL_IMAGE_REQUESTS;){var Ae=$t.shift(),ze=Ae.requestParameters,Ze=Ae.callback;Ae.cancelled||(Ae.cancel=He(ze,Ze).cancel)}},ge=xt(b,function(Ae,ze,Ze,st){fe(),Ae?I(Ae):ze&&(it()?function(pt,Rt){var Gt=new self.Blob([new Uint8Array(pt)],{type:"image/png"});self.createImageBitmap(Gt).then(function(Ut){Rt(null,Ut)}).catch(function(Ut){Rt(new Error("Could not load image because of "+Ut.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(ze,I):function(pt,Rt,Gt,Ut){var rr=new self.Image,pr=self.URL;rr.onload=function(){Rt(null,rr),pr.revokeObjectURL(rr.src)},rr.onerror=function(){return Rt(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Sr=new self.Blob([new Uint8Array(pt)],{type:"image/png"});rr.cacheControl=Gt,rr.expires=Ut,rr.src=pt.byteLength?pr.createObjectURL(Sr):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}(ze,I,Ze,st))});return{cancel:function(){ge.cancel(),fe()}}};function Be(b,I,V){V[b]&&V[b].indexOf(I)!==-1||(V[b]=V[b]||[],V[b].push(I))}function Je(b,I,V){if(V&&V[b]){var re=V[b].indexOf(I);re!==-1&&V[b].splice(re,1)}}var _e=function(b,I){I===void 0&&(I={}),d(this,I),this.type=b},Le=function(b){function I(V,re){re===void 0&&(re={}),b.call(this,"error",d({error:V},re))}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I}(_e),Ce=function(){};Ce.prototype.on=function(b,I){return this._listeners=this._listeners||{},Be(b,I,this._listeners),this},Ce.prototype.off=function(b,I){return Je(b,I,this._listeners),Je(b,I,this._oneTimeListeners),this},Ce.prototype.once=function(b,I){return this._oneTimeListeners=this._oneTimeListeners||{},Be(b,I,this._oneTimeListeners),this},Ce.prototype.fire=function(b,I){typeof b=="string"&&(b=new _e(b,I||{}));var V=b.type;if(this.listens(V)){b.target=this;for(var re=0,fe=this._listeners&&this._listeners[V]?this._listeners[V].slice():[];re<fe.length;re+=1)fe[re].call(this,b);for(var ge=0,Ae=this._oneTimeListeners&&this._oneTimeListeners[V]?this._oneTimeListeners[V].slice():[];ge<Ae.length;ge+=1){var ze=Ae[ge];Je(V,ze,this._oneTimeListeners),ze.call(this,b)}var Ze=this._eventedParent;Ze&&(d(b,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),Ze.fire(b))}else b instanceof Le&&console.error(b.error);return this},Ce.prototype.listens=function(b){return this._listeners&&this._listeners[b]&&this._listeners[b].length>0||this._oneTimeListeners&&this._oneTimeListeners[b]&&this._oneTimeListeners[b].length>0||this._eventedParent&&this._eventedParent.listens(b)},Ce.prototype.setEventedParent=function(b,I){return this._eventedParent=b,this._eventedParentData=I,this};var Pe={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},"index-of":{group:"Lookup"},slice:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},distance:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},within:{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Xe=function(b,I,V,re){this.message=(b?b+": ":"")+V,re&&(this.identifier=re),I!=null&&I.__line__&&(this.line=I.__line__)};function ut(b){var I=b.key,V=b.value;return V?[new Xe(I,V,"constants have been deprecated as of v8")]:[]}function kt(b){for(var I=[],V=arguments.length-1;V-- >0;)I[V]=arguments[V+1];for(var re=0,fe=I;re<fe.length;re+=1){var ge=fe[re];for(var Ae in ge)b[Ae]=ge[Ae]}return b}function ft(b){return b instanceof Number||b instanceof String||b instanceof Boolean?b.valueOf():b}function Et(b){if(Array.isArray(b))return b.map(Et);if(b instanceof Object&&!(b instanceof Number||b instanceof String||b instanceof Boolean)){var I={};for(var V in b)I[V]=Et(b[V]);return I}return ft(b)}var mt=function(b){function I(V,re){b.call(this,re),this.message=re,this.key=V}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I}(Error),It=function(b,I){I===void 0&&(I=[]),this.parent=b,this.bindings={};for(var V=0,re=I;V<re.length;V+=1){var fe=re[V],ge=fe[0],Ae=fe[1];this.bindings[ge]=Ae}};It.prototype.concat=function(b){return new It(this,b)},It.prototype.get=function(b){if(this.bindings[b])return this.bindings[b];if(this.parent)return this.parent.get(b);throw new Error(b+" not found in scope.")},It.prototype.has=function(b){return!!this.bindings[b]||!!this.parent&&this.parent.has(b)};var vt={kind:"null"},nt={kind:"number"},At={kind:"string"},Ft={kind:"boolean"},Nt={kind:"color"},Kt={kind:"object"},Ie={kind:"value"},ot={kind:"collator"},bt={kind:"formatted"},Pt={kind:"resolvedImage"};function Vt(b,I){return{kind:"array",itemType:b,N:I}}function nr(b){if(b.kind==="array"){var I=nr(b.itemType);return typeof b.N=="number"?"array<"+I+", "+b.N+">":b.itemType.kind==="value"?"array":"array<"+I+">"}return b.kind}var Yt=[vt,nt,At,Ft,Nt,bt,Kt,Vt(Ie),Pt];function Xt(b,I){if(I.kind==="error")return null;if(b.kind==="array"){if(I.kind==="array"&&(I.N===0&&I.itemType.kind==="value"||!Xt(b.itemType,I.itemType))&&(typeof b.N!="number"||b.N===I.N))return null}else{if(b.kind===I.kind)return null;if(b.kind==="value"){for(var V=0,re=Yt;V<re.length;V+=1)if(!Xt(re[V],I))return null}}return"Expected "+nr(b)+" but found "+nr(I)+" instead."}function ar(b,I){return I.some(function(V){return V.kind===b.kind})}function hr(b,I){return I.some(function(V){return V==="null"?b===null:V==="array"?Array.isArray(b):V==="object"?b&&!Array.isArray(b)&&typeof b=="object":V===typeof b})}var mr=f(function(b,I){var V={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function re(Ze){return(Ze=Math.round(Ze))<0?0:Ze>255?255:Ze}function fe(Ze){return Ze<0?0:Ze>1?1:Ze}function ge(Ze){return Ze[Ze.length-1]==="%"?re(parseFloat(Ze)/100*255):re(parseInt(Ze))}function Ae(Ze){return Ze[Ze.length-1]==="%"?fe(parseFloat(Ze)/100):fe(parseFloat(Ze))}function ze(Ze,st,pt){return pt<0?pt+=1:pt>1&&(pt-=1),6*pt<1?Ze+(st-Ze)*pt*6:2*pt<1?st:3*pt<2?Ze+(st-Ze)*(2/3-pt)*6:Ze}try{I.parseCSSColor=function(Ze){var st,pt=Ze.replace(/ /g,"").toLowerCase();if(pt in V)return V[pt].slice();if(pt[0]==="#")return pt.length===4?(st=parseInt(pt.substr(1),16))>=0&&st<=4095?[(3840&st)>>4|(3840&st)>>8,240&st|(240&st)>>4,15&st|(15&st)<<4,1]:null:pt.length===7&&(st=parseInt(pt.substr(1),16))>=0&&st<=16777215?[(16711680&st)>>16,(65280&st)>>8,255&st,1]:null;var Rt=pt.indexOf("("),Gt=pt.indexOf(")");if(Rt!==-1&&Gt+1===pt.length){var Ut=pt.substr(0,Rt),rr=pt.substr(Rt+1,Gt-(Rt+1)).split(","),pr=1;switch(Ut){case"rgba":if(rr.length!==4)return null;pr=Ae(rr.pop());case"rgb":return rr.length!==3?null:[ge(rr[0]),ge(rr[1]),ge(rr[2]),pr];case"hsla":if(rr.length!==4)return null;pr=Ae(rr.pop());case"hsl":if(rr.length!==3)return null;var Sr=(parseFloat(rr[0])%360+360)%360/360,Mr=Ae(rr[1]),Dr=Ae(rr[2]),Rr=Dr<=.5?Dr*(Mr+1):Dr+Mr-Dr*Mr,Ur=2*Dr-Rr;return[re(255*ze(Ur,Rr,Sr+1/3)),re(255*ze(Ur,Rr,Sr)),re(255*ze(Ur,Rr,Sr-1/3)),pr];default:return null}}return null}}catch(Ze){}}).parseCSSColor,sr=function(b,I,V,re){re===void 0&&(re=1),this.r=b,this.g=I,this.b=V,this.a=re};sr.parse=function(b){if(b){if(b instanceof sr)return b;if(typeof b=="string"){var I=mr(b);if(I)return new sr(I[0]/255*I[3],I[1]/255*I[3],I[2]/255*I[3],I[3])}}},sr.prototype.toString=function(){var b=this.toArray(),I=b[0],V=b[1],re=b[2],fe=b[3];return"rgba("+Math.round(I)+","+Math.round(V)+","+Math.round(re)+","+fe+")"},sr.prototype.toArray=function(){var b=this.r,I=this.g,V=this.b,re=this.a;return re===0?[0,0,0,0]:[255*b/re,255*I/re,255*V/re,re]},sr.black=new sr(0,0,0,1),sr.white=new sr(1,1,1,1),sr.transparent=new sr(0,0,0,0),sr.red=new sr(1,0,0,1);var fr=function(b,I,V){this.sensitivity=b?I?"variant":"case":I?"accent":"base",this.locale=V,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};fr.prototype.compare=function(b,I){return this.collator.compare(b,I)},fr.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var yr=function(b,I,V,re,fe){this.text=b,this.image=I,this.scale=V,this.fontStack=re,this.textColor=fe},zr=function(b){this.sections=b};zr.fromString=function(b){return new zr([new yr(b,null,null,null,null)])},zr.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(b){return b.text.length!==0||b.image&&b.image.name.length!==0})},zr.factory=function(b){return b instanceof zr?b:zr.fromString(b)},zr.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(b){return b.text}).join("")},zr.prototype.serialize=function(){for(var b=["format"],I=0,V=this.sections;I<V.length;I+=1){var re=V[I];if(re.image)b.push(["image",re.image.name]);else{b.push(re.text);var fe={};re.fontStack&&(fe["text-font"]=["literal",re.fontStack.split(",")]),re.scale&&(fe["font-scale"]=re.scale),re.textColor&&(fe["text-color"]=["rgba"].concat(re.textColor.toArray())),b.push(fe)}}return b};var xr=function(b){this.name=b.name,this.available=b.available};function Br(b,I,V,re){return typeof b=="number"&&b>=0&&b<=255&&typeof I=="number"&&I>=0&&I<=255&&typeof V=="number"&&V>=0&&V<=255?re===void 0||typeof re=="number"&&re>=0&&re<=1?null:"Invalid rgba value ["+[b,I,V,re].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof re=="number"?[b,I,V,re]:[b,I,V]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Jr(b){if(b===null||typeof b=="string"||typeof b=="boolean"||typeof b=="number"||b instanceof sr||b instanceof fr||b instanceof zr||b instanceof xr)return!0;if(Array.isArray(b)){for(var I=0,V=b;I<V.length;I+=1)if(!Jr(V[I]))return!1;return!0}if(typeof b=="object"){for(var re in b)if(!Jr(b[re]))return!1;return!0}return!1}function fn(b){if(b===null)return vt;if(typeof b=="string")return At;if(typeof b=="boolean")return Ft;if(typeof b=="number")return nt;if(b instanceof sr)return Nt;if(b instanceof fr)return ot;if(b instanceof zr)return bt;if(b instanceof xr)return Pt;if(Array.isArray(b)){for(var I,V=b.length,re=0,fe=b;re<fe.length;re+=1){var ge=fn(fe[re]);if(I){if(I===ge)continue;I=Ie;break}I=ge}return Vt(I||Ie,V)}return Kt}function Cn(b){var I=typeof b;return b===null?"":I==="string"||I==="number"||I==="boolean"?String(b):b instanceof sr||b instanceof zr||b instanceof xr?b.toString():JSON.stringify(b)}xr.prototype.toString=function(){return this.name},xr.fromString=function(b){return b?new xr({name:b,available:!1}):null},xr.prototype.serialize=function(){return["image",this.name]};var Pn=function(b,I){this.type=b,this.value=I};Pn.parse=function(b,I){if(b.length!==2)return I.error("'literal' expression requires exactly one argument, but found "+(b.length-1)+" instead.");if(!Jr(b[1]))return I.error("invalid value");var V=b[1],re=fn(V),fe=I.expectedType;return re.kind!=="array"||re.N!==0||!fe||fe.kind!=="array"||typeof fe.N=="number"&&fe.N!==0||(re=fe),new Pn(re,V)},Pn.prototype.evaluate=function(){return this.value},Pn.prototype.eachChild=function(){},Pn.prototype.outputDefined=function(){return!0},Pn.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof sr?["rgba"].concat(this.value.toArray()):this.value instanceof zr?this.value.serialize():this.value};var An=function(b){this.name="ExpressionEvaluationError",this.message=b};An.prototype.toJSON=function(){return this.message};var rn={string:At,number:nt,boolean:Ft,object:Kt},Fr=function(b,I){this.type=b,this.args=I};Fr.parse=function(b,I){if(b.length<2)return I.error("Expected at least one argument.");var V,re=1,fe=b[0];if(fe==="array"){var ge,Ae;if(b.length>2){var ze=b[1];if(typeof ze!="string"||!(ze in rn)||ze==="object")return I.error('The item type argument of "array" must be one of string, number, boolean',1);ge=rn[ze],re++}else ge=Ie;if(b.length>3){if(b[2]!==null&&(typeof b[2]!="number"||b[2]<0||b[2]!==Math.floor(b[2])))return I.error('The length argument to "array" must be a positive integer literal',2);Ae=b[2],re++}V=Vt(ge,Ae)}else V=rn[fe];for(var Ze=[];re<b.length;re++){var st=I.parse(b[re],re,Ie);if(!st)return null;Ze.push(st)}return new Fr(V,Ze)},Fr.prototype.evaluate=function(b){for(var I=0;I<this.args.length;I++){var V=this.args[I].evaluate(b);if(!Xt(this.type,fn(V)))return V;if(I===this.args.length-1)throw new An("Expected value to be of type "+nr(this.type)+", but found "+nr(fn(V))+" instead.")}return null},Fr.prototype.eachChild=function(b){this.args.forEach(b)},Fr.prototype.outputDefined=function(){return this.args.every(function(b){return b.outputDefined()})},Fr.prototype.serialize=function(){var b=this.type,I=[b.kind];if(b.kind==="array"){var V=b.itemType;if(V.kind==="string"||V.kind==="number"||V.kind==="boolean"){I.push(V.kind);var re=b.N;(typeof re=="number"||this.args.length>1)&&I.push(re)}}return I.concat(this.args.map(function(fe){return fe.serialize()}))};var Lr=function(b){this.type=bt,this.sections=b};Lr.parse=function(b,I){if(b.length<2)return I.error("Expected at least one argument.");var V=b[1];if(!Array.isArray(V)&&typeof V=="object")return I.error("First argument must be an image or text section.");for(var re=[],fe=!1,ge=1;ge<=b.length-1;++ge){var Ae=b[ge];if(fe&&typeof Ae=="object"&&!Array.isArray(Ae)){fe=!1;var ze=null;if(Ae["font-scale"]&&!(ze=I.parse(Ae["font-scale"],1,nt)))return null;var Ze=null;if(Ae["text-font"]&&!(Ze=I.parse(Ae["text-font"],1,Vt(At))))return null;var st=null;if(Ae["text-color"]&&!(st=I.parse(Ae["text-color"],1,Nt)))return null;var pt=re[re.length-1];pt.scale=ze,pt.font=Ze,pt.textColor=st}else{var Rt=I.parse(b[ge],1,Ie);if(!Rt)return null;var Gt=Rt.type.kind;if(Gt!=="string"&&Gt!=="value"&&Gt!=="null"&&Gt!=="resolvedImage")return I.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");fe=!0,re.push({content:Rt,scale:null,font:null,textColor:null})}}return new Lr(re)},Lr.prototype.evaluate=function(b){return new zr(this.sections.map(function(I){var V=I.content.evaluate(b);return fn(V)===Pt?new yr("",V,null,null,null):new yr(Cn(V),null,I.scale?I.scale.evaluate(b):null,I.font?I.font.evaluate(b).join(","):null,I.textColor?I.textColor.evaluate(b):null)}))},Lr.prototype.eachChild=function(b){for(var I=0,V=this.sections;I<V.length;I+=1){var re=V[I];b(re.content),re.scale&&b(re.scale),re.font&&b(re.font),re.textColor&&b(re.textColor)}},Lr.prototype.outputDefined=function(){return!1},Lr.prototype.serialize=function(){for(var b=["format"],I=0,V=this.sections;I<V.length;I+=1){var re=V[I];b.push(re.content.serialize());var fe={};re.scale&&(fe["font-scale"]=re.scale.serialize()),re.font&&(fe["text-font"]=re.font.serialize()),re.textColor&&(fe["text-color"]=re.textColor.serialize()),b.push(fe)}return b};var Qr=function(b){this.type=Pt,this.input=b};Qr.parse=function(b,I){if(b.length!==2)return I.error("Expected two arguments.");var V=I.parse(b[1],1,At);return V?new Qr(V):I.error("No image name provided.")},Qr.prototype.evaluate=function(b){var I=this.input.evaluate(b),V=xr.fromString(I);return V&&b.availableImages&&(V.available=b.availableImages.indexOf(I)>-1),V},Qr.prototype.eachChild=function(b){b(this.input)},Qr.prototype.outputDefined=function(){return!1},Qr.prototype.serialize=function(){return["image",this.input.serialize()]};var $r={"to-boolean":Ft,"to-color":Nt,"to-number":nt,"to-string":At},Kr=function(b,I){this.type=b,this.args=I};Kr.parse=function(b,I){if(b.length<2)return I.error("Expected at least one argument.");var V=b[0];if((V==="to-boolean"||V==="to-string")&&b.length!==2)return I.error("Expected one argument.");for(var re=$r[V],fe=[],ge=1;ge<b.length;ge++){var Ae=I.parse(b[ge],ge,Ie);if(!Ae)return null;fe.push(Ae)}return new Kr(re,fe)},Kr.prototype.evaluate=function(b){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(b));if(this.type.kind==="color"){for(var I,V,re=0,fe=this.args;re<fe.length;re+=1){if(V=null,(I=fe[re].evaluate(b))instanceof sr)return I;if(typeof I=="string"){var ge=b.parseColor(I);if(ge)return ge}else if(Array.isArray(I)&&!(V=I.length<3||I.length>4?"Invalid rbga value "+JSON.stringify(I)+": expected an array containing either three or four numeric values.":Br(I[0],I[1],I[2],I[3])))return new sr(I[0]/255,I[1]/255,I[2]/255,I[3])}throw new An(V||"Could not parse color from value '"+(typeof I=="string"?I:String(JSON.stringify(I)))+"'")}if(this.type.kind==="number"){for(var Ae=null,ze=0,Ze=this.args;ze<Ze.length;ze+=1){if((Ae=Ze[ze].evaluate(b))===null)return 0;var st=Number(Ae);if(!isNaN(st))return st}throw new An("Could not convert "+JSON.stringify(Ae)+" to number.")}return this.type.kind==="formatted"?zr.fromString(Cn(this.args[0].evaluate(b))):this.type.kind==="resolvedImage"?xr.fromString(Cn(this.args[0].evaluate(b))):Cn(this.args[0].evaluate(b))},Kr.prototype.eachChild=function(b){this.args.forEach(b)},Kr.prototype.outputDefined=function(){return this.args.every(function(b){return b.outputDefined()})},Kr.prototype.serialize=function(){if(this.type.kind==="formatted")return new Lr([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Qr(this.args[0]).serialize();var b=["to-"+this.type.kind];return this.eachChild(function(I){b.push(I.serialize())}),b};var en=["Unknown","Point","LineString","Polygon"],Tn=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};Tn.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Tn.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?en[this.feature.type]:this.feature.type:null},Tn.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Tn.prototype.canonicalID=function(){return this.canonical},Tn.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Tn.prototype.parseColor=function(b){var I=this._parseColorCache[b];return I||(I=this._parseColorCache[b]=sr.parse(b)),I};var Mn=function(b,I,V,re){this.name=b,this.type=I,this._evaluate=V,this.args=re};Mn.prototype.evaluate=function(b){return this._evaluate(b,this.args)},Mn.prototype.eachChild=function(b){this.args.forEach(b)},Mn.prototype.outputDefined=function(){return!1},Mn.prototype.serialize=function(){return[this.name].concat(this.args.map(function(b){return b.serialize()}))},Mn.parse=function(b,I){var V,re=b[0],fe=Mn.definitions[re];if(!fe)return I.error('Unknown expression "'+re+'". If you wanted a literal array, use ["literal", [...]].',0);for(var ge=Array.isArray(fe)?fe[0]:fe.type,Ae=Array.isArray(fe)?[[fe[1],fe[2]]]:fe.overloads,ze=Ae.filter(function(na){var Xn=na[0];return!Array.isArray(Xn)||Xn.length===b.length-1}),Ze=null,st=0,pt=ze;st<pt.length;st+=1){var Rt=pt[st],Gt=Rt[0],Ut=Rt[1];Ze=new hn(I.registry,I.path,null,I.scope);for(var rr=[],pr=!1,Sr=1;Sr<b.length;Sr++){var Mr=b[Sr],Dr=Array.isArray(Gt)?Gt[Sr-1]:Gt.type,Rr=Ze.parse(Mr,1+rr.length,Dr);if(!Rr){pr=!0;break}rr.push(Rr)}if(!pr)if(Array.isArray(Gt)&&Gt.length!==rr.length)Ze.error("Expected "+Gt.length+" arguments, but found "+rr.length+" instead.");else{for(var Ur=0;Ur<rr.length;Ur++){var cn=Array.isArray(Gt)?Gt[Ur]:Gt.type,vn=rr[Ur];Ze.concat(Ur+1).checkSubtype(cn,vn.type)}if(Ze.errors.length===0)return new Mn(re,ge,Ut,rr)}}if(ze.length===1)(V=I.errors).push.apply(V,Ze.errors);else{for(var Fn=(ze.length?ze:Ae).map(function(na){var Xn,ua=na[0];return Xn=ua,Array.isArray(Xn)?"("+Xn.map(nr).join(", ")+")":"("+nr(Xn.type)+"...)"}).join(" | "),Dn=[],Hn=1;Hn<b.length;Hn++){var ra=I.parse(b[Hn],1+Dn.length);if(!ra)return null;Dn.push(nr(ra.type))}I.error("Expected arguments of type "+Fn+", but found ("+Dn.join(", ")+") instead.")}return null},Mn.register=function(b,I){for(var V in Mn.definitions=I,I)b[V]=Mn};var Rn=function(b,I,V){this.type=ot,this.locale=V,this.caseSensitive=b,this.diacriticSensitive=I};Rn.parse=function(b,I){if(b.length!==2)return I.error("Expected one argument.");var V=b[1];if(typeof V!="object"||Array.isArray(V))return I.error("Collator options argument must be an object.");var re=I.parse(V["case-sensitive"]!==void 0&&V["case-sensitive"],1,Ft);if(!re)return null;var fe=I.parse(V["diacritic-sensitive"]!==void 0&&V["diacritic-sensitive"],1,Ft);if(!fe)return null;var ge=null;return V.locale&&!(ge=I.parse(V.locale,1,At))?null:new Rn(re,fe,ge)},Rn.prototype.evaluate=function(b){return new fr(this.caseSensitive.evaluate(b),this.diacriticSensitive.evaluate(b),this.locale?this.locale.evaluate(b):null)},Rn.prototype.eachChild=function(b){b(this.caseSensitive),b(this.diacriticSensitive),this.locale&&b(this.locale)},Rn.prototype.outputDefined=function(){return!1},Rn.prototype.serialize=function(){var b={};return b["case-sensitive"]=this.caseSensitive.serialize(),b["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(b.locale=this.locale.serialize()),["collator",b]};function Zt(b,I){b[0]=Math.min(b[0],I[0]),b[1]=Math.min(b[1],I[1]),b[2]=Math.max(b[2],I[0]),b[3]=Math.max(b[3],I[1])}function Ct(b,I){return!(b[0]<=I[0])&&!(b[2]>=I[2])&&!(b[1]<=I[1])&&!(b[3]>=I[3])}function Ht(b,I){var V,re=(180+b[0])/360,fe=(V=b[1],(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+V*Math.PI/360)))/360),ge=Math.pow(2,I.z);return[Math.round(re*ge*8192),Math.round(fe*ge*8192)]}function cr(b,I,V){return I[1]>b[1]!=V[1]>b[1]&&b[0]<(V[0]-I[0])*(b[1]-I[1])/(V[1]-I[1])+I[0]}function _r(b,I){for(var V,re,fe,ge,Ae,ze,Ze,st=!1,pt=0,Rt=I.length;pt<Rt;pt++)for(var Gt=I[pt],Ut=0,rr=Gt.length;Ut<rr-1;Ut++){if(V=b,re=Gt[Ut],fe=Gt[Ut+1],ge=void 0,Ae=void 0,ze=void 0,Ze=void 0,ge=V[0]-re[0],Ae=V[1]-re[1],ze=V[0]-fe[0],Ze=V[1]-fe[1],ge*Ze-ze*Ae==0&&ge*ze<=0&&Ae*Ze<=0)return!1;cr(b,Gt[Ut],Gt[Ut+1])&&(st=!st)}return st}function Vr(b,I){for(var V=0;V<I.length;V++)if(_r(b,I[V]))return!0;return!1}function jr(b,I,V,re){var fe=b[0]-V[0],ge=b[1]-V[1],Ae=I[0]-V[0],ze=I[1]-V[1],Ze=re[0]-V[0],st=re[1]-V[1],pt=fe*st-Ze*ge,Rt=Ae*st-Ze*ze;return pt>0&&Rt<0||pt<0&&Rt>0}function vr(b,I,V){for(var re=0,fe=V;re<fe.length;re+=1)for(var ge=fe[re],Ae=0;Ae<ge.length-1;++Ae)if(ze=b,Ze=I,st=ge[Ae],pt=ge[Ae+1],Rt=void 0,Gt=void 0,Ut=void 0,rr=void 0,Ut=[Ze[0]-ze[0],Ze[1]-ze[1]],rr=[pt[0]-st[0],pt[1]-st[1]],(Rt=rr)[0]*(Gt=Ut)[1]-Rt[1]*Gt[0]!=0&&jr(ze,Ze,st,pt)&&jr(st,pt,ze,Ze))return!0;var ze,Ze,st,pt,Rt,Gt,Ut,rr;return!1}function br(b,I){for(var V=0;V<b.length;++V)if(!_r(b[V],I))return!1;for(var re=0;re<b.length-1;++re)if(vr(b[re],b[re+1],I))return!1;return!0}function Ar(b,I){for(var V=0;V<I.length;V++)if(br(b,I[V]))return!0;return!1}function kr(b,I,V){for(var re=[],fe=0;fe<b.length;fe++){for(var ge=[],Ae=0;Ae<b[fe].length;Ae++){var ze=Ht(b[fe][Ae],V);Zt(I,ze),ge.push(ze)}re.push(ge)}return re}function Cr(b,I,V){for(var re=[],fe=0;fe<b.length;fe++){var ge=kr(b[fe],I,V);re.push(ge)}return re}function Hr(b,I,V,re){if(b[0]<V[0]||b[0]>V[2]){var fe=.5*re,ge=b[0]-V[0]>fe?-re:V[0]-b[0]>fe?re:0;ge===0&&(ge=b[0]-V[2]>fe?-re:V[2]-b[0]>fe?re:0),b[0]+=ge}Zt(I,b)}function ln(b,I,V,re){for(var fe=8192*Math.pow(2,re.z),ge=[8192*re.x,8192*re.y],Ae=[],ze=0,Ze=b;ze<Ze.length;ze+=1)for(var st=0,pt=Ze[ze];st<pt.length;st+=1){var Rt=pt[st],Gt=[Rt.x+ge[0],Rt.y+ge[1]];Hr(Gt,I,V,fe),Ae.push(Gt)}return Ae}function xn(b,I,V,re){for(var fe,ge=8192*Math.pow(2,re.z),Ae=[8192*re.x,8192*re.y],ze=[],Ze=0,st=b;Ze<st.length;Ze+=1){for(var pt=[],Rt=0,Gt=st[Ze];Rt<Gt.length;Rt+=1){var Ut=Gt[Rt],rr=[Ut.x+Ae[0],Ut.y+Ae[1]];Zt(I,rr),pt.push(rr)}ze.push(pt)}if(I[2]-I[0]<=ge/2){(fe=I)[0]=fe[1]=1/0,fe[2]=fe[3]=-1/0;for(var pr=0,Sr=ze;pr<Sr.length;pr+=1)for(var Mr=0,Dr=Sr[pr];Mr<Dr.length;Mr+=1)Hr(Dr[Mr],I,V,ge)}return ze}var Zr=function(b,I){this.type=Ft,this.geojson=b,this.geometries=I};function yn(b){if(b instanceof Mn&&(b.name==="get"&&b.args.length===1||b.name==="feature-state"||b.name==="has"&&b.args.length===1||b.name==="properties"||b.name==="geometry-type"||b.name==="id"||/^filter-/.test(b.name))||b instanceof Zr)return!1;var I=!0;return b.eachChild(function(V){I&&!yn(V)&&(I=!1)}),I}function Ir(b){if(b instanceof Mn&&b.name==="feature-state")return!1;var I=!0;return b.eachChild(function(V){I&&!Ir(V)&&(I=!1)}),I}function Gr(b,I){if(b instanceof Mn&&I.indexOf(b.name)>=0)return!1;var V=!0;return b.eachChild(function(re){V&&!Gr(re,I)&&(V=!1)}),V}Zr.parse=function(b,I){if(b.length!==2)return I.error("'within' expression requires exactly one argument, but found "+(b.length-1)+" instead.");if(Jr(b[1])){var V=b[1];if(V.type==="FeatureCollection")for(var re=0;re<V.features.length;++re){var fe=V.features[re].geometry.type;if(fe==="Polygon"||fe==="MultiPolygon")return new Zr(V,V.features[re].geometry)}else if(V.type==="Feature"){var ge=V.geometry.type;if(ge==="Polygon"||ge==="MultiPolygon")return new Zr(V,V.geometry)}else if(V.type==="Polygon"||V.type==="MultiPolygon")return new Zr(V,V)}return I.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Zr.prototype.evaluate=function(b){if(b.geometry()!=null&&b.canonicalID()!=null){if(b.geometryType()==="Point")return function(I,V){var re=[1/0,1/0,-1/0,-1/0],fe=[1/0,1/0,-1/0,-1/0],ge=I.canonicalID();if(V.type==="Polygon"){var Ae=kr(V.coordinates,fe,ge),ze=ln(I.geometry(),re,fe,ge);if(!Ct(re,fe))return!1;for(var Ze=0,st=ze;Ze<st.length;Ze+=1)if(!_r(st[Ze],Ae))return!1}if(V.type==="MultiPolygon"){var pt=Cr(V.coordinates,fe,ge),Rt=ln(I.geometry(),re,fe,ge);if(!Ct(re,fe))return!1;for(var Gt=0,Ut=Rt;Gt<Ut.length;Gt+=1)if(!Vr(Ut[Gt],pt))return!1}return!0}(b,this.geometries);if(b.geometryType()==="LineString")return function(I,V){var re=[1/0,1/0,-1/0,-1/0],fe=[1/0,1/0,-1/0,-1/0],ge=I.canonicalID();if(V.type==="Polygon"){var Ae=kr(V.coordinates,fe,ge),ze=xn(I.geometry(),re,fe,ge);if(!Ct(re,fe))return!1;for(var Ze=0,st=ze;Ze<st.length;Ze+=1)if(!br(st[Ze],Ae))return!1}if(V.type==="MultiPolygon"){var pt=Cr(V.coordinates,fe,ge),Rt=xn(I.geometry(),re,fe,ge);if(!Ct(re,fe))return!1;for(var Gt=0,Ut=Rt;Gt<Ut.length;Gt+=1)if(!Ar(Ut[Gt],pt))return!1}return!0}(b,this.geometries)}return!1},Zr.prototype.eachChild=function(){},Zr.prototype.outputDefined=function(){return!0},Zr.prototype.serialize=function(){return["within",this.geojson]};var mn=function(b,I){this.type=I.type,this.name=b,this.boundExpression=I};mn.parse=function(b,I){if(b.length!==2||typeof b[1]!="string")return I.error("'var' expression requires exactly one string literal argument.");var V=b[1];return I.scope.has(V)?new mn(V,I.scope.get(V)):I.error('Unknown variable "'+V+'". Make sure "'+V+'" has been bound in an enclosing "let" expression before using it.',1)},mn.prototype.evaluate=function(b){return this.boundExpression.evaluate(b)},mn.prototype.eachChild=function(){},mn.prototype.outputDefined=function(){return!1},mn.prototype.serialize=function(){return["var",this.name]};var hn=function(b,I,V,re,fe){I===void 0&&(I=[]),re===void 0&&(re=new It),fe===void 0&&(fe=[]),this.registry=b,this.path=I,this.key=I.map(function(ge){return"["+ge+"]"}).join(""),this.scope=re,this.errors=fe,this.expectedType=V};function Ln(b,I){for(var V,re,fe=b.length-1,ge=0,Ae=fe,ze=0;ge<=Ae;)if(V=b[ze=Math.floor((ge+Ae)/2)],re=b[ze+1],V<=I){if(ze===fe||I<re)return ze;ge=ze+1}else{if(!(V>I))throw new An("Input is not a number.");Ae=ze-1}return 0}hn.prototype.parse=function(b,I,V,re,fe){return fe===void 0&&(fe={}),I?this.concat(I,V,re)._parse(b,fe):this._parse(b,fe)},hn.prototype._parse=function(b,I){function V(st,pt,Rt){return Rt==="assert"?new Fr(pt,[st]):Rt==="coerce"?new Kr(pt,[st]):st}if(b!==null&&typeof b!="string"&&typeof b!="boolean"&&typeof b!="number"||(b=["literal",b]),Array.isArray(b)){if(b.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var re=b[0];if(typeof re!="string")return this.error("Expression name must be a string, but found "+typeof re+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var fe=this.registry[re];if(fe){var ge=fe.parse(b,this);if(!ge)return null;if(this.expectedType){var Ae=this.expectedType,ze=ge.type;if(Ae.kind!=="string"&&Ae.kind!=="number"&&Ae.kind!=="boolean"&&Ae.kind!=="object"&&Ae.kind!=="array"||ze.kind!=="value")if(Ae.kind!=="color"&&Ae.kind!=="formatted"&&Ae.kind!=="resolvedImage"||ze.kind!=="value"&&ze.kind!=="string"){if(this.checkSubtype(Ae,ze))return null}else ge=V(ge,Ae,I.typeAnnotation||"coerce");else ge=V(ge,Ae,I.typeAnnotation||"assert")}if(!(ge instanceof Pn)&&ge.type.kind!=="resolvedImage"&&function st(pt){if(pt instanceof mn)return st(pt.boundExpression);if(pt instanceof Mn&&pt.name==="error"||pt instanceof Rn||pt instanceof Zr)return!1;var Rt=pt instanceof Kr||pt instanceof Fr,Gt=!0;return pt.eachChild(function(Ut){Gt=Rt?Gt&&st(Ut):Gt&&Ut instanceof Pn}),Gt?yn(pt)&&Gr(pt,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"]):!1}(ge)){var Ze=new Tn;try{ge=new Pn(ge.type,ge.evaluate(Ze))}catch(st){return this.error(st.message),null}}return ge}return this.error('Unknown expression "'+re+'". If you wanted a literal array, use ["literal", [...]].',0)}return b===void 0?this.error("'undefined' value invalid. Use null instead."):typeof b=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found "+typeof b+" instead.")},hn.prototype.concat=function(b,I,V){var re=typeof b=="number"?this.path.concat(b):this.path,fe=V?this.scope.concat(V):this.scope;return new hn(this.registry,re,I||null,fe,this.errors)},hn.prototype.error=function(b){for(var I=[],V=arguments.length-1;V-- >0;)I[V]=arguments[V+1];var re=""+this.key+I.map(function(fe){return"["+fe+"]"}).join("");this.errors.push(new mt(re,b))},hn.prototype.checkSubtype=function(b,I){var V=Xt(b,I);return V&&this.error(V),V};var ia=function(b,I,V){this.type=b,this.input=I,this.labels=[],this.outputs=[];for(var re=0,fe=V;re<fe.length;re+=1){var ge=fe[re],Ae=ge[0],ze=ge[1];this.labels.push(Ae),this.outputs.push(ze)}};function qn(b,I,V){return b*(1-V)+I*V}ia.parse=function(b,I){if(b.length-1<4)return I.error("Expected at least 4 arguments, but found only "+(b.length-1)+".");if((b.length-1)%2!=0)return I.error("Expected an even number of arguments.");var V=I.parse(b[1],1,nt);if(!V)return null;var re=[],fe=null;I.expectedType&&I.expectedType.kind!=="value"&&(fe=I.expectedType);for(var ge=1;ge<b.length;ge+=2){var Ae=ge===1?-1/0:b[ge],ze=b[ge+1],Ze=ge,st=ge+1;if(typeof Ae!="number")return I.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Ze);if(re.length&&re[re.length-1][0]>=Ae)return I.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',Ze);var pt=I.parse(ze,st,fe);if(!pt)return null;fe=fe||pt.type,re.push([Ae,pt])}return new ia(fe,V,re)},ia.prototype.evaluate=function(b){var I=this.labels,V=this.outputs;if(I.length===1)return V[0].evaluate(b);var re=this.input.evaluate(b);if(re<=I[0])return V[0].evaluate(b);var fe=I.length;return re>=I[fe-1]?V[fe-1].evaluate(b):V[Ln(I,re)].evaluate(b)},ia.prototype.eachChild=function(b){b(this.input);for(var I=0,V=this.outputs;I<V.length;I+=1)b(V[I])},ia.prototype.outputDefined=function(){return this.outputs.every(function(b){return b.outputDefined()})},ia.prototype.serialize=function(){for(var b=["step",this.input.serialize()],I=0;I<this.labels.length;I++)I>0&&b.push(this.labels[I]),b.push(this.outputs[I].serialize());return b};var gn=Object.freeze({__proto__:null,number:qn,color:function(b,I,V){return new sr(qn(b.r,I.r,V),qn(b.g,I.g,V),qn(b.b,I.b,V),qn(b.a,I.a,V))},array:function(b,I,V){return b.map(function(re,fe){return qn(re,I[fe],V)})}}),ta=6/29,fa=3*ta*ta,Za=Math.PI/180,Pi=180/Math.PI;function ni(b){return b>.008856451679035631?Math.pow(b,1/3):b/fa+4/29}function yi(b){return b>ta?b*b*b:fa*(b-4/29)}function Aa(b){return 255*(b<=.0031308?12.92*b:1.055*Math.pow(b,1/2.4)-.055)}function ja(b){return(b/=255)<=.04045?b/12.92:Math.pow((b+.055)/1.055,2.4)}function co(b){var I=ja(b.r),V=ja(b.g),re=ja(b.b),fe=ni((.4124564*I+.3575761*V+.1804375*re)/.95047),ge=ni((.2126729*I+.7151522*V+.072175*re)/1);return{l:116*ge-16,a:500*(fe-ge),b:200*(ge-ni((.0193339*I+.119192*V+.9503041*re)/1.08883)),alpha:b.a}}function Bo(b){var I=(b.l+16)/116,V=isNaN(b.a)?I:I+b.a/500,re=isNaN(b.b)?I:I-b.b/200;return I=1*yi(I),V=.95047*yi(V),re=1.08883*yi(re),new sr(Aa(3.2404542*V-1.5371385*I-.4985314*re),Aa(-.969266*V+1.8760108*I+.041556*re),Aa(.0556434*V-.2040259*I+1.0572252*re),b.alpha)}function Wo(b,I,V){var re=I-b;return b+V*(re>180||re<-180?re-360*Math.round(re/360):re)}var qi={forward:co,reverse:Bo,interpolate:function(b,I,V){return{l:qn(b.l,I.l,V),a:qn(b.a,I.a,V),b:qn(b.b,I.b,V),alpha:qn(b.alpha,I.alpha,V)}}},Wi={forward:function(b){var I=co(b),V=I.l,re=I.a,fe=I.b,ge=Math.atan2(fe,re)*Pi;return{h:ge<0?ge+360:ge,c:Math.sqrt(re*re+fe*fe),l:V,alpha:b.a}},reverse:function(b){var I=b.h*Za,V=b.c;return Bo({l:b.l,a:Math.cos(I)*V,b:Math.sin(I)*V,alpha:b.alpha})},interpolate:function(b,I,V){return{h:Wo(b.h,I.h,V),c:qn(b.c,I.c,V),l:qn(b.l,I.l,V),alpha:qn(b.alpha,I.alpha,V)}}},No=Object.freeze({__proto__:null,lab:qi,hcl:Wi}),Ha=function(b,I,V,re,fe){this.type=b,this.operator=I,this.interpolation=V,this.input=re,this.labels=[],this.outputs=[];for(var ge=0,Ae=fe;ge<Ae.length;ge+=1){var ze=Ae[ge],Ze=ze[0],st=ze[1];this.labels.push(Ze),this.outputs.push(st)}};function ko(b,I,V,re){var fe=re-V,ge=b-V;return fe===0?0:I===1?ge/fe:(Math.pow(I,ge)-1)/(Math.pow(I,fe)-1)}Ha.interpolationFactor=function(b,I,V,re){var fe=0;if(b.name==="exponential")fe=ko(I,b.base,V,re);else if(b.name==="linear")fe=ko(I,1,V,re);else if(b.name==="cubic-bezier"){var ge=b.controlPoints;fe=new u(ge[0],ge[1],ge[2],ge[3]).solve(ko(I,1,V,re))}return fe},Ha.parse=function(b,I){var V=b[0],re=b[1],fe=b[2],ge=b.slice(3);if(!Array.isArray(re)||re.length===0)return I.error("Expected an interpolation type expression.",1);if(re[0]==="linear")re={name:"linear"};else if(re[0]==="exponential"){var Ae=re[1];if(typeof Ae!="number")return I.error("Exponential interpolation requires a numeric base.",1,1);re={name:"exponential",base:Ae}}else{if(re[0]!=="cubic-bezier")return I.error("Unknown interpolation type "+String(re[0]),1,0);var ze=re.slice(1);if(ze.length!==4||ze.some(function(Sr){return typeof Sr!="number"||Sr<0||Sr>1}))return I.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);re={name:"cubic-bezier",controlPoints:ze}}if(b.length-1<4)return I.error("Expected at least 4 arguments, but found only "+(b.length-1)+".");if((b.length-1)%2!=0)return I.error("Expected an even number of arguments.");if(!(fe=I.parse(fe,2,nt)))return null;var Ze=[],st=null;V==="interpolate-hcl"||V==="interpolate-lab"?st=Nt:I.expectedType&&I.expectedType.kind!=="value"&&(st=I.expectedType);for(var pt=0;pt<ge.length;pt+=2){var Rt=ge[pt],Gt=ge[pt+1],Ut=pt+3,rr=pt+4;if(typeof Rt!="number")return I.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Ut);if(Ze.length&&Ze[Ze.length-1][0]>=Rt)return I.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Ut);var pr=I.parse(Gt,rr,st);if(!pr)return null;st=st||pr.type,Ze.push([Rt,pr])}return st.kind==="number"||st.kind==="color"||st.kind==="array"&&st.itemType.kind==="number"&&typeof st.N=="number"?new Ha(st,V,re,fe,Ze):I.error("Type "+nr(st)+" is not interpolatable.")},Ha.prototype.evaluate=function(b){var I=this.labels,V=this.outputs;if(I.length===1)return V[0].evaluate(b);var re=this.input.evaluate(b);if(re<=I[0])return V[0].evaluate(b);var fe=I.length;if(re>=I[fe-1])return V[fe-1].evaluate(b);var ge=Ln(I,re),Ae=I[ge],ze=I[ge+1],Ze=Ha.interpolationFactor(this.interpolation,re,Ae,ze),st=V[ge].evaluate(b),pt=V[ge+1].evaluate(b);return this.operator==="interpolate"?gn[this.type.kind.toLowerCase()](st,pt,Ze):this.operator==="interpolate-hcl"?Wi.reverse(Wi.interpolate(Wi.forward(st),Wi.forward(pt),Ze)):qi.reverse(qi.interpolate(qi.forward(st),qi.forward(pt),Ze))},Ha.prototype.eachChild=function(b){b(this.input);for(var I=0,V=this.outputs;I<V.length;I+=1)b(V[I])},Ha.prototype.outputDefined=function(){return this.outputs.every(function(b){return b.outputDefined()})},Ha.prototype.serialize=function(){var b;b=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var I=[this.operator,b,this.input.serialize()],V=0;V<this.labels.length;V++)I.push(this.labels[V],this.outputs[V].serialize());return I};var uo=function(b,I){this.type=b,this.args=I};uo.parse=function(b,I){if(b.length<2)return I.error("Expectected at least one argument.");var V=null,re=I.expectedType;re&&re.kind!=="value"&&(V=re);for(var fe=[],ge=0,Ae=b.slice(1);ge<Ae.length;ge+=1){var ze=Ae[ge],Ze=I.parse(ze,1+fe.length,V,void 0,{typeAnnotation:"omit"});if(!Ze)return null;V=V||Ze.type,fe.push(Ze)}var st=re&&fe.some(function(pt){return Xt(re,pt.type)});return new uo(st?Ie:V,fe)},uo.prototype.evaluate=function(b){for(var I,V=null,re=0,fe=0,ge=this.args;fe<ge.length&&(re++,(V=ge[fe].evaluate(b))&&V instanceof xr&&!V.available&&(I||(I=V.name),V=null,re===this.args.length&&(V=I)),V===null);fe+=1);return V},uo.prototype.eachChild=function(b){this.args.forEach(b)},uo.prototype.outputDefined=function(){return this.args.every(function(b){return b.outputDefined()})},uo.prototype.serialize=function(){var b=["coalesce"];return this.eachChild(function(I){b.push(I.serialize())}),b};var xi=function(b,I){this.type=I.type,this.bindings=[].concat(b),this.result=I};xi.prototype.evaluate=function(b){return this.result.evaluate(b)},xi.prototype.eachChild=function(b){for(var I=0,V=this.bindings;I<V.length;I+=1)b(V[I][1]);b(this.result)},xi.parse=function(b,I){if(b.length<4)return I.error("Expected at least 3 arguments, but found "+(b.length-1)+" instead.");for(var V=[],re=1;re<b.length-1;re+=2){var fe=b[re];if(typeof fe!="string")return I.error("Expected string, but found "+typeof fe+" instead.",re);if(/[^a-zA-Z0-9_]/.test(fe))return I.error("Variable names must contain only alphanumeric characters or '_'.",re);var ge=I.parse(b[re+1],re+1);if(!ge)return null;V.push([fe,ge])}var Ae=I.parse(b[b.length-1],b.length-1,I.expectedType,V);return Ae?new xi(V,Ae):null},xi.prototype.outputDefined=function(){return this.result.outputDefined()},xi.prototype.serialize=function(){for(var b=["let"],I=0,V=this.bindings;I<V.length;I+=1){var re=V[I],fe=re[0],ge=re[1];b.push(fe,ge.serialize())}return b.push(this.result.serialize()),b};var Xi=function(b,I,V){this.type=b,this.index=I,this.input=V};Xi.parse=function(b,I){if(b.length!==3)return I.error("Expected 2 arguments, but found "+(b.length-1)+" instead.");var V=I.parse(b[1],1,nt),re=I.parse(b[2],2,Vt(I.expectedType||Ie));if(!V||!re)return null;var fe=re.type;return new Xi(fe.itemType,V,re)},Xi.prototype.evaluate=function(b){var I=this.index.evaluate(b),V=this.input.evaluate(b);if(I<0)throw new An("Array index out of bounds: "+I+" < 0.");if(I>=V.length)throw new An("Array index out of bounds: "+I+" > "+(V.length-1)+".");if(I!==Math.floor(I))throw new An("Array index must be an integer, but found "+I+" instead.");return V[I]},Xi.prototype.eachChild=function(b){b(this.index),b(this.input)},Xi.prototype.outputDefined=function(){return!1},Xi.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var fo=function(b,I){this.type=Ft,this.needle=b,this.haystack=I};fo.parse=function(b,I){if(b.length!==3)return I.error("Expected 2 arguments, but found "+(b.length-1)+" instead.");var V=I.parse(b[1],1,Ie),re=I.parse(b[2],2,Ie);return V&&re?ar(V.type,[Ft,At,nt,vt,Ie])?new fo(V,re):I.error("Expected first argument to be of type boolean, string, number or null, but found "+nr(V.type)+" instead"):null},fo.prototype.evaluate=function(b){var I=this.needle.evaluate(b),V=this.haystack.evaluate(b);if(!V)return!1;if(!hr(I,["boolean","string","number","null"]))throw new An("Expected first argument to be of type boolean, string, number or null, but found "+nr(fn(I))+" instead.");if(!hr(V,["string","array"]))throw new An("Expected second argument to be of type array or string, but found "+nr(fn(V))+" instead.");return V.indexOf(I)>=0},fo.prototype.eachChild=function(b){b(this.needle),b(this.haystack)},fo.prototype.outputDefined=function(){return!0},fo.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var _o=function(b,I,V){this.type=nt,this.needle=b,this.haystack=I,this.fromIndex=V};_o.parse=function(b,I){if(b.length<=2||b.length>=5)return I.error("Expected 3 or 4 arguments, but found "+(b.length-1)+" instead.");var V=I.parse(b[1],1,Ie),re=I.parse(b[2],2,Ie);if(!V||!re)return null;if(!ar(V.type,[Ft,At,nt,vt,Ie]))return I.error("Expected first argument to be of type boolean, string, number or null, but found "+nr(V.type)+" instead");if(b.length===4){var fe=I.parse(b[3],3,nt);return fe?new _o(V,re,fe):null}return new _o(V,re)},_o.prototype.evaluate=function(b){var I=this.needle.evaluate(b),V=this.haystack.evaluate(b);if(!hr(I,["boolean","string","number","null"]))throw new An("Expected first argument to be of type boolean, string, number or null, but found "+nr(fn(I))+" instead.");if(!hr(V,["string","array"]))throw new An("Expected second argument to be of type array or string, but found "+nr(fn(V))+" instead.");if(this.fromIndex){var re=this.fromIndex.evaluate(b);return V.indexOf(I,re)}return V.indexOf(I)},_o.prototype.eachChild=function(b){b(this.needle),b(this.haystack),this.fromIndex&&b(this.fromIndex)},_o.prototype.outputDefined=function(){return!1},_o.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var b=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),b]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Di=function(b,I,V,re,fe,ge){this.inputType=b,this.type=I,this.input=V,this.cases=re,this.outputs=fe,this.otherwise=ge};Di.parse=function(b,I){if(b.length<5)return I.error("Expected at least 4 arguments, but found only "+(b.length-1)+".");if(b.length%2!=1)return I.error("Expected an even number of arguments.");var V,re;I.expectedType&&I.expectedType.kind!=="value"&&(re=I.expectedType);for(var fe={},ge=[],Ae=2;Ae<b.length-1;Ae+=2){var ze=b[Ae],Ze=b[Ae+1];Array.isArray(ze)||(ze=[ze]);var st=I.concat(Ae);if(ze.length===0)return st.error("Expected at least one branch label.");for(var pt=0,Rt=ze;pt<Rt.length;pt+=1){var Gt=Rt[pt];if(typeof Gt!="number"&&typeof Gt!="string")return st.error("Branch labels must be numbers or strings.");if(typeof Gt=="number"&&Math.abs(Gt)>Number.MAX_SAFE_INTEGER)return st.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof Gt=="number"&&Math.floor(Gt)!==Gt)return st.error("Numeric branch labels must be integer values.");if(V){if(st.checkSubtype(V,fn(Gt)))return null}else V=fn(Gt);if(fe[String(Gt)]!==void 0)return st.error("Branch labels must be unique.");fe[String(Gt)]=ge.length}var Ut=I.parse(Ze,Ae,re);if(!Ut)return null;re=re||Ut.type,ge.push(Ut)}var rr=I.parse(b[1],1,Ie);if(!rr)return null;var pr=I.parse(b[b.length-1],b.length-1,re);return pr?rr.type.kind!=="value"&&I.concat(1).checkSubtype(V,rr.type)?null:new Di(V,re,rr,fe,ge,pr):null},Di.prototype.evaluate=function(b){var I=this.input.evaluate(b);return(fn(I)===this.inputType&&this.outputs[this.cases[I]]||this.otherwise).evaluate(b)},Di.prototype.eachChild=function(b){b(this.input),this.outputs.forEach(b),b(this.otherwise)},Di.prototype.outputDefined=function(){return this.outputs.every(function(b){return b.outputDefined()})&&this.otherwise.outputDefined()},Di.prototype.serialize=function(){for(var b=this,I=["match",this.input.serialize()],V=[],re={},fe=0,ge=Object.keys(this.cases).sort();fe<ge.length;fe+=1){var Ae=ge[fe];(Rt=re[this.cases[Ae]])===void 0?(re[this.cases[Ae]]=V.length,V.push([this.cases[Ae],[Ae]])):V[Rt][1].push(Ae)}for(var ze=function(Ut){return b.inputType.kind==="number"?Number(Ut):Ut},Ze=0,st=V;Ze<st.length;Ze+=1){var pt=st[Ze],Rt=pt[0],Gt=pt[1];Gt.length===1?I.push(ze(Gt[0])):I.push(Gt.map(ze)),I.push(this.outputs[outputIndex$1].serialize())}return I.push(this.otherwise.serialize()),I};var fi=function(b,I,V){this.type=b,this.branches=I,this.otherwise=V};fi.parse=function(b,I){if(b.length<4)return I.error("Expected at least 3 arguments, but found only "+(b.length-1)+".");if(b.length%2!=0)return I.error("Expected an odd number of arguments.");var V;I.expectedType&&I.expectedType.kind!=="value"&&(V=I.expectedType);for(var re=[],fe=1;fe<b.length-1;fe+=2){var ge=I.parse(b[fe],fe,Ft);if(!ge)return null;var Ae=I.parse(b[fe+1],fe+1,V);if(!Ae)return null;re.push([ge,Ae]),V=V||Ae.type}var ze=I.parse(b[b.length-1],b.length-1,V);return ze?new fi(V,re,ze):null},fi.prototype.evaluate=function(b){for(var I=0,V=this.branches;I<V.length;I+=1){var re=V[I],fe=re[0],ge=re[1];if(fe.evaluate(b))return ge.evaluate(b)}return this.otherwise.evaluate(b)},fi.prototype.eachChild=function(b){for(var I=0,V=this.branches;I<V.length;I+=1){var re=V[I],fe=re[0],ge=re[1];b(fe),b(ge)}b(this.otherwise)},fi.prototype.outputDefined=function(){return this.branches.every(function(b){return b[0],b[1].outputDefined()})&&this.otherwise.outputDefined()},fi.prototype.serialize=function(){var b=["case"];return this.eachChild(function(I){b.push(I.serialize())}),b};var Gi=function(b,I,V,re){this.type=b,this.input=I,this.beginIndex=V,this.endIndex=re};function ys(b,I){return b==="=="||b==="!="?I.kind==="boolean"||I.kind==="string"||I.kind==="number"||I.kind==="null"||I.kind==="value":I.kind==="string"||I.kind==="number"||I.kind==="value"}function ws(b,I,V,re){return re.compare(I,V)===0}function qa(b,I,V){var re=b!=="=="&&b!=="!=";return function(){function fe(ge,Ae,ze){this.type=Ft,this.lhs=ge,this.rhs=Ae,this.collator=ze,this.hasUntypedArgument=ge.type.kind==="value"||Ae.type.kind==="value"}return fe.parse=function(ge,Ae){if(ge.length!==3&&ge.length!==4)return Ae.error("Expected two or three arguments.");var ze=ge[0],Ze=Ae.parse(ge[1],1,Ie);if(!Ze)return null;if(!ys(ze,Ze.type))return Ae.concat(1).error('"'+ze+`" comparisons are not supported for type '`+nr(Ze.type)+"'.");var st=Ae.parse(ge[2],2,Ie);if(!st)return null;if(!ys(ze,st.type))return Ae.concat(2).error('"'+ze+`" comparisons are not supported for type '`+nr(st.type)+"'.");if(Ze.type.kind!==st.type.kind&&Ze.type.kind!=="value"&&st.type.kind!=="value")return Ae.error("Cannot compare types '"+nr(Ze.type)+"' and '"+nr(st.type)+"'.");re&&(Ze.type.kind==="value"&&st.type.kind!=="value"?Ze=new Fr(st.type,[Ze]):Ze.type.kind!=="value"&&st.type.kind==="value"&&(st=new Fr(Ze.type,[st])));var pt=null;if(ge.length===4){if(Ze.type.kind!=="string"&&st.type.kind!=="string"&&Ze.type.kind!=="value"&&st.type.kind!=="value")return Ae.error("Cannot use collator to compare non-string types.");if(!(pt=Ae.parse(ge[3],3,ot)))return null}return new fe(Ze,st,pt)},fe.prototype.evaluate=function(ge){var Ae=this.lhs.evaluate(ge),ze=this.rhs.evaluate(ge);if(re&&this.hasUntypedArgument){var Ze=fn(Ae),st=fn(ze);if(Ze.kind!==st.kind||Ze.kind!=="string"&&Ze.kind!=="number")throw new An('Expected arguments for "'+b+'" to be (string, string) or (number, number), but found ('+Ze.kind+", "+st.kind+") instead.")}if(this.collator&&!re&&this.hasUntypedArgument){var pt=fn(Ae),Rt=fn(ze);if(pt.kind!=="string"||Rt.kind!=="string")return I(ge,Ae,ze)}return this.collator?V(ge,Ae,ze,this.collator.evaluate(ge)):I(ge,Ae,ze)},fe.prototype.eachChild=function(ge){ge(this.lhs),ge(this.rhs),this.collator&&ge(this.collator)},fe.prototype.outputDefined=function(){return!0},fe.prototype.serialize=function(){var ge=[b];return this.eachChild(function(Ae){ge.push(Ae.serialize())}),ge},fe}()}Gi.parse=function(b,I){if(b.length<=2||b.length>=5)return I.error("Expected 3 or 4 arguments, but found "+(b.length-1)+" instead.");var V=I.parse(b[1],1,Ie),re=I.parse(b[2],2,nt);if(!V||!re)return null;if(!ar(V.type,[Vt(Ie),At,Ie]))return I.error("Expected first argument to be of type array or string, but found "+nr(V.type)+" instead");if(b.length===4){var fe=I.parse(b[3],3,nt);return fe?new Gi(V.type,V,re,fe):null}return new Gi(V.type,V,re)},Gi.prototype.evaluate=function(b){var I=this.input.evaluate(b),V=this.beginIndex.evaluate(b);if(!hr(I,["string","array"]))throw new An("Expected first argument to be of type array or string, but found "+nr(fn(I))+" instead.");if(this.endIndex){var re=this.endIndex.evaluate(b);return I.slice(V,re)}return I.slice(V)},Gi.prototype.eachChild=function(b){b(this.input),b(this.beginIndex),this.endIndex&&b(this.endIndex)},Gi.prototype.outputDefined=function(){return!1},Gi.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var b=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),b]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var hs=qa("==",function(b,I,V){return I===V},ws),Qo=qa("!=",function(b,I,V){return I!==V},function(b,I,V,re){return!ws(0,I,V,re)}),Ts=qa("<",function(b,I,V){return I<V},function(b,I,V,re){return re.compare(I,V)<0}),ks=qa(">",function(b,I,V){return I>V},function(b,I,V,re){return re.compare(I,V)>0}),xs=qa("<=",function(b,I,V){return I<=V},function(b,I,V,re){return re.compare(I,V)<=0}),As=qa(">=",function(b,I,V){return I>=V},function(b,I,V,re){return re.compare(I,V)>=0}),Ao=function(b,I,V,re,fe){this.type=At,this.number=b,this.locale=I,this.currency=V,this.minFractionDigits=re,this.maxFractionDigits=fe};Ao.parse=function(b,I){if(b.length!==3)return I.error("Expected two arguments.");var V=I.parse(b[1],1,nt);if(!V)return null;var re=b[2];if(typeof re!="object"||Array.isArray(re))return I.error("NumberFormat options argument must be an object.");var fe=null;if(re.locale&&!(fe=I.parse(re.locale,1,At)))return null;var ge=null;if(re.currency&&!(ge=I.parse(re.currency,1,At)))return null;var Ae=null;if(re["min-fraction-digits"]&&!(Ae=I.parse(re["min-fraction-digits"],1,nt)))return null;var ze=null;return re["max-fraction-digits"]&&!(ze=I.parse(re["max-fraction-digits"],1,nt))?null:new Ao(V,fe,ge,Ae,ze)},Ao.prototype.evaluate=function(b){return new Intl.NumberFormat(this.locale?this.locale.evaluate(b):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(b):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(b):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(b):void 0}).format(this.number.evaluate(b))},Ao.prototype.eachChild=function(b){b(this.number),this.locale&&b(this.locale),this.currency&&b(this.currency),this.minFractionDigits&&b(this.minFractionDigits),this.maxFractionDigits&&b(this.maxFractionDigits)},Ao.prototype.outputDefined=function(){return!1},Ao.prototype.serialize=function(){var b={};return this.locale&&(b.locale=this.locale.serialize()),this.currency&&(b.currency=this.currency.serialize()),this.minFractionDigits&&(b["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(b["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),b]};var Mo=function(b){this.type=nt,this.input=b};Mo.parse=function(b,I){if(b.length!==2)return I.error("Expected 1 argument, but found "+(b.length-1)+" instead.");var V=I.parse(b[1],1);return V?V.type.kind!=="array"&&V.type.kind!=="string"&&V.type.kind!=="value"?I.error("Expected argument of type string or array, but found "+nr(V.type)+" instead."):new Mo(V):null},Mo.prototype.evaluate=function(b){var I=this.input.evaluate(b);if(typeof I=="string"||Array.isArray(I))return I.length;throw new An("Expected value to be of type string or array, but found "+nr(fn(I))+" instead.")},Mo.prototype.eachChild=function(b){b(this.input)},Mo.prototype.outputDefined=function(){return!1},Mo.prototype.serialize=function(){var b=["length"];return this.eachChild(function(I){b.push(I.serialize())}),b};var jo={"==":hs,"!=":Qo,">":ks,"<":Ts,">=":As,"<=":xs,array:Fr,at:Xi,boolean:Fr,case:fi,coalesce:uo,collator:Rn,format:Lr,image:Qr,in:fo,"index-of":_o,interpolate:Ha,"interpolate-hcl":Ha,"interpolate-lab":Ha,length:Mo,let:xi,literal:Pn,match:Di,number:Fr,"number-format":Ao,object:Fr,slice:Gi,step:ia,string:Fr,"to-boolean":Kr,"to-color":Kr,"to-number":Kr,"to-string":Kr,var:mn,within:Zr};function Uo(b,I){var V=I[0],re=I[1],fe=I[2],ge=I[3];V=V.evaluate(b),re=re.evaluate(b),fe=fe.evaluate(b);var Ae=ge?ge.evaluate(b):1,ze=Br(V,re,fe,Ae);if(ze)throw new An(ze);return new sr(V/255*Ae,re/255*Ae,fe/255*Ae,Ae)}function Vo(b,I){return b in I}function $o(b,I){var V=I[b];return V===void 0?null:V}function ho(b){return{type:b}}function ps(b){return{result:"success",value:b}}function oo(b){return{result:"error",value:b}}function Ho(b){return b["property-type"]==="data-driven"||b["property-type"]==="cross-faded-data-driven"}function ds(b){return!!b.expression&&b.expression.parameters.indexOf("zoom")>-1}function So(b){return!!b.expression&&b.expression.interpolated}function Ua(b){return b instanceof Number?"number":b instanceof String?"string":b instanceof Boolean?"boolean":Array.isArray(b)?"array":b===null?"null":typeof b}function Re(b){return typeof b=="object"&&b!==null&&!Array.isArray(b)}function Ve(b){return b}function Ke(b,I,V){return b!==void 0?b:I!==void 0?I:V!==void 0?V:void 0}function at(b,I,V,re,fe){return Ke(typeof V===fe?re[V]:void 0,b.default,I.default)}function dt(b,I,V){if(Ua(V)!=="number")return Ke(b.default,I.default);var re=b.stops.length;if(re===1||V<=b.stops[0][0])return b.stops[0][1];if(V>=b.stops[re-1][0])return b.stops[re-1][1];var fe=Ln(b.stops.map(function(ge){return ge[0]}),V);return b.stops[fe][1]}function ht(b,I,V){var re=b.base!==void 0?b.base:1;if(Ua(V)!=="number")return Ke(b.default,I.default);var fe=b.stops.length;if(fe===1||V<=b.stops[0][0])return b.stops[0][1];if(V>=b.stops[fe-1][0])return b.stops[fe-1][1];var ge=Ln(b.stops.map(function(Rt){return Rt[0]}),V),Ae=function(Rt,Gt,Ut,rr){var pr=rr-Ut,Sr=Rt-Ut;return pr===0?0:Gt===1?Sr/pr:(Math.pow(Gt,Sr)-1)/(Math.pow(Gt,pr)-1)}(V,re,b.stops[ge][0],b.stops[ge+1][0]),ze=b.stops[ge][1],Ze=b.stops[ge+1][1],st=gn[I.type]||Ve;if(b.colorSpace&&b.colorSpace!=="rgb"){var pt=No[b.colorSpace];st=function(Rt,Gt){return pt.reverse(pt.interpolate(pt.forward(Rt),pt.forward(Gt),Ae))}}return typeof ze.evaluate=="function"?{evaluate:function(){for(var Rt=[],Gt=arguments.length;Gt--;)Rt[Gt]=arguments[Gt];var Ut=ze.evaluate.apply(void 0,Rt),rr=Ze.evaluate.apply(void 0,Rt);if(Ut!==void 0&&rr!==void 0)return st(Ut,rr,Ae)}}:st(ze,Ze,Ae)}function Mt(b,I,V){return I.type==="color"?V=sr.parse(V):I.type==="formatted"?V=zr.fromString(V.toString()):I.type==="resolvedImage"?V=xr.fromString(V.toString()):Ua(V)===I.type||I.type==="enum"&&I.values[V]||(V=void 0),Ke(V,b.default,I.default)}Mn.register(jo,{error:[{kind:"error"},[At],function(b,I){var V=I[0];throw new An(V.evaluate(b))}],typeof:[At,[Ie],function(b,I){return nr(fn(I[0].evaluate(b)))}],"to-rgba":[Vt(nt,4),[Nt],function(b,I){return I[0].evaluate(b).toArray()}],rgb:[Nt,[nt,nt,nt],Uo],rgba:[Nt,[nt,nt,nt,nt],Uo],has:{type:Ft,overloads:[[[At],function(b,I){return Vo(I[0].evaluate(b),b.properties())}],[[At,Kt],function(b,I){var V=I[0],re=I[1];return Vo(V.evaluate(b),re.evaluate(b))}]]},get:{type:Ie,overloads:[[[At],function(b,I){return $o(I[0].evaluate(b),b.properties())}],[[At,Kt],function(b,I){var V=I[0],re=I[1];return $o(V.evaluate(b),re.evaluate(b))}]]},"feature-state":[Ie,[At],function(b,I){return $o(I[0].evaluate(b),b.featureState||{})}],properties:[Kt,[],function(b){return b.properties()}],"geometry-type":[At,[],function(b){return b.geometryType()}],id:[Ie,[],function(b){return b.id()}],zoom:[nt,[],function(b){return b.globals.zoom}],"heatmap-density":[nt,[],function(b){return b.globals.heatmapDensity||0}],"line-progress":[nt,[],function(b){return b.globals.lineProgress||0}],accumulated:[Ie,[],function(b){return b.globals.accumulated===void 0?null:b.globals.accumulated}],"+":[nt,ho(nt),function(b,I){for(var V=0,re=0,fe=I;re<fe.length;re+=1)V+=fe[re].evaluate(b);return V}],"*":[nt,ho(nt),function(b,I){for(var V=1,re=0,fe=I;re<fe.length;re+=1)V*=fe[re].evaluate(b);return V}],"-":{type:nt,overloads:[[[nt,nt],function(b,I){var V=I[0],re=I[1];return V.evaluate(b)-re.evaluate(b)}],[[nt],function(b,I){return-I[0].evaluate(b)}]]},"/":[nt,[nt,nt],function(b,I){var V=I[0],re=I[1];return V.evaluate(b)/re.evaluate(b)}],"%":[nt,[nt,nt],function(b,I){var V=I[0],re=I[1];return V.evaluate(b)%re.evaluate(b)}],ln2:[nt,[],function(){return Math.LN2}],pi:[nt,[],function(){return Math.PI}],e:[nt,[],function(){return Math.E}],"^":[nt,[nt,nt],function(b,I){var V=I[0],re=I[1];return Math.pow(V.evaluate(b),re.evaluate(b))}],sqrt:[nt,[nt],function(b,I){var V=I[0];return Math.sqrt(V.evaluate(b))}],log10:[nt,[nt],function(b,I){var V=I[0];return Math.log(V.evaluate(b))/Math.LN10}],ln:[nt,[nt],function(b,I){var V=I[0];return Math.log(V.evaluate(b))}],log2:[nt,[nt],function(b,I){var V=I[0];return Math.log(V.evaluate(b))/Math.LN2}],sin:[nt,[nt],function(b,I){var V=I[0];return Math.sin(V.evaluate(b))}],cos:[nt,[nt],function(b,I){var V=I[0];return Math.cos(V.evaluate(b))}],tan:[nt,[nt],function(b,I){var V=I[0];return Math.tan(V.evaluate(b))}],asin:[nt,[nt],function(b,I){var V=I[0];return Math.asin(V.evaluate(b))}],acos:[nt,[nt],function(b,I){var V=I[0];return Math.acos(V.evaluate(b))}],atan:[nt,[nt],function(b,I){var V=I[0];return Math.atan(V.evaluate(b))}],min:[nt,ho(nt),function(b,I){return Math.min.apply(Math,I.map(function(V){return V.evaluate(b)}))}],max:[nt,ho(nt),function(b,I){return Math.max.apply(Math,I.map(function(V){return V.evaluate(b)}))}],abs:[nt,[nt],function(b,I){var V=I[0];return Math.abs(V.evaluate(b))}],round:[nt,[nt],function(b,I){var V=I[0].evaluate(b);return V<0?-Math.round(-V):Math.round(V)}],floor:[nt,[nt],function(b,I){var V=I[0];return Math.floor(V.evaluate(b))}],ceil:[nt,[nt],function(b,I){var V=I[0];return Math.ceil(V.evaluate(b))}],"filter-==":[Ft,[At,Ie],function(b,I){var V=I[0],re=I[1];return b.properties()[V.value]===re.value}],"filter-id-==":[Ft,[Ie],function(b,I){var V=I[0];return b.id()===V.value}],"filter-type-==":[Ft,[At],function(b,I){var V=I[0];return b.geometryType()===V.value}],"filter-<":[Ft,[At,Ie],function(b,I){var V=I[0],re=I[1],fe=b.properties()[V.value],ge=re.value;return typeof fe==typeof ge&&fe<ge}],"filter-id-<":[Ft,[Ie],function(b,I){var V=I[0],re=b.id(),fe=V.value;return typeof re==typeof fe&&re<fe}],"filter->":[Ft,[At,Ie],function(b,I){var V=I[0],re=I[1],fe=b.properties()[V.value],ge=re.value;return typeof fe==typeof ge&&fe>ge}],"filter-id->":[Ft,[Ie],function(b,I){var V=I[0],re=b.id(),fe=V.value;return typeof re==typeof fe&&re>fe}],"filter-<=":[Ft,[At,Ie],function(b,I){var V=I[0],re=I[1],fe=b.properties()[V.value],ge=re.value;return typeof fe==typeof ge&&fe<=ge}],"filter-id-<=":[Ft,[Ie],function(b,I){var V=I[0],re=b.id(),fe=V.value;return typeof re==typeof fe&&re<=fe}],"filter->=":[Ft,[At,Ie],function(b,I){var V=I[0],re=I[1],fe=b.properties()[V.value],ge=re.value;return typeof fe==typeof ge&&fe>=ge}],"filter-id->=":[Ft,[Ie],function(b,I){var V=I[0],re=b.id(),fe=V.value;return typeof re==typeof fe&&re>=fe}],"filter-has":[Ft,[Ie],function(b,I){return I[0].value in b.properties()}],"filter-has-id":[Ft,[],function(b){return b.id()!==null&&b.id()!==void 0}],"filter-type-in":[Ft,[Vt(At)],function(b,I){return I[0].value.indexOf(b.geometryType())>=0}],"filter-id-in":[Ft,[Vt(Ie)],function(b,I){return I[0].value.indexOf(b.id())>=0}],"filter-in-small":[Ft,[At,Vt(Ie)],function(b,I){var V=I[0];return I[1].value.indexOf(b.properties()[V.value])>=0}],"filter-in-large":[Ft,[At,Vt(Ie)],function(b,I){var V=I[0],re=I[1];return function(fe,ge,Ae,ze){for(;Ae<=ze;){var Ze=Ae+ze>>1;if(ge[Ze]===fe)return!0;ge[Ze]>fe?ze=Ze-1:Ae=Ze+1}return!1}(b.properties()[V.value],re.value,0,re.value.length-1)}],all:{type:Ft,overloads:[[[Ft,Ft],function(b,I){var V=I[0],re=I[1];return V.evaluate(b)&&re.evaluate(b)}],[ho(Ft),function(b,I){for(var V=0,re=I;V<re.length;V+=1)if(!re[V].evaluate(b))return!1;return!0}]]},any:{type:Ft,overloads:[[[Ft,Ft],function(b,I){var V=I[0],re=I[1];return V.evaluate(b)||re.evaluate(b)}],[ho(Ft),function(b,I){for(var V=0,re=I;V<re.length;V+=1)if(re[V].evaluate(b))return!0;return!1}]]},"!":[Ft,[Ft],function(b,I){return!I[0].evaluate(b)}],"is-supported-script":[Ft,[At],function(b,I){var V=I[0],re=b.globals&&b.globals.isSupportedScript;return!re||re(V.evaluate(b))}],upcase:[At,[At],function(b,I){return I[0].evaluate(b).toUpperCase()}],downcase:[At,[At],function(b,I){return I[0].evaluate(b).toLowerCase()}],concat:[At,ho(Ie),function(b,I){return I.map(function(V){return Cn(V.evaluate(b))}).join("")}],"resolved-locale":[At,[ot],function(b,I){return I[0].evaluate(b).resolvedLocale()}]});var Wt=function(b,I){this.expression=b,this._warningHistory={},this._evaluator=new Tn,this._defaultValue=I?function(V){return V.type==="color"&&Re(V.default)?new sr(0,0,0,0):V.type==="color"?sr.parse(V.default)||null:V.default===void 0?null:V.default}(I):null,this._enumValues=I&&I.type==="enum"?I.values:null};function Jt(b){return Array.isArray(b)&&b.length>0&&typeof b[0]=="string"&&b[0]in jo}function qt(b,I){var V=new hn(jo,[],I?function(fe){var ge={color:Nt,string:At,number:nt,enum:At,boolean:Ft,formatted:bt,resolvedImage:Pt};return fe.type==="array"?Vt(ge[fe.value]||Ie,fe.length):ge[fe.type]}(I):void 0),re=V.parse(b,void 0,void 0,void 0,I&&I.type==="string"?{typeAnnotation:"coerce"}:void 0);return re?ps(new Wt(re,I)):oo(V.errors)}Wt.prototype.evaluateWithoutErrorHandling=function(b,I,V,re,fe,ge){return this._evaluator.globals=b,this._evaluator.feature=I,this._evaluator.featureState=V,this._evaluator.canonical=re,this._evaluator.availableImages=fe||null,this._evaluator.formattedSection=ge,this.expression.evaluate(this._evaluator)},Wt.prototype.evaluate=function(b,I,V,re,fe,ge){this._evaluator.globals=b,this._evaluator.feature=I||null,this._evaluator.featureState=V||null,this._evaluator.canonical=re,this._evaluator.availableImages=fe||null,this._evaluator.formattedSection=ge||null;try{var Ae=this.expression.evaluate(this._evaluator);if(Ae==null||typeof Ae=="number"&&Ae!=Ae)return this._defaultValue;if(this._enumValues&&!(Ae in this._enumValues))throw new An("Expected value to be one of "+Object.keys(this._enumValues).map(function(ze){return JSON.stringify(ze)}).join(", ")+", but found "+JSON.stringify(Ae)+" instead.");return Ae}catch(ze){return this._warningHistory[ze.message]||(this._warningHistory[ze.message]=!0,typeof console!="undefined"&&console.warn(ze.message)),this._defaultValue}};var tr=function(b,I){this.kind=b,this._styleExpression=I,this.isStateDependent=b!=="constant"&&!Ir(I.expression)};tr.prototype.evaluateWithoutErrorHandling=function(b,I,V,re,fe,ge){return this._styleExpression.evaluateWithoutErrorHandling(b,I,V,re,fe,ge)},tr.prototype.evaluate=function(b,I,V,re,fe,ge){return this._styleExpression.evaluate(b,I,V,re,fe,ge)};var lr=function(b,I,V,re){this.kind=b,this.zoomStops=V,this._styleExpression=I,this.isStateDependent=b!=="camera"&&!Ir(I.expression),this.interpolationType=re};function dr(b,I){if((b=qt(b,I)).result==="error")return b;var V=b.value.expression,re=yn(V);if(!re&&!Ho(I))return oo([new mt("","data expressions not supported")]);var fe=Gr(V,["zoom"]);if(!fe&&!ds(I))return oo([new mt("","zoom expressions not supported")]);var ge=function ze(Ze){var st=null;if(Ze instanceof xi)st=ze(Ze.result);else if(Ze instanceof uo)for(var pt=0,Rt=Ze.args;pt<Rt.length;pt+=1){var Gt=Rt[pt];if(st=ze(Gt))break}else(Ze instanceof ia||Ze instanceof Ha)&&Ze.input instanceof Mn&&Ze.input.name==="zoom"&&(st=Ze);return st instanceof mt||Ze.eachChild(function(Ut){var rr=ze(Ut);rr instanceof mt?st=rr:!st&&rr?st=new mt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):st&&rr&&st!==rr&&(st=new mt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),st}(V);if(!ge&&!fe)return oo([new mt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(ge instanceof mt)return oo([ge]);if(ge instanceof Ha&&!So(I))return oo([new mt("",'"interpolate" expressions cannot be used with this property')]);if(!ge)return ps(new tr(re?"constant":"source",b.value));var Ae=ge instanceof Ha?ge.interpolation:void 0;return ps(new lr(re?"camera":"composite",b.value,ge.labels,Ae))}lr.prototype.evaluateWithoutErrorHandling=function(b,I,V,re,fe,ge){return this._styleExpression.evaluateWithoutErrorHandling(b,I,V,re,fe,ge)},lr.prototype.evaluate=function(b,I,V,re,fe,ge){return this._styleExpression.evaluate(b,I,V,re,fe,ge)},lr.prototype.interpolationFactor=function(b,I,V){return this.interpolationType?Ha.interpolationFactor(this.interpolationType,b,I,V):0};var gr=function(b,I){this._parameters=b,this._specification=I,kt(this,function V(re,fe){var ge,Ae,ze,Ze=fe.type==="color",st=re.stops&&typeof re.stops[0][0]=="object",pt=st||re.property!==void 0,Rt=st||!pt,Gt=re.type||(So(fe)?"exponential":"interval");if(Ze&&((re=kt({},re)).stops&&(re.stops=re.stops.map(function(na){return[na[0],sr.parse(na[1])]})),re.default?re.default=sr.parse(re.default):re.default=sr.parse(fe.default)),re.colorSpace&&re.colorSpace!=="rgb"&&!No[re.colorSpace])throw new Error("Unknown color space: "+re.colorSpace);if(Gt==="exponential")ge=ht;else if(Gt==="interval")ge=dt;else if(Gt==="categorical"){ge=at,Ae=Object.create(null);for(var Ut=0,rr=re.stops;Ut<rr.length;Ut+=1){var pr=rr[Ut];Ae[pr[0]]=pr[1]}ze=typeof re.stops[0][0]}else{if(Gt!=="identity")throw new Error('Unknown function type "'+Gt+'"');ge=Mt}if(st){for(var Sr={},Mr=[],Dr=0;Dr<re.stops.length;Dr++){var Rr=re.stops[Dr],Ur=Rr[0].zoom;Sr[Ur]===void 0&&(Sr[Ur]={zoom:Ur,type:re.type,property:re.property,default:re.default,stops:[]},Mr.push(Ur)),Sr[Ur].stops.push([Rr[0].value,Rr[1]])}for(var cn=[],vn=0,Fn=Mr;vn<Fn.length;vn+=1){var Dn=Fn[vn];cn.push([Sr[Dn].zoom,V(Sr[Dn],fe)])}var Hn={name:"linear"};return{kind:"composite",interpolationType:Hn,interpolationFactor:Ha.interpolationFactor.bind(void 0,Hn),zoomStops:cn.map(function(na){return na[0]}),evaluate:function(na,Xn){var ua=na.zoom;return ht({stops:cn,base:re.base},fe,ua).evaluate(ua,Xn)}}}if(Rt){var ra=Gt==="exponential"?{name:"exponential",base:re.base!==void 0?re.base:1}:null;return{kind:"camera",interpolationType:ra,interpolationFactor:Ha.interpolationFactor.bind(void 0,ra),zoomStops:re.stops.map(function(na){return na[0]}),evaluate:function(na){var Xn=na.zoom;return ge(re,fe,Xn,Ae,ze)}}}return{kind:"source",evaluate:function(na,Xn){var ua=Xn&&Xn.properties?Xn.properties[re.property]:void 0;return ua===void 0?Ke(re.default,fe.default):ge(re,fe,ua,Ae,ze)}}}(this._parameters,this._specification))};function Pr(b){var I=b.key,V=b.value,re=b.valueSpec||{},fe=b.objectElementValidators||{},ge=b.style,Ae=b.styleSpec,ze=[],Ze=Ua(V);if(Ze!=="object")return[new Xe(I,V,"object expected, "+Ze+" found")];for(var st in V){var pt=st.split(".")[0],Rt=re[pt]||re["*"],Gt=void 0;if(fe[pt])Gt=fe[pt];else if(re[pt])Gt=ir;else if(fe["*"])Gt=fe["*"];else{if(!re["*"]){ze.push(new Xe(I,V[st],'unknown property "'+st+'"'));continue}Gt=ir}ze=ze.concat(Gt({key:(I&&I+".")+st,value:V[st],valueSpec:Rt,style:ge,styleSpec:Ae,object:V,objectKey:st},V))}for(var Ut in re)fe[Ut]||re[Ut].required&&re[Ut].default===void 0&&V[Ut]===void 0&&ze.push(new Xe(I,V,'missing required property "'+Ut+'"'));return ze}function tn(b){var I=b.value,V=b.valueSpec,re=b.style,fe=b.styleSpec,ge=b.key,Ae=b.arrayElementValidator||ir;if(Ua(I)!=="array")return[new Xe(ge,I,"array expected, "+Ua(I)+" found")];if(V.length&&I.length!==V.length)return[new Xe(ge,I,"array length "+V.length+" expected, length "+I.length+" found")];if(V["min-length"]&&I.length<V["min-length"])return[new Xe(ge,I,"array length at least "+V["min-length"]+" expected, length "+I.length+" found")];var ze={type:V.value,values:V.values};fe.$version<7&&(ze.function=V.function),Ua(V.value)==="object"&&(ze=V.value);for(var Ze=[],st=0;st<I.length;st++)Ze=Ze.concat(Ae({array:I,arrayIndex:st,value:I[st],valueSpec:ze,style:re,styleSpec:fe,key:ge+"["+st+"]"}));return Ze}function pn(b){var I=b.key,V=b.value,re=b.valueSpec,fe=Ua(V);return fe==="number"&&V!=V&&(fe="NaN"),fe!=="number"?[new Xe(I,V,"number expected, "+fe+" found")]:"minimum"in re&&V<re.minimum?[new Xe(I,V,V+" is less than the minimum value "+re.minimum)]:"maximum"in re&&V>re.maximum?[new Xe(I,V,V+" is greater than the maximum value "+re.maximum)]:[]}function Sn(b){var I,V,re,fe=b.valueSpec,ge=ft(b.value.type),Ae={},ze=ge!=="categorical"&&b.value.property===void 0,Ze=!ze,st=Ua(b.value.stops)==="array"&&Ua(b.value.stops[0])==="array"&&Ua(b.value.stops[0][0])==="object",pt=Pr({key:b.key,value:b.value,valueSpec:b.styleSpec.function,style:b.style,styleSpec:b.styleSpec,objectElementValidators:{stops:function(Ut){if(ge==="identity")return[new Xe(Ut.key,Ut.value,'identity function may not have a "stops" property')];var rr=[],pr=Ut.value;return rr=rr.concat(tn({key:Ut.key,value:pr,valueSpec:Ut.valueSpec,style:Ut.style,styleSpec:Ut.styleSpec,arrayElementValidator:Rt})),Ua(pr)==="array"&&pr.length===0&&rr.push(new Xe(Ut.key,pr,"array must have at least one stop")),rr},default:function(Ut){return ir({key:Ut.key,value:Ut.value,valueSpec:fe,style:Ut.style,styleSpec:Ut.styleSpec})}}});return ge==="identity"&&ze&&pt.push(new Xe(b.key,b.value,'missing required property "property"')),ge==="identity"||b.value.stops||pt.push(new Xe(b.key,b.value,'missing required property "stops"')),ge==="exponential"&&b.valueSpec.expression&&!So(b.valueSpec)&&pt.push(new Xe(b.key,b.value,"exponential functions not supported")),b.styleSpec.$version>=8&&(Ze&&!Ho(b.valueSpec)?pt.push(new Xe(b.key,b.value,"property functions not supported")):ze&&!ds(b.valueSpec)&&pt.push(new Xe(b.key,b.value,"zoom functions not supported"))),ge!=="categorical"&&!st||b.value.property!==void 0||pt.push(new Xe(b.key,b.value,'"property" property is required')),pt;function Rt(Ut){var rr=[],pr=Ut.value,Sr=Ut.key;if(Ua(pr)!=="array")return[new Xe(Sr,pr,"array expected, "+Ua(pr)+" found")];if(pr.length!==2)return[new Xe(Sr,pr,"array length 2 expected, length "+pr.length+" found")];if(st){if(Ua(pr[0])!=="object")return[new Xe(Sr,pr,"object expected, "+Ua(pr[0])+" found")];if(pr[0].zoom===void 0)return[new Xe(Sr,pr,"object stop key must have zoom")];if(pr[0].value===void 0)return[new Xe(Sr,pr,"object stop key must have value")];if(re&&re>ft(pr[0].zoom))return[new Xe(Sr,pr[0].zoom,"stop zoom values must appear in ascending order")];ft(pr[0].zoom)!==re&&(re=ft(pr[0].zoom),V=void 0,Ae={}),rr=rr.concat(Pr({key:Sr+"[0]",value:pr[0],valueSpec:{zoom:{}},style:Ut.style,styleSpec:Ut.styleSpec,objectElementValidators:{zoom:pn,value:Gt}}))}else rr=rr.concat(Gt({key:Sr+"[0]",value:pr[0],valueSpec:{},style:Ut.style,styleSpec:Ut.styleSpec},pr));return Jt(Et(pr[1]))?rr.concat([new Xe(Sr+"[1]",pr[1],"expressions are not allowed in function stops.")]):rr.concat(ir({key:Sr+"[1]",value:pr[1],valueSpec:fe,style:Ut.style,styleSpec:Ut.styleSpec}))}function Gt(Ut,rr){var pr=Ua(Ut.value),Sr=ft(Ut.value),Mr=Ut.value!==null?Ut.value:rr;if(I){if(pr!==I)return[new Xe(Ut.key,Mr,pr+" stop domain type must match previous stop domain type "+I)]}else I=pr;if(pr!=="number"&&pr!=="string"&&pr!=="boolean")return[new Xe(Ut.key,Mr,"stop domain value must be a number, string, or boolean")];if(pr!=="number"&&ge!=="categorical"){var Dr="number expected, "+pr+" found";return Ho(fe)&&ge===void 0&&(Dr+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Xe(Ut.key,Mr,Dr)]}return ge!=="categorical"||pr!=="number"||isFinite(Sr)&&Math.floor(Sr)===Sr?ge!=="categorical"&&pr==="number"&&V!==void 0&&Sr<V?[new Xe(Ut.key,Mr,"stop domain values must appear in ascending order")]:(V=Sr,ge==="categorical"&&Sr in Ae?[new Xe(Ut.key,Mr,"stop domain values must be unique")]:(Ae[Sr]=!0,[])):[new Xe(Ut.key,Mr,"integer expected, found "+Sr)]}}function In(b){var I=(b.expressionContext==="property"?dr:qt)(Et(b.value),b.valueSpec);if(I.result==="error")return I.value.map(function(re){return new Xe(""+b.key+re.key,b.value,re.message)});var V=I.value.expression||I.value._styleExpression.expression;if(b.expressionContext==="property"&&b.propertyKey==="text-font"&&!V.outputDefined())return[new Xe(b.key,b.value,'Invalid data expression for "'+b.propertyKey+'". Output values must be contained as literals within the expression.')];if(b.expressionContext==="property"&&b.propertyType==="layout"&&!Ir(V))return[new Xe(b.key,b.value,'"feature-state" data expressions are not supported with layout properties.')];if(b.expressionContext==="filter"&&!Ir(V))return[new Xe(b.key,b.value,'"feature-state" data expressions are not supported with filters.')];if(b.expressionContext&&b.expressionContext.indexOf("cluster")===0){if(!Gr(V,["zoom","feature-state"]))return[new Xe(b.key,b.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(b.expressionContext==="cluster-initial"&&!yn(V))return[new Xe(b.key,b.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Un(b){var I=b.key,V=b.value,re=b.valueSpec,fe=[];return Array.isArray(re.values)?re.values.indexOf(ft(V))===-1&&fe.push(new Xe(I,V,"expected one of ["+re.values.join(", ")+"], "+JSON.stringify(V)+" found")):Object.keys(re.values).indexOf(ft(V))===-1&&fe.push(new Xe(I,V,"expected one of ["+Object.keys(re.values).join(", ")+"], "+JSON.stringify(V)+" found")),fe}function On(b){if(b===!0||b===!1)return!0;if(!Array.isArray(b)||b.length===0)return!1;switch(b[0]){case"has":return b.length>=2&&b[1]!=="$id"&&b[1]!=="$type";case"in":return b.length>=3&&(typeof b[1]!="string"||Array.isArray(b[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return b.length!==3||Array.isArray(b[1])||Array.isArray(b[2]);case"any":case"all":for(var I=0,V=b.slice(1);I<V.length;I+=1){var re=V[I];if(!On(re)&&typeof re!="boolean")return!1}return!0;default:return!0}}gr.deserialize=function(b){return new gr(b._parameters,b._specification)},gr.serialize=function(b){return{_parameters:b._parameters,_specification:b._specification}};var pa={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function _a(b){if(b==null)return{filter:function(){return!0},needGeometry:!1};On(b)||(b=Da(b));var I=qt(b,pa);if(I.result==="error")throw new Error(I.value.map(function(V){return V.key+": "+V.message}).join(", "));return{filter:function(V,re,fe){return I.value.evaluate(V,re,{},fe)},needGeometry:function V(re){if(!Array.isArray(re))return!1;if(re[0]==="within")return!0;for(var fe=1;fe<re.length;fe++)if(V(re[fe]))return!0;return!1}(b)}}function Ra(b,I){return b<I?-1:b>I?1:0}function Da(b){if(!b)return!0;var I,V=b[0];return b.length<=1?V!=="any":V==="=="?Fa(b[1],b[2],"=="):V==="!="?ai(Fa(b[1],b[2],"==")):V==="<"||V===">"||V==="<="||V===">="?Fa(b[1],b[2],V):V==="any"?(I=b.slice(1),["any"].concat(I.map(Da))):V==="all"?["all"].concat(b.slice(1).map(Da)):V==="none"?["all"].concat(b.slice(1).map(Da).map(ai)):V==="in"?bi(b[1],b.slice(2)):V==="!in"?ai(bi(b[1],b.slice(2))):V==="has"?gi(b[1]):V==="!has"?ai(gi(b[1])):V!=="within"||b}function Fa(b,I,V){switch(b){case"$type":return["filter-type-"+V,I];case"$id":return["filter-id-"+V,I];default:return["filter-"+V,b,I]}}function bi(b,I){if(I.length===0)return!1;switch(b){case"$type":return["filter-type-in",["literal",I]];case"$id":return["filter-id-in",["literal",I]];default:return I.length>200&&!I.some(function(V){return typeof V!=typeof I[0]})?["filter-in-large",b,["literal",I.sort(Ra)]]:["filter-in-small",b,["literal",I]]}}function gi(b){switch(b){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",b]}}function ai(b){return["!",b]}function ii(b){return On(Et(b.value))?In(kt({},b,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function I(V){var re=V.value,fe=V.key;if(Ua(re)!=="array")return[new Xe(fe,re,"array expected, "+Ua(re)+" found")];var ge,Ae=V.styleSpec,ze=[];if(re.length<1)return[new Xe(fe,re,"filter array must have at least 1 element")];switch(ze=ze.concat(Un({key:fe+"[0]",value:re[0],valueSpec:Ae.filter_operator,style:V.style,styleSpec:V.styleSpec})),ft(re[0])){case"<":case"<=":case">":case">=":re.length>=2&&ft(re[1])==="$type"&&ze.push(new Xe(fe,re,'"$type" cannot be use with operator "'+re[0]+'"'));case"==":case"!=":re.length!==3&&ze.push(new Xe(fe,re,'filter array for operator "'+re[0]+'" must have 3 elements'));case"in":case"!in":re.length>=2&&(ge=Ua(re[1]))!=="string"&&ze.push(new Xe(fe+"[1]",re[1],"string expected, "+ge+" found"));for(var Ze=2;Ze<re.length;Ze++)ge=Ua(re[Ze]),ft(re[1])==="$type"?ze=ze.concat(Un({key:fe+"["+Ze+"]",value:re[Ze],valueSpec:Ae.geometry_type,style:V.style,styleSpec:V.styleSpec})):ge!=="string"&&ge!=="number"&&ge!=="boolean"&&ze.push(new Xe(fe+"["+Ze+"]",re[Ze],"string, number, or boolean expected, "+ge+" found"));break;case"any":case"all":case"none":for(var st=1;st<re.length;st++)ze=ze.concat(I({key:fe+"["+st+"]",value:re[st],style:V.style,styleSpec:V.styleSpec}));break;case"has":case"!has":ge=Ua(re[1]),re.length!==2?ze.push(new Xe(fe,re,'filter array for "'+re[0]+'" operator must have 2 elements')):ge!=="string"&&ze.push(new Xe(fe+"[1]",re[1],"string expected, "+ge+" found"));break;case"within":ge=Ua(re[1]),re.length!==2?ze.push(new Xe(fe,re,'filter array for "'+re[0]+'" operator must have 2 elements')):ge!=="object"&&ze.push(new Xe(fe+"[1]",re[1],"object expected, "+ge+" found"))}return ze}(b)}function vi(b,I){var V=b.key,re=b.style,fe=b.styleSpec,ge=b.value,Ae=b.objectKey,ze=fe[I+"_"+b.layerType];if(!ze)return[];var Ze=Ae.match(/^(.*)-transition$/);if(I==="paint"&&Ze&&ze[Ze[1]]&&ze[Ze[1]].transition)return ir({key:V,value:ge,valueSpec:fe.transition,style:re,styleSpec:fe});var st,pt=b.valueSpec||ze[Ae];if(!pt)return[new Xe(V,ge,'unknown property "'+Ae+'"')];if(Ua(ge)==="string"&&Ho(pt)&&!pt.tokens&&(st=/^{([^}]+)}$/.exec(ge)))return[new Xe(V,ge,'"'+Ae+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(st[1])+" }`.")];var Rt=[];return b.layerType==="symbol"&&(Ae==="text-field"&&re&&!re.glyphs&&Rt.push(new Xe(V,ge,'use of "text-field" requires a style "glyphs" property')),Ae==="text-font"&&Re(Et(ge))&&ft(ge.type)==="identity"&&Rt.push(new Xe(V,ge,'"text-font" does not support identity functions'))),Rt.concat(ir({key:b.key,value:ge,valueSpec:pt,style:re,styleSpec:fe,expressionContext:"property",propertyType:I,propertyKey:Ae}))}function Ri(b){return vi(b,"paint")}function Zi(b){return vi(b,"layout")}function Ji(b){var I=[],V=b.value,re=b.key,fe=b.style,ge=b.styleSpec;V.type||V.ref||I.push(new Xe(re,V,'either "type" or "ref" is required'));var Ae,ze=ft(V.type),Ze=ft(V.ref);if(V.id)for(var st=ft(V.id),pt=0;pt<b.arrayIndex;pt++){var Rt=fe.layers[pt];ft(Rt.id)===st&&I.push(new Xe(re,V.id,'duplicate layer id "'+V.id+'", previously used at line '+Rt.id.__line__))}if("ref"in V)["type","source","source-layer","filter","layout"].forEach(function(rr){rr in V&&I.push(new Xe(re,V[rr],'"'+rr+'" is prohibited for ref layers'))}),fe.layers.forEach(function(rr){ft(rr.id)===Ze&&(Ae=rr)}),Ae?Ae.ref?I.push(new Xe(re,V.ref,"ref cannot reference another ref layer")):ze=ft(Ae.type):I.push(new Xe(re,V.ref,'ref layer "'+Ze+'" not found'));else if(ze!=="background")if(V.source){var Gt=fe.sources&&fe.sources[V.source],Ut=Gt&&ft(Gt.type);Gt?Ut==="vector"&&ze==="raster"?I.push(new Xe(re,V.source,'layer "'+V.id+'" requires a raster source')):Ut==="raster"&&ze!=="raster"?I.push(new Xe(re,V.source,'layer "'+V.id+'" requires a vector source')):Ut!=="vector"||V["source-layer"]?Ut==="raster-dem"&&ze!=="hillshade"?I.push(new Xe(re,V.source,"raster-dem source can only be used with layer type 'hillshade'.")):ze!=="line"||!V.paint||!V.paint["line-gradient"]||Ut==="geojson"&&Gt.lineMetrics||I.push(new Xe(re,V,'layer "'+V.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):I.push(new Xe(re,V,'layer "'+V.id+'" must specify a "source-layer"')):I.push(new Xe(re,V.source,'source "'+V.source+'" not found'))}else I.push(new Xe(re,V,'missing required property "source"'));return I=I.concat(Pr({key:re,value:V,valueSpec:ge.layer,style:b.style,styleSpec:b.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return ir({key:re+".type",value:V.type,valueSpec:ge.layer.type,style:b.style,styleSpec:b.styleSpec,object:V,objectKey:"type"})},filter:ii,layout:function(rr){return Pr({layer:V,key:rr.key,value:rr.value,style:rr.style,styleSpec:rr.styleSpec,objectElementValidators:{"*":function(pr){return Zi(kt({layerType:ze},pr))}}})},paint:function(rr){return Pr({layer:V,key:rr.key,value:rr.value,style:rr.style,styleSpec:rr.styleSpec,objectElementValidators:{"*":function(pr){return Ri(kt({layerType:ze},pr))}}})}}}))}function Ki(b){var I=b.value,V=b.key,re=Ua(I);return re!=="string"?[new Xe(V,I,"string expected, "+re+" found")]:[]}var Qi={promoteId:function(b){var I=b.key,V=b.value;if(Ua(V)==="string")return Ki({key:I,value:V});var re=[];for(var fe in V)re.push.apply(re,Ki({key:I+"."+fe,value:V[fe]}));return re}};function Pa(b){var I=b.value,V=b.key,re=b.styleSpec,fe=b.style;if(!I.type)return[new Xe(V,I,'"type" is required')];var ge,Ae=ft(I.type);switch(Ae){case"vector":case"raster":case"raster-dem":return ge=Pr({key:V,value:I,valueSpec:re["source_"+Ae.replace("-","_")],style:b.style,styleSpec:re,objectElementValidators:Qi});case"geojson":if(ge=Pr({key:V,value:I,valueSpec:re.source_geojson,style:fe,styleSpec:re,objectElementValidators:Qi}),I.cluster)for(var ze in I.clusterProperties){var Ze=I.clusterProperties[ze],st=Ze[0],pt=Ze[1],Rt=typeof st=="string"?[st,["accumulated"],["get",ze]]:st;ge.push.apply(ge,In({key:V+"."+ze+".map",value:pt,expressionContext:"cluster-map"})),ge.push.apply(ge,In({key:V+"."+ze+".reduce",value:Rt,expressionContext:"cluster-reduce"}))}return ge;case"video":return Pr({key:V,value:I,valueSpec:re.source_video,style:fe,styleSpec:re});case"image":return Pr({key:V,value:I,valueSpec:re.source_image,style:fe,styleSpec:re});case"canvas":return[new Xe(V,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Un({key:V+".type",value:I.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:fe,styleSpec:re})}}function ct(b){var I=b.value,V=b.styleSpec,re=V.light,fe=b.style,ge=[],Ae=Ua(I);if(I===void 0)return ge;if(Ae!=="object")return ge=ge.concat([new Xe("light",I,"object expected, "+Ae+" found")]);for(var ze in I){var Ze=ze.match(/^(.*)-transition$/);ge=Ze&&re[Ze[1]]&&re[Ze[1]].transition?ge.concat(ir({key:ze,value:I[ze],valueSpec:V.transition,style:fe,styleSpec:V})):re[ze]?ge.concat(ir({key:ze,value:I[ze],valueSpec:re[ze],style:fe,styleSpec:V})):ge.concat([new Xe(ze,I[ze],'unknown property "'+ze+'"')])}return ge}var zt={"*":function(){return[]},array:tn,boolean:function(b){var I=b.value,V=b.key,re=Ua(I);return re!=="boolean"?[new Xe(V,I,"boolean expected, "+re+" found")]:[]},number:pn,color:function(b){var I=b.key,V=b.value,re=Ua(V);return re!=="string"?[new Xe(I,V,"color expected, "+re+" found")]:mr(V)===null?[new Xe(I,V,'color expected, "'+V+'" found')]:[]},constants:ut,enum:Un,filter:ii,function:Sn,layer:Ji,object:Pr,source:Pa,light:ct,string:Ki,formatted:function(b){return Ki(b).length===0?[]:In(b)},resolvedImage:function(b){return Ki(b).length===0?[]:In(b)}};function ir(b){var I=b.value,V=b.valueSpec,re=b.styleSpec;return V.expression&&Re(ft(I))?Sn(b):V.expression&&Jt(Et(I))?In(b):V.type&&zt[V.type]?zt[V.type](b):Pr(kt({},b,{valueSpec:V.type?re[V.type]:V}))}function jt(b){var I=b.value,V=b.key,re=Ki(b);return re.length||(I.indexOf("{fontstack}")===-1&&re.push(new Xe(V,I,'"glyphs" url must include a "{fontstack}" token')),I.indexOf("{range}")===-1&&re.push(new Xe(V,I,'"glyphs" url must include a "{range}" token'))),re}function or(b,I){I===void 0&&(I=Pe);var V=[];return V=V.concat(ir({key:"",value:b,valueSpec:I.$root,styleSpec:I,style:b,objectElementValidators:{glyphs:jt,"*":function(){return[]}}})),b.constants&&(V=V.concat(ut({key:"constants",value:b.constants,style:b,styleSpec:I}))),Er(V)}function Er(b){return[].concat(b).sort(function(I,V){return I.line-V.line})}function Or(b){return function(){for(var I=[],V=arguments.length;V--;)I[V]=arguments[V];return Er(b.apply(this,I))}}or.source=Or(Pa),or.light=Or(ct),or.layer=Or(Ji),or.filter=Or(ii),or.paintProperty=Or(Ri),or.layoutProperty=Or(Zi);var qr=or,on=qr.light,nn=qr.paintProperty,dn=qr.layoutProperty;function bn(b,I){var V=!1;if(I&&I.length)for(var re=0,fe=I;re<fe.length;re+=1){var ge=fe[re];b.fire(new Le(new Error(ge.message))),V=!0}return V}var sn=_n;function _n(b,I,V){var re=this.cells=[];if(b instanceof ArrayBuffer){this.arrayBuffer=b;var fe=new Int32Array(this.arrayBuffer);b=fe[0],I=fe[1],V=fe[2],this.d=I+2*V;for(var ge=0;ge<this.d*this.d;ge++){var Ae=fe[3+ge],ze=fe[3+ge+1];re.push(Ae===ze?null:fe.subarray(Ae,ze))}var Ze=fe[3+re.length],st=fe[3+re.length+1];this.keys=fe.subarray(Ze,st),this.bboxes=fe.subarray(st),this.insert=this._insertReadonly}else{this.d=I+2*V;for(var pt=0;pt<this.d*this.d;pt++)re.push([]);this.keys=[],this.bboxes=[]}this.n=I,this.extent=b,this.padding=V,this.scale=I/b,this.uid=0;var Rt=V/I*b;this.min=-Rt,this.max=b+Rt}_n.prototype.insert=function(b,I,V,re,fe){this._forEachCell(I,V,re,fe,this._insertCell,this.uid++),this.keys.push(b),this.bboxes.push(I),this.bboxes.push(V),this.bboxes.push(re),this.bboxes.push(fe)},_n.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},_n.prototype._insertCell=function(b,I,V,re,fe,ge){this.cells[fe].push(ge)},_n.prototype.query=function(b,I,V,re,fe){var ge=this.min,Ae=this.max;if(b<=ge&&I<=ge&&Ae<=V&&Ae<=re&&!fe)return Array.prototype.slice.call(this.keys);var ze=[];return this._forEachCell(b,I,V,re,this._queryCell,ze,{},fe),ze},_n.prototype._queryCell=function(b,I,V,re,fe,ge,Ae,ze){var Ze=this.cells[fe];if(Ze!==null)for(var st=this.keys,pt=this.bboxes,Rt=0;Rt<Ze.length;Rt++){var Gt=Ze[Rt];if(Ae[Gt]===void 0){var Ut=4*Gt;(ze?ze(pt[Ut+0],pt[Ut+1],pt[Ut+2],pt[Ut+3]):b<=pt[Ut+2]&&I<=pt[Ut+3]&&V>=pt[Ut+0]&&re>=pt[Ut+1])?(Ae[Gt]=!0,ge.push(st[Gt])):Ae[Gt]=!1}}},_n.prototype._forEachCell=function(b,I,V,re,fe,ge,Ae,ze){for(var Ze=this._convertToCellCoord(b),st=this._convertToCellCoord(I),pt=this._convertToCellCoord(V),Rt=this._convertToCellCoord(re),Gt=Ze;Gt<=pt;Gt++)for(var Ut=st;Ut<=Rt;Ut++){var rr=this.d*Ut+Gt;if((!ze||ze(this._convertFromCellCoord(Gt),this._convertFromCellCoord(Ut),this._convertFromCellCoord(Gt+1),this._convertFromCellCoord(Ut+1)))&&fe.call(this,b,I,V,re,rr,ge,Ae,ze))return}},_n.prototype._convertFromCellCoord=function(b){return(b-this.padding)/this.scale},_n.prototype._convertToCellCoord=function(b){return Math.max(0,Math.min(this.d-1,Math.floor(b*this.scale)+this.padding))},_n.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var b=this.cells,I=3+this.cells.length+1+1,V=0,re=0;re<this.cells.length;re++)V+=this.cells[re].length;var fe=new Int32Array(I+V+this.keys.length+this.bboxes.length);fe[0]=this.extent,fe[1]=this.n,fe[2]=this.padding;for(var ge=I,Ae=0;Ae<b.length;Ae++){var ze=b[Ae];fe[3+Ae]=ge,fe.set(ze,ge),ge+=ze.length}return fe[3+b.length]=ge,fe.set(this.keys,ge),ge+=this.keys.length,fe[3+b.length+1]=ge,fe.set(this.bboxes,ge),ge+=this.bboxes.length,fe.buffer};var zn=self.ImageData,jn=self.ImageBitmap,ea={};function Yr(b,I,V){V===void 0&&(V={}),Object.defineProperty(I,"_classRegistryKey",{value:b,writeable:!1}),ea[b]={klass:I,omit:V.omit||[],shallow:V.shallow||[]}}for(var Kn in Yr("Object",Object),sn.serialize=function(b,I){var V=b.toArrayBuffer();return I&&I.push(V),{buffer:V}},sn.deserialize=function(b){return new sn(b.buffer)},Yr("Grid",sn),Yr("Color",sr),Yr("Error",Error),Yr("ResolvedImage",xr),Yr("StylePropertyFunction",gr),Yr("StyleExpression",Wt,{omit:["_evaluator"]}),Yr("ZoomDependentExpression",lr),Yr("ZoomConstantExpression",tr),Yr("CompoundExpression",Mn,{omit:["_evaluate"]}),jo)jo[Kn]._classRegistryKey||Yr("Expression_"+Kn,jo[Kn]);function En(b){return b&&typeof ArrayBuffer!="undefined"&&(b instanceof ArrayBuffer||b.constructor&&b.constructor.name==="ArrayBuffer")}function Bn(b){return jn&&b instanceof jn}function Jn(b,I){if(b==null||typeof b=="boolean"||typeof b=="number"||typeof b=="string"||b instanceof Boolean||b instanceof Number||b instanceof String||b instanceof Date||b instanceof RegExp)return b;if(En(b)||Bn(b))return I&&I.push(b),b;if(ArrayBuffer.isView(b)){var V=b;return I&&I.push(V.buffer),V}if(b instanceof zn)return I&&I.push(b.data.buffer),b;if(Array.isArray(b)){for(var re=[],fe=0,ge=b;fe<ge.length;fe+=1){var Ae=ge[fe];re.push(Jn(Ae,I))}return re}if(typeof b=="object"){var ze=b.constructor,Ze=ze._classRegistryKey;if(!Ze)throw new Error("can't serialize object of unregistered class");var st=ze.serialize?ze.serialize(b,I):{};if(!ze.serialize){for(var pt in b)if(b.hasOwnProperty(pt)&&!(ea[Ze].omit.indexOf(pt)>=0)){var Rt=b[pt];st[pt]=ea[Ze].shallow.indexOf(pt)>=0?Rt:Jn(Rt,I)}b instanceof Error&&(st.message=b.message)}if(st.$name)throw new Error("$name property is reserved for worker serialization logic.");return Ze!=="Object"&&(st.$name=Ze),st}throw new Error("can't serialize object of type "+typeof b)}function ba(b){if(b==null||typeof b=="boolean"||typeof b=="number"||typeof b=="string"||b instanceof Boolean||b instanceof Number||b instanceof String||b instanceof Date||b instanceof RegExp||En(b)||Bn(b)||ArrayBuffer.isView(b)||b instanceof zn)return b;if(Array.isArray(b))return b.map(ba);if(typeof b=="object"){var I=b.$name||"Object",V=ea[I].klass;if(!V)throw new Error("can't deserialize unregistered class "+I);if(V.deserialize)return V.deserialize(b);for(var re=Object.create(V.prototype),fe=0,ge=Object.keys(b);fe<ge.length;fe+=1){var Ae=ge[fe];if(Ae!=="$name"){var ze=b[Ae];re[Ae]=ea[I].shallow.indexOf(Ae)>=0?ze:ba(ze)}}return re}throw new Error("can't deserialize object of type "+typeof b)}var Ma=function(){this.first=!0};Ma.prototype.update=function(b,I){var V=Math.floor(b);return this.first?(this.first=!1,this.lastIntegerZoom=V,this.lastIntegerZoomTime=0,this.lastZoom=b,this.lastFloorZoom=V,!0):(this.lastFloorZoom>V?(this.lastIntegerZoom=V+1,this.lastIntegerZoomTime=I):this.lastFloorZoom<V&&(this.lastIntegerZoom=V,this.lastIntegerZoomTime=I),b!==this.lastZoom&&(this.lastZoom=b,this.lastFloorZoom=V,!0))};var kn={"Latin-1 Supplement":function(b){return b>=128&&b<=255},Arabic:function(b){return b>=1536&&b<=1791},"Arabic Supplement":function(b){return b>=1872&&b<=1919},"Arabic Extended-A":function(b){return b>=2208&&b<=2303},"Hangul Jamo":function(b){return b>=4352&&b<=4607},"Unified Canadian Aboriginal Syllabics":function(b){return b>=5120&&b<=5759},Khmer:function(b){return b>=6016&&b<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(b){return b>=6320&&b<=6399},"General Punctuation":function(b){return b>=8192&&b<=8303},"Letterlike Symbols":function(b){return b>=8448&&b<=8527},"Number Forms":function(b){return b>=8528&&b<=8591},"Miscellaneous Technical":function(b){return b>=8960&&b<=9215},"Control Pictures":function(b){return b>=9216&&b<=9279},"Optical Character Recognition":function(b){return b>=9280&&b<=9311},"Enclosed Alphanumerics":function(b){return b>=9312&&b<=9471},"Geometric Shapes":function(b){return b>=9632&&b<=9727},"Miscellaneous Symbols":function(b){return b>=9728&&b<=9983},"Miscellaneous Symbols and Arrows":function(b){return b>=11008&&b<=11263},"CJK Radicals Supplement":function(b){return b>=11904&&b<=12031},"Kangxi Radicals":function(b){return b>=12032&&b<=12255},"Ideographic Description Characters":function(b){return b>=12272&&b<=12287},"CJK Symbols and Punctuation":function(b){return b>=12288&&b<=12351},Hiragana:function(b){return b>=12352&&b<=12447},Katakana:function(b){return b>=12448&&b<=12543},Bopomofo:function(b){return b>=12544&&b<=12591},"Hangul Compatibility Jamo":function(b){return b>=12592&&b<=12687},Kanbun:function(b){return b>=12688&&b<=12703},"Bopomofo Extended":function(b){return b>=12704&&b<=12735},"CJK Strokes":function(b){return b>=12736&&b<=12783},"Katakana Phonetic Extensions":function(b){return b>=12784&&b<=12799},"Enclosed CJK Letters and Months":function(b){return b>=12800&&b<=13055},"CJK Compatibility":function(b){return b>=13056&&b<=13311},"CJK Unified Ideographs Extension A":function(b){return b>=13312&&b<=19903},"Yijing Hexagram Symbols":function(b){return b>=19904&&b<=19967},"CJK Unified Ideographs":function(b){return b>=19968&&b<=40959},"Yi Syllables":function(b){return b>=40960&&b<=42127},"Yi Radicals":function(b){return b>=42128&&b<=42191},"Hangul Jamo Extended-A":function(b){return b>=43360&&b<=43391},"Hangul Syllables":function(b){return b>=44032&&b<=55215},"Hangul Jamo Extended-B":function(b){return b>=55216&&b<=55295},"Private Use Area":function(b){return b>=57344&&b<=63743},"CJK Compatibility Ideographs":function(b){return b>=63744&&b<=64255},"Arabic Presentation Forms-A":function(b){return b>=64336&&b<=65023},"Vertical Forms":function(b){return b>=65040&&b<=65055},"CJK Compatibility Forms":function(b){return b>=65072&&b<=65103},"Small Form Variants":function(b){return b>=65104&&b<=65135},"Arabic Presentation Forms-B":function(b){return b>=65136&&b<=65279},"Halfwidth and Fullwidth Forms":function(b){return b>=65280&&b<=65519}};function Ia(b){for(var I=0,V=b;I<V.length;I+=1)if(ha(V[I].charCodeAt(0)))return!0;return!1}function ka(b){return!kn.Arabic(b)&&!kn["Arabic Supplement"](b)&&!kn["Arabic Extended-A"](b)&&!kn["Arabic Presentation Forms-A"](b)&&!kn["Arabic Presentation Forms-B"](b)}function ha(b){return b===746||b===747||!(b<4352)&&(!!kn["Bopomofo Extended"](b)||!!kn.Bopomofo(b)||!(!kn["CJK Compatibility Forms"](b)||b>=65097&&b<=65103)||!!kn["CJK Compatibility Ideographs"](b)||!!kn["CJK Compatibility"](b)||!!kn["CJK Radicals Supplement"](b)||!!kn["CJK Strokes"](b)||!(!kn["CJK Symbols and Punctuation"](b)||b>=12296&&b<=12305||b>=12308&&b<=12319||b===12336)||!!kn["CJK Unified Ideographs Extension A"](b)||!!kn["CJK Unified Ideographs"](b)||!!kn["Enclosed CJK Letters and Months"](b)||!!kn["Hangul Compatibility Jamo"](b)||!!kn["Hangul Jamo Extended-A"](b)||!!kn["Hangul Jamo Extended-B"](b)||!!kn["Hangul Jamo"](b)||!!kn["Hangul Syllables"](b)||!!kn.Hiragana(b)||!!kn["Ideographic Description Characters"](b)||!!kn.Kanbun(b)||!!kn["Kangxi Radicals"](b)||!!kn["Katakana Phonetic Extensions"](b)||!(!kn.Katakana(b)||b===12540)||!(!kn["Halfwidth and Fullwidth Forms"](b)||b===65288||b===65289||b===65293||b>=65306&&b<=65310||b===65339||b===65341||b===65343||b>=65371&&b<=65503||b===65507||b>=65512&&b<=65519)||!(!kn["Small Form Variants"](b)||b>=65112&&b<=65118||b>=65123&&b<=65126)||!!kn["Unified Canadian Aboriginal Syllabics"](b)||!!kn["Unified Canadian Aboriginal Syllabics Extended"](b)||!!kn["Vertical Forms"](b)||!!kn["Yijing Hexagram Symbols"](b)||!!kn["Yi Syllables"](b)||!!kn["Yi Radicals"](b))}function Oa(b){return!(ha(b)||function(I){return!(!kn["Latin-1 Supplement"](I)||I!==167&&I!==169&&I!==174&&I!==177&&I!==188&&I!==189&&I!==190&&I!==215&&I!==247)||!(!kn["General Punctuation"](I)||I!==8214&&I!==8224&&I!==8225&&I!==8240&&I!==8241&&I!==8251&&I!==8252&&I!==8258&&I!==8263&&I!==8264&&I!==8265&&I!==8273)||!!kn["Letterlike Symbols"](I)||!!kn["Number Forms"](I)||!(!kn["Miscellaneous Technical"](I)||!(I>=8960&&I<=8967||I>=8972&&I<=8991||I>=8996&&I<=9e3||I===9003||I>=9085&&I<=9114||I>=9150&&I<=9165||I===9167||I>=9169&&I<=9179||I>=9186&&I<=9215))||!(!kn["Control Pictures"](I)||I===9251)||!!kn["Optical Character Recognition"](I)||!!kn["Enclosed Alphanumerics"](I)||!!kn["Geometric Shapes"](I)||!(!kn["Miscellaneous Symbols"](I)||I>=9754&&I<=9759)||!(!kn["Miscellaneous Symbols and Arrows"](I)||!(I>=11026&&I<=11055||I>=11088&&I<=11097||I>=11192&&I<=11243))||!!kn["CJK Symbols and Punctuation"](I)||!!kn.Katakana(I)||!!kn["Private Use Area"](I)||!!kn["CJK Compatibility Forms"](I)||!!kn["Small Form Variants"](I)||!!kn["Halfwidth and Fullwidth Forms"](I)||I===8734||I===8756||I===8757||I>=9984&&I<=10087||I>=10102&&I<=10131||I===65532||I===65533}(b))}function wa(b){return b>=1424&&b<=2303||kn["Arabic Presentation Forms-A"](b)||kn["Arabic Presentation Forms-B"](b)}function Ka(b,I){return!(!I&&wa(b))&&!(b>=2304&&b<=3583||b>=3840&&b<=4255||kn.Khmer(b))}function Qn(b){for(var I=0,V=b;I<V.length;I+=1)if(wa(V[I].charCodeAt(0)))return!0;return!1}var Ga="deferred",Fi="loading",Xo="loaded",Io="error",po=null,ma="unavailable",hi=null,mo=function(b){b&&typeof b=="string"&&b.indexOf("NetworkError")>-1&&(ma=Io),po&&po(b)};function Ya(){_i.fire(new _e("pluginStateChange",{pluginStatus:ma,pluginURL:hi}))}var _i=new Ce,Ui=function(){return ma},$a=function(){if(ma!==Ga||!hi)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");ma=Fi,Ya(),hi&&xt({url:hi},function(b){b?mo(b):(ma=Xo,Ya())})},so={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return ma===Xo||so.applyArabicShaping!=null},isLoading:function(){return ma===Fi},setState:function(b){ma=b.pluginStatus,hi=b.pluginURL},isParsed:function(){return so.applyArabicShaping!=null&&so.processBidirectionalText!=null&&so.processStyledBidirectionalText!=null},getPluginURL:function(){return hi}},ei=function(b,I){this.zoom=b,I?(this.now=I.now,this.fadeDuration=I.fadeDuration,this.zoomHistory=I.zoomHistory,this.transition=I.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Ma,this.transition={})};ei.prototype.isSupportedScript=function(b){return function(I,V){for(var re=0,fe=I;re<fe.length;re+=1)if(!Ka(fe[re].charCodeAt(0),V))return!1;return!0}(b,so.isLoaded())},ei.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},ei.prototype.getCrossfadeParameters=function(){var b=this.zoom,I=b-Math.floor(b),V=this.crossFadingFactor();return b>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:I+(1-I)*V}:{fromScale:.5,toScale:1,t:1-(1-V)*I}};var $i=function(b,I){this.property=b,this.value=I,this.expression=function(V,re){if(Re(V))return new gr(V,re);if(Jt(V)){var fe=dr(V,re);if(fe.result==="error")throw new Error(fe.value.map(function(Ae){return Ae.key+": "+Ae.message}).join(", "));return fe.value}var ge=V;return typeof V=="string"&&re.type==="color"&&(ge=sr.parse(V)),{kind:"constant",evaluate:function(){return ge}}}(I===void 0?b.specification.default:I,b.specification)};$i.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},$i.prototype.possiblyEvaluate=function(b,I,V){return this.property.possiblyEvaluate(this,b,I,V)};var os=function(b){this.property=b,this.value=new $i(b,void 0)};os.prototype.transitioned=function(b,I){return new Fs(this.property,this.value,I,d({},b.transition,this.transition),b.now)},os.prototype.untransitioned=function(){return new Fs(this.property,this.value,null,{},0)};var es=function(b){this._properties=b,this._values=Object.create(b.defaultTransitionablePropertyValues)};es.prototype.getValue=function(b){return w(this._values[b].value.value)},es.prototype.setValue=function(b,I){this._values.hasOwnProperty(b)||(this._values[b]=new os(this._values[b].property)),this._values[b].value=new $i(this._values[b].property,I===null?void 0:w(I))},es.prototype.getTransition=function(b){return w(this._values[b].transition)},es.prototype.setTransition=function(b,I){this._values.hasOwnProperty(b)||(this._values[b]=new os(this._values[b].property)),this._values[b].transition=w(I)||void 0},es.prototype.serialize=function(){for(var b={},I=0,V=Object.keys(this._values);I<V.length;I+=1){var re=V[I],fe=this.getValue(re);fe!==void 0&&(b[re]=fe);var ge=this.getTransition(re);ge!==void 0&&(b[re+"-transition"]=ge)}return b},es.prototype.transitioned=function(b,I){for(var V=new Ii(this._properties),re=0,fe=Object.keys(this._values);re<fe.length;re+=1){var ge=fe[re];V._values[ge]=this._values[ge].transitioned(b,I._values[ge])}return V},es.prototype.untransitioned=function(){for(var b=new Ii(this._properties),I=0,V=Object.keys(this._values);I<V.length;I+=1){var re=V[I];b._values[re]=this._values[re].untransitioned()}return b};var Fs=function(b,I,V,re,fe){this.property=b,this.value=I,this.begin=fe+re.delay||0,this.end=this.begin+re.duration||0,b.specification.transition&&(re.delay||re.duration)&&(this.prior=V)};Fs.prototype.possiblyEvaluate=function(b,I,V){var re=b.now||0,fe=this.value.possiblyEvaluate(b,I,V),ge=this.prior;if(ge){if(re>this.end)return this.prior=null,fe;if(this.value.isDataDriven())return this.prior=null,fe;if(re<this.begin)return ge.possiblyEvaluate(b,I,V);var Ae=(re-this.begin)/(this.end-this.begin);return this.property.interpolate(ge.possiblyEvaluate(b,I,V),fe,function(ze){if(ze<=0)return 0;if(ze>=1)return 1;var Ze=ze*ze,st=Ze*ze;return 4*(ze<.5?st:3*(ze-Ze)+st-.75)}(Ae))}return fe};var Ii=function(b){this._properties=b,this._values=Object.create(b.defaultTransitioningPropertyValues)};Ii.prototype.possiblyEvaluate=function(b,I,V){for(var re=new ts(this._properties),fe=0,ge=Object.keys(this._values);fe<ge.length;fe+=1){var Ae=ge[fe];re._values[Ae]=this._values[Ae].possiblyEvaluate(b,I,V)}return re},Ii.prototype.hasTransition=function(){for(var b=0,I=Object.keys(this._values);b<I.length;b+=1){var V=I[b];if(this._values[V].prior)return!0}return!1};var Bs=function(b){this._properties=b,this._values=Object.create(b.defaultPropertyValues)};Bs.prototype.getValue=function(b){return w(this._values[b].value)},Bs.prototype.setValue=function(b,I){this._values[b]=new $i(this._values[b].property,I===null?void 0:w(I))},Bs.prototype.serialize=function(){for(var b={},I=0,V=Object.keys(this._values);I<V.length;I+=1){var re=V[I],fe=this.getValue(re);fe!==void 0&&(b[re]=fe)}return b},Bs.prototype.possiblyEvaluate=function(b,I,V){for(var re=new ts(this._properties),fe=0,ge=Object.keys(this._values);fe<ge.length;fe+=1){var Ae=ge[fe];re._values[Ae]=this._values[Ae].possiblyEvaluate(b,I,V)}return re};var Oi=function(b,I,V){this.property=b,this.value=I,this.parameters=V};Oi.prototype.isConstant=function(){return this.value.kind==="constant"},Oi.prototype.constantOr=function(b){return this.value.kind==="constant"?this.value.value:b},Oi.prototype.evaluate=function(b,I,V,re){return this.property.evaluate(this.value,this.parameters,b,I,V,re)};var ts=function(b){this._properties=b,this._values=Object.create(b.defaultPossiblyEvaluatedValues)};ts.prototype.get=function(b){return this._values[b]};var oa=function(b){this.specification=b};oa.prototype.possiblyEvaluate=function(b,I){return b.expression.evaluate(I)},oa.prototype.interpolate=function(b,I,V){var re=gn[this.specification.type];return re?re(b,I,V):b};var ga=function(b,I){this.specification=b,this.overrides=I};ga.prototype.possiblyEvaluate=function(b,I,V,re){return b.expression.kind==="constant"||b.expression.kind==="camera"?new Oi(this,{kind:"constant",value:b.expression.evaluate(I,null,{},V,re)},I):new Oi(this,b.expression,I)},ga.prototype.interpolate=function(b,I,V){if(b.value.kind!=="constant"||I.value.kind!=="constant")return b;if(b.value.value===void 0||I.value.value===void 0)return new Oi(this,{kind:"constant",value:void 0},b.parameters);var re=gn[this.specification.type];return re?new Oi(this,{kind:"constant",value:re(b.value.value,I.value.value,V)},b.parameters):b},ga.prototype.evaluate=function(b,I,V,re,fe,ge){return b.kind==="constant"?b.value:b.evaluate(I,V,re,fe,ge)};var Ns=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.possiblyEvaluate=function(V,re,fe,ge){if(V.value===void 0)return new Oi(this,{kind:"constant",value:void 0},re);if(V.expression.kind==="constant"){var Ae=V.expression.evaluate(re,null,{},fe,ge),ze=V.property.specification.type==="resolvedImage"&&typeof Ae!="string"?Ae.name:Ae,Ze=this._calculate(ze,ze,ze,re);return new Oi(this,{kind:"constant",value:Ze},re)}if(V.expression.kind==="camera"){var st=this._calculate(V.expression.evaluate({zoom:re.zoom-1}),V.expression.evaluate({zoom:re.zoom}),V.expression.evaluate({zoom:re.zoom+1}),re);return new Oi(this,{kind:"constant",value:st},re)}return new Oi(this,V.expression,re)},I.prototype.evaluate=function(V,re,fe,ge,Ae,ze){if(V.kind==="source"){var Ze=V.evaluate(re,fe,ge,Ae,ze);return this._calculate(Ze,Ze,Ze,re)}return V.kind==="composite"?this._calculate(V.evaluate({zoom:Math.floor(re.zoom)-1},fe,ge),V.evaluate({zoom:Math.floor(re.zoom)},fe,ge),V.evaluate({zoom:Math.floor(re.zoom)+1},fe,ge),re):V.value},I.prototype._calculate=function(V,re,fe,ge){return ge.zoom>ge.zoomHistory.lastIntegerZoom?{from:V,to:re}:{from:fe,to:re}},I.prototype.interpolate=function(V){return V},I}(ga),js=function(b){this.specification=b};js.prototype.possiblyEvaluate=function(b,I,V,re){if(b.value!==void 0){if(b.expression.kind==="constant"){var fe=b.expression.evaluate(I,null,{},V,re);return this._calculate(fe,fe,fe,I)}return this._calculate(b.expression.evaluate(new ei(Math.floor(I.zoom-1),I)),b.expression.evaluate(new ei(Math.floor(I.zoom),I)),b.expression.evaluate(new ei(Math.floor(I.zoom+1),I)),I)}},js.prototype._calculate=function(b,I,V,re){return re.zoom>re.zoomHistory.lastIntegerZoom?{from:b,to:I}:{from:V,to:I}},js.prototype.interpolate=function(b){return b};var rs=function(b){this.specification=b};rs.prototype.possiblyEvaluate=function(b,I,V,re){return!!b.expression.evaluate(I,null,{},V,re)},rs.prototype.interpolate=function(){return!1};var Eo=function(b){for(var I in this.properties=b,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],b){var V=b[I];V.specification.overridable&&this.overridableProperties.push(I);var re=this.defaultPropertyValues[I]=new $i(V,void 0),fe=this.defaultTransitionablePropertyValues[I]=new os(V);this.defaultTransitioningPropertyValues[I]=fe.untransitioned(),this.defaultPossiblyEvaluatedValues[I]=re.possiblyEvaluate({})}};Yr("DataDrivenProperty",ga),Yr("DataConstantProperty",oa),Yr("CrossFadedDataDrivenProperty",Ns),Yr("CrossFadedProperty",js),Yr("ColorRampProperty",rs);var qo=function(b){function I(V,re){if(b.call(this),this.id=V.id,this.type=V.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},V.type!=="custom"&&(V=V,this.metadata=V.metadata,this.minzoom=V.minzoom,this.maxzoom=V.maxzoom,V.type!=="background"&&(this.source=V.source,this.sourceLayer=V["source-layer"],this.filter=V.filter),re.layout&&(this._unevaluatedLayout=new Bs(re.layout)),re.paint)){for(var fe in this._transitionablePaint=new es(re.paint),V.paint)this.setPaintProperty(fe,V.paint[fe],{validate:!1});for(var ge in V.layout)this.setLayoutProperty(ge,V.layout[ge],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ts(re.paint)}}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},I.prototype.getLayoutProperty=function(V){return V==="visibility"?this.visibility:this._unevaluatedLayout.getValue(V)},I.prototype.setLayoutProperty=function(V,re,fe){if(fe===void 0&&(fe={}),re!=null){var ge="layers."+this.id+".layout."+V;if(this._validate(dn,ge,V,re,fe))return}V!=="visibility"?this._unevaluatedLayout.setValue(V,re):this.visibility=re},I.prototype.getPaintProperty=function(V){return T(V,"-transition")?this._transitionablePaint.getTransition(V.slice(0,-"-transition".length)):this._transitionablePaint.getValue(V)},I.prototype.setPaintProperty=function(V,re,fe){if(fe===void 0&&(fe={}),re!=null){var ge="layers."+this.id+".paint."+V;if(this._validate(nn,ge,V,re,fe))return!1}if(T(V,"-transition"))return this._transitionablePaint.setTransition(V.slice(0,-"-transition".length),re||void 0),!1;var Ae=this._transitionablePaint._values[V],ze=Ae.property.specification["property-type"]==="cross-faded-data-driven",Ze=Ae.value.isDataDriven(),st=Ae.value;this._transitionablePaint.setValue(V,re),this._handleSpecialPaintPropertyUpdate(V);var pt=this._transitionablePaint._values[V].value;return pt.isDataDriven()||Ze||ze||this._handleOverridablePaintPropertyUpdate(V,st,pt)},I.prototype._handleSpecialPaintPropertyUpdate=function(V){},I.prototype._handleOverridablePaintPropertyUpdate=function(V,re,fe){return!1},I.prototype.isHidden=function(V){return!!(this.minzoom&&V<this.minzoom)||!!(this.maxzoom&&V>=this.maxzoom)||this.visibility==="none"},I.prototype.updateTransitions=function(V){this._transitioningPaint=this._transitionablePaint.transitioned(V,this._transitioningPaint)},I.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},I.prototype.recalculate=function(V,re){V.getCrossfadeParameters&&(this._crossfadeParameters=V.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(V,void 0,re)),this.paint=this._transitioningPaint.possiblyEvaluate(V,void 0,re)},I.prototype.serialize=function(){var V={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(V.layout=V.layout||{},V.layout.visibility=this.visibility),S(V,function(re,fe){return!(re===void 0||fe==="layout"&&!Object.keys(re).length||fe==="paint"&&!Object.keys(re).length)})},I.prototype._validate=function(V,re,fe,ge,Ae){return Ae===void 0&&(Ae={}),(!Ae||Ae.validate!==!1)&&bn(this,V.call(qr,{key:re,layerType:this.type,objectKey:fe,value:ge,styleSpec:Pe,style:{glyphs:!0,sprite:!0}}))},I.prototype.is3D=function(){return!1},I.prototype.isTileClipped=function(){return!1},I.prototype.hasOffscreenPass=function(){return!1},I.prototype.resize=function(){},I.prototype.isStateDependent=function(){for(var V in this.paint._values){var re=this.paint.get(V);if(re instanceof Oi&&Ho(re.property.specification)&&(re.value.kind==="source"||re.value.kind==="composite")&&re.value.isStateDependent)return!0}return!1},I}(Ce),$s={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Ms=function(b,I){this._structArray=b,this._pos1=I*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Wa=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function ti(b,I){I===void 0&&(I=1);var V=0,re=0;return{members:b.map(function(fe){var ge,Ae=(ge=fe.type,$s[ge].BYTES_PER_ELEMENT),ze=V=ms(V,Math.max(I,Ae)),Ze=fe.components||1;return re=Math.max(re,Ae),V+=Ae*Ze,{name:fe.name,type:fe.type,components:Ze,offset:ze}}),size:ms(V,Math.max(re,I)),alignment:I}}function ms(b,I){return Math.ceil(b/I)*I}Wa.serialize=function(b,I){return b._trim(),I&&(b.isTransferred=!0,I.push(b.arrayBuffer)),{length:b.length,arrayBuffer:b.arrayBuffer}},Wa.deserialize=function(b){var I=Object.create(this.prototype);return I.arrayBuffer=b.arrayBuffer,I.length=b.length,I.capacity=b.arrayBuffer.byteLength/I.bytesPerElement,I._refreshViews(),I},Wa.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Wa.prototype.clear=function(){this.length=0},Wa.prototype.resize=function(b){this.reserve(b),this.length=b},Wa.prototype.reserve=function(b){if(b>this.capacity){this.capacity=Math.max(b,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var I=this.uint8;this._refreshViews(),I&&this.uint8.set(I)}},Wa.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var ss=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(V,re){var fe=this.length;return this.resize(fe+1),this.emplace(fe,V,re)},I.prototype.emplace=function(V,re,fe){var ge=2*V;return this.int16[ge+0]=re,this.int16[ge+1]=fe,V},I}(Wa);ss.prototype.bytesPerElement=4,Yr("StructArrayLayout2i4",ss);var Ei=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(V,re,fe,ge){var Ae=this.length;return this.resize(Ae+1),this.emplace(Ae,V,re,fe,ge)},I.prototype.emplace=function(V,re,fe,ge,Ae){var ze=4*V;return this.int16[ze+0]=re,this.int16[ze+1]=fe,this.int16[ze+2]=ge,this.int16[ze+3]=Ae,V},I}(Wa);Ei.prototype.bytesPerElement=8,Yr("StructArrayLayout4i8",Ei);var gs=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(V,re,fe,ge,Ae,ze){var Ze=this.length;return this.resize(Ze+1),this.emplace(Ze,V,re,fe,ge,Ae,ze)},I.prototype.emplace=function(V,re,fe,ge,Ae,ze,Ze){var st=6*V;return this.int16[st+0]=re,this.int16[st+1]=fe,this.int16[st+2]=ge,this.int16[st+3]=Ae,this.int16[st+4]=ze,this.int16[st+5]=Ze,V},I}(Wa);gs.prototype.bytesPerElement=12,Yr("StructArrayLayout2i4i12",gs);var Ss=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(V,re,fe,ge,Ae,ze){var Ze=this.length;return this.resize(Ze+1),this.emplace(Ze,V,re,fe,ge,Ae,ze)},I.prototype.emplace=function(V,re,fe,ge,Ae,ze,Ze){var st=4*V,pt=8*V;return this.int16[st+0]=re,this.int16[st+1]=fe,this.uint8[pt+4]=ge,this.uint8[pt+5]=Ae,this.uint8[pt+6]=ze,this.uint8[pt+7]=Ze,V},I}(Wa);Ss.prototype.bytesPerElement=8,Yr("StructArrayLayout2i4ub8",Ss);var bs=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(V,re,fe,ge,Ae,ze,Ze,st,pt,Rt){var Gt=this.length;return this.resize(Gt+1),this.emplace(Gt,V,re,fe,ge,Ae,ze,Ze,st,pt,Rt)},I.prototype.emplace=function(V,re,fe,ge,Ae,ze,Ze,st,pt,Rt,Gt){var Ut=9*V,rr=18*V;return this.uint16[Ut+0]=re,this.uint16[Ut+1]=fe,this.uint16[Ut+2]=ge,this.uint16[Ut+3]=Ae,this.uint16[Ut+4]=ze,this.uint16[Ut+5]=Ze,this.uint16[Ut+6]=st,this.uint16[Ut+7]=pt,this.uint8[rr+16]=Rt,this.uint8[rr+17]=Gt,V},I}(Wa);bs.prototype.bytesPerElement=18,Yr("StructArrayLayout8ui2ub18",bs);var Es=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(V,re,fe,ge,Ae,ze,Ze,st,pt,Rt,Gt,Ut){var rr=this.length;return this.resize(rr+1),this.emplace(rr,V,re,fe,ge,Ae,ze,Ze,st,pt,Rt,Gt,Ut)},I.prototype.emplace=function(V,re,fe,ge,Ae,ze,Ze,st,pt,Rt,Gt,Ut,rr){var pr=12*V;return this.int16[pr+0]=re,this.int16[pr+1]=fe,this.int16[pr+2]=ge,this.int16[pr+3]=Ae,this.uint16[pr+4]=ze,this.uint16[pr+5]=Ze,this.uint16[pr+6]=st,this.uint16[pr+7]=pt,this.int16[pr+8]=Rt,this.int16[pr+9]=Gt,this.int16[pr+10]=Ut,this.int16[pr+11]=rr,V},I}(Wa);Es.prototype.bytesPerElement=24,Yr("StructArrayLayout4i4ui4i24",Es);var ls=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},I.prototype.emplaceBack=function(V,re,fe){var ge=this.length;return this.resize(ge+1),this.emplace(ge,V,re,fe)},I.prototype.emplace=function(V,re,fe,ge){var Ae=3*V;return this.float32[Ae+0]=re,this.float32[Ae+1]=fe,this.float32[Ae+2]=ge,V},I}(Wa);ls.prototype.bytesPerElement=12,Yr("StructArrayLayout3f12",ls);var el=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},I.prototype.emplaceBack=function(V){var re=this.length;return this.resize(re+1),this.emplace(re,V)},I.prototype.emplace=function(V,re){var fe=1*V;return this.uint32[fe+0]=re,V},I}(Wa);el.prototype.bytesPerElement=4,Yr("StructArrayLayout1ul4",el);var cl=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(V,re,fe,ge,Ae,ze,Ze,st,pt){var Rt=this.length;return this.resize(Rt+1),this.emplace(Rt,V,re,fe,ge,Ae,ze,Ze,st,pt)},I.prototype.emplace=function(V,re,fe,ge,Ae,ze,Ze,st,pt,Rt){var Gt=10*V,Ut=5*V;return this.int16[Gt+0]=re,this.int16[Gt+1]=fe,this.int16[Gt+2]=ge,this.int16[Gt+3]=Ae,this.int16[Gt+4]=ze,this.int16[Gt+5]=Ze,this.uint32[Ut+3]=st,this.uint16[Gt+8]=pt,this.uint16[Gt+9]=Rt,V},I}(Wa);cl.prototype.bytesPerElement=20,Yr("StructArrayLayout6i1ul2ui20",cl);var vs=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(V,re,fe,ge,Ae,ze){var Ze=this.length;return this.resize(Ze+1),this.emplace(Ze,V,re,fe,ge,Ae,ze)},I.prototype.emplace=function(V,re,fe,ge,Ae,ze,Ze){var st=6*V;return this.int16[st+0]=re,this.int16[st+1]=fe,this.int16[st+2]=ge,this.int16[st+3]=Ae,this.int16[st+4]=ze,this.int16[st+5]=Ze,V},I}(Wa);vs.prototype.bytesPerElement=12,Yr("StructArrayLayout2i2i2i12",vs);var tl=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(V,re,fe,ge,Ae){var ze=this.length;return this.resize(ze+1),this.emplace(ze,V,re,fe,ge,Ae)},I.prototype.emplace=function(V,re,fe,ge,Ae,ze){var Ze=4*V,st=8*V;return this.float32[Ze+0]=re,this.float32[Ze+1]=fe,this.float32[Ze+2]=ge,this.int16[st+6]=Ae,this.int16[st+7]=ze,V},I}(Wa);tl.prototype.bytesPerElement=16,Yr("StructArrayLayout2f1f2i16",tl);var Ls=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},I.prototype.emplaceBack=function(V,re,fe,ge){var Ae=this.length;return this.resize(Ae+1),this.emplace(Ae,V,re,fe,ge)},I.prototype.emplace=function(V,re,fe,ge,Ae){var ze=12*V,Ze=3*V;return this.uint8[ze+0]=re,this.uint8[ze+1]=fe,this.float32[Ze+1]=ge,this.float32[Ze+2]=Ae,V},I}(Wa);Ls.prototype.bytesPerElement=12,Yr("StructArrayLayout2ub2f12",Ls);var eo=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(V,re,fe){var ge=this.length;return this.resize(ge+1),this.emplace(ge,V,re,fe)},I.prototype.emplace=function(V,re,fe,ge){var Ae=3*V;return this.uint16[Ae+0]=re,this.uint16[Ae+1]=fe,this.uint16[Ae+2]=ge,V},I}(Wa);eo.prototype.bytesPerElement=6,Yr("StructArrayLayout3ui6",eo);var ul=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},I.prototype.emplaceBack=function(V,re,fe,ge,Ae,ze,Ze,st,pt,Rt,Gt,Ut,rr,pr,Sr,Mr,Dr){var Rr=this.length;return this.resize(Rr+1),this.emplace(Rr,V,re,fe,ge,Ae,ze,Ze,st,pt,Rt,Gt,Ut,rr,pr,Sr,Mr,Dr)},I.prototype.emplace=function(V,re,fe,ge,Ae,ze,Ze,st,pt,Rt,Gt,Ut,rr,pr,Sr,Mr,Dr,Rr){var Ur=24*V,cn=12*V,vn=48*V;return this.int16[Ur+0]=re,this.int16[Ur+1]=fe,this.uint16[Ur+2]=ge,this.uint16[Ur+3]=Ae,this.uint32[cn+2]=ze,this.uint32[cn+3]=Ze,this.uint32[cn+4]=st,this.uint16[Ur+10]=pt,this.uint16[Ur+11]=Rt,this.uint16[Ur+12]=Gt,this.float32[cn+7]=Ut,this.float32[cn+8]=rr,this.uint8[vn+36]=pr,this.uint8[vn+37]=Sr,this.uint8[vn+38]=Mr,this.uint32[cn+10]=Dr,this.int16[Ur+22]=Rr,V},I}(Wa);ul.prototype.bytesPerElement=48,Yr("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",ul);var fl=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},I.prototype.emplaceBack=function(V,re,fe,ge,Ae,ze,Ze,st,pt,Rt,Gt,Ut,rr,pr,Sr,Mr,Dr,Rr,Ur,cn,vn,Fn,Dn,Hn,ra,na,Xn,ua){var la=this.length;return this.resize(la+1),this.emplace(la,V,re,fe,ge,Ae,ze,Ze,st,pt,Rt,Gt,Ut,rr,pr,Sr,Mr,Dr,Rr,Ur,cn,vn,Fn,Dn,Hn,ra,na,Xn,ua)},I.prototype.emplace=function(V,re,fe,ge,Ae,ze,Ze,st,pt,Rt,Gt,Ut,rr,pr,Sr,Mr,Dr,Rr,Ur,cn,vn,Fn,Dn,Hn,ra,na,Xn,ua,la){var aa=34*V,Xa=17*V;return this.int16[aa+0]=re,this.int16[aa+1]=fe,this.int16[aa+2]=ge,this.int16[aa+3]=Ae,this.int16[aa+4]=ze,this.int16[aa+5]=Ze,this.int16[aa+6]=st,this.int16[aa+7]=pt,this.uint16[aa+8]=Rt,this.uint16[aa+9]=Gt,this.uint16[aa+10]=Ut,this.uint16[aa+11]=rr,this.uint16[aa+12]=pr,this.uint16[aa+13]=Sr,this.uint16[aa+14]=Mr,this.uint16[aa+15]=Dr,this.uint16[aa+16]=Rr,this.uint16[aa+17]=Ur,this.uint16[aa+18]=cn,this.uint16[aa+19]=vn,this.uint16[aa+20]=Fn,this.uint16[aa+21]=Dn,this.uint16[aa+22]=Hn,this.uint32[Xa+12]=ra,this.float32[Xa+13]=na,this.float32[Xa+14]=Xn,this.float32[Xa+15]=ua,this.float32[Xa+16]=la,V},I}(Wa);fl.prototype.bytesPerElement=68,Yr("StructArrayLayout8i15ui1ul4f68",fl);var oe=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},I.prototype.emplaceBack=function(V){var re=this.length;return this.resize(re+1),this.emplace(re,V)},I.prototype.emplace=function(V,re){var fe=1*V;return this.float32[fe+0]=re,V},I}(Wa);oe.prototype.bytesPerElement=4,Yr("StructArrayLayout1f4",oe);var E=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(V,re,fe){var ge=this.length;return this.resize(ge+1),this.emplace(ge,V,re,fe)},I.prototype.emplace=function(V,re,fe,ge){var Ae=3*V;return this.int16[Ae+0]=re,this.int16[Ae+1]=fe,this.int16[Ae+2]=ge,V},I}(Wa);E.prototype.bytesPerElement=6,Yr("StructArrayLayout3i6",E);var z=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(V,re,fe){var ge=this.length;return this.resize(ge+1),this.emplace(ge,V,re,fe)},I.prototype.emplace=function(V,re,fe,ge){var Ae=2*V,ze=4*V;return this.uint32[Ae+0]=re,this.uint16[ze+2]=fe,this.uint16[ze+3]=ge,V},I}(Wa);z.prototype.bytesPerElement=8,Yr("StructArrayLayout1ul2ui8",z);var R=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(V,re){var fe=this.length;return this.resize(fe+1),this.emplace(fe,V,re)},I.prototype.emplace=function(V,re,fe){var ge=2*V;return this.uint16[ge+0]=re,this.uint16[ge+1]=fe,V},I}(Wa);R.prototype.bytesPerElement=4,Yr("StructArrayLayout2ui4",R);var U=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(V){var re=this.length;return this.resize(re+1),this.emplace(re,V)},I.prototype.emplace=function(V,re){var fe=1*V;return this.uint16[fe+0]=re,V},I}(Wa);U.prototype.bytesPerElement=2,Yr("StructArrayLayout1ui2",U);var ne=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},I.prototype.emplaceBack=function(V,re){var fe=this.length;return this.resize(fe+1),this.emplace(fe,V,re)},I.prototype.emplace=function(V,re,fe){var ge=2*V;return this.float32[ge+0]=re,this.float32[ge+1]=fe,V},I}(Wa);ne.prototype.bytesPerElement=8,Yr("StructArrayLayout2f8",ne);var le=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},I.prototype.emplaceBack=function(V,re,fe,ge){var Ae=this.length;return this.resize(Ae+1),this.emplace(Ae,V,re,fe,ge)},I.prototype.emplace=function(V,re,fe,ge,Ae){var ze=4*V;return this.float32[ze+0]=re,this.float32[ze+1]=fe,this.float32[ze+2]=ge,this.float32[ze+3]=Ae,V},I}(Wa);le.prototype.bytesPerElement=16,Yr("StructArrayLayout4f16",le);var pe=function(b){function I(){b.apply(this,arguments)}b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I;var V={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return V.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},V.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},V.x1.get=function(){return this._structArray.int16[this._pos2+2]},V.y1.get=function(){return this._structArray.int16[this._pos2+3]},V.x2.get=function(){return this._structArray.int16[this._pos2+4]},V.y2.get=function(){return this._structArray.int16[this._pos2+5]},V.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},V.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},V.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},V.anchorPoint.get=function(){return new s(this.anchorPointX,this.anchorPointY)},Object.defineProperties(I.prototype,V),I}(Ms);pe.prototype.size=20;var ye=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.get=function(V){return new pe(this,V)},I}(cl);Yr("CollisionBoxArray",ye);var Te=function(b){function I(){b.apply(this,arguments)}b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I;var V={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return V.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},V.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},V.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},V.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},V.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},V.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},V.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},V.segment.get=function(){return this._structArray.uint16[this._pos2+10]},V.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},V.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},V.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},V.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},V.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},V.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},V.placedOrientation.set=function(re){this._structArray.uint8[this._pos1+37]=re},V.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},V.hidden.set=function(re){this._structArray.uint8[this._pos1+38]=re},V.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},V.crossTileID.set=function(re){this._structArray.uint32[this._pos4+10]=re},V.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(I.prototype,V),I}(Ms);Te.prototype.size=48;var Ne=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.get=function(V){return new Te(this,V)},I}(ul);Yr("PlacedSymbolArray",Ne);var qe=function(b){function I(){b.apply(this,arguments)}b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I;var V={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return V.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},V.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},V.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},V.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},V.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},V.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},V.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},V.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},V.key.get=function(){return this._structArray.uint16[this._pos2+8]},V.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},V.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},V.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},V.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},V.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},V.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},V.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},V.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},V.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},V.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},V.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},V.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},V.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},V.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},V.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},V.crossTileID.set=function(re){this._structArray.uint32[this._pos4+12]=re},V.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},V.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},V.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},V.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(I.prototype,V),I}(Ms);qe.prototype.size=68;var tt=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.get=function(V){return new qe(this,V)},I}(fl);Yr("SymbolInstanceArray",tt);var yt=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.getoffsetX=function(V){return this.float32[1*V+0]},I}(oe);Yr("GlyphOffsetArray",yt);var St=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.getx=function(V){return this.int16[3*V+0]},I.prototype.gety=function(V){return this.int16[3*V+1]},I.prototype.gettileUnitDistanceFromAnchor=function(V){return this.int16[3*V+2]},I}(E);Yr("SymbolLineVertexArray",St);var _t=function(b){function I(){b.apply(this,arguments)}b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I;var V={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return V.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},V.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},V.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(I.prototype,V),I}(Ms);_t.prototype.size=8;var Tt=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.get=function(V){return new _t(this,V)},I}(z);Yr("FeatureIndexArray",Tt);var gt=ti([{name:"a_pos",components:2,type:"Int16"}],4).members,Dt=function(b){b===void 0&&(b=[]),this.segments=b};function Ot(b,I){return 256*(b=r(Math.floor(b),0,255))+(I=r(Math.floor(I),0,255))}Dt.prototype.prepareSegment=function(b,I,V,re){var fe=this.segments[this.segments.length-1];return b>Dt.MAX_VERTEX_ARRAY_LENGTH&&k("Max vertices per segment is "+Dt.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+b),(!fe||fe.vertexLength+b>Dt.MAX_VERTEX_ARRAY_LENGTH||fe.sortKey!==re)&&(fe={vertexOffset:I.length,primitiveOffset:V.length,vertexLength:0,primitiveLength:0},re!==void 0&&(fe.sortKey=re),this.segments.push(fe)),fe},Dt.prototype.get=function(){return this.segments},Dt.prototype.destroy=function(){for(var b=0,I=this.segments;b<I.length;b+=1){var V=I[b];for(var re in V.vaos)V.vaos[re].destroy()}},Dt.simpleSegment=function(b,I,V,re){return new Dt([{vertexOffset:b,primitiveOffset:I,vertexLength:V,primitiveLength:re,vaos:{},sortKey:0}])},Dt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Yr("SegmentVector",Dt);var Bt=ti([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint8"},{name:"a_pixel_ratio_to",components:1,type:"Uint8"}]),er=f(function(b){b.exports=function(I,V){var re,fe,ge,Ae,ze,Ze,st,pt;for(re=3&I.length,fe=I.length-re,ge=V,ze=3432918353,Ze=461845907,pt=0;pt<fe;)st=255&I.charCodeAt(pt)|(255&I.charCodeAt(++pt))<<8|(255&I.charCodeAt(++pt))<<16|(255&I.charCodeAt(++pt))<<24,++pt,ge=27492+(65535&(Ae=5*(65535&(ge=(ge^=st=(65535&(st=(st=(65535&st)*ze+(((st>>>16)*ze&65535)<<16)&4294967295)<<15|st>>>17))*Ze+(((st>>>16)*Ze&65535)<<16)&4294967295)<<13|ge>>>19))+((5*(ge>>>16)&65535)<<16)&4294967295))+((58964+(Ae>>>16)&65535)<<16);switch(st=0,re){case 3:st^=(255&I.charCodeAt(pt+2))<<16;case 2:st^=(255&I.charCodeAt(pt+1))<<8;case 1:ge^=st=(65535&(st=(st=(65535&(st^=255&I.charCodeAt(pt)))*ze+(((st>>>16)*ze&65535)<<16)&4294967295)<<15|st>>>17))*Ze+(((st>>>16)*Ze&65535)<<16)&4294967295}return ge^=I.length,ge=2246822507*(65535&(ge^=ge>>>16))+((2246822507*(ge>>>16)&65535)<<16)&4294967295,ge=3266489909*(65535&(ge^=ge>>>13))+((3266489909*(ge>>>16)&65535)<<16)&4294967295,(ge^=ge>>>16)>>>0}}),ur=f(function(b){b.exports=function(I,V){for(var re,fe=I.length,ge=V^fe,Ae=0;fe>=4;)re=1540483477*(65535&(re=255&I.charCodeAt(Ae)|(255&I.charCodeAt(++Ae))<<8|(255&I.charCodeAt(++Ae))<<16|(255&I.charCodeAt(++Ae))<<24))+((1540483477*(re>>>16)&65535)<<16),ge=1540483477*(65535&ge)+((1540483477*(ge>>>16)&65535)<<16)^(re=1540483477*(65535&(re^=re>>>24))+((1540483477*(re>>>16)&65535)<<16)),fe-=4,++Ae;switch(fe){case 3:ge^=(255&I.charCodeAt(Ae+2))<<16;case 2:ge^=(255&I.charCodeAt(Ae+1))<<8;case 1:ge=1540483477*(65535&(ge^=255&I.charCodeAt(Ae)))+((1540483477*(ge>>>16)&65535)<<16)}return ge=1540483477*(65535&(ge^=ge>>>13))+((1540483477*(ge>>>16)&65535)<<16),(ge^=ge>>>15)>>>0}}),Tr=er,wr=er,Xr=ur;Tr.murmur3=wr,Tr.murmur2=Xr;var Wr=function(){this.ids=[],this.positions=[],this.indexed=!1};Wr.prototype.add=function(b,I,V,re){this.ids.push(an(b)),this.positions.push(I,V,re)},Wr.prototype.getPositions=function(b){for(var I=an(b),V=0,re=this.ids.length-1;V<re;){var fe=V+re>>1;this.ids[fe]>=I?re=fe:V=fe+1}for(var ge=[];this.ids[V]===I;){var Ae=this.positions[3*V],ze=this.positions[3*V+1],Ze=this.positions[3*V+2];ge.push({index:Ae,start:ze,end:Ze}),V++}return ge},Wr.serialize=function(b,I){var V=new Float64Array(b.ids),re=new Uint32Array(b.positions);return function fe(ge,Ae,ze,Ze){for(;ze<Ze;){for(var st=ge[ze+Ze>>1],pt=ze-1,Rt=Ze+1;;){do pt++;while(ge[pt]<st);do Rt--;while(ge[Rt]>st);if(pt>=Rt)break;Nn(ge,pt,Rt),Nn(Ae,3*pt,3*Rt),Nn(Ae,3*pt+1,3*Rt+1),Nn(Ae,3*pt+2,3*Rt+2)}Rt-ze<Ze-Rt?(fe(ge,Ae,ze,Rt),ze=Rt+1):(fe(ge,Ae,Rt+1,Ze),Ze=Rt)}}(V,re,0,V.length-1),I&&I.push(V.buffer,re.buffer),{ids:V,positions:re}},Wr.deserialize=function(b){var I=new Wr;return I.ids=b.ids,I.positions=b.positions,I.indexed=!0,I};var un=Math.pow(2,53)-1;function an(b){var I=+b;return!isNaN(I)&&I<=un?I:Tr(String(b))}function Nn(b,I,V){var re=b[I];b[I]=b[V],b[V]=re}Yr("FeaturePositionMap",Wr);var Yn=function(b,I){this.gl=b.gl,this.location=I},sa=function(b){function I(V,re){b.call(this,V,re),this.current=0}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.set=function(V){this.current!==V&&(this.current=V,this.gl.uniform1i(this.location,V))},I}(Yn),Nr=function(b){function I(V,re){b.call(this,V,re),this.current=0}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.set=function(V){this.current!==V&&(this.current=V,this.gl.uniform1f(this.location,V))},I}(Yn),wn=function(b){function I(V,re){b.call(this,V,re),this.current=[0,0]}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.set=function(V){V[0]===this.current[0]&&V[1]===this.current[1]||(this.current=V,this.gl.uniform2f(this.location,V[0],V[1]))},I}(Yn),Wn=function(b){function I(V,re){b.call(this,V,re),this.current=[0,0,0]}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.set=function(V){V[0]===this.current[0]&&V[1]===this.current[1]&&V[2]===this.current[2]||(this.current=V,this.gl.uniform3f(this.location,V[0],V[1],V[2]))},I}(Yn),Vn=function(b){function I(V,re){b.call(this,V,re),this.current=[0,0,0,0]}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.set=function(V){V[0]===this.current[0]&&V[1]===this.current[1]&&V[2]===this.current[2]&&V[3]===this.current[3]||(this.current=V,this.gl.uniform4f(this.location,V[0],V[1],V[2],V[3]))},I}(Yn),$n=function(b){function I(V,re){b.call(this,V,re),this.current=sr.transparent}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.set=function(V){V.r===this.current.r&&V.g===this.current.g&&V.b===this.current.b&&V.a===this.current.a||(this.current=V,this.gl.uniform4f(this.location,V.r,V.g,V.b,V.a))},I}(Yn),ca=new Float32Array(16),Ta=function(b){function I(V,re){b.call(this,V,re),this.current=ca}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.set=function(V){if(V[12]!==this.current[12]||V[0]!==this.current[0])return this.current=V,void this.gl.uniformMatrix4fv(this.location,!1,V);for(var re=1;re<16;re++)if(V[re]!==this.current[re]){this.current=V,this.gl.uniformMatrix4fv(this.location,!1,V);break}},I}(Yn);function Zn(b){return[Ot(255*b.r,255*b.g),Ot(255*b.b,255*b.a)]}var va=function(b,I,V){this.value=b,this.uniformNames=I.map(function(re){return"u_"+re}),this.type=V};va.prototype.setUniform=function(b,I,V){b.set(V.constantOr(this.value))},va.prototype.getBinding=function(b,I,V){return this.type==="color"?new $n(b,I):new Nr(b,I)};var da=function(b,I){this.uniformNames=I.map(function(V){return"u_"+V}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};da.prototype.setConstantPatternPositions=function(b,I){this.pixelRatioFrom=I.pixelRatio,this.pixelRatioTo=b.pixelRatio,this.patternFrom=I.tlbr,this.patternTo=b.tlbr},da.prototype.setUniform=function(b,I,V,re){var fe=re==="u_pattern_to"?this.patternTo:re==="u_pattern_from"?this.patternFrom:re==="u_pixel_ratio_to"?this.pixelRatioTo:re==="u_pixel_ratio_from"?this.pixelRatioFrom:null;fe&&b.set(fe)},da.prototype.getBinding=function(b,I,V){return V.substr(0,9)==="u_pattern"?new Vn(b,I):new Nr(b,I)};var Sa=function(b,I,V,re){this.expression=b,this.type=V,this.maxValue=0,this.paintVertexAttributes=I.map(function(fe){return{name:"a_"+fe,type:"Float32",components:V==="color"?2:1,offset:0}}),this.paintVertexArray=new re};Sa.prototype.populatePaintArray=function(b,I,V,re,fe){var ge=this.paintVertexArray.length,Ae=this.expression.evaluate(new ei(0),I,{},re,[],fe);this.paintVertexArray.resize(b),this._setPaintValue(ge,b,Ae)},Sa.prototype.updatePaintArray=function(b,I,V,re){var fe=this.expression.evaluate({zoom:0},V,re);this._setPaintValue(b,I,fe)},Sa.prototype._setPaintValue=function(b,I,V){if(this.type==="color")for(var re=Zn(V),fe=b;fe<I;fe++)this.paintVertexArray.emplace(fe,re[0],re[1]);else{for(var ge=b;ge<I;ge++)this.paintVertexArray.emplace(ge,V);this.maxValue=Math.max(this.maxValue,Math.abs(V))}},Sa.prototype.upload=function(b){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=b.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Sa.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var ya=function(b,I,V,re,fe,ge){this.expression=b,this.uniformNames=I.map(function(Ae){return"u_"+Ae+"_t"}),this.type=V,this.useIntegerZoom=re,this.zoom=fe,this.maxValue=0,this.paintVertexAttributes=I.map(function(Ae){return{name:"a_"+Ae,type:"Float32",components:V==="color"?4:2,offset:0}}),this.paintVertexArray=new ge};ya.prototype.populatePaintArray=function(b,I,V,re,fe){var ge=this.expression.evaluate(new ei(this.zoom),I,{},re,[],fe),Ae=this.expression.evaluate(new ei(this.zoom+1),I,{},re,[],fe),ze=this.paintVertexArray.length;this.paintVertexArray.resize(b),this._setPaintValue(ze,b,ge,Ae)},ya.prototype.updatePaintArray=function(b,I,V,re){var fe=this.expression.evaluate({zoom:this.zoom},V,re),ge=this.expression.evaluate({zoom:this.zoom+1},V,re);this._setPaintValue(b,I,fe,ge)},ya.prototype._setPaintValue=function(b,I,V,re){if(this.type==="color")for(var fe=Zn(V),ge=Zn(re),Ae=b;Ae<I;Ae++)this.paintVertexArray.emplace(Ae,fe[0],fe[1],ge[0],ge[1]);else{for(var ze=b;ze<I;ze++)this.paintVertexArray.emplace(ze,V,re);this.maxValue=Math.max(this.maxValue,Math.abs(V),Math.abs(re))}},ya.prototype.upload=function(b){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=b.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},ya.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},ya.prototype.setUniform=function(b,I){var V=this.useIntegerZoom?Math.floor(I.zoom):I.zoom,re=r(this.expression.interpolationFactor(V,this.zoom,this.zoom+1),0,1);b.set(re)},ya.prototype.getBinding=function(b,I,V){return new Nr(b,I)};var Ea=function(b,I,V,re,fe,ge){this.expression=b,this.type=I,this.useIntegerZoom=V,this.zoom=re,this.layerId=ge,this.zoomInPaintVertexArray=new fe,this.zoomOutPaintVertexArray=new fe};Ea.prototype.populatePaintArray=function(b,I,V){var re=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(b),this.zoomOutPaintVertexArray.resize(b),this._setPaintValues(re,b,I.patterns&&I.patterns[this.layerId],V)},Ea.prototype.updatePaintArray=function(b,I,V,re,fe){this._setPaintValues(b,I,V.patterns&&V.patterns[this.layerId],fe)},Ea.prototype._setPaintValues=function(b,I,V,re){if(re&&V){var fe=V.min,ge=V.mid,Ae=V.max,ze=re[fe],Ze=re[ge],st=re[Ae];if(ze&&Ze&&st)for(var pt=b;pt<I;pt++)this.zoomInPaintVertexArray.emplace(pt,Ze.tl[0],Ze.tl[1],Ze.br[0],Ze.br[1],ze.tl[0],ze.tl[1],ze.br[0],ze.br[1],Ze.pixelRatio,ze.pixelRatio),this.zoomOutPaintVertexArray.emplace(pt,Ze.tl[0],Ze.tl[1],Ze.br[0],Ze.br[1],st.tl[0],st.tl[1],st.br[0],st.br[1],Ze.pixelRatio,st.pixelRatio)}},Ea.prototype.upload=function(b){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=b.createVertexBuffer(this.zoomInPaintVertexArray,Bt.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=b.createVertexBuffer(this.zoomOutPaintVertexArray,Bt.members,this.expression.isStateDependent))},Ea.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Ba=function(b,I,V,re){this.binders={},this.layoutAttributes=re,this._buffers=[];var fe=[];for(var ge in b.paint._values)if(V(ge)){var Ae=b.paint.get(ge);if(Ae instanceof Oi&&Ho(Ae.property.specification)){var ze=Li(ge,b.type),Ze=Ae.value,st=Ae.property.specification.type,pt=Ae.property.useIntegerZoom,Rt=Ae.property.specification["property-type"],Gt=Rt==="cross-faded"||Rt==="cross-faded-data-driven";if(Ze.kind==="constant")this.binders[ge]=Gt?new da(Ze.value,ze):new va(Ze.value,ze,st),fe.push("/u_"+ge);else if(Ze.kind==="source"||Gt){var Ut=Ci(ge,st,"source");this.binders[ge]=Gt?new Ea(Ze,st,pt,I,Ut,b.id):new Sa(Ze,ze,st,Ut),fe.push("/a_"+ge)}else{var rr=Ci(ge,st,"composite");this.binders[ge]=new ya(Ze,ze,st,pt,I,rr),fe.push("/z_"+ge)}}}this.cacheKey=fe.sort().join("")};Ba.prototype.getMaxValue=function(b){var I=this.binders[b];return I instanceof Sa||I instanceof ya?I.maxValue:0},Ba.prototype.populatePaintArrays=function(b,I,V,re,fe){for(var ge in this.binders){var Ae=this.binders[ge];(Ae instanceof Sa||Ae instanceof ya||Ae instanceof Ea)&&Ae.populatePaintArray(b,I,V,re,fe)}},Ba.prototype.setConstantPatternPositions=function(b,I){for(var V in this.binders){var re=this.binders[V];re instanceof da&&re.setConstantPatternPositions(b,I)}},Ba.prototype.updatePaintArrays=function(b,I,V,re,fe){var ge=!1;for(var Ae in b)for(var ze=0,Ze=I.getPositions(Ae);ze<Ze.length;ze+=1){var st=Ze[ze],pt=V.feature(st.index);for(var Rt in this.binders){var Gt=this.binders[Rt];if((Gt instanceof Sa||Gt instanceof ya||Gt instanceof Ea)&&Gt.expression.isStateDependent===!0){var Ut=re.paint.get(Rt);Gt.expression=Ut.value,Gt.updatePaintArray(st.start,st.end,pt,b[Ae],fe),ge=!0}}}return ge},Ba.prototype.defines=function(){var b=[];for(var I in this.binders){var V=this.binders[I];(V instanceof va||V instanceof da)&&b.push.apply(b,V.uniformNames.map(function(re){return"#define HAS_UNIFORM_"+re}))}return b},Ba.prototype.getPaintVertexBuffers=function(){return this._buffers},Ba.prototype.getUniforms=function(b,I){var V=[];for(var re in this.binders){var fe=this.binders[re];if(fe instanceof va||fe instanceof da||fe instanceof ya)for(var ge=0,Ae=fe.uniformNames;ge<Ae.length;ge+=1){var ze=Ae[ge];if(I[ze]){var Ze=fe.getBinding(b,I[ze],ze);V.push({name:ze,property:re,binding:Ze})}}}return V},Ba.prototype.setUniforms=function(b,I,V,re){for(var fe=0,ge=I;fe<ge.length;fe+=1){var Ae=ge[fe],ze=Ae.name,Ze=Ae.property,st=Ae.binding;this.binders[Ze].setUniform(st,re,V.get(Ze),ze)}},Ba.prototype.updatePaintBuffers=function(b){for(var I in this._buffers=[],this.binders){var V=this.binders[I];if(b&&V instanceof Ea){var re=b.fromScale===2?V.zoomInPaintVertexBuffer:V.zoomOutPaintVertexBuffer;re&&this._buffers.push(re)}else(V instanceof Sa||V instanceof ya)&&V.paintVertexBuffer&&this._buffers.push(V.paintVertexBuffer)}},Ba.prototype.upload=function(b){for(var I in this.binders){var V=this.binders[I];(V instanceof Sa||V instanceof ya||V instanceof Ea)&&V.upload(b)}this.updatePaintBuffers()},Ba.prototype.destroy=function(){for(var b in this.binders){var I=this.binders[b];(I instanceof Sa||I instanceof ya||I instanceof Ea)&&I.destroy()}};var li=function(b,I,V,re){re===void 0&&(re=function(){return!0}),this.programConfigurations={};for(var fe=0,ge=I;fe<ge.length;fe+=1){var Ae=ge[fe];this.programConfigurations[Ae.id]=new Ba(Ae,V,re,b)}this.needsUpload=!1,this._featureMap=new Wr,this._bufferOffset=0};function Li(b,I){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[b]||[b.replace(I+"-","").replace(/-/g,"_")]}function Ci(b,I,V){var re={color:{source:ne,composite:le},number:{source:oe,composite:ne}},fe=function(ge){return{"line-pattern":{source:bs,composite:bs},"fill-pattern":{source:bs,composite:bs},"fill-extrusion-pattern":{source:bs,composite:bs}}[ge]}(b);return fe&&fe[V]||re[I][V]}li.prototype.populatePaintArrays=function(b,I,V,re,fe,ge){for(var Ae in this.programConfigurations)this.programConfigurations[Ae].populatePaintArrays(b,I,re,fe,ge);I.id!==void 0&&this._featureMap.add(I.id,V,this._bufferOffset,b),this._bufferOffset=b,this.needsUpload=!0},li.prototype.updatePaintArrays=function(b,I,V,re){for(var fe=0,ge=V;fe<ge.length;fe+=1){var Ae=ge[fe];this.needsUpload=this.programConfigurations[Ae.id].updatePaintArrays(b,this._featureMap,I,Ae,re)||this.needsUpload}},li.prototype.get=function(b){return this.programConfigurations[b]},li.prototype.upload=function(b){if(this.needsUpload){for(var I in this.programConfigurations)this.programConfigurations[I].upload(b);this.needsUpload=!1}},li.prototype.destroy=function(){for(var b in this.programConfigurations)this.programConfigurations[b].destroy()},Yr("ConstantBinder",va),Yr("CrossFadedConstantBinder",da),Yr("SourceExpressionBinder",Sa),Yr("CrossFadedCompositeBinder",Ea),Yr("CompositeExpressionBinder",ya),Yr("ProgramConfiguration",Ba,{omit:["_buffers"]}),Yr("ProgramConfigurationSet",li);var si,wi=(si=15,{min:-1*Math.pow(2,si-1),max:Math.pow(2,si-1)-1});function pi(b){for(var I=8192/b.extent,V=b.loadGeometry(),re=0;re<V.length;re++)for(var fe=V[re],ge=0;ge<fe.length;ge++){var Ae=fe[ge];Ae.x=Math.round(Ae.x*I),Ae.y=Math.round(Ae.y*I),(Ae.x<wi.min||Ae.x>wi.max||Ae.y<wi.min||Ae.y>wi.max)&&(k("Geometry exceeds allowed extent, reduce your vector tile buffer size"),Ae.x=r(Ae.x,wi.min,wi.max),Ae.y=r(Ae.y,wi.min,wi.max))}return V}function go(b,I,V,re,fe){b.emplaceBack(2*I+(re+1)/2,2*V+(fe+1)/2)}var Vi=function(b){this.zoom=b.zoom,this.overscaling=b.overscaling,this.layers=b.layers,this.layerIds=this.layers.map(function(I){return I.id}),this.index=b.index,this.hasPattern=!1,this.layoutVertexArray=new ss,this.indexArray=new eo,this.segments=new Dt,this.programConfigurations=new li(gt,b.layers,b.zoom),this.stateDependentLayerIds=this.layers.filter(function(I){return I.isStateDependent()}).map(function(I){return I.id})};function Oo(b,I){for(var V=0;V<b.length;V++)if(ns(I,b[V]))return!0;for(var re=0;re<I.length;re++)if(ns(b,I[re]))return!0;return!!rl(b,I)}function _s(b,I,V){return!!ns(b,I)||!!vo(I,b,V)}function Us(b,I){if(b.length===1)return pl(I,b[0]);for(var V=0;V<I.length;V++)for(var re=I[V],fe=0;fe<re.length;fe++)if(ns(b,re[fe]))return!0;for(var ge=0;ge<b.length;ge++)if(pl(I,b[ge]))return!0;for(var Ae=0;Ae<I.length;Ae++)if(rl(b,I[Ae]))return!0;return!1}function hl(b,I,V){if(b.length>1){if(rl(b,I))return!0;for(var re=0;re<I.length;re++)if(vo(I[re],b,V))return!0}for(var fe=0;fe<b.length;fe++)if(vo(b[fe],I,V))return!0;return!1}function rl(b,I){if(b.length===0||I.length===0)return!1;for(var V=0;V<b.length-1;V++)for(var re=b[V],fe=b[V+1],ge=0;ge<I.length-1;ge++)if(nl(re,fe,I[ge],I[ge+1]))return!0;return!1}function nl(b,I,V,re){return C(b,V,re)!==C(I,V,re)&&C(b,I,V)!==C(b,I,re)}function vo(b,I,V){var re=V*V;if(I.length===1)return b.distSqr(I[0])<re;for(var fe=1;fe<I.length;fe++)if(Gs(b,I[fe-1],I[fe])<re)return!0;return!1}function Gs(b,I,V){var re=I.distSqr(V);if(re===0)return b.distSqr(I);var fe=((b.x-I.x)*(V.x-I.x)+(b.y-I.y)*(V.y-I.y))/re;return fe<0?b.distSqr(I):fe>1?b.distSqr(V):b.distSqr(V.sub(I)._mult(fe)._add(I))}function pl(b,I){for(var V,re,fe,ge=!1,Ae=0;Ae<b.length;Ae++)for(var ze=0,Ze=(V=b[Ae]).length-1;ze<V.length;Ze=ze++)re=V[ze],fe=V[Ze],re.y>I.y!=fe.y>I.y&&I.x<(fe.x-re.x)*(I.y-re.y)/(fe.y-re.y)+re.x&&(ge=!ge);return ge}function ns(b,I){for(var V=!1,re=0,fe=b.length-1;re<b.length;fe=re++){var ge=b[re],Ae=b[fe];ge.y>I.y!=Ae.y>I.y&&I.x<(Ae.x-ge.x)*(I.y-ge.y)/(Ae.y-ge.y)+ge.x&&(V=!V)}return V}function dl(b,I,V){var re=V[0],fe=V[2];if(b.x<re.x&&I.x<re.x||b.x>fe.x&&I.x>fe.x||b.y<re.y&&I.y<re.y||b.y>fe.y&&I.y>fe.y)return!1;var ge=C(b,I,V[0]);return ge!==C(b,I,V[1])||ge!==C(b,I,V[2])||ge!==C(b,I,V[3])}function Ti(b,I,V){var re=I.paint.get(b).value;return re.kind==="constant"?re.value:V.programConfigurations.get(I.id).getMaxValue(b)}function Lo(b){return Math.sqrt(b[0]*b[0]+b[1]*b[1])}function Co(b,I,V,re,fe){if(!I[0]&&!I[1])return b;var ge=s.convert(I)._mult(fe);V==="viewport"&&ge._rotate(-re);for(var Ae=[],ze=0;ze<b.length;ze++){var Ze=b[ze];Ae.push(Ze.sub(ge))}return Ae}Vi.prototype.populate=function(b,I,V){var re=this.layers[0],fe=[],ge=null;re.type==="circle"&&(ge=re.layout.get("circle-sort-key"));for(var Ae=0,ze=b;Ae<ze.length;Ae+=1){var Ze=ze[Ae],st=Ze.feature,pt=Ze.id,Rt=Ze.index,Gt=Ze.sourceLayerIndex,Ut=this.layers[0]._featureFilter.needGeometry,rr={type:st.type,id:pt,properties:st.properties,geometry:Ut?pi(st):[]};if(this.layers[0]._featureFilter.filter(new ei(this.zoom),rr,V)){Ut||(rr.geometry=pi(st));var pr=ge?ge.evaluate(rr,{},V):void 0,Sr={id:pt,properties:st.properties,type:st.type,sourceLayerIndex:Gt,index:Rt,geometry:rr.geometry,patterns:{},sortKey:pr};fe.push(Sr)}}ge&&fe.sort(function(Hn,ra){return Hn.sortKey-ra.sortKey});for(var Mr=0,Dr=fe;Mr<Dr.length;Mr+=1){var Rr=Dr[Mr],Ur=Rr,cn=Ur.geometry,vn=Ur.index,Fn=Ur.sourceLayerIndex,Dn=b[vn].feature;this.addFeature(Rr,cn,vn,V),I.featureIndex.insert(Dn,cn,vn,Fn,this.index)}},Vi.prototype.update=function(b,I,V){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(b,I,this.stateDependentLayers,V)},Vi.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Vi.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Vi.prototype.upload=function(b){this.uploaded||(this.layoutVertexBuffer=b.createVertexBuffer(this.layoutVertexArray,gt),this.indexBuffer=b.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(b),this.uploaded=!0},Vi.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Vi.prototype.addFeature=function(b,I,V,re){for(var fe=0,ge=I;fe<ge.length;fe+=1)for(var Ae=0,ze=ge[fe];Ae<ze.length;Ae+=1){var Ze=ze[Ae],st=Ze.x,pt=Ze.y;if(!(st<0||st>=8192||pt<0||pt>=8192)){var Rt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,b.sortKey),Gt=Rt.vertexLength;go(this.layoutVertexArray,st,pt,-1,-1),go(this.layoutVertexArray,st,pt,1,-1),go(this.layoutVertexArray,st,pt,1,1),go(this.layoutVertexArray,st,pt,-1,1),this.indexArray.emplaceBack(Gt,Gt+1,Gt+2),this.indexArray.emplaceBack(Gt,Gt+3,Gt+2),Rt.vertexLength+=4,Rt.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,b,V,{},re)},Yr("CircleBucket",Vi,{omit:["layers"]});var Tl=new Eo({"circle-sort-key":new ga(Pe.layout_circle["circle-sort-key"])}),ou={paint:new Eo({"circle-radius":new ga(Pe.paint_circle["circle-radius"]),"circle-color":new ga(Pe.paint_circle["circle-color"]),"circle-blur":new ga(Pe.paint_circle["circle-blur"]),"circle-opacity":new ga(Pe.paint_circle["circle-opacity"]),"circle-translate":new oa(Pe.paint_circle["circle-translate"]),"circle-translate-anchor":new oa(Pe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new oa(Pe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new oa(Pe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ga(Pe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ga(Pe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ga(Pe.paint_circle["circle-stroke-opacity"])}),layout:Tl},Zo=typeof Float32Array!="undefined"?Float32Array:Array;function Jl(b){return b[0]=1,b[1]=0,b[2]=0,b[3]=0,b[4]=0,b[5]=1,b[6]=0,b[7]=0,b[8]=0,b[9]=0,b[10]=1,b[11]=0,b[12]=0,b[13]=0,b[14]=0,b[15]=1,b}function ml(b,I,V){var re=I[0],fe=I[1],ge=I[2],Ae=I[3],ze=I[4],Ze=I[5],st=I[6],pt=I[7],Rt=I[8],Gt=I[9],Ut=I[10],rr=I[11],pr=I[12],Sr=I[13],Mr=I[14],Dr=I[15],Rr=V[0],Ur=V[1],cn=V[2],vn=V[3];return b[0]=Rr*re+Ur*ze+cn*Rt+vn*pr,b[1]=Rr*fe+Ur*Ze+cn*Gt+vn*Sr,b[2]=Rr*ge+Ur*st+cn*Ut+vn*Mr,b[3]=Rr*Ae+Ur*pt+cn*rr+vn*Dr,Rr=V[4],Ur=V[5],cn=V[6],vn=V[7],b[4]=Rr*re+Ur*ze+cn*Rt+vn*pr,b[5]=Rr*fe+Ur*Ze+cn*Gt+vn*Sr,b[6]=Rr*ge+Ur*st+cn*Ut+vn*Mr,b[7]=Rr*Ae+Ur*pt+cn*rr+vn*Dr,Rr=V[8],Ur=V[9],cn=V[10],vn=V[11],b[8]=Rr*re+Ur*ze+cn*Rt+vn*pr,b[9]=Rr*fe+Ur*Ze+cn*Gt+vn*Sr,b[10]=Rr*ge+Ur*st+cn*Ut+vn*Mr,b[11]=Rr*Ae+Ur*pt+cn*rr+vn*Dr,Rr=V[12],Ur=V[13],cn=V[14],vn=V[15],b[12]=Rr*re+Ur*ze+cn*Rt+vn*pr,b[13]=Rr*fe+Ur*Ze+cn*Gt+vn*Sr,b[14]=Rr*ge+Ur*st+cn*Ut+vn*Mr,b[15]=Rr*Ae+Ur*pt+cn*rr+vn*Dr,b}Math.hypot||(Math.hypot=function(){for(var b=arguments,I=0,V=arguments.length;V--;)I+=b[V]*b[V];return Math.sqrt(I)});var su=ml,Ys,lu=function(b,I,V){return b[0]=I[0]-V[0],b[1]=I[1]-V[1],b[2]=I[2]-V[2],b};Ys=new Zo(3),Zo!=Float32Array&&(Ys[0]=0,Ys[1]=0,Ys[2]=0);function kl(b,I,V){var re=I[0],fe=I[1],ge=I[2],Ae=I[3];return b[0]=V[0]*re+V[4]*fe+V[8]*ge+V[12]*Ae,b[1]=V[1]*re+V[5]*fe+V[9]*ge+V[13]*Ae,b[2]=V[2]*re+V[6]*fe+V[10]*ge+V[14]*Ae,b[3]=V[3]*re+V[7]*fe+V[11]*ge+V[15]*Ae,b}(function(){(function(){var b=new Zo(4);return Zo!=Float32Array&&(b[0]=0,b[1]=0,b[2]=0,b[3]=0),b})()})();var Kl=function(b){var I=b[0],V=b[1];return I*I+V*V},ap=(function(){(function(){var b=new Zo(2);return Zo!=Float32Array&&(b[0]=0,b[1]=0),b})()}(),function(b){function I(V){b.call(this,V,ou)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.createBucket=function(V){return new Vi(V)},I.prototype.queryRadius=function(V){var re=V;return Ti("circle-radius",this,re)+Ti("circle-stroke-width",this,re)+Lo(this.paint.get("circle-translate"))},I.prototype.queryIntersectsFeature=function(V,re,fe,ge,Ae,ze,Ze,st){for(var pt=Co(V,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),ze.angle,Ze),Rt=this.paint.get("circle-radius").evaluate(re,fe)+this.paint.get("circle-stroke-width").evaluate(re,fe),Gt=this.paint.get("circle-pitch-alignment")==="map",Ut=Gt?pt:function(Fn,Dn){return Fn.map(function(Hn){return Qu(Hn,Dn)})}(pt,st),rr=Gt?Rt*Ze:Rt,pr=0,Sr=ge;pr<Sr.length;pr+=1)for(var Mr=0,Dr=Sr[pr];Mr<Dr.length;Mr+=1){var Rr=Dr[Mr],Ur=Gt?Rr:Qu(Rr,st),cn=rr,vn=kl([],[Rr.x,Rr.y,0,1],st);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?cn*=vn[3]/ze.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(cn*=ze.cameraToCenterDistance/vn[3]),_s(Ut,Ur,cn))return!0}return!1},I}(qo));function Qu(b,I){var V=kl([],[b.x,b.y,0,1],I);return new s(V[0]/V[3],V[1]/V[3])}var $u=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I}(Vi);function cu(b,I,V,re){var fe=I.width,ge=I.height;if(re){if(re instanceof Uint8ClampedArray)re=new Uint8Array(re.buffer);else if(re.length!==fe*ge*V)throw new RangeError("mismatched image size")}else re=new Uint8Array(fe*ge*V);return b.width=fe,b.height=ge,b.data=re,b}function ef(b,I,V){var re=I.width,fe=I.height;if(re!==b.width||fe!==b.height){var ge=cu({},{width:re,height:fe},V);uu(b,ge,{x:0,y:0},{x:0,y:0},{width:Math.min(b.width,re),height:Math.min(b.height,fe)},V),b.width=re,b.height=fe,b.data=ge.data}}function uu(b,I,V,re,fe,ge){if(fe.width===0||fe.height===0)return I;if(fe.width>b.width||fe.height>b.height||V.x>b.width-fe.width||V.y>b.height-fe.height)throw new RangeError("out of range source coordinates for image copy");if(fe.width>I.width||fe.height>I.height||re.x>I.width-fe.width||re.y>I.height-fe.height)throw new RangeError("out of range destination coordinates for image copy");for(var Ae=b.data,ze=I.data,Ze=0;Ze<fe.height;Ze++)for(var st=((V.y+Ze)*b.width+V.x)*ge,pt=((re.y+Ze)*I.width+re.x)*ge,Rt=0;Rt<fe.width*ge;Rt++)ze[pt+Rt]=Ae[st+Rt];return I}Yr("HeatmapBucket",$u,{omit:["layers"]});var vl=function(b,I){cu(this,b,1,I)};vl.prototype.resize=function(b){ef(this,b,1)},vl.prototype.clone=function(){return new vl({width:this.width,height:this.height},new Uint8Array(this.data))},vl.copy=function(b,I,V,re,fe){uu(b,I,V,re,fe,1)};var Jo=function(b,I){cu(this,b,4,I)};Jo.prototype.resize=function(b){ef(this,b,4)},Jo.prototype.replace=function(b,I){I?this.data.set(b):b instanceof Uint8ClampedArray?this.data=new Uint8Array(b.buffer):this.data=b},Jo.prototype.clone=function(){return new Jo({width:this.width,height:this.height},new Uint8Array(this.data))},Jo.copy=function(b,I,V,re,fe){uu(b,I,V,re,fe,4)},Yr("AlphaImage",vl),Yr("RGBAImage",Jo);var ip={paint:new Eo({"heatmap-radius":new ga(Pe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ga(Pe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new oa(Pe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new rs(Pe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new oa(Pe.paint_heatmap["heatmap-opacity"])})};function tf(b,I){for(var V=new Uint8Array(1024),re={},fe=0,ge=0;fe<256;fe++,ge+=4){re[I]=fe/255;var Ae=b.evaluate(re);V[ge+0]=Math.floor(255*Ae.r/Ae.a),V[ge+1]=Math.floor(255*Ae.g/Ae.a),V[ge+2]=Math.floor(255*Ae.b/Ae.a),V[ge+3]=Math.floor(255*Ae.a)}return new Jo({width:256,height:1},V)}var op=function(b){function I(V){b.call(this,V,ip),this._updateColorRamp()}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.createBucket=function(V){return new $u(V)},I.prototype._handleSpecialPaintPropertyUpdate=function(V){V==="heatmap-color"&&this._updateColorRamp()},I.prototype._updateColorRamp=function(){var V=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=tf(V,"heatmapDensity"),this.colorRampTexture=null},I.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},I.prototype.queryRadius=function(){return 0},I.prototype.queryIntersectsFeature=function(){return!1},I.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},I}(qo),sp={paint:new Eo({"hillshade-illumination-direction":new oa(Pe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new oa(Pe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new oa(Pe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new oa(Pe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new oa(Pe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new oa(Pe.paint_hillshade["hillshade-accent-color"])})},lp=function(b){function I(V){b.call(this,V,sp)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},I}(qo),rf=ti([{name:"a_pos",components:2,type:"Int16"}],4).members,fu=_c,cp=_c;function _c(b,I,V){V=V||2;var re,fe,ge,Ae,ze,Ze,st,pt=I&&I.length,Rt=pt?I[0]*V:b.length,Gt=nf(b,0,Rt,V,!0),Ut=[];if(!Gt||Gt.next===Gt.prev)return Ut;if(pt&&(Gt=function(pr,Sr,Mr,Dr){var Rr,Ur,cn,vn,Fn,Dn=[];for(Rr=0,Ur=Sr.length;Rr<Ur;Rr++)cn=Sr[Rr]*Dr,vn=Rr<Ur-1?Sr[Rr+1]*Dr:pr.length,(Fn=nf(pr,cn,vn,Dr,!1))===Fn.next&&(Fn.steiner=!0),Dn.push(vp(Fn));for(Dn.sort(dp),Rr=0;Rr<Dn.length;Rr++)mp(Dn[Rr],Mr),Mr=al(Mr,Mr.next);return Mr}(b,I,Gt,V)),b.length>80*V){re=ge=b[0],fe=Ae=b[1];for(var rr=V;rr<Rt;rr+=V)(ze=b[rr])<re&&(re=ze),(Ze=b[rr+1])<fe&&(fe=Ze),ze>ge&&(ge=ze),Ze>Ae&&(Ae=Ze);st=(st=Math.max(ge-re,Ae-fe))!==0?1/st:0}return Ql(Gt,Ut,V,re,fe,st),Ut}function nf(b,I,V,re,fe){var ge,Ae;if(fe===du(b,I,V,re)>0)for(ge=I;ge<V;ge+=re)Ae=sf(ge,b[ge],b[ge+1],Ae);else for(ge=V-re;ge>=I;ge-=re)Ae=sf(ge,b[ge],b[ge+1],Ae);return Ae&&wc(Ae,Ae.next)&&(ec(Ae),Ae=Ae.next),Ae}function al(b,I){if(!b)return b;I||(I=b);var V,re=b;do if(V=!1,re.steiner||!wc(re,re.next)&&to(re.prev,re,re.next)!==0)re=re.next;else{if(ec(re),(re=I=re.prev)===re.next)break;V=!0}while(V||re!==I);return I}function Ql(b,I,V,re,fe,ge,Ae){if(b){!Ae&&ge&&function(pt,Rt,Gt,Ut){var rr=pt;do rr.z===null&&(rr.z=hu(rr.x,rr.y,Rt,Gt,Ut)),rr.prevZ=rr.prev,rr.nextZ=rr.next,rr=rr.next;while(rr!==pt);rr.prevZ.nextZ=null,rr.prevZ=null,function(pr){var Sr,Mr,Dr,Rr,Ur,cn,vn,Fn,Dn=1;do{for(Mr=pr,pr=null,Ur=null,cn=0;Mr;){for(cn++,Dr=Mr,vn=0,Sr=0;Sr<Dn&&(vn++,Dr=Dr.nextZ);Sr++);for(Fn=Dn;vn>0||Fn>0&&Dr;)vn!==0&&(Fn===0||!Dr||Mr.z<=Dr.z)?(Rr=Mr,Mr=Mr.nextZ,vn--):(Rr=Dr,Dr=Dr.nextZ,Fn--),Ur?Ur.nextZ=Rr:pr=Rr,Rr.prevZ=Ur,Ur=Rr;Mr=Dr}Ur.nextZ=null,Dn*=2}while(cn>1)}(rr)}(b,re,fe,ge);for(var ze,Ze,st=b;b.prev!==b.next;)if(ze=b.prev,Ze=b.next,ge?fp(b,re,fe,ge):up(b))I.push(ze.i/V),I.push(b.i/V),I.push(Ze.i/V),ec(b),b=Ze.next,st=Ze.next;else if((b=Ze)===st){Ae?Ae===1?Ql(b=hp(al(b),I,V),I,V,re,fe,ge,2):Ae===2&&pp(b,I,V,re,fe,ge):Ql(al(b),I,V,re,fe,ge,1);break}}}function up(b){var I=b.prev,V=b,re=b.next;if(to(I,V,re)>=0)return!1;for(var fe=b.next.next;fe!==b.prev;){if(Al(I.x,I.y,V.x,V.y,re.x,re.y,fe.x,fe.y)&&to(fe.prev,fe,fe.next)>=0)return!1;fe=fe.next}return!0}function fp(b,I,V,re){var fe=b.prev,ge=b,Ae=b.next;if(to(fe,ge,Ae)>=0)return!1;for(var ze=fe.x<ge.x?fe.x<Ae.x?fe.x:Ae.x:ge.x<Ae.x?ge.x:Ae.x,Ze=fe.y<ge.y?fe.y<Ae.y?fe.y:Ae.y:ge.y<Ae.y?ge.y:Ae.y,st=fe.x>ge.x?fe.x>Ae.x?fe.x:Ae.x:ge.x>Ae.x?ge.x:Ae.x,pt=fe.y>ge.y?fe.y>Ae.y?fe.y:Ae.y:ge.y>Ae.y?ge.y:Ae.y,Rt=hu(ze,Ze,I,V,re),Gt=hu(st,pt,I,V,re),Ut=b.prevZ,rr=b.nextZ;Ut&&Ut.z>=Rt&&rr&&rr.z<=Gt;){if(Ut!==b.prev&&Ut!==b.next&&Al(fe.x,fe.y,ge.x,ge.y,Ae.x,Ae.y,Ut.x,Ut.y)&&to(Ut.prev,Ut,Ut.next)>=0||(Ut=Ut.prevZ,rr!==b.prev&&rr!==b.next&&Al(fe.x,fe.y,ge.x,ge.y,Ae.x,Ae.y,rr.x,rr.y)&&to(rr.prev,rr,rr.next)>=0))return!1;rr=rr.nextZ}for(;Ut&&Ut.z>=Rt;){if(Ut!==b.prev&&Ut!==b.next&&Al(fe.x,fe.y,ge.x,ge.y,Ae.x,Ae.y,Ut.x,Ut.y)&&to(Ut.prev,Ut,Ut.next)>=0)return!1;Ut=Ut.prevZ}for(;rr&&rr.z<=Gt;){if(rr!==b.prev&&rr!==b.next&&Al(fe.x,fe.y,ge.x,ge.y,Ae.x,Ae.y,rr.x,rr.y)&&to(rr.prev,rr,rr.next)>=0)return!1;rr=rr.nextZ}return!0}function hp(b,I,V){var re=b;do{var fe=re.prev,ge=re.next.next;!wc(fe,ge)&&af(fe,re,re.next,ge)&&$l(fe,ge)&&$l(ge,fe)&&(I.push(fe.i/V),I.push(re.i/V),I.push(ge.i/V),ec(re),ec(re.next),re=b=ge),re=re.next}while(re!==b);return al(re)}function pp(b,I,V,re,fe,ge){var Ae=b;do{for(var ze=Ae.next.next;ze!==Ae.prev;){if(Ae.i!==ze.i&&yp(Ae,ze)){var Ze=of(Ae,ze);return Ae=al(Ae,Ae.next),Ze=al(Ze,Ze.next),Ql(Ae,I,V,re,fe,ge),void Ql(Ze,I,V,re,fe,ge)}ze=ze.next}Ae=Ae.next}while(Ae!==b)}function dp(b,I){return b.x-I.x}function mp(b,I){if(I=function(re,fe){var ge,Ae=fe,ze=re.x,Ze=re.y,st=-1/0;do{if(Ze<=Ae.y&&Ze>=Ae.next.y&&Ae.next.y!==Ae.y){var pt=Ae.x+(Ze-Ae.y)*(Ae.next.x-Ae.x)/(Ae.next.y-Ae.y);if(pt<=ze&&pt>st){if(st=pt,pt===ze){if(Ze===Ae.y)return Ae;if(Ze===Ae.next.y)return Ae.next}ge=Ae.x<Ae.next.x?Ae:Ae.next}}Ae=Ae.next}while(Ae!==fe);if(!ge)return null;if(ze===st)return ge;var Rt,Gt=ge,Ut=ge.x,rr=ge.y,pr=1/0;Ae=ge;do ze>=Ae.x&&Ae.x>=Ut&&ze!==Ae.x&&Al(Ze<rr?ze:st,Ze,Ut,rr,Ze<rr?st:ze,Ze,Ae.x,Ae.y)&&(Rt=Math.abs(Ze-Ae.y)/(ze-Ae.x),$l(Ae,re)&&(Rt<pr||Rt===pr&&(Ae.x>ge.x||Ae.x===ge.x&&gp(ge,Ae)))&&(ge=Ae,pr=Rt)),Ae=Ae.next;while(Ae!==Gt);return ge}(b,I)){var V=of(I,b);al(I,I.next),al(V,V.next)}}function gp(b,I){return to(b.prev,b,I.prev)<0&&to(I.next,b,b.next)<0}function hu(b,I,V,re,fe){return(b=1431655765&((b=858993459&((b=252645135&((b=16711935&((b=32767*(b-V)*fe)|b<<8))|b<<4))|b<<2))|b<<1))|(I=1431655765&((I=858993459&((I=252645135&((I=16711935&((I=32767*(I-re)*fe)|I<<8))|I<<4))|I<<2))|I<<1))<<1}function vp(b){var I=b,V=b;do(I.x<V.x||I.x===V.x&&I.y<V.y)&&(V=I),I=I.next;while(I!==b);return V}function Al(b,I,V,re,fe,ge,Ae,ze){return(fe-Ae)*(I-ze)-(b-Ae)*(ge-ze)>=0&&(b-Ae)*(re-ze)-(V-Ae)*(I-ze)>=0&&(V-Ae)*(ge-ze)-(fe-Ae)*(re-ze)>=0}function yp(b,I){return b.next.i!==I.i&&b.prev.i!==I.i&&!function(V,re){var fe=V;do{if(fe.i!==V.i&&fe.next.i!==V.i&&fe.i!==re.i&&fe.next.i!==re.i&&af(fe,fe.next,V,re))return!0;fe=fe.next}while(fe!==V);return!1}(b,I)&&($l(b,I)&&$l(I,b)&&function(V,re){var fe=V,ge=!1,Ae=(V.x+re.x)/2,ze=(V.y+re.y)/2;do fe.y>ze!=fe.next.y>ze&&fe.next.y!==fe.y&&Ae<(fe.next.x-fe.x)*(ze-fe.y)/(fe.next.y-fe.y)+fe.x&&(ge=!ge),fe=fe.next;while(fe!==V);return ge}(b,I)&&(to(b.prev,b,I.prev)||to(b,I.prev,I))||wc(b,I)&&to(b.prev,b,b.next)>0&&to(I.prev,I,I.next)>0)}function to(b,I,V){return(I.y-b.y)*(V.x-I.x)-(I.x-b.x)*(V.y-I.y)}function wc(b,I){return b.x===I.x&&b.y===I.y}function af(b,I,V,re){var fe=kc(to(b,I,V)),ge=kc(to(b,I,re)),Ae=kc(to(V,re,b)),ze=kc(to(V,re,I));return fe!==ge&&Ae!==ze||!(fe!==0||!Tc(b,V,I))||!(ge!==0||!Tc(b,re,I))||!(Ae!==0||!Tc(V,b,re))||!(ze!==0||!Tc(V,I,re))}function Tc(b,I,V){return I.x<=Math.max(b.x,V.x)&&I.x>=Math.min(b.x,V.x)&&I.y<=Math.max(b.y,V.y)&&I.y>=Math.min(b.y,V.y)}function kc(b){return b>0?1:b<0?-1:0}function $l(b,I){return to(b.prev,b,b.next)<0?to(b,I,b.next)>=0&&to(b,b.prev,I)>=0:to(b,I,b.prev)<0||to(b,b.next,I)<0}function of(b,I){var V=new pu(b.i,b.x,b.y),re=new pu(I.i,I.x,I.y),fe=b.next,ge=I.prev;return b.next=I,I.prev=b,V.next=fe,fe.prev=V,re.next=V,V.prev=re,ge.next=re,re.prev=ge,re}function sf(b,I,V,re){var fe=new pu(b,I,V);return re?(fe.next=re.next,fe.prev=re,re.next.prev=fe,re.next=fe):(fe.prev=fe,fe.next=fe),fe}function ec(b){b.next.prev=b.prev,b.prev.next=b.next,b.prevZ&&(b.prevZ.nextZ=b.nextZ),b.nextZ&&(b.nextZ.prevZ=b.prevZ)}function pu(b,I,V){this.i=b,this.x=I,this.y=V,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function du(b,I,V,re){for(var fe=0,ge=I,Ae=V-re;ge<V;ge+=re)fe+=(b[Ae]-b[ge])*(b[ge+1]+b[Ae+1]),Ae=ge;return fe}function xp(b,I,V,re,fe){(function ge(Ae,ze,Ze,st,pt){for(;st>Ze;){if(st-Ze>600){var Rt=st-Ze+1,Gt=ze-Ze+1,Ut=Math.log(Rt),rr=.5*Math.exp(2*Ut/3),pr=.5*Math.sqrt(Ut*rr*(Rt-rr)/Rt)*(Gt-Rt/2<0?-1:1),Sr=Math.max(Ze,Math.floor(ze-Gt*rr/Rt+pr)),Mr=Math.min(st,Math.floor(ze+(Rt-Gt)*rr/Rt+pr));ge(Ae,ze,Sr,Mr,pt)}var Dr=Ae[ze],Rr=Ze,Ur=st;for(tc(Ae,Ze,ze),pt(Ae[st],Dr)>0&&tc(Ae,Ze,st);Rr<Ur;){for(tc(Ae,Rr,Ur),Rr++,Ur--;pt(Ae[Rr],Dr)<0;)Rr++;for(;pt(Ae[Ur],Dr)>0;)Ur--}pt(Ae[Ze],Dr)===0?tc(Ae,Ze,Ur):(Ur++,tc(Ae,Ur,st)),Ur<=ze&&(Ze=Ur+1),ze<=Ur&&(st=Ur-1)}})(b,I,V||0,re||b.length-1,fe||bp)}function tc(b,I,V){var re=b[I];b[I]=b[V],b[V]=re}function bp(b,I){return b<I?-1:b>I?1:0}function mu(b,I){var V=b.length;if(V<=1)return[b];for(var re,fe,ge=[],Ae=0;Ae<V;Ae++){var ze=M(b[Ae]);ze!==0&&(b[Ae].area=Math.abs(ze),fe===void 0&&(fe=ze<0),fe===ze<0?(re&&ge.push(re),re=[b[Ae]]):re.push(b[Ae]))}if(re&&ge.push(re),I>1)for(var Ze=0;Ze<ge.length;Ze++)ge[Ze].length<=I||(xp(ge[Ze],I,1,ge[Ze].length-1,_p),ge[Ze]=ge[Ze].slice(0,I));return ge}function _p(b,I){return I.area-b.area}function gu(b,I,V){for(var re=V.patternDependencies,fe=!1,ge=0,Ae=I;ge<Ae.length;ge+=1){var ze=Ae[ge].paint.get(b+"-pattern");ze.isConstant()||(fe=!0);var Ze=ze.constantOr(null);Ze&&(fe=!0,re[Ze.to]=!0,re[Ze.from]=!0)}return fe}function vu(b,I,V,re,fe){for(var ge=fe.patternDependencies,Ae=0,ze=I;Ae<ze.length;Ae+=1){var Ze=ze[Ae],st=Ze.paint.get(b+"-pattern").value;if(st.kind!=="constant"){var pt=st.evaluate({zoom:re-1},V,{},fe.availableImages),Rt=st.evaluate({zoom:re},V,{},fe.availableImages),Gt=st.evaluate({zoom:re+1},V,{},fe.availableImages);pt=pt&&pt.name?pt.name:pt,Rt=Rt&&Rt.name?Rt.name:Rt,Gt=Gt&&Gt.name?Gt.name:Gt,ge[pt]=!0,ge[Rt]=!0,ge[Gt]=!0,V.patterns[Ze.id]={min:pt,mid:Rt,max:Gt}}}return V}_c.deviation=function(b,I,V,re){var fe=I&&I.length,ge=fe?I[0]*V:b.length,Ae=Math.abs(du(b,0,ge,V));if(fe)for(var ze=0,Ze=I.length;ze<Ze;ze++){var st=I[ze]*V,pt=ze<Ze-1?I[ze+1]*V:b.length;Ae-=Math.abs(du(b,st,pt,V))}var Rt=0;for(ze=0;ze<re.length;ze+=3){var Gt=re[ze]*V,Ut=re[ze+1]*V,rr=re[ze+2]*V;Rt+=Math.abs((b[Gt]-b[rr])*(b[Ut+1]-b[Gt+1])-(b[Gt]-b[Ut])*(b[rr+1]-b[Gt+1]))}return Ae===0&&Rt===0?0:Math.abs((Rt-Ae)/Ae)},_c.flatten=function(b){for(var I=b[0][0].length,V={vertices:[],holes:[],dimensions:I},re=0,fe=0;fe<b.length;fe++){for(var ge=0;ge<b[fe].length;ge++)for(var Ae=0;Ae<I;Ae++)V.vertices.push(b[fe][ge][Ae]);fe>0&&(re+=b[fe-1].length,V.holes.push(re))}return V},fu.default=cp;var Cs=function(b){this.zoom=b.zoom,this.overscaling=b.overscaling,this.layers=b.layers,this.layerIds=this.layers.map(function(I){return I.id}),this.index=b.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ss,this.indexArray=new eo,this.indexArray2=new R,this.programConfigurations=new li(rf,b.layers,b.zoom),this.segments=new Dt,this.segments2=new Dt,this.stateDependentLayerIds=this.layers.filter(function(I){return I.isStateDependent()}).map(function(I){return I.id})};Cs.prototype.populate=function(b,I,V){this.hasPattern=gu("fill",this.layers,I);for(var re=this.layers[0].layout.get("fill-sort-key"),fe=[],ge=0,Ae=b;ge<Ae.length;ge+=1){var ze=Ae[ge],Ze=ze.feature,st=ze.id,pt=ze.index,Rt=ze.sourceLayerIndex,Gt=this.layers[0]._featureFilter.needGeometry,Ut={type:Ze.type,id:st,properties:Ze.properties,geometry:Gt?pi(Ze):[]};if(this.layers[0]._featureFilter.filter(new ei(this.zoom),Ut,V)){Gt||(Ut.geometry=pi(Ze));var rr=re?re.evaluate(Ut,{},V,I.availableImages):void 0,pr={id:st,properties:Ze.properties,type:Ze.type,sourceLayerIndex:Rt,index:pt,geometry:Ut.geometry,patterns:{},sortKey:rr};fe.push(pr)}}re&&fe.sort(function(Hn,ra){return Hn.sortKey-ra.sortKey});for(var Sr=0,Mr=fe;Sr<Mr.length;Sr+=1){var Dr=Mr[Sr],Rr=Dr,Ur=Rr.geometry,cn=Rr.index,vn=Rr.sourceLayerIndex;if(this.hasPattern){var Fn=vu("fill",this.layers,Dr,this.zoom,I);this.patternFeatures.push(Fn)}else this.addFeature(Dr,Ur,cn,V,{});var Dn=b[cn].feature;I.featureIndex.insert(Dn,Ur,cn,vn,this.index)}},Cs.prototype.update=function(b,I,V){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(b,I,this.stateDependentLayers,V)},Cs.prototype.addFeatures=function(b,I,V){for(var re=0,fe=this.patternFeatures;re<fe.length;re+=1){var ge=fe[re];this.addFeature(ge,ge.geometry,ge.index,I,V)}},Cs.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Cs.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Cs.prototype.upload=function(b){this.uploaded||(this.layoutVertexBuffer=b.createVertexBuffer(this.layoutVertexArray,rf),this.indexBuffer=b.createIndexBuffer(this.indexArray),this.indexBuffer2=b.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(b),this.uploaded=!0},Cs.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Cs.prototype.addFeature=function(b,I,V,re,fe){for(var ge=0,Ae=mu(I,500);ge<Ae.length;ge+=1){for(var ze=Ae[ge],Ze=0,st=0,pt=ze;st<pt.length;st+=1)Ze+=pt[st].length;for(var Rt=this.segments.prepareSegment(Ze,this.layoutVertexArray,this.indexArray),Gt=Rt.vertexLength,Ut=[],rr=[],pr=0,Sr=ze;pr<Sr.length;pr+=1){var Mr=Sr[pr];if(Mr.length!==0){Mr!==ze[0]&&rr.push(Ut.length/2);var Dr=this.segments2.prepareSegment(Mr.length,this.layoutVertexArray,this.indexArray2),Rr=Dr.vertexLength;this.layoutVertexArray.emplaceBack(Mr[0].x,Mr[0].y),this.indexArray2.emplaceBack(Rr+Mr.length-1,Rr),Ut.push(Mr[0].x),Ut.push(Mr[0].y);for(var Ur=1;Ur<Mr.length;Ur++)this.layoutVertexArray.emplaceBack(Mr[Ur].x,Mr[Ur].y),this.indexArray2.emplaceBack(Rr+Ur-1,Rr+Ur),Ut.push(Mr[Ur].x),Ut.push(Mr[Ur].y);Dr.vertexLength+=Mr.length,Dr.primitiveLength+=Mr.length}}for(var cn=fu(Ut,rr),vn=0;vn<cn.length;vn+=3)this.indexArray.emplaceBack(Gt+cn[vn],Gt+cn[vn+1],Gt+cn[vn+2]);Rt.vertexLength+=Ze,Rt.primitiveLength+=cn.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,b,V,fe,re)},Yr("FillBucket",Cs,{omit:["layers","patternFeatures"]});var wp=new Eo({"fill-sort-key":new ga(Pe.layout_fill["fill-sort-key"])}),Tp={paint:new Eo({"fill-antialias":new oa(Pe.paint_fill["fill-antialias"]),"fill-opacity":new ga(Pe.paint_fill["fill-opacity"]),"fill-color":new ga(Pe.paint_fill["fill-color"]),"fill-outline-color":new ga(Pe.paint_fill["fill-outline-color"]),"fill-translate":new oa(Pe.paint_fill["fill-translate"]),"fill-translate-anchor":new oa(Pe.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ns(Pe.paint_fill["fill-pattern"])}),layout:wp},kp=function(b){function I(V){b.call(this,V,Tp)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.recalculate=function(V,re){b.prototype.recalculate.call(this,V,re);var fe=this.paint._values["fill-outline-color"];fe.value.kind==="constant"&&fe.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},I.prototype.createBucket=function(V){return new Cs(V)},I.prototype.queryRadius=function(){return Lo(this.paint.get("fill-translate"))},I.prototype.queryIntersectsFeature=function(V,re,fe,ge,Ae,ze,Ze){return Us(Co(V,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),ze.angle,Ze),ge)},I.prototype.isTileClipped=function(){return!0},I}(qo),lf=ti([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,cf=Ml;function Ml(b,I,V,re,fe){this.properties={},this.extent=V,this.type=0,this._pbf=b,this._geometry=-1,this._keys=re,this._values=fe,b.readFields(Ap,this,I)}function Ap(b,I,V){b==1?I.id=V.readVarint():b==2?function(re,fe){for(var ge=re.readVarint()+re.pos;re.pos<ge;){var Ae=fe._keys[re.readVarint()],ze=fe._values[re.readVarint()];fe.properties[Ae]=ze}}(V,I):b==3?I.type=V.readVarint():b==4&&(I._geometry=V.pos)}function Mp(b){for(var I,V,re=0,fe=0,ge=b.length,Ae=ge-1;fe<ge;Ae=fe++)I=b[fe],re+=((V=b[Ae]).x-I.x)*(I.y+V.y);return re}Ml.types=["Unknown","Point","LineString","Polygon"],Ml.prototype.loadGeometry=function(){var b=this._pbf;b.pos=this._geometry;for(var I,V=b.readVarint()+b.pos,re=1,fe=0,ge=0,Ae=0,ze=[];b.pos<V;){if(fe<=0){var Ze=b.readVarint();re=7&Ze,fe=Ze>>3}if(fe--,re===1||re===2)ge+=b.readSVarint(),Ae+=b.readSVarint(),re===1&&(I&&ze.push(I),I=[]),I.push(new s(ge,Ae));else{if(re!==7)throw new Error("unknown command "+re);I&&I.push(I[0].clone())}}return I&&ze.push(I),ze},Ml.prototype.bbox=function(){var b=this._pbf;b.pos=this._geometry;for(var I=b.readVarint()+b.pos,V=1,re=0,fe=0,ge=0,Ae=1/0,ze=-1/0,Ze=1/0,st=-1/0;b.pos<I;){if(re<=0){var pt=b.readVarint();V=7&pt,re=pt>>3}if(re--,V===1||V===2)(fe+=b.readSVarint())<Ae&&(Ae=fe),fe>ze&&(ze=fe),(ge+=b.readSVarint())<Ze&&(Ze=ge),ge>st&&(st=ge);else if(V!==7)throw new Error("unknown command "+V)}return[Ae,Ze,ze,st]},Ml.prototype.toGeoJSON=function(b,I,V){var re,fe,ge=this.extent*Math.pow(2,V),Ae=this.extent*b,ze=this.extent*I,Ze=this.loadGeometry(),st=Ml.types[this.type];function pt(Ut){for(var rr=0;rr<Ut.length;rr++){var pr=Ut[rr],Sr=180-360*(pr.y+ze)/ge;Ut[rr]=[360*(pr.x+Ae)/ge-180,360/Math.PI*Math.atan(Math.exp(Sr*Math.PI/180))-90]}}switch(this.type){case 1:var Rt=[];for(re=0;re<Ze.length;re++)Rt[re]=Ze[re][0];pt(Ze=Rt);break;case 2:for(re=0;re<Ze.length;re++)pt(Ze[re]);break;case 3:for(Ze=function(Ut){var rr=Ut.length;if(rr<=1)return[Ut];for(var pr,Sr,Mr=[],Dr=0;Dr<rr;Dr++){var Rr=Mp(Ut[Dr]);Rr!==0&&(Sr===void 0&&(Sr=Rr<0),Sr===Rr<0?(pr&&Mr.push(pr),pr=[Ut[Dr]]):pr.push(Ut[Dr]))}return pr&&Mr.push(pr),Mr}(Ze),re=0;re<Ze.length;re++)for(fe=0;fe<Ze[re].length;fe++)pt(Ze[re][fe])}Ze.length===1?Ze=Ze[0]:st="Multi"+st;var Gt={type:"Feature",geometry:{type:st,coordinates:Ze},properties:this.properties};return"id"in this&&(Gt.id=this.id),Gt};var uf=ff;function ff(b,I){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=b,this._keys=[],this._values=[],this._features=[],b.readFields(Sp,this,I),this.length=this._features.length}function Sp(b,I,V){b===15?I.version=V.readVarint():b===1?I.name=V.readString():b===5?I.extent=V.readVarint():b===2?I._features.push(V.pos):b===3?I._keys.push(V.readString()):b===4&&I._values.push(function(re){for(var fe=null,ge=re.readVarint()+re.pos;re.pos<ge;){var Ae=re.readVarint()>>3;fe=Ae===1?re.readString():Ae===2?re.readFloat():Ae===3?re.readDouble():Ae===4?re.readVarint64():Ae===5?re.readVarint():Ae===6?re.readSVarint():Ae===7?re.readBoolean():null}return fe}(V))}function Ep(b,I,V){if(b===3){var re=new uf(V,V.readVarint()+V.pos);re.length&&(I[re.name]=re)}}ff.prototype.feature=function(b){if(b<0||b>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[b];var I=this._pbf.readVarint()+this._pbf.pos;return new cf(this._pbf,I,this.extent,this._keys,this._values)};var Sl={VectorTile:function(b,I){this.layers=b.readFields(Ep,{},I)},VectorTileFeature:cf,VectorTileLayer:uf},Lp=Sl.VectorTileFeature.types,yu=Math.pow(2,13);function rc(b,I,V,re,fe,ge,Ae,ze){b.emplaceBack(I,V,2*Math.floor(re*yu)+Ae,fe*yu*2,ge*yu*2,Math.round(ze))}var Ps=function(b){this.zoom=b.zoom,this.overscaling=b.overscaling,this.layers=b.layers,this.layerIds=this.layers.map(function(I){return I.id}),this.index=b.index,this.hasPattern=!1,this.layoutVertexArray=new gs,this.indexArray=new eo,this.programConfigurations=new li(lf,b.layers,b.zoom),this.segments=new Dt,this.stateDependentLayerIds=this.layers.filter(function(I){return I.isStateDependent()}).map(function(I){return I.id})};function Cp(b,I){return b.x===I.x&&(b.x<0||b.x>8192)||b.y===I.y&&(b.y<0||b.y>8192)}function Pp(b){return b.every(function(I){return I.x<0})||b.every(function(I){return I.x>8192})||b.every(function(I){return I.y<0})||b.every(function(I){return I.y>8192})}Ps.prototype.populate=function(b,I,V){this.features=[],this.hasPattern=gu("fill-extrusion",this.layers,I);for(var re=0,fe=b;re<fe.length;re+=1){var ge=fe[re],Ae=ge.feature,ze=ge.id,Ze=ge.index,st=ge.sourceLayerIndex,pt=this.layers[0]._featureFilter.needGeometry,Rt={type:Ae.type,id:ze,properties:Ae.properties,geometry:pt?pi(Ae):[]};if(this.layers[0]._featureFilter.filter(new ei(this.zoom),Rt,V)){var Gt={id:ze,sourceLayerIndex:st,index:Ze,geometry:pt?Rt.geometry:pi(Ae),properties:Ae.properties,type:Ae.type,patterns:{}};Ae.id!==void 0&&(Gt.id=Ae.id),this.hasPattern?this.features.push(vu("fill-extrusion",this.layers,Gt,this.zoom,I)):this.addFeature(Gt,Gt.geometry,Ze,V,{}),I.featureIndex.insert(Ae,Gt.geometry,Ze,st,this.index,!0)}}},Ps.prototype.addFeatures=function(b,I,V){for(var re=0,fe=this.features;re<fe.length;re+=1){var ge=fe[re],Ae=ge.geometry;this.addFeature(ge,Ae,ge.index,I,V)}},Ps.prototype.update=function(b,I,V){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(b,I,this.stateDependentLayers,V)},Ps.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ps.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ps.prototype.upload=function(b){this.uploaded||(this.layoutVertexBuffer=b.createVertexBuffer(this.layoutVertexArray,lf),this.indexBuffer=b.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(b),this.uploaded=!0},Ps.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ps.prototype.addFeature=function(b,I,V,re,fe){for(var ge=0,Ae=mu(I,500);ge<Ae.length;ge+=1){for(var ze=Ae[ge],Ze=0,st=0,pt=ze;st<pt.length;st+=1)Ze+=pt[st].length;for(var Rt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),Gt=0,Ut=ze;Gt<Ut.length;Gt+=1){var rr=Ut[Gt];if(rr.length!==0&&!Pp(rr))for(var pr=0,Sr=0;Sr<rr.length;Sr++){var Mr=rr[Sr];if(Sr>=1){var Dr=rr[Sr-1];if(!Cp(Mr,Dr)){Rt.vertexLength+4>Dt.MAX_VERTEX_ARRAY_LENGTH&&(Rt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var Rr=Mr.sub(Dr)._perp()._unit(),Ur=Dr.dist(Mr);pr+Ur>32768&&(pr=0),rc(this.layoutVertexArray,Mr.x,Mr.y,Rr.x,Rr.y,0,0,pr),rc(this.layoutVertexArray,Mr.x,Mr.y,Rr.x,Rr.y,0,1,pr),pr+=Ur,rc(this.layoutVertexArray,Dr.x,Dr.y,Rr.x,Rr.y,0,0,pr),rc(this.layoutVertexArray,Dr.x,Dr.y,Rr.x,Rr.y,0,1,pr);var cn=Rt.vertexLength;this.indexArray.emplaceBack(cn,cn+2,cn+1),this.indexArray.emplaceBack(cn+1,cn+2,cn+3),Rt.vertexLength+=4,Rt.primitiveLength+=2}}}}if(Rt.vertexLength+Ze>Dt.MAX_VERTEX_ARRAY_LENGTH&&(Rt=this.segments.prepareSegment(Ze,this.layoutVertexArray,this.indexArray)),Lp[b.type]==="Polygon"){for(var vn=[],Fn=[],Dn=Rt.vertexLength,Hn=0,ra=ze;Hn<ra.length;Hn+=1){var na=ra[Hn];if(na.length!==0){na!==ze[0]&&Fn.push(vn.length/2);for(var Xn=0;Xn<na.length;Xn++){var ua=na[Xn];rc(this.layoutVertexArray,ua.x,ua.y,0,0,1,1,0),vn.push(ua.x),vn.push(ua.y)}}}for(var la=fu(vn,Fn),aa=0;aa<la.length;aa+=3)this.indexArray.emplaceBack(Dn+la[aa],Dn+la[aa+2],Dn+la[aa+1]);Rt.primitiveLength+=la.length/3,Rt.vertexLength+=Ze}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,b,V,fe,re)},Yr("FillExtrusionBucket",Ps,{omit:["layers","features"]});var Ip={paint:new Eo({"fill-extrusion-opacity":new oa(Pe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ga(Pe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new oa(Pe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new oa(Pe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ns(Pe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ga(Pe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ga(Pe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new oa(Pe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Op=function(b){function I(V){b.call(this,V,Ip)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.createBucket=function(V){return new Ps(V)},I.prototype.queryRadius=function(){return Lo(this.paint.get("fill-extrusion-translate"))},I.prototype.is3D=function(){return!0},I.prototype.queryIntersectsFeature=function(V,re,fe,ge,Ae,ze,Ze,st){var pt=Co(V,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),ze.angle,Ze),Rt=this.paint.get("fill-extrusion-height").evaluate(re,fe),Gt=this.paint.get("fill-extrusion-base").evaluate(re,fe),Ut=function(pr,Sr,Mr,Dr){for(var Rr=[],Ur=0,cn=pr;Ur<cn.length;Ur+=1){var vn=cn[Ur],Fn=[vn.x,vn.y,Dr,1];kl(Fn,Fn,Sr),Rr.push(new s(Fn[0]/Fn[3],Fn[1]/Fn[3]))}return Rr}(pt,st,0,0),rr=function(pr,Sr,Mr,Dr){for(var Rr=[],Ur=[],cn=Dr[8]*Sr,vn=Dr[9]*Sr,Fn=Dr[10]*Sr,Dn=Dr[11]*Sr,Hn=Dr[8]*Mr,ra=Dr[9]*Mr,na=Dr[10]*Mr,Xn=Dr[11]*Mr,ua=0,la=pr;ua<la.length;ua+=1){for(var aa=la[ua],Xa=[],Na=[],Qa=0,xa=aa;Qa<xa.length;Qa+=1){var Va=xa[Qa],mi=Va.x,ci=Va.y,Ai=Dr[0]*mi+Dr[4]*ci+Dr[12],ui=Dr[1]*mi+Dr[5]*ci+Dr[13],ao=Dr[2]*mi+Dr[6]*ci+Dr[14],Mi=Dr[3]*mi+Dr[7]*ci+Dr[15],Po=ao+Fn,xo=Mi+Dn,wo=Ai+Hn,Go=ui+ra,Do=ao+na,io=Mi+Xn,To=new s((Ai+cn)/xo,(ui+vn)/xo);To.z=Po/xo,Xa.push(To);var Yi=new s(wo/io,Go/io);Yi.z=Do/io,Na.push(Yi)}Rr.push(Xa),Ur.push(Na)}return[Rr,Ur]}(ge,Gt,Rt,st);return function(pr,Sr,Mr){var Dr=1/0;Us(Mr,Sr)&&(Dr=hf(Mr,Sr[0]));for(var Rr=0;Rr<Sr.length;Rr++)for(var Ur=Sr[Rr],cn=pr[Rr],vn=0;vn<Ur.length-1;vn++){var Fn=Ur[vn],Dn=Ur[vn+1],Hn=cn[vn],ra=cn[vn+1],na=[Fn,Dn,ra,Hn,Fn];Oo(Mr,na)&&(Dr=Math.min(Dr,hf(Mr,na)))}return Dr!==1/0&&Dr}(rr[0],rr[1],Ut)},I}(qo);function nc(b,I){return b.x*I.x+b.y*I.y}function hf(b,I){if(b.length===1){for(var V,re=0,fe=I[re++];!V||fe.equals(V);)if(!(V=I[re++]))return 1/0;for(;re<I.length;re++){var ge=I[re],Ae=b[0],ze=V.sub(fe),Ze=ge.sub(fe),st=Ae.sub(fe),pt=nc(ze,ze),Rt=nc(ze,Ze),Gt=nc(Ze,Ze),Ut=nc(st,ze),rr=nc(st,Ze),pr=pt*Gt-Rt*Rt,Sr=(Gt*Ut-Rt*rr)/pr,Mr=(pt*rr-Rt*Ut)/pr,Dr=1-Sr-Mr,Rr=fe.z*Dr+V.z*Sr+ge.z*Mr;if(isFinite(Rr))return Rr}return 1/0}for(var Ur=1/0,cn=0,vn=I;cn<vn.length;cn+=1){var Fn=vn[cn];Ur=Math.min(Ur,Fn.z)}return Ur}var pf=ti([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,zp=Sl.VectorTileFeature.types,Dp=Math.cos(Math.PI/180*37.5),df=Math.pow(2,14)/.5,Ko=function(b){this.zoom=b.zoom,this.overscaling=b.overscaling,this.layers=b.layers,this.layerIds=this.layers.map(function(I){return I.id}),this.index=b.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ss,this.indexArray=new eo,this.programConfigurations=new li(pf,b.layers,b.zoom),this.segments=new Dt,this.stateDependentLayerIds=this.layers.filter(function(I){return I.isStateDependent()}).map(function(I){return I.id})};Ko.prototype.populate=function(b,I,V){this.hasPattern=gu("line",this.layers,I);for(var re=this.layers[0].layout.get("line-sort-key"),fe=[],ge=0,Ae=b;ge<Ae.length;ge+=1){var ze=Ae[ge],Ze=ze.feature,st=ze.id,pt=ze.index,Rt=ze.sourceLayerIndex,Gt=this.layers[0]._featureFilter.needGeometry,Ut={type:Ze.type,id:st,properties:Ze.properties,geometry:Gt?pi(Ze):[]};if(this.layers[0]._featureFilter.filter(new ei(this.zoom),Ut,V)){Gt||(Ut.geometry=pi(Ze));var rr=re?re.evaluate(Ut,{},V):void 0,pr={id:st,properties:Ze.properties,type:Ze.type,sourceLayerIndex:Rt,index:pt,geometry:Ut.geometry,patterns:{},sortKey:rr};fe.push(pr)}}re&&fe.sort(function(Hn,ra){return Hn.sortKey-ra.sortKey});for(var Sr=0,Mr=fe;Sr<Mr.length;Sr+=1){var Dr=Mr[Sr],Rr=Dr,Ur=Rr.geometry,cn=Rr.index,vn=Rr.sourceLayerIndex;if(this.hasPattern){var Fn=vu("line",this.layers,Dr,this.zoom,I);this.patternFeatures.push(Fn)}else this.addFeature(Dr,Ur,cn,V,{});var Dn=b[cn].feature;I.featureIndex.insert(Dn,Ur,cn,vn,this.index)}},Ko.prototype.update=function(b,I,V){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(b,I,this.stateDependentLayers,V)},Ko.prototype.addFeatures=function(b,I,V){for(var re=0,fe=this.patternFeatures;re<fe.length;re+=1){var ge=fe[re];this.addFeature(ge,ge.geometry,ge.index,I,V)}},Ko.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ko.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ko.prototype.upload=function(b){this.uploaded||(this.layoutVertexBuffer=b.createVertexBuffer(this.layoutVertexArray,pf),this.indexBuffer=b.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(b),this.uploaded=!0},Ko.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ko.prototype.addFeature=function(b,I,V,re,fe){for(var ge=this.layers[0].layout,Ae=ge.get("line-join").evaluate(b,{}),ze=ge.get("line-cap"),Ze=ge.get("line-miter-limit"),st=ge.get("line-round-limit"),pt=0,Rt=I;pt<Rt.length;pt+=1){var Gt=Rt[pt];this.addLine(Gt,b,Ae,ze,Ze,st)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,b,V,fe,re)},Ko.prototype.addLine=function(b,I,V,re,fe,ge){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,I.properties&&I.properties.hasOwnProperty("mapbox_clip_start")&&I.properties.hasOwnProperty("mapbox_clip_end")){this.clipStart=+I.properties.mapbox_clip_start,this.clipEnd=+I.properties.mapbox_clip_end;for(var Ae=0;Ae<b.length-1;Ae++)this.totalDistance+=b[Ae].dist(b[Ae+1]);this.updateScaledDistance()}for(var ze=zp[I.type]==="Polygon",Ze=b.length;Ze>=2&&b[Ze-1].equals(b[Ze-2]);)Ze--;for(var st=0;st<Ze-1&&b[st].equals(b[st+1]);)st++;if(!(Ze<(ze?3:2))){V==="bevel"&&(fe=1.05);var pt,Rt=this.overscaling<=16?122880/(512*this.overscaling):0,Gt=this.segments.prepareSegment(10*Ze,this.layoutVertexArray,this.indexArray),Ut=void 0,rr=void 0,pr=void 0,Sr=void 0;this.e1=this.e2=-1,ze&&(pt=b[Ze-2],Sr=b[st].sub(pt)._unit()._perp());for(var Mr=st;Mr<Ze;Mr++)if(!(rr=Mr===Ze-1?ze?b[st+1]:void 0:b[Mr+1])||!b[Mr].equals(rr)){Sr&&(pr=Sr),pt&&(Ut=pt),pt=b[Mr],Sr=rr?rr.sub(pt)._unit()._perp():pr;var Dr=(pr=pr||Sr).add(Sr);Dr.x===0&&Dr.y===0||Dr._unit();var Rr=pr.x*Sr.x+pr.y*Sr.y,Ur=Dr.x*Sr.x+Dr.y*Sr.y,cn=Ur!==0?1/Ur:1/0,vn=2*Math.sqrt(2-2*Ur),Fn=Ur<Dp&&Ut&&rr,Dn=pr.x*Sr.y-pr.y*Sr.x>0;if(Fn&&Mr>st){var Hn=pt.dist(Ut);if(Hn>2*Rt){var ra=pt.sub(pt.sub(Ut)._mult(Rt/Hn)._round());this.updateDistance(Ut,ra),this.addCurrentVertex(ra,pr,0,0,Gt),Ut=ra}}var na=Ut&&rr,Xn=na?V:ze?"butt":re;if(na&&Xn==="round"&&(cn<ge?Xn="miter":cn<=2&&(Xn="fakeround")),Xn==="miter"&&cn>fe&&(Xn="bevel"),Xn==="bevel"&&(cn>2&&(Xn="flipbevel"),cn<fe&&(Xn="miter")),Ut&&this.updateDistance(Ut,pt),Xn==="miter")Dr._mult(cn),this.addCurrentVertex(pt,Dr,0,0,Gt);else if(Xn==="flipbevel"){if(cn>100)Dr=Sr.mult(-1);else{var ua=cn*pr.add(Sr).mag()/pr.sub(Sr).mag();Dr._perp()._mult(ua*(Dn?-1:1))}this.addCurrentVertex(pt,Dr,0,0,Gt),this.addCurrentVertex(pt,Dr.mult(-1),0,0,Gt)}else if(Xn==="bevel"||Xn==="fakeround"){var la=-Math.sqrt(cn*cn-1),aa=Dn?la:0,Xa=Dn?0:la;if(Ut&&this.addCurrentVertex(pt,pr,aa,Xa,Gt),Xn==="fakeround")for(var Na=Math.round(180*vn/Math.PI/20),Qa=1;Qa<Na;Qa++){var xa=Qa/Na;if(xa!==.5){var Va=xa-.5;xa+=xa*Va*(xa-1)*((1.0904+Rr*(Rr*(3.55645-1.43519*Rr)-3.2452))*Va*Va+(.848013+Rr*(.215638*Rr-1.06021)))}var mi=Sr.sub(pr)._mult(xa)._add(pr)._unit()._mult(Dn?-1:1);this.addHalfVertex(pt,mi.x,mi.y,!1,Dn,0,Gt)}rr&&this.addCurrentVertex(pt,Sr,-aa,-Xa,Gt)}else if(Xn==="butt")this.addCurrentVertex(pt,Dr,0,0,Gt);else if(Xn==="square"){var ci=Ut?1:-1;this.addCurrentVertex(pt,Dr,ci,ci,Gt)}else Xn==="round"&&(Ut&&(this.addCurrentVertex(pt,pr,0,0,Gt),this.addCurrentVertex(pt,pr,1,1,Gt,!0)),rr&&(this.addCurrentVertex(pt,Sr,-1,-1,Gt,!0),this.addCurrentVertex(pt,Sr,0,0,Gt)));if(Fn&&Mr<Ze-1){var Ai=pt.dist(rr);if(Ai>2*Rt){var ui=pt.add(rr.sub(pt)._mult(Rt/Ai)._round());this.updateDistance(pt,ui),this.addCurrentVertex(ui,Sr,0,0,Gt),pt=ui}}}}},Ko.prototype.addCurrentVertex=function(b,I,V,re,fe,ge){ge===void 0&&(ge=!1);var Ae=I.x+I.y*V,ze=I.y-I.x*V,Ze=-I.x+I.y*re,st=-I.y-I.x*re;this.addHalfVertex(b,Ae,ze,ge,!1,V,fe),this.addHalfVertex(b,Ze,st,ge,!0,-re,fe),this.distance>df/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(b,I,V,re,fe,ge))},Ko.prototype.addHalfVertex=function(b,I,V,re,fe,ge,Ae){var ze=b.x,Ze=b.y,st=.5*this.scaledDistance;this.layoutVertexArray.emplaceBack((ze<<1)+(re?1:0),(Ze<<1)+(fe?1:0),Math.round(63*I)+128,Math.round(63*V)+128,1+(ge===0?0:ge<0?-1:1)|(63&st)<<2,st>>6);var pt=Ae.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,pt),Ae.primitiveLength++),fe?this.e2=pt:this.e1=pt},Ko.prototype.updateScaledDistance=function(){this.scaledDistance=this.totalDistance>0?(this.clipStart+(this.clipEnd-this.clipStart)*this.distance/this.totalDistance)*(df-1):this.distance},Ko.prototype.updateDistance=function(b,I){this.distance+=b.dist(I),this.updateScaledDistance()},Yr("LineBucket",Ko,{omit:["layers","patternFeatures"]});var Rp=new Eo({"line-cap":new oa(Pe.layout_line["line-cap"]),"line-join":new ga(Pe.layout_line["line-join"]),"line-miter-limit":new oa(Pe.layout_line["line-miter-limit"]),"line-round-limit":new oa(Pe.layout_line["line-round-limit"]),"line-sort-key":new ga(Pe.layout_line["line-sort-key"])}),mf={paint:new Eo({"line-opacity":new ga(Pe.paint_line["line-opacity"]),"line-color":new ga(Pe.paint_line["line-color"]),"line-translate":new oa(Pe.paint_line["line-translate"]),"line-translate-anchor":new oa(Pe.paint_line["line-translate-anchor"]),"line-width":new ga(Pe.paint_line["line-width"]),"line-gap-width":new ga(Pe.paint_line["line-gap-width"]),"line-offset":new ga(Pe.paint_line["line-offset"]),"line-blur":new ga(Pe.paint_line["line-blur"]),"line-dasharray":new js(Pe.paint_line["line-dasharray"]),"line-pattern":new Ns(Pe.paint_line["line-pattern"]),"line-gradient":new rs(Pe.paint_line["line-gradient"])}),layout:Rp},gf=new(function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.possiblyEvaluate=function(V,re){return re=new ei(Math.floor(re.zoom),{now:re.now,fadeDuration:re.fadeDuration,zoomHistory:re.zoomHistory,transition:re.transition}),b.prototype.possiblyEvaluate.call(this,V,re)},I.prototype.evaluate=function(V,re,fe,ge){return re=d({},re,{zoom:Math.floor(re.zoom)}),b.prototype.evaluate.call(this,V,re,fe,ge)},I}(ga))(mf.paint.properties["line-width"].specification);gf.useIntegerZoom=!0;var Fp=function(b){function I(V){b.call(this,V,mf)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._handleSpecialPaintPropertyUpdate=function(V){V==="line-gradient"&&this._updateGradient()},I.prototype._updateGradient=function(){var V=this._transitionablePaint._values["line-gradient"].value.expression;this.gradient=tf(V,"lineProgress"),this.gradientTexture=null},I.prototype.recalculate=function(V,re){b.prototype.recalculate.call(this,V,re),this.paint._values["line-floorwidth"]=gf.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,V)},I.prototype.createBucket=function(V){return new Ko(V)},I.prototype.queryRadius=function(V){var re=V,fe=vf(Ti("line-width",this,re),Ti("line-gap-width",this,re)),ge=Ti("line-offset",this,re);return fe/2+Math.abs(ge)+Lo(this.paint.get("line-translate"))},I.prototype.queryIntersectsFeature=function(V,re,fe,ge,Ae,ze,Ze){var st=Co(V,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),ze.angle,Ze),pt=Ze/2*vf(this.paint.get("line-width").evaluate(re,fe),this.paint.get("line-gap-width").evaluate(re,fe)),Rt=this.paint.get("line-offset").evaluate(re,fe);return Rt&&(ge=function(Gt,Ut){for(var rr=[],pr=new s(0,0),Sr=0;Sr<Gt.length;Sr++){for(var Mr=Gt[Sr],Dr=[],Rr=0;Rr<Mr.length;Rr++){var Ur=Mr[Rr-1],cn=Mr[Rr],vn=Mr[Rr+1],Fn=Rr===0?pr:cn.sub(Ur)._unit()._perp(),Dn=Rr===Mr.length-1?pr:vn.sub(cn)._unit()._perp(),Hn=Fn._add(Dn)._unit(),ra=Hn.x*Dn.x+Hn.y*Dn.y;Hn._mult(1/ra),Dr.push(Hn._mult(Ut)._add(cn))}rr.push(Dr)}return rr}(ge,Rt*Ze)),function(Gt,Ut,rr){for(var pr=0;pr<Ut.length;pr++){var Sr=Ut[pr];if(Gt.length>=3){for(var Mr=0;Mr<Sr.length;Mr++)if(ns(Gt,Sr[Mr]))return!0}if(hl(Gt,Sr,rr))return!0}return!1}(st,ge,pt)},I.prototype.isTileClipped=function(){return!0},I}(qo);function vf(b,I){return I>0?I+2*b:b}var xu=ti([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Bp=ti([{name:"a_projected_pos",components:3,type:"Float32"}],4),Np=(ti([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),ti([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),yf=(ti([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),ti([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),jp=ti([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);ti([{name:"triangle",components:3,type:"Uint16"}]),ti([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),ti([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),ti([{type:"Float32",name:"offsetX"}]),ti([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);function Up(b,I,V){return b.sections.forEach(function(re){re.text=function(fe,ge,Ae){var ze=ge.layout.get("text-transform").evaluate(Ae,{});return ze==="uppercase"?fe=fe.toLocaleUpperCase():ze==="lowercase"&&(fe=fe.toLocaleLowerCase()),so.applyArabicShaping&&(fe=so.applyArabicShaping(fe)),fe}(re.text,I,V)}),b}var ac={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},xf=function(b,I,V,re,fe){var ge,Ae,ze=8*fe-re-1,Ze=(1<<ze)-1,st=Ze>>1,pt=-7,Rt=V?fe-1:0,Gt=V?-1:1,Ut=b[I+Rt];for(Rt+=Gt,ge=Ut&(1<<-pt)-1,Ut>>=-pt,pt+=ze;pt>0;ge=256*ge+b[I+Rt],Rt+=Gt,pt-=8);for(Ae=ge&(1<<-pt)-1,ge>>=-pt,pt+=re;pt>0;Ae=256*Ae+b[I+Rt],Rt+=Gt,pt-=8);if(ge===0)ge=1-st;else{if(ge===Ze)return Ae?NaN:1/0*(Ut?-1:1);Ae+=Math.pow(2,re),ge-=st}return(Ut?-1:1)*Ae*Math.pow(2,ge-re)},bf=function(b,I,V,re,fe,ge){var Ae,ze,Ze,st=8*ge-fe-1,pt=(1<<st)-1,Rt=pt>>1,Gt=fe===23?Math.pow(2,-24)-Math.pow(2,-77):0,Ut=re?0:ge-1,rr=re?1:-1,pr=I<0||I===0&&1/I<0?1:0;for(I=Math.abs(I),isNaN(I)||I===1/0?(ze=isNaN(I)?1:0,Ae=pt):(Ae=Math.floor(Math.log(I)/Math.LN2),I*(Ze=Math.pow(2,-Ae))<1&&(Ae--,Ze*=2),(I+=Ae+Rt>=1?Gt/Ze:Gt*Math.pow(2,1-Rt))*Ze>=2&&(Ae++,Ze/=2),Ae+Rt>=pt?(ze=0,Ae=pt):Ae+Rt>=1?(ze=(I*Ze-1)*Math.pow(2,fe),Ae+=Rt):(ze=I*Math.pow(2,Rt-1)*Math.pow(2,fe),Ae=0));fe>=8;b[V+Ut]=255&ze,Ut+=rr,ze/=256,fe-=8);for(Ae=Ae<<fe|ze,st+=fe;st>0;b[V+Ut]=255&Ae,Ut+=rr,Ae/=256,st-=8);b[V+Ut-rr]|=128*pr},Ac=di;function di(b){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(b)?b:new Uint8Array(b||0),this.pos=0,this.type=0,this.length=this.buf.length}di.Varint=0,di.Fixed64=1,di.Bytes=2,di.Fixed32=5;var _f=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function Ws(b){return b.type===di.Bytes?b.readVarint()+b.pos:b.pos+1}function El(b,I,V){return V?4294967296*I+(b>>>0):4294967296*(I>>>0)+(b>>>0)}function wf(b,I,V){var re=I<=16383?1:I<=2097151?2:I<=268435455?3:Math.floor(Math.log(I)/(7*Math.LN2));V.realloc(re);for(var fe=V.pos-1;fe>=b;fe--)V.buf[fe+re]=V.buf[fe]}function Vp(b,I){for(var V=0;V<b.length;V++)I.writeVarint(b[V])}function Hp(b,I){for(var V=0;V<b.length;V++)I.writeSVarint(b[V])}function qp(b,I){for(var V=0;V<b.length;V++)I.writeFloat(b[V])}function Gp(b,I){for(var V=0;V<b.length;V++)I.writeDouble(b[V])}function Yp(b,I){for(var V=0;V<b.length;V++)I.writeBoolean(b[V])}function Wp(b,I){for(var V=0;V<b.length;V++)I.writeFixed32(b[V])}function Xp(b,I){for(var V=0;V<b.length;V++)I.writeSFixed32(b[V])}function Zp(b,I){for(var V=0;V<b.length;V++)I.writeFixed64(b[V])}function Jp(b,I){for(var V=0;V<b.length;V++)I.writeSFixed64(b[V])}function Mc(b,I){return(b[I]|b[I+1]<<8|b[I+2]<<16)+16777216*b[I+3]}function Ll(b,I,V){b[V]=I,b[V+1]=I>>>8,b[V+2]=I>>>16,b[V+3]=I>>>24}function Tf(b,I){return(b[I]|b[I+1]<<8|b[I+2]<<16)+(b[I+3]<<24)}di.prototype={destroy:function(){this.buf=null},readFields:function(b,I,V){for(V=V||this.length;this.pos<V;){var re=this.readVarint(),fe=re>>3,ge=this.pos;this.type=7&re,b(fe,I,this),this.pos===ge&&this.skip(re)}return I},readMessage:function(b,I){return this.readFields(b,I,this.readVarint()+this.pos)},readFixed32:function(){var b=Mc(this.buf,this.pos);return this.pos+=4,b},readSFixed32:function(){var b=Tf(this.buf,this.pos);return this.pos+=4,b},readFixed64:function(){var b=Mc(this.buf,this.pos)+4294967296*Mc(this.buf,this.pos+4);return this.pos+=8,b},readSFixed64:function(){var b=Mc(this.buf,this.pos)+4294967296*Tf(this.buf,this.pos+4);return this.pos+=8,b},readFloat:function(){var b=xf(this.buf,this.pos,!0,23,4);return this.pos+=4,b},readDouble:function(){var b=xf(this.buf,this.pos,!0,52,8);return this.pos+=8,b},readVarint:function(b){var I,V,re=this.buf;return I=127&(V=re[this.pos++]),V<128?I:(I|=(127&(V=re[this.pos++]))<<7,V<128?I:(I|=(127&(V=re[this.pos++]))<<14,V<128?I:(I|=(127&(V=re[this.pos++]))<<21,V<128?I:function(fe,ge,Ae){var ze,Ze,st=Ae.buf;if(Ze=st[Ae.pos++],ze=(112&Ze)>>4,Ze<128||(Ze=st[Ae.pos++],ze|=(127&Ze)<<3,Ze<128)||(Ze=st[Ae.pos++],ze|=(127&Ze)<<10,Ze<128)||(Ze=st[Ae.pos++],ze|=(127&Ze)<<17,Ze<128)||(Ze=st[Ae.pos++],ze|=(127&Ze)<<24,Ze<128)||(Ze=st[Ae.pos++],ze|=(1&Ze)<<31,Ze<128))return El(fe,ze,ge);throw new Error("Expected varint not more than 10 bytes")}(I|=(15&(V=re[this.pos]))<<28,b,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var b=this.readVarint();return b%2==1?(b+1)/-2:b/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var b=this.readVarint()+this.pos,I=this.pos;return this.pos=b,b-I>=12&&_f?function(V,re,fe){return _f.decode(V.subarray(re,fe))}(this.buf,I,b):function(V,re,fe){for(var ge="",Ae=re;Ae<fe;){var ze,Ze,st,pt=V[Ae],Rt=null,Gt=pt>239?4:pt>223?3:pt>191?2:1;if(Ae+Gt>fe)break;Gt===1?pt<128&&(Rt=pt):Gt===2?(192&(ze=V[Ae+1]))==128&&(Rt=(31&pt)<<6|63&ze)<=127&&(Rt=null):Gt===3?(ze=V[Ae+1],Ze=V[Ae+2],(192&ze)==128&&(192&Ze)==128&&((Rt=(15&pt)<<12|(63&ze)<<6|63&Ze)<=2047||Rt>=55296&&Rt<=57343)&&(Rt=null)):Gt===4&&(ze=V[Ae+1],Ze=V[Ae+2],st=V[Ae+3],(192&ze)==128&&(192&Ze)==128&&(192&st)==128&&((Rt=(15&pt)<<18|(63&ze)<<12|(63&Ze)<<6|63&st)<=65535||Rt>=1114112)&&(Rt=null)),Rt===null?(Rt=65533,Gt=1):Rt>65535&&(Rt-=65536,ge+=String.fromCharCode(Rt>>>10&1023|55296),Rt=56320|1023&Rt),ge+=String.fromCharCode(Rt),Ae+=Gt}return ge}(this.buf,I,b)},readBytes:function(){var b=this.readVarint()+this.pos,I=this.buf.subarray(this.pos,b);return this.pos=b,I},readPackedVarint:function(b,I){if(this.type!==di.Bytes)return b.push(this.readVarint(I));var V=Ws(this);for(b=b||[];this.pos<V;)b.push(this.readVarint(I));return b},readPackedSVarint:function(b){if(this.type!==di.Bytes)return b.push(this.readSVarint());var I=Ws(this);for(b=b||[];this.pos<I;)b.push(this.readSVarint());return b},readPackedBoolean:function(b){if(this.type!==di.Bytes)return b.push(this.readBoolean());var I=Ws(this);for(b=b||[];this.pos<I;)b.push(this.readBoolean());return b},readPackedFloat:function(b){if(this.type!==di.Bytes)return b.push(this.readFloat());var I=Ws(this);for(b=b||[];this.pos<I;)b.push(this.readFloat());return b},readPackedDouble:function(b){if(this.type!==di.Bytes)return b.push(this.readDouble());var I=Ws(this);for(b=b||[];this.pos<I;)b.push(this.readDouble());return b},readPackedFixed32:function(b){if(this.type!==di.Bytes)return b.push(this.readFixed32());var I=Ws(this);for(b=b||[];this.pos<I;)b.push(this.readFixed32());return b},readPackedSFixed32:function(b){if(this.type!==di.Bytes)return b.push(this.readSFixed32());var I=Ws(this);for(b=b||[];this.pos<I;)b.push(this.readSFixed32());return b},readPackedFixed64:function(b){if(this.type!==di.Bytes)return b.push(this.readFixed64());var I=Ws(this);for(b=b||[];this.pos<I;)b.push(this.readFixed64());return b},readPackedSFixed64:function(b){if(this.type!==di.Bytes)return b.push(this.readSFixed64());var I=Ws(this);for(b=b||[];this.pos<I;)b.push(this.readSFixed64());return b},skip:function(b){var I=7&b;if(I===di.Varint)for(;this.buf[this.pos++]>127;);else if(I===di.Bytes)this.pos=this.readVarint()+this.pos;else if(I===di.Fixed32)this.pos+=4;else{if(I!==di.Fixed64)throw new Error("Unimplemented type: "+I);this.pos+=8}},writeTag:function(b,I){this.writeVarint(b<<3|I)},realloc:function(b){for(var I=this.length||16;I<this.pos+b;)I*=2;if(I!==this.length){var V=new Uint8Array(I);V.set(this.buf),this.buf=V,this.length=I}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(b){this.realloc(4),Ll(this.buf,b,this.pos),this.pos+=4},writeSFixed32:function(b){this.realloc(4),Ll(this.buf,b,this.pos),this.pos+=4},writeFixed64:function(b){this.realloc(8),Ll(this.buf,-1&b,this.pos),Ll(this.buf,Math.floor(b*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(b){this.realloc(8),Ll(this.buf,-1&b,this.pos),Ll(this.buf,Math.floor(b*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(b){(b=+b||0)>268435455||b<0?function(I,V){var re,fe;if(I>=0?(re=I%4294967296|0,fe=I/4294967296|0):(fe=~(-I/4294967296),4294967295^(re=~(-I%4294967296))?re=re+1|0:(re=0,fe=fe+1|0)),I>=18446744073709552e3||I<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");V.realloc(10),function(ge,Ae,ze){ze.buf[ze.pos++]=127&ge|128,ge>>>=7,ze.buf[ze.pos++]=127&ge|128,ge>>>=7,ze.buf[ze.pos++]=127&ge|128,ge>>>=7,ze.buf[ze.pos++]=127&ge|128,ge>>>=7,ze.buf[ze.pos]=127&ge}(re,0,V),function(ge,Ae){var ze=(7&ge)<<4;Ae.buf[Ae.pos++]|=ze|((ge>>>=3)?128:0),!!ge&&(Ae.buf[Ae.pos++]=127&ge|((ge>>>=7)?128:0),!!ge&&(Ae.buf[Ae.pos++]=127&ge|((ge>>>=7)?128:0),!!ge&&(Ae.buf[Ae.pos++]=127&ge|((ge>>>=7)?128:0),!!ge&&(Ae.buf[Ae.pos++]=127&ge|((ge>>>=7)?128:0),!!ge&&(Ae.buf[Ae.pos++]=127&ge)))))}(fe,V)}(b,this):(this.realloc(4),this.buf[this.pos++]=127&b|(b>127?128:0),b<=127||(this.buf[this.pos++]=127&(b>>>=7)|(b>127?128:0),b<=127||(this.buf[this.pos++]=127&(b>>>=7)|(b>127?128:0),b<=127||(this.buf[this.pos++]=b>>>7&127))))},writeSVarint:function(b){this.writeVarint(b<0?2*-b-1:2*b)},writeBoolean:function(b){this.writeVarint(Boolean(b))},writeString:function(b){b=String(b),this.realloc(4*b.length),this.pos++;var I=this.pos;this.pos=function(re,fe,ge){for(var Ae,ze,Ze=0;Ze<fe.length;Ze++){if((Ae=fe.charCodeAt(Ze))>55295&&Ae<57344){if(!ze){Ae>56319||Ze+1===fe.length?(re[ge++]=239,re[ge++]=191,re[ge++]=189):ze=Ae;continue}if(Ae<56320){re[ge++]=239,re[ge++]=191,re[ge++]=189,ze=Ae;continue}Ae=ze-55296<<10|Ae-56320|65536,ze=null}else ze&&(re[ge++]=239,re[ge++]=191,re[ge++]=189,ze=null);Ae<128?re[ge++]=Ae:(Ae<2048?re[ge++]=Ae>>6|192:(Ae<65536?re[ge++]=Ae>>12|224:(re[ge++]=Ae>>18|240,re[ge++]=Ae>>12&63|128),re[ge++]=Ae>>6&63|128),re[ge++]=63&Ae|128)}return ge}(this.buf,b,this.pos);var V=this.pos-I;V>=128&&wf(I,V,this),this.pos=I-1,this.writeVarint(V),this.pos+=V},writeFloat:function(b){this.realloc(4),bf(this.buf,b,this.pos,!0,23,4),this.pos+=4},writeDouble:function(b){this.realloc(8),bf(this.buf,b,this.pos,!0,52,8),this.pos+=8},writeBytes:function(b){var I=b.length;this.writeVarint(I),this.realloc(I);for(var V=0;V<I;V++)this.buf[this.pos++]=b[V]},writeRawMessage:function(b,I){this.pos++;var V=this.pos;b(I,this);var re=this.pos-V;re>=128&&wf(V,re,this),this.pos=V-1,this.writeVarint(re),this.pos+=re},writeMessage:function(b,I,V){this.writeTag(b,di.Bytes),this.writeRawMessage(I,V)},writePackedVarint:function(b,I){I.length&&this.writeMessage(b,Vp,I)},writePackedSVarint:function(b,I){I.length&&this.writeMessage(b,Hp,I)},writePackedBoolean:function(b,I){I.length&&this.writeMessage(b,Yp,I)},writePackedFloat:function(b,I){I.length&&this.writeMessage(b,qp,I)},writePackedDouble:function(b,I){I.length&&this.writeMessage(b,Gp,I)},writePackedFixed32:function(b,I){I.length&&this.writeMessage(b,Wp,I)},writePackedSFixed32:function(b,I){I.length&&this.writeMessage(b,Xp,I)},writePackedFixed64:function(b,I){I.length&&this.writeMessage(b,Zp,I)},writePackedSFixed64:function(b,I){I.length&&this.writeMessage(b,Jp,I)},writeBytesField:function(b,I){this.writeTag(b,di.Bytes),this.writeBytes(I)},writeFixed32Field:function(b,I){this.writeTag(b,di.Fixed32),this.writeFixed32(I)},writeSFixed32Field:function(b,I){this.writeTag(b,di.Fixed32),this.writeSFixed32(I)},writeFixed64Field:function(b,I){this.writeTag(b,di.Fixed64),this.writeFixed64(I)},writeSFixed64Field:function(b,I){this.writeTag(b,di.Fixed64),this.writeSFixed64(I)},writeVarintField:function(b,I){this.writeTag(b,di.Varint),this.writeVarint(I)},writeSVarintField:function(b,I){this.writeTag(b,di.Varint),this.writeSVarint(I)},writeStringField:function(b,I){this.writeTag(b,di.Bytes),this.writeString(I)},writeFloatField:function(b,I){this.writeTag(b,di.Fixed32),this.writeFloat(I)},writeDoubleField:function(b,I){this.writeTag(b,di.Fixed64),this.writeDouble(I)},writeBooleanField:function(b,I){this.writeVarintField(b,Boolean(I))}};function Kp(b,I,V){b===1&&V.readMessage(Qp,I)}function Qp(b,I,V){if(b===3){var re=V.readMessage($p,{}),fe=re.id,ge=re.bitmap,Ae=re.width,ze=re.height,Ze=re.left,st=re.top,pt=re.advance;I.push({id:fe,bitmap:new vl({width:Ae+6,height:ze+6},ge),metrics:{width:Ae,height:ze,left:Ze,top:st,advance:pt}})}}function $p(b,I,V){b===1?I.id=V.readVarint():b===2?I.bitmap=V.readBytes():b===3?I.width=V.readVarint():b===4?I.height=V.readVarint():b===5?I.left=V.readSVarint():b===6?I.top=V.readSVarint():b===7&&(I.advance=V.readVarint())}function kf(b){for(var I=0,V=0,re=0,fe=b;re<fe.length;re+=1){var ge=fe[re];I+=ge.w*ge.h,V=Math.max(V,ge.w)}b.sort(function(pr,Sr){return Sr.h-pr.h});for(var Ae=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(I/.95)),V),h:1/0}],ze=0,Ze=0,st=0,pt=b;st<pt.length;st+=1)for(var Rt=pt[st],Gt=Ae.length-1;Gt>=0;Gt--){var Ut=Ae[Gt];if(!(Rt.w>Ut.w||Rt.h>Ut.h)){if(Rt.x=Ut.x,Rt.y=Ut.y,Ze=Math.max(Ze,Rt.y+Rt.h),ze=Math.max(ze,Rt.x+Rt.w),Rt.w===Ut.w&&Rt.h===Ut.h){var rr=Ae.pop();Gt<Ae.length&&(Ae[Gt]=rr)}else Rt.h===Ut.h?(Ut.x+=Rt.w,Ut.w-=Rt.w):Rt.w===Ut.w?(Ut.y+=Rt.h,Ut.h-=Rt.h):(Ae.push({x:Ut.x+Rt.w,y:Ut.y,w:Ut.w-Rt.w,h:Rt.h}),Ut.y+=Rt.h,Ut.h-=Rt.h);break}}return{w:ze,h:Ze,fill:I/(ze*Ze)||0}}var Sc=function(b,I){var V=I.pixelRatio,re=I.version,fe=I.stretchX,ge=I.stretchY,Ae=I.content;this.paddedRect=b,this.pixelRatio=V,this.stretchX=fe,this.stretchY=ge,this.content=Ae,this.version=re},ic={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};ic.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},ic.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},ic.tlbr.get=function(){return this.tl.concat(this.br)},ic.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Sc.prototype,ic);var oc=function(b,I){var V={},re={};this.haveRenderCallbacks=[];var fe=[];this.addImages(b,V,fe),this.addImages(I,re,fe);var ge=kf(fe),Ae=ge.w,ze=ge.h,Ze=new Jo({width:Ae||1,height:ze||1});for(var st in b){var pt=b[st],Rt=V[st].paddedRect;Jo.copy(pt.data,Ze,{x:0,y:0},{x:Rt.x+1,y:Rt.y+1},pt.data)}for(var Gt in I){var Ut=I[Gt],rr=re[Gt].paddedRect,pr=rr.x+1,Sr=rr.y+1,Mr=Ut.data.width,Dr=Ut.data.height;Jo.copy(Ut.data,Ze,{x:0,y:0},{x:pr,y:Sr},Ut.data),Jo.copy(Ut.data,Ze,{x:0,y:Dr-1},{x:pr,y:Sr-1},{width:Mr,height:1}),Jo.copy(Ut.data,Ze,{x:0,y:0},{x:pr,y:Sr+Dr},{width:Mr,height:1}),Jo.copy(Ut.data,Ze,{x:Mr-1,y:0},{x:pr-1,y:Sr},{width:1,height:Dr}),Jo.copy(Ut.data,Ze,{x:0,y:0},{x:pr+Mr,y:Sr},{width:1,height:Dr})}this.image=Ze,this.iconPositions=V,this.patternPositions=re};oc.prototype.addImages=function(b,I,V){for(var re in b){var fe=b[re],ge={x:0,y:0,w:fe.data.width+2,h:fe.data.height+2};V.push(ge),I[re]=new Sc(ge,fe),fe.hasRenderCallback&&this.haveRenderCallbacks.push(re)}},oc.prototype.patchUpdatedImages=function(b,I){for(var V in b.dispatchRenderCallbacks(this.haveRenderCallbacks),b.updatedImages)this.patchUpdatedImage(this.iconPositions[V],b.getImage(V),I),this.patchUpdatedImage(this.patternPositions[V],b.getImage(V),I)},oc.prototype.patchUpdatedImage=function(b,I,V){if(b&&I&&b.version!==I.version){b.version=I.version;var re=b.tl,fe=re[0],ge=re[1];V.update(I.data,void 0,{x:fe,y:ge})}},Yr("ImagePosition",Sc),Yr("ImageAtlas",oc);var cs={horizontal:1,vertical:2,horizontalOnly:3},Cl=function(){this.scale=1,this.fontStack="",this.imageName=null};Cl.forText=function(b,I){var V=new Cl;return V.scale=b||1,V.fontStack=I,V},Cl.forImage=function(b){var I=new Cl;return I.imageName=b,I};var zo=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Ec(b,I,V,re,fe,ge,Ae,ze,Ze,st,pt,Rt,Gt,Ut,rr,pr){var Sr,Mr=zo.fromFeature(b,fe);Rt===cs.vertical&&Mr.verticalizePunctuation();var Dr=so.processBidirectionalText,Rr=so.processStyledBidirectionalText;if(Dr&&Mr.sections.length===1){Sr=[];for(var Ur=0,cn=Dr(Mr.toString(),bu(Mr,st,ge,I,re,Ut,rr));Ur<cn.length;Ur+=1){var vn=cn[Ur],Fn=new zo;Fn.text=vn,Fn.sections=Mr.sections;for(var Dn=0;Dn<vn.length;Dn++)Fn.sectionIndex.push(0);Sr.push(Fn)}}else if(Rr){Sr=[];for(var Hn=0,ra=Rr(Mr.text,Mr.sectionIndex,bu(Mr,st,ge,I,re,Ut,rr));Hn<ra.length;Hn+=1){var na=ra[Hn],Xn=new zo;Xn.text=na[0],Xn.sectionIndex=na[1],Xn.sections=Mr.sections,Sr.push(Xn)}}else Sr=function(aa,Xa){for(var Na=[],Qa=aa.text,xa=0,Va=0,mi=Xa;Va<mi.length;Va+=1){var ci=mi[Va];Na.push(aa.substring(xa,ci)),xa=ci}return xa<Qa.length&&Na.push(aa.substring(xa,Qa.length)),Na}(Mr,bu(Mr,st,ge,I,re,Ut,rr));var ua=[],la={positionedLines:ua,text:Mr.toString(),top:pt[1],bottom:pt[1],left:pt[0],right:pt[0],writingMode:Rt,iconsInText:!1,verticalizable:!1};return function(aa,Xa,Na,Qa,xa,Va,mi,ci,Ai,ui,ao,Mi){for(var Po=0,xo=-17,wo=0,Go=0,Do=ci==="right"?1:ci==="left"?0:.5,io=0,To=0,Yi=xa;To<Yi.length;To+=1){var lo=Yi[To];lo.trim();var za=lo.getMaxScale(),Ja=24*(za-1),Bi={positionedGlyphs:[],lineOffset:0};aa.positionedLines[io]=Bi;var Ni=Bi.positionedGlyphs,zi=0;if(lo.length()){for(var Si=0;Si<lo.length();Si++){var ri=lo.getSection(Si),ji=lo.getSectionIndex(Si),Yo=lo.getCharCode(Si),is=0,Ro=null,Is=null,Js=null,bo=24,Os=!(Ai===cs.horizontal||!ao&&!ha(Yo)||ao&&(Lc[Yo]||(ol=Yo,kn.Arabic(ol)||kn["Arabic Supplement"](ol)||kn["Arabic Extended-A"](ol)||kn["Arabic Presentation Forms-A"](ol)||kn["Arabic Presentation Forms-B"](ol))));if(ri.imageName){var zs=Qa[ri.imageName];if(!zs)continue;Js=ri.imageName,aa.iconsInText=aa.iconsInText||!0,Is=zs.paddedRect;var Ds=zs.displaySize;ri.scale=24*ri.scale/Mi,Ro={width:Ds[0],height:Ds[1],left:1,top:-3,advance:Os?Ds[1]:Ds[0]};var Cu=24-Ds[1]*ri.scale;is=Ja+Cu,bo=Ro.advance;var Bl=Os?Ds[0]*ri.scale-24*za:Ds[1]*ri.scale-24*za;Bl>0&&Bl>zi&&(zi=Bl)}else{var Bc=Na[ri.fontStack],_l=Bc&&Bc[Yo];if(_l&&_l.rect)Is=_l.rect,Ro=_l.metrics;else{var Nc=Xa[ri.fontStack],jc=Nc&&Nc[Yo];if(!jc)continue;Ro=jc.metrics}is=24*(za-ri.scale)}Os?(aa.verticalizable=!0,Ni.push({glyph:Yo,imageName:Js,x:Po,y:xo+is,vertical:Os,scale:ri.scale,fontStack:ri.fontStack,sectionIndex:ji,metrics:Ro,rect:Is}),Po+=bo*ri.scale+ui):(Ni.push({glyph:Yo,imageName:Js,x:Po,y:xo+is,vertical:Os,scale:ri.scale,fontStack:ri.fontStack,sectionIndex:ji,metrics:Ro,rect:Is}),Po+=Ro.advance*ri.scale+ui)}if(Ni.length!==0){var Uc=Po-ui;wo=Math.max(Uc,wo),td(Ni,0,Ni.length-1,Do,zi)}Po=0;var Vc=Va*za+zi;Bi.lineOffset=Math.max(zi,Ja),xo+=Vc,Go=Math.max(Vc,Go),++io}else xo+=Va,++io}var ol,Nl=xo- -17,Hc=_u(mi),jl=Hc.horizontalAlign,sl=Hc.verticalAlign;(function(cc,qc,Gc,Yc,uc,Wc,fc,Xc,hc){var Zc=(qc-Gc)*uc,Ul=0;Ul=Wc!==fc?-Xc*Yc- -17:(-Yc*hc+.5)*fc;for(var Vl=0,Hl=cc;Vl<Hl.length;Vl+=1)for(var Jc=Hl[Vl],ql=0,pc=Jc.positionedGlyphs;ql<pc.length;ql+=1){var Gl=pc[ql];Gl.x+=Zc,Gl.y+=Ul}})(aa.positionedLines,Do,jl,sl,wo,Go,Va,Nl,xa.length),aa.top+=-sl*Nl,aa.bottom=aa.top+Nl,aa.left+=-jl*wo,aa.right=aa.left+wo}(la,I,V,re,Sr,Ae,ze,Ze,Rt,st,Gt,pr),!function(aa){for(var Xa=0,Na=aa;Xa<Na.length;Xa+=1)if(Na[Xa].positionedGlyphs.length!==0)return!1;return!0}(ua)&&la}zo.fromFeature=function(b,I){for(var V=new zo,re=0;re<b.sections.length;re++){var fe=b.sections[re];fe.image?V.addImageSection(fe):V.addTextSection(fe,I)}return V},zo.prototype.length=function(){return this.text.length},zo.prototype.getSection=function(b){return this.sections[this.sectionIndex[b]]},zo.prototype.getSectionIndex=function(b){return this.sectionIndex[b]},zo.prototype.getCharCode=function(b){return this.text.charCodeAt(b)},zo.prototype.verticalizePunctuation=function(){this.text=function(b){for(var I="",V=0;V<b.length;V++){var re=b.charCodeAt(V+1)||null,fe=b.charCodeAt(V-1)||null;(!re||!Oa(re)||ac[b[V+1]])&&(!fe||!Oa(fe)||ac[b[V-1]])&&ac[b[V]]?I+=ac[b[V]]:I+=b[V]}return I}(this.text)},zo.prototype.trim=function(){for(var b=0,I=0;I<this.text.length&&Lc[this.text.charCodeAt(I)];I++)b++;for(var V=this.text.length,re=this.text.length-1;re>=0&&re>=b&&Lc[this.text.charCodeAt(re)];re--)V--;this.text=this.text.substring(b,V),this.sectionIndex=this.sectionIndex.slice(b,V)},zo.prototype.substring=function(b,I){var V=new zo;return V.text=this.text.substring(b,I),V.sectionIndex=this.sectionIndex.slice(b,I),V.sections=this.sections,V},zo.prototype.toString=function(){return this.text},zo.prototype.getMaxScale=function(){var b=this;return this.sectionIndex.reduce(function(I,V){return Math.max(I,b.sections[V].scale)},0)},zo.prototype.addTextSection=function(b,I){this.text+=b.text,this.sections.push(Cl.forText(b.scale,b.fontStack||I));for(var V=this.sections.length-1,re=0;re<b.text.length;++re)this.sectionIndex.push(V)},zo.prototype.addImageSection=function(b){var I=b.image?b.image.name:"";if(I.length!==0){var V=this.getNextImageSectionCharCode();V?(this.text+=String.fromCharCode(V),this.sections.push(Cl.forImage(I)),this.sectionIndex.push(this.sections.length-1)):k("Reached maximum number of images 6401")}else k("Can't add FormattedSection with an empty image.")},zo.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Lc={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},as={};function Af(b,I,V,re,fe,ge){if(I.imageName){var Ae=re[I.imageName];return Ae?Ae.displaySize[0]*I.scale*24/ge+fe:0}var ze=V[I.fontStack],Ze=ze&&ze[b];return Ze?Ze.metrics.advance*I.scale+fe:0}function Mf(b,I,V,re){var fe=Math.pow(b-I,2);return re?b<I?fe/2:2*fe:fe+Math.abs(V)*V}function ed(b,I,V){var re=0;return b===10&&(re-=1e4),V&&(re+=150),b!==40&&b!==65288||(re+=50),I!==41&&I!==65289||(re+=50),re}function Sf(b,I,V,re,fe,ge){for(var Ae=null,ze=Mf(I,V,fe,ge),Ze=0,st=re;Ze<st.length;Ze+=1){var pt=st[Ze],Rt=Mf(I-pt.x,V,fe,ge)+pt.badness;Rt<=ze&&(Ae=pt,ze=Rt)}return{index:b,x:I,priorBreak:Ae,badness:ze}}function bu(b,I,V,re,fe,ge,Ae){if(ge!=="point")return[];if(!b)return[];for(var ze,Ze=[],st=function(Sr,Mr,Dr,Rr,Ur,cn){for(var vn=0,Fn=0;Fn<Sr.length();Fn++){var Dn=Sr.getSection(Fn);vn+=Af(Sr.getCharCode(Fn),Dn,Rr,Ur,Mr,cn)}return vn/Math.max(1,Math.ceil(vn/Dr))}(b,I,V,re,fe,Ae),pt=b.text.indexOf("\u200B")>=0,Rt=0,Gt=0;Gt<b.length();Gt++){var Ut=b.getSection(Gt),rr=b.getCharCode(Gt);if(Lc[rr]||(Rt+=Af(rr,Ut,re,fe,I,Ae)),Gt<b.length()-1){var pr=!!(!((ze=rr)<11904)&&(kn["Bopomofo Extended"](ze)||kn.Bopomofo(ze)||kn["CJK Compatibility Forms"](ze)||kn["CJK Compatibility Ideographs"](ze)||kn["CJK Compatibility"](ze)||kn["CJK Radicals Supplement"](ze)||kn["CJK Strokes"](ze)||kn["CJK Symbols and Punctuation"](ze)||kn["CJK Unified Ideographs Extension A"](ze)||kn["CJK Unified Ideographs"](ze)||kn["Enclosed CJK Letters and Months"](ze)||kn["Halfwidth and Fullwidth Forms"](ze)||kn.Hiragana(ze)||kn["Ideographic Description Characters"](ze)||kn["Kangxi Radicals"](ze)||kn["Katakana Phonetic Extensions"](ze)||kn.Katakana(ze)||kn["Vertical Forms"](ze)||kn["Yi Radicals"](ze)||kn["Yi Syllables"](ze)));(as[rr]||pr||Ut.imageName)&&Ze.push(Sf(Gt+1,Rt,st,Ze,ed(rr,b.getCharCode(Gt+1),pr&&pt),!1))}}return function Sr(Mr){return Mr?Sr(Mr.priorBreak).concat(Mr.index):[]}(Sf(b.length(),Rt,st,Ze,0,!0))}function _u(b){var I=.5,V=.5;switch(b){case"right":case"top-right":case"bottom-right":I=1;break;case"left":case"top-left":case"bottom-left":I=0}switch(b){case"bottom":case"bottom-right":case"bottom-left":V=1;break;case"top":case"top-right":case"top-left":V=0}return{horizontalAlign:I,verticalAlign:V}}function td(b,I,V,re,fe){if(re||fe)for(var ge=b[V],Ae=ge.metrics.advance*ge.scale,ze=(b[V].x+Ae)*re,Ze=I;Ze<=V;Ze++)b[Ze].x-=ze,b[Ze].y+=fe}function Ef(b,I,V,re,fe,ge){var Ae,ze=b.image;if(ze.content){var Ze=ze.content,st=ze.pixelRatio||1;Ae=[Ze[0]/st,Ze[1]/st,ze.displaySize[0]-Ze[2]/st,ze.displaySize[1]-Ze[3]/st]}var pt,Rt,Gt,Ut,rr=I.left*ge,pr=I.right*ge;V==="width"||V==="both"?(Ut=fe[0]+rr-re[3],Rt=fe[0]+pr+re[1]):Rt=(Ut=fe[0]+(rr+pr-ze.displaySize[0])/2)+ze.displaySize[0];var Sr=I.top*ge,Mr=I.bottom*ge;return V==="height"||V==="both"?(pt=fe[1]+Sr-re[0],Gt=fe[1]+Mr+re[2]):Gt=(pt=fe[1]+(Sr+Mr-ze.displaySize[1])/2)+ze.displaySize[1],{image:ze,top:pt,right:Rt,bottom:Gt,left:Ut,collisionPadding:Ae}}as[10]=!0,as[32]=!0,as[38]=!0,as[40]=!0,as[41]=!0,as[43]=!0,as[45]=!0,as[47]=!0,as[173]=!0,as[183]=!0,as[8203]=!0,as[8208]=!0,as[8211]=!0,as[8231]=!0;var Pl=function(b){function I(V,re,fe,ge){b.call(this,V,re),this.angle=fe,ge!==void 0&&(this.segment=ge)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.clone=function(){return new I(this.x,this.y,this.angle,this.segment)},I}(s);Yr("Anchor",Pl);function wu(b,I){var V=I.expression;if(V.kind==="constant")return{kind:"constant",layoutSize:V.evaluate(new ei(b+1))};if(V.kind==="source")return{kind:"source"};for(var re=V.zoomStops,fe=V.interpolationType,ge=0;ge<re.length&&re[ge]<=b;)ge++;for(var Ae=ge=Math.max(0,ge-1);Ae<re.length&&re[Ae]<b+1;)Ae++;Ae=Math.min(re.length-1,Ae);var ze=re[ge],Ze=re[Ae];return V.kind==="composite"?{kind:"composite",minZoom:ze,maxZoom:Ze,interpolationType:fe}:{kind:"camera",minZoom:ze,maxZoom:Ze,minSize:V.evaluate(new ei(ze)),maxSize:V.evaluate(new ei(Ze)),interpolationType:fe}}function Lf(b,I,V){var re=I.uSize,fe=I.uSizeT,ge=V.lowerSize,Ae=V.upperSize;return b.kind==="source"?ge/128:b.kind==="composite"?qn(ge/128,Ae/128,fe):re}function Cf(b,I){var V=0,re=0;if(b.kind==="constant")re=b.layoutSize;else if(b.kind!=="source"){var fe=b.interpolationType,ge=b.minZoom,Ae=b.maxZoom,ze=fe?r(Ha.interpolationFactor(fe,I,ge,Ae),0,1):0;b.kind==="camera"?re=qn(b.minSize,b.maxSize,ze):V=ze}return{uSizeT:V,uSize:re}}var rd=Object.freeze({__proto__:null,getSizeData:wu,evaluateSizeForFeature:Lf,evaluateSizeForZoom:Cf,SIZE_PACK_FACTOR:128});function Pf(b,I,V,re,fe){if(I.segment===void 0)return!0;for(var ge=I,Ae=I.segment+1,ze=0;ze>-V/2;){if(--Ae<0)return!1;ze-=b[Ae].dist(ge),ge=b[Ae]}ze+=b[Ae].dist(b[Ae+1]),Ae++;for(var Ze=[],st=0;ze<V/2;){var pt=b[Ae-1],Rt=b[Ae],Gt=b[Ae+1];if(!Gt)return!1;var Ut=pt.angleTo(Rt)-Rt.angleTo(Gt);for(Ut=Math.abs((Ut+3*Math.PI)%(2*Math.PI)-Math.PI),Ze.push({distance:ze,angleDelta:Ut}),st+=Ut;ze-Ze[0].distance>re;)st-=Ze.shift().angleDelta;if(st>fe)return!1;Ae++,ze+=Rt.dist(Gt)}return!0}function If(b){for(var I=0,V=0;V<b.length-1;V++)I+=b[V].dist(b[V+1]);return I}function Of(b,I,V){return b?.6*I*V:0}function zf(b,I){return Math.max(b?b.right-b.left:0,I?I.right-I.left:0)}function nd(b,I,V,re,fe,ge){for(var Ae=Of(V,fe,ge),ze=zf(V,re)*ge,Ze=0,st=If(b)/2,pt=0;pt<b.length-1;pt++){var Rt=b[pt],Gt=b[pt+1],Ut=Rt.dist(Gt);if(Ze+Ut>st){var rr=(st-Ze)/Ut,pr=qn(Rt.x,Gt.x,rr),Sr=qn(Rt.y,Gt.y,rr),Mr=new Pl(pr,Sr,Gt.angleTo(Rt),pt);return Mr._round(),!Ae||Pf(b,Mr,ze,Ae,I)?Mr:void 0}Ze+=Ut}}function ad(b,I,V,re,fe,ge,Ae,ze,Ze){var st=Of(re,ge,Ae),pt=zf(re,fe),Rt=pt*Ae,Gt=b[0].x===0||b[0].x===Ze||b[0].y===0||b[0].y===Ze;return I-Rt<I/4&&(I=Rt+I/4),function Ut(rr,pr,Sr,Mr,Dr,Rr,Ur,cn,vn){for(var Fn=Rr/2,Dn=If(rr),Hn=0,ra=pr-Sr,na=[],Xn=0;Xn<rr.length-1;Xn++){for(var ua=rr[Xn],la=rr[Xn+1],aa=ua.dist(la),Xa=la.angleTo(ua);ra+Sr<Hn+aa;){var Na=((ra+=Sr)-Hn)/aa,Qa=qn(ua.x,la.x,Na),xa=qn(ua.y,la.y,Na);if(Qa>=0&&Qa<vn&&xa>=0&&xa<vn&&ra-Fn>=0&&ra+Fn<=Dn){var Va=new Pl(Qa,xa,Xa,Xn);Va._round(),Mr&&!Pf(rr,Va,Rr,Mr,Dr)||na.push(Va)}}Hn+=aa}return cn||na.length||Ur||(na=Ut(rr,Hn/2,Sr,Mr,Dr,Rr,Ur,!0,vn)),na}(b,Gt?I/2*ze%I:(pt/2+2*ge)*Ae*ze%I,I,st,V,Rt,Gt,!1,Ze)}function Df(b,I,V,re,fe){for(var ge=[],Ae=0;Ae<b.length;Ae++)for(var ze=b[Ae],Ze=void 0,st=0;st<ze.length-1;st++){var pt=ze[st],Rt=ze[st+1];pt.x<I&&Rt.x<I||(pt.x<I?pt=new s(I,pt.y+(Rt.y-pt.y)*((I-pt.x)/(Rt.x-pt.x)))._round():Rt.x<I&&(Rt=new s(I,pt.y+(Rt.y-pt.y)*((I-pt.x)/(Rt.x-pt.x)))._round()),pt.y<V&&Rt.y<V||(pt.y<V?pt=new s(pt.x+(Rt.x-pt.x)*((V-pt.y)/(Rt.y-pt.y)),V)._round():Rt.y<V&&(Rt=new s(pt.x+(Rt.x-pt.x)*((V-pt.y)/(Rt.y-pt.y)),V)._round()),pt.x>=re&&Rt.x>=re||(pt.x>=re?pt=new s(re,pt.y+(Rt.y-pt.y)*((re-pt.x)/(Rt.x-pt.x)))._round():Rt.x>=re&&(Rt=new s(re,pt.y+(Rt.y-pt.y)*((re-pt.x)/(Rt.x-pt.x)))._round()),pt.y>=fe&&Rt.y>=fe||(pt.y>=fe?pt=new s(pt.x+(Rt.x-pt.x)*((fe-pt.y)/(Rt.y-pt.y)),fe)._round():Rt.y>=fe&&(Rt=new s(pt.x+(Rt.x-pt.x)*((fe-pt.y)/(Rt.y-pt.y)),fe)._round()),Ze&&pt.equals(Ze[Ze.length-1])||(Ze=[pt],ge.push(Ze)),Ze.push(Rt)))))}return ge}function Rf(b,I,V,re){var fe=[],ge=b.image,Ae=ge.pixelRatio,ze=ge.paddedRect.w-2,Ze=ge.paddedRect.h-2,st=b.right-b.left,pt=b.bottom-b.top,Rt=ge.stretchX||[[0,ze]],Gt=ge.stretchY||[[0,Ze]],Ut=function(Va,mi){return Va+mi[1]-mi[0]},rr=Rt.reduce(Ut,0),pr=Gt.reduce(Ut,0),Sr=ze-rr,Mr=Ze-pr,Dr=0,Rr=rr,Ur=0,cn=pr,vn=0,Fn=Sr,Dn=0,Hn=Mr;if(ge.content&&re){var ra=ge.content;Dr=Cc(Rt,0,ra[0]),Ur=Cc(Gt,0,ra[1]),Rr=Cc(Rt,ra[0],ra[2]),cn=Cc(Gt,ra[1],ra[3]),vn=ra[0]-Dr,Dn=ra[1]-Ur,Fn=ra[2]-ra[0]-Rr,Hn=ra[3]-ra[1]-cn}var na=function(Va,mi,ci,Ai){var ui=Pc(Va.stretch-Dr,Rr,st,b.left),ao=Ic(Va.fixed-vn,Fn,Va.stretch,rr),Mi=Pc(mi.stretch-Ur,cn,pt,b.top),Po=Ic(mi.fixed-Dn,Hn,mi.stretch,pr),xo=Pc(ci.stretch-Dr,Rr,st,b.left),wo=Ic(ci.fixed-vn,Fn,ci.stretch,rr),Go=Pc(Ai.stretch-Ur,cn,pt,b.top),Do=Ic(Ai.fixed-Dn,Hn,Ai.stretch,pr),io=new s(ui,Mi),To=new s(xo,Mi),Yi=new s(xo,Go),lo=new s(ui,Go),za=new s(ao/Ae,Po/Ae),Ja=new s(wo/Ae,Do/Ae),Bi=I*Math.PI/180;if(Bi){var Ni=Math.sin(Bi),zi=Math.cos(Bi),Si=[zi,-Ni,Ni,zi];io._matMult(Si),To._matMult(Si),lo._matMult(Si),Yi._matMult(Si)}var ri=Va.stretch+Va.fixed,ji=ci.stretch+ci.fixed,Yo=mi.stretch+mi.fixed,is=Ai.stretch+Ai.fixed;return{tl:io,tr:To,bl:lo,br:Yi,tex:{x:ge.paddedRect.x+1+ri,y:ge.paddedRect.y+1+Yo,w:ji-ri,h:is-Yo},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:za,pixelOffsetBR:Ja,minFontScaleX:Fn/Ae/st,minFontScaleY:Hn/Ae/pt,isSDF:V}};if(re&&(ge.stretchX||ge.stretchY))for(var Xn=Ff(Rt,Sr,rr),ua=Ff(Gt,Mr,pr),la=0;la<Xn.length-1;la++)for(var aa=Xn[la],Xa=Xn[la+1],Na=0;Na<ua.length-1;Na++){var Qa=ua[Na],xa=ua[Na+1];fe.push(na(aa,Qa,Xa,xa))}else fe.push(na({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:ze+1},{fixed:0,stretch:Ze+1}));return fe}function Cc(b,I,V){for(var re=0,fe=0,ge=b;fe<ge.length;fe+=1){var Ae=ge[fe];re+=Math.max(I,Math.min(V,Ae[1]))-Math.max(I,Math.min(V,Ae[0]))}return re}function Ff(b,I,V){for(var re=[{fixed:-1,stretch:0}],fe=0,ge=b;fe<ge.length;fe+=1){var Ae=ge[fe],ze=Ae[0],Ze=Ae[1],st=re[re.length-1];re.push({fixed:ze-st.stretch,stretch:st.stretch}),re.push({fixed:ze-st.stretch,stretch:st.stretch+(Ze-ze)})}return re.push({fixed:I+1,stretch:V}),re}function Pc(b,I,V,re){return b/I*V+re}function Ic(b,I,V,re){return b-I*V/re}var Oc=function(b,I,V,re,fe,ge,Ae,ze,Ze,st){if(this.boxStartIndex=b.length,Ze){var pt=ge.top,Rt=ge.bottom,Gt=ge.collisionPadding;Gt&&(pt-=Gt[1],Rt+=Gt[3]);var Ut=Rt-pt;Ut>0&&(Ut=Math.max(10,Ut),this.circleDiameter=Ut)}else{var rr=ge.top*Ae-ze,pr=ge.bottom*Ae+ze,Sr=ge.left*Ae-ze,Mr=ge.right*Ae+ze,Dr=ge.collisionPadding;if(Dr&&(Sr-=Dr[0]*Ae,rr-=Dr[1]*Ae,Mr+=Dr[2]*Ae,pr+=Dr[3]*Ae),st){var Rr=new s(Sr,rr),Ur=new s(Mr,rr),cn=new s(Sr,pr),vn=new s(Mr,pr),Fn=st*Math.PI/180;Rr._rotate(Fn),Ur._rotate(Fn),cn._rotate(Fn),vn._rotate(Fn),Sr=Math.min(Rr.x,Ur.x,cn.x,vn.x),Mr=Math.max(Rr.x,Ur.x,cn.x,vn.x),rr=Math.min(Rr.y,Ur.y,cn.y,vn.y),pr=Math.max(Rr.y,Ur.y,cn.y,vn.y)}b.emplaceBack(I.x,I.y,Sr,rr,Mr,pr,V,re,fe)}this.boxEndIndex=b.length},Il=function(b,I){if(b===void 0&&(b=[]),I===void 0&&(I=id),this.data=b,this.length=this.data.length,this.compare=I,this.length>0)for(var V=(this.length>>1)-1;V>=0;V--)this._down(V)};function id(b,I){return b<I?-1:b>I?1:0}function od(b,I,V){I===void 0&&(I=1),V===void 0&&(V=!1);for(var re=1/0,fe=1/0,ge=-1/0,Ae=-1/0,ze=b[0],Ze=0;Ze<ze.length;Ze++){var st=ze[Ze];(!Ze||st.x<re)&&(re=st.x),(!Ze||st.y<fe)&&(fe=st.y),(!Ze||st.x>ge)&&(ge=st.x),(!Ze||st.y>Ae)&&(Ae=st.y)}var pt=ge-re,Rt=Ae-fe,Gt=Math.min(pt,Rt),Ut=Gt/2,rr=new Il([],sd);if(Gt===0)return new s(re,fe);for(var pr=re;pr<ge;pr+=Gt)for(var Sr=fe;Sr<Ae;Sr+=Gt)rr.push(new Ol(pr+Ut,Sr+Ut,Ut,b));for(var Mr=function(Ur){for(var cn=0,vn=0,Fn=0,Dn=Ur[0],Hn=0,ra=Dn.length,na=ra-1;Hn<ra;na=Hn++){var Xn=Dn[Hn],ua=Dn[na],la=Xn.x*ua.y-ua.x*Xn.y;vn+=(Xn.x+ua.x)*la,Fn+=(Xn.y+ua.y)*la,cn+=3*la}return new Ol(vn/cn,Fn/cn,0,Ur)}(b),Dr=rr.length;rr.length;){var Rr=rr.pop();(Rr.d>Mr.d||!Mr.d)&&(Mr=Rr,V&&console.log("found best %d after %d probes",Math.round(1e4*Rr.d)/1e4,Dr)),Rr.max-Mr.d<=I||(Ut=Rr.h/2,rr.push(new Ol(Rr.p.x-Ut,Rr.p.y-Ut,Ut,b)),rr.push(new Ol(Rr.p.x+Ut,Rr.p.y-Ut,Ut,b)),rr.push(new Ol(Rr.p.x-Ut,Rr.p.y+Ut,Ut,b)),rr.push(new Ol(Rr.p.x+Ut,Rr.p.y+Ut,Ut,b)),Dr+=4)}return V&&(console.log("num probes: "+Dr),console.log("best distance: "+Mr.d)),Mr.p}function sd(b,I){return I.max-b.max}function Ol(b,I,V,re){this.p=new s(b,I),this.h=V,this.d=function(fe,ge){for(var Ae=!1,ze=1/0,Ze=0;Ze<ge.length;Ze++)for(var st=ge[Ze],pt=0,Rt=st.length,Gt=Rt-1;pt<Rt;Gt=pt++){var Ut=st[pt],rr=st[Gt];Ut.y>fe.y!=rr.y>fe.y&&fe.x<(rr.x-Ut.x)*(fe.y-Ut.y)/(rr.y-Ut.y)+Ut.x&&(Ae=!Ae),ze=Math.min(ze,Gs(fe,Ut,rr))}return(Ae?1:-1)*Math.sqrt(ze)}(this.p,re),this.max=this.d+this.h*Math.SQRT2}Il.prototype.push=function(b){this.data.push(b),this.length++,this._up(this.length-1)},Il.prototype.pop=function(){if(this.length!==0){var b=this.data[0],I=this.data.pop();return this.length--,this.length>0&&(this.data[0]=I,this._down(0)),b}},Il.prototype.peek=function(){return this.data[0]},Il.prototype._up=function(b){for(var I=this.data,V=this.compare,re=I[b];b>0;){var fe=b-1>>1,ge=I[fe];if(V(re,ge)>=0)break;I[b]=ge,b=fe}I[b]=re},Il.prototype._down=function(b){for(var I=this.data,V=this.compare,re=this.length>>1,fe=I[b];b<re;){var ge=1+(b<<1),Ae=I[ge],ze=ge+1;if(ze<this.length&&V(I[ze],Ae)<0&&(ge=ze,Ae=I[ze]),V(Ae,fe)>=0)break;I[b]=Ae,b=ge}I[b]=fe};var Tu=Number.POSITIVE_INFINITY;function Bf(b,I){return I[1]!==Tu?function(V,re,fe){var ge=0,Ae=0;switch(re=Math.abs(re),fe=Math.abs(fe),V){case"top-right":case"top-left":case"top":Ae=fe-7;break;case"bottom-right":case"bottom-left":case"bottom":Ae=7-fe}switch(V){case"top-right":case"bottom-right":case"right":ge=-re;break;case"top-left":case"bottom-left":case"left":ge=re}return[ge,Ae]}(b,I[0],I[1]):function(V,re){var fe=0,ge=0;re<0&&(re=0);var Ae=re/Math.sqrt(2);switch(V){case"top-right":case"top-left":ge=Ae-7;break;case"bottom-right":case"bottom-left":ge=7-Ae;break;case"bottom":ge=7-re;break;case"top":ge=re-7}switch(V){case"top-right":case"bottom-right":fe=-Ae;break;case"top-left":case"bottom-left":fe=Ae;break;case"left":fe=re;break;case"right":fe=-re}return[fe,ge]}(b,I[0])}function ku(b){switch(b){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Nf(b,I,V,re,fe,ge,Ae,ze,Ze,st,pt,Rt,Gt,Ut,rr){var pr=function(Ur,cn,vn,Fn,Dn,Hn,ra,na){for(var Xn=Fn.layout.get("text-rotate").evaluate(Hn,{})*Math.PI/180,ua=[],la=0,aa=cn.positionedLines;la<aa.length;la+=1)for(var Xa=aa[la],Na=0,Qa=Xa.positionedGlyphs;Na<Qa.length;Na+=1){var xa=Qa[Na];if(xa.rect){var Va=xa.rect||{},mi=4,ci=!0,Ai=1,ui=0,ao=(Dn||na)&&xa.vertical,Mi=xa.metrics.advance*xa.scale/2;if(na&&cn.verticalizable){var Po=24*(xa.scale-1),xo=(24-xa.metrics.width*xa.scale)/2;ui=Xa.lineOffset/2-(xa.imageName?-xo:Po)}if(xa.imageName){var wo=ra[xa.imageName];ci=wo.sdf,mi=1/(Ai=wo.pixelRatio)}var Go=Dn?[xa.x+Mi,xa.y]:[0,0],Do=Dn?[0,0]:[xa.x+Mi+vn[0],xa.y+vn[1]-ui],io=[0,0];ao&&(io=Do,Do=[0,0]);var To=(xa.metrics.left-mi)*xa.scale-Mi+Do[0],Yi=(-xa.metrics.top-mi)*xa.scale+Do[1],lo=To+Va.w*xa.scale/Ai,za=Yi+Va.h*xa.scale/Ai,Ja=new s(To,Yi),Bi=new s(lo,Yi),Ni=new s(To,za),zi=new s(lo,za);if(ao){var Si=new s(-Mi,Mi- -17),ri=-Math.PI/2,ji=12-Mi,Yo=xa.imageName?ji:0,is=new s(22-ji,-Yo),Ro=new(Function.prototype.bind.apply(s,[null].concat(io)));Ja._rotateAround(ri,Si)._add(is)._add(Ro),Bi._rotateAround(ri,Si)._add(is)._add(Ro),Ni._rotateAround(ri,Si)._add(is)._add(Ro),zi._rotateAround(ri,Si)._add(is)._add(Ro)}if(Xn){var Is=Math.sin(Xn),Js=Math.cos(Xn),bo=[Js,-Is,Is,Js];Ja._matMult(bo),Bi._matMult(bo),Ni._matMult(bo),zi._matMult(bo)}var Os=new s(0,0),zs=new s(0,0);ua.push({tl:Ja,tr:Bi,bl:Ni,br:zi,tex:Va,writingMode:cn.writingMode,glyphOffset:Go,sectionIndex:xa.sectionIndex,isSDF:ci,pixelOffsetTL:Os,pixelOffsetBR:zs,minFontScaleX:0,minFontScaleY:0})}}return ua}(0,V,ze,fe,ge,Ae,re,b.allowVerticalPlacement),Sr=b.textSizeData,Mr=null;Sr.kind==="source"?(Mr=[128*fe.layout.get("text-size").evaluate(Ae,{})])[0]>32640&&k(b.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):Sr.kind==="composite"&&((Mr=[128*Ut.compositeTextSizes[0].evaluate(Ae,{},rr),128*Ut.compositeTextSizes[1].evaluate(Ae,{},rr)])[0]>32640||Mr[1]>32640)&&k(b.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),b.addSymbols(b.text,pr,Mr,ze,ge,Ae,st,I,Ze.lineStartIndex,Ze.lineLength,Gt,rr);for(var Dr=0,Rr=pt;Dr<Rr.length;Dr+=1)Rt[Rr[Dr]]=b.text.placedSymbolArray.length-1;return 4*pr.length}function jf(b){for(var I in b)return b[I];return null}function ld(b,I,V,re){var fe=b.compareText;if(I in fe){for(var ge=fe[I],Ae=ge.length-1;Ae>=0;Ae--)if(re.dist(ge[Ae])<V)return!0}else fe[I]=[];return fe[I].push(re),!1}var cd=Sl.VectorTileFeature.types,ud=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function zc(b,I,V,re,fe,ge,Ae,ze,Ze,st,pt,Rt,Gt){var Ut=ze?Math.min(32640,Math.round(ze[0])):0,rr=ze?Math.min(32640,Math.round(ze[1])):0;b.emplaceBack(I,V,Math.round(32*re),Math.round(32*fe),ge,Ae,(Ut<<1)+(Ze?1:0),rr,16*st,16*pt,256*Rt,256*Gt)}function Au(b,I,V){b.emplaceBack(I.x,I.y,V),b.emplaceBack(I.x,I.y,V),b.emplaceBack(I.x,I.y,V),b.emplaceBack(I.x,I.y,V)}function fd(b){for(var I=0,V=b.sections;I<V.length;I+=1)if(Qn(V[I].text))return!0;return!1}var zl=function(b){this.layoutVertexArray=new Es,this.indexArray=new eo,this.programConfigurations=b,this.segments=new Dt,this.dynamicLayoutVertexArray=new ls,this.opacityVertexArray=new el,this.placedSymbolArray=new Ne};zl.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},zl.prototype.upload=function(b,I,V,re){this.isEmpty()||(V&&(this.layoutVertexBuffer=b.createVertexBuffer(this.layoutVertexArray,xu.members),this.indexBuffer=b.createIndexBuffer(this.indexArray,I),this.dynamicLayoutVertexBuffer=b.createVertexBuffer(this.dynamicLayoutVertexArray,Bp.members,!0),this.opacityVertexBuffer=b.createVertexBuffer(this.opacityVertexArray,ud,!0),this.opacityVertexBuffer.itemSize=1),(V||re)&&this.programConfigurations.upload(b))},zl.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Yr("SymbolBuffers",zl);var sc=function(b,I,V){this.layoutVertexArray=new b,this.layoutAttributes=I,this.indexArray=new V,this.segments=new Dt,this.collisionVertexArray=new Ls};sc.prototype.upload=function(b){this.layoutVertexBuffer=b.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=b.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=b.createVertexBuffer(this.collisionVertexArray,Np.members,!0)},sc.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Yr("CollisionBuffers",sc);var oi=function(b){this.collisionBoxArray=b.collisionBoxArray,this.zoom=b.zoom,this.overscaling=b.overscaling,this.layers=b.layers,this.layerIds=this.layers.map(function(Ae){return Ae.id}),this.index=b.index,this.pixelRatio=b.pixelRatio,this.sourceLayerIndex=b.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Jl([]),this.placementViewportMatrix=Jl([]);var I=this.layers[0]._unevaluatedLayout._values;this.textSizeData=wu(this.zoom,I["text-size"]),this.iconSizeData=wu(this.zoom,I["icon-size"]);var V=this.layers[0].layout,re=V.get("symbol-sort-key"),fe=V.get("symbol-z-order");this.sortFeaturesByKey=fe!=="viewport-y"&&re.constantOr(1)!==void 0;var ge=fe==="viewport-y"||fe==="auto"&&!this.sortFeaturesByKey;this.sortFeaturesByY=ge&&(V.get("text-allow-overlap")||V.get("icon-allow-overlap")||V.get("text-ignore-placement")||V.get("icon-ignore-placement")),V.get("symbol-placement")==="point"&&(this.writingModes=V.get("text-writing-mode").map(function(Ae){return cs[Ae]})),this.stateDependentLayerIds=this.layers.filter(function(Ae){return Ae.isStateDependent()}).map(function(Ae){return Ae.id}),this.sourceID=b.sourceID};oi.prototype.createArrays=function(){this.text=new zl(new li(xu.members,this.layers,this.zoom,function(b){return/^text/.test(b)})),this.icon=new zl(new li(xu.members,this.layers,this.zoom,function(b){return/^icon/.test(b)})),this.glyphOffsetArray=new yt,this.lineVertexArray=new St,this.symbolInstances=new tt},oi.prototype.calculateGlyphDependencies=function(b,I,V,re,fe){for(var ge=0;ge<b.length;ge++)if(I[b.charCodeAt(ge)]=!0,(V||re)&&fe){var Ae=ac[b.charAt(ge)];Ae&&(I[Ae.charCodeAt(0)]=!0)}},oi.prototype.populate=function(b,I,V){var re=this.layers[0],fe=re.layout,ge=fe.get("text-font"),Ae=fe.get("text-field"),ze=fe.get("icon-image"),Ze=(Ae.value.kind!=="constant"||Ae.value.value instanceof zr&&!Ae.value.value.isEmpty()||Ae.value.value.toString().length>0)&&(ge.value.kind!=="constant"||ge.value.value.length>0),st=ze.value.kind!=="constant"||!!ze.value.value||Object.keys(ze.parameters).length>0,pt=fe.get("symbol-sort-key");if(this.features=[],Ze||st){for(var Rt=I.iconDependencies,Gt=I.glyphDependencies,Ut=I.availableImages,rr=new ei(this.zoom),pr=0,Sr=b;pr<Sr.length;pr+=1){var Mr=Sr[pr],Dr=Mr.feature,Rr=Mr.id,Ur=Mr.index,cn=Mr.sourceLayerIndex,vn=re._featureFilter.needGeometry,Fn={type:Dr.type,id:Rr,properties:Dr.properties,geometry:vn?pi(Dr):[]};if(re._featureFilter.filter(rr,Fn,V)){vn||(Fn.geometry=pi(Dr));var Dn=void 0;if(Ze){var Hn=re.getValueAndResolveTokens("text-field",Fn,V,Ut),ra=zr.factory(Hn);fd(ra)&&(this.hasRTLText=!0),(!this.hasRTLText||Ui()==="unavailable"||this.hasRTLText&&so.isParsed())&&(Dn=Up(ra,re,Fn))}var na=void 0;if(st){var Xn=re.getValueAndResolveTokens("icon-image",Fn,V,Ut);na=Xn instanceof xr?Xn:xr.fromString(Xn)}if(Dn||na){var ua=this.sortFeaturesByKey?pt.evaluate(Fn,{},V):void 0,la={id:Rr,text:Dn,icon:na,index:Ur,sourceLayerIndex:cn,geometry:pi(Dr),properties:Dr.properties,type:cd[Dr.type],sortKey:ua};if(this.features.push(la),na&&(Rt[na.name]=!0),Dn){var aa=ge.evaluate(Fn,{},V).join(","),Xa=fe.get("text-rotation-alignment")==="map"&&fe.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(cs.vertical)>=0;for(var Na=0,Qa=Dn.sections;Na<Qa.length;Na+=1){var xa=Qa[Na];if(xa.image)Rt[xa.image.name]=!0;else{var Va=Ia(Dn.toString()),mi=xa.fontStack||aa,ci=Gt[mi]=Gt[mi]||{};this.calculateGlyphDependencies(xa.text,ci,Xa,this.allowVerticalPlacement,Va)}}}}}}fe.get("symbol-placement")==="line"&&(this.features=function(Ai){var ui={},ao={},Mi=[],Po=0;function xo(zi){Mi.push(Ai[zi]),Po++}function wo(zi,Si,ri){var ji=ao[zi];return delete ao[zi],ao[Si]=ji,Mi[ji].geometry[0].pop(),Mi[ji].geometry[0]=Mi[ji].geometry[0].concat(ri[0]),ji}function Go(zi,Si,ri){var ji=ui[Si];return delete ui[Si],ui[zi]=ji,Mi[ji].geometry[0].shift(),Mi[ji].geometry[0]=ri[0].concat(Mi[ji].geometry[0]),ji}function Do(zi,Si,ri){var ji=ri?Si[0][Si[0].length-1]:Si[0][0];return zi+":"+ji.x+":"+ji.y}for(var io=0;io<Ai.length;io++){var To=Ai[io],Yi=To.geometry,lo=To.text?To.text.toString():null;if(lo){var za=Do(lo,Yi),Ja=Do(lo,Yi,!0);if(za in ao&&Ja in ui&&ao[za]!==ui[Ja]){var Bi=Go(za,Ja,Yi),Ni=wo(za,Ja,Mi[Bi].geometry);delete ui[za],delete ao[Ja],ao[Do(lo,Mi[Ni].geometry,!0)]=Ni,Mi[Bi].geometry=null}else za in ao?wo(za,Ja,Yi):Ja in ui?Go(za,Ja,Yi):(xo(io),ui[za]=Po-1,ao[Ja]=Po-1)}else xo(io)}return Mi.filter(function(zi){return zi.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Ai,ui){return Ai.sortKey-ui.sortKey})}},oi.prototype.update=function(b,I,V){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(b,I,this.layers,V),this.icon.programConfigurations.updatePaintArrays(b,I,this.layers,V))},oi.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},oi.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},oi.prototype.upload=function(b){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(b),this.iconCollisionBox.upload(b)),this.text.upload(b,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(b,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},oi.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},oi.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},oi.prototype.addToLineVertexArray=function(b,I){var V=this.lineVertexArray.length;if(b.segment!==void 0){for(var re=b.dist(I[b.segment+1]),fe=b.dist(I[b.segment]),ge={},Ae=b.segment+1;Ae<I.length;Ae++)ge[Ae]={x:I[Ae].x,y:I[Ae].y,tileUnitDistanceFromAnchor:re},Ae<I.length-1&&(re+=I[Ae+1].dist(I[Ae]));for(var ze=b.segment||0;ze>=0;ze--)ge[ze]={x:I[ze].x,y:I[ze].y,tileUnitDistanceFromAnchor:fe},ze>0&&(fe+=I[ze-1].dist(I[ze]));for(var Ze=0;Ze<I.length;Ze++){var st=ge[Ze];this.lineVertexArray.emplaceBack(st.x,st.y,st.tileUnitDistanceFromAnchor)}}return{lineStartIndex:V,lineLength:this.lineVertexArray.length-V}},oi.prototype.addSymbols=function(b,I,V,re,fe,ge,Ae,ze,Ze,st,pt,Rt){for(var Gt=b.indexArray,Ut=b.layoutVertexArray,rr=b.segments.prepareSegment(4*I.length,Ut,Gt,ge.sortKey),pr=this.glyphOffsetArray.length,Sr=rr.vertexLength,Mr=this.allowVerticalPlacement&&Ae===cs.vertical?Math.PI/2:0,Dr=ge.text&&ge.text.sections,Rr=0;Rr<I.length;Rr++){var Ur=I[Rr],cn=Ur.tl,vn=Ur.tr,Fn=Ur.bl,Dn=Ur.br,Hn=Ur.tex,ra=Ur.pixelOffsetTL,na=Ur.pixelOffsetBR,Xn=Ur.minFontScaleX,ua=Ur.minFontScaleY,la=Ur.glyphOffset,aa=Ur.isSDF,Xa=Ur.sectionIndex,Na=rr.vertexLength,Qa=la[1];zc(Ut,ze.x,ze.y,cn.x,Qa+cn.y,Hn.x,Hn.y,V,aa,ra.x,ra.y,Xn,ua),zc(Ut,ze.x,ze.y,vn.x,Qa+vn.y,Hn.x+Hn.w,Hn.y,V,aa,na.x,ra.y,Xn,ua),zc(Ut,ze.x,ze.y,Fn.x,Qa+Fn.y,Hn.x,Hn.y+Hn.h,V,aa,ra.x,na.y,Xn,ua),zc(Ut,ze.x,ze.y,Dn.x,Qa+Dn.y,Hn.x+Hn.w,Hn.y+Hn.h,V,aa,na.x,na.y,Xn,ua),Au(b.dynamicLayoutVertexArray,ze,Mr),Gt.emplaceBack(Na,Na+1,Na+2),Gt.emplaceBack(Na+1,Na+2,Na+3),rr.vertexLength+=4,rr.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(la[0]),Rr!==I.length-1&&Xa===I[Rr+1].sectionIndex||b.programConfigurations.populatePaintArrays(Ut.length,ge,ge.index,{},Rt,Dr&&Dr[Xa])}b.placedSymbolArray.emplaceBack(ze.x,ze.y,pr,this.glyphOffsetArray.length-pr,Sr,Ze,st,ze.segment,V?V[0]:0,V?V[1]:0,re[0],re[1],Ae,0,!1,0,pt)},oi.prototype._addCollisionDebugVertex=function(b,I,V,re,fe,ge){return I.emplaceBack(0,0),b.emplaceBack(V.x,V.y,re,fe,Math.round(ge.x),Math.round(ge.y))},oi.prototype.addCollisionDebugVertices=function(b,I,V,re,fe,ge,Ae){var ze=fe.segments.prepareSegment(4,fe.layoutVertexArray,fe.indexArray),Ze=ze.vertexLength,st=fe.layoutVertexArray,pt=fe.collisionVertexArray,Rt=Ae.anchorX,Gt=Ae.anchorY;this._addCollisionDebugVertex(st,pt,ge,Rt,Gt,new s(b,I)),this._addCollisionDebugVertex(st,pt,ge,Rt,Gt,new s(V,I)),this._addCollisionDebugVertex(st,pt,ge,Rt,Gt,new s(V,re)),this._addCollisionDebugVertex(st,pt,ge,Rt,Gt,new s(b,re)),ze.vertexLength+=4;var Ut=fe.indexArray;Ut.emplaceBack(Ze,Ze+1),Ut.emplaceBack(Ze+1,Ze+2),Ut.emplaceBack(Ze+2,Ze+3),Ut.emplaceBack(Ze+3,Ze),ze.primitiveLength+=4},oi.prototype.addDebugCollisionBoxes=function(b,I,V,re){for(var fe=b;fe<I;fe++){var ge=this.collisionBoxArray.get(fe),Ae=ge.x1,ze=ge.y1,Ze=ge.x2,st=ge.y2;this.addCollisionDebugVertices(Ae,ze,Ze,st,re?this.textCollisionBox:this.iconCollisionBox,ge.anchorPoint,V)}},oi.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new sc(vs,yf.members,R),this.iconCollisionBox=new sc(vs,yf.members,R);for(var b=0;b<this.symbolInstances.length;b++){var I=this.symbolInstances.get(b);this.addDebugCollisionBoxes(I.textBoxStartIndex,I.textBoxEndIndex,I,!0),this.addDebugCollisionBoxes(I.verticalTextBoxStartIndex,I.verticalTextBoxEndIndex,I,!0),this.addDebugCollisionBoxes(I.iconBoxStartIndex,I.iconBoxEndIndex,I,!1),this.addDebugCollisionBoxes(I.verticalIconBoxStartIndex,I.verticalIconBoxEndIndex,I,!1)}},oi.prototype._deserializeCollisionBoxesForSymbol=function(b,I,V,re,fe,ge,Ae,ze,Ze){for(var st={},pt=I;pt<V;pt++){var Rt=b.get(pt);st.textBox={x1:Rt.x1,y1:Rt.y1,x2:Rt.x2,y2:Rt.y2,anchorPointX:Rt.anchorPointX,anchorPointY:Rt.anchorPointY},st.textFeatureIndex=Rt.featureIndex;break}for(var Gt=re;Gt<fe;Gt++){var Ut=b.get(Gt);st.verticalTextBox={x1:Ut.x1,y1:Ut.y1,x2:Ut.x2,y2:Ut.y2,anchorPointX:Ut.anchorPointX,anchorPointY:Ut.anchorPointY},st.verticalTextFeatureIndex=Ut.featureIndex;break}for(var rr=ge;rr<Ae;rr++){var pr=b.get(rr);st.iconBox={x1:pr.x1,y1:pr.y1,x2:pr.x2,y2:pr.y2,anchorPointX:pr.anchorPointX,anchorPointY:pr.anchorPointY},st.iconFeatureIndex=pr.featureIndex;break}for(var Sr=ze;Sr<Ze;Sr++){var Mr=b.get(Sr);st.verticalIconBox={x1:Mr.x1,y1:Mr.y1,x2:Mr.x2,y2:Mr.y2,anchorPointX:Mr.anchorPointX,anchorPointY:Mr.anchorPointY},st.verticalIconFeatureIndex=Mr.featureIndex;break}return st},oi.prototype.deserializeCollisionBoxes=function(b){this.collisionArrays=[];for(var I=0;I<this.symbolInstances.length;I++){var V=this.symbolInstances.get(I);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(b,V.textBoxStartIndex,V.textBoxEndIndex,V.verticalTextBoxStartIndex,V.verticalTextBoxEndIndex,V.iconBoxStartIndex,V.iconBoxEndIndex,V.verticalIconBoxStartIndex,V.verticalIconBoxEndIndex))}},oi.prototype.hasTextData=function(){return this.text.segments.get().length>0},oi.prototype.hasIconData=function(){return this.icon.segments.get().length>0},oi.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},oi.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},oi.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},oi.prototype.addIndicesForPlacedSymbol=function(b,I){for(var V=b.placedSymbolArray.get(I),re=V.vertexStartIndex+4*V.numGlyphs,fe=V.vertexStartIndex;fe<re;fe+=4)b.indexArray.emplaceBack(fe,fe+1,fe+2),b.indexArray.emplaceBack(fe+1,fe+2,fe+3)},oi.prototype.getSortedSymbolIndexes=function(b){if(this.sortedAngle===b&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var I=Math.sin(b),V=Math.cos(b),re=[],fe=[],ge=[],Ae=0;Ae<this.symbolInstances.length;++Ae){ge.push(Ae);var ze=this.symbolInstances.get(Ae);re.push(0|Math.round(I*ze.anchorX+V*ze.anchorY)),fe.push(ze.featureIndex)}return ge.sort(function(Ze,st){return re[Ze]-re[st]||fe[st]-fe[Ze]}),ge},oi.prototype.addToSortKeyRanges=function(b,I){var V=this.sortKeyRanges[this.sortKeyRanges.length-1];V&&V.sortKey===I?V.symbolInstanceEnd=b+1:this.sortKeyRanges.push({sortKey:I,symbolInstanceStart:b,symbolInstanceEnd:b+1})},oi.prototype.sortFeatures=function(b){var I=this;if(this.sortFeaturesByY&&this.sortedAngle!==b&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(b),this.sortedAngle=b,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var V=0,re=this.symbolInstanceIndexes;V<re.length;V+=1){var fe=re[V],ge=this.symbolInstances.get(fe);this.featureSortOrder.push(ge.featureIndex),[ge.rightJustifiedTextSymbolIndex,ge.centerJustifiedTextSymbolIndex,ge.leftJustifiedTextSymbolIndex].forEach(function(Ae,ze,Ze){Ae>=0&&Ze.indexOf(Ae)===ze&&I.addIndicesForPlacedSymbol(I.text,Ae)}),ge.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,ge.verticalPlacedTextSymbolIndex),ge.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,ge.placedIconSymbolIndex),ge.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,ge.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Yr("SymbolBucket",oi,{omit:["layers","collisionBoxArray","features","compareText"]}),oi.MAX_GLYPHS=65535,oi.addDynamicAttributes=Au;var hd=new Eo({"symbol-placement":new oa(Pe.layout_symbol["symbol-placement"]),"symbol-spacing":new oa(Pe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new oa(Pe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ga(Pe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new oa(Pe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new oa(Pe.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new oa(Pe.layout_symbol["icon-ignore-placement"]),"icon-optional":new oa(Pe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new oa(Pe.layout_symbol["icon-rotation-alignment"]),"icon-size":new ga(Pe.layout_symbol["icon-size"]),"icon-text-fit":new oa(Pe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new oa(Pe.layout_symbol["icon-text-fit-padding"]),"icon-image":new ga(Pe.layout_symbol["icon-image"]),"icon-rotate":new ga(Pe.layout_symbol["icon-rotate"]),"icon-padding":new oa(Pe.layout_symbol["icon-padding"]),"icon-keep-upright":new oa(Pe.layout_symbol["icon-keep-upright"]),"icon-offset":new ga(Pe.layout_symbol["icon-offset"]),"icon-anchor":new ga(Pe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new oa(Pe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new oa(Pe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new oa(Pe.layout_symbol["text-rotation-alignment"]),"text-field":new ga(Pe.layout_symbol["text-field"]),"text-font":new ga(Pe.layout_symbol["text-font"]),"text-size":new ga(Pe.layout_symbol["text-size"]),"text-max-width":new ga(Pe.layout_symbol["text-max-width"]),"text-line-height":new oa(Pe.layout_symbol["text-line-height"]),"text-letter-spacing":new ga(Pe.layout_symbol["text-letter-spacing"]),"text-justify":new ga(Pe.layout_symbol["text-justify"]),"text-radial-offset":new ga(Pe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new oa(Pe.layout_symbol["text-variable-anchor"]),"text-anchor":new ga(Pe.layout_symbol["text-anchor"]),"text-max-angle":new oa(Pe.layout_symbol["text-max-angle"]),"text-writing-mode":new oa(Pe.layout_symbol["text-writing-mode"]),"text-rotate":new ga(Pe.layout_symbol["text-rotate"]),"text-padding":new oa(Pe.layout_symbol["text-padding"]),"text-keep-upright":new oa(Pe.layout_symbol["text-keep-upright"]),"text-transform":new ga(Pe.layout_symbol["text-transform"]),"text-offset":new ga(Pe.layout_symbol["text-offset"]),"text-allow-overlap":new oa(Pe.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new oa(Pe.layout_symbol["text-ignore-placement"]),"text-optional":new oa(Pe.layout_symbol["text-optional"])}),Mu={paint:new Eo({"icon-opacity":new ga(Pe.paint_symbol["icon-opacity"]),"icon-color":new ga(Pe.paint_symbol["icon-color"]),"icon-halo-color":new ga(Pe.paint_symbol["icon-halo-color"]),"icon-halo-width":new ga(Pe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ga(Pe.paint_symbol["icon-halo-blur"]),"icon-translate":new oa(Pe.paint_symbol["icon-translate"]),"icon-translate-anchor":new oa(Pe.paint_symbol["icon-translate-anchor"]),"text-opacity":new ga(Pe.paint_symbol["text-opacity"]),"text-color":new ga(Pe.paint_symbol["text-color"],{runtimeType:Nt,getOverride:function(b){return b.textColor},hasOverride:function(b){return!!b.textColor}}),"text-halo-color":new ga(Pe.paint_symbol["text-halo-color"]),"text-halo-width":new ga(Pe.paint_symbol["text-halo-width"]),"text-halo-blur":new ga(Pe.paint_symbol["text-halo-blur"]),"text-translate":new oa(Pe.paint_symbol["text-translate"]),"text-translate-anchor":new oa(Pe.paint_symbol["text-translate-anchor"])}),layout:hd},Dl=function(b){this.type=b.property.overrides?b.property.overrides.runtimeType:vt,this.defaultValue=b};Dl.prototype.evaluate=function(b){if(b.formattedSection){var I=this.defaultValue.property.overrides;if(I&&I.hasOverride(b.formattedSection))return I.getOverride(b.formattedSection)}return b.feature&&b.featureState?this.defaultValue.evaluate(b.feature,b.featureState):this.defaultValue.property.specification.default},Dl.prototype.eachChild=function(b){this.defaultValue.isConstant()||b(this.defaultValue.value._styleExpression.expression)},Dl.prototype.outputDefined=function(){return!1},Dl.prototype.serialize=function(){return null},Yr("FormatSectionOverride",Dl,{omit:["defaultValue"]});var pd=function(b){function I(V){b.call(this,V,Mu)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.recalculate=function(V,re){if(b.prototype.recalculate.call(this,V,re),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var fe=this.layout.get("text-writing-mode");if(fe){for(var ge=[],Ae=0,ze=fe;Ae<ze.length;Ae+=1){var Ze=ze[Ae];ge.indexOf(Ze)<0&&ge.push(Ze)}this.layout._values["text-writing-mode"]=ge}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},I.prototype.getValueAndResolveTokens=function(V,re,fe,ge){var Ae=this.layout.get(V).evaluate(re,{},fe,ge),ze=this._unevaluatedLayout._values[V];return ze.isDataDriven()||Jt(ze.value)||!Ae?Ae:function(Ze,st){return st.replace(/{([^{}]+)}/g,function(pt,Rt){return Rt in Ze?String(Ze[Rt]):""})}(re.properties,Ae)},I.prototype.createBucket=function(V){return new oi(V)},I.prototype.queryRadius=function(){return 0},I.prototype.queryIntersectsFeature=function(){return!1},I.prototype._setPaintOverrides=function(){for(var V=0,re=Mu.paint.overridableProperties;V<re.length;V+=1){var fe=re[V];if(I.hasPaintOverride(this.layout,fe)){var ge=this.paint.get(fe),Ae=new Dl(ge),ze=new Wt(Ae,ge.property.specification),Ze=null;Ze=ge.value.kind==="constant"||ge.value.kind==="source"?new tr("source",ze):new lr("composite",ze,ge.value.zoomStops,ge.value._interpolationType),this.paint._values[fe]=new Oi(ge.property,Ze,ge.parameters)}}},I.prototype._handleOverridablePaintPropertyUpdate=function(V,re,fe){return!(!this.layout||re.isDataDriven()||fe.isDataDriven())&&I.hasPaintOverride(this.layout,V)},I.hasPaintOverride=function(V,re){var fe=V.get("text-field"),ge=Mu.paint.properties[re],Ae=!1,ze=function(pt){for(var Rt=0,Gt=pt;Rt<Gt.length;Rt+=1){var Ut=Gt[Rt];if(ge.overrides&&ge.overrides.hasOverride(Ut))return void(Ae=!0)}};if(fe.value.kind==="constant"&&fe.value.value instanceof zr)ze(fe.value.value.sections);else if(fe.value.kind==="source"){var Ze=function(pt){if(!Ae)if(pt instanceof Pn&&fn(pt.value)===bt){var Rt=pt.value;ze(Rt.sections)}else pt instanceof Lr?ze(pt.sections):pt.eachChild(Ze)},st=fe.value;st._styleExpression&&Ze(st._styleExpression.expression)}return Ae},I}(qo),dd={paint:new Eo({"background-color":new oa(Pe.paint_background["background-color"]),"background-pattern":new js(Pe.paint_background["background-pattern"]),"background-opacity":new oa(Pe.paint_background["background-opacity"])})},md=function(b){function I(V){b.call(this,V,dd)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I}(qo),gd={paint:new Eo({"raster-opacity":new oa(Pe.paint_raster["raster-opacity"]),"raster-hue-rotate":new oa(Pe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new oa(Pe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new oa(Pe.paint_raster["raster-brightness-max"]),"raster-saturation":new oa(Pe.paint_raster["raster-saturation"]),"raster-contrast":new oa(Pe.paint_raster["raster-contrast"]),"raster-resampling":new oa(Pe.paint_raster["raster-resampling"]),"raster-fade-duration":new oa(Pe.paint_raster["raster-fade-duration"])})},vd=function(b){function I(V){b.call(this,V,gd)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I}(qo),yd=function(b){function I(V){b.call(this,V,{}),this.implementation=V}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},I.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},I.prototype.recalculate=function(){},I.prototype.updateTransitions=function(){},I.prototype.hasTransition=function(){},I.prototype.serialize=function(){},I.prototype.onAdd=function(V){this.implementation.onAdd&&this.implementation.onAdd(V,V.painter.context.gl)},I.prototype.onRemove=function(V){this.implementation.onRemove&&this.implementation.onRemove(V,V.painter.context.gl)},I}(qo),xd={circle:ap,heatmap:op,hillshade:lp,fill:kp,"fill-extrusion":Op,line:Fp,symbol:pd,background:md,raster:vd},Uf=self.HTMLImageElement,Vf=self.HTMLCanvasElement,Hf=self.HTMLVideoElement,qf=self.ImageData,Dc=self.ImageBitmap,yl=function(b,I,V,re){this.context=b,this.format=V,this.texture=b.gl.createTexture(),this.update(I,re)};yl.prototype.update=function(b,I,V){var re=b.width,fe=b.height,ge=!(this.size&&this.size[0]===re&&this.size[1]===fe||V),Ae=this.context,ze=Ae.gl;if(this.useMipmap=Boolean(I&&I.useMipmap),ze.bindTexture(ze.TEXTURE_2D,this.texture),Ae.pixelStoreUnpackFlipY.set(!1),Ae.pixelStoreUnpack.set(1),Ae.pixelStoreUnpackPremultiplyAlpha.set(this.format===ze.RGBA&&(!I||I.premultiply!==!1)),ge)this.size=[re,fe],b instanceof Uf||b instanceof Vf||b instanceof Hf||b instanceof qf||Dc&&b instanceof Dc?ze.texImage2D(ze.TEXTURE_2D,0,this.format,this.format,ze.UNSIGNED_BYTE,b):ze.texImage2D(ze.TEXTURE_2D,0,this.format,re,fe,0,this.format,ze.UNSIGNED_BYTE,b.data);else{var Ze=V||{x:0,y:0},st=Ze.x,pt=Ze.y;b instanceof Uf||b instanceof Vf||b instanceof Hf||b instanceof qf||Dc&&b instanceof Dc?ze.texSubImage2D(ze.TEXTURE_2D,0,st,pt,ze.RGBA,ze.UNSIGNED_BYTE,b):ze.texSubImage2D(ze.TEXTURE_2D,0,st,pt,re,fe,ze.RGBA,ze.UNSIGNED_BYTE,b.data)}this.useMipmap&&this.isSizePowerOfTwo()&&ze.generateMipmap(ze.TEXTURE_2D)},yl.prototype.bind=function(b,I,V){var re=this.context.gl;re.bindTexture(re.TEXTURE_2D,this.texture),V!==re.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(V=re.LINEAR),b!==this.filter&&(re.texParameteri(re.TEXTURE_2D,re.TEXTURE_MAG_FILTER,b),re.texParameteri(re.TEXTURE_2D,re.TEXTURE_MIN_FILTER,V||b),this.filter=b),I!==this.wrap&&(re.texParameteri(re.TEXTURE_2D,re.TEXTURE_WRAP_S,I),re.texParameteri(re.TEXTURE_2D,re.TEXTURE_WRAP_T,I),this.wrap=I)},yl.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},yl.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var Su=function(b){var I=this;this._callback=b,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){I._triggered=!1,I._callback()})};Su.prototype.trigger=function(){var b=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){b._triggered=!1,b._callback()},0))},Su.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Rl=function(b,I,V){this.target=b,this.parent=I,this.mapId=V,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},x(["receive","process"],this),this.invoker=new Su(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=P()?b:self};function Gf(b,I,V){var re=2*Math.PI*6378137/256/Math.pow(2,V);return[b*re-2*Math.PI*6378137/2,I*re-2*Math.PI*6378137/2]}Rl.prototype.send=function(b,I,V,re,fe){var ge=this;fe===void 0&&(fe=!1);var Ae=Math.round(1e18*Math.random()).toString(36).substring(0,10);V&&(this.callbacks[Ae]=V);var ze=j(this.globalScope)?void 0:[];return this.target.postMessage({id:Ae,type:b,hasCallback:!!V,targetMapId:re,mustQueue:fe,sourceMapId:this.mapId,data:Jn(I,ze)},ze),{cancel:function(){V&&delete ge.callbacks[Ae],ge.target.postMessage({id:Ae,type:"<cancel>",targetMapId:re,sourceMapId:ge.mapId})}}},Rl.prototype.receive=function(b){var I=b.data,V=I.id;if(V&&(!I.targetMapId||this.mapId===I.targetMapId))if(I.type==="<cancel>"){delete this.tasks[V];var re=this.cancelCallbacks[V];delete this.cancelCallbacks[V],re&&re()}else P()||I.mustQueue?(this.tasks[V]=I,this.taskQueue.push(V),this.invoker.trigger()):this.processTask(V,I)},Rl.prototype.process=function(){if(this.taskQueue.length){var b=this.taskQueue.shift(),I=this.tasks[b];delete this.tasks[b],this.taskQueue.length&&this.invoker.trigger(),I&&this.processTask(b,I)}},Rl.prototype.processTask=function(b,I){var V=this;if(I.type==="<response>"){var re=this.callbacks[b];delete this.callbacks[b],re&&(I.error?re(ba(I.error)):re(null,ba(I.data)))}else{var fe=!1,ge=j(this.globalScope)?void 0:[],Ae=I.hasCallback?function(pt,Rt){fe=!0,delete V.cancelCallbacks[b],V.target.postMessage({id:b,type:"<response>",sourceMapId:V.mapId,error:pt?Jn(pt):null,data:Jn(Rt,ge)},ge)}:function(pt){fe=!0},ze=null,Ze=ba(I.data);if(this.parent[I.type])ze=this.parent[I.type](I.sourceMapId,Ze,Ae);else if(this.parent.getWorkerSource){var st=I.type.split(".");ze=this.parent.getWorkerSource(I.sourceMapId,st[0],Ze.source)[st[1]](Ze,Ae)}else Ae(new Error("Could not find function "+I.type));!fe&&ze&&ze.cancel&&(this.cancelCallbacks[b]=ze.cancel)}},Rl.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var ro=function(b,I){b&&(I?this.setSouthWest(b).setNorthEast(I):b.length===4?this.setSouthWest([b[0],b[1]]).setNorthEast([b[2],b[3]]):this.setSouthWest(b[0]).setNorthEast(b[1]))};ro.prototype.setNorthEast=function(b){return this._ne=b instanceof ki?new ki(b.lng,b.lat):ki.convert(b),this},ro.prototype.setSouthWest=function(b){return this._sw=b instanceof ki?new ki(b.lng,b.lat):ki.convert(b),this},ro.prototype.extend=function(b){var I,V,re=this._sw,fe=this._ne;if(b instanceof ki)I=b,V=b;else{if(!(b instanceof ro)){if(Array.isArray(b)){if(b.length===4||b.every(Array.isArray)){var ge=b;return this.extend(ro.convert(ge))}var Ae=b;return this.extend(ki.convert(Ae))}return this}if(I=b._sw,V=b._ne,!I||!V)return this}return re||fe?(re.lng=Math.min(I.lng,re.lng),re.lat=Math.min(I.lat,re.lat),fe.lng=Math.max(V.lng,fe.lng),fe.lat=Math.max(V.lat,fe.lat)):(this._sw=new ki(I.lng,I.lat),this._ne=new ki(V.lng,V.lat)),this},ro.prototype.getCenter=function(){return new ki((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},ro.prototype.getSouthWest=function(){return this._sw},ro.prototype.getNorthEast=function(){return this._ne},ro.prototype.getNorthWest=function(){return new ki(this.getWest(),this.getNorth())},ro.prototype.getSouthEast=function(){return new ki(this.getEast(),this.getSouth())},ro.prototype.getWest=function(){return this._sw.lng},ro.prototype.getSouth=function(){return this._sw.lat},ro.prototype.getEast=function(){return this._ne.lng},ro.prototype.getNorth=function(){return this._ne.lat},ro.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},ro.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},ro.prototype.isEmpty=function(){return!(this._sw&&this._ne)},ro.prototype.contains=function(b){var I=ki.convert(b),V=I.lng,re=I.lat,fe=this._sw.lat<=re&&re<=this._ne.lat,ge=this._sw.lng<=V&&V<=this._ne.lng;return this._sw.lng>this._ne.lng&&(ge=this._sw.lng>=V&&V>=this._ne.lng),fe&&ge},ro.convert=function(b){return!b||b instanceof ro?b:new ro(b)};var ki=function(b,I){if(isNaN(b)||isNaN(I))throw new Error("Invalid LngLat object: ("+b+", "+I+")");if(this.lng=+b,this.lat=+I,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};ki.prototype.wrap=function(){return new ki(n(this.lng,-180,180),this.lat)},ki.prototype.toArray=function(){return[this.lng,this.lat]},ki.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},ki.prototype.distanceTo=function(b){var I=Math.PI/180,V=this.lat*I,re=b.lat*I,fe=Math.sin(V)*Math.sin(re)+Math.cos(V)*Math.cos(re)*Math.cos((b.lng-this.lng)*I);return 63710088e-1*Math.acos(Math.min(fe,1))},ki.prototype.toBounds=function(b){b===void 0&&(b=0);var I=360*b/40075017,V=I/Math.cos(Math.PI/180*this.lat);return new ro(new ki(this.lng-V,this.lat-I),new ki(this.lng+V,this.lat+I))},ki.convert=function(b){if(b instanceof ki)return b;if(Array.isArray(b)&&(b.length===2||b.length===3))return new ki(Number(b[0]),Number(b[1]));if(!Array.isArray(b)&&typeof b=="object"&&b!==null)return new ki(Number("lng"in b?b.lng:b.lon),Number(b.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Yf=2*Math.PI*63710088e-1;function Wf(b){return Yf*Math.cos(b*Math.PI/180)}function Xf(b){return(180+b)/360}function Zf(b){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+b*Math.PI/360)))/360}function Jf(b,I){return b/Wf(I)}function Eu(b){var I=180-360*b;return 360/Math.PI*Math.atan(Math.exp(I*Math.PI/180))-90}var xl=function(b,I,V){V===void 0&&(V=0),this.x=+b,this.y=+I,this.z=+V};xl.fromLngLat=function(b,I){I===void 0&&(I=0);var V=ki.convert(b);return new xl(Xf(V.lng),Zf(V.lat),Jf(I,V.lat))},xl.prototype.toLngLat=function(){return new ki(360*this.x-180,Eu(this.y))},xl.prototype.toAltitude=function(){return b=this.z,I=this.y,b*Wf(Eu(I));var b,I},xl.prototype.meterInMercatorCoordinateUnits=function(){return 1/Yf*(b=Eu(this.y),1/Math.cos(b*Math.PI/180));var b};var bl=function(b,I,V){this.z=b,this.x=I,this.y=V,this.key=lc(0,b,b,I,V)};bl.prototype.equals=function(b){return this.z===b.z&&this.x===b.x&&this.y===b.y},bl.prototype.url=function(b,I){var V,re,fe,ge,Ae,ze=(V=this.x,re=this.y,fe=this.z,ge=Gf(256*V,256*(re=Math.pow(2,fe)-re-1),fe),Ae=Gf(256*(V+1),256*(re+1),fe),ge[0]+","+ge[1]+","+Ae[0]+","+Ae[1]),Ze=function(st,pt,Rt){for(var Gt,Ut="",rr=st;rr>0;rr--)Ut+=(pt&(Gt=1<<rr-1)?1:0)+(Rt&Gt?2:0);return Ut}(this.z,this.x,this.y);return b[(this.x+this.y)%b.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(I==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",Ze).replace("{bbox-epsg-3857}",ze)},bl.prototype.getTilePoint=function(b){var I=Math.pow(2,this.z);return new s(8192*(b.x*I-this.x),8192*(b.y*I-this.y))},bl.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var Kf=function(b,I){this.wrap=b,this.canonical=I,this.key=lc(b,I.z,I.z,I.x,I.y)},no=function(b,I,V,re,fe){this.overscaledZ=b,this.wrap=I,this.canonical=new bl(V,+re,+fe),this.key=lc(I,b,V,re,fe)};function lc(b,I,V,re,fe){(b*=2)<0&&(b=-1*b-1);var ge=1<<V;return(ge*ge*b+ge*fe+re).toString(36)+V.toString(36)+I.toString(36)}no.prototype.equals=function(b){return this.overscaledZ===b.overscaledZ&&this.wrap===b.wrap&&this.canonical.equals(b.canonical)},no.prototype.scaledTo=function(b){var I=this.canonical.z-b;return b>this.canonical.z?new no(b,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new no(b,this.wrap,b,this.canonical.x>>I,this.canonical.y>>I)},no.prototype.calculateScaledKey=function(b,I){var V=this.canonical.z-b;return b>this.canonical.z?lc(this.wrap*+I,b,this.canonical.z,this.canonical.x,this.canonical.y):lc(this.wrap*+I,b,b,this.canonical.x>>V,this.canonical.y>>V)},no.prototype.isChildOf=function(b){if(b.wrap!==this.wrap)return!1;var I=this.canonical.z-b.canonical.z;return b.overscaledZ===0||b.overscaledZ<this.overscaledZ&&b.canonical.x===this.canonical.x>>I&&b.canonical.y===this.canonical.y>>I},no.prototype.children=function(b){if(this.overscaledZ>=b)return[new no(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var I=this.canonical.z+1,V=2*this.canonical.x,re=2*this.canonical.y;return[new no(I,this.wrap,I,V,re),new no(I,this.wrap,I,V+1,re),new no(I,this.wrap,I,V,re+1),new no(I,this.wrap,I,V+1,re+1)]},no.prototype.isLessThan=function(b){return this.wrap<b.wrap||!(this.wrap>b.wrap)&&(this.overscaledZ<b.overscaledZ||!(this.overscaledZ>b.overscaledZ)&&(this.canonical.x<b.canonical.x||!(this.canonical.x>b.canonical.x)&&this.canonical.y<b.canonical.y))},no.prototype.wrapped=function(){return new no(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},no.prototype.unwrapTo=function(b){return new no(this.overscaledZ,b,this.canonical.z,this.canonical.x,this.canonical.y)},no.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},no.prototype.toUnwrapped=function(){return new Kf(this.wrap,this.canonical)},no.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},no.prototype.getTilePoint=function(b){return this.canonical.getTilePoint(new xl(b.x-this.wrap,b.y))},Yr("CanonicalTileID",bl),Yr("OverscaledTileID",no,{omit:["posMatrix"]});var Xs=function(b,I,V){if(this.uid=b,I.height!==I.width)throw new RangeError("DEM tiles must be square");if(V&&V!=="mapbox"&&V!=="terrarium")return k('"'+V+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=I.height;var re=this.dim=I.height-2;this.data=new Uint32Array(I.data.buffer),this.encoding=V||"mapbox";for(var fe=0;fe<re;fe++)this.data[this._idx(-1,fe)]=this.data[this._idx(0,fe)],this.data[this._idx(re,fe)]=this.data[this._idx(re-1,fe)],this.data[this._idx(fe,-1)]=this.data[this._idx(fe,0)],this.data[this._idx(fe,re)]=this.data[this._idx(fe,re-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(re,-1)]=this.data[this._idx(re-1,0)],this.data[this._idx(-1,re)]=this.data[this._idx(0,re-1)],this.data[this._idx(re,re)]=this.data[this._idx(re-1,re-1)]};Xs.prototype.get=function(b,I){var V=new Uint8Array(this.data.buffer),re=4*this._idx(b,I);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(V[re],V[re+1],V[re+2])},Xs.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Xs.prototype._idx=function(b,I){if(b<-1||b>=this.dim+1||I<-1||I>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(I+1)*this.stride+(b+1)},Xs.prototype._unpackMapbox=function(b,I,V){return(256*b*256+256*I+V)/10-1e4},Xs.prototype._unpackTerrarium=function(b,I,V){return 256*b+I+V/256-32768},Xs.prototype.getPixels=function(){return new Jo({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Xs.prototype.backfillBorder=function(b,I,V){if(this.dim!==b.dim)throw new Error("dem dimension mismatch");var re=I*this.dim,fe=I*this.dim+this.dim,ge=V*this.dim,Ae=V*this.dim+this.dim;switch(I){case-1:re=fe-1;break;case 1:fe=re+1}switch(V){case-1:ge=Ae-1;break;case 1:Ae=ge+1}for(var ze=-I*this.dim,Ze=-V*this.dim,st=ge;st<Ae;st++)for(var pt=re;pt<fe;pt++)this.data[this._idx(pt,st)]=b.data[this._idx(pt+ze,st+Ze)]},Yr("DEMData",Xs);var Rc=function(b){this._stringToNumber={},this._numberToString=[];for(var I=0;I<b.length;I++){var V=b[I];this._stringToNumber[V]=I,this._numberToString[I]=V}};Rc.prototype.encode=function(b){return this._stringToNumber[b]},Rc.prototype.decode=function(b){return this._numberToString[b]};var Fc=function(b,I,V,re,fe){this.type="Feature",this._vectorTileFeature=b,b._z=I,b._x=V,b._y=re,this.properties=b.properties,this.id=fe},Lu={geometry:{configurable:!0}};Lu.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Lu.geometry.set=function(b){this._geometry=b},Fc.prototype.toJSON=function(){var b={geometry:this.geometry};for(var I in this)I!=="_geometry"&&I!=="_vectorTileFeature"&&(b[I]=this[I]);return b},Object.defineProperties(Fc.prototype,Lu);var Fl=function(){this.state={},this.stateChanges={},this.deletedStates={}};Fl.prototype.updateState=function(b,I,V){var re=String(I);if(this.stateChanges[b]=this.stateChanges[b]||{},this.stateChanges[b][re]=this.stateChanges[b][re]||{},d(this.stateChanges[b][re],V),this.deletedStates[b]===null)for(var fe in this.deletedStates[b]={},this.state[b])fe!==re&&(this.deletedStates[b][fe]=null);else if(this.deletedStates[b]&&this.deletedStates[b][re]===null)for(var ge in this.deletedStates[b][re]={},this.state[b][re])V[ge]||(this.deletedStates[b][re][ge]=null);else for(var Ae in V)this.deletedStates[b]&&this.deletedStates[b][re]&&this.deletedStates[b][re][Ae]===null&&delete this.deletedStates[b][re][Ae]},Fl.prototype.removeFeatureState=function(b,I,V){if(this.deletedStates[b]!==null){var re=String(I);if(this.deletedStates[b]=this.deletedStates[b]||{},V&&I!==void 0)this.deletedStates[b][re]!==null&&(this.deletedStates[b][re]=this.deletedStates[b][re]||{},this.deletedStates[b][re][V]=null);else if(I!==void 0)if(this.stateChanges[b]&&this.stateChanges[b][re])for(V in this.deletedStates[b][re]={},this.stateChanges[b][re])this.deletedStates[b][re][V]=null;else this.deletedStates[b][re]=null;else this.deletedStates[b]=null}},Fl.prototype.getState=function(b,I){var V=String(I),re=this.state[b]||{},fe=this.stateChanges[b]||{},ge=d({},re[V],fe[V]);if(this.deletedStates[b]===null)return{};if(this.deletedStates[b]){var Ae=this.deletedStates[b][I];if(Ae===null)return{};for(var ze in Ae)delete ge[ze]}return ge},Fl.prototype.initializeTileState=function(b,I){b.setFeatureState(this.state,I)},Fl.prototype.coalesceChanges=function(b,I){var V={};for(var re in this.stateChanges){this.state[re]=this.state[re]||{};var fe={};for(var ge in this.stateChanges[re])this.state[re][ge]||(this.state[re][ge]={}),d(this.state[re][ge],this.stateChanges[re][ge]),fe[ge]=this.state[re][ge];V[re]=fe}for(var Ae in this.deletedStates){this.state[Ae]=this.state[Ae]||{};var ze={};if(this.deletedStates[Ae]===null)for(var Ze in this.state[Ae])ze[Ze]={},this.state[Ae][Ze]={};else for(var st in this.deletedStates[Ae]){if(this.deletedStates[Ae][st]===null)this.state[Ae][st]={};else for(var pt=0,Rt=Object.keys(this.deletedStates[Ae][st]);pt<Rt.length;pt+=1){var Gt=Rt[pt];delete this.state[Ae][st][Gt]}ze[st]=this.state[Ae][st]}V[Ae]=V[Ae]||{},d(V[Ae],ze)}if(this.stateChanges={},this.deletedStates={},Object.keys(V).length!==0)for(var Ut in b)b[Ut].setFeatureState(V,I)};var Zs=function(b,I){this.tileID=b,this.x=b.canonical.x,this.y=b.canonical.y,this.z=b.canonical.z,this.grid=new sn(8192,16,0),this.grid3D=new sn(8192,16,0),this.featureIndexArray=new Tt,this.promoteId=I};function Qf(b,I,V,re,fe){return A(b,function(ge,Ae){var ze=I instanceof ts?I.get(Ae):null;return ze&&ze.evaluate?ze.evaluate(V,re,fe):ze})}function $f(b){for(var I=1/0,V=1/0,re=-1/0,fe=-1/0,ge=0,Ae=b;ge<Ae.length;ge+=1){var ze=Ae[ge];I=Math.min(I,ze.x),V=Math.min(V,ze.y),re=Math.max(re,ze.x),fe=Math.max(fe,ze.y)}return{minX:I,minY:V,maxX:re,maxY:fe}}function bd(b,I){return I-b}Zs.prototype.insert=function(b,I,V,re,fe,ge){var Ae=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(V,re,fe);for(var ze=ge?this.grid3D:this.grid,Ze=0;Ze<I.length;Ze++){for(var st=I[Ze],pt=[1/0,1/0,-1/0,-1/0],Rt=0;Rt<st.length;Rt++){var Gt=st[Rt];pt[0]=Math.min(pt[0],Gt.x),pt[1]=Math.min(pt[1],Gt.y),pt[2]=Math.max(pt[2],Gt.x),pt[3]=Math.max(pt[3],Gt.y)}pt[0]<8192&&pt[1]<8192&&pt[2]>=0&&pt[3]>=0&&ze.insert(Ae,pt[0],pt[1],pt[2],pt[3])}},Zs.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Sl.VectorTile(new Ac(this.rawTileData)).layers,this.sourceLayerCoder=new Rc(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Zs.prototype.query=function(b,I,V,re){var fe=this;this.loadVTLayers();for(var ge=b.params||{},Ae=8192/b.tileSize/b.scale,ze=_a(ge.filter),Ze=b.queryGeometry,st=b.queryPadding*Ae,pt=$f(Ze),Rt=this.grid.query(pt.minX-st,pt.minY-st,pt.maxX+st,pt.maxY+st),Gt=$f(b.cameraQueryGeometry),Ut=this.grid3D.query(Gt.minX-st,Gt.minY-st,Gt.maxX+st,Gt.maxY+st,function(cn,vn,Fn,Dn){return function(Hn,ra,na,Xn,ua){for(var la=0,aa=Hn;la<aa.length;la+=1){var Xa=aa[la];if(ra<=Xa.x&&na<=Xa.y&&Xn>=Xa.x&&ua>=Xa.y)return!0}var Na=[new s(ra,na),new s(ra,ua),new s(Xn,ua),new s(Xn,na)];if(Hn.length>2){for(var Qa=0,xa=Na;Qa<xa.length;Qa+=1)if(ns(Hn,xa[Qa]))return!0}for(var Va=0;Va<Hn.length-1;Va++)if(dl(Hn[Va],Hn[Va+1],Na))return!0;return!1}(b.cameraQueryGeometry,cn-st,vn-st,Fn+st,Dn+st)}),rr=0,pr=Ut;rr<pr.length;rr+=1){var Sr=pr[rr];Rt.push(Sr)}Rt.sort(bd);for(var Mr,Dr={},Rr=function(cn){var vn=Rt[cn];if(vn!==Mr){Mr=vn;var Fn=fe.featureIndexArray.get(vn),Dn=null;fe.loadMatchingFeature(Dr,Fn.bucketIndex,Fn.sourceLayerIndex,Fn.featureIndex,ze,ge.layers,ge.availableImages,I,V,re,function(Hn,ra,na){return Dn||(Dn=pi(Hn)),ra.queryIntersectsFeature(Ze,Hn,na,Dn,fe.z,b.transform,Ae,b.pixelPosMatrix)})}},Ur=0;Ur<Rt.length;Ur++)Rr(Ur);return Dr},Zs.prototype.loadMatchingFeature=function(b,I,V,re,fe,ge,Ae,ze,Ze,st,pt){var Rt=this.bucketLayerIDs[I];if(!ge||function(Fn,Dn){for(var Hn=0;Hn<Fn.length;Hn++)if(Dn.indexOf(Fn[Hn])>=0)return!0;return!1}(ge,Rt)){var Gt=this.sourceLayerCoder.decode(V),Ut=this.vtLayers[Gt].feature(re);if(fe.filter(new ei(this.tileID.overscaledZ),Ut))for(var rr=this.getId(Ut,Gt),pr=0;pr<Rt.length;pr++){var Sr=Rt[pr];if(!(ge&&ge.indexOf(Sr)<0)){var Mr=ze[Sr];if(Mr){var Dr={};rr!==void 0&&st&&(Dr=st.getState(Mr.sourceLayer||"_geojsonTileLayer",rr));var Rr=Ze[Sr];Rr.paint=Qf(Rr.paint,Mr.paint,Ut,Dr,Ae),Rr.layout=Qf(Rr.layout,Mr.layout,Ut,Dr,Ae);var Ur=!pt||pt(Ut,Mr,Dr);if(Ur){var cn=new Fc(Ut,this.z,this.x,this.y,rr);cn.layer=Rr;var vn=b[Sr];vn===void 0&&(vn=b[Sr]=[]),vn.push({featureIndex:re,feature:cn,intersectionZ:Ur})}}}}}},Zs.prototype.lookupSymbolFeatures=function(b,I,V,re,fe,ge,Ae,ze){var Ze={};this.loadVTLayers();for(var st=_a(fe),pt=0,Rt=b;pt<Rt.length;pt+=1){var Gt=Rt[pt];this.loadMatchingFeature(Ze,V,re,Gt,st,ge,Ae,ze,I)}return Ze},Zs.prototype.hasLayer=function(b){for(var I=0,V=this.bucketLayerIDs;I<V.length;I+=1)for(var re=0,fe=V[I];re<fe.length;re+=1)if(b===fe[re])return!0;return!1},Zs.prototype.getId=function(b,I){var V=b.id;if(this.promoteId){var re=typeof this.promoteId=="string"?this.promoteId:this.promoteId[I];typeof(V=b.properties[re])=="boolean"&&(V=Number(V))}return V},Yr("FeatureIndex",Zs,{omit:["rawTileData","sourceLayerCoder"]});var yo=function(b,I){this.tileID=b,this.uid=y(),this.uses=0,this.tileSize=I,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};yo.prototype.registerFadeDuration=function(b){var I=b+this.timeAdded;I<B.now()||this.fadeEndTime&&I<this.fadeEndTime||(this.fadeEndTime=I)},yo.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},yo.prototype.loadVectorData=function(b,I,V){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",b){for(var re in b.featureIndex&&(this.latestFeatureIndex=b.featureIndex,b.rawTileData?(this.latestRawTileData=b.rawTileData,this.latestFeatureIndex.rawTileData=b.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=b.collisionBoxArray,this.buckets=function(st,pt){var Rt={};if(!pt)return Rt;for(var Gt=function(){var pr=rr[Ut],Sr=pr.layerIds.map(function(Ur){return pt.getLayer(Ur)}).filter(Boolean);if(Sr.length!==0){pr.layers=Sr,pr.stateDependentLayerIds&&(pr.stateDependentLayers=pr.stateDependentLayerIds.map(function(Ur){return Sr.filter(function(cn){return cn.id===Ur})[0]}));for(var Mr=0,Dr=Sr;Mr<Dr.length;Mr+=1){var Rr=Dr[Mr];Rt[Rr.id]=pr}}},Ut=0,rr=st;Ut<rr.length;Ut+=1)Gt();return Rt}(b.buckets,I.style),this.hasSymbolBuckets=!1,this.buckets){var fe=this.buckets[re];if(fe instanceof oi){if(this.hasSymbolBuckets=!0,!V)break;fe.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var ge in this.buckets){var Ae=this.buckets[ge];if(Ae instanceof oi&&Ae.hasRTLText){this.hasRTLText=!0,so.isLoading()||so.isLoaded()||Ui()!=="deferred"||$a();break}}for(var ze in this.queryPadding=0,this.buckets){var Ze=this.buckets[ze];this.queryPadding=Math.max(this.queryPadding,I.style.getLayer(ze).queryRadius(Ze))}b.imageAtlas&&(this.imageAtlas=b.imageAtlas),b.glyphAtlasImage&&(this.glyphAtlasImage=b.glyphAtlasImage)}else this.collisionBoxArray=new ye},yo.prototype.unloadVectorData=function(){for(var b in this.buckets)this.buckets[b].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},yo.prototype.getBucket=function(b){return this.buckets[b.id]},yo.prototype.upload=function(b){for(var I in this.buckets){var V=this.buckets[I];V.uploadPending()&&V.upload(b)}var re=b.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new yl(b,this.imageAtlas.image,re.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new yl(b,this.glyphAtlasImage,re.ALPHA),this.glyphAtlasImage=null)},yo.prototype.prepare=function(b){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(b,this.imageAtlasTexture)},yo.prototype.queryRenderedFeatures=function(b,I,V,re,fe,ge,Ae,ze,Ze,st){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:re,cameraQueryGeometry:fe,scale:ge,tileSize:this.tileSize,pixelPosMatrix:st,transform:ze,params:Ae,queryPadding:this.queryPadding*Ze},b,I,V):{}},yo.prototype.querySourceFeatures=function(b,I){var V=this.latestFeatureIndex;if(V&&V.rawTileData){var re=V.loadVTLayers(),fe=I?I.sourceLayer:"",ge=re._geojsonTileLayer||re[fe];if(ge)for(var Ae=_a(I&&I.filter),ze=this.tileID.canonical,Ze=ze.z,st=ze.x,pt=ze.y,Rt={z:Ze,x:st,y:pt},Gt=0;Gt<ge.length;Gt++){var Ut=ge.feature(Gt);if(Ae.filter(new ei(this.tileID.overscaledZ),Ut)){var rr=V.getId(Ut,fe),pr=new Fc(Ut,Ze,st,pt,rr);pr.tile=Rt,b.push(pr)}}}},yo.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},yo.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},yo.prototype.setExpiryData=function(b){var I=this.expirationTime;if(b.cacheControl){var V=O(b.cacheControl);V["max-age"]&&(this.expirationTime=Date.now()+1e3*V["max-age"])}else b.expires&&(this.expirationTime=new Date(b.expires).getTime());if(this.expirationTime){var re=Date.now(),fe=!1;if(this.expirationTime>re)fe=!1;else if(I)if(this.expirationTime<I)fe=!0;else{var ge=this.expirationTime-I;ge?this.expirationTime=re+Math.max(ge,3e4):fe=!0}else fe=!0;fe?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},yo.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},yo.prototype.setFeatureState=function(b,I){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(b).length!==0){var V=this.latestFeatureIndex.loadVTLayers();for(var re in this.buckets)if(I.style.hasLayer(re)){var fe=this.buckets[re],ge=fe.layers[0].sourceLayer||"_geojsonTileLayer",Ae=V[ge],ze=b[ge];if(Ae&&ze&&Object.keys(ze).length!==0){fe.update(ze,Ae,this.imageAtlas&&this.imageAtlas.patternPositions||{});var Ze=I&&I.style&&I.style.getLayer(re);Ze&&(this.queryPadding=Math.max(this.queryPadding,Ze.queryRadius(fe)))}}}},yo.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},yo.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<B.now()},yo.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},yo.prototype.setHoldDuration=function(b){this.symbolFadeHoldUntil=B.now()+b},yo.prototype.setDependencies=function(b,I){for(var V={},re=0,fe=I;re<fe.length;re+=1)V[fe[re]]=!0;this.dependencies[b]=V},yo.prototype.hasDependency=function(b,I){for(var V=0,re=b;V<re.length;V+=1){var fe=re[V],ge=this.dependencies[fe];if(ge){for(var Ae=0,ze=I;Ae<ze.length;Ae+=1)if(ge[ze[Ae]])return!0}}return!1};var il=self.performance,eh=function(b){this._marks={start:[b.url,"start"].join("#"),end:[b.url,"end"].join("#"),measure:b.url.toString()},il.mark(this._marks.start)};eh.prototype.finish=function(){il.mark(this._marks.end);var b=il.getEntriesByName(this._marks.measure);return b.length===0&&(il.measure(this._marks.measure,this._marks.start,this._marks.end),b=il.getEntriesByName(this._marks.measure),il.clearMarks(this._marks.start),il.clearMarks(this._marks.end),il.clearMeasures(this._marks.measure)),b},e.Actor=Rl,e.AlphaImage=vl,e.CanonicalTileID=bl,e.CollisionBoxArray=ye,e.Color=sr,e.DEMData=Xs,e.DataConstantProperty=oa,e.DictionaryCoder=Rc,e.EXTENT=8192,e.ErrorEvent=Le,e.EvaluationParameters=ei,e.Event=_e,e.Evented=Ce,e.FeatureIndex=Zs,e.FillBucket=Cs,e.FillExtrusionBucket=Ps,e.ImageAtlas=oc,e.ImagePosition=Sc,e.LineBucket=Ko,e.LngLat=ki,e.LngLatBounds=ro,e.MercatorCoordinate=xl,e.ONE_EM=24,e.OverscaledTileID=no,e.Point=s,e.Point$1=s,e.Properties=Eo,e.Protobuf=Ac,e.RGBAImage=Jo,e.RequestManager=ae,e.RequestPerformance=eh,e.ResourceType=lt,e.SegmentVector=Dt,e.SourceFeatureState=Fl,e.StructArrayLayout1ui2=U,e.StructArrayLayout2f1f2i16=tl,e.StructArrayLayout2i4=ss,e.StructArrayLayout3ui6=eo,e.StructArrayLayout4i8=Ei,e.SymbolBucket=oi,e.Texture=yl,e.Tile=yo,e.Transitionable=es,e.Uniform1f=Nr,e.Uniform1i=sa,e.Uniform2f=wn,e.Uniform3f=Wn,e.Uniform4f=Vn,e.UniformColor=$n,e.UniformMatrix4f=Ta,e.UnwrappedTileID=Kf,e.ValidationError=Xe,e.WritingMode=cs,e.ZoomHistory=Ma,e.add=function(b,I,V){return b[0]=I[0]+V[0],b[1]=I[1]+V[1],b[2]=I[2]+V[2],b},e.addDynamicAttributes=Au,e.asyncAll=function(b,I,V){if(!b.length)return V(null,[]);var re=b.length,fe=new Array(b.length),ge=null;b.forEach(function(Ae,ze){I(Ae,function(Ze,st){Ze&&(ge=Ze),fe[ze]=st,--re==0&&V(ge,fe)})})},e.bezier=a,e.bindAll=x,e.browser=B,e.cacheEntryPossiblyAdded=function(b){++Qe>Ye&&(b.getActor().send("enforceCacheSizeLimit",Fe),Qe=0)},e.clamp=r,e.clearTileCache=function(b){var I=self.caches.delete("mapbox-tiles");b&&I.catch(b).then(function(){return b()})},e.clipLine=Df,e.clone=function(b){var I=new Zo(16);return I[0]=b[0],I[1]=b[1],I[2]=b[2],I[3]=b[3],I[4]=b[4],I[5]=b[5],I[6]=b[6],I[7]=b[7],I[8]=b[8],I[9]=b[9],I[10]=b[10],I[11]=b[11],I[12]=b[12],I[13]=b[13],I[14]=b[14],I[15]=b[15],I},e.clone$1=w,e.clone$2=function(b){var I=new Zo(3);return I[0]=b[0],I[1]=b[1],I[2]=b[2],I},e.collisionCircleLayout=jp,e.config=q,e.create=function(){var b=new Zo(16);return Zo!=Float32Array&&(b[1]=0,b[2]=0,b[3]=0,b[4]=0,b[6]=0,b[7]=0,b[8]=0,b[9]=0,b[11]=0,b[12]=0,b[13]=0,b[14]=0),b[0]=1,b[5]=1,b[10]=1,b[15]=1,b},e.create$1=function(){var b=new Zo(9);return Zo!=Float32Array&&(b[1]=0,b[2]=0,b[3]=0,b[5]=0,b[6]=0,b[7]=0),b[0]=1,b[4]=1,b[8]=1,b},e.create$2=function(){var b=new Zo(4);return Zo!=Float32Array&&(b[1]=0,b[2]=0),b[0]=1,b[3]=1,b},e.createCommonjsModule=f,e.createExpression=qt,e.createLayout=ti,e.createStyleLayer=function(b){return b.type==="custom"?new yd(b):new xd[b.type](b)},e.cross=function(b,I,V){var re=I[0],fe=I[1],ge=I[2],Ae=V[0],ze=V[1],Ze=V[2];return b[0]=fe*Ze-ge*ze,b[1]=ge*Ae-re*Ze,b[2]=re*ze-fe*Ae,b},e.deepEqual=function b(I,V){if(Array.isArray(I)){if(!Array.isArray(V)||I.length!==V.length)return!1;for(var re=0;re<I.length;re++)if(!b(I[re],V[re]))return!1;return!0}if(typeof I=="object"&&I!==null&&V!==null){if(typeof V!="object"||Object.keys(I).length!==Object.keys(V).length)return!1;for(var fe in I)if(!b(I[fe],V[fe]))return!1;return!0}return I===V},e.dot=function(b,I){return b[0]*I[0]+b[1]*I[1]+b[2]*I[2]},e.dot$1=function(b,I){return b[0]*I[0]+b[1]*I[1]+b[2]*I[2]+b[3]*I[3]},e.ease=c,e.emitValidationErrors=bn,e.endsWith=T,e.enforceCacheSizeLimit=function(b){et(),xe&&xe.then(function(I){I.keys().then(function(V){for(var re=0;re<V.length-b;re++)I.delete(V[re])})})},e.evaluateSizeForFeature=Lf,e.evaluateSizeForZoom=Cf,e.evaluateVariableOffset=Bf,e.evented=_i,e.extend=d,e.featureFilter=_a,e.filterObject=S,e.fromRotation=function(b,I){var V=Math.sin(I),re=Math.cos(I);return b[0]=re,b[1]=V,b[2]=0,b[3]=-V,b[4]=re,b[5]=0,b[6]=0,b[7]=0,b[8]=1,b},e.getAnchorAlignment=_u,e.getAnchorJustification=ku,e.getArrayBuffer=xt,e.getImage=He,e.getJSON=function(b,I){return $e(d(b,{type:"json"}),I)},e.getRTLTextPluginStatus=Ui,e.getReferrer=wt,e.getVideo=function(b,I){var V,re,fe=self.document.createElement("video");fe.muted=!0,fe.onloadstart=function(){I(null,fe)};for(var ge=0;ge<b.length;ge++){var Ae=self.document.createElement("source");V=b[ge],re=void 0,(re=self.document.createElement("a")).href=V,(re.protocol!==self.document.location.protocol||re.host!==self.document.location.host)&&(fe.crossOrigin="Anonymous"),Ae.src=b[ge],fe.appendChild(Ae)}return{cancel:function(){}}},e.identity=Jl,e.invert=function(b,I){var V=I[0],re=I[1],fe=I[2],ge=I[3],Ae=I[4],ze=I[5],Ze=I[6],st=I[7],pt=I[8],Rt=I[9],Gt=I[10],Ut=I[11],rr=I[12],pr=I[13],Sr=I[14],Mr=I[15],Dr=V*ze-re*Ae,Rr=V*Ze-fe*Ae,Ur=V*st-ge*Ae,cn=re*Ze-fe*ze,vn=re*st-ge*ze,Fn=fe*st-ge*Ze,Dn=pt*pr-Rt*rr,Hn=pt*Sr-Gt*rr,ra=pt*Mr-Ut*rr,na=Rt*Sr-Gt*pr,Xn=Rt*Mr-Ut*pr,ua=Gt*Mr-Ut*Sr,la=Dr*ua-Rr*Xn+Ur*na+cn*ra-vn*Hn+Fn*Dn;return la?(la=1/la,b[0]=(ze*ua-Ze*Xn+st*na)*la,b[1]=(fe*Xn-re*ua-ge*na)*la,b[2]=(pr*Fn-Sr*vn+Mr*cn)*la,b[3]=(Gt*vn-Rt*Fn-Ut*cn)*la,b[4]=(Ze*ra-Ae*ua-st*Hn)*la,b[5]=(V*ua-fe*ra+ge*Hn)*la,b[6]=(Sr*Ur-rr*Fn-Mr*Rr)*la,b[7]=(pt*Fn-Gt*Ur+Ut*Rr)*la,b[8]=(Ae*Xn-ze*ra+st*Dn)*la,b[9]=(re*ra-V*Xn-ge*Dn)*la,b[10]=(rr*vn-pr*Ur+Mr*Dr)*la,b[11]=(Rt*Ur-pt*vn-Ut*Dr)*la,b[12]=(ze*Hn-Ae*na-Ze*Dn)*la,b[13]=(V*na-re*Hn+fe*Dn)*la,b[14]=(pr*Rr-rr*cn-Sr*Dr)*la,b[15]=(pt*cn-Rt*Rr+Gt*Dr)*la,b):null},e.isChar=kn,e.isMapboxURL=he,e.keysDifference=function(b,I){var V=[];for(var re in b)re in I||V.push(re);return V},e.makeRequest=$e,e.mapObject=A,e.mercatorXfromLng=Xf,e.mercatorYfromLat=Zf,e.mercatorZfromAltitude=Jf,e.mul=su,e.multiply=ml,e.mvt=Sl,e.normalize=function(b,I){var V=I[0],re=I[1],fe=I[2],ge=V*V+re*re+fe*fe;return ge>0&&(ge=1/Math.sqrt(ge)),b[0]=I[0]*ge,b[1]=I[1]*ge,b[2]=I[2]*ge,b},e.number=qn,e.offscreenCanvasSupported=it,e.ortho=function(b,I,V,re,fe,ge,Ae){var ze=1/(I-V),Ze=1/(re-fe),st=1/(ge-Ae);return b[0]=-2*ze,b[1]=0,b[2]=0,b[3]=0,b[4]=0,b[5]=-2*Ze,b[6]=0,b[7]=0,b[8]=0,b[9]=0,b[10]=2*st,b[11]=0,b[12]=(I+V)*ze,b[13]=(fe+re)*Ze,b[14]=(Ae+ge)*st,b[15]=1,b},e.parseGlyphPBF=function(b){return new Ac(b).readFields(Kp,[])},e.pbf=Ac,e.performSymbolLayout=function(b,I,V,re,fe,ge,Ae){b.createArrays();var ze=512*b.overscaling;b.tilePixelRatio=8192/ze,b.compareText={},b.iconsNeedLinear=!1;var Ze=b.layers[0].layout,st=b.layers[0]._unevaluatedLayout._values,pt={};if(b.textSizeData.kind==="composite"){var Rt=b.textSizeData,Gt=Rt.minZoom,Ut=Rt.maxZoom;pt.compositeTextSizes=[st["text-size"].possiblyEvaluate(new ei(Gt),Ae),st["text-size"].possiblyEvaluate(new ei(Ut),Ae)]}if(b.iconSizeData.kind==="composite"){var rr=b.iconSizeData,pr=rr.minZoom,Sr=rr.maxZoom;pt.compositeIconSizes=[st["icon-size"].possiblyEvaluate(new ei(pr),Ae),st["icon-size"].possiblyEvaluate(new ei(Sr),Ae)]}pt.layoutTextSize=st["text-size"].possiblyEvaluate(new ei(b.zoom+1),Ae),pt.layoutIconSize=st["icon-size"].possiblyEvaluate(new ei(b.zoom+1),Ae),pt.textMaxSize=st["text-size"].possiblyEvaluate(new ei(18));for(var Mr=24*Ze.get("text-line-height"),Dr=Ze.get("text-rotation-alignment")==="map"&&Ze.get("symbol-placement")!=="point",Rr=Ze.get("text-keep-upright"),Ur=Ze.get("text-size"),cn=function(){var Dn=Fn[vn],Hn=Ze.get("text-font").evaluate(Dn,{},Ae).join(","),ra=Ur.evaluate(Dn,{},Ae),na=pt.layoutTextSize.evaluate(Dn,{},Ae),Xn=pt.layoutIconSize.evaluate(Dn,{},Ae),ua={horizontal:{},vertical:void 0},la=Dn.text,aa=[0,0];if(la){var Xa=la.toString(),Na=24*Ze.get("text-letter-spacing").evaluate(Dn,{},Ae),Qa=function(za){for(var Ja=0,Bi=za;Ja<Bi.length;Ja+=1)if(!ka(Bi[Ja].charCodeAt(0)))return!1;return!0}(Xa)?Na:0,xa=Ze.get("text-anchor").evaluate(Dn,{},Ae),Va=Ze.get("text-variable-anchor");if(!Va){var mi=Ze.get("text-radial-offset").evaluate(Dn,{},Ae);aa=mi?Bf(xa,[24*mi,Tu]):Ze.get("text-offset").evaluate(Dn,{},Ae).map(function(za){return 24*za})}var ci=Dr?"center":Ze.get("text-justify").evaluate(Dn,{},Ae),Ai=Ze.get("symbol-placement"),ui=Ai==="point"?24*Ze.get("text-max-width").evaluate(Dn,{},Ae):0,ao=function(){b.allowVerticalPlacement&&Ia(Xa)&&(ua.vertical=Ec(la,I,V,fe,Hn,ui,Mr,xa,"left",Qa,aa,cs.vertical,!0,Ai,na,ra))};if(!Dr&&Va){for(var Mi=ci==="auto"?Va.map(function(za){return ku(za)}):[ci],Po=!1,xo=0;xo<Mi.length;xo++){var wo=Mi[xo];if(!ua.horizontal[wo])if(Po)ua.horizontal[wo]=ua.horizontal[0];else{var Go=Ec(la,I,V,fe,Hn,ui,Mr,"center",wo,Qa,aa,cs.horizontal,!1,Ai,na,ra);Go&&(ua.horizontal[wo]=Go,Po=Go.positionedLines.length===1)}}ao()}else{ci==="auto"&&(ci=ku(xa));var Do=Ec(la,I,V,fe,Hn,ui,Mr,xa,ci,Qa,aa,cs.horizontal,!1,Ai,na,ra);Do&&(ua.horizontal[ci]=Do),ao(),Ia(Xa)&&Dr&&Rr&&(ua.vertical=Ec(la,I,V,fe,Hn,ui,Mr,xa,ci,Qa,aa,cs.vertical,!1,Ai,na,ra))}}var io=void 0,To=!1;if(Dn.icon&&Dn.icon.name){var Yi=re[Dn.icon.name];Yi&&(io=function(za,Ja,Bi){var Ni=_u(Bi),zi=Ni.horizontalAlign,Si=Ni.verticalAlign,ri=Ja[0],ji=Ja[1],Yo=ri-za.displaySize[0]*zi,is=Yo+za.displaySize[0],Ro=ji-za.displaySize[1]*Si;return{image:za,top:Ro,bottom:Ro+za.displaySize[1],left:Yo,right:is}}(fe[Dn.icon.name],Ze.get("icon-offset").evaluate(Dn,{},Ae),Ze.get("icon-anchor").evaluate(Dn,{},Ae)),To=Yi.sdf,b.sdfIcons===void 0?b.sdfIcons=Yi.sdf:b.sdfIcons!==Yi.sdf&&k("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Yi.pixelRatio!==b.pixelRatio||Ze.get("icon-rotate").constantOr(1)!==0)&&(b.iconsNeedLinear=!0))}var lo=jf(ua.horizontal)||ua.vertical;b.iconsInText=!!lo&&lo.iconsInText,(lo||io)&&function(za,Ja,Bi,Ni,zi,Si,ri,ji,Yo,is,Ro){var Is=Si.textMaxSize.evaluate(Ja,{});Is===void 0&&(Is=ri);var Js,bo=za.layers[0].layout,Os=bo.get("icon-offset").evaluate(Ja,{},Ro),zs=jf(Bi.horizontal),Ds=ri/24,Cu=za.tilePixelRatio*Ds,Bl=za.tilePixelRatio*Is/24,Bc=za.tilePixelRatio*ji,_l=za.tilePixelRatio*bo.get("symbol-spacing"),Nc=bo.get("text-padding")*za.tilePixelRatio,jc=bo.get("icon-padding")*za.tilePixelRatio,Uc=bo.get("text-max-angle")/180*Math.PI,Vc=bo.get("text-rotation-alignment")==="map"&&bo.get("symbol-placement")!=="point",ol=bo.get("icon-rotation-alignment")==="map"&&bo.get("symbol-placement")!=="point",Nl=bo.get("symbol-placement"),Hc=_l/2,jl=bo.get("icon-text-fit");Ni&&jl!=="none"&&(za.allowVerticalPlacement&&Bi.vertical&&(Js=Ef(Ni,Bi.vertical,jl,bo.get("icon-text-fit-padding"),Os,Ds)),zs&&(Ni=Ef(Ni,zs,jl,bo.get("icon-text-fit-padding"),Os,Ds)));var sl=function(wd,dc){dc.x<0||dc.x>=8192||dc.y<0||dc.y>=8192||function(Hi,Rs,Td,ll,Du,ah,Kc,Vs,Qc,mc,$c,eu,Ru,ih,gc,oh,sh,lh,ch,uh,us,tu,fh,Hs,kd){var Fu,wl,Yl,Wl,Xl,Zl=Hi.addToLineVertexArray(Rs,Td),hh=0,ph=0,dh=0,mh=0,Bu=-1,Nu=-1,Ks={},gh=Tr(""),ju=0,Uu=0;if(Vs._unevaluatedLayout.getValue("text-radial-offset")===void 0?(Fu=Vs.layout.get("text-offset").evaluate(us,{},Hs).map(function(yc){return 24*yc}),ju=Fu[0],Uu=Fu[1]):(ju=24*Vs.layout.get("text-radial-offset").evaluate(us,{},Hs),Uu=Tu),Hi.allowVerticalPlacement&&ll.vertical){var vh=Vs.layout.get("text-rotate").evaluate(us,{},Hs)+90,Ad=ll.vertical;Wl=new Oc(Qc,Rs,mc,$c,eu,Ad,Ru,ih,gc,vh),Kc&&(Xl=new Oc(Qc,Rs,mc,$c,eu,Kc,sh,lh,gc,vh))}if(Du){var Vu=Vs.layout.get("icon-rotate").evaluate(us,{}),yh=Vs.layout.get("icon-text-fit")!=="none",xh=Rf(Du,Vu,fh,yh),Hu=Kc?Rf(Kc,Vu,fh,yh):void 0;Yl=new Oc(Qc,Rs,mc,$c,eu,Du,sh,lh,!1,Vu),hh=4*xh.length;var bh=Hi.iconSizeData,vc=null;bh.kind==="source"?(vc=[128*Vs.layout.get("icon-size").evaluate(us,{})])[0]>32640&&k(Hi.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):bh.kind==="composite"&&((vc=[128*tu.compositeIconSizes[0].evaluate(us,{},Hs),128*tu.compositeIconSizes[1].evaluate(us,{},Hs)])[0]>32640||vc[1]>32640)&&k(Hi.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),Hi.addSymbols(Hi.icon,xh,vc,uh,ch,us,!1,Rs,Zl.lineStartIndex,Zl.lineLength,-1,Hs),Bu=Hi.icon.placedSymbolArray.length-1,Hu&&(ph=4*Hu.length,Hi.addSymbols(Hi.icon,Hu,vc,uh,ch,us,cs.vertical,Rs,Zl.lineStartIndex,Zl.lineLength,-1,Hs),Nu=Hi.icon.placedSymbolArray.length-1)}for(var _h in ll.horizontal){var ru=ll.horizontal[_h];if(!wl){gh=Tr(ru.text);var Md=Vs.layout.get("text-rotate").evaluate(us,{},Hs);wl=new Oc(Qc,Rs,mc,$c,eu,ru,Ru,ih,gc,Md)}var wh=ru.positionedLines.length===1;if(dh+=Nf(Hi,Rs,ru,ah,Vs,gc,us,oh,Zl,ll.vertical?cs.horizontal:cs.horizontalOnly,wh?Object.keys(ll.horizontal):[_h],Ks,Bu,tu,Hs),wh)break}ll.vertical&&(mh+=Nf(Hi,Rs,ll.vertical,ah,Vs,gc,us,oh,Zl,cs.vertical,["vertical"],Ks,Nu,tu,Hs));var Sd=wl?wl.boxStartIndex:Hi.collisionBoxArray.length,Ed=wl?wl.boxEndIndex:Hi.collisionBoxArray.length,Ld=Wl?Wl.boxStartIndex:Hi.collisionBoxArray.length,Cd=Wl?Wl.boxEndIndex:Hi.collisionBoxArray.length,Pd=Yl?Yl.boxStartIndex:Hi.collisionBoxArray.length,Id=Yl?Yl.boxEndIndex:Hi.collisionBoxArray.length,Od=Xl?Xl.boxStartIndex:Hi.collisionBoxArray.length,zd=Xl?Xl.boxEndIndex:Hi.collisionBoxArray.length,qs=-1,nu=function(yc,kh){return yc&&yc.circleDiameter?Math.max(yc.circleDiameter,kh):kh};qs=nu(wl,qs),qs=nu(Wl,qs),qs=nu(Yl,qs);var Th=(qs=nu(Xl,qs))>-1?1:0;Th&&(qs*=kd/24),Hi.glyphOffsetArray.length>=oi.MAX_GLYPHS&&k("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),us.sortKey!==void 0&&Hi.addToSortKeyRanges(Hi.symbolInstances.length,us.sortKey),Hi.symbolInstances.emplaceBack(Rs.x,Rs.y,Ks.right>=0?Ks.right:-1,Ks.center>=0?Ks.center:-1,Ks.left>=0?Ks.left:-1,Ks.vertical||-1,Bu,Nu,gh,Sd,Ed,Ld,Cd,Pd,Id,Od,zd,mc,dh,mh,hh,ph,Th,0,Ru,ju,Uu,qs)}(za,dc,wd,Bi,Ni,zi,Js,za.layers[0],za.collisionBoxArray,Ja.index,Ja.sourceLayerIndex,za.index,Cu,Nc,Vc,Yo,Bc,jc,ol,Os,Ja,Si,is,Ro,ri)};if(Nl==="line")for(var cc=0,qc=Df(Ja.geometry,0,0,8192,8192);cc<qc.length;cc+=1)for(var Gc=qc[cc],Yc=ad(Gc,_l,Uc,Bi.vertical||zs,Ni,24,Bl,za.overscaling,8192),uc=0,Wc=Yc;uc<Wc.length;uc+=1){var fc=Wc[uc],Xc=zs;Xc&&ld(za,Xc.text,Hc,fc)||sl(Gc,fc)}else if(Nl==="line-center")for(var hc=0,Zc=Ja.geometry;hc<Zc.length;hc+=1){var Ul=Zc[hc];if(Ul.length>1){var Vl=nd(Ul,Uc,Bi.vertical||zs,Ni,24,Bl);Vl&&sl(Ul,Vl)}}else if(Ja.type==="Polygon")for(var Hl=0,Jc=mu(Ja.geometry,0);Hl<Jc.length;Hl+=1){var ql=Jc[Hl],pc=od(ql,16);sl(ql[0],new Pl(pc.x,pc.y,0))}else if(Ja.type==="LineString")for(var Gl=0,th=Ja.geometry;Gl<th.length;Gl+=1){var Pu=th[Gl];sl(Pu,new Pl(Pu[0].x,Pu[0].y,0))}else if(Ja.type==="Point")for(var Iu=0,rh=Ja.geometry;Iu<rh.length;Iu+=1)for(var _d=rh[Iu],Ou=0,nh=_d;Ou<nh.length;Ou+=1){var zu=nh[Ou];sl([zu],new Pl(zu.x,zu.y,0))}}(b,Dn,ua,io,re,pt,na,Xn,aa,To,Ae)},vn=0,Fn=b.features;vn<Fn.length;vn+=1)cn();ge&&b.generateCollisionDebugBuffers()},e.perspective=function(b,I,V,re,fe){var ge,Ae=1/Math.tan(I/2);return b[0]=Ae/V,b[1]=0,b[2]=0,b[3]=0,b[4]=0,b[5]=Ae,b[6]=0,b[7]=0,b[8]=0,b[9]=0,b[11]=-1,b[12]=0,b[13]=0,b[15]=0,fe!=null&&fe!==1/0?(ge=1/(re-fe),b[10]=(fe+re)*ge,b[14]=2*fe*re*ge):(b[10]=-1,b[14]=-2*re),b},e.pick=function(b,I){for(var V={},re=0;re<I.length;re++){var fe=I[re];fe in b&&(V[fe]=b[fe])}return V},e.plugin=so,e.polygonIntersectsPolygon=Oo,e.postMapLoadEvent=De,e.postTurnstileEvent=Me,e.potpack=kf,e.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],e.register=Yr,e.registerForPluginStateChange=function(b){return b({pluginStatus:ma,pluginURL:hi}),_i.on("pluginStateChange",b),b},e.rotate=function(b,I,V){var re=I[0],fe=I[1],ge=I[2],Ae=I[3],ze=Math.sin(V),Ze=Math.cos(V);return b[0]=re*Ze+ge*ze,b[1]=fe*Ze+Ae*ze,b[2]=re*-ze+ge*Ze,b[3]=fe*-ze+Ae*Ze,b},e.rotateX=function(b,I,V){var re=Math.sin(V),fe=Math.cos(V),ge=I[4],Ae=I[5],ze=I[6],Ze=I[7],st=I[8],pt=I[9],Rt=I[10],Gt=I[11];return I!==b&&(b[0]=I[0],b[1]=I[1],b[2]=I[2],b[3]=I[3],b[12]=I[12],b[13]=I[13],b[14]=I[14],b[15]=I[15]),b[4]=ge*fe+st*re,b[5]=Ae*fe+pt*re,b[6]=ze*fe+Rt*re,b[7]=Ze*fe+Gt*re,b[8]=st*fe-ge*re,b[9]=pt*fe-Ae*re,b[10]=Rt*fe-ze*re,b[11]=Gt*fe-Ze*re,b},e.rotateZ=function(b,I,V){var re=Math.sin(V),fe=Math.cos(V),ge=I[0],Ae=I[1],ze=I[2],Ze=I[3],st=I[4],pt=I[5],Rt=I[6],Gt=I[7];return I!==b&&(b[8]=I[8],b[9]=I[9],b[10]=I[10],b[11]=I[11],b[12]=I[12],b[13]=I[13],b[14]=I[14],b[15]=I[15]),b[0]=ge*fe+st*re,b[1]=Ae*fe+pt*re,b[2]=ze*fe+Rt*re,b[3]=Ze*fe+Gt*re,b[4]=st*fe-ge*re,b[5]=pt*fe-Ae*re,b[6]=Rt*fe-ze*re,b[7]=Gt*fe-Ze*re,b},e.scale=function(b,I,V){var re=V[0],fe=V[1],ge=V[2];return b[0]=I[0]*re,b[1]=I[1]*re,b[2]=I[2]*re,b[3]=I[3]*re,b[4]=I[4]*fe,b[5]=I[5]*fe,b[6]=I[6]*fe,b[7]=I[7]*fe,b[8]=I[8]*ge,b[9]=I[9]*ge,b[10]=I[10]*ge,b[11]=I[11]*ge,b[12]=I[12],b[13]=I[13],b[14]=I[14],b[15]=I[15],b},e.scale$1=function(b,I,V){return b[0]=I[0]*V,b[1]=I[1]*V,b[2]=I[2]*V,b[3]=I[3]*V,b},e.scale$2=function(b,I,V){return b[0]=I[0]*V,b[1]=I[1]*V,b[2]=I[2]*V,b},e.setCacheLimits=function(b,I){Fe=b,Ye=I},e.setRTLTextPlugin=function(b,I,V){if(V===void 0&&(V=!1),ma===Ga||ma===Fi||ma===Xo)throw new Error("setRTLTextPlugin cannot be called multiple times.");hi=B.resolveURL(b),ma=Ga,po=I,Ya(),V||$a()},e.sphericalToCartesian=function(b){var I=b[0],V=b[1],re=b[2];return V+=90,V*=Math.PI/180,re*=Math.PI/180,{x:I*Math.cos(V)*Math.sin(re),y:I*Math.sin(V)*Math.sin(re),z:I*Math.cos(re)}},e.sqrLen=Kl,e.styleSpec=Pe,e.sub=lu,e.symbolSize=rd,e.transformMat3=function(b,I,V){var re=I[0],fe=I[1],ge=I[2];return b[0]=re*V[0]+fe*V[3]+ge*V[6],b[1]=re*V[1]+fe*V[4]+ge*V[7],b[2]=re*V[2]+fe*V[5]+ge*V[8],b},e.transformMat4=kl,e.translate=function(b,I,V){var re,fe,ge,Ae,ze,Ze,st,pt,Rt,Gt,Ut,rr,pr=V[0],Sr=V[1],Mr=V[2];return I===b?(b[12]=I[0]*pr+I[4]*Sr+I[8]*Mr+I[12],b[13]=I[1]*pr+I[5]*Sr+I[9]*Mr+I[13],b[14]=I[2]*pr+I[6]*Sr+I[10]*Mr+I[14],b[15]=I[3]*pr+I[7]*Sr+I[11]*Mr+I[15]):(re=I[0],fe=I[1],ge=I[2],Ae=I[3],ze=I[4],Ze=I[5],st=I[6],pt=I[7],Rt=I[8],Gt=I[9],Ut=I[10],rr=I[11],b[0]=re,b[1]=fe,b[2]=ge,b[3]=Ae,b[4]=ze,b[5]=Ze,b[6]=st,b[7]=pt,b[8]=Rt,b[9]=Gt,b[10]=Ut,b[11]=rr,b[12]=re*pr+ze*Sr+Rt*Mr+I[12],b[13]=fe*pr+Ze*Sr+Gt*Mr+I[13],b[14]=ge*pr+st*Sr+Ut*Mr+I[14],b[15]=Ae*pr+pt*Sr+rr*Mr+I[15]),b},e.triggerPluginCompletionEvent=mo,e.uniqueId=y,e.validateCustomStyleLayer=function(b){var I=[],V=b.id;return V===void 0&&I.push({message:"layers."+V+': missing required property "id"'}),b.render===void 0&&I.push({message:"layers."+V+': missing required method "render"'}),b.renderingMode&&b.renderingMode!=="2d"&&b.renderingMode!=="3d"&&I.push({message:"layers."+V+': property "renderingMode" must be either "2d" or "3d"'}),I},e.validateLight=on,e.validateStyle=qr,e.values=function(b){var I=[];for(var V in b)I.push(b[V]);return I},e.vectorTile=Sl,e.version="1.10.1",e.warnOnce=k,e.webpSupported=ee,e.window=self,e.wrap=n}),p(0,function(e){function f(_e){var Le=typeof _e;if(Le==="number"||Le==="boolean"||Le==="string"||_e==null)return JSON.stringify(_e);if(Array.isArray(_e)){for(var Ce="[",Pe=0,Xe=_e;Pe<Xe.length;Pe+=1)Ce+=f(Xe[Pe])+",";return Ce+"]"}for(var ut=Object.keys(_e).sort(),kt="{",ft=0;ft<ut.length;ft++)kt+=JSON.stringify(ut[ft])+":"+f(_e[ut[ft]])+",";return kt+"}"}function u(_e){for(var Le="",Ce=0,Pe=e.refProperties;Ce<Pe.length;Ce+=1)Le+="/"+f(_e[Pe[Ce]]);return Le}var i=function(_e){this.keyCache={},_e&&this.replace(_e)};i.prototype.replace=function(_e){this._layerConfigs={},this._layers={},this.update(_e,[])},i.prototype.update=function(_e,Le){for(var Ce=this,Pe=0,Xe=_e;Pe<Xe.length;Pe+=1){var ut=Xe[Pe];this._layerConfigs[ut.id]=ut;var kt=this._layers[ut.id]=e.createStyleLayer(ut);kt._featureFilter=e.featureFilter(kt.filter),this.keyCache[ut.id]&&delete this.keyCache[ut.id]}for(var ft=0,Et=Le;ft<Et.length;ft+=1){var mt=Et[ft];delete this.keyCache[mt],delete this._layerConfigs[mt],delete this._layers[mt]}this.familiesBySource={};for(var It=0,vt=function(ot,bt){for(var Pt={},Vt=0;Vt<ot.length;Vt++){var nr=bt&&bt[ot[Vt].id]||u(ot[Vt]);bt&&(bt[ot[Vt].id]=nr);var Yt=Pt[nr];Yt||(Yt=Pt[nr]=[]),Yt.push(ot[Vt])}var Xt=[];for(var ar in Pt)Xt.push(Pt[ar]);return Xt}(e.values(this._layerConfigs),this.keyCache);It<vt.length;It+=1){var nt=vt[It].map(function(ot){return Ce._layers[ot.id]}),At=nt[0];if(At.visibility!=="none"){var Ft=At.source||"",Nt=this.familiesBySource[Ft];Nt||(Nt=this.familiesBySource[Ft]={});var Kt=At.sourceLayer||"_geojsonTileLayer",Ie=Nt[Kt];Ie||(Ie=Nt[Kt]=[]),Ie.push(nt)}}};var s=function(_e){var Le={},Ce=[];for(var Pe in _e){var Xe=_e[Pe],ut=Le[Pe]={};for(var kt in Xe){var ft=Xe[+kt];if(ft&&ft.bitmap.width!==0&&ft.bitmap.height!==0){var Et={x:0,y:0,w:ft.bitmap.width+2,h:ft.bitmap.height+2};Ce.push(Et),ut[kt]={rect:Et,metrics:ft.metrics}}}}var mt=e.potpack(Ce),It=mt.w,vt=mt.h,nt=new e.AlphaImage({width:It||1,height:vt||1});for(var At in _e){var Ft=_e[At];for(var Nt in Ft){var Kt=Ft[+Nt];if(Kt&&Kt.bitmap.width!==0&&Kt.bitmap.height!==0){var Ie=Le[At][Nt].rect;e.AlphaImage.copy(Kt.bitmap,nt,{x:0,y:0},{x:Ie.x+1,y:Ie.y+1},Kt.bitmap)}}}this.image=nt,this.positions=Le};e.register("GlyphAtlas",s);var o=function(_e){this.tileID=new e.OverscaledTileID(_e.tileID.overscaledZ,_e.tileID.wrap,_e.tileID.canonical.z,_e.tileID.canonical.x,_e.tileID.canonical.y),this.uid=_e.uid,this.zoom=_e.zoom,this.pixelRatio=_e.pixelRatio,this.tileSize=_e.tileSize,this.source=_e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=_e.showCollisionBoxes,this.collectResourceTiming=!!_e.collectResourceTiming,this.returnDependencies=!!_e.returnDependencies,this.promoteId=_e.promoteId};function a(_e,Le,Ce){for(var Pe=new e.EvaluationParameters(Le),Xe=0,ut=_e;Xe<ut.length;Xe+=1)ut[Xe].recalculate(Pe,Ce)}function c(_e,Le){var Ce=e.getArrayBuffer(_e.request,function(Pe,Xe,ut,kt){Pe?Le(Pe):Xe&&Le(null,{vectorTile:new e.vectorTile.VectorTile(new e.pbf(Xe)),rawData:Xe,cacheControl:ut,expires:kt})});return function(){Ce.cancel(),Le()}}o.prototype.parse=function(_e,Le,Ce,Pe,Xe){var ut=this;this.status="parsing",this.data=_e,this.collisionBoxArray=new e.CollisionBoxArray;var kt=new e.DictionaryCoder(Object.keys(_e.layers).sort()),ft=new e.FeatureIndex(this.tileID,this.promoteId);ft.bucketLayerIDs=[];var Et,mt,It,vt,nt={},At={featureIndex:ft,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:Ce},Ft=Le.familiesBySource[this.source];for(var Nt in Ft){var Kt=_e.layers[Nt];if(Kt){Kt.version===1&&e.warnOnce('Vector tile source "'+this.source+'" layer "'+Nt+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Ie=kt.encode(Nt),ot=[],bt=0;bt<Kt.length;bt++){var Pt=Kt.feature(bt),Vt=ft.getId(Pt,Nt);ot.push({feature:Pt,id:Vt,index:bt,sourceLayerIndex:Ie})}for(var nr=0,Yt=Ft[Nt];nr<Yt.length;nr+=1){var Xt=Yt[nr],ar=Xt[0];ar.minzoom&&this.zoom<Math.floor(ar.minzoom)||ar.maxzoom&&this.zoom>=ar.maxzoom||ar.visibility!=="none"&&(a(Xt,this.zoom,Ce),(nt[ar.id]=ar.createBucket({index:ft.bucketLayerIDs.length,layers:Xt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ie,sourceID:this.source})).populate(ot,At,this.tileID.canonical),ft.bucketLayerIDs.push(Xt.map(function(yr){return yr.id})))}}}var hr=e.mapObject(At.glyphDependencies,function(yr){return Object.keys(yr).map(Number)});Object.keys(hr).length?Pe.send("getGlyphs",{uid:this.uid,stacks:hr},function(yr,zr){Et||(Et=yr,mt=zr,fr.call(ut))}):mt={};var mr=Object.keys(At.iconDependencies);mr.length?Pe.send("getImages",{icons:mr,source:this.source,tileID:this.tileID,type:"icons"},function(yr,zr){Et||(Et=yr,It=zr,fr.call(ut))}):It={};var sr=Object.keys(At.patternDependencies);function fr(){if(Et)return Xe(Et);if(mt&&It&&vt){var yr=new s(mt),zr=new e.ImageAtlas(It,vt);for(var xr in nt){var Br=nt[xr];Br instanceof e.SymbolBucket?(a(Br.layers,this.zoom,Ce),e.performSymbolLayout(Br,mt,yr.positions,It,zr.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Br.hasPattern&&(Br instanceof e.LineBucket||Br instanceof e.FillBucket||Br instanceof e.FillExtrusionBucket)&&(a(Br.layers,this.zoom,Ce),Br.addFeatures(At,this.tileID.canonical,zr.patternPositions))}this.status="done",Xe(null,{buckets:e.values(nt).filter(function(Jr){return!Jr.isEmpty()}),featureIndex:ft,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:yr.image,imageAtlas:zr,glyphMap:this.returnDependencies?mt:null,iconMap:this.returnDependencies?It:null,glyphPositions:this.returnDependencies?yr.positions:null})}}sr.length?Pe.send("getImages",{icons:sr,source:this.source,tileID:this.tileID,type:"patterns"},function(yr,zr){Et||(Et=yr,vt=zr,fr.call(ut))}):vt={},fr.call(this)};var r=function(_e,Le,Ce,Pe){this.actor=_e,this.layerIndex=Le,this.availableImages=Ce,this.loadVectorData=Pe||c,this.loading={},this.loaded={}};r.prototype.loadTile=function(_e,Le){var Ce=this,Pe=_e.uid;this.loading||(this.loading={});var Xe=!!(_e&&_e.request&&_e.request.collectResourceTiming)&&new e.RequestPerformance(_e.request),ut=this.loading[Pe]=new o(_e);ut.abort=this.loadVectorData(_e,function(kt,ft){if(delete Ce.loading[Pe],kt||!ft)return ut.status="done",Ce.loaded[Pe]=ut,Le(kt);var Et=ft.rawData,mt={};ft.expires&&(mt.expires=ft.expires),ft.cacheControl&&(mt.cacheControl=ft.cacheControl);var It={};if(Xe){var vt=Xe.finish();vt&&(It.resourceTiming=JSON.parse(JSON.stringify(vt)))}ut.vectorTile=ft.vectorTile,ut.parse(ft.vectorTile,Ce.layerIndex,Ce.availableImages,Ce.actor,function(nt,At){if(nt||!At)return Le(nt);Le(null,e.extend({rawTileData:Et.slice(0)},At,mt,It))}),Ce.loaded=Ce.loaded||{},Ce.loaded[Pe]=ut})},r.prototype.reloadTile=function(_e,Le){var Ce=this,Pe=this.loaded,Xe=_e.uid,ut=this;if(Pe&&Pe[Xe]){var kt=Pe[Xe];kt.showCollisionBoxes=_e.showCollisionBoxes;var ft=function(Et,mt){var It=kt.reloadCallback;It&&(delete kt.reloadCallback,kt.parse(kt.vectorTile,ut.layerIndex,Ce.availableImages,ut.actor,It)),Le(Et,mt)};kt.status==="parsing"?kt.reloadCallback=ft:kt.status==="done"&&(kt.vectorTile?kt.parse(kt.vectorTile,this.layerIndex,this.availableImages,this.actor,ft):ft())}},r.prototype.abortTile=function(_e,Le){var Ce=this.loading,Pe=_e.uid;Ce&&Ce[Pe]&&Ce[Pe].abort&&(Ce[Pe].abort(),delete Ce[Pe]),Le()},r.prototype.removeTile=function(_e,Le){var Ce=this.loaded,Pe=_e.uid;Ce&&Ce[Pe]&&delete Ce[Pe],Le()};var n=e.window.ImageBitmap,d=function(){this.loaded={}};d.prototype.loadTile=function(_e,Le){var Ce=_e.uid,Pe=_e.encoding,Xe=_e.rawImageData,ut=n&&Xe instanceof n?this.getImageData(Xe):Xe,kt=new e.DEMData(Ce,ut,Pe);this.loaded=this.loaded||{},this.loaded[Ce]=kt,Le(null,kt)},d.prototype.getImageData=function(_e){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(_e.width,_e.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=_e.width,this.offscreenCanvas.height=_e.height,this.offscreenCanvasContext.drawImage(_e,0,0,_e.width,_e.height);var Le=this.offscreenCanvasContext.getImageData(-1,-1,_e.width+2,_e.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new e.RGBAImage({width:Le.width,height:Le.height},Le.data)},d.prototype.removeTile=function(_e){var Le=this.loaded,Ce=_e.uid;Le&&Le[Ce]&&delete Le[Ce]};var l=function _e(Le,Ce){var Pe,Xe=Le&&Le.type;if(Xe==="FeatureCollection")for(Pe=0;Pe<Le.features.length;Pe++)_e(Le.features[Pe],Ce);else if(Xe==="GeometryCollection")for(Pe=0;Pe<Le.geometries.length;Pe++)_e(Le.geometries[Pe],Ce);else if(Xe==="Feature")_e(Le.geometry,Ce);else if(Xe==="Polygon")y(Le.coordinates,Ce);else if(Xe==="MultiPolygon")for(Pe=0;Pe<Le.coordinates.length;Pe++)y(Le.coordinates[Pe],Ce);return Le};function y(_e,Le){if(_e.length!==0){v(_e[0],Le);for(var Ce=1;Ce<_e.length;Ce++)v(_e[Ce],!Le)}}function v(_e,Le){for(var Ce=0,Pe=0,Xe=_e.length,ut=Xe-1;Pe<Xe;ut=Pe++)Ce+=(_e[Pe][0]-_e[ut][0])*(_e[ut][1]+_e[Pe][1]);Ce>=0!=!!Le&&_e.reverse()}var _=e.vectorTile.VectorTileFeature.prototype.toGeoJSON,x=function(_e){this._feature=_e,this.extent=e.EXTENT,this.type=_e.type,this.properties=_e.tags,"id"in _e&&!isNaN(_e.id)&&(this.id=parseInt(_e.id,10))};x.prototype.loadGeometry=function(){if(this._feature.type===1){for(var _e=[],Le=0,Ce=this._feature.geometry;Le<Ce.length;Le+=1){var Pe=Ce[Le];_e.push([new e.Point$1(Pe[0],Pe[1])])}return _e}for(var Xe=[],ut=0,kt=this._feature.geometry;ut<kt.length;ut+=1){for(var ft=[],Et=0,mt=kt[ut];Et<mt.length;Et+=1){var It=mt[Et];ft.push(new e.Point$1(It[0],It[1]))}Xe.push(ft)}return Xe},x.prototype.toGeoJSON=function(_e,Le,Ce){return _.call(this,_e,Le,Ce)};var T=function(_e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=e.EXTENT,this.length=_e.length,this._features=_e};T.prototype.feature=function(_e){return new x(this._features[_e])};var A=e.vectorTile.VectorTileFeature,S=w;function w(_e,Le){this.options=Le||{},this.features=_e,this.length=_e.length}function L(_e,Le){this.id=typeof _e.id=="number"?_e.id:void 0,this.type=_e.type,this.rawGeometry=_e.type===1?[_e.geometry]:_e.geometry,this.properties=_e.tags,this.extent=Le||4096}w.prototype.feature=function(_e){return new L(this.features[_e],this.options.extent)},L.prototype.loadGeometry=function(){var _e=this.rawGeometry;this.geometry=[];for(var Le=0;Le<_e.length;Le++){for(var Ce=_e[Le],Pe=[],Xe=0;Xe<Ce.length;Xe++)Pe.push(new e.Point$1(Ce[Xe][0],Ce[Xe][1]));this.geometry.push(Pe)}return this.geometry},L.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var _e=this.geometry,Le=1/0,Ce=-1/0,Pe=1/0,Xe=-1/0,ut=0;ut<_e.length;ut++)for(var kt=_e[ut],ft=0;ft<kt.length;ft++){var Et=kt[ft];Le=Math.min(Le,Et.x),Ce=Math.max(Ce,Et.x),Pe=Math.min(Pe,Et.y),Xe=Math.max(Xe,Et.y)}return[Le,Pe,Ce,Xe]},L.prototype.toGeoJSON=A.prototype.toGeoJSON;var k=O,C=O,M=function(_e,Le){Le=Le||{};var Ce={};for(var Pe in _e)Ce[Pe]=new S(_e[Pe].features,Le),Ce[Pe].name=Pe,Ce[Pe].version=Le.version,Ce[Pe].extent=Le.extent;return O({layers:Ce})},P=S;function O(_e){var Le=new e.pbf;return function(Ce,Pe){for(var Xe in Ce.layers)Pe.writeMessage(3,F,Ce.layers[Xe])}(_e,Le),Le.finish()}function F(_e,Le){var Ce;Le.writeVarintField(15,_e.version||1),Le.writeStringField(1,_e.name||""),Le.writeVarintField(5,_e.extent||4096);var Pe={keys:[],values:[],keycache:{},valuecache:{}};for(Ce=0;Ce<_e.length;Ce++)Pe.feature=_e.feature(Ce),Le.writeMessage(2,j,Pe);var Xe=Pe.keys;for(Ce=0;Ce<Xe.length;Ce++)Le.writeStringField(3,Xe[Ce]);var ut=Pe.values;for(Ce=0;Ce<ut.length;Ce++)Le.writeMessage(4,G,ut[Ce])}function j(_e,Le){var Ce=_e.feature;Ce.id!==void 0&&Le.writeVarintField(1,Ce.id),Le.writeMessage(2,W,_e),Le.writeVarintField(3,Ce.type),Le.writeMessage(4,X,Ce)}function W(_e,Le){var Ce=_e.feature,Pe=_e.keys,Xe=_e.values,ut=_e.keycache,kt=_e.valuecache;for(var ft in Ce.properties){var Et=ut[ft];Et===void 0&&(Pe.push(ft),Et=Pe.length-1,ut[ft]=Et),Le.writeVarint(Et);var mt=Ce.properties[ft],It=typeof mt;It!=="string"&&It!=="boolean"&&It!=="number"&&(mt=JSON.stringify(mt));var vt=It+":"+mt,nt=kt[vt];nt===void 0&&(Xe.push(mt),nt=Xe.length-1,kt[vt]=nt),Le.writeVarint(nt)}}function Z(_e,Le){return(Le<<3)+(7&_e)}function Q(_e){return _e<<1^_e>>31}function X(_e,Le){for(var Ce=_e.loadGeometry(),Pe=_e.type,Xe=0,ut=0,kt=Ce.length,ft=0;ft<kt;ft++){var Et=Ce[ft],mt=1;Pe===1&&(mt=Et.length),Le.writeVarint(Z(1,mt));for(var It=Pe===3?Et.length-1:Et.length,vt=0;vt<It;vt++){vt===1&&Pe!==1&&Le.writeVarint(Z(2,It-1));var nt=Et[vt].x-Xe,At=Et[vt].y-ut;Le.writeVarint(Q(nt)),Le.writeVarint(Q(At)),Xe+=nt,ut+=At}Pe===3&&Le.writeVarint(Z(7,1))}}function G(_e,Le){var Ce=typeof _e;Ce==="string"?Le.writeStringField(1,_e):Ce==="boolean"?Le.writeBooleanField(7,_e):Ce==="number"&&(_e%1!=0?Le.writeDoubleField(3,_e):_e<0?Le.writeSVarintField(6,_e):Le.writeVarintField(5,_e))}function Y(_e,Le,Ce,Pe,Xe,ut){if(!(Xe-Pe<=Ce)){var kt=Pe+Xe>>1;(function ft(Et,mt,It,vt,nt,At){for(;nt>vt;){if(nt-vt>600){var Ft=nt-vt+1,Nt=It-vt+1,Kt=Math.log(Ft),Ie=.5*Math.exp(2*Kt/3),ot=.5*Math.sqrt(Kt*Ie*(Ft-Ie)/Ft)*(Nt-Ft/2<0?-1:1),bt=Math.max(vt,Math.floor(It-Nt*Ie/Ft+ot)),Pt=Math.min(nt,Math.floor(It+(Ft-Nt)*Ie/Ft+ot));ft(Et,mt,It,bt,Pt,At)}var Vt=mt[2*It+At],nr=vt,Yt=nt;for(K(Et,mt,vt,It),mt[2*nt+At]>Vt&&K(Et,mt,vt,nt);nr<Yt;){for(K(Et,mt,nr,Yt),nr++,Yt--;mt[2*nr+At]<Vt;)nr++;for(;mt[2*Yt+At]>Vt;)Yt--}mt[2*vt+At]===Vt?K(Et,mt,vt,Yt):(Yt++,K(Et,mt,Yt,nt)),Yt<=It&&(vt=Yt+1),It<=Yt&&(nt=Yt-1)}})(_e,Le,kt,Pe,Xe,ut%2),Y(_e,Le,Ce,Pe,kt-1,ut+1),Y(_e,Le,Ce,kt+1,Xe,ut+1)}}function K(_e,Le,Ce,Pe){D(_e,Ce,Pe),D(Le,2*Ce,2*Pe),D(Le,2*Ce+1,2*Pe+1)}function D(_e,Le,Ce){var Pe=_e[Le];_e[Le]=_e[Ce],_e[Ce]=Pe}function B(_e,Le,Ce,Pe){var Xe=_e-Ce,ut=Le-Pe;return Xe*Xe+ut*ut}k.fromVectorTileJs=C,k.fromGeojsonVt=M,k.GeoJSONWrapper=P;var q=function(_e){return _e[0]},ee=function(_e){return _e[1]},J=function(_e,Le,Ce,Pe,Xe){Le===void 0&&(Le=q),Ce===void 0&&(Ce=ee),Pe===void 0&&(Pe=64),Xe===void 0&&(Xe=Float64Array),this.nodeSize=Pe,this.points=_e;for(var ut=_e.length<65536?Uint16Array:Uint32Array,kt=this.ids=new ut(_e.length),ft=this.coords=new Xe(2*_e.length),Et=0;Et<_e.length;Et++)kt[Et]=Et,ft[2*Et]=Le(_e[Et]),ft[2*Et+1]=Ce(_e[Et]);Y(kt,ft,Pe,0,kt.length-1,0)};J.prototype.range=function(_e,Le,Ce,Pe){return function(Xe,ut,kt,ft,Et,mt,It){for(var vt,nt,At=[0,Xe.length-1,0],Ft=[];At.length;){var Nt=At.pop(),Kt=At.pop(),Ie=At.pop();if(Kt-Ie<=It)for(var ot=Ie;ot<=Kt;ot++)vt=ut[2*ot],nt=ut[2*ot+1],vt>=kt&&vt<=Et&&nt>=ft&&nt<=mt&&Ft.push(Xe[ot]);else{var bt=Math.floor((Ie+Kt)/2);vt=ut[2*bt],nt=ut[2*bt+1],vt>=kt&&vt<=Et&&nt>=ft&&nt<=mt&&Ft.push(Xe[bt]);var Pt=(Nt+1)%2;(Nt===0?kt<=vt:ft<=nt)&&(At.push(Ie),At.push(bt-1),At.push(Pt)),(Nt===0?Et>=vt:mt>=nt)&&(At.push(bt+1),At.push(Kt),At.push(Pt))}}return Ft}(this.ids,this.coords,_e,Le,Ce,Pe,this.nodeSize)},J.prototype.within=function(_e,Le,Ce){return function(Pe,Xe,ut,kt,ft,Et){for(var mt=[0,Pe.length-1,0],It=[],vt=ft*ft;mt.length;){var nt=mt.pop(),At=mt.pop(),Ft=mt.pop();if(At-Ft<=Et)for(var Nt=Ft;Nt<=At;Nt++)B(Xe[2*Nt],Xe[2*Nt+1],ut,kt)<=vt&&It.push(Pe[Nt]);else{var Kt=Math.floor((Ft+At)/2),Ie=Xe[2*Kt],ot=Xe[2*Kt+1];B(Ie,ot,ut,kt)<=vt&&It.push(Pe[Kt]);var bt=(nt+1)%2;(nt===0?ut-ft<=Ie:kt-ft<=ot)&&(mt.push(Ft),mt.push(Kt-1),mt.push(bt)),(nt===0?ut+ft>=Ie:kt+ft>=ot)&&(mt.push(Kt+1),mt.push(At),mt.push(bt))}}return It}(this.ids,this.coords,_e,Le,Ce,this.nodeSize)};var $={minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(_e){return _e}},te=function(_e){this.options=ve(Object.create($),_e),this.trees=new Array(this.options.maxZoom+1)};function ie(_e,Le,Ce,Pe,Xe){return{x:_e,y:Le,zoom:1/0,id:Ce,parentId:-1,numPoints:Pe,properties:Xe}}function ae(_e,Le){var Ce=_e.geometry.coordinates,Pe=Ce[0],Xe=Ce[1];return{x:de(Pe),y:ce(Xe),zoom:1/0,index:Le,parentId:-1}}function he(_e){return{type:"Feature",id:_e.id,properties:se(_e),geometry:{type:"Point",coordinates:[(Pe=_e.x,360*(Pe-.5)),(Le=_e.y,Ce=(180-360*Le)*Math.PI/180,360*Math.atan(Math.exp(Ce))/Math.PI-90)]}};var Le,Ce,Pe}function se(_e){var Le=_e.numPoints,Ce=Le>=1e4?Math.round(Le/1e3)+"k":Le>=1e3?Math.round(Le/100)/10+"k":Le;return ve(ve({},_e.properties),{cluster:!0,cluster_id:_e.id,point_count:Le,point_count_abbreviated:Ce})}function de(_e){return _e/360+.5}function ce(_e){var Le=Math.sin(_e*Math.PI/180),Ce=.5-.25*Math.log((1+Le)/(1-Le))/Math.PI;return Ce<0?0:Ce>1?1:Ce}function ve(_e,Le){for(var Ce in Le)_e[Ce]=Le[Ce];return _e}function ke(_e){return _e.x}function Ee(_e){return _e.y}function be(_e,Le,Ce,Pe,Xe,ut){var kt=Xe-Ce,ft=ut-Pe;if(kt!==0||ft!==0){var Et=((_e-Ce)*kt+(Le-Pe)*ft)/(kt*kt+ft*ft);Et>1?(Ce=Xe,Pe=ut):Et>0&&(Ce+=kt*Et,Pe+=ft*Et)}return(kt=_e-Ce)*kt+(ft=Le-Pe)*ft}function xe(_e,Le,Ce,Pe){var Xe={id:_e===void 0?null:_e,type:Le,geometry:Ce,tags:Pe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ut){var kt=ut.geometry,ft=ut.type;if(ft==="Point"||ft==="MultiPoint"||ft==="LineString")ue(ut,kt);else if(ft==="Polygon"||ft==="MultiLineString")for(var Et=0;Et<kt.length;Et++)ue(ut,kt[Et]);else if(ft==="MultiPolygon")for(Et=0;Et<kt.length;Et++)for(var mt=0;mt<kt[Et].length;mt++)ue(ut,kt[Et][mt])}(Xe),Xe}function ue(_e,Le){for(var Ce=0;Ce<Le.length;Ce+=3)_e.minX=Math.min(_e.minX,Le[Ce]),_e.minY=Math.min(_e.minY,Le[Ce+1]),_e.maxX=Math.max(_e.maxX,Le[Ce]),_e.maxY=Math.max(_e.maxY,Le[Ce+1])}function me(_e,Le,Ce,Pe){if(Le.geometry){var Xe=Le.geometry.coordinates,ut=Le.geometry.type,kt=Math.pow(Ce.tolerance/((1<<Ce.maxZoom)*Ce.extent),2),ft=[],Et=Le.id;if(Ce.promoteId?Et=Le.properties[Ce.promoteId]:Ce.generateId&&(Et=Pe||0),ut==="Point")we(Xe,ft);else if(ut==="MultiPoint")for(var mt=0;mt<Xe.length;mt++)we(Xe[mt],ft);else if(ut==="LineString")Me(Xe,ft,kt,!1);else if(ut==="MultiLineString"){if(Ce.lineMetrics){for(mt=0;mt<Xe.length;mt++)ft=[],Me(Xe[mt],ft,kt,!1),_e.push(xe(Et,"LineString",ft,Le.properties));return}Se(Xe,ft,kt,!1)}else if(ut==="Polygon")Se(Xe,ft,kt,!0);else{if(ut!=="MultiPolygon"){if(ut==="GeometryCollection"){for(mt=0;mt<Le.geometry.geometries.length;mt++)me(_e,{id:Et,geometry:Le.geometry.geometries[mt],properties:Le.properties},Ce,Pe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(mt=0;mt<Xe.length;mt++){var It=[];Se(Xe[mt],It,kt,!0),ft.push(It)}}_e.push(xe(Et,ut,ft,Le.properties))}}function we(_e,Le){Le.push(De(_e[0])),Le.push(Fe(_e[1])),Le.push(0)}function Me(_e,Le,Ce,Pe){for(var Xe,ut,kt=0,ft=0;ft<_e.length;ft++){var Et=De(_e[ft][0]),mt=Fe(_e[ft][1]);Le.push(Et),Le.push(mt),Le.push(0),ft>0&&(kt+=Pe?(Xe*mt-Et*ut)/2:Math.sqrt(Math.pow(Et-Xe,2)+Math.pow(mt-ut,2))),Xe=Et,ut=mt}var It=Le.length-3;Le[2]=1,function vt(nt,At,Ft,Nt){for(var Kt,Ie=Nt,ot=Ft-At>>1,bt=Ft-At,Pt=nt[At],Vt=nt[At+1],nr=nt[Ft],Yt=nt[Ft+1],Xt=At+3;Xt<Ft;Xt+=3){var ar=be(nt[Xt],nt[Xt+1],Pt,Vt,nr,Yt);if(ar>Ie)Kt=Xt,Ie=ar;else if(ar===Ie){var hr=Math.abs(Xt-ot);hr<bt&&(Kt=Xt,bt=hr)}}Ie>Nt&&(Kt-At>3&&vt(nt,At,Kt,Nt),nt[Kt+2]=Ie,Ft-Kt>3&&vt(nt,Kt,Ft,Nt))}(Le,0,It,Ce),Le[It+2]=1,Le.size=Math.abs(kt),Le.start=0,Le.end=Le.size}function Se(_e,Le,Ce,Pe){for(var Xe=0;Xe<_e.length;Xe++){var ut=[];Me(_e[Xe],ut,Ce,Pe),Le.push(ut)}}function De(_e){return _e/360+.5}function Fe(_e){var Le=Math.sin(_e*Math.PI/180),Ce=.5-.25*Math.log((1+Le)/(1-Le))/Math.PI;return Ce<0?0:Ce>1?1:Ce}function Ye(_e,Le,Ce,Pe,Xe,ut,kt,ft){if(Pe/=Le,ut>=(Ce/=Le)&&kt<Pe)return _e;if(kt<Ce||ut>=Pe)return null;for(var Et=[],mt=0;mt<_e.length;mt++){var It=_e[mt],vt=It.geometry,nt=It.type,At=Xe===0?It.minX:It.minY,Ft=Xe===0?It.maxX:It.maxY;if(At>=Ce&&Ft<Pe)Et.push(It);else if(!(Ft<Ce||At>=Pe)){var Nt=[];if(nt==="Point"||nt==="MultiPoint")et(vt,Nt,Ce,Pe,Xe);else if(nt==="LineString")Oe(vt,Nt,Ce,Pe,Xe,!1,ft.lineMetrics);else if(nt==="MultiLineString")We(vt,Nt,Ce,Pe,Xe,!1);else if(nt==="Polygon")We(vt,Nt,Ce,Pe,Xe,!0);else if(nt==="MultiPolygon")for(var Kt=0;Kt<vt.length;Kt++){var Ie=[];We(vt[Kt],Ie,Ce,Pe,Xe,!0),Ie.length&&Nt.push(Ie)}if(Nt.length){if(ft.lineMetrics&&nt==="LineString"){for(Kt=0;Kt<Nt.length;Kt++)Et.push(xe(It.id,nt,Nt[Kt],It.tags));continue}nt!=="LineString"&&nt!=="MultiLineString"||(Nt.length===1?(nt="LineString",Nt=Nt[0]):nt="MultiLineString"),nt!=="Point"&&nt!=="MultiPoint"||(nt=Nt.length===3?"Point":"MultiPoint"),Et.push(xe(It.id,nt,Nt,It.tags))}}}return Et.length?Et:null}function et(_e,Le,Ce,Pe,Xe){for(var ut=0;ut<_e.length;ut+=3){var kt=_e[ut+Xe];kt>=Ce&&kt<=Pe&&(Le.push(_e[ut]),Le.push(_e[ut+1]),Le.push(_e[ut+2]))}}function Oe(_e,Le,Ce,Pe,Xe,ut,kt){for(var ft,Et,mt=je(_e),It=Xe===0?Qe:it,vt=_e.start,nt=0;nt<_e.length-3;nt+=3){var At=_e[nt],Ft=_e[nt+1],Nt=_e[nt+2],Kt=_e[nt+3],Ie=_e[nt+4],ot=Xe===0?At:Ft,bt=Xe===0?Kt:Ie,Pt=!1;kt&&(ft=Math.sqrt(Math.pow(At-Kt,2)+Math.pow(Ft-Ie,2))),ot<Ce?bt>Ce&&(Et=It(mt,At,Ft,Kt,Ie,Ce),kt&&(mt.start=vt+ft*Et)):ot>Pe?bt<Pe&&(Et=It(mt,At,Ft,Kt,Ie,Pe),kt&&(mt.start=vt+ft*Et)):Ge(mt,At,Ft,Nt),bt<Ce&&ot>=Ce&&(Et=It(mt,At,Ft,Kt,Ie,Ce),Pt=!0),bt>Pe&&ot<=Pe&&(Et=It(mt,At,Ft,Kt,Ie,Pe),Pt=!0),!ut&&Pt&&(kt&&(mt.end=vt+ft*Et),Le.push(mt),mt=je(_e)),kt&&(vt+=ft)}var Vt=_e.length-3;At=_e[Vt],Ft=_e[Vt+1],Nt=_e[Vt+2],(ot=Xe===0?At:Ft)>=Ce&&ot<=Pe&&Ge(mt,At,Ft,Nt),Vt=mt.length-3,ut&&Vt>=3&&(mt[Vt]!==mt[0]||mt[Vt+1]!==mt[1])&&Ge(mt,mt[0],mt[1],mt[2]),mt.length&&Le.push(mt)}function je(_e){var Le=[];return Le.size=_e.size,Le.start=_e.start,Le.end=_e.end,Le}function We(_e,Le,Ce,Pe,Xe,ut){for(var kt=0;kt<_e.length;kt++)Oe(_e[kt],Le,Ce,Pe,Xe,ut,!1)}function Ge(_e,Le,Ce,Pe){_e.push(Le),_e.push(Ce),_e.push(Pe)}function Qe(_e,Le,Ce,Pe,Xe,ut){var kt=(ut-Le)/(Pe-Le);return _e.push(ut),_e.push(Ce+(Xe-Ce)*kt),_e.push(1),kt}function it(_e,Le,Ce,Pe,Xe,ut){var kt=(ut-Ce)/(Xe-Ce);return _e.push(Le+(Pe-Le)*kt),_e.push(ut),_e.push(1),kt}function lt(_e,Le){for(var Ce=[],Pe=0;Pe<_e.length;Pe++){var Xe,ut=_e[Pe],kt=ut.type;if(kt==="Point"||kt==="MultiPoint"||kt==="LineString")Xe=Lt(ut.geometry,Le);else if(kt==="MultiLineString"||kt==="Polygon"){Xe=[];for(var ft=0;ft<ut.geometry.length;ft++)Xe.push(Lt(ut.geometry[ft],Le))}else if(kt==="MultiPolygon")for(Xe=[],ft=0;ft<ut.geometry.length;ft++){for(var Et=[],mt=0;mt<ut.geometry[ft].length;mt++)Et.push(Lt(ut.geometry[ft][mt],Le));Xe.push(Et)}Ce.push(xe(ut.id,kt,Xe,ut.tags))}return Ce}function Lt(_e,Le){var Ce=[];Ce.size=_e.size,_e.start!==void 0&&(Ce.start=_e.start,Ce.end=_e.end);for(var Pe=0;Pe<_e.length;Pe+=3)Ce.push(_e[Pe]+Le,_e[Pe+1],_e[Pe+2]);return Ce}function wt(_e,Le){if(_e.transformed)return _e;var Ce,Pe,Xe,ut=1<<_e.z,kt=_e.x,ft=_e.y;for(Ce=0;Ce<_e.features.length;Ce++){var Et=_e.features[Ce],mt=Et.geometry,It=Et.type;if(Et.geometry=[],It===1)for(Pe=0;Pe<mt.length;Pe+=2)Et.geometry.push(rt(mt[Pe],mt[Pe+1],Le,ut,kt,ft));else for(Pe=0;Pe<mt.length;Pe++){var vt=[];for(Xe=0;Xe<mt[Pe].length;Xe+=2)vt.push(rt(mt[Pe][Xe],mt[Pe][Xe+1],Le,ut,kt,ft));Et.geometry.push(vt)}}return _e.transformed=!0,_e}function rt(_e,Le,Ce,Pe,Xe,ut){return[Math.round(Ce*(_e*Pe-Xe)),Math.round(Ce*(Le*Pe-ut))]}function $e(_e,Le,Ce,Pe,Xe){for(var ut=Le===Xe.maxZoom?0:Xe.tolerance/((1<<Le)*Xe.extent),kt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:Ce,y:Pe,z:Le,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ft=0;ft<_e.length;ft++){kt.numFeatures++,xt(kt,_e[ft],ut,Xe);var Et=_e[ft].minX,mt=_e[ft].minY,It=_e[ft].maxX,vt=_e[ft].maxY;Et<kt.minX&&(kt.minX=Et),mt<kt.minY&&(kt.minY=mt),It>kt.maxX&&(kt.maxX=It),vt>kt.maxY&&(kt.maxY=vt)}return kt}function xt(_e,Le,Ce,Pe){var Xe=Le.geometry,ut=Le.type,kt=[];if(ut==="Point"||ut==="MultiPoint")for(var ft=0;ft<Xe.length;ft+=3)kt.push(Xe[ft]),kt.push(Xe[ft+1]),_e.numPoints++,_e.numSimplified++;else if(ut==="LineString")Qt(kt,Xe,_e,Ce,!1,!1);else if(ut==="MultiLineString"||ut==="Polygon")for(ft=0;ft<Xe.length;ft++)Qt(kt,Xe[ft],_e,Ce,ut==="Polygon",ft===0);else if(ut==="MultiPolygon")for(var Et=0;Et<Xe.length;Et++){var mt=Xe[Et];for(ft=0;ft<mt.length;ft++)Qt(kt,mt[ft],_e,Ce,!0,ft===0)}if(kt.length){var It=Le.tags||null;if(ut==="LineString"&&Pe.lineMetrics){for(var vt in It={},Le.tags)It[vt]=Le.tags[vt];It.mapbox_clip_start=Xe.start/Xe.size,It.mapbox_clip_end=Xe.end/Xe.size}var nt={geometry:kt,type:ut==="Polygon"||ut==="MultiPolygon"?3:ut==="LineString"||ut==="MultiLineString"?2:1,tags:It};Le.id!==null&&(nt.id=Le.id),_e.features.push(nt)}}function Qt(_e,Le,Ce,Pe,Xe,ut){var kt=Pe*Pe;if(Pe>0&&Le.size<(Xe?kt:Pe))Ce.numPoints+=Le.length/3;else{for(var ft=[],Et=0;Et<Le.length;Et+=3)(Pe===0||Le[Et+2]>kt)&&(Ce.numSimplified++,ft.push(Le[Et]),ft.push(Le[Et+1])),Ce.numPoints++;Xe&&function(mt,It){for(var vt=0,nt=0,At=mt.length,Ft=At-2;nt<At;Ft=nt,nt+=2)vt+=(mt[nt]-mt[Ft])*(mt[nt+1]+mt[Ft+1]);if(vt>0===It)for(nt=0,At=mt.length;nt<At/2;nt+=2){var Nt=mt[nt],Kt=mt[nt+1];mt[nt]=mt[At-2-nt],mt[nt+1]=mt[At-1-nt],mt[At-2-nt]=Nt,mt[At-1-nt]=Kt}}(ft,ut),_e.push(ft)}}function $t(_e,Le){var Ce=(Le=this.options=function(Xe,ut){for(var kt in ut)Xe[kt]=ut[kt];return Xe}(Object.create(this.options),Le)).debug;if(Ce&&console.time("preprocess data"),Le.maxZoom<0||Le.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Le.promoteId&&Le.generateId)throw new Error("promoteId and generateId cannot be used together.");var Pe=function(Xe,ut){var kt=[];if(Xe.type==="FeatureCollection")for(var ft=0;ft<Xe.features.length;ft++)me(kt,Xe.features[ft],ut,ft);else Xe.type==="Feature"?me(kt,Xe,ut):me(kt,{geometry:Xe},ut);return kt}(_e,Le);this.tiles={},this.tileCoords=[],Ce&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Le.indexMaxZoom,Le.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(Pe=function(Xe,ut){var kt=ut.buffer/ut.extent,ft=Xe,Et=Ye(Xe,1,-1-kt,kt,0,-1,2,ut),mt=Ye(Xe,1,1-kt,2+kt,0,-1,2,ut);return(Et||mt)&&(ft=Ye(Xe,1,-kt,1+kt,0,-1,2,ut)||[],Et&&(ft=lt(Et,1).concat(ft)),mt&&(ft=ft.concat(lt(mt,-1)))),ft}(Pe,Le)).length&&this.splitTile(Pe,0,0,0),Ce&&(Pe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Ue(_e,Le,Ce){return 32*((1<<_e)*Ce+Le)+_e}function He(_e,Le){var Ce=_e.tileID.canonical;if(!this._geoJSONIndex)return Le(null,null);var Pe=this._geoJSONIndex.getTile(Ce.z,Ce.x,Ce.y);if(!Pe)return Le(null,null);var Xe=new T(Pe.features),ut=k(Xe);ut.byteOffset===0&&ut.byteLength===ut.buffer.byteLength||(ut=new Uint8Array(ut)),Le(null,{vectorTile:Xe,rawData:ut.buffer})}te.prototype.load=function(_e){var Le=this.options,Ce=Le.log,Pe=Le.minZoom,Xe=Le.maxZoom,ut=Le.nodeSize;Ce&&console.time("total time");var kt="prepare "+_e.length+" points";Ce&&console.time(kt),this.points=_e;for(var ft=[],Et=0;Et<_e.length;Et++)_e[Et].geometry&&ft.push(ae(_e[Et],Et));this.trees[Xe+1]=new J(ft,ke,Ee,ut,Float32Array),Ce&&console.timeEnd(kt);for(var mt=Xe;mt>=Pe;mt--){var It=+Date.now();ft=this._cluster(ft,mt),this.trees[mt]=new J(ft,ke,Ee,ut,Float32Array),Ce&&console.log("z%d: %d clusters in %dms",mt,ft.length,+Date.now()-It)}return Ce&&console.timeEnd("total time"),this},te.prototype.getClusters=function(_e,Le){var Ce=((_e[0]+180)%360+360)%360-180,Pe=Math.max(-90,Math.min(90,_e[1])),Xe=_e[2]===180?180:((_e[2]+180)%360+360)%360-180,ut=Math.max(-90,Math.min(90,_e[3]));if(_e[2]-_e[0]>=360)Ce=-180,Xe=180;else if(Ce>Xe){var kt=this.getClusters([Ce,Pe,180,ut],Le),ft=this.getClusters([-180,Pe,Xe,ut],Le);return kt.concat(ft)}for(var Et=this.trees[this._limitZoom(Le)],mt=[],It=0,vt=Et.range(de(Ce),ce(ut),de(Xe),ce(Pe));It<vt.length;It+=1){var nt=vt[It],At=Et.points[nt];mt.push(At.numPoints?he(At):this.points[At.index])}return mt},te.prototype.getChildren=function(_e){var Le=this._getOriginId(_e),Ce=this._getOriginZoom(_e),Pe="No cluster with the specified id.",Xe=this.trees[Ce];if(!Xe)throw new Error(Pe);var ut=Xe.points[Le];if(!ut)throw new Error(Pe);for(var kt=this.options.radius/(this.options.extent*Math.pow(2,Ce-1)),ft=[],Et=0,mt=Xe.within(ut.x,ut.y,kt);Et<mt.length;Et+=1){var It=mt[Et],vt=Xe.points[It];vt.parentId===_e&&ft.push(vt.numPoints?he(vt):this.points[vt.index])}if(ft.length===0)throw new Error(Pe);return ft},te.prototype.getLeaves=function(_e,Le,Ce){Le=Le||10,Ce=Ce||0;var Pe=[];return this._appendLeaves(Pe,_e,Le,Ce,0),Pe},te.prototype.getTile=function(_e,Le,Ce){var Pe=this.trees[this._limitZoom(_e)],Xe=Math.pow(2,_e),ut=this.options,kt=ut.extent,ft=ut.radius/kt,Et=(Ce-ft)/Xe,mt=(Ce+1+ft)/Xe,It={features:[]};return this._addTileFeatures(Pe.range((Le-ft)/Xe,Et,(Le+1+ft)/Xe,mt),Pe.points,Le,Ce,Xe,It),Le===0&&this._addTileFeatures(Pe.range(1-ft/Xe,Et,1,mt),Pe.points,Xe,Ce,Xe,It),Le===Xe-1&&this._addTileFeatures(Pe.range(0,Et,ft/Xe,mt),Pe.points,-1,Ce,Xe,It),It.features.length?It:null},te.prototype.getClusterExpansionZoom=function(_e){for(var Le=this._getOriginZoom(_e)-1;Le<=this.options.maxZoom;){var Ce=this.getChildren(_e);if(Le++,Ce.length!==1)break;_e=Ce[0].properties.cluster_id}return Le},te.prototype._appendLeaves=function(_e,Le,Ce,Pe,Xe){for(var ut=0,kt=this.getChildren(Le);ut<kt.length;ut+=1){var ft=kt[ut],Et=ft.properties;if(Et&&Et.cluster?Xe+Et.point_count<=Pe?Xe+=Et.point_count:Xe=this._appendLeaves(_e,Et.cluster_id,Ce,Pe,Xe):Xe<Pe?Xe++:_e.push(ft),_e.length===Ce)break}return Xe},te.prototype._addTileFeatures=function(_e,Le,Ce,Pe,Xe,ut){for(var kt=0,ft=_e;kt<ft.length;kt+=1){var Et=Le[ft[kt]],mt=Et.numPoints,It={type:1,geometry:[[Math.round(this.options.extent*(Et.x*Xe-Ce)),Math.round(this.options.extent*(Et.y*Xe-Pe))]],tags:mt?se(Et):this.points[Et.index].properties},vt=void 0;mt?vt=Et.id:this.options.generateId?vt=Et.index:this.points[Et.index].id&&(vt=this.points[Et.index].id),vt!==void 0&&(It.id=vt),ut.features.push(It)}},te.prototype._limitZoom=function(_e){return Math.max(this.options.minZoom,Math.min(_e,this.options.maxZoom+1))},te.prototype._cluster=function(_e,Le){for(var Ce=[],Pe=this.options,Xe=Pe.radius,ut=Pe.extent,kt=Pe.reduce,ft=Xe/(ut*Math.pow(2,Le)),Et=0;Et<_e.length;Et++){var mt=_e[Et];if(!(mt.zoom<=Le)){mt.zoom=Le;for(var It=this.trees[Le+1],vt=It.within(mt.x,mt.y,ft),nt=mt.numPoints||1,At=mt.x*nt,Ft=mt.y*nt,Nt=kt&&nt>1?this._map(mt,!0):null,Kt=(Et<<5)+(Le+1)+this.points.length,Ie=0,ot=vt;Ie<ot.length;Ie+=1){var bt=ot[Ie],Pt=It.points[bt];if(!(Pt.zoom<=Le)){Pt.zoom=Le;var Vt=Pt.numPoints||1;At+=Pt.x*Vt,Ft+=Pt.y*Vt,nt+=Vt,Pt.parentId=Kt,kt&&(Nt||(Nt=this._map(mt,!0)),kt(Nt,this._map(Pt)))}}nt===1?Ce.push(mt):(mt.parentId=Kt,Ce.push(ie(At/nt,Ft/nt,Kt,nt,Nt)))}}return Ce},te.prototype._getOriginId=function(_e){return _e-this.points.length>>5},te.prototype._getOriginZoom=function(_e){return(_e-this.points.length)%32},te.prototype._map=function(_e,Le){if(_e.numPoints)return Le?ve({},_e.properties):_e.properties;var Ce=this.points[_e.index].properties,Pe=this.options.map(Ce);return Le&&Pe===Ce?ve({},Pe):Pe},$t.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},$t.prototype.splitTile=function(_e,Le,Ce,Pe,Xe,ut,kt){for(var ft=[_e,Le,Ce,Pe],Et=this.options,mt=Et.debug;ft.length;){Pe=ft.pop(),Ce=ft.pop(),Le=ft.pop(),_e=ft.pop();var It=1<<Le,vt=Ue(Le,Ce,Pe),nt=this.tiles[vt];if(!nt&&(mt>1&&console.time("creation"),nt=this.tiles[vt]=$e(_e,Le,Ce,Pe,Et),this.tileCoords.push({z:Le,x:Ce,y:Pe}),mt)){mt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Le,Ce,Pe,nt.numFeatures,nt.numPoints,nt.numSimplified),console.timeEnd("creation"));var At="z"+Le;this.stats[At]=(this.stats[At]||0)+1,this.total++}if(nt.source=_e,Xe){if(Le===Et.maxZoom||Le===Xe)continue;var Ft=1<<Xe-Le;if(Ce!==Math.floor(ut/Ft)||Pe!==Math.floor(kt/Ft))continue}else if(Le===Et.indexMaxZoom||nt.numPoints<=Et.indexMaxPoints)continue;if(nt.source=null,_e.length!==0){mt>1&&console.time("clipping");var Nt,Kt,Ie,ot,bt,Pt,Vt=.5*Et.buffer/Et.extent,nr=.5-Vt,Yt=.5+Vt,Xt=1+Vt;Nt=Kt=Ie=ot=null,bt=Ye(_e,It,Ce-Vt,Ce+Yt,0,nt.minX,nt.maxX,Et),Pt=Ye(_e,It,Ce+nr,Ce+Xt,0,nt.minX,nt.maxX,Et),_e=null,bt&&(Nt=Ye(bt,It,Pe-Vt,Pe+Yt,1,nt.minY,nt.maxY,Et),Kt=Ye(bt,It,Pe+nr,Pe+Xt,1,nt.minY,nt.maxY,Et),bt=null),Pt&&(Ie=Ye(Pt,It,Pe-Vt,Pe+Yt,1,nt.minY,nt.maxY,Et),ot=Ye(Pt,It,Pe+nr,Pe+Xt,1,nt.minY,nt.maxY,Et),Pt=null),mt>1&&console.timeEnd("clipping"),ft.push(Nt||[],Le+1,2*Ce,2*Pe),ft.push(Kt||[],Le+1,2*Ce,2*Pe+1),ft.push(Ie||[],Le+1,2*Ce+1,2*Pe),ft.push(ot||[],Le+1,2*Ce+1,2*Pe+1)}}},$t.prototype.getTile=function(_e,Le,Ce){var Pe=this.options,Xe=Pe.extent,ut=Pe.debug;if(_e<0||_e>24)return null;var kt=1<<_e,ft=Ue(_e,Le=(Le%kt+kt)%kt,Ce);if(this.tiles[ft])return wt(this.tiles[ft],Xe);ut>1&&console.log("drilling down to z%d-%d-%d",_e,Le,Ce);for(var Et,mt=_e,It=Le,vt=Ce;!Et&&mt>0;)mt--,It=Math.floor(It/2),vt=Math.floor(vt/2),Et=this.tiles[Ue(mt,It,vt)];return Et&&Et.source?(ut>1&&console.log("found parent tile z%d-%d-%d",mt,It,vt),ut>1&&console.time("drilling down"),this.splitTile(Et.source,mt,It,vt,_e,Le,Ce),ut>1&&console.timeEnd("drilling down"),this.tiles[ft]?wt(this.tiles[ft],Xe):null):null};var Be=function(_e){function Le(Ce,Pe,Xe,ut){_e.call(this,Ce,Pe,Xe,He),ut&&(this.loadGeoJSON=ut)}return _e&&(Le.__proto__=_e),Le.prototype=Object.create(_e&&_e.prototype),Le.prototype.constructor=Le,Le.prototype.loadData=function(Ce,Pe){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=Pe,this._pendingLoadDataParams=Ce,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},Le.prototype._loadData=function(){var Ce=this;if(this._pendingCallback&&this._pendingLoadDataParams){var Pe=this._pendingCallback,Xe=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var ut=!!(Xe&&Xe.request&&Xe.request.collectResourceTiming)&&new e.RequestPerformance(Xe.request);this.loadGeoJSON(Xe,function(kt,ft){if(kt||!ft)return Pe(kt);if(typeof ft!="object")return Pe(new Error("Input data given to '"+Xe.source+"' is not a valid GeoJSON object."));l(ft,!0);try{Ce._geoJSONIndex=Xe.cluster?new te(function(It){var vt=It.superclusterOptions,nt=It.clusterProperties;if(!nt||!vt)return vt;for(var At={},Ft={},Nt={accumulated:null,zoom:0},Kt={properties:null},Ie=Object.keys(nt),ot=0,bt=Ie;ot<bt.length;ot+=1){var Pt=bt[ot],Vt=nt[Pt],nr=Vt[0],Yt=Vt[1],Xt=e.createExpression(Yt),ar=e.createExpression(typeof nr=="string"?[nr,["accumulated"],["get",Pt]]:nr);At[Pt]=Xt.value,Ft[Pt]=ar.value}return vt.map=function(hr){Kt.properties=hr;for(var mr={},sr=0,fr=Ie;sr<fr.length;sr+=1){var yr=fr[sr];mr[yr]=At[yr].evaluate(Nt,Kt)}return mr},vt.reduce=function(hr,mr){Kt.properties=mr;for(var sr=0,fr=Ie;sr<fr.length;sr+=1){var yr=fr[sr];Nt.accumulated=hr[yr],hr[yr]=Ft[yr].evaluate(Nt,Kt)}},vt}(Xe)).load(ft.features):function(It,vt){return new $t(It,vt)}(ft,Xe.geojsonVtOptions)}catch(It){return Pe(It)}Ce.loaded={};var Et={};if(ut){var mt=ut.finish();mt&&(Et.resourceTiming={},Et.resourceTiming[Xe.source]=JSON.parse(JSON.stringify(mt)))}Pe(null,Et)})}},Le.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},Le.prototype.reloadTile=function(Ce,Pe){var Xe=this.loaded,ut=Ce.uid;return Xe&&Xe[ut]?_e.prototype.reloadTile.call(this,Ce,Pe):this.loadTile(Ce,Pe)},Le.prototype.loadGeoJSON=function(Ce,Pe){if(Ce.request)e.getJSON(Ce.request,Pe);else{if(typeof Ce.data!="string")return Pe(new Error("Input data given to '"+Ce.source+"' is not a valid GeoJSON object."));try{return Pe(null,JSON.parse(Ce.data))}catch(Xe){return Pe(new Error("Input data given to '"+Ce.source+"' is not a valid GeoJSON object."))}}},Le.prototype.removeSource=function(Ce,Pe){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),Pe()},Le.prototype.getClusterExpansionZoom=function(Ce,Pe){try{Pe(null,this._geoJSONIndex.getClusterExpansionZoom(Ce.clusterId))}catch(Xe){Pe(Xe)}},Le.prototype.getClusterChildren=function(Ce,Pe){try{Pe(null,this._geoJSONIndex.getChildren(Ce.clusterId))}catch(Xe){Pe(Xe)}},Le.prototype.getClusterLeaves=function(Ce,Pe){try{Pe(null,this._geoJSONIndex.getLeaves(Ce.clusterId,Ce.limit,Ce.offset))}catch(Xe){Pe(Xe)}},Le}(r),Je=function(_e){var Le=this;this.self=_e,this.actor=new e.Actor(_e,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:r,geojson:Be},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(Ce,Pe){if(Le.workerSourceTypes[Ce])throw new Error('Worker source with name "'+Ce+'" already registered.');Le.workerSourceTypes[Ce]=Pe},this.self.registerRTLTextPlugin=function(Ce){if(e.plugin.isParsed())throw new Error("RTL text plugin already registered.");e.plugin.applyArabicShaping=Ce.applyArabicShaping,e.plugin.processBidirectionalText=Ce.processBidirectionalText,e.plugin.processStyledBidirectionalText=Ce.processStyledBidirectionalText}};return Je.prototype.setReferrer=function(_e,Le){this.referrer=Le},Je.prototype.setImages=function(_e,Le,Ce){for(var Pe in this.availableImages[_e]=Le,this.workerSources[_e]){var Xe=this.workerSources[_e][Pe];for(var ut in Xe)Xe[ut].availableImages=Le}Ce()},Je.prototype.setLayers=function(_e,Le,Ce){this.getLayerIndex(_e).replace(Le),Ce()},Je.prototype.updateLayers=function(_e,Le,Ce){this.getLayerIndex(_e).update(Le.layers,Le.removedIds),Ce()},Je.prototype.loadTile=function(_e,Le,Ce){this.getWorkerSource(_e,Le.type,Le.source).loadTile(Le,Ce)},Je.prototype.loadDEMTile=function(_e,Le,Ce){this.getDEMWorkerSource(_e,Le.source).loadTile(Le,Ce)},Je.prototype.reloadTile=function(_e,Le,Ce){this.getWorkerSource(_e,Le.type,Le.source).reloadTile(Le,Ce)},Je.prototype.abortTile=function(_e,Le,Ce){this.getWorkerSource(_e,Le.type,Le.source).abortTile(Le,Ce)},Je.prototype.removeTile=function(_e,Le,Ce){this.getWorkerSource(_e,Le.type,Le.source).removeTile(Le,Ce)},Je.prototype.removeDEMTile=function(_e,Le){this.getDEMWorkerSource(_e,Le.source).removeTile(Le)},Je.prototype.removeSource=function(_e,Le,Ce){if(this.workerSources[_e]&&this.workerSources[_e][Le.type]&&this.workerSources[_e][Le.type][Le.source]){var Pe=this.workerSources[_e][Le.type][Le.source];delete this.workerSources[_e][Le.type][Le.source],Pe.removeSource!==void 0?Pe.removeSource(Le,Ce):Ce()}},Je.prototype.loadWorkerSource=function(_e,Le,Ce){try{this.self.importScripts(Le.url),Ce()}catch(Pe){Ce(Pe.toString())}},Je.prototype.syncRTLPluginState=function(_e,Le,Ce){try{e.plugin.setState(Le);var Pe=e.plugin.getPluginURL();if(e.plugin.isLoaded()&&!e.plugin.isParsed()&&Pe!=null){this.self.importScripts(Pe);var Xe=e.plugin.isParsed();Ce(Xe?void 0:new Error("RTL Text Plugin failed to import scripts from "+Pe),Xe)}}catch(ut){Ce(ut.toString())}},Je.prototype.getAvailableImages=function(_e){var Le=this.availableImages[_e];return Le||(Le=[]),Le},Je.prototype.getLayerIndex=function(_e){var Le=this.layerIndexes[_e];return Le||(Le=this.layerIndexes[_e]=new i),Le},Je.prototype.getWorkerSource=function(_e,Le,Ce){var Pe=this;if(this.workerSources[_e]||(this.workerSources[_e]={}),this.workerSources[_e][Le]||(this.workerSources[_e][Le]={}),!this.workerSources[_e][Le][Ce]){var Xe={send:function(ut,kt,ft){Pe.actor.send(ut,kt,ft,_e)}};this.workerSources[_e][Le][Ce]=new this.workerSourceTypes[Le](Xe,this.getLayerIndex(_e),this.getAvailableImages(_e))}return this.workerSources[_e][Le][Ce]},Je.prototype.getDEMWorkerSource=function(_e,Le){return this.demWorkerSources[_e]||(this.demWorkerSources[_e]={}),this.demWorkerSources[_e][Le]||(this.demWorkerSources[_e][Le]=new d),this.demWorkerSources[_e][Le]},Je.prototype.enforceCacheSizeLimit=function(_e,Le){e.enforceCacheSizeLimit(Le)},typeof WorkerGlobalScope!="undefined"&&e.window!==void 0&&e.window instanceof WorkerGlobalScope&&(e.window.worker=new Je(e.window)),Je}),p(0,function(e){var f=e.createCommonjsModule(function(E){function z(ne){return!R(ne)}function R(ne){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var le,pe,ye=new Blob([""],{type:"text/javascript"}),Te=URL.createObjectURL(ye);try{pe=new Worker(Te),le=!0}catch(Ne){le=!1}return pe&&pe.terminate(),URL.revokeObjectURL(Te),le}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var le=document.createElement("canvas");le.width=le.height=1;var pe=le.getContext("2d");if(!pe)return!1;var ye=pe.getImageData(0,0,1,1);return ye&&ye.width===le.width}()?function(le){return U[le]===void 0&&(U[le]=function(pe){var ye=function(Ne){var qe=document.createElement("canvas"),tt=Object.create(z.webGLContextAttributes);return tt.failIfMajorPerformanceCaveat=Ne,qe.probablySupportsContext?qe.probablySupportsContext("webgl",tt)||qe.probablySupportsContext("experimental-webgl",tt):qe.supportsContext?qe.supportsContext("webgl",tt)||qe.supportsContext("experimental-webgl",tt):qe.getContext("webgl",tt)||qe.getContext("experimental-webgl",tt)}(pe);if(!ye)return!1;var Te=ye.createShader(ye.VERTEX_SHADER);return!Te||ye.isContextLost()?!1:(ye.shaderSource(Te,"void main() {}"),ye.compileShader(Te),ye.getShaderParameter(Te,ye.COMPILE_STATUS)===!0)}(le)),U[le]}(ne&&ne.failIfMajorPerformanceCaveat)?void 0:"insufficient WebGL support":"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support"}E.exports?E.exports=z:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=z,window.mapboxgl.notSupportedReason=R);var U={};z.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),u={create:function(E,z,R){var U=e.window.document.createElement(E);return z!==void 0&&(U.className=z),R&&R.appendChild(U),U},createNS:function(E,z){return e.window.document.createElementNS(E,z)}},i=e.window.document.documentElement.style;function s(E){if(!i)return E[0];for(var z=0;z<E.length;z++)if(E[z]in i)return E[z];return E[0]}var o,a=s(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);u.disableDrag=function(){i&&a&&(o=i[a],i[a]="none")},u.enableDrag=function(){i&&a&&(i[a]=o)};var c=s(["transform","WebkitTransform"]);u.setTransform=function(E,z){E.style[c]=z};var r=!1;try{var n=Object.defineProperty({},"passive",{get:function(){r=!0}});e.window.addEventListener("test",n,n),e.window.removeEventListener("test",n,n)}catch(E){r=!1}u.addEventListener=function(E,z,R,U){U===void 0&&(U={}),"passive"in U&&r?E.addEventListener(z,R,U):E.addEventListener(z,R,U.capture)},u.removeEventListener=function(E,z,R,U){U===void 0&&(U={}),"passive"in U&&r?E.removeEventListener(z,R,U):E.removeEventListener(z,R,U.capture)};var d=function(E){E.preventDefault(),E.stopPropagation(),e.window.removeEventListener("click",d,!0)};function l(E){var z=E.userImage;return z&&z.render&&z.render()?(E.data.replace(new Uint8Array(z.data.buffer)),!0):!1}u.suppressClick=function(){e.window.addEventListener("click",d,!0),e.window.setTimeout(function(){e.window.removeEventListener("click",d,!0)},0)},u.mousePos=function(E,z){var R=E.getBoundingClientRect();return new e.Point(z.clientX-R.left-E.clientLeft,z.clientY-R.top-E.clientTop)},u.touchPos=function(E,z){for(var R=E.getBoundingClientRect(),U=[],ne=0;ne<z.length;ne++)U.push(new e.Point(z[ne].clientX-R.left-E.clientLeft,z[ne].clientY-R.top-E.clientTop));return U},u.mouseButton=function(E){return e.window.InstallTrigger!==void 0&&E.button===2&&E.ctrlKey&&e.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:E.button},u.remove=function(E){E.parentNode&&E.parentNode.removeChild(E)};var y=function(E){function z(){E.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new e.RGBAImage({width:1,height:1}),this.dirty=!0}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.isLoaded=function(){return this.loaded},z.prototype.setLoaded=function(R){if(this.loaded!==R&&(this.loaded=R,R)){for(var U=0,ne=this.requestors;U<ne.length;U+=1){var le=ne[U],pe=le.ids,ye=le.callback;this._notify(pe,ye)}this.requestors=[]}},z.prototype.getImage=function(R){return this.images[R]},z.prototype.addImage=function(R,U){this._validate(R,U)&&(this.images[R]=U)},z.prototype._validate=function(R,U){var ne=!0;return this._validateStretch(U.stretchX,U.data&&U.data.width)||(this.fire(new e.ErrorEvent(new Error('Image "'+R+'" has invalid "stretchX" value'))),ne=!1),this._validateStretch(U.stretchY,U.data&&U.data.height)||(this.fire(new e.ErrorEvent(new Error('Image "'+R+'" has invalid "stretchY" value'))),ne=!1),this._validateContent(U.content,U)||(this.fire(new e.ErrorEvent(new Error('Image "'+R+'" has invalid "content" value'))),ne=!1),ne},z.prototype._validateStretch=function(R,U){if(!R)return!0;for(var ne=0,le=0,pe=R;le<pe.length;le+=1){var ye=pe[le];if(ye[0]<ne||ye[1]<ye[0]||U<ye[1])return!1;ne=ye[1]}return!0},z.prototype._validateContent=function(R,U){return!R||R.length===4&&!(R[0]<0||U.data.width<R[0])&&!(R[1]<0||U.data.height<R[1])&&!(R[2]<0||U.data.width<R[2])&&!(R[3]<0||U.data.height<R[3])&&!(R[2]<R[0])&&!(R[3]<R[1])},z.prototype.updateImage=function(R,U){var ne=this.images[R];U.version=ne.version+1,this.images[R]=U,this.updatedImages[R]=!0},z.prototype.removeImage=function(R){var U=this.images[R];delete this.images[R],delete this.patterns[R],U.userImage&&U.userImage.onRemove&&U.userImage.onRemove()},z.prototype.listImages=function(){return Object.keys(this.images)},z.prototype.getImages=function(R,U){var ne=!0;if(!this.isLoaded())for(var le=0,pe=R;le<pe.length;le+=1){var ye=pe[le];this.images[ye]||(ne=!1)}this.isLoaded()||ne?this._notify(R,U):this.requestors.push({ids:R,callback:U})},z.prototype._notify=function(R,U){for(var ne={},le=0,pe=R;le<pe.length;le+=1){var ye=pe[le];this.images[ye]||this.fire(new e.Event("styleimagemissing",{id:ye}));var Te=this.images[ye];Te?ne[ye]={data:Te.data.clone(),pixelRatio:Te.pixelRatio,sdf:Te.sdf,version:Te.version,stretchX:Te.stretchX,stretchY:Te.stretchY,content:Te.content,hasRenderCallback:Boolean(Te.userImage&&Te.userImage.render)}:e.warnOnce('Image "'+ye+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}U(null,ne)},z.prototype.getPixelSize=function(){var R=this.atlasImage;return{width:R.width,height:R.height}},z.prototype.getPattern=function(R){var U=this.patterns[R],ne=this.getImage(R);if(!ne)return null;if(U&&U.position.version===ne.version)return U.position;if(U)U.position.version=ne.version;else{var le={w:ne.data.width+2,h:ne.data.height+2,x:0,y:0},pe=new e.ImagePosition(le,ne);this.patterns[R]={bin:le,position:pe}}return this._updatePatternAtlas(),this.patterns[R].position},z.prototype.bind=function(R){var U=R.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new e.Texture(R,this.atlasImage,U.RGBA),this.atlasTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE)},z.prototype._updatePatternAtlas=function(){var R=[];for(var U in this.patterns)R.push(this.patterns[U].bin);var ne=e.potpack(R),le=ne.w,pe=ne.h,ye=this.atlasImage;for(var Te in ye.resize({width:le||1,height:pe||1}),this.patterns){var Ne=this.patterns[Te].bin,qe=Ne.x+1,tt=Ne.y+1,yt=this.images[Te].data,St=yt.width,_t=yt.height;e.RGBAImage.copy(yt,ye,{x:0,y:0},{x:qe,y:tt},{width:St,height:_t}),e.RGBAImage.copy(yt,ye,{x:0,y:_t-1},{x:qe,y:tt-1},{width:St,height:1}),e.RGBAImage.copy(yt,ye,{x:0,y:0},{x:qe,y:tt+_t},{width:St,height:1}),e.RGBAImage.copy(yt,ye,{x:St-1,y:0},{x:qe-1,y:tt},{width:1,height:_t}),e.RGBAImage.copy(yt,ye,{x:0,y:0},{x:qe+St,y:tt},{width:1,height:_t})}this.dirty=!0},z.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},z.prototype.dispatchRenderCallbacks=function(R){for(var U=0,ne=R;U<ne.length;U+=1){var le=ne[U];if(!this.callbackDispatchedThisFrame[le]){this.callbackDispatchedThisFrame[le]=!0;var pe=this.images[le];l(pe)&&this.updateImage(le,pe)}}},z}(e.Evented),v=T,_=T,x=1e20;function T(E,z,R,U,ne,le){this.fontSize=E||24,this.buffer=z===void 0?3:z,this.cutoff=U||.25,this.fontFamily=ne||"sans-serif",this.fontWeight=le||"normal",this.radius=R||8;var pe=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=pe,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(pe*pe),this.gridInner=new Float64Array(pe*pe),this.f=new Float64Array(pe),this.d=new Float64Array(pe),this.z=new Float64Array(pe+1),this.v=new Int16Array(pe),this.middle=Math.round(pe/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function A(E,z,R,U,ne,le,pe){for(var ye=0;ye<z;ye++){for(var Te=0;Te<R;Te++)U[Te]=E[Te*z+ye];for(S(U,ne,le,pe,R),Te=0;Te<R;Te++)E[Te*z+ye]=ne[Te]}for(Te=0;Te<R;Te++){for(ye=0;ye<z;ye++)U[ye]=E[Te*z+ye];for(S(U,ne,le,pe,z),ye=0;ye<z;ye++)E[Te*z+ye]=Math.sqrt(ne[ye])}}function S(E,z,R,U,ne){R[0]=0,U[0]=-x,U[1]=+x;for(var le=1,pe=0;le<ne;le++){for(var ye=(E[le]+le*le-(E[R[pe]]+R[pe]*R[pe]))/(2*le-2*R[pe]);ye<=U[pe];)pe--,ye=(E[le]+le*le-(E[R[pe]]+R[pe]*R[pe]))/(2*le-2*R[pe]);R[++pe]=le,U[pe]=ye,U[pe+1]=+x}for(le=0,pe=0;le<ne;le++){for(;U[pe+1]<le;)pe++;z[le]=(le-R[pe])*(le-R[pe])+E[R[pe]]}}T.prototype.draw=function(E){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(E,this.buffer,this.middle);for(var z=this.ctx.getImageData(0,0,this.size,this.size),R=new Uint8ClampedArray(this.size*this.size),U=0;U<this.size*this.size;U++){var ne=z.data[4*U+3]/255;this.gridOuter[U]=ne===1?0:ne===0?x:Math.pow(Math.max(0,.5-ne),2),this.gridInner[U]=ne===1?x:ne===0?0:Math.pow(Math.max(0,ne-.5),2)}for(A(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),A(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),U=0;U<this.size*this.size;U++){var le=this.gridOuter[U]-this.gridInner[U];R[U]=Math.max(0,Math.min(255,Math.round(255-255*(le/this.radius+this.cutoff))))}return R},v.default=_;var w=function(E,z){this.requestManager=E,this.localIdeographFontFamily=z,this.entries={}};w.prototype.setURL=function(E){this.url=E},w.prototype.getGlyphs=function(E,z){var R=this,U=[];for(var ne in E)for(var le=0,pe=E[ne];le<pe.length;le+=1){var ye=pe[le];U.push({stack:ne,id:ye})}e.asyncAll(U,function(Te,Ne){var qe=Te.stack,tt=Te.id,yt=R.entries[qe];yt||(yt=R.entries[qe]={glyphs:{},requests:{},ranges:{}});var St=yt.glyphs[tt];if(St===void 0){if(St=R._tinySDF(yt,qe,tt))return yt.glyphs[tt]=St,void Ne(null,{stack:qe,id:tt,glyph:St});var _t=Math.floor(tt/256);if(256*_t>65535)Ne(new Error("glyphs > 65535 not supported"));else if(yt.ranges[_t])Ne(null,{stack:qe,id:tt,glyph:St});else{var Tt=yt.requests[_t];Tt||(Tt=yt.requests[_t]=[],w.loadGlyphRange(qe,_t,R.url,R.requestManager,function(gt,Dt){if(Dt){for(var Ot in Dt)R._doesCharSupportLocalGlyph(+Ot)||(yt.glyphs[+Ot]=Dt[+Ot]);yt.ranges[_t]=!0}for(var Bt=0,er=Tt;Bt<er.length;Bt+=1)(0,er[Bt])(gt,Dt);delete yt.requests[_t]})),Tt.push(function(gt,Dt){gt?Ne(gt):Dt&&Ne(null,{stack:qe,id:tt,glyph:Dt[tt]||null})})}}else Ne(null,{stack:qe,id:tt,glyph:St})},function(Te,Ne){if(Te)z(Te);else if(Ne){for(var qe={},tt=0,yt=Ne;tt<yt.length;tt+=1){var St=yt[tt],_t=St.stack,Tt=St.id,gt=St.glyph;(qe[_t]||(qe[_t]={}))[Tt]=gt&&{id:gt.id,bitmap:gt.bitmap.clone(),metrics:gt.metrics}}z(null,qe)}})},w.prototype._doesCharSupportLocalGlyph=function(E){return!!this.localIdeographFontFamily&&(e.isChar["CJK Unified Ideographs"](E)||e.isChar["Hangul Syllables"](E)||e.isChar.Hiragana(E)||e.isChar.Katakana(E))},w.prototype._tinySDF=function(E,z,R){var U=this.localIdeographFontFamily;if(U&&this._doesCharSupportLocalGlyph(R)){var ne=E.tinySDF;if(!ne){var le="400";/bold/i.test(z)?le="900":/medium/i.test(z)?le="500":/light/i.test(z)&&(le="200"),ne=E.tinySDF=new w.TinySDF(24,3,8,.25,U,le)}return{id:R,bitmap:new e.AlphaImage({width:30,height:30},ne.draw(String.fromCharCode(R))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},w.loadGlyphRange=function(E,z,R,U,ne){var le=256*z,pe=le+255,ye=U.transformRequest(U.normalizeGlyphsURL(R).replace("{fontstack}",E).replace("{range}",le+"-"+pe),e.ResourceType.Glyphs);e.getArrayBuffer(ye,function(Te,Ne){if(Te)ne(Te);else if(Ne){for(var qe={},tt=0,yt=e.parseGlyphPBF(Ne);tt<yt.length;tt+=1){var St=yt[tt];qe[St.id]=St}ne(null,qe)}})},w.TinySDF=v;var L=function(){this.specification=e.styleSpec.light.position};L.prototype.possiblyEvaluate=function(E,z){return e.sphericalToCartesian(E.expression.evaluate(z))},L.prototype.interpolate=function(E,z,R){return{x:e.number(E.x,z.x,R),y:e.number(E.y,z.y,R),z:e.number(E.z,z.z,R)}};var k=new e.Properties({anchor:new e.DataConstantProperty(e.styleSpec.light.anchor),position:new L,color:new e.DataConstantProperty(e.styleSpec.light.color),intensity:new e.DataConstantProperty(e.styleSpec.light.intensity)}),C=function(E){function z(R){E.call(this),this._transitionable=new e.Transitionable(k),this.setLight(R),this._transitioning=this._transitionable.untransitioned()}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.getLight=function(){return this._transitionable.serialize()},z.prototype.setLight=function(R,U){if(U===void 0&&(U={}),!this._validate(e.validateLight,R,U))for(var ne in R){var le=R[ne];e.endsWith(ne,"-transition")?this._transitionable.setTransition(ne.slice(0,-"-transition".length),le):this._transitionable.setValue(ne,le)}},z.prototype.updateTransitions=function(R){this._transitioning=this._transitionable.transitioned(R,this._transitioning)},z.prototype.hasTransition=function(){return this._transitioning.hasTransition()},z.prototype.recalculate=function(R){this.properties=this._transitioning.possiblyEvaluate(R)},z.prototype._validate=function(R,U,ne){return(!ne||ne.validate!==!1)&&e.emitValidationErrors(this,R.call(e.validateStyle,e.extend({value:U,style:{glyphs:!0,sprite:!0},styleSpec:e.styleSpec})))},z}(e.Evented),M=function(E,z){this.width=E,this.height=z,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};M.prototype.getDash=function(E,z){var R=E.join(",")+String(z);return this.dashEntry[R]||(this.dashEntry[R]=this.addDash(E,z)),this.dashEntry[R]},M.prototype.getDashRanges=function(E,z,R){var U=[],ne=E.length%2==1?-E[E.length-1]*R:0,le=E[0]*R,pe=!0;U.push({left:ne,right:le,isDash:pe,zeroLength:E[0]===0});for(var ye=E[0],Te=1;Te<E.length;Te++){pe=!pe;var Ne=E[Te];ne=ye*R,le=(ye+=Ne)*R,U.push({left:ne,right:le,isDash:pe,zeroLength:Ne===0})}return U},M.prototype.addRoundDash=function(E,z,R){for(var U=z/2,ne=-R;ne<=R;ne++)for(var le=this.nextRow+R+ne,pe=this.width*le,ye=0,Te=E[ye],Ne=0;Ne<this.width;Ne++){Ne/Te.right>1&&(Te=E[++ye]);var qe=Math.abs(Ne-Te.left),tt=Math.abs(Ne-Te.right),yt=Math.min(qe,tt),St=void 0,_t=ne/R*(U+1);if(Te.isDash){var Tt=U-Math.abs(_t);St=Math.sqrt(yt*yt+Tt*Tt)}else St=U-Math.sqrt(yt*yt+_t*_t);this.data[pe+Ne]=Math.max(0,Math.min(255,St+128))}},M.prototype.addRegularDash=function(E){for(var z=E.length-1;z>=0;--z){var R=E[z],U=E[z+1];R.zeroLength?E.splice(z,1):U&&U.isDash===R.isDash&&(U.left=R.left,E.splice(z,1))}var ne=E[0],le=E[E.length-1];ne.isDash===le.isDash&&(ne.left=le.left-this.width,le.right=ne.right+this.width);for(var pe=this.width*this.nextRow,ye=0,Te=E[ye],Ne=0;Ne<this.width;Ne++){Ne/Te.right>1&&(Te=E[++ye]);var qe=Math.abs(Ne-Te.left),tt=Math.abs(Ne-Te.right),yt=Math.min(qe,tt),St=Te.isDash?yt:-yt;this.data[pe+Ne]=Math.max(0,Math.min(255,St+128))}},M.prototype.addDash=function(E,z){var R=z?7:0,U=2*R+1;if(this.nextRow+U>this.height)return e.warnOnce("LineAtlas out of space"),null;for(var ne=0,le=0;le<E.length;le++)ne+=E[le];if(ne!==0){var pe=this.width/ne,ye=this.getDashRanges(E,this.width,pe);z?this.addRoundDash(ye,pe,R):this.addRegularDash(ye)}var Te={y:(this.nextRow+R+.5)/this.height,height:2*R/this.height,width:ne};return this.nextRow+=U,this.dirty=!0,Te},M.prototype.bind=function(E){var z=E.gl;this.texture?(z.bindTexture(z.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,z.texSubImage2D(z.TEXTURE_2D,0,0,0,this.width,this.height,z.ALPHA,z.UNSIGNED_BYTE,this.data))):(this.texture=z.createTexture(),z.bindTexture(z.TEXTURE_2D,this.texture),z.texParameteri(z.TEXTURE_2D,z.TEXTURE_WRAP_S,z.REPEAT),z.texParameteri(z.TEXTURE_2D,z.TEXTURE_WRAP_T,z.REPEAT),z.texParameteri(z.TEXTURE_2D,z.TEXTURE_MIN_FILTER,z.LINEAR),z.texParameteri(z.TEXTURE_2D,z.TEXTURE_MAG_FILTER,z.LINEAR),z.texImage2D(z.TEXTURE_2D,0,z.ALPHA,this.width,this.height,0,z.ALPHA,z.UNSIGNED_BYTE,this.data))};var P=function E(z,R){this.workerPool=z,this.actors=[],this.currentActor=0,this.id=e.uniqueId();for(var U=this.workerPool.acquire(this.id),ne=0;ne<U.length;ne++){var le=U[ne],pe=new E.Actor(le,R,this.id);pe.name="Worker "+ne,this.actors.push(pe)}};function O(E,z,R){var U=function(ne,le){if(ne)return R(ne);if(le){var pe=e.pick(e.extend(le,E),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);le.vector_layers&&(pe.vectorLayers=le.vector_layers,pe.vectorLayerIds=pe.vectorLayers.map(function(ye){return ye.id})),pe.tiles=z.canonicalizeTileset(pe,E.url),R(null,pe)}};return E.url?e.getJSON(z.transformRequest(z.normalizeSourceURL(E.url),e.ResourceType.Source),U):e.browser.frame(function(){return U(null,E)})}P.prototype.broadcast=function(E,z,R){R=R||function(){},e.asyncAll(this.actors,function(U,ne){U.send(E,z,ne)},R)},P.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},P.prototype.remove=function(){this.actors.forEach(function(E){E.remove()}),this.actors=[],this.workerPool.release(this.id)},P.Actor=e.Actor;var F=function(E,z,R){this.bounds=e.LngLatBounds.convert(this.validateBounds(E)),this.minzoom=z||0,this.maxzoom=R||24};F.prototype.validateBounds=function(E){return Array.isArray(E)&&E.length===4?[Math.max(-180,E[0]),Math.max(-90,E[1]),Math.min(180,E[2]),Math.min(90,E[3])]:[-180,-90,180,90]},F.prototype.contains=function(E){var z=Math.pow(2,E.z),R=Math.floor(e.mercatorXfromLng(this.bounds.getWest())*z),U=Math.floor(e.mercatorYfromLat(this.bounds.getNorth())*z),ne=Math.ceil(e.mercatorXfromLng(this.bounds.getEast())*z),le=Math.ceil(e.mercatorYfromLat(this.bounds.getSouth())*z);return E.x>=R&&E.x<ne&&E.y>=U&&E.y<le};var j=function(E){function z(R,U,ne,le){if(E.call(this),this.id=R,this.dispatcher=ne,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,e.extend(this,e.pick(U,["url","scheme","tileSize","promoteId"])),this._options=e.extend({type:"vector"},U),this._collectResourceTiming=U.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(le)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.load=function(){var R=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=O(this._options,this.map._requestManager,function(U,ne){R._tileJSONRequest=null,R._loaded=!0,U?R.fire(new e.ErrorEvent(U)):ne&&(e.extend(R,ne),ne.bounds&&(R.tileBounds=new F(ne.bounds,R.minzoom,R.maxzoom)),e.postTurnstileEvent(ne.tiles,R.map._requestManager._customAccessToken),e.postMapLoadEvent(ne.tiles,R.map._getMapId(),R.map._requestManager._skuToken,R.map._requestManager._customAccessToken),R.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),R.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))})},z.prototype.loaded=function(){return this._loaded},z.prototype.hasTile=function(R){return!this.tileBounds||this.tileBounds.contains(R.canonical)},z.prototype.onAdd=function(R){this.map=R,this.load()},z.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},z.prototype.serialize=function(){return e.extend({},this._options)},z.prototype.loadTile=function(R,U){var ne=this.map._requestManager.normalizeTileURL(R.tileID.canonical.url(this.tiles,this.scheme)),le={request:this.map._requestManager.transformRequest(ne,e.ResourceType.Tile),uid:R.uid,tileID:R.tileID,zoom:R.tileID.overscaledZ,tileSize:this.tileSize*R.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function pe(ye,Te){return delete R.request,R.aborted?U(null):ye&&ye.status!==404?U(ye):(Te&&Te.resourceTiming&&(R.resourceTiming=Te.resourceTiming),this.map._refreshExpiredTiles&&Te&&R.setExpiryData(Te),R.loadVectorData(Te,this.map.painter),e.cacheEntryPossiblyAdded(this.dispatcher),U(null),void(R.reloadCallback&&(this.loadTile(R,R.reloadCallback),R.reloadCallback=null)))}le.request.collectResourceTiming=this._collectResourceTiming,R.actor&&R.state!=="expired"?R.state==="loading"?R.reloadCallback=U:R.request=R.actor.send("reloadTile",le,pe.bind(this)):(R.actor=this.dispatcher.getActor(),R.request=R.actor.send("loadTile",le,pe.bind(this)))},z.prototype.abortTile=function(R){R.request&&(R.request.cancel(),delete R.request),R.actor&&R.actor.send("abortTile",{uid:R.uid,type:this.type,source:this.id},void 0)},z.prototype.unloadTile=function(R){R.unloadVectorData(),R.actor&&R.actor.send("removeTile",{uid:R.uid,type:this.type,source:this.id},void 0)},z.prototype.hasTransition=function(){return!1},z}(e.Evented),W=function(E){function z(R,U,ne,le){E.call(this),this.id=R,this.dispatcher=ne,this.setEventedParent(le),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=e.extend({type:"raster"},U),e.extend(this,e.pick(U,["url","scheme","tileSize"]))}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.load=function(){var R=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=O(this._options,this.map._requestManager,function(U,ne){R._tileJSONRequest=null,R._loaded=!0,U?R.fire(new e.ErrorEvent(U)):ne&&(e.extend(R,ne),ne.bounds&&(R.tileBounds=new F(ne.bounds,R.minzoom,R.maxzoom)),e.postTurnstileEvent(ne.tiles),e.postMapLoadEvent(ne.tiles,R.map._getMapId(),R.map._requestManager._skuToken),R.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),R.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))})},z.prototype.loaded=function(){return this._loaded},z.prototype.onAdd=function(R){this.map=R,this.load()},z.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},z.prototype.serialize=function(){return e.extend({},this._options)},z.prototype.hasTile=function(R){return!this.tileBounds||this.tileBounds.contains(R.canonical)},z.prototype.loadTile=function(R,U){var ne=this,le=this.map._requestManager.normalizeTileURL(R.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);R.request=e.getImage(this.map._requestManager.transformRequest(le,e.ResourceType.Tile),function(pe,ye){if(delete R.request,R.aborted)R.state="unloaded",U(null);else if(pe)R.state="errored",U(pe);else if(ye){ne.map._refreshExpiredTiles&&R.setExpiryData(ye),delete ye.cacheControl,delete ye.expires;var Te=ne.map.painter.context,Ne=Te.gl;R.texture=ne.map.painter.getTileTexture(ye.width),R.texture?R.texture.update(ye,{useMipmap:!0}):(R.texture=new e.Texture(Te,ye,Ne.RGBA,{useMipmap:!0}),R.texture.bind(Ne.LINEAR,Ne.CLAMP_TO_EDGE,Ne.LINEAR_MIPMAP_NEAREST),Te.extTextureFilterAnisotropic&&Ne.texParameterf(Ne.TEXTURE_2D,Te.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Te.extTextureFilterAnisotropicMax)),R.state="loaded",e.cacheEntryPossiblyAdded(ne.dispatcher),U(null)}})},z.prototype.abortTile=function(R,U){R.request&&(R.request.cancel(),delete R.request),U()},z.prototype.unloadTile=function(R,U){R.texture&&this.map.painter.saveTileTexture(R.texture),U()},z.prototype.hasTransition=function(){return!1},z}(e.Evented),Z=function(E){function z(R,U,ne,le){E.call(this,R,U,ne,le),this.type="raster-dem",this.maxzoom=22,this._options=e.extend({type:"raster-dem"},U),this.encoding=U.encoding||"mapbox"}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},z.prototype.loadTile=function(R,U){var ne=this.map._requestManager.normalizeTileURL(R.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function le(pe,ye){pe&&(R.state="errored",U(pe)),ye&&(R.dem=ye,R.needsHillshadePrepare=!0,R.state="loaded",U(null))}R.request=e.getImage(this.map._requestManager.transformRequest(ne,e.ResourceType.Tile),function(pe,ye){if(delete R.request,R.aborted)R.state="unloaded",U(null);else if(pe)R.state="errored",U(pe);else if(ye){this.map._refreshExpiredTiles&&R.setExpiryData(ye),delete ye.cacheControl,delete ye.expires;var Te=e.window.ImageBitmap&&ye instanceof e.window.ImageBitmap&&e.offscreenCanvasSupported()?ye:e.browser.getImageData(ye,1),Ne={uid:R.uid,coord:R.tileID,source:this.id,rawImageData:Te,encoding:this.encoding};R.actor&&R.state!=="expired"||(R.actor=this.dispatcher.getActor(),R.actor.send("loadDEMTile",Ne,le.bind(this)))}}.bind(this)),R.neighboringTiles=this._getNeighboringTiles(R.tileID)},z.prototype._getNeighboringTiles=function(R){var U=R.canonical,ne=Math.pow(2,U.z),le=(U.x-1+ne)%ne,pe=U.x===0?R.wrap-1:R.wrap,ye=(U.x+1+ne)%ne,Te=U.x+1===ne?R.wrap+1:R.wrap,Ne={};return Ne[new e.OverscaledTileID(R.overscaledZ,pe,U.z,le,U.y).key]={backfilled:!1},Ne[new e.OverscaledTileID(R.overscaledZ,Te,U.z,ye,U.y).key]={backfilled:!1},U.y>0&&(Ne[new e.OverscaledTileID(R.overscaledZ,pe,U.z,le,U.y-1).key]={backfilled:!1},Ne[new e.OverscaledTileID(R.overscaledZ,R.wrap,U.z,U.x,U.y-1).key]={backfilled:!1},Ne[new e.OverscaledTileID(R.overscaledZ,Te,U.z,ye,U.y-1).key]={backfilled:!1}),U.y+1<ne&&(Ne[new e.OverscaledTileID(R.overscaledZ,pe,U.z,le,U.y+1).key]={backfilled:!1},Ne[new e.OverscaledTileID(R.overscaledZ,R.wrap,U.z,U.x,U.y+1).key]={backfilled:!1},Ne[new e.OverscaledTileID(R.overscaledZ,Te,U.z,ye,U.y+1).key]={backfilled:!1}),Ne},z.prototype.unloadTile=function(R){R.demTexture&&this.map.painter.saveTileTexture(R.demTexture),R.fbo&&(R.fbo.destroy(),delete R.fbo),R.dem&&delete R.dem,delete R.neighboringTiles,R.state="unloaded",R.actor&&R.actor.send("removeDEMTile",{uid:R.uid,source:this.id})},z}(W),Q=function(E){function z(R,U,ne,le){E.call(this),this.id=R,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=ne.getActor(),this.setEventedParent(le),this._data=U.data,this._options=e.extend({},U),this._collectResourceTiming=U.collectResourceTiming,this._resourceTiming=[],U.maxzoom!==void 0&&(this.maxzoom=U.maxzoom),U.type&&(this.type=U.type),U.attribution&&(this.attribution=U.attribution),this.promoteId=U.promoteId;var pe=e.EXTENT/this.tileSize;this.workerOptions=e.extend({source:this.id,cluster:U.cluster||!1,geojsonVtOptions:{buffer:(U.buffer!==void 0?U.buffer:128)*pe,tolerance:(U.tolerance!==void 0?U.tolerance:.375)*pe,extent:e.EXTENT,maxZoom:this.maxzoom,lineMetrics:U.lineMetrics||!1,generateId:U.generateId||!1},superclusterOptions:{maxZoom:U.clusterMaxZoom!==void 0?Math.min(U.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:e.EXTENT,radius:(U.clusterRadius||50)*pe,log:!1,generateId:U.generateId||!1},clusterProperties:U.clusterProperties},U.workerOptions)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.load=function(){var R=this;this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(U){if(U)R.fire(new e.ErrorEvent(U));else{var ne={dataType:"source",sourceDataType:"metadata"};R._collectResourceTiming&&R._resourceTiming&&R._resourceTiming.length>0&&(ne.resourceTiming=R._resourceTiming,R._resourceTiming=[]),R.fire(new e.Event("data",ne))}})},z.prototype.onAdd=function(R){this.map=R,this.load()},z.prototype.setData=function(R){var U=this;return this._data=R,this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(ne){if(ne)U.fire(new e.ErrorEvent(ne));else{var le={dataType:"source",sourceDataType:"content"};U._collectResourceTiming&&U._resourceTiming&&U._resourceTiming.length>0&&(le.resourceTiming=U._resourceTiming,U._resourceTiming=[]),U.fire(new e.Event("data",le))}}),this},z.prototype.getClusterExpansionZoom=function(R,U){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:R,source:this.id},U),this},z.prototype.getClusterChildren=function(R,U){return this.actor.send("geojson.getClusterChildren",{clusterId:R,source:this.id},U),this},z.prototype.getClusterLeaves=function(R,U,ne,le){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:R,limit:U,offset:ne},le),this},z.prototype._updateWorkerData=function(R){var U=this;this._loaded=!1;var ne=e.extend({},this.workerOptions),le=this._data;typeof le=="string"?(ne.request=this.map._requestManager.transformRequest(e.browser.resolveURL(le),e.ResourceType.Source),ne.request.collectResourceTiming=this._collectResourceTiming):ne.data=JSON.stringify(le),this.actor.send(this.type+".loadData",ne,function(pe,ye){U._removed||ye&&ye.abandoned||(U._loaded=!0,ye&&ye.resourceTiming&&ye.resourceTiming[U.id]&&(U._resourceTiming=ye.resourceTiming[U.id].slice(0)),U.actor.send(U.type+".coalesce",{source:ne.source},null),R(pe))})},z.prototype.loaded=function(){return this._loaded},z.prototype.loadTile=function(R,U){var ne=this,le=R.actor?"reloadTile":"loadTile";R.actor=this.actor;var pe={type:this.type,uid:R.uid,tileID:R.tileID,zoom:R.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};R.request=this.actor.send(le,pe,function(ye,Te){return delete R.request,R.unloadVectorData(),R.aborted?U(null):ye?U(ye):(R.loadVectorData(Te,ne.map.painter,le==="reloadTile"),U(null))})},z.prototype.abortTile=function(R){R.request&&(R.request.cancel(),delete R.request),R.aborted=!0},z.prototype.unloadTile=function(R){R.unloadVectorData(),this.actor.send("removeTile",{uid:R.uid,type:this.type,source:this.id})},z.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},z.prototype.serialize=function(){return e.extend({},this._options,{type:this.type,data:this._data})},z.prototype.hasTransition=function(){return!1},z}(e.Evented),X=e.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),G=function(E){function z(R,U,ne,le){E.call(this),this.id=R,this.dispatcher=ne,this.coordinates=U.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(le),this.options=U}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.load=function(R,U){var ne=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this.url=this.options.url,e.getImage(this.map._requestManager.transformRequest(this.url,e.ResourceType.Image),function(le,pe){ne._loaded=!0,le?ne.fire(new e.ErrorEvent(le)):pe&&(ne.image=pe,R&&(ne.coordinates=R),U&&U(),ne._finishLoading())})},z.prototype.loaded=function(){return this._loaded},z.prototype.updateImage=function(R){var U=this;return this.image&&R.url?(this.options.url=R.url,this.load(R.coordinates,function(){U.texture=null}),this):this},z.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})))},z.prototype.onAdd=function(R){this.map=R,this.load()},z.prototype.setCoordinates=function(R){var U=this;this.coordinates=R;var ne=R.map(e.MercatorCoordinate.fromLngLat);this.tileID=function(pe){for(var ye=1/0,Te=1/0,Ne=-1/0,qe=-1/0,tt=0,yt=pe;tt<yt.length;tt+=1){var St=yt[tt];ye=Math.min(ye,St.x),Te=Math.min(Te,St.y),Ne=Math.max(Ne,St.x),qe=Math.max(qe,St.y)}var _t=Ne-ye,Tt=qe-Te,gt=Math.max(_t,Tt),Dt=Math.max(0,Math.floor(-Math.log(gt)/Math.LN2)),Ot=Math.pow(2,Dt);return new e.CanonicalTileID(Dt,Math.floor((ye+Ne)/2*Ot),Math.floor((Te+qe)/2*Ot))}(ne),this.minzoom=this.maxzoom=this.tileID.z;var le=ne.map(function(pe){return U.tileID.getTilePoint(pe)._round()});return this._boundsArray=new e.StructArrayLayout4i8,this._boundsArray.emplaceBack(le[0].x,le[0].y,0,0),this._boundsArray.emplaceBack(le[1].x,le[1].y,e.EXTENT,0),this._boundsArray.emplaceBack(le[3].x,le[3].y,0,e.EXTENT),this._boundsArray.emplaceBack(le[2].x,le[2].y,e.EXTENT,e.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})),this},z.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var R=this.map.painter.context,U=R.gl;for(var ne in this.boundsBuffer||(this.boundsBuffer=R.createVertexBuffer(this._boundsArray,X.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new e.Texture(R,this.image,U.RGBA),this.texture.bind(U.LINEAR,U.CLAMP_TO_EDGE)),this.tiles){var le=this.tiles[ne];le.state!=="loaded"&&(le.state="loaded",le.texture=this.texture)}}},z.prototype.loadTile=function(R,U){this.tileID&&this.tileID.equals(R.tileID.canonical)?(this.tiles[String(R.tileID.wrap)]=R,R.buckets={},U(null)):(R.state="errored",U(null))},z.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},z.prototype.hasTransition=function(){return!1},z}(e.Evented),Y=function(E){function z(R,U,ne,le){E.call(this,R,U,ne,le),this.roundZoom=!0,this.type="video",this.options=U}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.load=function(){var R=this;this._loaded=!1;var U=this.options;this.urls=[];for(var ne=0,le=U.urls;ne<le.length;ne+=1){var pe=le[ne];this.urls.push(this.map._requestManager.transformRequest(pe,e.ResourceType.Source).url)}e.getVideo(this.urls,function(ye,Te){R._loaded=!0,ye?R.fire(new e.ErrorEvent(ye)):Te&&(R.video=Te,R.video.loop=!0,R.video.addEventListener("playing",function(){R.map.triggerRepaint()}),R.map&&R.video.play(),R._finishLoading())})},z.prototype.pause=function(){this.video&&this.video.pause()},z.prototype.play=function(){this.video&&this.video.play()},z.prototype.seek=function(R){if(this.video){var U=this.video.seekable;R<U.start(0)||R>U.end(0)?this.fire(new e.ErrorEvent(new e.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+U.start(0)+" and "+U.end(0)+"-second mark."))):this.video.currentTime=R}},z.prototype.getVideo=function(){return this.video},z.prototype.onAdd=function(R){this.map||(this.map=R,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},z.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var R=this.map.painter.context,U=R.gl;for(var ne in this.boundsBuffer||(this.boundsBuffer=R.createVertexBuffer(this._boundsArray,X.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(U.LINEAR,U.CLAMP_TO_EDGE),U.texSubImage2D(U.TEXTURE_2D,0,0,0,U.RGBA,U.UNSIGNED_BYTE,this.video)):(this.texture=new e.Texture(R,this.video,U.RGBA),this.texture.bind(U.LINEAR,U.CLAMP_TO_EDGE)),this.tiles){var le=this.tiles[ne];le.state!=="loaded"&&(le.state="loaded",le.texture=this.texture)}}},z.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},z.prototype.hasTransition=function(){return this.video&&!this.video.paused},z}(G),K=function(E){function z(R,U,ne,le){E.call(this,R,U,ne,le),U.coordinates?Array.isArray(U.coordinates)&&U.coordinates.length===4&&!U.coordinates.some(function(pe){return!Array.isArray(pe)||pe.length!==2||pe.some(function(ye){return typeof ye!="number"})})||this.fire(new e.ErrorEvent(new e.ValidationError("sources."+R,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+R,null,'missing required property "coordinates"'))),U.animate&&typeof U.animate!="boolean"&&this.fire(new e.ErrorEvent(new e.ValidationError("sources."+R,null,'optional "animate" property must be a boolean value'))),U.canvas?typeof U.canvas=="string"||U.canvas instanceof e.window.HTMLCanvasElement||this.fire(new e.ErrorEvent(new e.ValidationError("sources."+R,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+R,null,'missing required property "canvas"'))),this.options=U,this.animate=U.animate===void 0||U.animate}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof e.window.HTMLCanvasElement?this.options.canvas:e.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new e.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},z.prototype.getCanvas=function(){return this.canvas},z.prototype.onAdd=function(R){this.map=R,this.load(),this.canvas&&this.animate&&this.play()},z.prototype.onRemove=function(){this.pause()},z.prototype.prepare=function(){var R=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,R=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,R=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var U=this.map.painter.context,ne=U.gl;for(var le in this.boundsBuffer||(this.boundsBuffer=U.createVertexBuffer(this._boundsArray,X.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(R||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new e.Texture(U,this.canvas,ne.RGBA,{premultiply:!0}),this.tiles){var pe=this.tiles[le];pe.state!=="loaded"&&(pe.state="loaded",pe.texture=this.texture)}}},z.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},z.prototype.hasTransition=function(){return this._playing},z.prototype._hasInvalidDimensions=function(){for(var R=0,U=[this.canvas.width,this.canvas.height];R<U.length;R+=1){var ne=U[R];if(isNaN(ne)||ne<=0)return!0}return!1},z}(G),D={vector:j,raster:W,"raster-dem":Z,geojson:Q,video:Y,image:G,canvas:K};function B(E,z){var R=e.identity([]);return e.translate(R,R,[1,1,0]),e.scale(R,R,[.5*E.width,.5*E.height,1]),e.multiply(R,R,E.calculatePosMatrix(z.toUnwrapped()))}function q(E,z,R,U,ne,le){var pe=function(Tt,gt,Dt){if(Tt)for(var Ot=0,Bt=Tt;Ot<Bt.length;Ot+=1){var er=gt[Bt[Ot]];if(er&&er.source===Dt&&er.type==="fill-extrusion")return!0}else for(var ur in gt){var Tr=gt[ur];if(Tr.source===Dt&&Tr.type==="fill-extrusion")return!0}return!1}(ne&&ne.layers,z,E.id),ye=le.maxPitchScaleFactor(),Te=E.tilesIn(U,ye,pe);Te.sort(ee);for(var Ne=[],qe=0,tt=Te;qe<tt.length;qe+=1){var yt=tt[qe];Ne.push({wrappedTileID:yt.tileID.wrapped().key,queryResults:yt.tile.queryRenderedFeatures(z,R,E._state,yt.queryGeometry,yt.cameraQueryGeometry,yt.scale,ne,le,ye,B(E.transform,yt.tileID))})}var St=function(Tt){for(var gt={},Dt={},Ot=0,Bt=Tt;Ot<Bt.length;Ot+=1){var er=Bt[Ot],ur=er.queryResults,Tr=er.wrappedTileID,wr=Dt[Tr]=Dt[Tr]||{};for(var Xr in ur)for(var Wr=ur[Xr],un=wr[Xr]=wr[Xr]||{},an=gt[Xr]=gt[Xr]||[],Nn=0,Yn=Wr;Nn<Yn.length;Nn+=1){var sa=Yn[Nn];un[sa.featureIndex]||(un[sa.featureIndex]=!0,an.push(sa))}}return gt}(Ne);for(var _t in St)St[_t].forEach(function(Tt){var gt=Tt.feature,Dt=E.getFeatureState(gt.layer["source-layer"],gt.id);gt.source=gt.layer.source,gt.layer["source-layer"]&&(gt.sourceLayer=gt.layer["source-layer"]),gt.state=Dt});return St}function ee(E,z){var R=E.tileID,U=z.tileID;return R.overscaledZ-U.overscaledZ||R.canonical.y-U.canonical.y||R.wrap-U.wrap||R.canonical.x-U.canonical.x}var J=function(E,z){this.max=E,this.onRemove=z,this.reset()};J.prototype.reset=function(){for(var E in this.data)for(var z=0,R=this.data[E];z<R.length;z+=1){var U=R[z];U.timeout&&clearTimeout(U.timeout),this.onRemove(U.value)}return this.data={},this.order=[],this},J.prototype.add=function(E,z,R){var U=this,ne=E.wrapped().key;this.data[ne]===void 0&&(this.data[ne]=[]);var le={value:z,timeout:void 0};if(R!==void 0&&(le.timeout=setTimeout(function(){U.remove(E,le)},R)),this.data[ne].push(le),this.order.push(ne),this.order.length>this.max){var pe=this._getAndRemoveByKey(this.order[0]);pe&&this.onRemove(pe)}return this},J.prototype.has=function(E){return E.wrapped().key in this.data},J.prototype.getAndRemove=function(E){return this.has(E)?this._getAndRemoveByKey(E.wrapped().key):null},J.prototype._getAndRemoveByKey=function(E){var z=this.data[E].shift();return z.timeout&&clearTimeout(z.timeout),this.data[E].length===0&&delete this.data[E],this.order.splice(this.order.indexOf(E),1),z.value},J.prototype.getByKey=function(E){var z=this.data[E];return z?z[0].value:null},J.prototype.get=function(E){return this.has(E)?this.data[E.wrapped().key][0].value:null},J.prototype.remove=function(E,z){if(!this.has(E))return this;var R=E.wrapped().key,U=z===void 0?0:this.data[R].indexOf(z),ne=this.data[R][U];return this.data[R].splice(U,1),ne.timeout&&clearTimeout(ne.timeout),this.data[R].length===0&&delete this.data[R],this.onRemove(ne.value),this.order.splice(this.order.indexOf(R),1),this},J.prototype.setMaxSize=function(E){for(this.max=E;this.order.length>this.max;){var z=this._getAndRemoveByKey(this.order[0]);z&&this.onRemove(z)}return this},J.prototype.filter=function(E){var z=[];for(var R in this.data)for(var U=0,ne=this.data[R];U<ne.length;U+=1){var le=ne[U];E(le.value)||z.push(le)}for(var pe=0,ye=z;pe<ye.length;pe+=1){var Te=ye[pe];this.remove(Te.value.tileID,Te)}};var $=function(E,z,R){this.context=E;var U=E.gl;this.buffer=U.createBuffer(),this.dynamicDraw=Boolean(R),this.context.unbindVAO(),E.bindElementBuffer.set(this.buffer),U.bufferData(U.ELEMENT_ARRAY_BUFFER,z.arrayBuffer,this.dynamicDraw?U.DYNAMIC_DRAW:U.STATIC_DRAW),this.dynamicDraw||delete z.arrayBuffer};$.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},$.prototype.updateData=function(E){var z=this.context.gl;this.context.unbindVAO(),this.bind(),z.bufferSubData(z.ELEMENT_ARRAY_BUFFER,0,E.arrayBuffer)},$.prototype.destroy=function(){var E=this.context.gl;this.buffer&&(E.deleteBuffer(this.buffer),delete this.buffer)};var te={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},ie=function(E,z,R,U){this.length=z.length,this.attributes=R,this.itemSize=z.bytesPerElement,this.dynamicDraw=U,this.context=E;var ne=E.gl;this.buffer=ne.createBuffer(),E.bindVertexBuffer.set(this.buffer),ne.bufferData(ne.ARRAY_BUFFER,z.arrayBuffer,this.dynamicDraw?ne.DYNAMIC_DRAW:ne.STATIC_DRAW),this.dynamicDraw||delete z.arrayBuffer};ie.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},ie.prototype.updateData=function(E){var z=this.context.gl;this.bind(),z.bufferSubData(z.ARRAY_BUFFER,0,E.arrayBuffer)},ie.prototype.enableAttributes=function(E,z){for(var R=0;R<this.attributes.length;R++){var U=this.attributes[R],ne=z.attributes[U.name];ne!==void 0&&E.enableVertexAttribArray(ne)}},ie.prototype.setVertexAttribPointers=function(E,z,R){for(var U=0;U<this.attributes.length;U++){var ne=this.attributes[U],le=z.attributes[ne.name];le!==void 0&&E.vertexAttribPointer(le,ne.components,E[te[ne.type]],!1,this.itemSize,ne.offset+this.itemSize*(R||0))}},ie.prototype.destroy=function(){var E=this.context.gl;this.buffer&&(E.deleteBuffer(this.buffer),delete this.buffer)};var ae=function(E){this.gl=E.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};ae.prototype.get=function(){return this.current},ae.prototype.set=function(E){},ae.prototype.getDefault=function(){return this.default},ae.prototype.setDefault=function(){this.set(this.default)};var he=function(E){function z(){E.apply(this,arguments)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return e.Color.transparent},z.prototype.set=function(R){var U=this.current;(R.r!==U.r||R.g!==U.g||R.b!==U.b||R.a!==U.a||this.dirty)&&(this.gl.clearColor(R.r,R.g,R.b,R.a),this.current=R,this.dirty=!1)},z}(ae),se=function(E){function z(){E.apply(this,arguments)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return 1},z.prototype.set=function(R){(R!==this.current||this.dirty)&&(this.gl.clearDepth(R),this.current=R,this.dirty=!1)},z}(ae),de=function(E){function z(){E.apply(this,arguments)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return 0},z.prototype.set=function(R){(R!==this.current||this.dirty)&&(this.gl.clearStencil(R),this.current=R,this.dirty=!1)},z}(ae),ce=function(E){function z(){E.apply(this,arguments)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return[!0,!0,!0,!0]},z.prototype.set=function(R){var U=this.current;(R[0]!==U[0]||R[1]!==U[1]||R[2]!==U[2]||R[3]!==U[3]||this.dirty)&&(this.gl.colorMask(R[0],R[1],R[2],R[3]),this.current=R,this.dirty=!1)},z}(ae),ve=function(E){function z(){E.apply(this,arguments)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return!0},z.prototype.set=function(R){(R!==this.current||this.dirty)&&(this.gl.depthMask(R),this.current=R,this.dirty=!1)},z}(ae),ke=function(E){function z(){E.apply(this,arguments)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return 255},z.prototype.set=function(R){(R!==this.current||this.dirty)&&(this.gl.stencilMask(R),this.current=R,this.dirty=!1)},z}(ae),Ee=function(E){function z(){E.apply(this,arguments)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},z.prototype.set=function(R){var U=this.current;(R.func!==U.func||R.ref!==U.ref||R.mask!==U.mask||this.dirty)&&(this.gl.stencilFunc(R.func,R.ref,R.mask),this.current=R,this.dirty=!1)},z}(ae),be=function(E){function z(){E.apply(this,arguments)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){var R=this.gl;return[R.KEEP,R.KEEP,R.KEEP]},z.prototype.set=function(R){var U=this.current;(R[0]!==U[0]||R[1]!==U[1]||R[2]!==U[2]||this.dirty)&&(this.gl.stencilOp(R[0],R[1],R[2]),this.current=R,this.dirty=!1)},z}(ae),xe=function(E){function z(){E.apply(this,arguments)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return!1},z.prototype.set=function(R){if(R!==this.current||this.dirty){var U=this.gl;R?U.enable(U.STENCIL_TEST):U.disable(U.STENCIL_TEST),this.current=R,this.dirty=!1}},z}(ae),ue=function(E){function z(){E.apply(this,arguments)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return[0,1]},z.prototype.set=function(R){var U=this.current;(R[0]!==U[0]||R[1]!==U[1]||this.dirty)&&(this.gl.depthRange(R[0],R[1]),this.current=R,this.dirty=!1)},z}(ae),me=function(E){function z(){E.apply(this,arguments)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return!1},z.prototype.set=function(R){if(R!==this.current||this.dirty){var U=this.gl;R?U.enable(U.DEPTH_TEST):U.disable(U.DEPTH_TEST),this.current=R,this.dirty=!1}},z}(ae),we=function(E){function z(){E.apply(this,arguments)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return this.gl.LESS},z.prototype.set=function(R){(R!==this.current||this.dirty)&&(this.gl.depthFunc(R),this.current=R,this.dirty=!1)},z}(ae),Me=function(E){function z(){E.apply(this,arguments)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return!1},z.prototype.set=function(R){if(R!==this.current||this.dirty){var U=this.gl;R?U.enable(U.BLEND):U.disable(U.BLEND),this.current=R,this.dirty=!1}},z}(ae),Se=function(E){function z(){E.apply(this,arguments)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){var R=this.gl;return[R.ONE,R.ZERO]},z.prototype.set=function(R){var U=this.current;(R[0]!==U[0]||R[1]!==U[1]||this.dirty)&&(this.gl.blendFunc(R[0],R[1]),this.current=R,this.dirty=!1)},z}(ae),De=function(E){function z(){E.apply(this,arguments)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return e.Color.transparent},z.prototype.set=function(R){var U=this.current;(R.r!==U.r||R.g!==U.g||R.b!==U.b||R.a!==U.a||this.dirty)&&(this.gl.blendColor(R.r,R.g,R.b,R.a),this.current=R,this.dirty=!1)},z}(ae),Fe=function(E){function z(){E.apply(this,arguments)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return this.gl.FUNC_ADD},z.prototype.set=function(R){(R!==this.current||this.dirty)&&(this.gl.blendEquation(R),this.current=R,this.dirty=!1)},z}(ae),Ye=function(E){function z(){E.apply(this,arguments)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return!1},z.prototype.set=function(R){if(R!==this.current||this.dirty){var U=this.gl;R?U.enable(U.CULL_FACE):U.disable(U.CULL_FACE),this.current=R,this.dirty=!1}},z}(ae),et=function(E){function z(){E.apply(this,arguments)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return this.gl.BACK},z.prototype.set=function(R){(R!==this.current||this.dirty)&&(this.gl.cullFace(R),this.current=R,this.dirty=!1)},z}(ae),Oe=function(E){function z(){E.apply(this,arguments)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return this.gl.CCW},z.prototype.set=function(R){(R!==this.current||this.dirty)&&(this.gl.frontFace(R),this.current=R,this.dirty=!1)},z}(ae),je=function(E){function z(){E.apply(this,arguments)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return null},z.prototype.set=function(R){(R!==this.current||this.dirty)&&(this.gl.useProgram(R),this.current=R,this.dirty=!1)},z}(ae),We=function(E){function z(){E.apply(this,arguments)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return this.gl.TEXTURE0},z.prototype.set=function(R){(R!==this.current||this.dirty)&&(this.gl.activeTexture(R),this.current=R,this.dirty=!1)},z}(ae),Ge=function(E){function z(){E.apply(this,arguments)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){var R=this.gl;return[0,0,R.drawingBufferWidth,R.drawingBufferHeight]},z.prototype.set=function(R){var U=this.current;(R[0]!==U[0]||R[1]!==U[1]||R[2]!==U[2]||R[3]!==U[3]||this.dirty)&&(this.gl.viewport(R[0],R[1],R[2],R[3]),this.current=R,this.dirty=!1)},z}(ae),Qe=function(E){function z(){E.apply(this,arguments)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return null},z.prototype.set=function(R){if(R!==this.current||this.dirty){var U=this.gl;U.bindFramebuffer(U.FRAMEBUFFER,R),this.current=R,this.dirty=!1}},z}(ae),it=function(E){function z(){E.apply(this,arguments)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return null},z.prototype.set=function(R){if(R!==this.current||this.dirty){var U=this.gl;U.bindRenderbuffer(U.RENDERBUFFER,R),this.current=R,this.dirty=!1}},z}(ae),lt=function(E){function z(){E.apply(this,arguments)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return null},z.prototype.set=function(R){if(R!==this.current||this.dirty){var U=this.gl;U.bindTexture(U.TEXTURE_2D,R),this.current=R,this.dirty=!1}},z}(ae),Lt=function(E){function z(){E.apply(this,arguments)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return null},z.prototype.set=function(R){if(R!==this.current||this.dirty){var U=this.gl;U.bindBuffer(U.ARRAY_BUFFER,R),this.current=R,this.dirty=!1}},z}(ae),wt=function(E){function z(){E.apply(this,arguments)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return null},z.prototype.set=function(R){var U=this.gl;U.bindBuffer(U.ELEMENT_ARRAY_BUFFER,R),this.current=R,this.dirty=!1},z}(ae),rt=function(E){function z(R){E.call(this,R),this.vao=R.extVertexArrayObject}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return null},z.prototype.set=function(R){this.vao&&(R!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(R),this.current=R,this.dirty=!1)},z}(ae),$e=function(E){function z(){E.apply(this,arguments)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return 4},z.prototype.set=function(R){if(R!==this.current||this.dirty){var U=this.gl;U.pixelStorei(U.UNPACK_ALIGNMENT,R),this.current=R,this.dirty=!1}},z}(ae),xt=function(E){function z(){E.apply(this,arguments)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return!1},z.prototype.set=function(R){if(R!==this.current||this.dirty){var U=this.gl;U.pixelStorei(U.UNPACK_PREMULTIPLY_ALPHA_WEBGL,R),this.current=R,this.dirty=!1}},z}(ae),Qt=function(E){function z(){E.apply(this,arguments)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return!1},z.prototype.set=function(R){if(R!==this.current||this.dirty){var U=this.gl;U.pixelStorei(U.UNPACK_FLIP_Y_WEBGL,R),this.current=R,this.dirty=!1}},z}(ae),$t=function(E){function z(R,U){E.call(this,R),this.context=R,this.parent=U}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return null},z}(ae),Ue=function(E){function z(){E.apply(this,arguments)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.setDirty=function(){this.dirty=!0},z.prototype.set=function(R){if(R!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var U=this.gl;U.framebufferTexture2D(U.FRAMEBUFFER,U.COLOR_ATTACHMENT0,U.TEXTURE_2D,R,0),this.current=R,this.dirty=!1}},z}($t),He=function(E){function z(){E.apply(this,arguments)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.set=function(R){if(R!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var U=this.gl;U.framebufferRenderbuffer(U.FRAMEBUFFER,U.DEPTH_ATTACHMENT,U.RENDERBUFFER,R),this.current=R,this.dirty=!1}},z}($t),Be=function(E,z,R,U){this.context=E,this.width=z,this.height=R;var ne=E.gl,le=this.framebuffer=ne.createFramebuffer();this.colorAttachment=new Ue(E,le),U&&(this.depthAttachment=new He(E,le))};Be.prototype.destroy=function(){var E=this.context.gl,z=this.colorAttachment.get();if(z&&E.deleteTexture(z),this.depthAttachment){var R=this.depthAttachment.get();R&&E.deleteRenderbuffer(R)}E.deleteFramebuffer(this.framebuffer)};var Je=function(E,z,R){this.func=E,this.mask=z,this.range=R};Je.ReadOnly=!1,Je.ReadWrite=!0,Je.disabled=new Je(519,Je.ReadOnly,[0,1]);var _e=function(E,z,R,U,ne,le){this.test=E,this.ref=z,this.mask=R,this.fail=U,this.depthFail=ne,this.pass=le};_e.disabled=new _e({func:519,mask:0},0,0,7680,7680,7680);var Le=function(E,z,R){this.blendFunction=E,this.blendColor=z,this.mask=R};Le.disabled=new Le(Le.Replace=[1,0],e.Color.transparent,[!1,!1,!1,!1]),Le.unblended=new Le(Le.Replace,e.Color.transparent,[!0,!0,!0,!0]),Le.alphaBlended=new Le([1,771],e.Color.transparent,[!0,!0,!0,!0]);var Ce=function(E,z,R){this.enable=E,this.mode=z,this.frontFace=R};Ce.disabled=new Ce(!1,1029,2305),Ce.backCCW=new Ce(!0,1029,2305);var Pe=function(E){this.gl=E,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new he(this),this.clearDepth=new se(this),this.clearStencil=new de(this),this.colorMask=new ce(this),this.depthMask=new ve(this),this.stencilMask=new ke(this),this.stencilFunc=new Ee(this),this.stencilOp=new be(this),this.stencilTest=new xe(this),this.depthRange=new ue(this),this.depthTest=new me(this),this.depthFunc=new we(this),this.blend=new Me(this),this.blendFunc=new Se(this),this.blendColor=new De(this),this.blendEquation=new Fe(this),this.cullFace=new Ye(this),this.cullFaceSide=new et(this),this.frontFace=new Oe(this),this.program=new je(this),this.activeTexture=new We(this),this.viewport=new Ge(this),this.bindFramebuffer=new Qe(this),this.bindRenderbuffer=new it(this),this.bindTexture=new lt(this),this.bindVertexBuffer=new Lt(this),this.bindElementBuffer=new wt(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new rt(this),this.pixelStoreUnpack=new $e(this),this.pixelStoreUnpackPremultiplyAlpha=new xt(this),this.pixelStoreUnpackFlipY=new Qt(this),this.extTextureFilterAnisotropic=E.getExtension("EXT_texture_filter_anisotropic")||E.getExtension("MOZ_EXT_texture_filter_anisotropic")||E.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=E.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=E.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(E.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=E.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=E.getExtension("EXT_disjoint_timer_query")};Pe.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},Pe.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},Pe.prototype.createIndexBuffer=function(E,z){return new $(this,E,z)},Pe.prototype.createVertexBuffer=function(E,z,R){return new ie(this,E,z,R)},Pe.prototype.createRenderbuffer=function(E,z,R){var U=this.gl,ne=U.createRenderbuffer();return this.bindRenderbuffer.set(ne),U.renderbufferStorage(U.RENDERBUFFER,E,z,R),this.bindRenderbuffer.set(null),ne},Pe.prototype.createFramebuffer=function(E,z,R){return new Be(this,E,z,R)},Pe.prototype.clear=function(E){var z=E.color,R=E.depth,U=this.gl,ne=0;z&&(ne|=U.COLOR_BUFFER_BIT,this.clearColor.set(z),this.colorMask.set([!0,!0,!0,!0])),R!==void 0&&(ne|=U.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(R),this.depthMask.set(!0)),U.clear(ne)},Pe.prototype.setCullFace=function(E){E.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(E.mode),this.frontFace.set(E.frontFace))},Pe.prototype.setDepthMode=function(E){E.func!==this.gl.ALWAYS||E.mask?(this.depthTest.set(!0),this.depthFunc.set(E.func),this.depthMask.set(E.mask),this.depthRange.set(E.range)):this.depthTest.set(!1)},Pe.prototype.setStencilMode=function(E){E.test.func!==this.gl.ALWAYS||E.mask?(this.stencilTest.set(!0),this.stencilMask.set(E.mask),this.stencilOp.set([E.fail,E.depthFail,E.pass]),this.stencilFunc.set({func:E.test.func,ref:E.ref,mask:E.test.mask})):this.stencilTest.set(!1)},Pe.prototype.setColorMode=function(E){e.deepEqual(E.blendFunction,Le.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(E.blendFunction),this.blendColor.set(E.blendColor)),this.colorMask.set(E.mask)},Pe.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Xe=function(E){function z(R,U,ne){var le=this;E.call(this),this.id=R,this.dispatcher=ne,this.on("data",function(pe){pe.dataType==="source"&&pe.sourceDataType==="metadata"&&(le._sourceLoaded=!0),le._sourceLoaded&&!le._paused&&pe.dataType==="source"&&pe.sourceDataType==="content"&&(le.reload(),le.transform&&le.update(le.transform))}),this.on("error",function(){le._sourceErrored=!0}),this._source=function(pe,ye,Te,Ne){var qe=new D[ye.type](pe,ye,Te,Ne);if(qe.id!==pe)throw new Error("Expected Source id to be "+pe+" instead of "+qe.id);return e.bindAll(["load","abort","unload","serialize","prepare"],qe),qe}(R,U,ne,this),this._tiles={},this._cache=new J(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new e.SourceFeatureState}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.onAdd=function(R){this.map=R,this._maxTileCacheSize=R?R._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(R)},z.prototype.onRemove=function(R){this._source&&this._source.onRemove&&this._source.onRemove(R)},z.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var R in this._tiles){var U=this._tiles[R];if(U.state!=="loaded"&&U.state!=="errored")return!1}return!0},z.prototype.getSource=function(){return this._source},z.prototype.pause=function(){this._paused=!0},z.prototype.resume=function(){if(this._paused){var R=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,R&&this.reload(),this.transform&&this.update(this.transform)}},z.prototype._loadTile=function(R,U){return this._source.loadTile(R,U)},z.prototype._unloadTile=function(R){if(this._source.unloadTile)return this._source.unloadTile(R,function(){})},z.prototype._abortTile=function(R){if(this._source.abortTile)return this._source.abortTile(R,function(){})},z.prototype.serialize=function(){return this._source.serialize()},z.prototype.prepare=function(R){for(var U in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var ne=this._tiles[U];ne.upload(R),ne.prepare(this.map.style.imageManager)}},z.prototype.getIds=function(){return e.values(this._tiles).map(function(R){return R.tileID}).sort(ut).map(function(R){return R.key})},z.prototype.getRenderableIds=function(R){var U=this,ne=[];for(var le in this._tiles)this._isIdRenderable(le,R)&&ne.push(this._tiles[le]);return R?ne.sort(function(pe,ye){var Te=pe.tileID,Ne=ye.tileID,qe=new e.Point(Te.canonical.x,Te.canonical.y)._rotate(U.transform.angle),tt=new e.Point(Ne.canonical.x,Ne.canonical.y)._rotate(U.transform.angle);return Te.overscaledZ-Ne.overscaledZ||tt.y-qe.y||tt.x-qe.x}).map(function(pe){return pe.tileID.key}):ne.map(function(pe){return pe.tileID}).sort(ut).map(function(pe){return pe.key})},z.prototype.hasRenderableParent=function(R){var U=this.findLoadedParent(R,0);return!!U&&this._isIdRenderable(U.tileID.key)},z.prototype._isIdRenderable=function(R,U){return this._tiles[R]&&this._tiles[R].hasData()&&!this._coveredTiles[R]&&(U||!this._tiles[R].holdingForFade())},z.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var R in this._cache.reset(),this._tiles)this._tiles[R].state!=="errored"&&this._reloadTile(R,"reloading")},z.prototype._reloadTile=function(R,U){var ne=this._tiles[R];ne&&(ne.state!=="loading"&&(ne.state=U),this._loadTile(ne,this._tileLoaded.bind(this,ne,R,U)))},z.prototype._tileLoaded=function(R,U,ne,le){if(le)return R.state="errored",void(le.status!==404?this._source.fire(new e.ErrorEvent(le,{tile:R})):this.update(this.transform));R.timeAdded=e.browser.now(),ne==="expired"&&(R.refreshedUponExpiration=!0),this._setTileReloadTimer(U,R),this.getSource().type==="raster-dem"&&R.dem&&this._backfillDEM(R),this._state.initializeTileState(R,this.map?this.map.painter:null),this._source.fire(new e.Event("data",{dataType:"source",tile:R,coord:R.tileID}))},z.prototype._backfillDEM=function(R){for(var U=this.getRenderableIds(),ne=0;ne<U.length;ne++){var le=U[ne];if(R.neighboringTiles&&R.neighboringTiles[le]){var pe=this.getTileByID(le);ye(R,pe),ye(pe,R)}}function ye(Te,Ne){Te.needsHillshadePrepare=!0;var qe=Ne.tileID.canonical.x-Te.tileID.canonical.x,tt=Ne.tileID.canonical.y-Te.tileID.canonical.y,yt=Math.pow(2,Te.tileID.canonical.z),St=Ne.tileID.key;qe===0&&tt===0||Math.abs(tt)>1||(Math.abs(qe)>1&&(Math.abs(qe+yt)===1?qe+=yt:Math.abs(qe-yt)===1&&(qe-=yt)),Ne.dem&&Te.dem&&(Te.dem.backfillBorder(Ne.dem,qe,tt),Te.neighboringTiles&&Te.neighboringTiles[St]&&(Te.neighboringTiles[St].backfilled=!0)))}},z.prototype.getTile=function(R){return this.getTileByID(R.key)},z.prototype.getTileByID=function(R){return this._tiles[R]},z.prototype._retainLoadedChildren=function(R,U,ne,le){for(var pe in this._tiles){var ye=this._tiles[pe];if(!(le[pe]||!ye.hasData()||ye.tileID.overscaledZ<=U||ye.tileID.overscaledZ>ne)){for(var Te=ye.tileID;ye&&ye.tileID.overscaledZ>U+1;){var Ne=ye.tileID.scaledTo(ye.tileID.overscaledZ-1);(ye=this._tiles[Ne.key])&&ye.hasData()&&(Te=Ne)}for(var qe=Te;qe.overscaledZ>U;)if(R[(qe=qe.scaledTo(qe.overscaledZ-1)).key]){le[Te.key]=Te;break}}}},z.prototype.findLoadedParent=function(R,U){if(R.key in this._loadedParentTiles){var ne=this._loadedParentTiles[R.key];return ne&&ne.tileID.overscaledZ>=U?ne:null}for(var le=R.overscaledZ-1;le>=U;le--){var pe=R.scaledTo(le),ye=this._getLoadedTile(pe);if(ye)return ye}},z.prototype._getLoadedTile=function(R){var U=this._tiles[R.key];return U&&U.hasData()?U:this._cache.getByKey(R.wrapped().key)},z.prototype.updateCacheSize=function(R){var U=(Math.ceil(R.width/this._source.tileSize)+1)*(Math.ceil(R.height/this._source.tileSize)+1),ne=Math.floor(5*U),le=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,ne):ne;this._cache.setMaxSize(le)},z.prototype.handleWrapJump=function(R){var U=(R-(this._prevLng===void 0?R:this._prevLng))/360,ne=Math.round(U);if(this._prevLng=R,ne){var le={};for(var pe in this._tiles){var ye=this._tiles[pe];ye.tileID=ye.tileID.unwrapTo(ye.tileID.wrap+ne),le[ye.tileID.key]=ye}for(var Te in this._tiles=le,this._timers)clearTimeout(this._timers[Te]),delete this._timers[Te];for(var Ne in this._tiles){var qe=this._tiles[Ne];this._setTileReloadTimer(Ne,qe)}}},z.prototype.update=function(R){var U=this;if(this.transform=R,this._sourceLoaded&&!this._paused){var ne;this.updateCacheSize(R),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?ne=R.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(wr){return new e.OverscaledTileID(wr.canonical.z,wr.wrap,wr.canonical.z,wr.canonical.x,wr.canonical.y)}):(ne=R.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(ne=ne.filter(function(wr){return U._source.hasTile(wr)}))):ne=[];var le=R.coveringZoomLevel(this._source),pe=Math.max(le-z.maxOverzooming,this._source.minzoom),ye=Math.max(le+z.maxUnderzooming,this._source.minzoom),Te=this._updateRetainedTiles(ne,le);if(kt(this._source.type)){for(var Ne={},qe={},tt=0,yt=Object.keys(Te);tt<yt.length;tt+=1){var St=yt[tt],_t=Te[St],Tt=this._tiles[St];if(Tt&&!(Tt.fadeEndTime&&Tt.fadeEndTime<=e.browser.now())){var gt=this.findLoadedParent(_t,pe);gt&&(this._addTile(gt.tileID),Ne[gt.tileID.key]=gt.tileID),qe[St]=_t}}for(var Dt in this._retainLoadedChildren(qe,le,ye,Te),Ne)Te[Dt]||(this._coveredTiles[Dt]=!0,Te[Dt]=Ne[Dt])}for(var Ot in Te)this._tiles[Ot].clearFadeHold();for(var Bt=0,er=e.keysDifference(this._tiles,Te);Bt<er.length;Bt+=1){var ur=er[Bt],Tr=this._tiles[ur];Tr.hasSymbolBuckets&&!Tr.holdingForFade()?Tr.setHoldDuration(this.map._fadeDuration):Tr.hasSymbolBuckets&&!Tr.symbolFadeFinished()||this._removeTile(ur)}this._updateLoadedParentTileCache()}},z.prototype.releaseSymbolFadeTiles=function(){for(var R in this._tiles)this._tiles[R].holdingForFade()&&this._removeTile(R)},z.prototype._updateRetainedTiles=function(R,U){for(var ne={},le={},pe=Math.max(U-z.maxOverzooming,this._source.minzoom),ye=Math.max(U+z.maxUnderzooming,this._source.minzoom),Te={},Ne=0,qe=R;Ne<qe.length;Ne+=1){var tt=qe[Ne],yt=this._addTile(tt);ne[tt.key]=tt,yt.hasData()||U<this._source.maxzoom&&(Te[tt.key]=tt)}this._retainLoadedChildren(Te,U,ye,ne);for(var St=0,_t=R;St<_t.length;St+=1){var Tt=_t[St],gt=this._tiles[Tt.key];if(!gt.hasData()){if(U+1>this._source.maxzoom){var Dt=Tt.children(this._source.maxzoom)[0],Ot=this.getTile(Dt);if(Ot&&Ot.hasData()){ne[Dt.key]=Dt;continue}}else{var Bt=Tt.children(this._source.maxzoom);if(ne[Bt[0].key]&&ne[Bt[1].key]&&ne[Bt[2].key]&&ne[Bt[3].key])continue}for(var er=gt.wasRequested(),ur=Tt.overscaledZ-1;ur>=pe;--ur){var Tr=Tt.scaledTo(ur);if(le[Tr.key]||(le[Tr.key]=!0,!(gt=this.getTile(Tr))&&er&&(gt=this._addTile(Tr)),gt&&(ne[Tr.key]=Tr,er=gt.wasRequested(),gt.hasData())))break}}}return ne},z.prototype._updateLoadedParentTileCache=function(){for(var R in this._loadedParentTiles={},this._tiles){for(var U=[],ne=void 0,le=this._tiles[R].tileID;le.overscaledZ>0;){if(le.key in this._loadedParentTiles){ne=this._loadedParentTiles[le.key];break}U.push(le.key);var pe=le.scaledTo(le.overscaledZ-1);if(ne=this._getLoadedTile(pe))break;le=pe}for(var ye=0,Te=U;ye<Te.length;ye+=1){var Ne=Te[ye];this._loadedParentTiles[Ne]=ne}}},z.prototype._addTile=function(R){var U=this._tiles[R.key];if(U)return U;(U=this._cache.getAndRemove(R))&&(this._setTileReloadTimer(R.key,U),U.tileID=R,this._state.initializeTileState(U,this.map?this.map.painter:null),this._cacheTimers[R.key]&&(clearTimeout(this._cacheTimers[R.key]),delete this._cacheTimers[R.key],this._setTileReloadTimer(R.key,U)));var ne=Boolean(U);return ne||(U=new e.Tile(R,this._source.tileSize*R.overscaleFactor()),this._loadTile(U,this._tileLoaded.bind(this,U,R.key,U.state))),U?(U.uses++,this._tiles[R.key]=U,ne||this._source.fire(new e.Event("dataloading",{tile:U,coord:U.tileID,dataType:"source"})),U):null},z.prototype._setTileReloadTimer=function(R,U){var ne=this;R in this._timers&&(clearTimeout(this._timers[R]),delete this._timers[R]);var le=U.getExpiryTimeout();le&&(this._timers[R]=setTimeout(function(){ne._reloadTile(R,"expired"),delete ne._timers[R]},le))},z.prototype._removeTile=function(R){var U=this._tiles[R];U&&(U.uses--,delete this._tiles[R],this._timers[R]&&(clearTimeout(this._timers[R]),delete this._timers[R]),U.uses>0||(U.hasData()&&U.state!=="reloading"?this._cache.add(U.tileID,U,U.getExpiryTimeout()):(U.aborted=!0,this._abortTile(U),this._unloadTile(U))))},z.prototype.clearTiles=function(){for(var R in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(R);this._cache.reset()},z.prototype.tilesIn=function(R,U,ne){var le=this,pe=[],ye=this.transform;if(!ye)return pe;for(var Te=ne?ye.getCameraQueryGeometry(R):R,Ne=R.map(function(ur){return ye.pointCoordinate(ur)}),qe=Te.map(function(ur){return ye.pointCoordinate(ur)}),tt=this.getIds(),yt=1/0,St=1/0,_t=-1/0,Tt=-1/0,gt=0,Dt=qe;gt<Dt.length;gt+=1){var Ot=Dt[gt];yt=Math.min(yt,Ot.x),St=Math.min(St,Ot.y),_t=Math.max(_t,Ot.x),Tt=Math.max(Tt,Ot.y)}for(var Bt=function(ur){var Tr=le._tiles[tt[ur]];if(!Tr.holdingForFade()){var wr=Tr.tileID,Xr=Math.pow(2,ye.zoom-Tr.tileID.overscaledZ),Wr=U*Tr.queryPadding*e.EXTENT/Tr.tileSize/Xr,un=[wr.getTilePoint(new e.MercatorCoordinate(yt,St)),wr.getTilePoint(new e.MercatorCoordinate(_t,Tt))];if(un[0].x-Wr<e.EXTENT&&un[0].y-Wr<e.EXTENT&&un[1].x+Wr>=0&&un[1].y+Wr>=0){var an=Ne.map(function(Yn){return wr.getTilePoint(Yn)}),Nn=qe.map(function(Yn){return wr.getTilePoint(Yn)});pe.push({tile:Tr,tileID:wr,queryGeometry:an,cameraQueryGeometry:Nn,scale:Xr})}}},er=0;er<tt.length;er++)Bt(er);return pe},z.prototype.getVisibleCoordinates=function(R){for(var U=this,ne=this.getRenderableIds(R).map(function(Te){return U._tiles[Te].tileID}),le=0,pe=ne;le<pe.length;le+=1){var ye=pe[le];ye.posMatrix=this.transform.calculatePosMatrix(ye.toUnwrapped())}return ne},z.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(kt(this._source.type))for(var R in this._tiles){var U=this._tiles[R];if(U.fadeEndTime!==void 0&&U.fadeEndTime>=e.browser.now())return!0}return!1},z.prototype.setFeatureState=function(R,U,ne){R=R||"_geojsonTileLayer",this._state.updateState(R,U,ne)},z.prototype.removeFeatureState=function(R,U,ne){R=R||"_geojsonTileLayer",this._state.removeFeatureState(R,U,ne)},z.prototype.getFeatureState=function(R,U){return R=R||"_geojsonTileLayer",this._state.getState(R,U)},z.prototype.setDependencies=function(R,U,ne){var le=this._tiles[R];le&&le.setDependencies(U,ne)},z.prototype.reloadTilesForDependencies=function(R,U){for(var ne in this._tiles)this._tiles[ne].hasDependency(R,U)&&this._reloadTile(ne,"reloading");this._cache.filter(function(le){return!le.hasDependency(R,U)})},z}(e.Evented);function ut(E,z){var R=Math.abs(2*E.wrap)-+(E.wrap<0),U=Math.abs(2*z.wrap)-+(z.wrap<0);return E.overscaledZ-z.overscaledZ||U-R||z.canonical.y-E.canonical.y||z.canonical.x-E.canonical.x}function kt(E){return E==="raster"||E==="image"||E==="video"}function ft(){return new e.window.Worker(oe.workerUrl)}Xe.maxOverzooming=10,Xe.maxUnderzooming=3;var Et="mapboxgl_preloaded_worker_pool",mt=function(){this.active={}};mt.prototype.acquire=function(E){if(!this.workers)for(this.workers=[];this.workers.length<mt.workerCount;)this.workers.push(new ft);return this.active[E]=!0,this.workers.slice()},mt.prototype.release=function(E){delete this.active[E],this.numActive()===0&&(this.workers.forEach(function(z){z.terminate()}),this.workers=null)},mt.prototype.isPreloaded=function(){return!!this.active[Et]},mt.prototype.numActive=function(){return Object.keys(this.active).length};var It,vt=Math.floor(e.browser.hardwareConcurrency/2);function nt(){return It||(It=new mt),It}function At(E,z){var R={};for(var U in E)U!=="ref"&&(R[U]=E[U]);return e.refProperties.forEach(function(ne){ne in z&&(R[ne]=z[ne])}),R}function Ft(E){E=E.slice();for(var z=Object.create(null),R=0;R<E.length;R++)z[E[R].id]=E[R];for(var U=0;U<E.length;U++)"ref"in E[U]&&(E[U]=At(E[U],z[E[U].ref]));return E}mt.workerCount=Math.max(Math.min(vt,6),1);var Nt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Kt(E,z,R){R.push({command:Nt.addSource,args:[E,z[E]]})}function Ie(E,z,R){z.push({command:Nt.removeSource,args:[E]}),R[E]=!0}function ot(E,z,R,U){Ie(E,R,U),Kt(E,z,R)}function bt(E,z,R){var U;for(U in E[R])if(E[R].hasOwnProperty(U)&&U!=="data"&&!e.deepEqual(E[R][U],z[R][U]))return!1;for(U in z[R])if(z[R].hasOwnProperty(U)&&U!=="data"&&!e.deepEqual(E[R][U],z[R][U]))return!1;return!0}function Pt(E,z,R,U,ne,le){var pe;for(pe in z=z||{},E=E||{})E.hasOwnProperty(pe)&&(e.deepEqual(E[pe],z[pe])||R.push({command:le,args:[U,pe,z[pe],ne]}));for(pe in z)z.hasOwnProperty(pe)&&!E.hasOwnProperty(pe)&&(e.deepEqual(E[pe],z[pe])||R.push({command:le,args:[U,pe,z[pe],ne]}))}function Vt(E){return E.id}function nr(E,z){return E[z.id]=z,E}function Yt(E,z){if(!E)return[{command:Nt.setStyle,args:[z]}];var R=[];try{if(!e.deepEqual(E.version,z.version))return[{command:Nt.setStyle,args:[z]}];e.deepEqual(E.center,z.center)||R.push({command:Nt.setCenter,args:[z.center]}),e.deepEqual(E.zoom,z.zoom)||R.push({command:Nt.setZoom,args:[z.zoom]}),e.deepEqual(E.bearing,z.bearing)||R.push({command:Nt.setBearing,args:[z.bearing]}),e.deepEqual(E.pitch,z.pitch)||R.push({command:Nt.setPitch,args:[z.pitch]}),e.deepEqual(E.sprite,z.sprite)||R.push({command:Nt.setSprite,args:[z.sprite]}),e.deepEqual(E.glyphs,z.glyphs)||R.push({command:Nt.setGlyphs,args:[z.glyphs]}),e.deepEqual(E.transition,z.transition)||R.push({command:Nt.setTransition,args:[z.transition]}),e.deepEqual(E.light,z.light)||R.push({command:Nt.setLight,args:[z.light]});var U={},ne=[];(function(pe,ye,Te,Ne){var qe;for(qe in ye=ye||{},pe=pe||{})pe.hasOwnProperty(qe)&&(ye.hasOwnProperty(qe)||Ie(qe,Te,Ne));for(qe in ye)ye.hasOwnProperty(qe)&&(pe.hasOwnProperty(qe)?e.deepEqual(pe[qe],ye[qe])||(pe[qe].type==="geojson"&&ye[qe].type==="geojson"&&bt(pe,ye,qe)?Te.push({command:Nt.setGeoJSONSourceData,args:[qe,ye[qe].data]}):ot(qe,ye,Te,Ne)):Kt(qe,ye,Te))})(E.sources,z.sources,ne,U);var le=[];E.layers&&E.layers.forEach(function(pe){U[pe.source]?R.push({command:Nt.removeLayer,args:[pe.id]}):le.push(pe)}),R=R.concat(ne),function(pe,ye,Te){ye=ye||[];var Ne,qe,tt,yt,St,_t,Tt,gt=(pe=pe||[]).map(Vt),Dt=ye.map(Vt),Ot=pe.reduce(nr,{}),Bt=ye.reduce(nr,{}),er=gt.slice(),ur=Object.create(null);for(Ne=0,qe=0;Ne<gt.length;Ne++)tt=gt[Ne],Bt.hasOwnProperty(tt)?qe++:(Te.push({command:Nt.removeLayer,args:[tt]}),er.splice(er.indexOf(tt,qe),1));for(Ne=0,qe=0;Ne<Dt.length;Ne++)tt=Dt[Dt.length-1-Ne],er[er.length-1-Ne]!==tt&&(Ot.hasOwnProperty(tt)?(Te.push({command:Nt.removeLayer,args:[tt]}),er.splice(er.lastIndexOf(tt,er.length-qe),1)):qe++,_t=er[er.length-Ne],Te.push({command:Nt.addLayer,args:[Bt[tt],_t]}),er.splice(er.length-Ne,0,tt),ur[tt]=!0);for(Ne=0;Ne<Dt.length;Ne++)if(yt=Ot[tt=Dt[Ne]],St=Bt[tt],!ur[tt]&&!e.deepEqual(yt,St))if(e.deepEqual(yt.source,St.source)&&e.deepEqual(yt["source-layer"],St["source-layer"])&&e.deepEqual(yt.type,St.type)){for(Tt in Pt(yt.layout,St.layout,Te,tt,null,Nt.setLayoutProperty),Pt(yt.paint,St.paint,Te,tt,null,Nt.setPaintProperty),e.deepEqual(yt.filter,St.filter)||Te.push({command:Nt.setFilter,args:[tt,St.filter]}),e.deepEqual(yt.minzoom,St.minzoom)&&e.deepEqual(yt.maxzoom,St.maxzoom)||Te.push({command:Nt.setLayerZoomRange,args:[tt,St.minzoom,St.maxzoom]}),yt)yt.hasOwnProperty(Tt)&&Tt!=="layout"&&Tt!=="paint"&&Tt!=="filter"&&Tt!=="metadata"&&Tt!=="minzoom"&&Tt!=="maxzoom"&&(Tt.indexOf("paint.")===0?Pt(yt[Tt],St[Tt],Te,tt,Tt.slice(6),Nt.setPaintProperty):e.deepEqual(yt[Tt],St[Tt])||Te.push({command:Nt.setLayerProperty,args:[tt,Tt,St[Tt]]}));for(Tt in St)St.hasOwnProperty(Tt)&&!yt.hasOwnProperty(Tt)&&Tt!=="layout"&&Tt!=="paint"&&Tt!=="filter"&&Tt!=="metadata"&&Tt!=="minzoom"&&Tt!=="maxzoom"&&(Tt.indexOf("paint.")===0?Pt(yt[Tt],St[Tt],Te,tt,Tt.slice(6),Nt.setPaintProperty):e.deepEqual(yt[Tt],St[Tt])||Te.push({command:Nt.setLayerProperty,args:[tt,Tt,St[Tt]]}))}else Te.push({command:Nt.removeLayer,args:[tt]}),_t=er[er.lastIndexOf(tt)+1],Te.push({command:Nt.addLayer,args:[St,_t]})}(le,z.layers,R)}catch(pe){console.warn("Unable to compute style diff:",pe),R=[{command:Nt.setStyle,args:[z]}]}return R}var Xt=function(E,z){this.reset(E,z)};Xt.prototype.reset=function(E,z){this.points=E||[],this._distances=[0];for(var R=1;R<this.points.length;R++)this._distances[R]=this._distances[R-1]+this.points[R].dist(this.points[R-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(z||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Xt.prototype.lerp=function(E){if(this.points.length===1)return this.points[0];E=e.clamp(E,0,1);for(var z=1,R=this._distances[z],U=E*this.paddedLength+this.padding;R<U&&z<this._distances.length;)R=this._distances[++z];var ne=z-1,le=this._distances[ne],pe=R-le,ye=pe>0?(U-le)/pe:0;return this.points[ne].mult(1-ye).add(this.points[z].mult(ye))};var ar=function(E,z,R){var U=this.boxCells=[],ne=this.circleCells=[];this.xCellCount=Math.ceil(E/R),this.yCellCount=Math.ceil(z/R);for(var le=0;le<this.xCellCount*this.yCellCount;le++)U.push([]),ne.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=E,this.height=z,this.xScale=this.xCellCount/E,this.yScale=this.yCellCount/z,this.boxUid=0,this.circleUid=0};function hr(E,z,R,U,ne){var le=e.create();return z?(e.scale(le,le,[1/ne,1/ne,1]),R||e.rotateZ(le,le,U.angle)):e.multiply(le,U.labelPlaneMatrix,E),le}function mr(E,z,R,U,ne){if(z){var le=e.clone(E);return e.scale(le,le,[ne,ne,1]),R||e.rotateZ(le,le,-U.angle),le}return U.glCoordMatrix}function sr(E,z){var R=[E.x,E.y,0,1];rn(R,R,z);var U=R[3];return{point:new e.Point(R[0]/U,R[1]/U),signedDistanceFromCamera:U}}function fr(E,z){return .5+E/z*.5}function yr(E,z){var R=E[0]/E[3],U=E[1]/E[3];return R>=-z[0]&&R<=z[0]&&U>=-z[1]&&U<=z[1]}function zr(E,z,R,U,ne,le,pe,ye){var Te=U?E.textSizeData:E.iconSizeData,Ne=e.evaluateSizeForZoom(Te,R.transform.zoom),qe=[256/R.width*2+1,256/R.height*2+1],tt=U?E.text.dynamicLayoutVertexArray:E.icon.dynamicLayoutVertexArray;tt.clear();for(var yt=E.lineVertexArray,St=U?E.text.placedSymbolArray:E.icon.placedSymbolArray,_t=R.transform.width/R.transform.height,Tt=!1,gt=0;gt<St.length;gt++){var Dt=St.get(gt);if(Dt.hidden||Dt.writingMode===e.WritingMode.vertical&&!Tt)An(Dt.numGlyphs,tt);else{Tt=!1;var Ot=[Dt.anchorX,Dt.anchorY,0,1];if(e.transformMat4(Ot,Ot,z),yr(Ot,qe)){var Bt=Ot[3],er=fr(R.transform.cameraToCenterDistance,Bt),ur=e.evaluateSizeForFeature(Te,Ne,Dt),Tr=pe?ur/er:ur*er,wr=new e.Point(Dt.anchorX,Dt.anchorY),Xr=sr(wr,ne).point,Wr={},un=Jr(Dt,Tr,!1,ye,z,ne,le,E.glyphOffsetArray,yt,tt,Xr,wr,Wr,_t);Tt=un.useVertical,(un.notEnoughRoom||Tt||un.needsFlipping&&Jr(Dt,Tr,!0,ye,z,ne,le,E.glyphOffsetArray,yt,tt,Xr,wr,Wr,_t).notEnoughRoom)&&An(Dt.numGlyphs,tt)}else An(Dt.numGlyphs,tt)}}U?E.text.dynamicLayoutVertexBuffer.updateData(tt):E.icon.dynamicLayoutVertexBuffer.updateData(tt)}function xr(E,z,R,U,ne,le,pe,ye,Te,Ne,qe){var tt=ye.glyphStartIndex+ye.numGlyphs,yt=ye.lineStartIndex,St=ye.lineStartIndex+ye.lineLength,_t=z.getoffsetX(ye.glyphStartIndex),Tt=z.getoffsetX(tt-1),gt=Cn(E*_t,R,U,ne,le,pe,ye.segment,yt,St,Te,Ne,qe);if(!gt)return null;var Dt=Cn(E*Tt,R,U,ne,le,pe,ye.segment,yt,St,Te,Ne,qe);return Dt?{first:gt,last:Dt}:null}function Br(E,z,R,U){return E===e.WritingMode.horizontal&&Math.abs(R.y-z.y)>Math.abs(R.x-z.x)*U?{useVertical:!0}:(E===e.WritingMode.vertical?z.y<R.y:z.x>R.x)?{needsFlipping:!0}:null}function Jr(E,z,R,U,ne,le,pe,ye,Te,Ne,qe,tt,yt,St){var _t,Tt=z/24,gt=E.lineOffsetX*Tt,Dt=E.lineOffsetY*Tt;if(E.numGlyphs>1){var Ot=E.glyphStartIndex+E.numGlyphs,Bt=E.lineStartIndex,er=E.lineStartIndex+E.lineLength,ur=xr(Tt,ye,gt,Dt,R,qe,tt,E,Te,le,yt);if(!ur)return{notEnoughRoom:!0};var Tr=sr(ur.first.point,pe).point,wr=sr(ur.last.point,pe).point;if(U&&!R){var Xr=Br(E.writingMode,Tr,wr,St);if(Xr)return Xr}_t=[ur.first];for(var Wr=E.glyphStartIndex+1;Wr<Ot-1;Wr++)_t.push(Cn(Tt*ye.getoffsetX(Wr),gt,Dt,R,qe,tt,E.segment,Bt,er,Te,le,yt));_t.push(ur.last)}else{if(U&&!R){var un=sr(tt,ne).point,an=E.lineStartIndex+E.segment+1,Nn=new e.Point(Te.getx(an),Te.gety(an)),Yn=sr(Nn,ne),sa=Yn.signedDistanceFromCamera>0?Yn.point:fn(tt,Nn,un,1,ne),Nr=Br(E.writingMode,un,sa,St);if(Nr)return Nr}var wn=Cn(Tt*ye.getoffsetX(E.glyphStartIndex),gt,Dt,R,qe,tt,E.segment,E.lineStartIndex,E.lineStartIndex+E.lineLength,Te,le,yt);if(!wn)return{notEnoughRoom:!0};_t=[wn]}for(var Wn=0,Vn=_t;Wn<Vn.length;Wn+=1){var $n=Vn[Wn];e.addDynamicAttributes(Ne,$n.point,$n.angle)}return{}}function fn(E,z,R,U,ne){var le=sr(E.add(E.sub(z)._unit()),ne).point,pe=R.sub(le);return R.add(pe._mult(U/pe.mag()))}function Cn(E,z,R,U,ne,le,pe,ye,Te,Ne,qe,tt){var yt=U?E-z:E+z,St=yt>0?1:-1,_t=0;U&&(St*=-1,_t=Math.PI),St<0&&(_t+=Math.PI);for(var Tt=St>0?ye+pe:ye+pe+1,gt=ne,Dt=ne,Ot=0,Bt=0,er=Math.abs(yt),ur=[];Ot+Bt<=er;){if((Tt+=St)<ye||Tt>=Te)return null;if(Dt=gt,ur.push(gt),(gt=tt[Tt])===void 0){var Tr=new e.Point(Ne.getx(Tt),Ne.gety(Tt)),wr=sr(Tr,qe);if(wr.signedDistanceFromCamera>0)gt=tt[Tt]=wr.point;else{var Xr=Tt-St;gt=fn(Ot===0?le:new e.Point(Ne.getx(Xr),Ne.gety(Xr)),Tr,Dt,er-Ot+1,qe)}}Ot+=Bt,Bt=Dt.dist(gt)}var Wr=(er-Ot)/Bt,un=gt.sub(Dt),an=un.mult(Wr)._add(Dt);an._add(un._unit()._perp()._mult(R*St));var Nn=_t+Math.atan2(gt.y-Dt.y,gt.x-Dt.x);return ur.push(an),{point:an,angle:Nn,path:ur}}ar.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},ar.prototype.insert=function(E,z,R,U,ne){this._forEachCell(z,R,U,ne,this._insertBoxCell,this.boxUid++),this.boxKeys.push(E),this.bboxes.push(z),this.bboxes.push(R),this.bboxes.push(U),this.bboxes.push(ne)},ar.prototype.insertCircle=function(E,z,R,U){this._forEachCell(z-U,R-U,z+U,R+U,this._insertCircleCell,this.circleUid++),this.circleKeys.push(E),this.circles.push(z),this.circles.push(R),this.circles.push(U)},ar.prototype._insertBoxCell=function(E,z,R,U,ne,le){this.boxCells[ne].push(le)},ar.prototype._insertCircleCell=function(E,z,R,U,ne,le){this.circleCells[ne].push(le)},ar.prototype._query=function(E,z,R,U,ne,le){if(R<0||E>this.width||U<0||z>this.height)return!ne&&[];var pe=[];if(E<=0&&z<=0&&this.width<=R&&this.height<=U){if(ne)return!0;for(var ye=0;ye<this.boxKeys.length;ye++)pe.push({key:this.boxKeys[ye],x1:this.bboxes[4*ye],y1:this.bboxes[4*ye+1],x2:this.bboxes[4*ye+2],y2:this.bboxes[4*ye+3]});for(var Te=0;Te<this.circleKeys.length;Te++){var Ne=this.circles[3*Te],qe=this.circles[3*Te+1],tt=this.circles[3*Te+2];pe.push({key:this.circleKeys[Te],x1:Ne-tt,y1:qe-tt,x2:Ne+tt,y2:qe+tt})}return le?pe.filter(le):pe}var yt={hitTest:ne,seenUids:{box:{},circle:{}}};return this._forEachCell(E,z,R,U,this._queryCell,pe,yt,le),ne?pe.length>0:pe},ar.prototype._queryCircle=function(E,z,R,U,ne){var le=E-R,pe=E+R,ye=z-R,Te=z+R;if(pe<0||le>this.width||Te<0||ye>this.height)return!U&&[];var Ne=[],qe={hitTest:U,circle:{x:E,y:z,radius:R},seenUids:{box:{},circle:{}}};return this._forEachCell(le,ye,pe,Te,this._queryCellCircle,Ne,qe,ne),U?Ne.length>0:Ne},ar.prototype.query=function(E,z,R,U,ne){return this._query(E,z,R,U,!1,ne)},ar.prototype.hitTest=function(E,z,R,U,ne){return this._query(E,z,R,U,!0,ne)},ar.prototype.hitTestCircle=function(E,z,R,U){return this._queryCircle(E,z,R,!0,U)},ar.prototype._queryCell=function(E,z,R,U,ne,le,pe,ye){var Te=pe.seenUids,Ne=this.boxCells[ne];if(Ne!==null)for(var qe=this.bboxes,tt=0,yt=Ne;tt<yt.length;tt+=1){var St=yt[tt];if(!Te.box[St]){Te.box[St]=!0;var _t=4*St;if(E<=qe[_t+2]&&z<=qe[_t+3]&&R>=qe[_t+0]&&U>=qe[_t+1]&&(!ye||ye(this.boxKeys[St]))){if(pe.hitTest)return le.push(!0),!0;le.push({key:this.boxKeys[St],x1:qe[_t],y1:qe[_t+1],x2:qe[_t+2],y2:qe[_t+3]})}}}var Tt=this.circleCells[ne];if(Tt!==null)for(var gt=this.circles,Dt=0,Ot=Tt;Dt<Ot.length;Dt+=1){var Bt=Ot[Dt];if(!Te.circle[Bt]){Te.circle[Bt]=!0;var er=3*Bt;if(this._circleAndRectCollide(gt[er],gt[er+1],gt[er+2],E,z,R,U)&&(!ye||ye(this.circleKeys[Bt]))){if(pe.hitTest)return le.push(!0),!0;var ur=gt[er],Tr=gt[er+1],wr=gt[er+2];le.push({key:this.circleKeys[Bt],x1:ur-wr,y1:Tr-wr,x2:ur+wr,y2:Tr+wr})}}}},ar.prototype._queryCellCircle=function(E,z,R,U,ne,le,pe,ye){var Te=pe.circle,Ne=pe.seenUids,qe=this.boxCells[ne];if(qe!==null)for(var tt=this.bboxes,yt=0,St=qe;yt<St.length;yt+=1){var _t=St[yt];if(!Ne.box[_t]){Ne.box[_t]=!0;var Tt=4*_t;if(this._circleAndRectCollide(Te.x,Te.y,Te.radius,tt[Tt+0],tt[Tt+1],tt[Tt+2],tt[Tt+3])&&(!ye||ye(this.boxKeys[_t])))return le.push(!0),!0}}var gt=this.circleCells[ne];if(gt!==null)for(var Dt=this.circles,Ot=0,Bt=gt;Ot<Bt.length;Ot+=1){var er=Bt[Ot];if(!Ne.circle[er]){Ne.circle[er]=!0;var ur=3*er;if(this._circlesCollide(Dt[ur],Dt[ur+1],Dt[ur+2],Te.x,Te.y,Te.radius)&&(!ye||ye(this.circleKeys[er])))return le.push(!0),!0}}},ar.prototype._forEachCell=function(E,z,R,U,ne,le,pe,ye){for(var Te=this._convertToXCellCoord(E),Ne=this._convertToYCellCoord(z),qe=this._convertToXCellCoord(R),tt=this._convertToYCellCoord(U),yt=Te;yt<=qe;yt++)for(var St=Ne;St<=tt;St++){var _t=this.xCellCount*St+yt;if(ne.call(this,E,z,R,U,_t,le,pe,ye))return}},ar.prototype._convertToXCellCoord=function(E){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(E*this.xScale)))},ar.prototype._convertToYCellCoord=function(E){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(E*this.yScale)))},ar.prototype._circlesCollide=function(E,z,R,U,ne,le){var pe=U-E,ye=ne-z,Te=R+le;return Te*Te>pe*pe+ye*ye},ar.prototype._circleAndRectCollide=function(E,z,R,U,ne,le,pe){var ye=(le-U)/2,Te=Math.abs(E-(U+ye));if(Te>ye+R)return!1;var Ne=(pe-ne)/2,qe=Math.abs(z-(ne+Ne));if(qe>Ne+R)return!1;if(Te<=ye||qe<=Ne)return!0;var tt=Te-ye,yt=qe-Ne;return tt*tt+yt*yt<=R*R};var Pn=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function An(E,z){for(var R=0;R<E;R++){var U=z.length;z.resize(U+4),z.float32.set(Pn,3*U)}}function rn(E,z,R){var U=z[0],ne=z[1];return E[0]=R[0]*U+R[4]*ne+R[12],E[1]=R[1]*U+R[5]*ne+R[13],E[3]=R[3]*U+R[7]*ne+R[15],E}var Fr=function(E,z,R){z===void 0&&(z=new ar(E.width+200,E.height+200,25)),R===void 0&&(R=new ar(E.width+200,E.height+200,25)),this.transform=E,this.grid=z,this.ignoredGrid=R,this.pitchfactor=Math.cos(E._pitch)*E.cameraToCenterDistance,this.screenRightBoundary=E.width+100,this.screenBottomBoundary=E.height+100,this.gridRightBoundary=E.width+200,this.gridBottomBoundary=E.height+200};function Lr(E,z,R){return z*(e.EXTENT/(E.tileSize*Math.pow(2,R-E.tileID.overscaledZ)))}Fr.prototype.placeCollisionBox=function(E,z,R,U,ne){var le=this.projectAndGetPerspectiveRatio(U,E.anchorPointX,E.anchorPointY),pe=R*le.perspectiveRatio,ye=E.x1*pe+le.point.x,Te=E.y1*pe+le.point.y,Ne=E.x2*pe+le.point.x,qe=E.y2*pe+le.point.y;return!this.isInsideGrid(ye,Te,Ne,qe)||!z&&this.grid.hitTest(ye,Te,Ne,qe,ne)?{box:[],offscreen:!1}:{box:[ye,Te,Ne,qe],offscreen:this.isOffscreen(ye,Te,Ne,qe)}},Fr.prototype.placeCollisionCircles=function(E,z,R,U,ne,le,pe,ye,Te,Ne,qe,tt,yt){var St=[],_t=new e.Point(z.anchorX,z.anchorY),Tt=sr(_t,le),gt=fr(this.transform.cameraToCenterDistance,Tt.signedDistanceFromCamera),Dt=(Ne?ne/gt:ne*gt)/e.ONE_EM,Ot=sr(_t,pe).point,Bt=xr(Dt,U,z.lineOffsetX*Dt,z.lineOffsetY*Dt,!1,Ot,_t,z,R,pe,{}),er=!1,ur=!1,Tr=!0;if(Bt){for(var wr=.5*tt*gt+yt,Xr=new e.Point(-100,-100),Wr=new e.Point(this.screenRightBoundary,this.screenBottomBoundary),un=new Xt,an=Bt.first,Nn=Bt.last,Yn=[],sa=an.path.length-1;sa>=1;sa--)Yn.push(an.path[sa]);for(var Nr=1;Nr<Nn.path.length;Nr++)Yn.push(Nn.path[Nr]);var wn=2.5*wr;if(ye){var Wn=Yn.map(function(go){return sr(go,ye)});Yn=Wn.some(function(go){return go.signedDistanceFromCamera<=0})?[]:Wn.map(function(go){return go.point})}var Vn=[];if(Yn.length>0){for(var $n=Yn[0].clone(),ca=Yn[0].clone(),Ta=1;Ta<Yn.length;Ta++)$n.x=Math.min($n.x,Yn[Ta].x),$n.y=Math.min($n.y,Yn[Ta].y),ca.x=Math.max(ca.x,Yn[Ta].x),ca.y=Math.max(ca.y,Yn[Ta].y);Vn=$n.x>=Xr.x&&ca.x<=Wr.x&&$n.y>=Xr.y&&ca.y<=Wr.y?[Yn]:ca.x<Xr.x||$n.x>Wr.x||ca.y<Xr.y||$n.y>Wr.y?[]:e.clipLine([Yn],Xr.x,Xr.y,Wr.x,Wr.y)}for(var Zn=0,va=Vn;Zn<va.length;Zn+=1){var da=va[Zn];un.reset(da,.25*wr);var Sa=0;Sa=un.length<=.5*wr?1:Math.ceil(un.paddedLength/wn)+1;for(var ya=0;ya<Sa;ya++){var Ea=ya/Math.max(Sa-1,1),Ba=un.lerp(Ea),li=Ba.x+100,Li=Ba.y+100;St.push(li,Li,wr,0);var Ci=li-wr,si=Li-wr,wi=li+wr,pi=Li+wr;if(Tr=Tr&&this.isOffscreen(Ci,si,wi,pi),ur=ur||this.isInsideGrid(Ci,si,wi,pi),!E&&this.grid.hitTestCircle(li,Li,wr,qe)&&(er=!0,!Te))return{circles:[],offscreen:!1,collisionDetected:er}}}}return{circles:!Te&&er||!ur?[]:St,offscreen:Tr,collisionDetected:er}},Fr.prototype.queryRenderedSymbols=function(E){if(E.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var z=[],R=1/0,U=1/0,ne=-1/0,le=-1/0,pe=0,ye=E;pe<ye.length;pe+=1){var Te=ye[pe],Ne=new e.Point(Te.x+100,Te.y+100);R=Math.min(R,Ne.x),U=Math.min(U,Ne.y),ne=Math.max(ne,Ne.x),le=Math.max(le,Ne.y),z.push(Ne)}for(var qe={},tt={},yt=0,St=this.grid.query(R,U,ne,le).concat(this.ignoredGrid.query(R,U,ne,le));yt<St.length;yt+=1){var _t=St[yt],Tt=_t.key;if(qe[Tt.bucketInstanceId]===void 0&&(qe[Tt.bucketInstanceId]={}),!qe[Tt.bucketInstanceId][Tt.featureIndex]){var gt=[new e.Point(_t.x1,_t.y1),new e.Point(_t.x2,_t.y1),new e.Point(_t.x2,_t.y2),new e.Point(_t.x1,_t.y2)];e.polygonIntersectsPolygon(z,gt)&&(qe[Tt.bucketInstanceId][Tt.featureIndex]=!0,tt[Tt.bucketInstanceId]===void 0&&(tt[Tt.bucketInstanceId]=[]),tt[Tt.bucketInstanceId].push(Tt.featureIndex))}}return tt},Fr.prototype.insertCollisionBox=function(E,z,R,U,ne){var le={bucketInstanceId:R,featureIndex:U,collisionGroupID:ne};(z?this.ignoredGrid:this.grid).insert(le,E[0],E[1],E[2],E[3])},Fr.prototype.insertCollisionCircles=function(E,z,R,U,ne){for(var le=z?this.ignoredGrid:this.grid,pe={bucketInstanceId:R,featureIndex:U,collisionGroupID:ne},ye=0;ye<E.length;ye+=4)le.insertCircle(pe,E[ye],E[ye+1],E[ye+2])},Fr.prototype.projectAndGetPerspectiveRatio=function(E,z,R){var U=[z,R,0,1];return rn(U,U,E),{point:new e.Point((U[0]/U[3]+1)/2*this.transform.width+100,(-U[1]/U[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/U[3]*.5}},Fr.prototype.isOffscreen=function(E,z,R,U){return R<100||E>=this.screenRightBoundary||U<100||z>this.screenBottomBoundary},Fr.prototype.isInsideGrid=function(E,z,R,U){return R>=0&&E<this.gridRightBoundary&&U>=0&&z<this.gridBottomBoundary},Fr.prototype.getViewportMatrix=function(){var E=e.identity([]);return e.translate(E,E,[-100,-100,0]),E};var Qr=function(E,z,R,U){this.opacity=E?Math.max(0,Math.min(1,E.opacity+(E.placed?z:-z))):U&&R?1:0,this.placed=R};Qr.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var $r=function(E,z,R,U,ne){this.text=new Qr(E?E.text:null,z,R,ne),this.icon=new Qr(E?E.icon:null,z,U,ne)};$r.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Kr=function(E,z,R){this.text=E,this.icon=z,this.skipFade=R},en=function(){this.invProjMatrix=e.create(),this.viewportMatrix=e.create(),this.circles=[]},Tn=function(E,z,R,U,ne){this.bucketInstanceId=E,this.featureIndex=z,this.sourceLayerIndex=R,this.bucketIndex=U,this.tileID=ne},Mn=function(E){this.crossSourceCollisions=E,this.maxGroupID=0,this.collisionGroups={}};function Rn(E,z,R,U,ne){var le=e.getAnchorAlignment(E),pe=-(le.horizontalAlign-.5)*z,ye=-(le.verticalAlign-.5)*R,Te=e.evaluateVariableOffset(E,U);return new e.Point(pe+Te[0]*ne,ye+Te[1]*ne)}function Zt(E,z,R,U,ne,le){var pe=E.x1,ye=E.x2,Te=E.y1,Ne=E.y2,qe=E.anchorPointX,tt=E.anchorPointY,yt=new e.Point(z,R);return U&&yt._rotate(ne?le:-le),{x1:pe+yt.x,y1:Te+yt.y,x2:ye+yt.x,y2:Ne+yt.y,anchorPointX:qe,anchorPointY:tt}}Mn.prototype.get=function(E){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[E]){var z=++this.maxGroupID;this.collisionGroups[E]={ID:z,predicate:function(R){return R.collisionGroupID===z}}}return this.collisionGroups[E]};var Ct=function(E,z,R,U){this.transform=E.clone(),this.collisionIndex=new Fr(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=z,this.retainedQueryData={},this.collisionGroups=new Mn(R),this.collisionCircleArrays={},this.prevPlacement=U,U&&(U.prevPlacement=void 0),this.placedOrientations={}};function Ht(E,z,R,U,ne){E.emplaceBack(z?1:0,R?1:0,U||0,ne||0),E.emplaceBack(z?1:0,R?1:0,U||0,ne||0),E.emplaceBack(z?1:0,R?1:0,U||0,ne||0),E.emplaceBack(z?1:0,R?1:0,U||0,ne||0)}Ct.prototype.getBucketParts=function(E,z,R,U){var ne=R.getBucket(z),le=R.latestFeatureIndex;if(ne&&le&&z.id===ne.layerIds[0]){var pe=R.collisionBoxArray,ye=ne.layers[0].layout,Te=Math.pow(2,this.transform.zoom-R.tileID.overscaledZ),Ne=R.tileSize/e.EXTENT,qe=this.transform.calculatePosMatrix(R.tileID.toUnwrapped()),tt=ye.get("text-pitch-alignment")==="map",yt=ye.get("text-rotation-alignment")==="map",St=Lr(R,1,this.transform.zoom),_t=hr(qe,tt,yt,this.transform,St),Tt=null;if(tt){var gt=mr(qe,tt,yt,this.transform,St);Tt=e.multiply([],this.transform.labelPlaneMatrix,gt)}this.retainedQueryData[ne.bucketInstanceId]=new Tn(ne.bucketInstanceId,le,ne.sourceLayerIndex,ne.index,R.tileID);var Dt={bucket:ne,layout:ye,posMatrix:qe,textLabelPlaneMatrix:_t,labelToScreenMatrix:Tt,scale:Te,textPixelRatio:Ne,holdingForFade:R.holdingForFade(),collisionBoxArray:pe,partiallyEvaluatedTextSize:e.evaluateSizeForZoom(ne.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(ne.sourceID)};if(U)for(var Ot=0,Bt=ne.sortKeyRanges;Ot<Bt.length;Ot+=1){var er=Bt[Ot],ur=er.sortKey,Tr=er.symbolInstanceStart,wr=er.symbolInstanceEnd;E.push({sortKey:ur,symbolInstanceStart:Tr,symbolInstanceEnd:wr,parameters:Dt})}else E.push({symbolInstanceStart:0,symbolInstanceEnd:ne.symbolInstances.length,parameters:Dt})}},Ct.prototype.attemptAnchorPlacement=function(E,z,R,U,ne,le,pe,ye,Te,Ne,qe,tt,yt,St,_t){var Tt,gt=[tt.textOffset0,tt.textOffset1],Dt=Rn(E,R,U,gt,ne),Ot=this.collisionIndex.placeCollisionBox(Zt(z,Dt.x,Dt.y,le,pe,this.transform.angle),qe,ye,Te,Ne.predicate);if(!(_t&&this.collisionIndex.placeCollisionBox(Zt(_t,Dt.x,Dt.y,le,pe,this.transform.angle),qe,ye,Te,Ne.predicate).box.length===0)&&Ot.box.length>0)return this.prevPlacement&&this.prevPlacement.variableOffsets[tt.crossTileID]&&this.prevPlacement.placements[tt.crossTileID]&&this.prevPlacement.placements[tt.crossTileID].text&&(Tt=this.prevPlacement.variableOffsets[tt.crossTileID].anchor),this.variableOffsets[tt.crossTileID]={textOffset:gt,width:R,height:U,anchor:E,textBoxScale:ne,prevAnchor:Tt},this.markUsedJustification(yt,E,tt,St),yt.allowVerticalPlacement&&(this.markUsedOrientation(yt,St,tt),this.placedOrientations[tt.crossTileID]=St),{shift:Dt,placedGlyphBoxes:Ot}},Ct.prototype.placeLayerBucketPart=function(E,z,R){var U=this,ne=E.parameters,le=ne.bucket,pe=ne.layout,ye=ne.posMatrix,Te=ne.textLabelPlaneMatrix,Ne=ne.labelToScreenMatrix,qe=ne.textPixelRatio,tt=ne.holdingForFade,yt=ne.collisionBoxArray,St=ne.partiallyEvaluatedTextSize,_t=ne.collisionGroup,Tt=pe.get("text-optional"),gt=pe.get("icon-optional"),Dt=pe.get("text-allow-overlap"),Ot=pe.get("icon-allow-overlap"),Bt=pe.get("text-rotation-alignment")==="map",er=pe.get("text-pitch-alignment")==="map",ur=pe.get("icon-text-fit")!=="none",Tr=pe.get("symbol-z-order")==="viewport-y",wr=Dt&&(Ot||!le.hasIconData()||gt),Xr=Ot&&(Dt||!le.hasTextData()||Tt);!le.collisionArrays&&yt&&le.deserializeCollisionBoxes(yt);var Wr=function(Nr,wn){if(!z[Nr.crossTileID])if(tt)U.placements[Nr.crossTileID]=new Kr(!1,!1,!1);else{var Wn,Vn=!1,$n=!1,ca=!0,Ta=null,Zn={box:null,offscreen:null},va={box:null,offscreen:null},da=null,Sa=null,ya=0,Ea=0,Ba=0;wn.textFeatureIndex?ya=wn.textFeatureIndex:Nr.useRuntimeCollisionCircles&&(ya=Nr.featureIndex),wn.verticalTextFeatureIndex&&(Ea=wn.verticalTextFeatureIndex);var li=wn.textBox;if(li){var Li=function(Ti){var Lo=e.WritingMode.horizontal;if(le.allowVerticalPlacement&&!Ti&&U.prevPlacement){var Co=U.prevPlacement.placedOrientations[Nr.crossTileID];Co&&(U.placedOrientations[Nr.crossTileID]=Co,Lo=Co,U.markUsedOrientation(le,Lo,Nr))}return Lo},Ci=function(Ti,Lo){if(le.allowVerticalPlacement&&Nr.numVerticalGlyphVertices>0&&wn.verticalTextBox)for(var Co=0,Tl=le.writingModes;Co<Tl.length&&(Tl[Co]===e.WritingMode.vertical?(Zn=Lo(),va=Zn):Zn=Ti(),!(Zn&&Zn.box&&Zn.box.length));Co+=1);else Zn=Ti()};if(pe.get("text-variable-anchor")){var si=pe.get("text-variable-anchor");if(U.prevPlacement&&U.prevPlacement.variableOffsets[Nr.crossTileID]){var wi=U.prevPlacement.variableOffsets[Nr.crossTileID];si.indexOf(wi.anchor)>0&&(si=si.filter(function(Ti){return Ti!==wi.anchor})).unshift(wi.anchor)}var pi=function(Ti,Lo,Co){for(var Tl=Ti.x2-Ti.x1,ou=Ti.y2-Ti.y1,Zo=Nr.textBoxScale,Jl=ur&&!Ot?Lo:null,ml={box:[],offscreen:!1},su=Dt?2*si.length:si.length,Ys=0;Ys<su;++Ys){var lu=si[Ys%si.length],kl=Ys>=si.length,Kl=U.attemptAnchorPlacement(lu,Ti,Tl,ou,Zo,Bt,er,qe,ye,_t,kl,Nr,le,Co,Jl);if(Kl&&(ml=Kl.placedGlyphBoxes)&&ml.box&&ml.box.length){Vn=!0,Ta=Kl.shift;break}}return ml};Ci(function(){return pi(li,wn.iconBox,e.WritingMode.horizontal)},function(){var Ti=wn.verticalTextBox,Lo=Zn&&Zn.box&&Zn.box.length;return le.allowVerticalPlacement&&!Lo&&Nr.numVerticalGlyphVertices>0&&Ti?pi(Ti,wn.verticalIconBox,e.WritingMode.vertical):{box:null,offscreen:null}}),Zn&&(Vn=Zn.box,ca=Zn.offscreen);var go=Li(Zn&&Zn.box);if(!Vn&&U.prevPlacement){var Vi=U.prevPlacement.variableOffsets[Nr.crossTileID];Vi&&(U.variableOffsets[Nr.crossTileID]=Vi,U.markUsedJustification(le,Vi.anchor,Nr,go))}}else{var Oo=function(Ti,Lo){var Co=U.collisionIndex.placeCollisionBox(Ti,Dt,qe,ye,_t.predicate);return Co&&Co.box&&Co.box.length&&(U.markUsedOrientation(le,Lo,Nr),U.placedOrientations[Nr.crossTileID]=Lo),Co};Ci(function(){return Oo(li,e.WritingMode.horizontal)},function(){var Ti=wn.verticalTextBox;return le.allowVerticalPlacement&&Nr.numVerticalGlyphVertices>0&&Ti?Oo(Ti,e.WritingMode.vertical):{box:null,offscreen:null}}),Li(Zn&&Zn.box&&Zn.box.length)}}if(Vn=(Wn=Zn)&&Wn.box&&Wn.box.length>0,ca=Wn&&Wn.offscreen,Nr.useRuntimeCollisionCircles){var _s=le.text.placedSymbolArray.get(Nr.centerJustifiedTextSymbolIndex),Us=e.evaluateSizeForFeature(le.textSizeData,St,_s),hl=pe.get("text-padding"),rl=Nr.collisionCircleDiameter;da=U.collisionIndex.placeCollisionCircles(Dt,_s,le.lineVertexArray,le.glyphOffsetArray,Us,ye,Te,Ne,R,er,_t.predicate,rl,hl),Vn=Dt||da.circles.length>0&&!da.collisionDetected,ca=ca&&da.offscreen}if(wn.iconFeatureIndex&&(Ba=wn.iconFeatureIndex),wn.iconBox){var nl=function(Ti){var Lo=ur&&Ta?Zt(Ti,Ta.x,Ta.y,Bt,er,U.transform.angle):Ti;return U.collisionIndex.placeCollisionBox(Lo,Ot,qe,ye,_t.predicate)};$n=va&&va.box&&va.box.length&&wn.verticalIconBox?(Sa=nl(wn.verticalIconBox)).box.length>0:(Sa=nl(wn.iconBox)).box.length>0,ca=ca&&Sa.offscreen}var vo=Tt||Nr.numHorizontalGlyphVertices===0&&Nr.numVerticalGlyphVertices===0,Gs=gt||Nr.numIconVertices===0;if(vo||Gs?Gs?vo||($n=$n&&Vn):Vn=$n&&Vn:$n=Vn=$n&&Vn,Vn&&Wn&&Wn.box&&(va&&va.box&&Ea?U.collisionIndex.insertCollisionBox(Wn.box,pe.get("text-ignore-placement"),le.bucketInstanceId,Ea,_t.ID):U.collisionIndex.insertCollisionBox(Wn.box,pe.get("text-ignore-placement"),le.bucketInstanceId,ya,_t.ID)),$n&&Sa&&U.collisionIndex.insertCollisionBox(Sa.box,pe.get("icon-ignore-placement"),le.bucketInstanceId,Ba,_t.ID),da&&(Vn&&U.collisionIndex.insertCollisionCircles(da.circles,pe.get("text-ignore-placement"),le.bucketInstanceId,ya,_t.ID),R)){var pl=le.bucketInstanceId,ns=U.collisionCircleArrays[pl];ns===void 0&&(ns=U.collisionCircleArrays[pl]=new en);for(var dl=0;dl<da.circles.length;dl+=4)ns.circles.push(da.circles[dl+0]),ns.circles.push(da.circles[dl+1]),ns.circles.push(da.circles[dl+2]),ns.circles.push(da.collisionDetected?1:0)}U.placements[Nr.crossTileID]=new Kr(Vn||wr,$n||Xr,ca||le.justReloaded),z[Nr.crossTileID]=!0}};if(Tr)for(var un=le.getSortedSymbolIndexes(this.transform.angle),an=un.length-1;an>=0;--an){var Nn=un[an];Wr(le.symbolInstances.get(Nn),le.collisionArrays[Nn])}else for(var Yn=E.symbolInstanceStart;Yn<E.symbolInstanceEnd;Yn++)Wr(le.symbolInstances.get(Yn),le.collisionArrays[Yn]);if(R&&le.bucketInstanceId in this.collisionCircleArrays){var sa=this.collisionCircleArrays[le.bucketInstanceId];e.invert(sa.invProjMatrix,ye),sa.viewportMatrix=this.collisionIndex.getViewportMatrix()}le.justReloaded=!1},Ct.prototype.markUsedJustification=function(E,z,R,U){var ne,le={left:R.leftJustifiedTextSymbolIndex,center:R.centerJustifiedTextSymbolIndex,right:R.rightJustifiedTextSymbolIndex};ne=U===e.WritingMode.vertical?R.verticalPlacedTextSymbolIndex:le[e.getAnchorJustification(z)];for(var pe=0,ye=[R.leftJustifiedTextSymbolIndex,R.centerJustifiedTextSymbolIndex,R.rightJustifiedTextSymbolIndex,R.verticalPlacedTextSymbolIndex];pe<ye.length;pe+=1){var Te=ye[pe];Te>=0&&(E.text.placedSymbolArray.get(Te).crossTileID=ne>=0&&Te!==ne?0:R.crossTileID)}},Ct.prototype.markUsedOrientation=function(E,z,R){for(var U=z===e.WritingMode.horizontal||z===e.WritingMode.horizontalOnly?z:0,ne=z===e.WritingMode.vertical?z:0,le=0,pe=[R.leftJustifiedTextSymbolIndex,R.centerJustifiedTextSymbolIndex,R.rightJustifiedTextSymbolIndex];le<pe.length;le+=1){var ye=pe[le];E.text.placedSymbolArray.get(ye).placedOrientation=U}R.verticalPlacedTextSymbolIndex&&(E.text.placedSymbolArray.get(R.verticalPlacedTextSymbolIndex).placedOrientation=ne)},Ct.prototype.commit=function(E){this.commitTime=E,this.zoomAtLastRecencyCheck=this.transform.zoom;var z=this.prevPlacement,R=!1;this.prevZoomAdjustment=z?z.zoomAdjustment(this.transform.zoom):0;var U=z?z.symbolFadeChange(E):1,ne=z?z.opacities:{},le=z?z.variableOffsets:{},pe=z?z.placedOrientations:{};for(var ye in this.placements){var Te=this.placements[ye],Ne=ne[ye];Ne?(this.opacities[ye]=new $r(Ne,U,Te.text,Te.icon),R=R||Te.text!==Ne.text.placed||Te.icon!==Ne.icon.placed):(this.opacities[ye]=new $r(null,U,Te.text,Te.icon,Te.skipFade),R=R||Te.text||Te.icon)}for(var qe in ne){var tt=ne[qe];if(!this.opacities[qe]){var yt=new $r(tt,U,!1,!1);yt.isHidden()||(this.opacities[qe]=yt,R=R||tt.text.placed||tt.icon.placed)}}for(var St in le)this.variableOffsets[St]||!this.opacities[St]||this.opacities[St].isHidden()||(this.variableOffsets[St]=le[St]);for(var _t in pe)this.placedOrientations[_t]||!this.opacities[_t]||this.opacities[_t].isHidden()||(this.placedOrientations[_t]=pe[_t]);R?this.lastPlacementChangeTime=E:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=z?z.lastPlacementChangeTime:E)},Ct.prototype.updateLayerOpacities=function(E,z){for(var R={},U=0,ne=z;U<ne.length;U+=1){var le=ne[U],pe=le.getBucket(E);pe&&le.latestFeatureIndex&&E.id===pe.layerIds[0]&&this.updateBucketOpacities(pe,R,le.collisionBoxArray)}},Ct.prototype.updateBucketOpacities=function(E,z,R){var U=this;E.hasTextData()&&E.text.opacityVertexArray.clear(),E.hasIconData()&&E.icon.opacityVertexArray.clear(),E.hasIconCollisionBoxData()&&E.iconCollisionBox.collisionVertexArray.clear(),E.hasTextCollisionBoxData()&&E.textCollisionBox.collisionVertexArray.clear();var ne=E.layers[0].layout,le=new $r(null,0,!1,!1,!0),pe=ne.get("text-allow-overlap"),ye=ne.get("icon-allow-overlap"),Te=ne.get("text-variable-anchor"),Ne=ne.get("text-rotation-alignment")==="map",qe=ne.get("text-pitch-alignment")==="map",tt=ne.get("icon-text-fit")!=="none",yt=new $r(null,0,pe&&(ye||!E.hasIconData()||ne.get("icon-optional")),ye&&(pe||!E.hasTextData()||ne.get("text-optional")),!0);!E.collisionArrays&&R&&(E.hasIconCollisionBoxData()||E.hasTextCollisionBoxData())&&E.deserializeCollisionBoxes(R);for(var St=function(Dt,Ot,Bt){for(var er=0;er<Ot/4;er++)Dt.opacityVertexArray.emplaceBack(Bt)},_t=function(Dt){var Ot=E.symbolInstances.get(Dt),Bt=Ot.numHorizontalGlyphVertices,er=Ot.numVerticalGlyphVertices,ur=Ot.crossTileID,Tr=z[ur],wr=U.opacities[ur];Tr?wr=le:wr||(wr=yt,U.opacities[ur]=wr),z[ur]=!0;var Xr=Bt>0||er>0,Wr=Ot.numIconVertices>0,un=U.placedOrientations[Ot.crossTileID],an=un===e.WritingMode.vertical,Nn=un===e.WritingMode.horizontal||un===e.WritingMode.horizontalOnly;if(Xr){var Yn=kr(wr.text),sa=an?Cr:Yn;St(E.text,Bt,sa);var Nr=Nn?Cr:Yn;St(E.text,er,Nr);var wn=wr.text.isHidden();[Ot.rightJustifiedTextSymbolIndex,Ot.centerJustifiedTextSymbolIndex,Ot.leftJustifiedTextSymbolIndex].forEach(function(Ba){Ba>=0&&(E.text.placedSymbolArray.get(Ba).hidden=wn||an?1:0)}),Ot.verticalPlacedTextSymbolIndex>=0&&(E.text.placedSymbolArray.get(Ot.verticalPlacedTextSymbolIndex).hidden=wn||Nn?1:0);var Wn=U.variableOffsets[Ot.crossTileID];Wn&&U.markUsedJustification(E,Wn.anchor,Ot,un);var Vn=U.placedOrientations[Ot.crossTileID];Vn&&(U.markUsedJustification(E,"left",Ot,Vn),U.markUsedOrientation(E,Vn,Ot))}if(Wr){var $n=kr(wr.icon),ca=!(tt&&Ot.verticalPlacedIconSymbolIndex&&an);if(Ot.placedIconSymbolIndex>=0){var Ta=ca?$n:Cr;St(E.icon,Ot.numIconVertices,Ta),E.icon.placedSymbolArray.get(Ot.placedIconSymbolIndex).hidden=wr.icon.isHidden()}if(Ot.verticalPlacedIconSymbolIndex>=0){var Zn=ca?Cr:$n;St(E.icon,Ot.numVerticalIconVertices,Zn),E.icon.placedSymbolArray.get(Ot.verticalPlacedIconSymbolIndex).hidden=wr.icon.isHidden()}}if(E.hasIconCollisionBoxData()||E.hasTextCollisionBoxData()){var va=E.collisionArrays[Dt];if(va){var da=new e.Point(0,0);if(va.textBox||va.verticalTextBox){var Sa=!0;if(Te){var ya=U.variableOffsets[ur];ya?(da=Rn(ya.anchor,ya.width,ya.height,ya.textOffset,ya.textBoxScale),Ne&&da._rotate(qe?U.transform.angle:-U.transform.angle)):Sa=!1}va.textBox&&Ht(E.textCollisionBox.collisionVertexArray,wr.text.placed,!Sa||an,da.x,da.y),va.verticalTextBox&&Ht(E.textCollisionBox.collisionVertexArray,wr.text.placed,!Sa||Nn,da.x,da.y)}var Ea=Boolean(!Nn&&va.verticalIconBox);va.iconBox&&Ht(E.iconCollisionBox.collisionVertexArray,wr.icon.placed,Ea,tt?da.x:0,tt?da.y:0),va.verticalIconBox&&Ht(E.iconCollisionBox.collisionVertexArray,wr.icon.placed,!Ea,tt?da.x:0,tt?da.y:0)}}},Tt=0;Tt<E.symbolInstances.length;Tt++)_t(Tt);if(E.sortFeatures(this.transform.angle),this.retainedQueryData[E.bucketInstanceId]&&(this.retainedQueryData[E.bucketInstanceId].featureSortOrder=E.featureSortOrder),E.hasTextData()&&E.text.opacityVertexBuffer&&E.text.opacityVertexBuffer.updateData(E.text.opacityVertexArray),E.hasIconData()&&E.icon.opacityVertexBuffer&&E.icon.opacityVertexBuffer.updateData(E.icon.opacityVertexArray),E.hasIconCollisionBoxData()&&E.iconCollisionBox.collisionVertexBuffer&&E.iconCollisionBox.collisionVertexBuffer.updateData(E.iconCollisionBox.collisionVertexArray),E.hasTextCollisionBoxData()&&E.textCollisionBox.collisionVertexBuffer&&E.textCollisionBox.collisionVertexBuffer.updateData(E.textCollisionBox.collisionVertexArray),E.bucketInstanceId in this.collisionCircleArrays){var gt=this.collisionCircleArrays[E.bucketInstanceId];E.placementInvProjMatrix=gt.invProjMatrix,E.placementViewportMatrix=gt.viewportMatrix,E.collisionCircleArray=gt.circles,delete this.collisionCircleArrays[E.bucketInstanceId]}},Ct.prototype.symbolFadeChange=function(E){return this.fadeDuration===0?1:(E-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Ct.prototype.zoomAdjustment=function(E){return Math.max(0,(this.transform.zoom-E)/1.5)},Ct.prototype.hasTransitions=function(E){return this.stale||E-this.lastPlacementChangeTime<this.fadeDuration},Ct.prototype.stillRecent=function(E,z){var R=this.zoomAtLastRecencyCheck===z?1-this.zoomAdjustment(z):1;return this.zoomAtLastRecencyCheck=z,this.commitTime+this.fadeDuration*R>E},Ct.prototype.setStale=function(){this.stale=!0};var cr=Math.pow(2,25),_r=Math.pow(2,24),Vr=Math.pow(2,17),jr=Math.pow(2,16),vr=Math.pow(2,9),br=Math.pow(2,8),Ar=Math.pow(2,1);function kr(E){if(E.opacity===0&&!E.placed)return 0;if(E.opacity===1&&E.placed)return 4294967295;var z=E.placed?1:0,R=Math.floor(127*E.opacity);return R*cr+z*_r+R*Vr+z*jr+R*vr+z*br+R*Ar+z}var Cr=0,Hr=function(E){this._sortAcrossTiles=E.layout.get("symbol-z-order")!=="viewport-y"&&E.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Hr.prototype.continuePlacement=function(E,z,R,U,ne){for(var le=this._bucketParts;this._currentTileIndex<E.length;){var pe=E[this._currentTileIndex];if(z.getBucketParts(le,U,pe,this._sortAcrossTiles),this._currentTileIndex++,ne())return!0}for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,le.sort(function(Te,Ne){return Te.sortKey-Ne.sortKey}));this._currentPartIndex<le.length;){var ye=le[this._currentPartIndex];if(z.placeLayerBucketPart(ye,this._seenCrossTileIDs,R),this._currentPartIndex++,ne())return!0}return!1};var ln=function(E,z,R,U,ne,le,pe){this.placement=new Ct(E,ne,le,pe),this._currentPlacementIndex=z.length-1,this._forceFullPlacement=R,this._showCollisionBoxes=U,this._done=!1};ln.prototype.isDone=function(){return this._done},ln.prototype.continuePlacement=function(E,z,R){for(var U=this,ne=e.browser.now(),le=function(){var Te=e.browser.now()-ne;return!U._forceFullPlacement&&Te>2};this._currentPlacementIndex>=0;){var pe=z[E[this._currentPlacementIndex]],ye=this.placement.collisionIndex.transform.zoom;if(pe.type==="symbol"&&(!pe.minzoom||pe.minzoom<=ye)&&(!pe.maxzoom||pe.maxzoom>ye)){if(this._inProgressLayer||(this._inProgressLayer=new Hr(pe)),this._inProgressLayer.continuePlacement(R[pe.source],this.placement,this._showCollisionBoxes,pe,le))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},ln.prototype.commit=function(E){return this.placement.commit(E),this.placement};var xn=512/e.EXTENT/2,Zr=function(E,z,R){this.tileID=E,this.indexedSymbolInstances={},this.bucketInstanceId=R;for(var U=0;U<z.length;U++){var ne=z.get(U),le=ne.key;this.indexedSymbolInstances[le]||(this.indexedSymbolInstances[le]=[]),this.indexedSymbolInstances[le].push({crossTileID:ne.crossTileID,coord:this.getScaledCoordinates(ne,E)})}};Zr.prototype.getScaledCoordinates=function(E,z){var R=z.canonical.z-this.tileID.canonical.z,U=xn/Math.pow(2,R);return{x:Math.floor((z.canonical.x*e.EXTENT+E.anchorX)*U),y:Math.floor((z.canonical.y*e.EXTENT+E.anchorY)*U)}},Zr.prototype.findMatches=function(E,z,R){for(var U=this.tileID.canonical.z<z.canonical.z?1:Math.pow(2,this.tileID.canonical.z-z.canonical.z),ne=0;ne<E.length;ne++){var le=E.get(ne);if(!le.crossTileID){var pe=this.indexedSymbolInstances[le.key];if(pe)for(var ye=this.getScaledCoordinates(le,z),Te=0,Ne=pe;Te<Ne.length;Te+=1){var qe=Ne[Te];if(Math.abs(qe.coord.x-ye.x)<=U&&Math.abs(qe.coord.y-ye.y)<=U&&!R[qe.crossTileID]){R[qe.crossTileID]=!0,le.crossTileID=qe.crossTileID;break}}}}};var yn=function(){this.maxCrossTileID=0};yn.prototype.generate=function(){return++this.maxCrossTileID};var Ir=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Ir.prototype.handleWrapJump=function(E){var z=Math.round((E-this.lng)/360);if(z!==0)for(var R in this.indexes){var U=this.indexes[R],ne={};for(var le in U){var pe=U[le];pe.tileID=pe.tileID.unwrapTo(pe.tileID.wrap+z),ne[pe.tileID.key]=pe}this.indexes[R]=ne}this.lng=E},Ir.prototype.addBucket=function(E,z,R){if(this.indexes[E.overscaledZ]&&this.indexes[E.overscaledZ][E.key]){if(this.indexes[E.overscaledZ][E.key].bucketInstanceId===z.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(E.overscaledZ,this.indexes[E.overscaledZ][E.key])}for(var U=0;U<z.symbolInstances.length;U++)z.symbolInstances.get(U).crossTileID=0;this.usedCrossTileIDs[E.overscaledZ]||(this.usedCrossTileIDs[E.overscaledZ]={});var ne=this.usedCrossTileIDs[E.overscaledZ];for(var le in this.indexes){var pe=this.indexes[le];if(Number(le)>E.overscaledZ)for(var ye in pe){var Te=pe[ye];Te.tileID.isChildOf(E)&&Te.findMatches(z.symbolInstances,E,ne)}else{var Ne=pe[E.scaledTo(Number(le)).key];Ne&&Ne.findMatches(z.symbolInstances,E,ne)}}for(var qe=0;qe<z.symbolInstances.length;qe++){var tt=z.symbolInstances.get(qe);tt.crossTileID||(tt.crossTileID=R.generate(),ne[tt.crossTileID]=!0)}return this.indexes[E.overscaledZ]===void 0&&(this.indexes[E.overscaledZ]={}),this.indexes[E.overscaledZ][E.key]=new Zr(E,z.symbolInstances,z.bucketInstanceId),!0},Ir.prototype.removeBucketCrossTileIDs=function(E,z){for(var R in z.indexedSymbolInstances)for(var U=0,ne=z.indexedSymbolInstances[R];U<ne.length;U+=1){var le=ne[U];delete this.usedCrossTileIDs[E][le.crossTileID]}},Ir.prototype.removeStaleBuckets=function(E){var z=!1;for(var R in this.indexes){var U=this.indexes[R];for(var ne in U)E[U[ne].bucketInstanceId]||(this.removeBucketCrossTileIDs(R,U[ne]),delete U[ne],z=!0)}return z};var Gr=function(){this.layerIndexes={},this.crossTileIDs=new yn,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Gr.prototype.addLayer=function(E,z,R){var U=this.layerIndexes[E.id];U===void 0&&(U=this.layerIndexes[E.id]=new Ir);var ne=!1,le={};U.handleWrapJump(R);for(var pe=0,ye=z;pe<ye.length;pe+=1){var Te=ye[pe],Ne=Te.getBucket(E);Ne&&E.id===Ne.layerIds[0]&&(Ne.bucketInstanceId||(Ne.bucketInstanceId=++this.maxBucketInstanceId),U.addBucket(Te.tileID,Ne,this.crossTileIDs)&&(ne=!0),le[Ne.bucketInstanceId]=!0)}return U.removeStaleBuckets(le)&&(ne=!0),ne},Gr.prototype.pruneUnusedLayers=function(E){var z={};for(var R in E.forEach(function(U){z[U]=!0}),this.layerIndexes)z[R]||delete this.layerIndexes[R]};var mn=function(E,z){return e.emitValidationErrors(E,z&&z.filter(function(R){return R.identifier!=="source.canvas"}))},hn=e.pick(Nt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Ln=e.pick(Nt,["setCenter","setZoom","setBearing","setPitch"]),ia=function(){var E={},z=e.styleSpec.$version;for(var R in e.styleSpec.$root){var U=e.styleSpec.$root[R];if(U.required){var ne=null;(ne=R==="version"?z:U.type==="array"?[]:{})!=null&&(E[R]=ne)}}return E}(),qn=function(E){function z(R,U){var ne=this;U===void 0&&(U={}),E.call(this),this.map=R,this.dispatcher=new P(nt(),this),this.imageManager=new y,this.imageManager.setEventedParent(this),this.glyphManager=new w(R._requestManager,U.localIdeographFontFamily),this.lineAtlas=new M(256,512),this.crossTileSymbolIndex=new Gr,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new e.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",e.getReferrer());var le=this;this._rtlTextPluginCallback=z.registerForPluginStateChange(function(pe){var ye={pluginStatus:pe.pluginStatus,pluginURL:pe.pluginURL};le.dispatcher.broadcast("syncRTLPluginState",ye,function(Te,Ne){if(e.triggerPluginCompletionEvent(Te),Ne&&Ne.every(function(tt){return tt}))for(var qe in le.sourceCaches)le.sourceCaches[qe].reload()})}),this.on("data",function(pe){if(pe.dataType==="source"&&pe.sourceDataType==="metadata"){var ye=ne.sourceCaches[pe.sourceId];if(ye){var Te=ye.getSource();if(Te&&Te.vectorLayerIds)for(var Ne in ne._layers){var qe=ne._layers[Ne];qe.source===Te.id&&ne._validateLayer(qe)}}}})}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.loadURL=function(R,U){var ne=this;U===void 0&&(U={}),this.fire(new e.Event("dataloading",{dataType:"style"}));var le=typeof U.validate=="boolean"?U.validate:!e.isMapboxURL(R);R=this.map._requestManager.normalizeStyleURL(R,U.accessToken);var pe=this.map._requestManager.transformRequest(R,e.ResourceType.Style);this._request=e.getJSON(pe,function(ye,Te){ne._request=null,ye?ne.fire(new e.ErrorEvent(ye)):Te&&ne._load(Te,le)})},z.prototype.loadJSON=function(R,U){var ne=this;U===void 0&&(U={}),this.fire(new e.Event("dataloading",{dataType:"style"})),this._request=e.browser.frame(function(){ne._request=null,ne._load(R,U.validate!==!1)})},z.prototype.loadEmpty=function(){this.fire(new e.Event("dataloading",{dataType:"style"})),this._load(ia,!1)},z.prototype._load=function(R,U){if(!U||!mn(this,e.validateStyle(R))){for(var ne in this._loaded=!0,this.stylesheet=R,R.sources)this.addSource(ne,R.sources[ne],{validate:!1});R.sprite?this._loadSprite(R.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(R.glyphs);var le=Ft(this.stylesheet.layers);this._order=le.map(function(Ne){return Ne.id}),this._layers={},this._serializedLayers={};for(var pe=0,ye=le;pe<ye.length;pe+=1){var Te=ye[pe];(Te=e.createStyleLayer(Te)).setEventedParent(this,{layer:{id:Te.id}}),this._layers[Te.id]=Te,this._serializedLayers[Te.id]=Te.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new C(this.stylesheet.light),this.fire(new e.Event("data",{dataType:"style"})),this.fire(new e.Event("style.load"))}},z.prototype._loadSprite=function(R){var U=this;this._spriteRequest=function(ne,le,pe){var ye,Te,Ne,qe=e.browser.devicePixelRatio>1?"@2x":"",tt=e.getJSON(le.transformRequest(le.normalizeSpriteURL(ne,qe,".json"),e.ResourceType.SpriteJSON),function(_t,Tt){tt=null,Ne||(Ne=_t,ye=Tt,St())}),yt=e.getImage(le.transformRequest(le.normalizeSpriteURL(ne,qe,".png"),e.ResourceType.SpriteImage),function(_t,Tt){yt=null,Ne||(Ne=_t,Te=Tt,St())});function St(){if(Ne)pe(Ne);else if(ye&&Te){var _t=e.browser.getImageData(Te),Tt={};for(var gt in ye){var Dt=ye[gt],Ot=Dt.width,Bt=Dt.height,er=Dt.x,ur=Dt.y,Tr=Dt.sdf,wr=Dt.pixelRatio,Xr=Dt.stretchX,Wr=Dt.stretchY,un=Dt.content,an=new e.RGBAImage({width:Ot,height:Bt});e.RGBAImage.copy(_t,an,{x:er,y:ur},{x:0,y:0},{width:Ot,height:Bt}),Tt[gt]={data:an,pixelRatio:wr,sdf:Tr,stretchX:Xr,stretchY:Wr,content:un}}pe(null,Tt)}}return{cancel:function(){tt&&(tt.cancel(),tt=null),yt&&(yt.cancel(),yt=null)}}}(R,this.map._requestManager,function(ne,le){if(U._spriteRequest=null,ne)U.fire(new e.ErrorEvent(ne));else if(le)for(var pe in le)U.imageManager.addImage(pe,le[pe]);U.imageManager.setLoaded(!0),U._availableImages=U.imageManager.listImages(),U.dispatcher.broadcast("setImages",U._availableImages),U.fire(new e.Event("data",{dataType:"style"}))})},z.prototype._validateLayer=function(R){var U=this.sourceCaches[R.source];if(U){var ne=R.sourceLayer;if(ne){var le=U.getSource();(le.type==="geojson"||le.vectorLayerIds&&le.vectorLayerIds.indexOf(ne)===-1)&&this.fire(new e.ErrorEvent(new Error('Source layer "'+ne+'" does not exist on source "'+le.id+'" as specified by style layer "'+R.id+'"')))}}},z.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var R in this.sourceCaches)if(!this.sourceCaches[R].loaded())return!1;return!!this.imageManager.isLoaded()},z.prototype._serializeLayers=function(R){for(var U=[],ne=0,le=R;ne<le.length;ne+=1){var pe=le[ne],ye=this._layers[pe];ye.type!=="custom"&&U.push(ye.serialize())}return U},z.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var R in this.sourceCaches)if(this.sourceCaches[R].hasTransition())return!0;for(var U in this._layers)if(this._layers[U].hasTransition())return!0;return!1},z.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},z.prototype.update=function(R){if(this._loaded){var U=this._changed;if(this._changed){var ne=Object.keys(this._updatedLayers),le=Object.keys(this._removedLayers);for(var pe in(ne.length||le.length)&&this._updateWorkerLayers(ne,le),this._updatedSources){var ye=this._updatedSources[pe];ye==="reload"?this._reloadSource(pe):ye==="clear"&&this._clearSource(pe)}for(var Te in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[Te].updateTransitions(R);this.light.updateTransitions(R),this._resetUpdates()}for(var Ne in this.sourceCaches)this.sourceCaches[Ne].used=!1;for(var qe=0,tt=this._order;qe<tt.length;qe+=1){var yt=tt[qe],St=this._layers[yt];St.recalculate(R,this._availableImages),!St.isHidden(R.zoom)&&St.source&&(this.sourceCaches[St.source].used=!0)}this.light.recalculate(R),this.z=R.zoom,U&&this.fire(new e.Event("data",{dataType:"style"}))}},z.prototype._updateTilesForChangedImages=function(){var R=Object.keys(this._changedImages);if(R.length){for(var U in this.sourceCaches)this.sourceCaches[U].reloadTilesForDependencies(["icons","patterns"],R);this._changedImages={}}},z.prototype._updateWorkerLayers=function(R,U){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(R),removedIds:U})},z.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},z.prototype.setState=function(R){var U=this;if(this._checkLoaded(),mn(this,e.validateStyle(R)))return!1;(R=e.clone$1(R)).layers=Ft(R.layers);var ne=Yt(this.serialize(),R).filter(function(pe){return!(pe.command in Ln)});if(ne.length===0)return!1;var le=ne.filter(function(pe){return!(pe.command in hn)});if(le.length>0)throw new Error("Unimplemented: "+le.map(function(pe){return pe.command}).join(", ")+".");return ne.forEach(function(pe){pe.command!=="setTransition"&&U[pe.command].apply(U,pe.args)}),this.stylesheet=R,!0},z.prototype.addImage=function(R,U){if(this.getImage(R))return this.fire(new e.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(R,U),this._availableImages=this.imageManager.listImages(),this._changedImages[R]=!0,this._changed=!0,this.fire(new e.Event("data",{dataType:"style"}))},z.prototype.updateImage=function(R,U){this.imageManager.updateImage(R,U)},z.prototype.getImage=function(R){return this.imageManager.getImage(R)},z.prototype.removeImage=function(R){if(!this.getImage(R))return this.fire(new e.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(R),this._availableImages=this.imageManager.listImages(),this._changedImages[R]=!0,this._changed=!0,this.fire(new e.Event("data",{dataType:"style"}))},z.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},z.prototype.addSource=function(R,U,ne){var le=this;if(ne===void 0&&(ne={}),this._checkLoaded(),this.sourceCaches[R]!==void 0)throw new Error("There is already a source with this ID");if(!U.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(U).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(U.type)>=0)||!this._validate(e.validateStyle.source,"sources."+R,U,null,ne)){this.map&&this.map._collectResourceTiming&&(U.collectResourceTiming=!0);var pe=this.sourceCaches[R]=new Xe(R,U,this.dispatcher);pe.style=this,pe.setEventedParent(this,function(){return{isSourceLoaded:le.loaded(),source:pe.serialize(),sourceId:R}}),pe.onAdd(this.map),this._changed=!0}},z.prototype.removeSource=function(R){if(this._checkLoaded(),this.sourceCaches[R]===void 0)throw new Error("There is no source with this ID");for(var U in this._layers)if(this._layers[U].source===R)return this.fire(new e.ErrorEvent(new Error('Source "'+R+'" cannot be removed while layer "'+U+'" is using it.')));var ne=this.sourceCaches[R];delete this.sourceCaches[R],delete this._updatedSources[R],ne.fire(new e.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:R})),ne.setEventedParent(null),ne.clearTiles(),ne.onRemove&&ne.onRemove(this.map),this._changed=!0},z.prototype.setGeoJSONSourceData=function(R,U){this._checkLoaded(),this.sourceCaches[R].getSource().setData(U),this._changed=!0},z.prototype.getSource=function(R){return this.sourceCaches[R]&&this.sourceCaches[R].getSource()},z.prototype.addLayer=function(R,U,ne){ne===void 0&&(ne={}),this._checkLoaded();var le=R.id;if(this.getLayer(le))this.fire(new e.ErrorEvent(new Error('Layer with id "'+le+'" already exists on this map')));else{var pe;if(R.type==="custom"){if(mn(this,e.validateCustomStyleLayer(R)))return;pe=e.createStyleLayer(R)}else{if(typeof R.source=="object"&&(this.addSource(le,R.source),R=e.clone$1(R),R=e.extend(R,{source:le})),this._validate(e.validateStyle.layer,"layers."+le,R,{arrayIndex:-1},ne))return;pe=e.createStyleLayer(R),this._validateLayer(pe),pe.setEventedParent(this,{layer:{id:le}}),this._serializedLayers[pe.id]=pe.serialize()}var ye=U?this._order.indexOf(U):this._order.length;if(U&&ye===-1)this.fire(new e.ErrorEvent(new Error('Layer with id "'+U+'" does not exist on this map.')));else{if(this._order.splice(ye,0,le),this._layerOrderChanged=!0,this._layers[le]=pe,this._removedLayers[le]&&pe.source&&pe.type!=="custom"){var Te=this._removedLayers[le];delete this._removedLayers[le],Te.type!==pe.type?this._updatedSources[pe.source]="clear":(this._updatedSources[pe.source]="reload",this.sourceCaches[pe.source].pause())}this._updateLayer(pe),pe.onAdd&&pe.onAdd(this.map)}}},z.prototype.moveLayer=function(R,U){if(this._checkLoaded(),this._changed=!0,this._layers[R]){if(R!==U){var ne=this._order.indexOf(R);this._order.splice(ne,1);var le=U?this._order.indexOf(U):this._order.length;U&&le===-1?this.fire(new e.ErrorEvent(new Error('Layer with id "'+U+'" does not exist on this map.'))):(this._order.splice(le,0,R),this._layerOrderChanged=!0)}}else this.fire(new e.ErrorEvent(new Error("The layer '"+R+"' does not exist in the map's style and cannot be moved.")))},z.prototype.removeLayer=function(R){this._checkLoaded();var U=this._layers[R];if(U){U.setEventedParent(null);var ne=this._order.indexOf(R);this._order.splice(ne,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[R]=U,delete this._layers[R],delete this._serializedLayers[R],delete this._updatedLayers[R],delete this._updatedPaintProps[R],U.onRemove&&U.onRemove(this.map)}else this.fire(new e.ErrorEvent(new Error("The layer '"+R+"' does not exist in the map's style and cannot be removed.")))},z.prototype.getLayer=function(R){return this._layers[R]},z.prototype.hasLayer=function(R){return R in this._layers},z.prototype.setLayerZoomRange=function(R,U,ne){this._checkLoaded();var le=this.getLayer(R);le?le.minzoom===U&&le.maxzoom===ne||(U!=null&&(le.minzoom=U),ne!=null&&(le.maxzoom=ne),this._updateLayer(le)):this.fire(new e.ErrorEvent(new Error("The layer '"+R+"' does not exist in the map's style and cannot have zoom extent.")))},z.prototype.setFilter=function(R,U,ne){ne===void 0&&(ne={}),this._checkLoaded();var le=this.getLayer(R);if(le){if(!e.deepEqual(le.filter,U))return U==null?(le.filter=void 0,void this._updateLayer(le)):void(this._validate(e.validateStyle.filter,"layers."+le.id+".filter",U,null,ne)||(le.filter=e.clone$1(U),this._updateLayer(le)))}else this.fire(new e.ErrorEvent(new Error("The layer '"+R+"' does not exist in the map's style and cannot be filtered.")))},z.prototype.getFilter=function(R){return e.clone$1(this.getLayer(R).filter)},z.prototype.setLayoutProperty=function(R,U,ne,le){le===void 0&&(le={}),this._checkLoaded();var pe=this.getLayer(R);pe?e.deepEqual(pe.getLayoutProperty(U),ne)||(pe.setLayoutProperty(U,ne,le),this._updateLayer(pe)):this.fire(new e.ErrorEvent(new Error("The layer '"+R+"' does not exist in the map's style and cannot be styled.")))},z.prototype.getLayoutProperty=function(R,U){var ne=this.getLayer(R);if(ne)return ne.getLayoutProperty(U);this.fire(new e.ErrorEvent(new Error("The layer '"+R+"' does not exist in the map's style.")))},z.prototype.setPaintProperty=function(R,U,ne,le){le===void 0&&(le={}),this._checkLoaded();var pe=this.getLayer(R);pe?e.deepEqual(pe.getPaintProperty(U),ne)||(pe.setPaintProperty(U,ne,le)&&this._updateLayer(pe),this._changed=!0,this._updatedPaintProps[R]=!0):this.fire(new e.ErrorEvent(new Error("The layer '"+R+"' does not exist in the map's style and cannot be styled.")))},z.prototype.getPaintProperty=function(R,U){return this.getLayer(R).getPaintProperty(U)},z.prototype.setFeatureState=function(R,U){this._checkLoaded();var ne=R.source,le=R.sourceLayer,pe=this.sourceCaches[ne];if(pe!==void 0){var ye=pe.getSource().type;ye==="geojson"&&le?this.fire(new e.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):ye!=="vector"||le?(R.id===void 0&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),pe.setFeatureState(le,R.id,U)):this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+ne+"' does not exist in the map's style.")))},z.prototype.removeFeatureState=function(R,U){this._checkLoaded();var ne=R.source,le=this.sourceCaches[ne];if(le!==void 0){var pe=le.getSource().type,ye=pe==="vector"?R.sourceLayer:void 0;pe!=="vector"||ye?U&&typeof R.id!="string"&&typeof R.id!="number"?this.fire(new e.ErrorEvent(new Error("A feature id is requred to remove its specific state property."))):le.removeFeatureState(ye,R.id,U):this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+ne+"' does not exist in the map's style.")))},z.prototype.getFeatureState=function(R){this._checkLoaded();var U=R.source,ne=R.sourceLayer,le=this.sourceCaches[U];if(le!==void 0){if(le.getSource().type!=="vector"||ne)return R.id===void 0&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),le.getFeatureState(ne,R.id);this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+U+"' does not exist in the map's style.")))},z.prototype.getTransition=function(){return e.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},z.prototype.serialize=function(){return e.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:e.mapObject(this.sourceCaches,function(R){return R.serialize()}),layers:this._serializeLayers(this._order)},function(R){return R!==void 0})},z.prototype._updateLayer=function(R){this._updatedLayers[R.id]=!0,R.source&&!this._updatedSources[R.source]&&this.sourceCaches[R.source].getSource().type!=="raster"&&(this._updatedSources[R.source]="reload",this.sourceCaches[R.source].pause()),this._changed=!0},z.prototype._flattenAndSortRenderedFeatures=function(R){for(var U=this,ne=function(un){return U._layers[un].type==="fill-extrusion"},le={},pe=[],ye=this._order.length-1;ye>=0;ye--){var Te=this._order[ye];if(ne(Te)){le[Te]=ye;for(var Ne=0,qe=R;Ne<qe.length;Ne+=1){var tt=qe[Ne][Te];if(tt)for(var yt=0,St=tt;yt<St.length;yt+=1){var _t=St[yt];pe.push(_t)}}}}pe.sort(function(un,an){return an.intersectionZ-un.intersectionZ});for(var Tt=[],gt=this._order.length-1;gt>=0;gt--){var Dt=this._order[gt];if(ne(Dt))for(var Ot=pe.length-1;Ot>=0;Ot--){var Bt=pe[Ot].feature;if(le[Bt.layer.id]<gt)break;Tt.push(Bt),pe.pop()}else for(var er=0,ur=R;er<ur.length;er+=1){var Tr=ur[er][Dt];if(Tr)for(var wr=0,Xr=Tr;wr<Xr.length;wr+=1){var Wr=Xr[wr];Tt.push(Wr.feature)}}}return Tt},z.prototype.queryRenderedFeatures=function(R,U,ne){U&&U.filter&&this._validate(e.validateStyle.filter,"queryRenderedFeatures.filter",U.filter,null,U);var le={};if(U&&U.layers){if(!Array.isArray(U.layers))return this.fire(new e.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var pe=0,ye=U.layers;pe<ye.length;pe+=1){var Te=ye[pe],Ne=this._layers[Te];if(!Ne)return this.fire(new e.ErrorEvent(new Error("The layer '"+Te+"' does not exist in the map's style and cannot be queried for features."))),[];le[Ne.source]=!0}}var qe=[];for(var tt in U.availableImages=this._availableImages,this.sourceCaches)U.layers&&!le[tt]||qe.push(q(this.sourceCaches[tt],this._layers,this._serializedLayers,R,U,ne));return this.placement&&qe.push(function(yt,St,_t,Tt,gt,Dt,Ot){for(var Bt={},er=Dt.queryRenderedSymbols(Tt),ur=[],Tr=0,wr=Object.keys(er).map(Number);Tr<wr.length;Tr+=1){var Xr=wr[Tr];ur.push(Ot[Xr])}ur.sort(ee);for(var Wr=function(){var sa=an[un],Nr=sa.featureIndex.lookupSymbolFeatures(er[sa.bucketInstanceId],St,sa.bucketIndex,sa.sourceLayerIndex,gt.filter,gt.layers,gt.availableImages,yt);for(var wn in Nr){var Wn=Bt[wn]=Bt[wn]||[],Vn=Nr[wn];Vn.sort(function(Zn,va){var da=sa.featureSortOrder;if(da){var Sa=da.indexOf(Zn.featureIndex);return da.indexOf(va.featureIndex)-Sa}return va.featureIndex-Zn.featureIndex});for(var $n=0,ca=Vn;$n<ca.length;$n+=1){var Ta=ca[$n];Wn.push(Ta)}}},un=0,an=ur;un<an.length;un+=1)Wr();var Nn=function(sa){Bt[sa].forEach(function(Nr){var wn=Nr.feature,Wn=yt[sa],Vn=_t[Wn.source].getFeatureState(wn.layer["source-layer"],wn.id);wn.source=wn.layer.source,wn.layer["source-layer"]&&(wn.sourceLayer=wn.layer["source-layer"]),wn.state=Vn})};for(var Yn in Bt)Nn(Yn);return Bt}(this._layers,this._serializedLayers,this.sourceCaches,R,U,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(qe)},z.prototype.querySourceFeatures=function(R,U){U&&U.filter&&this._validate(e.validateStyle.filter,"querySourceFeatures.filter",U.filter,null,U);var ne=this.sourceCaches[R];return ne?function(le,pe){for(var ye=le.getRenderableIds().map(function(St){return le.getTileByID(St)}),Te=[],Ne={},qe=0;qe<ye.length;qe++){var tt=ye[qe],yt=tt.tileID.canonical.key;Ne[yt]||(Ne[yt]=!0,tt.querySourceFeatures(Te,pe))}return Te}(ne,U):[]},z.prototype.addSourceType=function(R,U,ne){return z.getSourceType(R)?ne(new Error('A source type called "'+R+'" already exists.')):(z.setSourceType(R,U),U.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:R,url:U.workerSourceURL},ne):ne(null,null))},z.prototype.getLight=function(){return this.light.getLight()},z.prototype.setLight=function(R,U){U===void 0&&(U={}),this._checkLoaded();var ne=this.light.getLight(),le=!1;for(var pe in R)if(!e.deepEqual(R[pe],ne[pe])){le=!0;break}if(le){var ye={now:e.browser.now(),transition:e.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(R,U),this.light.updateTransitions(ye)}},z.prototype._validate=function(R,U,ne,le,pe){return pe===void 0&&(pe={}),(!pe||pe.validate!==!1)&&mn(this,R.call(e.validateStyle,e.extend({key:U,style:this.serialize(),value:ne,styleSpec:e.styleSpec},le)))},z.prototype._remove=function(){for(var R in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),e.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[R].setEventedParent(null);for(var U in this.sourceCaches)this.sourceCaches[U].clearTiles(),this.sourceCaches[U].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},z.prototype._clearSource=function(R){this.sourceCaches[R].clearTiles()},z.prototype._reloadSource=function(R){this.sourceCaches[R].resume(),this.sourceCaches[R].reload()},z.prototype._updateSources=function(R){for(var U in this.sourceCaches)this.sourceCaches[U].update(R)},z.prototype._generateCollisionBoxes=function(){for(var R in this.sourceCaches)this._reloadSource(R)},z.prototype._updatePlacement=function(R,U,ne,le,pe){pe===void 0&&(pe=!1);for(var ye=!1,Te=!1,Ne={},qe=0,tt=this._order;qe<tt.length;qe+=1){var yt=tt[qe],St=this._layers[yt];if(St.type==="symbol"){if(!Ne[St.source]){var _t=this.sourceCaches[St.source];Ne[St.source]=_t.getRenderableIds(!0).map(function(er){return _t.getTileByID(er)}).sort(function(er,ur){return ur.tileID.overscaledZ-er.tileID.overscaledZ||(er.tileID.isLessThan(ur.tileID)?-1:1)})}var Tt=this.crossTileSymbolIndex.addLayer(St,Ne[St.source],R.center.lng);ye=ye||Tt}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((pe=pe||this._layerOrderChanged||ne===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(e.browser.now(),R.zoom))&&(this.pauseablePlacement=new ln(R,this._order,pe,U,ne,le,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,Ne),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(e.browser.now()),Te=!0),ye&&this.pauseablePlacement.placement.setStale()),Te||ye)for(var gt=0,Dt=this._order;gt<Dt.length;gt+=1){var Ot=Dt[gt],Bt=this._layers[Ot];Bt.type==="symbol"&&this.placement.updateLayerOpacities(Bt,Ne[Bt.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(e.browser.now())},z.prototype._releaseSymbolFadeTiles=function(){for(var R in this.sourceCaches)this.sourceCaches[R].releaseSymbolFadeTiles()},z.prototype.getImages=function(R,U,ne){this.imageManager.getImages(U.icons,ne),this._updateTilesForChangedImages();var le=this.sourceCaches[U.source];le&&le.setDependencies(U.tileID.key,U.type,U.icons)},z.prototype.getGlyphs=function(R,U,ne){this.glyphManager.getGlyphs(U.stacks,ne)},z.prototype.getResource=function(R,U,ne){return e.makeRequest(U,ne)},z}(e.Evented);qn.getSourceType=function(E){return D[E]},qn.setSourceType=function(E,z){D[E]=z},qn.registerForPluginStateChange=e.registerForPluginStateChange;var gn=e.createLayout([{name:"a_pos",type:"Int16",components:2}]),ta=qa(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),fa=qa(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Za=qa(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Pi=qa(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),ni=qa("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),yi=qa(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),Aa=qa(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),ja=qa("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),co=qa("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Bo=qa("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),Wo=qa(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),qi=qa(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Wi=qa(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),No=qa(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),Ha=qa(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),ko=qa(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),uo=qa(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform float u_maxzoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggeration=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/ pow(2.0,(u_zoom-u_maxzoom)*exaggeration+19.2562-u_zoom);gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),xi=qa(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Xi=qa(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),fo=qa(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp float v_lineprogress;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,vec2(v_lineprogress,0.5));gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define MAX_LINE_DISTANCE 32767.0
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_lineprogress;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_lineprogress=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0/MAX_LINE_DISTANCE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),_o=qa(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),Di=qa(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),fi=qa(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Gi=qa(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),ys=qa(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),ws=qa(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function qa(E,z){var R=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,U={};return{fragmentSource:E=E.replace(R,function(ne,le,pe,ye,Te){return U[Te]=!0,le==="define"?`
#ifndef HAS_UNIFORM_u_`+Te+`
varying `+pe+" "+ye+" "+Te+`;
#else
uniform `+pe+" "+ye+" u_"+Te+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+Te+`
    `+pe+" "+ye+" "+Te+" = u_"+Te+`;
#endif
`}),vertexSource:z=z.replace(R,function(ne,le,pe,ye,Te){var Ne=ye==="float"?"vec2":"vec4",qe=Te.match(/color/)?"color":Ne;return U[Te]?le==="define"?`
#ifndef HAS_UNIFORM_u_`+Te+`
uniform lowp float u_`+Te+`_t;
attribute `+pe+" "+Ne+" a_"+Te+`;
varying `+pe+" "+ye+" "+Te+`;
#else
uniform `+pe+" "+ye+" u_"+Te+`;
#endif
`:qe==="vec4"?`
#ifndef HAS_UNIFORM_u_`+Te+`
    `+Te+" = a_"+Te+`;
#else
    `+pe+" "+ye+" "+Te+" = u_"+Te+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+Te+`
    `+Te+" = unpack_mix_"+qe+"(a_"+Te+", u_"+Te+`_t);
#else
    `+pe+" "+ye+" "+Te+" = u_"+Te+`;
#endif
`:le==="define"?`
#ifndef HAS_UNIFORM_u_`+Te+`
uniform lowp float u_`+Te+`_t;
attribute `+pe+" "+Ne+" a_"+Te+`;
#else
uniform `+pe+" "+ye+" u_"+Te+`;
#endif
`:qe==="vec4"?`
#ifndef HAS_UNIFORM_u_`+Te+`
    `+pe+" "+ye+" "+Te+" = a_"+Te+`;
#else
    `+pe+" "+ye+" "+Te+" = u_"+Te+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+Te+`
    `+pe+" "+ye+" "+Te+" = unpack_mix_"+qe+"(a_"+Te+", u_"+Te+`_t);
#else
    `+pe+" "+ye+" "+Te+" = u_"+Te+`;
#endif
`})}}var hs=Object.freeze({__proto__:null,prelude:ta,background:fa,backgroundPattern:Za,circle:Pi,clippingMask:ni,heatmap:yi,heatmapTexture:Aa,collisionBox:ja,collisionCircle:co,debug:Bo,fill:Wo,fillOutline:qi,fillOutlinePattern:Wi,fillPattern:No,fillExtrusion:Ha,fillExtrusionPattern:ko,hillshadePrepare:uo,hillshade:xi,line:Xi,lineGradient:fo,linePattern:_o,lineSDF:Di,raster:fi,symbolIcon:Gi,symbolSDF:ys,symbolTextAndIcon:ws}),Qo=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};Qo.prototype.bind=function(E,z,R,U,ne,le,pe,ye){this.context=E;for(var Te=this.boundPaintVertexBuffers.length!==U.length,Ne=0;!Te&&Ne<U.length;Ne++)this.boundPaintVertexBuffers[Ne]!==U[Ne]&&(Te=!0);var qe=!this.vao||this.boundProgram!==z||this.boundLayoutVertexBuffer!==R||Te||this.boundIndexBuffer!==ne||this.boundVertexOffset!==le||this.boundDynamicVertexBuffer!==pe||this.boundDynamicVertexBuffer2!==ye;!E.extVertexArrayObject||qe?this.freshBind(z,R,U,ne,le,pe,ye):(E.bindVertexArrayOES.set(this.vao),pe&&pe.bind(),ne&&ne.dynamicDraw&&ne.bind(),ye&&ye.bind())},Qo.prototype.freshBind=function(E,z,R,U,ne,le,pe){var ye,Te=E.numAttributes,Ne=this.context,qe=Ne.gl;if(Ne.extVertexArrayObject)this.vao&&this.destroy(),this.vao=Ne.extVertexArrayObject.createVertexArrayOES(),Ne.bindVertexArrayOES.set(this.vao),ye=0,this.boundProgram=E,this.boundLayoutVertexBuffer=z,this.boundPaintVertexBuffers=R,this.boundIndexBuffer=U,this.boundVertexOffset=ne,this.boundDynamicVertexBuffer=le,this.boundDynamicVertexBuffer2=pe;else{ye=Ne.currentNumAttributes||0;for(var tt=Te;tt<ye;tt++)qe.disableVertexAttribArray(tt)}z.enableAttributes(qe,E);for(var yt=0,St=R;yt<St.length;yt+=1)St[yt].enableAttributes(qe,E);le&&le.enableAttributes(qe,E),pe&&pe.enableAttributes(qe,E),z.bind(),z.setVertexAttribPointers(qe,E,ne);for(var _t=0,Tt=R;_t<Tt.length;_t+=1){var gt=Tt[_t];gt.bind(),gt.setVertexAttribPointers(qe,E,ne)}le&&(le.bind(),le.setVertexAttribPointers(qe,E,ne)),U&&U.bind(),pe&&(pe.bind(),pe.setVertexAttribPointers(qe,E,ne)),Ne.currentNumAttributes=Te},Qo.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var Ts=function(E,z,R,U,ne){var le=E.gl;this.program=le.createProgram();var pe=R?R.defines():[];ne&&pe.push("#define OVERDRAW_INSPECTOR;");var ye=pe.concat(ta.fragmentSource,z.fragmentSource).join(`
`),Te=pe.concat(ta.vertexSource,z.vertexSource).join(`
`),Ne=le.createShader(le.FRAGMENT_SHADER);if(le.isContextLost())this.failedToCreate=!0;else{le.shaderSource(Ne,ye),le.compileShader(Ne),le.attachShader(this.program,Ne);var qe=le.createShader(le.VERTEX_SHADER);if(le.isContextLost())this.failedToCreate=!0;else{le.shaderSource(qe,Te),le.compileShader(qe),le.attachShader(this.program,qe);for(var tt=R?R.layoutAttributes:[],yt=0;yt<tt.length;yt++)le.bindAttribLocation(this.program,yt,tt[yt].name);le.linkProgram(this.program),le.deleteShader(qe),le.deleteShader(Ne),this.numAttributes=le.getProgramParameter(this.program,le.ACTIVE_ATTRIBUTES),this.attributes={};for(var St={},_t=0;_t<this.numAttributes;_t++){var Tt=le.getActiveAttrib(this.program,_t);Tt&&(this.attributes[Tt.name]=le.getAttribLocation(this.program,Tt.name))}for(var gt=le.getProgramParameter(this.program,le.ACTIVE_UNIFORMS),Dt=0;Dt<gt;Dt++){var Ot=le.getActiveUniform(this.program,Dt);Ot&&(St[Ot.name]=le.getUniformLocation(this.program,Ot.name))}this.fixedUniforms=U(E,St),this.binderUniforms=R?R.getUniforms(E,St):[]}}};function ks(E,z,R){var U=1/Lr(R,1,z.transform.tileZoom),ne=Math.pow(2,R.tileID.overscaledZ),le=R.tileSize*Math.pow(2,z.transform.tileZoom)/ne,pe=le*(R.tileID.canonical.x+R.tileID.wrap*ne),ye=le*R.tileID.canonical.y;return{u_image:0,u_texsize:R.imageAtlasTexture.size,u_scale:[U,E.fromScale,E.toScale],u_fade:E.t,u_pixel_coord_upper:[pe>>16,ye>>16],u_pixel_coord_lower:[65535&pe,65535&ye]}}Ts.prototype.draw=function(E,z,R,U,ne,le,pe,ye,Te,Ne,qe,tt,yt,St,_t,Tt){var gt,Dt=E.gl;if(!this.failedToCreate){for(var Ot in E.program.set(this.program),E.setDepthMode(R),E.setStencilMode(U),E.setColorMode(ne),E.setCullFace(le),this.fixedUniforms)this.fixedUniforms[Ot].set(pe[Ot]);St&&St.setUniforms(E,this.binderUniforms,tt,{zoom:yt});for(var Bt=(gt={},gt[Dt.LINES]=2,gt[Dt.TRIANGLES]=3,gt[Dt.LINE_STRIP]=1,gt)[z],er=0,ur=qe.get();er<ur.length;er+=1){var Tr=ur[er],wr=Tr.vaos||(Tr.vaos={});(wr[ye]||(wr[ye]=new Qo)).bind(E,this,Te,St?St.getPaintVertexBuffers():[],Ne,Tr.vertexOffset,_t,Tt),Dt.drawElements(z,Tr.primitiveLength*Bt,Dt.UNSIGNED_SHORT,Tr.primitiveOffset*Bt*2)}}};var xs=function(E,z,R,U){var ne=z.style.light,le=ne.properties.get("position"),pe=[le.x,le.y,le.z],ye=e.create$1();ne.properties.get("anchor")==="viewport"&&e.fromRotation(ye,-z.transform.angle),e.transformMat3(pe,pe,ye);var Te=ne.properties.get("color");return{u_matrix:E,u_lightpos:pe,u_lightintensity:ne.properties.get("intensity"),u_lightcolor:[Te.r,Te.g,Te.b],u_vertical_gradient:+R,u_opacity:U}},As=function(E,z,R,U,ne,le,pe){return e.extend(xs(E,z,R,U),ks(le,z,pe),{u_height_factor:-Math.pow(2,ne.overscaledZ)/pe.tileSize/8})},Ao=function(E){return{u_matrix:E}},Mo=function(E,z,R,U){return e.extend(Ao(E),ks(R,z,U))},jo=function(E,z){return{u_matrix:E,u_world:z}},Uo=function(E,z,R,U,ne){return e.extend(Mo(E,z,R,U),{u_world:ne})},Vo=function(E,z,R,U){var ne,le,pe=E.transform;if(U.paint.get("circle-pitch-alignment")==="map"){var ye=Lr(R,1,pe.zoom);ne=!0,le=[ye,ye]}else ne=!1,le=pe.pixelsToGLUnits;return{u_camera_to_center_distance:pe.cameraToCenterDistance,u_scale_with_map:+(U.paint.get("circle-pitch-scale")==="map"),u_matrix:E.translatePosMatrix(z.posMatrix,R,U.paint.get("circle-translate"),U.paint.get("circle-translate-anchor")),u_pitch_with_map:+ne,u_device_pixel_ratio:e.browser.devicePixelRatio,u_extrude_scale:le}},$o=function(E,z,R){var U=Lr(R,1,z.zoom),ne=Math.pow(2,z.zoom-R.tileID.overscaledZ),le=R.tileID.overscaleFactor();return{u_matrix:E,u_camera_to_center_distance:z.cameraToCenterDistance,u_pixels_to_tile_units:U,u_extrude_scale:[z.pixelsToGLUnits[0]/(U*ne),z.pixelsToGLUnits[1]/(U*ne)],u_overscale_factor:le}},ho=function(E,z,R){return{u_matrix:E,u_inv_matrix:z,u_camera_to_center_distance:R.cameraToCenterDistance,u_viewport_size:[R.width,R.height]}},ps=function(E,z,R){return R===void 0&&(R=1),{u_matrix:E,u_color:z,u_overlay:0,u_overlay_scale:R}},oo=function(E){return{u_matrix:E}},Ho=function(E,z,R,U){return{u_matrix:E,u_extrude_scale:Lr(z,1,R),u_intensity:U}};function ds(E,z){var R=Math.pow(2,z.canonical.z),U=z.canonical.y;return[new e.MercatorCoordinate(0,U/R).toLngLat().lat,new e.MercatorCoordinate(0,(U+1)/R).toLngLat().lat]}var So=function(E,z,R){var U=E.transform;return{u_matrix:at(E,z,R),u_ratio:1/Lr(z,1,U.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_units_to_pixels:[1/U.pixelsToGLUnits[0],1/U.pixelsToGLUnits[1]]}},Ua=function(E,z,R){return e.extend(So(E,z,R),{u_image:0})},Re=function(E,z,R,U){var ne=E.transform,le=Ke(z,ne);return{u_matrix:at(E,z,R),u_texsize:z.imageAtlasTexture.size,u_ratio:1/Lr(z,1,ne.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_image:0,u_scale:[le,U.fromScale,U.toScale],u_fade:U.t,u_units_to_pixels:[1/ne.pixelsToGLUnits[0],1/ne.pixelsToGLUnits[1]]}},Ve=function(E,z,R,U,ne){var le=E.transform,pe=E.lineAtlas,ye=Ke(z,le),Te=R.layout.get("line-cap")==="round",Ne=pe.getDash(U.from,Te),qe=pe.getDash(U.to,Te),tt=Ne.width*ne.fromScale,yt=qe.width*ne.toScale;return e.extend(So(E,z,R),{u_patternscale_a:[ye/tt,-Ne.height/2],u_patternscale_b:[ye/yt,-qe.height/2],u_sdfgamma:pe.width/(256*Math.min(tt,yt)*e.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:Ne.y,u_tex_y_b:qe.y,u_mix:ne.t})};function Ke(E,z){return 1/Lr(E,1,z.tileZoom)}function at(E,z,R){return E.translatePosMatrix(z.tileID.posMatrix,z,R.paint.get("line-translate"),R.paint.get("line-translate-anchor"))}var dt=function(E,z,R,U,ne){return{u_matrix:E,u_tl_parent:z,u_scale_parent:R,u_buffer_scale:1,u_fade_t:U.mix,u_opacity:U.opacity*ne.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:ne.paint.get("raster-brightness-min"),u_brightness_high:ne.paint.get("raster-brightness-max"),u_saturation_factor:(pe=ne.paint.get("raster-saturation"),pe>0?1-1/(1.001-pe):-pe),u_contrast_factor:(le=ne.paint.get("raster-contrast"),le>0?1/(1-le):1+le),u_spin_weights:ht(ne.paint.get("raster-hue-rotate"))};var le,pe};function ht(E){E*=Math.PI/180;var z=Math.sin(E),R=Math.cos(E);return[(2*R+1)/3,(-Math.sqrt(3)*z-R+1)/3,(Math.sqrt(3)*z-R+1)/3]}var Mt,Wt=function(E,z,R,U,ne,le,pe,ye,Te,Ne){var qe=ne.transform;return{u_is_size_zoom_constant:+(E==="constant"||E==="source"),u_is_size_feature_constant:+(E==="constant"||E==="camera"),u_size_t:z?z.uSizeT:0,u_size:z?z.uSize:0,u_camera_to_center_distance:qe.cameraToCenterDistance,u_pitch:qe.pitch/360*2*Math.PI,u_rotate_symbol:+R,u_aspect_ratio:qe.width/qe.height,u_fade_change:ne.options.fadeDuration?ne.symbolFadeChange:1,u_matrix:le,u_label_plane_matrix:pe,u_coord_matrix:ye,u_is_text:+Te,u_pitch_with_map:+U,u_texsize:Ne,u_texture:0}},Jt=function(E,z,R,U,ne,le,pe,ye,Te,Ne,qe){var tt=ne.transform;return e.extend(Wt(E,z,R,U,ne,le,pe,ye,Te,Ne),{u_gamma_scale:U?Math.cos(tt._pitch)*tt.cameraToCenterDistance:1,u_device_pixel_ratio:e.browser.devicePixelRatio,u_is_halo:+qe})},qt=function(E,z,R,U,ne,le,pe,ye,Te,Ne){return e.extend(Jt(E,z,R,U,ne,le,pe,ye,!0,Te,!0),{u_texsize_icon:Ne,u_texture_icon:1})},tr=function(E,z,R){return{u_matrix:E,u_opacity:z,u_color:R}},lr=function(E,z,R,U,ne,le){return e.extend(function(pe,ye,Te,Ne){var qe=Te.imageManager.getPattern(pe.from.toString()),tt=Te.imageManager.getPattern(pe.to.toString()),yt=Te.imageManager.getPixelSize(),St=yt.width,_t=yt.height,Tt=Math.pow(2,Ne.tileID.overscaledZ),gt=Ne.tileSize*Math.pow(2,Te.transform.tileZoom)/Tt,Dt=gt*(Ne.tileID.canonical.x+Ne.tileID.wrap*Tt),Ot=gt*Ne.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:qe.tl,u_pattern_br_a:qe.br,u_pattern_tl_b:tt.tl,u_pattern_br_b:tt.br,u_texsize:[St,_t],u_mix:ye.t,u_pattern_size_a:qe.displaySize,u_pattern_size_b:tt.displaySize,u_scale_a:ye.fromScale,u_scale_b:ye.toScale,u_tile_units_to_pixels:1/Lr(Ne,1,Te.transform.tileZoom),u_pixel_coord_upper:[Dt>>16,Ot>>16],u_pixel_coord_lower:[65535&Dt,65535&Ot]}}(U,le,R,ne),{u_matrix:E,u_opacity:z})},dr={fillExtrusion:function(E,z){return{u_matrix:new e.UniformMatrix4f(E,z.u_matrix),u_lightpos:new e.Uniform3f(E,z.u_lightpos),u_lightintensity:new e.Uniform1f(E,z.u_lightintensity),u_lightcolor:new e.Uniform3f(E,z.u_lightcolor),u_vertical_gradient:new e.Uniform1f(E,z.u_vertical_gradient),u_opacity:new e.Uniform1f(E,z.u_opacity)}},fillExtrusionPattern:function(E,z){return{u_matrix:new e.UniformMatrix4f(E,z.u_matrix),u_lightpos:new e.Uniform3f(E,z.u_lightpos),u_lightintensity:new e.Uniform1f(E,z.u_lightintensity),u_lightcolor:new e.Uniform3f(E,z.u_lightcolor),u_vertical_gradient:new e.Uniform1f(E,z.u_vertical_gradient),u_height_factor:new e.Uniform1f(E,z.u_height_factor),u_image:new e.Uniform1i(E,z.u_image),u_texsize:new e.Uniform2f(E,z.u_texsize),u_pixel_coord_upper:new e.Uniform2f(E,z.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(E,z.u_pixel_coord_lower),u_scale:new e.Uniform3f(E,z.u_scale),u_fade:new e.Uniform1f(E,z.u_fade),u_opacity:new e.Uniform1f(E,z.u_opacity)}},fill:function(E,z){return{u_matrix:new e.UniformMatrix4f(E,z.u_matrix)}},fillPattern:function(E,z){return{u_matrix:new e.UniformMatrix4f(E,z.u_matrix),u_image:new e.Uniform1i(E,z.u_image),u_texsize:new e.Uniform2f(E,z.u_texsize),u_pixel_coord_upper:new e.Uniform2f(E,z.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(E,z.u_pixel_coord_lower),u_scale:new e.Uniform3f(E,z.u_scale),u_fade:new e.Uniform1f(E,z.u_fade)}},fillOutline:function(E,z){return{u_matrix:new e.UniformMatrix4f(E,z.u_matrix),u_world:new e.Uniform2f(E,z.u_world)}},fillOutlinePattern:function(E,z){return{u_matrix:new e.UniformMatrix4f(E,z.u_matrix),u_world:new e.Uniform2f(E,z.u_world),u_image:new e.Uniform1i(E,z.u_image),u_texsize:new e.Uniform2f(E,z.u_texsize),u_pixel_coord_upper:new e.Uniform2f(E,z.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(E,z.u_pixel_coord_lower),u_scale:new e.Uniform3f(E,z.u_scale),u_fade:new e.Uniform1f(E,z.u_fade)}},circle:function(E,z){return{u_camera_to_center_distance:new e.Uniform1f(E,z.u_camera_to_center_distance),u_scale_with_map:new e.Uniform1i(E,z.u_scale_with_map),u_pitch_with_map:new e.Uniform1i(E,z.u_pitch_with_map),u_extrude_scale:new e.Uniform2f(E,z.u_extrude_scale),u_device_pixel_ratio:new e.Uniform1f(E,z.u_device_pixel_ratio),u_matrix:new e.UniformMatrix4f(E,z.u_matrix)}},collisionBox:function(E,z){return{u_matrix:new e.UniformMatrix4f(E,z.u_matrix),u_camera_to_center_distance:new e.Uniform1f(E,z.u_camera_to_center_distance),u_pixels_to_tile_units:new e.Uniform1f(E,z.u_pixels_to_tile_units),u_extrude_scale:new e.Uniform2f(E,z.u_extrude_scale),u_overscale_factor:new e.Uniform1f(E,z.u_overscale_factor)}},collisionCircle:function(E,z){return{u_matrix:new e.UniformMatrix4f(E,z.u_matrix),u_inv_matrix:new e.UniformMatrix4f(E,z.u_inv_matrix),u_camera_to_center_distance:new e.Uniform1f(E,z.u_camera_to_center_distance),u_viewport_size:new e.Uniform2f(E,z.u_viewport_size)}},debug:function(E,z){return{u_color:new e.UniformColor(E,z.u_color),u_matrix:new e.UniformMatrix4f(E,z.u_matrix),u_overlay:new e.Uniform1i(E,z.u_overlay),u_overlay_scale:new e.Uniform1f(E,z.u_overlay_scale)}},clippingMask:function(E,z){return{u_matrix:new e.UniformMatrix4f(E,z.u_matrix)}},heatmap:function(E,z){return{u_extrude_scale:new e.Uniform1f(E,z.u_extrude_scale),u_intensity:new e.Uniform1f(E,z.u_intensity),u_matrix:new e.UniformMatrix4f(E,z.u_matrix)}},heatmapTexture:function(E,z){return{u_matrix:new e.UniformMatrix4f(E,z.u_matrix),u_world:new e.Uniform2f(E,z.u_world),u_image:new e.Uniform1i(E,z.u_image),u_color_ramp:new e.Uniform1i(E,z.u_color_ramp),u_opacity:new e.Uniform1f(E,z.u_opacity)}},hillshade:function(E,z){return{u_matrix:new e.UniformMatrix4f(E,z.u_matrix),u_image:new e.Uniform1i(E,z.u_image),u_latrange:new e.Uniform2f(E,z.u_latrange),u_light:new e.Uniform2f(E,z.u_light),u_shadow:new e.UniformColor(E,z.u_shadow),u_highlight:new e.UniformColor(E,z.u_highlight),u_accent:new e.UniformColor(E,z.u_accent)}},hillshadePrepare:function(E,z){return{u_matrix:new e.UniformMatrix4f(E,z.u_matrix),u_image:new e.Uniform1i(E,z.u_image),u_dimension:new e.Uniform2f(E,z.u_dimension),u_zoom:new e.Uniform1f(E,z.u_zoom),u_maxzoom:new e.Uniform1f(E,z.u_maxzoom),u_unpack:new e.Uniform4f(E,z.u_unpack)}},line:function(E,z){return{u_matrix:new e.UniformMatrix4f(E,z.u_matrix),u_ratio:new e.Uniform1f(E,z.u_ratio),u_device_pixel_ratio:new e.Uniform1f(E,z.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(E,z.u_units_to_pixels)}},lineGradient:function(E,z){return{u_matrix:new e.UniformMatrix4f(E,z.u_matrix),u_ratio:new e.Uniform1f(E,z.u_ratio),u_device_pixel_ratio:new e.Uniform1f(E,z.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(E,z.u_units_to_pixels),u_image:new e.Uniform1i(E,z.u_image)}},linePattern:function(E,z){return{u_matrix:new e.UniformMatrix4f(E,z.u_matrix),u_texsize:new e.Uniform2f(E,z.u_texsize),u_ratio:new e.Uniform1f(E,z.u_ratio),u_device_pixel_ratio:new e.Uniform1f(E,z.u_device_pixel_ratio),u_image:new e.Uniform1i(E,z.u_image),u_units_to_pixels:new e.Uniform2f(E,z.u_units_to_pixels),u_scale:new e.Uniform3f(E,z.u_scale),u_fade:new e.Uniform1f(E,z.u_fade)}},lineSDF:function(E,z){return{u_matrix:new e.UniformMatrix4f(E,z.u_matrix),u_ratio:new e.Uniform1f(E,z.u_ratio),u_device_pixel_ratio:new e.Uniform1f(E,z.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(E,z.u_units_to_pixels),u_patternscale_a:new e.Uniform2f(E,z.u_patternscale_a),u_patternscale_b:new e.Uniform2f(E,z.u_patternscale_b),u_sdfgamma:new e.Uniform1f(E,z.u_sdfgamma),u_image:new e.Uniform1i(E,z.u_image),u_tex_y_a:new e.Uniform1f(E,z.u_tex_y_a),u_tex_y_b:new e.Uniform1f(E,z.u_tex_y_b),u_mix:new e.Uniform1f(E,z.u_mix)}},raster:function(E,z){return{u_matrix:new e.UniformMatrix4f(E,z.u_matrix),u_tl_parent:new e.Uniform2f(E,z.u_tl_parent),u_scale_parent:new e.Uniform1f(E,z.u_scale_parent),u_buffer_scale:new e.Uniform1f(E,z.u_buffer_scale),u_fade_t:new e.Uniform1f(E,z.u_fade_t),u_opacity:new e.Uniform1f(E,z.u_opacity),u_image0:new e.Uniform1i(E,z.u_image0),u_image1:new e.Uniform1i(E,z.u_image1),u_brightness_low:new e.Uniform1f(E,z.u_brightness_low),u_brightness_high:new e.Uniform1f(E,z.u_brightness_high),u_saturation_factor:new e.Uniform1f(E,z.u_saturation_factor),u_contrast_factor:new e.Uniform1f(E,z.u_contrast_factor),u_spin_weights:new e.Uniform3f(E,z.u_spin_weights)}},symbolIcon:function(E,z){return{u_is_size_zoom_constant:new e.Uniform1i(E,z.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(E,z.u_is_size_feature_constant),u_size_t:new e.Uniform1f(E,z.u_size_t),u_size:new e.Uniform1f(E,z.u_size),u_camera_to_center_distance:new e.Uniform1f(E,z.u_camera_to_center_distance),u_pitch:new e.Uniform1f(E,z.u_pitch),u_rotate_symbol:new e.Uniform1i(E,z.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(E,z.u_aspect_ratio),u_fade_change:new e.Uniform1f(E,z.u_fade_change),u_matrix:new e.UniformMatrix4f(E,z.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(E,z.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(E,z.u_coord_matrix),u_is_text:new e.Uniform1i(E,z.u_is_text),u_pitch_with_map:new e.Uniform1i(E,z.u_pitch_with_map),u_texsize:new e.Uniform2f(E,z.u_texsize),u_texture:new e.Uniform1i(E,z.u_texture)}},symbolSDF:function(E,z){return{u_is_size_zoom_constant:new e.Uniform1i(E,z.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(E,z.u_is_size_feature_constant),u_size_t:new e.Uniform1f(E,z.u_size_t),u_size:new e.Uniform1f(E,z.u_size),u_camera_to_center_distance:new e.Uniform1f(E,z.u_camera_to_center_distance),u_pitch:new e.Uniform1f(E,z.u_pitch),u_rotate_symbol:new e.Uniform1i(E,z.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(E,z.u_aspect_ratio),u_fade_change:new e.Uniform1f(E,z.u_fade_change),u_matrix:new e.UniformMatrix4f(E,z.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(E,z.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(E,z.u_coord_matrix),u_is_text:new e.Uniform1i(E,z.u_is_text),u_pitch_with_map:new e.Uniform1i(E,z.u_pitch_with_map),u_texsize:new e.Uniform2f(E,z.u_texsize),u_texture:new e.Uniform1i(E,z.u_texture),u_gamma_scale:new e.Uniform1f(E,z.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(E,z.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(E,z.u_is_halo)}},symbolTextAndIcon:function(E,z){return{u_is_size_zoom_constant:new e.Uniform1i(E,z.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(E,z.u_is_size_feature_constant),u_size_t:new e.Uniform1f(E,z.u_size_t),u_size:new e.Uniform1f(E,z.u_size),u_camera_to_center_distance:new e.Uniform1f(E,z.u_camera_to_center_distance),u_pitch:new e.Uniform1f(E,z.u_pitch),u_rotate_symbol:new e.Uniform1i(E,z.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(E,z.u_aspect_ratio),u_fade_change:new e.Uniform1f(E,z.u_fade_change),u_matrix:new e.UniformMatrix4f(E,z.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(E,z.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(E,z.u_coord_matrix),u_is_text:new e.Uniform1i(E,z.u_is_text),u_pitch_with_map:new e.Uniform1i(E,z.u_pitch_with_map),u_texsize:new e.Uniform2f(E,z.u_texsize),u_texsize_icon:new e.Uniform2f(E,z.u_texsize_icon),u_texture:new e.Uniform1i(E,z.u_texture),u_texture_icon:new e.Uniform1i(E,z.u_texture_icon),u_gamma_scale:new e.Uniform1f(E,z.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(E,z.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(E,z.u_is_halo)}},background:function(E,z){return{u_matrix:new e.UniformMatrix4f(E,z.u_matrix),u_opacity:new e.Uniform1f(E,z.u_opacity),u_color:new e.UniformColor(E,z.u_color)}},backgroundPattern:function(E,z){return{u_matrix:new e.UniformMatrix4f(E,z.u_matrix),u_opacity:new e.Uniform1f(E,z.u_opacity),u_image:new e.Uniform1i(E,z.u_image),u_pattern_tl_a:new e.Uniform2f(E,z.u_pattern_tl_a),u_pattern_br_a:new e.Uniform2f(E,z.u_pattern_br_a),u_pattern_tl_b:new e.Uniform2f(E,z.u_pattern_tl_b),u_pattern_br_b:new e.Uniform2f(E,z.u_pattern_br_b),u_texsize:new e.Uniform2f(E,z.u_texsize),u_mix:new e.Uniform1f(E,z.u_mix),u_pattern_size_a:new e.Uniform2f(E,z.u_pattern_size_a),u_pattern_size_b:new e.Uniform2f(E,z.u_pattern_size_b),u_scale_a:new e.Uniform1f(E,z.u_scale_a),u_scale_b:new e.Uniform1f(E,z.u_scale_b),u_pixel_coord_upper:new e.Uniform2f(E,z.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(E,z.u_pixel_coord_lower),u_tile_units_to_pixels:new e.Uniform1f(E,z.u_tile_units_to_pixels)}}};function gr(E,z,R,U,ne,le,pe){for(var ye=E.context,Te=ye.gl,Ne=E.useProgram("collisionBox"),qe=[],tt=0,yt=0,St=0;St<U.length;St++){var _t=U[St],Tt=z.getTile(_t),gt=Tt.getBucket(R);if(gt){var Dt=_t.posMatrix;ne[0]===0&&ne[1]===0||(Dt=E.translatePosMatrix(_t.posMatrix,Tt,ne,le));var Ot=pe?gt.textCollisionBox:gt.iconCollisionBox,Bt=gt.collisionCircleArray;if(Bt.length>0){var er=e.create(),ur=Dt;e.mul(er,gt.placementInvProjMatrix,E.transform.glCoordMatrix),e.mul(er,er,gt.placementViewportMatrix),qe.push({circleArray:Bt,circleOffset:yt,transform:ur,invTransform:er}),yt=tt+=Bt.length/4}Ot&&Ne.draw(ye,Te.LINES,Je.disabled,_e.disabled,E.colorModeForRenderPass(),Ce.disabled,$o(Dt,E.transform,Tt),R.id,Ot.layoutVertexBuffer,Ot.indexBuffer,Ot.segments,null,E.transform.zoom,null,null,Ot.collisionVertexBuffer)}}if(pe&&qe.length){var Tr=E.useProgram("collisionCircle"),wr=new e.StructArrayLayout2f1f2i16;wr.resize(4*tt),wr._trim();for(var Xr=0,Wr=0,un=qe;Wr<un.length;Wr+=1)for(var an=un[Wr],Nn=0;Nn<an.circleArray.length/4;Nn++){var Yn=4*Nn,sa=an.circleArray[Yn+0],Nr=an.circleArray[Yn+1],wn=an.circleArray[Yn+2],Wn=an.circleArray[Yn+3];wr.emplace(Xr++,sa,Nr,wn,Wn,0),wr.emplace(Xr++,sa,Nr,wn,Wn,1),wr.emplace(Xr++,sa,Nr,wn,Wn,2),wr.emplace(Xr++,sa,Nr,wn,Wn,3)}(!Mt||Mt.length<2*tt)&&(Mt=function(da){var Sa=2*da,ya=new e.StructArrayLayout3ui6;ya.resize(Sa),ya._trim();for(var Ea=0;Ea<Sa;Ea++){var Ba=6*Ea;ya.uint16[Ba+0]=4*Ea+0,ya.uint16[Ba+1]=4*Ea+1,ya.uint16[Ba+2]=4*Ea+2,ya.uint16[Ba+3]=4*Ea+2,ya.uint16[Ba+4]=4*Ea+3,ya.uint16[Ba+5]=4*Ea+0}return ya}(tt));for(var Vn=ye.createIndexBuffer(Mt,!0),$n=ye.createVertexBuffer(wr,e.collisionCircleLayout.members,!0),ca=0,Ta=qe;ca<Ta.length;ca+=1){var Zn=Ta[ca],va=ho(Zn.transform,Zn.invTransform,E.transform);Tr.draw(ye,Te.TRIANGLES,Je.disabled,_e.disabled,E.colorModeForRenderPass(),Ce.disabled,va,R.id,$n,Vn,e.SegmentVector.simpleSegment(0,2*Zn.circleOffset,Zn.circleArray.length,Zn.circleArray.length/2),null,E.transform.zoom,null,null,null)}$n.destroy(),Vn.destroy()}}var Pr=e.identity(new Float32Array(16));function tn(E,z,R,U,ne,le){var pe=e.getAnchorAlignment(E),ye=-(pe.horizontalAlign-.5)*z,Te=-(pe.verticalAlign-.5)*R,Ne=e.evaluateVariableOffset(E,U);return new e.Point((ye/ne+Ne[0])*le,(Te/ne+Ne[1])*le)}function pn(E,z,R,U,ne,le,pe,ye,Te,Ne,qe){var tt=E.text.placedSymbolArray,yt=E.text.dynamicLayoutVertexArray,St=E.icon.dynamicLayoutVertexArray,_t={};yt.clear();for(var Tt=0;Tt<tt.length;Tt++){var gt=tt.get(Tt),Dt=E.allowVerticalPlacement&&!gt.placedOrientation,Ot=gt.hidden||!gt.crossTileID||Dt?null:U[gt.crossTileID];if(Ot){var Bt=new e.Point(gt.anchorX,gt.anchorY),er=sr(Bt,R?ye:pe),ur=fr(le.cameraToCenterDistance,er.signedDistanceFromCamera),Tr=ne.evaluateSizeForFeature(E.textSizeData,Ne,gt)*ur/e.ONE_EM;R&&(Tr*=E.tilePixelRatio/Te);for(var wr=Ot.width,Xr=Ot.height,Wr=tn(Ot.anchor,wr,Xr,Ot.textOffset,Ot.textBoxScale,Tr),un=R?sr(Bt.add(Wr),pe).point:er.point.add(z?Wr.rotate(-le.angle):Wr),an=E.allowVerticalPlacement&&gt.placedOrientation===e.WritingMode.vertical?Math.PI/2:0,Nn=0;Nn<gt.numGlyphs;Nn++)e.addDynamicAttributes(yt,un,an);qe&&gt.associatedIconIndex>=0&&(_t[gt.associatedIconIndex]={shiftedAnchor:un,angle:an})}else An(gt.numGlyphs,yt)}if(qe){St.clear();for(var Yn=E.icon.placedSymbolArray,sa=0;sa<Yn.length;sa++){var Nr=Yn.get(sa);if(Nr.hidden)An(Nr.numGlyphs,St);else{var wn=_t[sa];if(wn)for(var Wn=0;Wn<Nr.numGlyphs;Wn++)e.addDynamicAttributes(St,wn.shiftedAnchor,wn.angle);else An(Nr.numGlyphs,St)}}E.icon.dynamicLayoutVertexBuffer.updateData(St)}E.text.dynamicLayoutVertexBuffer.updateData(yt)}function Sn(E,z,R){return R.iconsInText&&z?"symbolTextAndIcon":E?"symbolSDF":"symbolIcon"}function In(E,z,R,U,ne,le,pe,ye,Te,Ne,qe,tt){for(var yt=E.context,St=yt.gl,_t=E.transform,Tt=ye==="map",gt=Te==="map",Dt=Tt&&R.layout.get("symbol-placement")!=="point",Ot=Tt&&!gt&&!Dt,Bt=R.layout.get("symbol-sort-key").constantOr(1)!==void 0,er=E.depthModeForSublayer(0,Je.ReadOnly),ur=R.layout.get("text-variable-anchor"),Tr=[],wr=0,Xr=U;wr<Xr.length;wr+=1){var Wr=Xr[wr],un=z.getTile(Wr),an=un.getBucket(R);if(an){var Nn=ne?an.text:an.icon;if(Nn&&Nn.segments.get().length){var Yn=Nn.programConfigurations.get(R.id),sa=ne||an.sdfIcons,Nr=ne?an.textSizeData:an.iconSizeData,wn=gt||_t.pitch!==0,Wn=E.useProgram(Sn(sa,ne,an),Yn),Vn=e.evaluateSizeForZoom(Nr,_t.zoom),$n=void 0,ca=[0,0],Ta=void 0,Zn=void 0,va=null,da=void 0;if(ne){if(Ta=un.glyphAtlasTexture,Zn=St.LINEAR,$n=un.glyphAtlasTexture.size,an.iconsInText){ca=un.imageAtlasTexture.size,va=un.imageAtlasTexture;var Sa=Nr.kind==="composite"||Nr.kind==="camera";da=wn||E.options.rotating||E.options.zooming||Sa?St.LINEAR:St.NEAREST}}else{var ya=R.layout.get("icon-size").constantOr(0)!==1||an.iconsNeedLinear;Ta=un.imageAtlasTexture,Zn=sa||E.options.rotating||E.options.zooming||ya||wn?St.LINEAR:St.NEAREST,$n=un.imageAtlasTexture.size}var Ea=Lr(un,1,E.transform.zoom),Ba=hr(Wr.posMatrix,gt,Tt,E.transform,Ea),li=mr(Wr.posMatrix,gt,Tt,E.transform,Ea),Li=ur&&an.hasTextData(),Ci=R.layout.get("icon-text-fit")!=="none"&&Li&&an.hasIconData();Dt&&zr(an,Wr.posMatrix,E,ne,Ba,li,gt,Ne);var si=E.translatePosMatrix(Wr.posMatrix,un,le,pe),wi=Dt||ne&&ur||Ci?Pr:Ba,pi=E.translatePosMatrix(li,un,le,pe,!0),go=sa&&R.paint.get(ne?"text-halo-width":"icon-halo-width").constantOr(1)!==0,Vi={program:Wn,buffers:Nn,uniformValues:sa?an.iconsInText?qt(Nr.kind,Vn,Ot,gt,E,si,wi,pi,$n,ca):Jt(Nr.kind,Vn,Ot,gt,E,si,wi,pi,ne,$n,!0):Wt(Nr.kind,Vn,Ot,gt,E,si,wi,pi,ne,$n),atlasTexture:Ta,atlasTextureIcon:va,atlasInterpolation:Zn,atlasInterpolationIcon:da,isSDF:sa,hasHalo:go};if(Bt)for(var Oo=0,_s=Nn.segments.get();Oo<_s.length;Oo+=1){var Us=_s[Oo];Tr.push({segments:new e.SegmentVector([Us]),sortKey:Us.sortKey,state:Vi})}else Tr.push({segments:Nn.segments,sortKey:0,state:Vi})}}}Bt&&Tr.sort(function(pl,ns){return pl.sortKey-ns.sortKey});for(var hl=0,rl=Tr;hl<rl.length;hl+=1){var nl=rl[hl],vo=nl.state;if(yt.activeTexture.set(St.TEXTURE0),vo.atlasTexture.bind(vo.atlasInterpolation,St.CLAMP_TO_EDGE),vo.atlasTextureIcon&&(yt.activeTexture.set(St.TEXTURE1),vo.atlasTextureIcon&&vo.atlasTextureIcon.bind(vo.atlasInterpolationIcon,St.CLAMP_TO_EDGE)),vo.isSDF){var Gs=vo.uniformValues;vo.hasHalo&&(Gs.u_is_halo=1,Un(vo.buffers,nl.segments,R,E,vo.program,er,qe,tt,Gs)),Gs.u_is_halo=0}Un(vo.buffers,nl.segments,R,E,vo.program,er,qe,tt,vo.uniformValues)}}function Un(E,z,R,U,ne,le,pe,ye,Te){var Ne=U.context,qe=Ne.gl;ne.draw(Ne,qe.TRIANGLES,le,pe,ye,Ce.disabled,Te,R.id,E.layoutVertexBuffer,E.indexBuffer,z,R.paint,U.transform.zoom,E.programConfigurations.get(R.id),E.dynamicLayoutVertexBuffer,E.opacityVertexBuffer)}function On(E,z,R,U,ne,le,pe){var ye,Te,Ne,qe,tt,yt=E.context.gl,St=R.paint.get("fill-pattern"),_t=St&&St.constantOr(1),Tt=R.getCrossfadeParameters();pe?(Te=_t&&!R.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ye=yt.LINES):(Te=_t?"fillPattern":"fill",ye=yt.TRIANGLES);for(var gt=0,Dt=U;gt<Dt.length;gt+=1){var Ot=Dt[gt],Bt=z.getTile(Ot);if(!_t||Bt.patternsLoaded()){var er=Bt.getBucket(R);if(er){var ur=er.programConfigurations.get(R.id),Tr=E.useProgram(Te,ur);_t&&(E.context.activeTexture.set(yt.TEXTURE0),Bt.imageAtlasTexture.bind(yt.LINEAR,yt.CLAMP_TO_EDGE),ur.updatePaintBuffers(Tt));var wr=St.constantOr(null);if(wr&&Bt.imageAtlas){var Xr=Bt.imageAtlas,Wr=Xr.patternPositions[wr.to.toString()],un=Xr.patternPositions[wr.from.toString()];Wr&&un&&ur.setConstantPatternPositions(Wr,un)}var an=E.translatePosMatrix(Ot.posMatrix,Bt,R.paint.get("fill-translate"),R.paint.get("fill-translate-anchor"));if(pe){qe=er.indexBuffer2,tt=er.segments2;var Nn=[yt.drawingBufferWidth,yt.drawingBufferHeight];Ne=Te==="fillOutlinePattern"&&_t?Uo(an,E,Tt,Bt,Nn):jo(an,Nn)}else qe=er.indexBuffer,tt=er.segments,Ne=_t?Mo(an,E,Tt,Bt):Ao(an);Tr.draw(E.context,ye,ne,E.stencilModeForClipping(Ot),le,Ce.disabled,Ne,R.id,er.layoutVertexBuffer,qe,tt,R.paint,E.transform.zoom,ur)}}}}function pa(E,z,R,U,ne,le,pe){for(var ye=E.context,Te=ye.gl,Ne=R.paint.get("fill-extrusion-pattern"),qe=Ne.constantOr(1),tt=R.getCrossfadeParameters(),yt=R.paint.get("fill-extrusion-opacity"),St=0,_t=U;St<_t.length;St+=1){var Tt=_t[St],gt=z.getTile(Tt),Dt=gt.getBucket(R);if(Dt){var Ot=Dt.programConfigurations.get(R.id),Bt=E.useProgram(qe?"fillExtrusionPattern":"fillExtrusion",Ot);qe&&(E.context.activeTexture.set(Te.TEXTURE0),gt.imageAtlasTexture.bind(Te.LINEAR,Te.CLAMP_TO_EDGE),Ot.updatePaintBuffers(tt));var er=Ne.constantOr(null);if(er&&gt.imageAtlas){var ur=gt.imageAtlas,Tr=ur.patternPositions[er.to.toString()],wr=ur.patternPositions[er.from.toString()];Tr&&wr&&Ot.setConstantPatternPositions(Tr,wr)}var Xr=E.translatePosMatrix(Tt.posMatrix,gt,R.paint.get("fill-extrusion-translate"),R.paint.get("fill-extrusion-translate-anchor")),Wr=R.paint.get("fill-extrusion-vertical-gradient"),un=qe?As(Xr,E,Wr,yt,Tt,tt,gt):xs(Xr,E,Wr,yt);Bt.draw(ye,ye.gl.TRIANGLES,ne,le,pe,Ce.backCCW,un,R.id,Dt.layoutVertexBuffer,Dt.indexBuffer,Dt.segments,R.paint,E.transform.zoom,Ot)}}}function _a(E,z,R,U,ne,le){var pe=E.context,ye=pe.gl,Te=z.fbo;if(Te){var Ne=E.useProgram("hillshade");pe.activeTexture.set(ye.TEXTURE0),ye.bindTexture(ye.TEXTURE_2D,Te.colorAttachment.get());var qe=function(tt,yt,St){var _t=St.paint.get("hillshade-shadow-color"),Tt=St.paint.get("hillshade-highlight-color"),gt=St.paint.get("hillshade-accent-color"),Dt=St.paint.get("hillshade-illumination-direction")*(Math.PI/180);St.paint.get("hillshade-illumination-anchor")==="viewport"&&(Dt-=tt.transform.angle);var Ot=!tt.options.moving;return{u_matrix:tt.transform.calculatePosMatrix(yt.tileID.toUnwrapped(),Ot),u_image:0,u_latrange:ds(tt,yt.tileID),u_light:[St.paint.get("hillshade-exaggeration"),Dt],u_shadow:_t,u_highlight:Tt,u_accent:gt}}(E,z,R);Ne.draw(pe,ye.TRIANGLES,U,ne,le,Ce.disabled,qe,R.id,E.rasterBoundsBuffer,E.quadTriangleIndexBuffer,E.rasterBoundsSegments)}}function Ra(E,z,R,U,ne,le,pe){var ye=E.context,Te=ye.gl,Ne=z.dem;if(Ne&&Ne.data){var qe=Ne.dim,tt=Ne.stride,yt=Ne.getPixels();if(ye.activeTexture.set(Te.TEXTURE1),ye.pixelStoreUnpackPremultiplyAlpha.set(!1),z.demTexture=z.demTexture||E.getTileTexture(tt),z.demTexture){var St=z.demTexture;St.update(yt,{premultiply:!1}),St.bind(Te.NEAREST,Te.CLAMP_TO_EDGE)}else z.demTexture=new e.Texture(ye,yt,Te.RGBA,{premultiply:!1}),z.demTexture.bind(Te.NEAREST,Te.CLAMP_TO_EDGE);ye.activeTexture.set(Te.TEXTURE0);var _t=z.fbo;if(!_t){var Tt=new e.Texture(ye,{width:qe,height:qe,data:null},Te.RGBA);Tt.bind(Te.LINEAR,Te.CLAMP_TO_EDGE),(_t=z.fbo=ye.createFramebuffer(qe,qe,!0)).colorAttachment.set(Tt.texture)}ye.bindFramebuffer.set(_t.framebuffer),ye.viewport.set([0,0,qe,qe]),E.useProgram("hillshadePrepare").draw(ye,Te.TRIANGLES,ne,le,pe,Ce.disabled,function(gt,Dt,Ot){var Bt=Dt.stride,er=e.create();return e.ortho(er,0,e.EXTENT,-e.EXTENT,0,0,1),e.translate(er,er,[0,-e.EXTENT,0]),{u_matrix:er,u_image:1,u_dimension:[Bt,Bt],u_zoom:gt.overscaledZ,u_maxzoom:Ot,u_unpack:Dt.getUnpackVector()}}(z.tileID,Ne,U),R.id,E.rasterBoundsBuffer,E.quadTriangleIndexBuffer,E.rasterBoundsSegments),z.needsHillshadePrepare=!1}}function Da(E,z,R,U,ne){var le=U.paint.get("raster-fade-duration");if(le>0){var pe=e.browser.now(),ye=(pe-E.timeAdded)/le,Te=z?(pe-z.timeAdded)/le:-1,Ne=R.getSource(),qe=ne.coveringZoomLevel({tileSize:Ne.tileSize,roundZoom:Ne.roundZoom}),tt=!z||Math.abs(z.tileID.overscaledZ-qe)>Math.abs(E.tileID.overscaledZ-qe),yt=tt&&E.refreshedUponExpiration?1:e.clamp(tt?ye:1-Te,0,1);return E.refreshedUponExpiration&&ye>=1&&(E.refreshedUponExpiration=!1),z?{opacity:1,mix:1-yt}:{opacity:yt,mix:0}}return{opacity:1,mix:0}}var Fa=new e.Color(1,0,0,1),bi=new e.Color(0,1,0,1),gi=new e.Color(0,0,1,1),ai=new e.Color(1,0,1,1),ii=new e.Color(0,1,1,1);function vi(E){var z=E.transform.padding;Ri(E,E.transform.height-(z.top||0),3,Fa),Ri(E,z.bottom||0,3,bi),Zi(E,z.left||0,3,gi),Zi(E,E.transform.width-(z.right||0),3,ai);var R=E.transform.centerPoint;(function(U,ne,le,pe){Ji(U,ne-1,le-10,2,20,pe),Ji(U,ne-10,le-1,20,2,pe)})(E,R.x,E.transform.height-R.y,ii)}function Ri(E,z,R,U){Ji(E,0,z+R/2,E.transform.width,R,U)}function Zi(E,z,R,U){Ji(E,z-R/2,0,R,E.transform.height,U)}function Ji(E,z,R,U,ne,le){var pe=E.context,ye=pe.gl;ye.enable(ye.SCISSOR_TEST),ye.scissor(z*e.browser.devicePixelRatio,R*e.browser.devicePixelRatio,U*e.browser.devicePixelRatio,ne*e.browser.devicePixelRatio),pe.clear({color:le}),ye.disable(ye.SCISSOR_TEST)}function Ki(E,z,R){var U=E.context,ne=U.gl,le=R.posMatrix,pe=E.useProgram("debug"),ye=Je.disabled,Te=_e.disabled,Ne=E.colorModeForRenderPass();U.activeTexture.set(ne.TEXTURE0),E.emptyTexture.bind(ne.LINEAR,ne.CLAMP_TO_EDGE),pe.draw(U,ne.LINE_STRIP,ye,Te,Ne,Ce.disabled,ps(le,e.Color.red),"$debug",E.debugBuffer,E.tileBorderIndexBuffer,E.debugSegments);var qe=z.getTileByID(R.key).latestRawTileData,tt=qe&&qe.byteLength||0,yt=Math.floor(tt/1024),St=z.getTile(R).tileSize,_t=512/Math.min(St,512)*(R.overscaledZ/E.transform.zoom)*.5,Tt=R.canonical.toString();R.overscaledZ!==R.canonical.z&&(Tt+=" => "+R.overscaledZ),function(gt,Dt){gt.initDebugOverlayCanvas();var Ot=gt.debugOverlayCanvas,Bt=gt.context.gl,er=gt.debugOverlayCanvas.getContext("2d");er.clearRect(0,0,Ot.width,Ot.height),er.shadowColor="white",er.shadowBlur=2,er.lineWidth=1.5,er.strokeStyle="white",er.textBaseline="top",er.font="bold 36px Open Sans, sans-serif",er.fillText(Dt,5,5),er.strokeText(Dt,5,5),gt.debugOverlayTexture.update(Ot),gt.debugOverlayTexture.bind(Bt.LINEAR,Bt.CLAMP_TO_EDGE)}(E,Tt+" "+yt+"kb"),pe.draw(U,ne.TRIANGLES,ye,Te,Le.alphaBlended,Ce.disabled,ps(le,e.Color.transparent,_t),"$debug",E.debugBuffer,E.quadTriangleIndexBuffer,E.debugSegments)}var Qi={symbol:function(E,z,R,U,ne){if(E.renderPass==="translucent"){var le=_e.disabled,pe=E.colorModeForRenderPass();R.layout.get("text-variable-anchor")&&function(ye,Te,Ne,qe,tt,yt,St){for(var _t=Te.transform,Tt=tt==="map",gt=yt==="map",Dt=0,Ot=ye;Dt<Ot.length;Dt+=1){var Bt=Ot[Dt],er=qe.getTile(Bt),ur=er.getBucket(Ne);if(ur&&ur.text&&ur.text.segments.get().length){var Tr=ur.textSizeData,wr=e.evaluateSizeForZoom(Tr,_t.zoom),Xr=Lr(er,1,Te.transform.zoom),Wr=hr(Bt.posMatrix,gt,Tt,Te.transform,Xr),un=Ne.layout.get("icon-text-fit")!=="none"&&ur.hasIconData();if(wr){var an=Math.pow(2,_t.zoom-er.tileID.overscaledZ);pn(ur,Tt,gt,St,e.symbolSize,_t,Wr,Bt.posMatrix,an,wr,un)}}}}(U,E,R,z,R.layout.get("text-rotation-alignment"),R.layout.get("text-pitch-alignment"),ne),R.paint.get("icon-opacity").constantOr(1)!==0&&In(E,z,R,U,!1,R.paint.get("icon-translate"),R.paint.get("icon-translate-anchor"),R.layout.get("icon-rotation-alignment"),R.layout.get("icon-pitch-alignment"),R.layout.get("icon-keep-upright"),le,pe),R.paint.get("text-opacity").constantOr(1)!==0&&In(E,z,R,U,!0,R.paint.get("text-translate"),R.paint.get("text-translate-anchor"),R.layout.get("text-rotation-alignment"),R.layout.get("text-pitch-alignment"),R.layout.get("text-keep-upright"),le,pe),z.map.showCollisionBoxes&&(gr(E,z,R,U,R.paint.get("text-translate"),R.paint.get("text-translate-anchor"),!0),gr(E,z,R,U,R.paint.get("icon-translate"),R.paint.get("icon-translate-anchor"),!1))}},circle:function(E,z,R,U){if(E.renderPass==="translucent"){var ne=R.paint.get("circle-opacity"),le=R.paint.get("circle-stroke-width"),pe=R.paint.get("circle-stroke-opacity"),ye=R.layout.get("circle-sort-key").constantOr(1)!==void 0;if(ne.constantOr(1)!==0||le.constantOr(1)!==0&&pe.constantOr(1)!==0){for(var Te=E.context,Ne=Te.gl,qe=E.depthModeForSublayer(0,Je.ReadOnly),tt=_e.disabled,yt=E.colorModeForRenderPass(),St=[],_t=0;_t<U.length;_t++){var Tt=U[_t],gt=z.getTile(Tt),Dt=gt.getBucket(R);if(Dt){var Ot=Dt.programConfigurations.get(R.id),Bt={programConfiguration:Ot,program:E.useProgram("circle",Ot),layoutVertexBuffer:Dt.layoutVertexBuffer,indexBuffer:Dt.indexBuffer,uniformValues:Vo(E,Tt,gt,R)};if(ye)for(var er=0,ur=Dt.segments.get();er<ur.length;er+=1){var Tr=ur[er];St.push({segments:new e.SegmentVector([Tr]),sortKey:Tr.sortKey,state:Bt})}else St.push({segments:Dt.segments,sortKey:0,state:Bt})}}ye&&St.sort(function(Wn,Vn){return Wn.sortKey-Vn.sortKey});for(var wr=0,Xr=St;wr<Xr.length;wr+=1){var Wr=Xr[wr],un=Wr.state,an=un.programConfiguration,Nn=un.program,Yn=un.layoutVertexBuffer,sa=un.indexBuffer,Nr=un.uniformValues,wn=Wr.segments;Nn.draw(Te,Ne.TRIANGLES,qe,tt,yt,Ce.disabled,Nr,R.id,Yn,sa,wn,R.paint,E.transform.zoom,an)}}}},heatmap:function(E,z,R,U){if(R.paint.get("heatmap-opacity")!==0)if(E.renderPass==="offscreen"){var ne=E.context,le=ne.gl,pe=_e.disabled,ye=new Le([le.ONE,le.ONE],e.Color.transparent,[!0,!0,!0,!0]);(function(Tt,gt,Dt){var Ot=Tt.gl;Tt.activeTexture.set(Ot.TEXTURE1),Tt.viewport.set([0,0,gt.width/4,gt.height/4]);var Bt=Dt.heatmapFbo;if(Bt)Ot.bindTexture(Ot.TEXTURE_2D,Bt.colorAttachment.get()),Tt.bindFramebuffer.set(Bt.framebuffer);else{var er=Ot.createTexture();Ot.bindTexture(Ot.TEXTURE_2D,er),Ot.texParameteri(Ot.TEXTURE_2D,Ot.TEXTURE_WRAP_S,Ot.CLAMP_TO_EDGE),Ot.texParameteri(Ot.TEXTURE_2D,Ot.TEXTURE_WRAP_T,Ot.CLAMP_TO_EDGE),Ot.texParameteri(Ot.TEXTURE_2D,Ot.TEXTURE_MIN_FILTER,Ot.LINEAR),Ot.texParameteri(Ot.TEXTURE_2D,Ot.TEXTURE_MAG_FILTER,Ot.LINEAR),Bt=Dt.heatmapFbo=Tt.createFramebuffer(gt.width/4,gt.height/4,!1),function(ur,Tr,wr,Xr){var Wr=ur.gl,un=ur.extRenderToTextureHalfFloat?ur.extTextureHalfFloat.HALF_FLOAT_OES:Wr.UNSIGNED_BYTE;Wr.texImage2D(Wr.TEXTURE_2D,0,Wr.RGBA,Tr.width/4,Tr.height/4,0,Wr.RGBA,un,null),Xr.colorAttachment.set(wr)}(Tt,gt,er,Bt)}})(ne,E,R),ne.clear({color:e.Color.transparent});for(var Te=0;Te<U.length;Te++){var Ne=U[Te];if(!z.hasRenderableParent(Ne)){var qe=z.getTile(Ne),tt=qe.getBucket(R);if(tt){var yt=tt.programConfigurations.get(R.id),St=E.useProgram("heatmap",yt),_t=E.transform.zoom;St.draw(ne,le.TRIANGLES,Je.disabled,pe,ye,Ce.disabled,Ho(Ne.posMatrix,qe,_t,R.paint.get("heatmap-intensity")),R.id,tt.layoutVertexBuffer,tt.indexBuffer,tt.segments,R.paint,E.transform.zoom,yt)}}}ne.viewport.set([0,0,E.width,E.height])}else E.renderPass==="translucent"&&(E.context.setColorMode(E.colorModeForRenderPass()),function(Tt,gt){var Dt=Tt.context,Ot=Dt.gl,Bt=gt.heatmapFbo;if(!!Bt){Dt.activeTexture.set(Ot.TEXTURE0),Ot.bindTexture(Ot.TEXTURE_2D,Bt.colorAttachment.get()),Dt.activeTexture.set(Ot.TEXTURE1);var er=gt.colorRampTexture;er||(er=gt.colorRampTexture=new e.Texture(Dt,gt.colorRamp,Ot.RGBA)),er.bind(Ot.LINEAR,Ot.CLAMP_TO_EDGE),Tt.useProgram("heatmapTexture").draw(Dt,Ot.TRIANGLES,Je.disabled,_e.disabled,Tt.colorModeForRenderPass(),Ce.disabled,function(ur,Tr,wr,Xr){var Wr=e.create();e.ortho(Wr,0,ur.width,ur.height,0,0,1);var un=ur.context.gl;return{u_matrix:Wr,u_world:[un.drawingBufferWidth,un.drawingBufferHeight],u_image:wr,u_color_ramp:Xr,u_opacity:Tr.paint.get("heatmap-opacity")}}(Tt,gt,0,1),gt.id,Tt.viewportBuffer,Tt.quadTriangleIndexBuffer,Tt.viewportSegments,gt.paint,Tt.transform.zoom)}}(E,R))},line:function(E,z,R,U){if(E.renderPass==="translucent"){var ne=R.paint.get("line-opacity"),le=R.paint.get("line-width");if(ne.constantOr(1)!==0&&le.constantOr(1)!==0){var pe=E.depthModeForSublayer(0,Je.ReadOnly),ye=E.colorModeForRenderPass(),Te=R.paint.get("line-dasharray"),Ne=R.paint.get("line-pattern"),qe=Ne.constantOr(1),tt=R.paint.get("line-gradient"),yt=R.getCrossfadeParameters(),St=qe?"linePattern":Te?"lineSDF":tt?"lineGradient":"line",_t=E.context,Tt=_t.gl,gt=!0;if(tt){_t.activeTexture.set(Tt.TEXTURE0);var Dt=R.gradientTexture;if(!R.gradient)return;Dt||(Dt=R.gradientTexture=new e.Texture(_t,R.gradient,Tt.RGBA)),Dt.bind(Tt.LINEAR,Tt.CLAMP_TO_EDGE)}for(var Ot=0,Bt=U;Ot<Bt.length;Ot+=1){var er=Bt[Ot],ur=z.getTile(er);if(!qe||ur.patternsLoaded()){var Tr=ur.getBucket(R);if(Tr){var wr=Tr.programConfigurations.get(R.id),Xr=E.context.program.get(),Wr=E.useProgram(St,wr),un=gt||Wr.program!==Xr,an=Ne.constantOr(null);if(an&&ur.imageAtlas){var Nn=ur.imageAtlas,Yn=Nn.patternPositions[an.to.toString()],sa=Nn.patternPositions[an.from.toString()];Yn&&sa&&wr.setConstantPatternPositions(Yn,sa)}var Nr=qe?Re(E,ur,R,yt):Te?Ve(E,ur,R,Te,yt):tt?Ua(E,ur,R):So(E,ur,R);qe?(_t.activeTexture.set(Tt.TEXTURE0),ur.imageAtlasTexture.bind(Tt.LINEAR,Tt.CLAMP_TO_EDGE),wr.updatePaintBuffers(yt)):Te&&(un||E.lineAtlas.dirty)&&(_t.activeTexture.set(Tt.TEXTURE0),E.lineAtlas.bind(_t)),Wr.draw(_t,Tt.TRIANGLES,pe,E.stencilModeForClipping(er),ye,Ce.disabled,Nr,R.id,Tr.layoutVertexBuffer,Tr.indexBuffer,Tr.segments,R.paint,E.transform.zoom,wr),gt=!1}}}}}},fill:function(E,z,R,U){var ne=R.paint.get("fill-color"),le=R.paint.get("fill-opacity");if(le.constantOr(1)!==0){var pe=E.colorModeForRenderPass(),ye=R.paint.get("fill-pattern"),Te=E.opaquePassEnabledForLayer()&&!ye.constantOr(1)&&ne.constantOr(e.Color.transparent).a===1&&le.constantOr(0)===1?"opaque":"translucent";if(E.renderPass===Te){var Ne=E.depthModeForSublayer(1,E.renderPass==="opaque"?Je.ReadWrite:Je.ReadOnly);On(E,z,R,U,Ne,pe,!1)}if(E.renderPass==="translucent"&&R.paint.get("fill-antialias")){var qe=E.depthModeForSublayer(R.getPaintProperty("fill-outline-color")?2:0,Je.ReadOnly);On(E,z,R,U,qe,pe,!0)}}},"fill-extrusion":function(E,z,R,U){var ne=R.paint.get("fill-extrusion-opacity");if(ne!==0&&E.renderPass==="translucent"){var le=new Je(E.context.gl.LEQUAL,Je.ReadWrite,E.depthRangeFor3D);if(ne!==1||R.paint.get("fill-extrusion-pattern").constantOr(1))pa(E,z,R,U,le,_e.disabled,Le.disabled),pa(E,z,R,U,le,E.stencilModeFor3D(),E.colorModeForRenderPass());else{var pe=E.colorModeForRenderPass();pa(E,z,R,U,le,_e.disabled,pe)}}},hillshade:function(E,z,R,U){if(E.renderPass==="offscreen"||E.renderPass==="translucent"){for(var ne=E.context,le=z.getSource().maxzoom,pe=E.depthModeForSublayer(0,Je.ReadOnly),ye=E.colorModeForRenderPass(),Te=E.renderPass==="translucent"?E.stencilConfigForOverlap(U):[{},U],Ne=Te[0],qe=0,tt=Te[1];qe<tt.length;qe+=1){var yt=tt[qe],St=z.getTile(yt);St.needsHillshadePrepare&&E.renderPass==="offscreen"?Ra(E,St,R,le,pe,_e.disabled,ye):E.renderPass==="translucent"&&_a(E,St,R,pe,Ne[yt.overscaledZ],ye)}ne.viewport.set([0,0,E.width,E.height])}},raster:function(E,z,R,U){if(E.renderPass==="translucent"&&R.paint.get("raster-opacity")!==0&&U.length)for(var ne=E.context,le=ne.gl,pe=z.getSource(),ye=E.useProgram("raster"),Te=E.colorModeForRenderPass(),Ne=pe instanceof G?[{},U]:E.stencilConfigForOverlap(U),qe=Ne[0],tt=Ne[1],yt=tt[tt.length-1].overscaledZ,St=!E.options.moving,_t=0,Tt=tt;_t<Tt.length;_t+=1){var gt=Tt[_t],Dt=E.depthModeForSublayer(gt.overscaledZ-yt,R.paint.get("raster-opacity")===1?Je.ReadWrite:Je.ReadOnly,le.LESS),Ot=z.getTile(gt),Bt=E.transform.calculatePosMatrix(gt.toUnwrapped(),St);Ot.registerFadeDuration(R.paint.get("raster-fade-duration"));var er=z.findLoadedParent(gt,0),ur=Da(Ot,er,z,R,E.transform),Tr=void 0,wr=void 0,Xr=R.paint.get("raster-resampling")==="nearest"?le.NEAREST:le.LINEAR;ne.activeTexture.set(le.TEXTURE0),Ot.texture.bind(Xr,le.CLAMP_TO_EDGE,le.LINEAR_MIPMAP_NEAREST),ne.activeTexture.set(le.TEXTURE1),er?(er.texture.bind(Xr,le.CLAMP_TO_EDGE,le.LINEAR_MIPMAP_NEAREST),Tr=Math.pow(2,er.tileID.overscaledZ-Ot.tileID.overscaledZ),wr=[Ot.tileID.canonical.x*Tr%1,Ot.tileID.canonical.y*Tr%1]):Ot.texture.bind(Xr,le.CLAMP_TO_EDGE,le.LINEAR_MIPMAP_NEAREST);var Wr=dt(Bt,wr||[0,0],Tr||1,ur,R);pe instanceof G?ye.draw(ne,le.TRIANGLES,Dt,_e.disabled,Te,Ce.disabled,Wr,R.id,pe.boundsBuffer,E.quadTriangleIndexBuffer,pe.boundsSegments):ye.draw(ne,le.TRIANGLES,Dt,qe[gt.overscaledZ],Te,Ce.disabled,Wr,R.id,E.rasterBoundsBuffer,E.quadTriangleIndexBuffer,E.rasterBoundsSegments)}},background:function(E,z,R){var U=R.paint.get("background-color"),ne=R.paint.get("background-opacity");if(ne!==0){var le=E.context,pe=le.gl,ye=E.transform,Te=ye.tileSize,Ne=R.paint.get("background-pattern");if(!E.isPatternMissing(Ne)){var qe=!Ne&&U.a===1&&ne===1&&E.opaquePassEnabledForLayer()?"opaque":"translucent";if(E.renderPass===qe){var tt=_e.disabled,yt=E.depthModeForSublayer(0,qe==="opaque"?Je.ReadWrite:Je.ReadOnly),St=E.colorModeForRenderPass(),_t=E.useProgram(Ne?"backgroundPattern":"background"),Tt=ye.coveringTiles({tileSize:Te});Ne&&(le.activeTexture.set(pe.TEXTURE0),E.imageManager.bind(E.context));for(var gt=R.getCrossfadeParameters(),Dt=0,Ot=Tt;Dt<Ot.length;Dt+=1){var Bt=Ot[Dt],er=E.transform.calculatePosMatrix(Bt.toUnwrapped()),ur=Ne?lr(er,ne,E,Ne,{tileID:Bt,tileSize:Te},gt):tr(er,ne,U);_t.draw(le,pe.TRIANGLES,yt,tt,St,Ce.disabled,ur,R.id,E.tileExtentBuffer,E.quadTriangleIndexBuffer,E.tileExtentSegments)}}}}},debug:function(E,z,R){for(var U=0;U<R.length;U++)Ki(E,z,R[U])},custom:function(E,z,R){var U=E.context,ne=R.implementation;if(E.renderPass==="offscreen"){var le=ne.prerender;le&&(E.setCustomLayerDefaults(),U.setColorMode(E.colorModeForRenderPass()),le.call(ne,U.gl,E.transform.customLayerMatrix()),U.setDirty(),E.setBaseState())}else if(E.renderPass==="translucent"){E.setCustomLayerDefaults(),U.setColorMode(E.colorModeForRenderPass()),U.setStencilMode(_e.disabled);var pe=ne.renderingMode==="3d"?new Je(E.context.gl.LEQUAL,Je.ReadWrite,E.depthRangeFor3D):E.depthModeForSublayer(0,Je.ReadOnly);U.setDepthMode(pe),ne.render(U.gl,E.transform.customLayerMatrix()),U.setDirty(),E.setBaseState(),U.bindFramebuffer.set(null)}}},Pa=function(E,z){this.context=new Pe(E),this.transform=z,this._tileTextures={},this.setup(),this.numSublayers=Xe.maxUnderzooming+Xe.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Gr,this.gpuTimers={}};Pa.prototype.resize=function(E,z){if(this.width=E*e.browser.devicePixelRatio,this.height=z*e.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var R=0,U=this.style._order;R<U.length;R+=1){var ne=U[R];this.style._layers[ne].resize()}},Pa.prototype.setup=function(){var E=this.context,z=new e.StructArrayLayout2i4;z.emplaceBack(0,0),z.emplaceBack(e.EXTENT,0),z.emplaceBack(0,e.EXTENT),z.emplaceBack(e.EXTENT,e.EXTENT),this.tileExtentBuffer=E.createVertexBuffer(z,gn.members),this.tileExtentSegments=e.SegmentVector.simpleSegment(0,0,4,2);var R=new e.StructArrayLayout2i4;R.emplaceBack(0,0),R.emplaceBack(e.EXTENT,0),R.emplaceBack(0,e.EXTENT),R.emplaceBack(e.EXTENT,e.EXTENT),this.debugBuffer=E.createVertexBuffer(R,gn.members),this.debugSegments=e.SegmentVector.simpleSegment(0,0,4,5);var U=new e.StructArrayLayout4i8;U.emplaceBack(0,0,0,0),U.emplaceBack(e.EXTENT,0,e.EXTENT,0),U.emplaceBack(0,e.EXTENT,0,e.EXTENT),U.emplaceBack(e.EXTENT,e.EXTENT,e.EXTENT,e.EXTENT),this.rasterBoundsBuffer=E.createVertexBuffer(U,X.members),this.rasterBoundsSegments=e.SegmentVector.simpleSegment(0,0,4,2);var ne=new e.StructArrayLayout2i4;ne.emplaceBack(0,0),ne.emplaceBack(1,0),ne.emplaceBack(0,1),ne.emplaceBack(1,1),this.viewportBuffer=E.createVertexBuffer(ne,gn.members),this.viewportSegments=e.SegmentVector.simpleSegment(0,0,4,2);var le=new e.StructArrayLayout1ui2;le.emplaceBack(0),le.emplaceBack(1),le.emplaceBack(3),le.emplaceBack(2),le.emplaceBack(0),this.tileBorderIndexBuffer=E.createIndexBuffer(le);var pe=new e.StructArrayLayout3ui6;pe.emplaceBack(0,1,2),pe.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=E.createIndexBuffer(pe),this.emptyTexture=new e.Texture(E,{width:1,height:1,data:new Uint8Array([0,0,0,0])},E.gl.RGBA);var ye=this.context.gl;this.stencilClearMode=new _e({func:ye.ALWAYS,mask:0},0,255,ye.ZERO,ye.ZERO,ye.ZERO)},Pa.prototype.clearStencil=function(){var E=this.context,z=E.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var R=e.create();e.ortho(R,0,this.width,this.height,0,0,1),e.scale(R,R,[z.drawingBufferWidth,z.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(E,z.TRIANGLES,Je.disabled,this.stencilClearMode,Le.disabled,Ce.disabled,oo(R),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Pa.prototype._renderTileClippingMasks=function(E,z){if(this.currentStencilSource!==E.source&&E.isTileClipped()&&z&&z.length){this.currentStencilSource=E.source;var R=this.context,U=R.gl;this.nextStencilID+z.length>256&&this.clearStencil(),R.setColorMode(Le.disabled),R.setDepthMode(Je.disabled);var ne=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var le=0,pe=z;le<pe.length;le+=1){var ye=pe[le],Te=this._tileClippingMaskIDs[ye.key]=this.nextStencilID++;ne.draw(R,U.TRIANGLES,Je.disabled,new _e({func:U.ALWAYS,mask:0},Te,255,U.KEEP,U.KEEP,U.REPLACE),Le.disabled,Ce.disabled,oo(ye.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Pa.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var E=this.nextStencilID++,z=this.context.gl;return new _e({func:z.NOTEQUAL,mask:255},E,255,z.KEEP,z.KEEP,z.REPLACE)},Pa.prototype.stencilModeForClipping=function(E){var z=this.context.gl;return new _e({func:z.EQUAL,mask:255},this._tileClippingMaskIDs[E.key],0,z.KEEP,z.KEEP,z.REPLACE)},Pa.prototype.stencilConfigForOverlap=function(E){var z,R=this.context.gl,U=E.sort(function(Te,Ne){return Ne.overscaledZ-Te.overscaledZ}),ne=U[U.length-1].overscaledZ,le=U[0].overscaledZ-ne+1;if(le>1){this.currentStencilSource=void 0,this.nextStencilID+le>256&&this.clearStencil();for(var pe={},ye=0;ye<le;ye++)pe[ye+ne]=new _e({func:R.GEQUAL,mask:255},ye+this.nextStencilID,255,R.KEEP,R.KEEP,R.REPLACE);return this.nextStencilID+=le,[pe,U]}return[(z={},z[ne]=_e.disabled,z),U]},Pa.prototype.colorModeForRenderPass=function(){var E=this.context.gl;return this._showOverdrawInspector?new Le([E.CONSTANT_COLOR,E.ONE],new e.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Le.unblended:Le.alphaBlended},Pa.prototype.depthModeForSublayer=function(E,z,R){if(!this.opaquePassEnabledForLayer())return Je.disabled;var U=1-((1+this.currentLayer)*this.numSublayers+E)*this.depthEpsilon;return new Je(R||this.context.gl.LEQUAL,z,[U,U])},Pa.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Pa.prototype.render=function(E,z){var R=this;this.style=E,this.options=z,this.lineAtlas=E.lineAtlas,this.imageManager=E.imageManager,this.glyphManager=E.glyphManager,this.symbolFadeChange=E.placement.symbolFadeChange(e.browser.now()),this.imageManager.beginFrame();var U=this.style._order,ne=this.style.sourceCaches;for(var le in ne){var pe=ne[le];pe.used&&pe.prepare(this.context)}var ye,Te,Ne={},qe={},tt={};for(var yt in ne){var St=ne[yt];Ne[yt]=St.getVisibleCoordinates(),qe[yt]=Ne[yt].slice().reverse(),tt[yt]=St.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var _t=0;_t<U.length;_t++){var Tt=U[_t];if(this.style._layers[Tt].is3D()){this.opaquePassCutoff=_t;break}}this.renderPass="offscreen";for(var gt=0,Dt=U;gt<Dt.length;gt+=1){var Ot=Dt[gt],Bt=this.style._layers[Ot];if(Bt.hasOffscreenPass()&&!Bt.isHidden(this.transform.zoom)){var er=qe[Bt.source];(Bt.type==="custom"||er.length)&&this.renderLayer(this,ne[Bt.source],Bt,er)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:z.showOverdrawInspector?e.Color.black:e.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=z.showOverdrawInspector,this.depthRangeFor3D=[0,1-(E._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=U.length-1;this.currentLayer>=0;this.currentLayer--){var ur=this.style._layers[U[this.currentLayer]],Tr=ne[ur.source],wr=Ne[ur.source];this._renderTileClippingMasks(ur,wr),this.renderLayer(this,Tr,ur,wr)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<U.length;this.currentLayer++){var Xr=this.style._layers[U[this.currentLayer]],Wr=ne[Xr.source],un=(Xr.type==="symbol"?tt:qe)[Xr.source];this._renderTileClippingMasks(Xr,Ne[Xr.source]),this.renderLayer(this,Wr,Xr,un)}this.options.showTileBoundaries&&(e.values(this.style._layers).forEach(function(an){an.source&&!an.isHidden(R.transform.zoom)&&(an.source!==(Te&&Te.id)&&(Te=R.style.sourceCaches[an.source]),(!ye||ye.getSource().maxzoom<Te.getSource().maxzoom)&&(ye=Te))}),ye&&Qi.debug(this,ye,ye.getVisibleCoordinates())),this.options.showPadding&&vi(this),this.context.setDefault()},Pa.prototype.renderLayer=function(E,z,R,U){R.isHidden(this.transform.zoom)||(R.type==="background"||R.type==="custom"||U.length)&&(this.id=R.id,this.gpuTimingStart(R),Qi[R.type](E,z,R,U,this.style.placement.variableOffsets),this.gpuTimingEnd())},Pa.prototype.gpuTimingStart=function(E){if(this.options.gpuTiming){var z=this.context.extTimerQuery,R=this.gpuTimers[E.id];R||(R=this.gpuTimers[E.id]={calls:0,cpuTime:0,query:z.createQueryEXT()}),R.calls++,z.beginQueryEXT(z.TIME_ELAPSED_EXT,R.query)}},Pa.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var E=this.context.extTimerQuery;E.endQueryEXT(E.TIME_ELAPSED_EXT)}},Pa.prototype.collectGpuTimers=function(){var E=this.gpuTimers;return this.gpuTimers={},E},Pa.prototype.queryGpuTimers=function(E){var z={};for(var R in E){var U=E[R],ne=this.context.extTimerQuery,le=ne.getQueryObjectEXT(U.query,ne.QUERY_RESULT_EXT)/1e6;ne.deleteQueryEXT(U.query),z[R]=le}return z},Pa.prototype.translatePosMatrix=function(E,z,R,U,ne){if(!R[0]&&!R[1])return E;var le=ne?U==="map"?this.transform.angle:0:U==="viewport"?-this.transform.angle:0;if(le){var pe=Math.sin(le),ye=Math.cos(le);R=[R[0]*ye-R[1]*pe,R[0]*pe+R[1]*ye]}var Te=[ne?R[0]:Lr(z,R[0],this.transform.zoom),ne?R[1]:Lr(z,R[1],this.transform.zoom),0],Ne=new Float32Array(16);return e.translate(Ne,E,Te),Ne},Pa.prototype.saveTileTexture=function(E){var z=this._tileTextures[E.size[0]];z?z.push(E):this._tileTextures[E.size[0]]=[E]},Pa.prototype.getTileTexture=function(E){var z=this._tileTextures[E];return z&&z.length>0?z.pop():null},Pa.prototype.isPatternMissing=function(E){if(!E)return!1;if(!E.from||!E.to)return!0;var z=this.imageManager.getPattern(E.from.toString()),R=this.imageManager.getPattern(E.to.toString());return!z||!R},Pa.prototype.useProgram=function(E,z){this.cache=this.cache||{};var R=""+E+(z?z.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[R]||(this.cache[R]=new Ts(this.context,hs[E],z,dr[E],this._showOverdrawInspector)),this.cache[R]},Pa.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Pa.prototype.setBaseState=function(){var E=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(E.FUNC_ADD)},Pa.prototype.initDebugOverlayCanvas=function(){if(this.debugOverlayCanvas==null){this.debugOverlayCanvas=e.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512;var E=this.context.gl;this.debugOverlayTexture=new e.Texture(this.context,this.debugOverlayCanvas,E.RGBA)}},Pa.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var ct=function(E,z){this.points=E,this.planes=z};ct.fromInvProjectionMatrix=function(E,z,R){var U=Math.pow(2,R),ne=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(pe){return e.transformMat4([],pe,E)}).map(function(pe){return e.scale$1([],pe,1/pe[3]/z*U)}),le=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(pe){var ye=e.sub([],ne[pe[0]],ne[pe[1]]),Te=e.sub([],ne[pe[2]],ne[pe[1]]),Ne=e.normalize([],e.cross([],ye,Te)),qe=-e.dot(Ne,ne[pe[1]]);return Ne.concat(qe)});return new ct(ne,le)};var zt=function(E,z){this.min=E,this.max=z,this.center=e.scale$2([],e.add([],this.min,this.max),.5)};zt.prototype.quadrant=function(E){for(var z=[E%2==0,E<2],R=e.clone$2(this.min),U=e.clone$2(this.max),ne=0;ne<z.length;ne++)R[ne]=z[ne]?this.min[ne]:this.center[ne],U[ne]=z[ne]?this.center[ne]:this.max[ne];return U[2]=this.max[2],new zt(R,U)},zt.prototype.distanceX=function(E){return Math.max(Math.min(this.max[0],E[0]),this.min[0])-E[0]},zt.prototype.distanceY=function(E){return Math.max(Math.min(this.max[1],E[1]),this.min[1])-E[1]},zt.prototype.intersects=function(E){for(var z=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],R=!0,U=0;U<E.planes.length;U++){for(var ne=E.planes[U],le=0,pe=0;pe<z.length;pe++)le+=e.dot$1(ne,z[pe])>=0;if(le===0)return 0;le!==z.length&&(R=!1)}if(R)return 2;for(var ye=0;ye<3;ye++){for(var Te=Number.MAX_VALUE,Ne=-Number.MAX_VALUE,qe=0;qe<E.points.length;qe++){var tt=E.points[qe][ye]-this.min[ye];Te=Math.min(Te,tt),Ne=Math.max(Ne,tt)}if(Ne<0||Te>this.max[ye]-this.min[ye])return 0}return 1};var ir=function(E,z,R,U){if(E===void 0&&(E=0),z===void 0&&(z=0),R===void 0&&(R=0),U===void 0&&(U=0),isNaN(E)||E<0||isNaN(z)||z<0||isNaN(R)||R<0||isNaN(U)||U<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=E,this.bottom=z,this.left=R,this.right=U};ir.prototype.interpolate=function(E,z,R){return z.top!=null&&E.top!=null&&(this.top=e.number(E.top,z.top,R)),z.bottom!=null&&E.bottom!=null&&(this.bottom=e.number(E.bottom,z.bottom,R)),z.left!=null&&E.left!=null&&(this.left=e.number(E.left,z.left,R)),z.right!=null&&E.right!=null&&(this.right=e.number(E.right,z.right,R)),this},ir.prototype.getCenter=function(E,z){var R=e.clamp((this.left+E-this.right)/2,0,E),U=e.clamp((this.top+z-this.bottom)/2,0,z);return new e.Point(R,U)},ir.prototype.equals=function(E){return this.top===E.top&&this.bottom===E.bottom&&this.left===E.left&&this.right===E.right},ir.prototype.clone=function(){return new ir(this.top,this.bottom,this.left,this.right)},ir.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var jt=function(E,z,R,U,ne){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=ne===void 0||ne,this._minZoom=E||0,this._maxZoom=z||22,this._minPitch=R==null?0:R,this._maxPitch=U==null?60:U,this.setMaxBounds(),this.width=0,this.height=0,this._center=new e.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new ir,this._posMatrixCache={},this._alignedPosMatrixCache={}},or={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};jt.prototype.clone=function(){var E=new jt(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return E.tileSize=this.tileSize,E.latRange=this.latRange,E.width=this.width,E.height=this.height,E._center=this._center,E.zoom=this.zoom,E.angle=this.angle,E._fov=this._fov,E._pitch=this._pitch,E._unmodified=this._unmodified,E._edgeInsets=this._edgeInsets.clone(),E._calcMatrices(),E},or.minZoom.get=function(){return this._minZoom},or.minZoom.set=function(E){this._minZoom!==E&&(this._minZoom=E,this.zoom=Math.max(this.zoom,E))},or.maxZoom.get=function(){return this._maxZoom},or.maxZoom.set=function(E){this._maxZoom!==E&&(this._maxZoom=E,this.zoom=Math.min(this.zoom,E))},or.minPitch.get=function(){return this._minPitch},or.minPitch.set=function(E){this._minPitch!==E&&(this._minPitch=E,this.pitch=Math.max(this.pitch,E))},or.maxPitch.get=function(){return this._maxPitch},or.maxPitch.set=function(E){this._maxPitch!==E&&(this._maxPitch=E,this.pitch=Math.min(this.pitch,E))},or.renderWorldCopies.get=function(){return this._renderWorldCopies},or.renderWorldCopies.set=function(E){E===void 0?E=!0:E===null&&(E=!1),this._renderWorldCopies=E},or.worldSize.get=function(){return this.tileSize*this.scale},or.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},or.size.get=function(){return new e.Point(this.width,this.height)},or.bearing.get=function(){return-this.angle/Math.PI*180},or.bearing.set=function(E){var z=-e.wrap(E,-180,180)*Math.PI/180;this.angle!==z&&(this._unmodified=!1,this.angle=z,this._calcMatrices(),this.rotationMatrix=e.create$2(),e.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},or.pitch.get=function(){return this._pitch/Math.PI*180},or.pitch.set=function(E){var z=e.clamp(E,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==z&&(this._unmodified=!1,this._pitch=z,this._calcMatrices())},or.fov.get=function(){return this._fov/Math.PI*180},or.fov.set=function(E){E=Math.max(.01,Math.min(60,E)),this._fov!==E&&(this._unmodified=!1,this._fov=E/180*Math.PI,this._calcMatrices())},or.zoom.get=function(){return this._zoom},or.zoom.set=function(E){var z=Math.min(Math.max(E,this.minZoom),this.maxZoom);this._zoom!==z&&(this._unmodified=!1,this._zoom=z,this.scale=this.zoomScale(z),this.tileZoom=Math.floor(z),this.zoomFraction=z-this.tileZoom,this._constrain(),this._calcMatrices())},or.center.get=function(){return this._center},or.center.set=function(E){E.lat===this._center.lat&&E.lng===this._center.lng||(this._unmodified=!1,this._center=E,this._constrain(),this._calcMatrices())},or.padding.get=function(){return this._edgeInsets.toJSON()},or.padding.set=function(E){this._edgeInsets.equals(E)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,E,1),this._calcMatrices())},or.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},jt.prototype.isPaddingEqual=function(E){return this._edgeInsets.equals(E)},jt.prototype.interpolatePadding=function(E,z,R){this._unmodified=!1,this._edgeInsets.interpolate(E,z,R),this._constrain(),this._calcMatrices()},jt.prototype.coveringZoomLevel=function(E){var z=(E.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/E.tileSize));return Math.max(0,z)},jt.prototype.getVisibleUnwrappedCoordinates=function(E){var z=[new e.UnwrappedTileID(0,E)];if(this._renderWorldCopies)for(var R=this.pointCoordinate(new e.Point(0,0)),U=this.pointCoordinate(new e.Point(this.width,0)),ne=this.pointCoordinate(new e.Point(this.width,this.height)),le=this.pointCoordinate(new e.Point(0,this.height)),pe=Math.floor(Math.min(R.x,U.x,ne.x,le.x)),ye=Math.floor(Math.max(R.x,U.x,ne.x,le.x)),Te=pe-1;Te<=ye+1;Te++)Te!==0&&z.push(new e.UnwrappedTileID(Te,E));return z},jt.prototype.coveringTiles=function(E){var z=this.coveringZoomLevel(E),R=z;if(E.minzoom!==void 0&&z<E.minzoom)return[];E.maxzoom!==void 0&&z>E.maxzoom&&(z=E.maxzoom);var U=e.MercatorCoordinate.fromLngLat(this.center),ne=Math.pow(2,z),le=[ne*U.x,ne*U.y,0],pe=ct.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,z),ye=E.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(ye=z);var Te=function(un){return{aabb:new zt([un*ne,0,0],[(un+1)*ne,ne,0]),zoom:0,x:0,y:0,wrap:un,fullyVisible:!1}},Ne=[],qe=[],tt=z,yt=E.reparseOverscaled?R:z;if(this._renderWorldCopies)for(var St=1;St<=3;St++)Ne.push(Te(-St)),Ne.push(Te(St));for(Ne.push(Te(0));Ne.length>0;){var _t=Ne.pop(),Tt=_t.x,gt=_t.y,Dt=_t.fullyVisible;if(!Dt){var Ot=_t.aabb.intersects(pe);if(Ot===0)continue;Dt=Ot===2}var Bt=_t.aabb.distanceX(le),er=_t.aabb.distanceY(le),ur=Math.max(Math.abs(Bt),Math.abs(er)),Tr=3+(1<<tt-_t.zoom)-2;if(_t.zoom===tt||ur>Tr&&_t.zoom>=ye)qe.push({tileID:new e.OverscaledTileID(_t.zoom===tt?yt:_t.zoom,_t.wrap,_t.zoom,Tt,gt),distanceSq:e.sqrLen([le[0]-.5-Tt,le[1]-.5-gt])});else for(var wr=0;wr<4;wr++){var Xr=(Tt<<1)+wr%2,Wr=(gt<<1)+(wr>>1);Ne.push({aabb:_t.aabb.quadrant(wr),zoom:_t.zoom+1,x:Xr,y:Wr,wrap:_t.wrap,fullyVisible:Dt})}}return qe.sort(function(un,an){return un.distanceSq-an.distanceSq}).map(function(un){return un.tileID})},jt.prototype.resize=function(E,z){this.width=E,this.height=z,this.pixelsToGLUnits=[2/E,-2/z],this._constrain(),this._calcMatrices()},or.unmodified.get=function(){return this._unmodified},jt.prototype.zoomScale=function(E){return Math.pow(2,E)},jt.prototype.scaleZoom=function(E){return Math.log(E)/Math.LN2},jt.prototype.project=function(E){var z=e.clamp(E.lat,-this.maxValidLatitude,this.maxValidLatitude);return new e.Point(e.mercatorXfromLng(E.lng)*this.worldSize,e.mercatorYfromLat(z)*this.worldSize)},jt.prototype.unproject=function(E){return new e.MercatorCoordinate(E.x/this.worldSize,E.y/this.worldSize).toLngLat()},or.point.get=function(){return this.project(this.center)},jt.prototype.setLocationAtPoint=function(E,z){var R=this.pointCoordinate(z),U=this.pointCoordinate(this.centerPoint),ne=this.locationCoordinate(E),le=new e.MercatorCoordinate(ne.x-(R.x-U.x),ne.y-(R.y-U.y));this.center=this.coordinateLocation(le),this._renderWorldCopies&&(this.center=this.center.wrap())},jt.prototype.locationPoint=function(E){return this.coordinatePoint(this.locationCoordinate(E))},jt.prototype.pointLocation=function(E){return this.coordinateLocation(this.pointCoordinate(E))},jt.prototype.locationCoordinate=function(E){return e.MercatorCoordinate.fromLngLat(E)},jt.prototype.coordinateLocation=function(E){return E.toLngLat()},jt.prototype.pointCoordinate=function(E){var z=[E.x,E.y,0,1],R=[E.x,E.y,1,1];e.transformMat4(z,z,this.pixelMatrixInverse),e.transformMat4(R,R,this.pixelMatrixInverse);var U=z[3],ne=R[3],le=z[0]/U,pe=R[0]/ne,ye=z[1]/U,Te=R[1]/ne,Ne=z[2]/U,qe=R[2]/ne,tt=Ne===qe?0:(0-Ne)/(qe-Ne);return new e.MercatorCoordinate(e.number(le,pe,tt)/this.worldSize,e.number(ye,Te,tt)/this.worldSize)},jt.prototype.coordinatePoint=function(E){var z=[E.x*this.worldSize,E.y*this.worldSize,0,1];return e.transformMat4(z,z,this.pixelMatrix),new e.Point(z[0]/z[3],z[1]/z[3])},jt.prototype.getBounds=function(){return new e.LngLatBounds().extend(this.pointLocation(new e.Point(0,0))).extend(this.pointLocation(new e.Point(this.width,0))).extend(this.pointLocation(new e.Point(this.width,this.height))).extend(this.pointLocation(new e.Point(0,this.height)))},jt.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new e.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},jt.prototype.setMaxBounds=function(E){E?(this.lngRange=[E.getWest(),E.getEast()],this.latRange=[E.getSouth(),E.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},jt.prototype.calculatePosMatrix=function(E,z){z===void 0&&(z=!1);var R=E.key,U=z?this._alignedPosMatrixCache:this._posMatrixCache;if(U[R])return U[R];var ne=E.canonical,le=this.worldSize/this.zoomScale(ne.z),pe=ne.x+Math.pow(2,ne.z)*E.wrap,ye=e.identity(new Float64Array(16));return e.translate(ye,ye,[pe*le,ne.y*le,0]),e.scale(ye,ye,[le/e.EXTENT,le/e.EXTENT,1]),e.multiply(ye,z?this.alignedProjMatrix:this.projMatrix,ye),U[R]=new Float32Array(ye),U[R]},jt.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},jt.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var E,z,R,U,ne=-90,le=90,pe=-180,ye=180,Te=this.size,Ne=this._unmodified;if(this.latRange){var qe=this.latRange;ne=e.mercatorYfromLat(qe[1])*this.worldSize,E=(le=e.mercatorYfromLat(qe[0])*this.worldSize)-ne<Te.y?Te.y/(le-ne):0}if(this.lngRange){var tt=this.lngRange;pe=e.mercatorXfromLng(tt[0])*this.worldSize,z=(ye=e.mercatorXfromLng(tt[1])*this.worldSize)-pe<Te.x?Te.x/(ye-pe):0}var yt=this.point,St=Math.max(z||0,E||0);if(St)return this.center=this.unproject(new e.Point(z?(ye+pe)/2:yt.x,E?(le+ne)/2:yt.y)),this.zoom+=this.scaleZoom(St),this._unmodified=Ne,void(this._constraining=!1);if(this.latRange){var _t=yt.y,Tt=Te.y/2;_t-Tt<ne&&(U=ne+Tt),_t+Tt>le&&(U=le-Tt)}if(this.lngRange){var gt=yt.x,Dt=Te.x/2;gt-Dt<pe&&(R=pe+Dt),gt+Dt>ye&&(R=ye-Dt)}R===void 0&&U===void 0||(this.center=this.unproject(new e.Point(R!==void 0?R:yt.x,U!==void 0?U:yt.y))),this._unmodified=Ne,this._constraining=!1}},jt.prototype._calcMatrices=function(){if(this.height){var E=this._fov/2,z=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(E)*this.height;var R=Math.PI/2+this._pitch,U=this._fov*(.5+z.y/this.height),ne=Math.sin(U)*this.cameraToCenterDistance/Math.sin(e.clamp(Math.PI-R-U,.01,Math.PI-.01)),le=this.point,pe=le.x,ye=le.y,Te=1.01*(Math.cos(Math.PI/2-this._pitch)*ne+this.cameraToCenterDistance),Ne=this.height/50,qe=new Float64Array(16);e.perspective(qe,this._fov,this.width/this.height,Ne,Te),qe[8]=2*-z.x/this.width,qe[9]=2*z.y/this.height,e.scale(qe,qe,[1,-1,1]),e.translate(qe,qe,[0,0,-this.cameraToCenterDistance]),e.rotateX(qe,qe,this._pitch),e.rotateZ(qe,qe,this.angle),e.translate(qe,qe,[-pe,-ye,0]),this.mercatorMatrix=e.scale([],qe,[this.worldSize,this.worldSize,this.worldSize]),e.scale(qe,qe,[1,1,e.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=qe,this.invProjMatrix=e.invert([],this.projMatrix);var tt=this.width%2/2,yt=this.height%2/2,St=Math.cos(this.angle),_t=Math.sin(this.angle),Tt=pe-Math.round(pe)+St*tt+_t*yt,gt=ye-Math.round(ye)+St*yt+_t*tt,Dt=new Float64Array(qe);if(e.translate(Dt,Dt,[Tt>.5?Tt-1:Tt,gt>.5?gt-1:gt,0]),this.alignedProjMatrix=Dt,qe=e.create(),e.scale(qe,qe,[this.width/2,-this.height/2,1]),e.translate(qe,qe,[1,-1,0]),this.labelPlaneMatrix=qe,qe=e.create(),e.scale(qe,qe,[1,-1,1]),e.translate(qe,qe,[-1,-1,0]),e.scale(qe,qe,[2/this.width,2/this.height,1]),this.glCoordMatrix=qe,this.pixelMatrix=e.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(qe=e.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=qe,this._posMatrixCache={},this._alignedPosMatrixCache={}}},jt.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var E=this.pointCoordinate(new e.Point(0,0)),z=[E.x*this.worldSize,E.y*this.worldSize,0,1];return e.transformMat4(z,z,this.pixelMatrix)[3]/this.cameraToCenterDistance},jt.prototype.getCameraPoint=function(){var E=this._pitch,z=Math.tan(E)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new e.Point(0,z))},jt.prototype.getCameraQueryGeometry=function(E){var z=this.getCameraPoint();if(E.length===1)return[E[0],z];for(var R=z.x,U=z.y,ne=z.x,le=z.y,pe=0,ye=E;pe<ye.length;pe+=1){var Te=ye[pe];R=Math.min(R,Te.x),U=Math.min(U,Te.y),ne=Math.max(ne,Te.x),le=Math.max(le,Te.y)}return[new e.Point(R,U),new e.Point(ne,U),new e.Point(ne,le),new e.Point(R,le),new e.Point(R,U)]},Object.defineProperties(jt.prototype,or);var Er=function(E){var z,R,U,ne,le;this._hashName=E&&encodeURIComponent(E),e.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(z=this._updateHashUnthrottled.bind(this),R=300,U=!1,ne=null,le=function(){ne=null,U&&(z(),ne=setTimeout(le,R),U=!1)},function(){return U=!0,ne||le(),ne})};Er.prototype.addTo=function(E){return this._map=E,e.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Er.prototype.remove=function(){return e.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Er.prototype.getHashString=function(E){var z=this._map.getCenter(),R=Math.round(100*this._map.getZoom())/100,U=Math.ceil((R*Math.LN2+Math.log(512/360/.5))/Math.LN10),ne=Math.pow(10,U),le=Math.round(z.lng*ne)/ne,pe=Math.round(z.lat*ne)/ne,ye=this._map.getBearing(),Te=this._map.getPitch(),Ne="";if(Ne+=E?"/"+le+"/"+pe+"/"+R:R+"/"+pe+"/"+le,(ye||Te)&&(Ne+="/"+Math.round(10*ye)/10),Te&&(Ne+="/"+Math.round(Te)),this._hashName){var qe=this._hashName,tt=!1,yt=e.window.location.hash.slice(1).split("&").map(function(St){var _t=St.split("=")[0];return _t===qe?(tt=!0,_t+"="+Ne):St}).filter(function(St){return St});return tt||yt.push(qe+"="+Ne),"#"+yt.join("&")}return"#"+Ne},Er.prototype._getCurrentHash=function(){var E,z=this,R=e.window.location.hash.replace("#","");return this._hashName?(R.split("&").map(function(U){return U.split("=")}).forEach(function(U){U[0]===z._hashName&&(E=U)}),(E&&E[1]||"").split("/")):R.split("/")},Er.prototype._onHashChange=function(){var E=this._getCurrentHash();if(E.length>=3&&!E.some(function(R){return isNaN(R)})){var z=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(E[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+E[2],+E[1]],zoom:+E[0],bearing:z,pitch:+(E[4]||0)}),!0}return!1},Er.prototype._updateHashUnthrottled=function(){var E=this.getHashString();try{e.window.history.replaceState(e.window.history.state,"",E)}catch(z){}};var Or={linearity:.3,easing:e.bezier(0,0,.3,1)},qr=e.extend({deceleration:2500,maxSpeed:1400},Or),on=e.extend({deceleration:20,maxSpeed:1400},Or),nn=e.extend({deceleration:1e3,maxSpeed:360},Or),dn=e.extend({deceleration:1e3,maxSpeed:90},Or),bn=function(E){this._map=E,this.clear()};function sn(E,z){(!E.duration||E.duration<z.duration)&&(E.duration=z.duration,E.easing=z.easing)}function _n(E,z,R){var U=R.maxSpeed,ne=R.linearity,le=R.deceleration,pe=e.clamp(E*ne/(z/1e3),-U,U),ye=Math.abs(pe)/(le*ne);return{easing:R.easing,duration:1e3*ye,amount:pe*(ye/2)}}bn.prototype.clear=function(){this._inertiaBuffer=[]},bn.prototype.record=function(E){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:e.browser.now(),settings:E})},bn.prototype._drainInertiaBuffer=function(){for(var E=this._inertiaBuffer,z=e.browser.now();E.length>0&&z-E[0].time>160;)E.shift()},bn.prototype._onMoveEnd=function(E){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var z={zoom:0,bearing:0,pitch:0,pan:new e.Point(0,0),pinchAround:void 0,around:void 0},R=0,U=this._inertiaBuffer;R<U.length;R+=1){var ne=U[R].settings;z.zoom+=ne.zoomDelta||0,z.bearing+=ne.bearingDelta||0,z.pitch+=ne.pitchDelta||0,ne.panDelta&&z.pan._add(ne.panDelta),ne.around&&(z.around=ne.around),ne.pinchAround&&(z.pinchAround=ne.pinchAround)}var le=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,pe={};if(z.pan.mag()){var ye=_n(z.pan.mag(),le,e.extend({},qr,E||{}));pe.offset=z.pan.mult(ye.amount/z.pan.mag()),pe.center=this._map.transform.center,sn(pe,ye)}if(z.zoom){var Te=_n(z.zoom,le,on);pe.zoom=this._map.transform.zoom+Te.amount,sn(pe,Te)}if(z.bearing){var Ne=_n(z.bearing,le,nn);pe.bearing=this._map.transform.bearing+e.clamp(Ne.amount,-179,179),sn(pe,Ne)}if(z.pitch){var qe=_n(z.pitch,le,dn);pe.pitch=this._map.transform.pitch+qe.amount,sn(pe,qe)}if(pe.zoom||pe.bearing){var tt=z.pinchAround===void 0?z.around:z.pinchAround;pe.around=tt?this._map.unproject(tt):this._map.getCenter()}return this.clear(),e.extend(pe,{noMoveStart:!0})}};var zn=function(E){function z(U,ne,le,pe){pe===void 0&&(pe={});var ye=u.mousePos(ne.getCanvasContainer(),le),Te=ne.unproject(ye);E.call(this,U,e.extend({point:ye,lngLat:Te,originalEvent:le},pe)),this._defaultPrevented=!1,this.target=ne}E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z;var R={defaultPrevented:{configurable:!0}};return z.prototype.preventDefault=function(){this._defaultPrevented=!0},R.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(z.prototype,R),z}(e.Event),jn=function(E){function z(U,ne,le){var pe=U==="touchend"?le.changedTouches:le.touches,ye=u.touchPos(ne.getCanvasContainer(),pe),Te=ye.map(function(tt){return ne.unproject(tt)}),Ne=ye.reduce(function(tt,yt,St,_t){return tt.add(yt.div(_t.length))},new e.Point(0,0)),qe=ne.unproject(Ne);E.call(this,U,{points:ye,point:Ne,lngLats:Te,lngLat:qe,originalEvent:le}),this._defaultPrevented=!1}E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z;var R={defaultPrevented:{configurable:!0}};return z.prototype.preventDefault=function(){this._defaultPrevented=!0},R.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(z.prototype,R),z}(e.Event),ea=function(E){function z(U,ne,le){E.call(this,U,{originalEvent:le}),this._defaultPrevented=!1}E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z;var R={defaultPrevented:{configurable:!0}};return z.prototype.preventDefault=function(){this._defaultPrevented=!0},R.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(z.prototype,R),z}(e.Event),Yr=function(E,z){this._map=E,this._clickTolerance=z.clickTolerance};Yr.prototype.reset=function(){delete this._mousedownPos},Yr.prototype.wheel=function(E){return this._firePreventable(new ea(E.type,this._map,E))},Yr.prototype.mousedown=function(E,z){return this._mousedownPos=z,this._firePreventable(new zn(E.type,this._map,E))},Yr.prototype.mouseup=function(E){this._map.fire(new zn(E.type,this._map,E))},Yr.prototype.click=function(E,z){this._mousedownPos&&this._mousedownPos.dist(z)>=this._clickTolerance||this._map.fire(new zn(E.type,this._map,E))},Yr.prototype.dblclick=function(E){return this._firePreventable(new zn(E.type,this._map,E))},Yr.prototype.mouseover=function(E){this._map.fire(new zn(E.type,this._map,E))},Yr.prototype.mouseout=function(E){this._map.fire(new zn(E.type,this._map,E))},Yr.prototype.touchstart=function(E){return this._firePreventable(new jn(E.type,this._map,E))},Yr.prototype.touchmove=function(E){this._map.fire(new jn(E.type,this._map,E))},Yr.prototype.touchend=function(E){this._map.fire(new jn(E.type,this._map,E))},Yr.prototype.touchcancel=function(E){this._map.fire(new jn(E.type,this._map,E))},Yr.prototype._firePreventable=function(E){if(this._map.fire(E),E.defaultPrevented)return{}},Yr.prototype.isEnabled=function(){return!0},Yr.prototype.isActive=function(){return!1},Yr.prototype.enable=function(){},Yr.prototype.disable=function(){};var Kn=function(E){this._map=E};Kn.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},Kn.prototype.mousemove=function(E){this._map.fire(new zn(E.type,this._map,E))},Kn.prototype.mousedown=function(){this._delayContextMenu=!0},Kn.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new zn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},Kn.prototype.contextmenu=function(E){this._delayContextMenu?this._contextMenuEvent=E:this._map.fire(new zn(E.type,this._map,E)),this._map.listens("contextmenu")&&E.preventDefault()},Kn.prototype.isEnabled=function(){return!0},Kn.prototype.isActive=function(){return!1},Kn.prototype.enable=function(){},Kn.prototype.disable=function(){};var En=function(E,z){this._map=E,this._el=E.getCanvasContainer(),this._container=E.getContainer(),this._clickTolerance=z.clickTolerance||1};function Bn(E,z){for(var R={},U=0;U<E.length;U++)R[E[U].identifier]=z[U];return R}En.prototype.isEnabled=function(){return!!this._enabled},En.prototype.isActive=function(){return!!this._active},En.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},En.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},En.prototype.mousedown=function(E,z){this.isEnabled()&&E.shiftKey&&E.button===0&&(u.disableDrag(),this._startPos=this._lastPos=z,this._active=!0)},En.prototype.mousemoveWindow=function(E,z){if(this._active){var R=z;if(!(this._lastPos.equals(R)||!this._box&&R.dist(this._startPos)<this._clickTolerance)){var U=this._startPos;this._lastPos=R,this._box||(this._box=u.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",E));var ne=Math.min(U.x,R.x),le=Math.max(U.x,R.x),pe=Math.min(U.y,R.y),ye=Math.max(U.y,R.y);u.setTransform(this._box,"translate("+ne+"px,"+pe+"px)"),this._box.style.width=le-ne+"px",this._box.style.height=ye-pe+"px"}}},En.prototype.mouseupWindow=function(E,z){var R=this;if(this._active&&E.button===0){var U=this._startPos,ne=z;if(this.reset(),u.suppressClick(),U.x!==ne.x||U.y!==ne.y)return this._map.fire(new e.Event("boxzoomend",{originalEvent:E})),{cameraAnimation:function(le){return le.fitScreenCoordinates(U,ne,R._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",E)}},En.prototype.keydown=function(E){this._active&&E.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",E))},En.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(u.remove(this._box),this._box=null),u.enableDrag(),delete this._startPos,delete this._lastPos},En.prototype._fireEvent=function(E,z){return this._map.fire(new e.Event(E,{originalEvent:z}))};var Jn=function(E){this.reset(),this.numTouches=E.numTouches};Jn.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Jn.prototype.touchstart=function(E,z,R){(this.centroid||R.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=E.timeStamp),R.length===this.numTouches&&(this.centroid=function(U){for(var ne=new e.Point(0,0),le=0,pe=U;le<pe.length;le+=1){var ye=pe[le];ne._add(ye)}return ne.div(U.length)}(z),this.touches=Bn(R,z)))},Jn.prototype.touchmove=function(E,z,R){if(!this.aborted&&this.centroid){var U=Bn(R,z);for(var ne in this.touches){var le=this.touches[ne],pe=U[ne];(!pe||pe.dist(le)>30)&&(this.aborted=!0)}}},Jn.prototype.touchend=function(E,z,R){if((!this.centroid||E.timeStamp-this.startTime>500)&&(this.aborted=!0),R.length===0){var U=!this.aborted&&this.centroid;if(this.reset(),U)return U}};var ba=function(E){this.singleTap=new Jn(E),this.numTaps=E.numTaps,this.reset()};ba.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},ba.prototype.touchstart=function(E,z,R){this.singleTap.touchstart(E,z,R)},ba.prototype.touchmove=function(E,z,R){this.singleTap.touchmove(E,z,R)},ba.prototype.touchend=function(E,z,R){var U=this.singleTap.touchend(E,z,R);if(U){var ne=E.timeStamp-this.lastTime<500,le=!this.lastTap||this.lastTap.dist(U)<30;if(ne&&le||this.reset(),this.count++,this.lastTime=E.timeStamp,this.lastTap=U,this.count===this.numTaps)return this.reset(),U}};var Ma=function(){this._zoomIn=new ba({numTouches:1,numTaps:2}),this._zoomOut=new ba({numTouches:2,numTaps:1}),this.reset()};Ma.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Ma.prototype.touchstart=function(E,z,R){this._zoomIn.touchstart(E,z,R),this._zoomOut.touchstart(E,z,R)},Ma.prototype.touchmove=function(E,z,R){this._zoomIn.touchmove(E,z,R),this._zoomOut.touchmove(E,z,R)},Ma.prototype.touchend=function(E,z,R){var U=this,ne=this._zoomIn.touchend(E,z,R),le=this._zoomOut.touchend(E,z,R);return ne?(this._active=!0,E.preventDefault(),setTimeout(function(){return U.reset()},0),{cameraAnimation:function(pe){return pe.easeTo({duration:300,zoom:pe.getZoom()+1,around:pe.unproject(ne)},{originalEvent:E})}}):le?(this._active=!0,E.preventDefault(),setTimeout(function(){return U.reset()},0),{cameraAnimation:function(pe){return pe.easeTo({duration:300,zoom:pe.getZoom()-1,around:pe.unproject(le)},{originalEvent:E})}}):void 0},Ma.prototype.touchcancel=function(){this.reset()},Ma.prototype.enable=function(){this._enabled=!0},Ma.prototype.disable=function(){this._enabled=!1,this.reset()},Ma.prototype.isEnabled=function(){return this._enabled},Ma.prototype.isActive=function(){return this._active};var kn=function(E){this.reset(),this._clickTolerance=E.clickTolerance||1};kn.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},kn.prototype._correctButton=function(E,z){return!1},kn.prototype._move=function(E,z){return{}},kn.prototype.mousedown=function(E,z){if(!this._lastPoint){var R=u.mouseButton(E);this._correctButton(E,R)&&(this._lastPoint=z,this._eventButton=R)}},kn.prototype.mousemoveWindow=function(E,z){var R=this._lastPoint;if(R&&(E.preventDefault(),this._moved||!(z.dist(R)<this._clickTolerance)))return this._moved=!0,this._lastPoint=z,this._move(R,z)},kn.prototype.mouseupWindow=function(E){u.mouseButton(E)===this._eventButton&&(this._moved&&u.suppressClick(),this.reset())},kn.prototype.enable=function(){this._enabled=!0},kn.prototype.disable=function(){this._enabled=!1,this.reset()},kn.prototype.isEnabled=function(){return this._enabled},kn.prototype.isActive=function(){return this._active};var Ia=function(E){function z(){E.apply(this,arguments)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.mousedown=function(R,U){E.prototype.mousedown.call(this,R,U),this._lastPoint&&(this._active=!0)},z.prototype._correctButton=function(R,U){return U===0&&!R.ctrlKey},z.prototype._move=function(R,U){return{around:U,panDelta:U.sub(R)}},z}(kn),ka=function(E){function z(){E.apply(this,arguments)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype._correctButton=function(R,U){return U===0&&R.ctrlKey||U===2},z.prototype._move=function(R,U){var ne=.8*(U.x-R.x);if(ne)return this._active=!0,{bearingDelta:ne}},z.prototype.contextmenu=function(R){R.preventDefault()},z}(kn),ha=function(E){function z(){E.apply(this,arguments)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype._correctButton=function(R,U){return U===0&&R.ctrlKey||U===2},z.prototype._move=function(R,U){var ne=-.5*(U.y-R.y);if(ne)return this._active=!0,{pitchDelta:ne}},z.prototype.contextmenu=function(R){R.preventDefault()},z}(kn),Oa=function(E){this._minTouches=1,this._clickTolerance=E.clickTolerance||1,this.reset()};Oa.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new e.Point(0,0)},Oa.prototype.touchstart=function(E,z,R){return this._calculateTransform(E,z,R)},Oa.prototype.touchmove=function(E,z,R){if(this._active)return E.preventDefault(),this._calculateTransform(E,z,R)},Oa.prototype.touchend=function(E,z,R){this._calculateTransform(E,z,R),this._active&&R.length<this._minTouches&&this.reset()},Oa.prototype.touchcancel=function(){this.reset()},Oa.prototype._calculateTransform=function(E,z,R){R.length>0&&(this._active=!0);var U=Bn(R,z),ne=new e.Point(0,0),le=new e.Point(0,0),pe=0;for(var ye in U){var Te=U[ye],Ne=this._touches[ye];Ne&&(ne._add(Te),le._add(Te.sub(Ne)),pe++,U[ye]=Te)}if(this._touches=U,!(pe<this._minTouches)&&le.mag()){var qe=le.div(pe);if(this._sum._add(qe),!(this._sum.mag()<this._clickTolerance))return{around:ne.div(pe),panDelta:qe}}},Oa.prototype.enable=function(){this._enabled=!0},Oa.prototype.disable=function(){this._enabled=!1,this.reset()},Oa.prototype.isEnabled=function(){return this._enabled},Oa.prototype.isActive=function(){return this._active};var wa=function(){this.reset()};function Ka(E,z,R){for(var U=0;U<E.length;U++)if(E[U].identifier===R)return z[U]}wa.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},wa.prototype._start=function(E){},wa.prototype._move=function(E,z,R){return{}},wa.prototype.touchstart=function(E,z,R){this._firstTwoTouches||R.length<2||(this._firstTwoTouches=[R[0].identifier,R[1].identifier],this._start([z[0],z[1]]))},wa.prototype.touchmove=function(E,z,R){if(this._firstTwoTouches){E.preventDefault();var U=this._firstTwoTouches,ne=U[0],le=U[1],pe=Ka(R,z,ne),ye=Ka(R,z,le);if(pe&&ye){var Te=this._aroundCenter?null:pe.add(ye).div(2);return this._move([pe,ye],Te,E)}}},wa.prototype.touchend=function(E,z,R){if(this._firstTwoTouches){var U=this._firstTwoTouches,ne=U[0],le=U[1],pe=Ka(R,z,ne),ye=Ka(R,z,le);pe&&ye||(this._active&&u.suppressClick(),this.reset())}},wa.prototype.touchcancel=function(){this.reset()},wa.prototype.enable=function(E){this._enabled=!0,this._aroundCenter=!!E&&E.around==="center"},wa.prototype.disable=function(){this._enabled=!1,this.reset()},wa.prototype.isEnabled=function(){return this._enabled},wa.prototype.isActive=function(){return this._active};function Qn(E,z){return Math.log(E/z)/Math.LN2}var Ga=function(E){function z(){E.apply(this,arguments)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.reset=function(){E.prototype.reset.call(this),delete this._distance,delete this._startDistance},z.prototype._start=function(R){this._startDistance=this._distance=R[0].dist(R[1])},z.prototype._move=function(R,U){var ne=this._distance;if(this._distance=R[0].dist(R[1]),this._active||!(Math.abs(Qn(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Qn(this._distance,ne),pinchAround:U}},z}(wa);function Fi(E,z){return 180*E.angleWith(z)/Math.PI}var Xo=function(E){function z(){E.apply(this,arguments)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.reset=function(){E.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},z.prototype._start=function(R){this._startVector=this._vector=R[0].sub(R[1]),this._minDiameter=R[0].dist(R[1])},z.prototype._move=function(R,U){var ne=this._vector;if(this._vector=R[0].sub(R[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Fi(this._vector,ne),pinchAround:U}},z.prototype._isBelowThreshold=function(R){this._minDiameter=Math.min(this._minDiameter,R.mag());var U=25/(Math.PI*this._minDiameter)*360,ne=Fi(R,this._startVector);return Math.abs(ne)<U},z}(wa);function Io(E){return Math.abs(E.y)>Math.abs(E.x)}var po=function(E){function z(){E.apply(this,arguments)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.reset=function(){E.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},z.prototype._start=function(R){this._lastPoints=R,Io(R[0].sub(R[1]))&&(this._valid=!1)},z.prototype._move=function(R,U,ne){var le=R[0].sub(this._lastPoints[0]),pe=R[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(le,pe,ne.timeStamp),this._valid)return this._lastPoints=R,this._active=!0,{pitchDelta:-.5*((le.y+pe.y)/2)}},z.prototype.gestureBeginsVertically=function(R,U,ne){if(this._valid!==void 0)return this._valid;var le=R.mag()>=2,pe=U.mag()>=2;if(le||pe){if(!le||!pe)return this._firstMove===void 0&&(this._firstMove=ne),ne-this._firstMove<100&&void 0;var ye=R.y>0==U.y>0;return Io(R)&&Io(U)&&ye}},z}(wa),ma={panStep:100,bearingStep:15,pitchStep:10},hi=function(){var E=ma;this._panStep=E.panStep,this._bearingStep=E.bearingStep,this._pitchStep=E.pitchStep};function mo(E){return E*(2-E)}hi.prototype.reset=function(){this._active=!1},hi.prototype.keydown=function(E){var z=this;if(!(E.altKey||E.ctrlKey||E.metaKey)){var R=0,U=0,ne=0,le=0,pe=0;switch(E.keyCode){case 61:case 107:case 171:case 187:R=1;break;case 189:case 109:case 173:R=-1;break;case 37:E.shiftKey?U=-1:(E.preventDefault(),le=-1);break;case 39:E.shiftKey?U=1:(E.preventDefault(),le=1);break;case 38:E.shiftKey?ne=1:(E.preventDefault(),pe=-1);break;case 40:E.shiftKey?ne=-1:(E.preventDefault(),pe=1);break;default:return}return{cameraAnimation:function(ye){var Te=ye.getZoom();ye.easeTo({duration:300,easeId:"keyboardHandler",easing:mo,zoom:R?Math.round(Te)+R*(E.shiftKey?2:1):Te,bearing:ye.getBearing()+U*z._bearingStep,pitch:ye.getPitch()+ne*z._pitchStep,offset:[-le*z._panStep,-pe*z._panStep],center:ye.getCenter()},{originalEvent:E})}}}},hi.prototype.enable=function(){this._enabled=!0},hi.prototype.disable=function(){this._enabled=!1,this.reset()},hi.prototype.isEnabled=function(){return this._enabled},hi.prototype.isActive=function(){return this._active};var Ya=function(E,z){this._map=E,this._el=E.getCanvasContainer(),this._handler=z,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,e.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};Ya.prototype.setZoomRate=function(E){this._defaultZoomRate=E},Ya.prototype.setWheelZoomRate=function(E){this._wheelZoomRate=E},Ya.prototype.isEnabled=function(){return!!this._enabled},Ya.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},Ya.prototype.isZooming=function(){return!!this._zooming},Ya.prototype.enable=function(E){this.isEnabled()||(this._enabled=!0,this._aroundCenter=E&&E.around==="center")},Ya.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Ya.prototype.wheel=function(E){if(this.isEnabled()){var z=E.deltaMode===e.window.WheelEvent.DOM_DELTA_LINE?40*E.deltaY:E.deltaY,R=e.browser.now(),U=R-(this._lastWheelEventTime||0);this._lastWheelEventTime=R,z!==0&&z%4.000244140625==0?this._type="wheel":z!==0&&Math.abs(z)<4?this._type="trackpad":U>400?(this._type=null,this._lastValue=z,this._timeout=setTimeout(this._onTimeout,40,E)):this._type||(this._type=Math.abs(U*z)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,z+=this._lastValue)),E.shiftKey&&z&&(z/=4),this._type&&(this._lastWheelEvent=E,this._delta-=z,this._active||this._start(E)),E.preventDefault()}},Ya.prototype._onTimeout=function(E){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(E)},Ya.prototype._start=function(E){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var z=u.mousePos(this._el,E);this._around=e.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(z)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Ya.prototype.renderFrame=function(){return this._onScrollFrame()},Ya.prototype._onScrollFrame=function(){var E=this;if(this._frameId&&(this._frameId=null,this.isActive())){var z=this._map.transform;if(this._delta!==0){var R=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,U=2/(1+Math.exp(-Math.abs(this._delta*R)));this._delta<0&&U!==0&&(U=1/U);var ne=typeof this._targetZoom=="number"?z.zoomScale(this._targetZoom):z.scale;this._targetZoom=Math.min(z.maxZoom,Math.max(z.minZoom,z.scaleZoom(ne*U))),this._type==="wheel"&&(this._startZoom=z.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var le,pe=typeof this._targetZoom=="number"?this._targetZoom:z.zoom,ye=this._startZoom,Te=this._easing,Ne=!1;if(this._type==="wheel"&&ye&&Te){var qe=Math.min((e.browser.now()-this._lastWheelEventTime)/200,1),tt=Te(qe);le=e.number(ye,pe,tt),qe<1?this._frameId||(this._frameId=!0):Ne=!0}else le=pe,Ne=!0;return this._active=!0,Ne&&(this._active=!1,this._finishTimeout=setTimeout(function(){E._zooming=!1,E._handler._triggerRenderFrame(),delete E._targetZoom,delete E._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!Ne,zoomDelta:le-z.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Ya.prototype._smoothOutEasing=function(E){var z=e.ease;if(this._prevEase){var R=this._prevEase,U=(e.browser.now()-R.start)/R.duration,ne=R.easing(U+.01)-R.easing(U),le=.27/Math.sqrt(ne*ne+1e-4)*.01,pe=Math.sqrt(.0729-le*le);z=e.bezier(le,pe,.25,1)}return this._prevEase={start:e.browser.now(),duration:E,easing:z},z},Ya.prototype.reset=function(){this._active=!1};var _i=function(E,z){this._clickZoom=E,this._tapZoom=z};_i.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},_i.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},_i.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},_i.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Ui=function(){this.reset()};Ui.prototype.reset=function(){this._active=!1},Ui.prototype.dblclick=function(E,z){return E.preventDefault(),{cameraAnimation:function(R){R.easeTo({duration:300,zoom:R.getZoom()+(E.shiftKey?-1:1),around:R.unproject(z)},{originalEvent:E})}}},Ui.prototype.enable=function(){this._enabled=!0},Ui.prototype.disable=function(){this._enabled=!1,this.reset()},Ui.prototype.isEnabled=function(){return this._enabled},Ui.prototype.isActive=function(){return this._active};var $a=function(){this._tap=new ba({numTouches:1,numTaps:1}),this.reset()};$a.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},$a.prototype.touchstart=function(E,z,R){this._swipePoint||(this._tapTime&&E.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?R.length>0&&(this._swipePoint=z[0],this._swipeTouch=R[0].identifier):this._tap.touchstart(E,z,R))},$a.prototype.touchmove=function(E,z,R){if(this._tapTime){if(this._swipePoint){if(R[0].identifier!==this._swipeTouch)return;var U=z[0],ne=U.y-this._swipePoint.y;return this._swipePoint=U,E.preventDefault(),this._active=!0,{zoomDelta:ne/128}}}else this._tap.touchmove(E,z,R)},$a.prototype.touchend=function(E,z,R){this._tapTime?this._swipePoint&&R.length===0&&this.reset():this._tap.touchend(E,z,R)&&(this._tapTime=E.timeStamp)},$a.prototype.touchcancel=function(){this.reset()},$a.prototype.enable=function(){this._enabled=!0},$a.prototype.disable=function(){this._enabled=!1,this.reset()},$a.prototype.isEnabled=function(){return this._enabled},$a.prototype.isActive=function(){return this._active};var so=function(E,z,R){this._el=E,this._mousePan=z,this._touchPan=R};so.prototype.enable=function(E){this._inertiaOptions=E||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},so.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},so.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},so.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var ei=function(E,z,R){this._pitchWithRotate=E.pitchWithRotate,this._mouseRotate=z,this._mousePitch=R};ei.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},ei.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},ei.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},ei.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var $i=function(E,z,R,U){this._el=E,this._touchZoom=z,this._touchRotate=R,this._tapDragZoom=U,this._rotationDisabled=!1,this._enabled=!0};$i.prototype.enable=function(E){this._touchZoom.enable(E),this._rotationDisabled||this._touchRotate.enable(E),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},$i.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},$i.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},$i.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},$i.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},$i.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var os=function(E){return E.zoom||E.drag||E.pitch||E.rotate},es=function(E){function z(){E.apply(this,arguments)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z}(e.Event);function Fs(E){return E.panDelta&&E.panDelta.mag()||E.zoomDelta||E.bearingDelta||E.pitchDelta}var Ii=function(E,z){this._map=E,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new bn(E),this._bearingSnap=z.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(z),e.bindAll(["handleEvent","handleWindowEvent"],this);var R=this._el;this._listeners=[[R,"touchstart",{passive:!1}],[R,"touchmove",{passive:!1}],[R,"touchend",void 0],[R,"touchcancel",void 0],[R,"mousedown",void 0],[R,"mousemove",void 0],[R,"mouseup",void 0],[e.window.document,"mousemove",{capture:!0}],[e.window.document,"mouseup",void 0],[R,"mouseover",void 0],[R,"mouseout",void 0],[R,"dblclick",void 0],[R,"click",void 0],[R,"keydown",{capture:!1}],[R,"keyup",void 0],[R,"wheel",{passive:!1}],[R,"contextmenu",void 0],[e.window,"blur",void 0]];for(var U=0,ne=this._listeners;U<ne.length;U+=1){var le=ne[U],pe=le[0],ye=le[1],Te=le[2];u.addEventListener(pe,ye,pe===e.window.document?this.handleWindowEvent:this.handleEvent,Te)}};Ii.prototype.destroy=function(){for(var E=0,z=this._listeners;E<z.length;E+=1){var R=z[E],U=R[0],ne=R[1],le=R[2];u.removeEventListener(U,ne,U===e.window.document?this.handleWindowEvent:this.handleEvent,le)}},Ii.prototype._addDefaultHandlers=function(E){var z=this._map,R=z.getCanvasContainer();this._add("mapEvent",new Yr(z,E));var U=z.boxZoom=new En(z,E);this._add("boxZoom",U);var ne=new Ma,le=new Ui;z.doubleClickZoom=new _i(le,ne),this._add("tapZoom",ne),this._add("clickZoom",le);var pe=new $a;this._add("tapDragZoom",pe);var ye=z.touchPitch=new po;this._add("touchPitch",ye);var Te=new ka(E),Ne=new ha(E);z.dragRotate=new ei(E,Te,Ne),this._add("mouseRotate",Te,["mousePitch"]),this._add("mousePitch",Ne,["mouseRotate"]);var qe=new Ia(E),tt=new Oa(E);z.dragPan=new so(R,qe,tt),this._add("mousePan",qe),this._add("touchPan",tt,["touchZoom","touchRotate"]);var yt=new Xo,St=new Ga;z.touchZoomRotate=new $i(R,St,yt,pe),this._add("touchRotate",yt,["touchPan","touchZoom"]),this._add("touchZoom",St,["touchPan","touchRotate"]);var _t=z.scrollZoom=new Ya(z,this);this._add("scrollZoom",_t,["mousePan"]);var Tt=z.keyboard=new hi;this._add("keyboard",Tt),this._add("blockableMapEvent",new Kn(z));for(var gt=0,Dt=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];gt<Dt.length;gt+=1){var Ot=Dt[gt];E.interactive&&E[Ot]&&z[Ot].enable(E[Ot])}},Ii.prototype._add=function(E,z,R){this._handlers.push({handlerName:E,handler:z,allowed:R}),this._handlersById[E]=z},Ii.prototype.stop=function(){if(!this._updatingCamera){for(var E=0,z=this._handlers;E<z.length;E+=1)z[E].handler.reset();this._inertia.clear(),this._fireEvents({},{}),this._changes=[]}},Ii.prototype.isActive=function(){for(var E=0,z=this._handlers;E<z.length;E+=1)if(z[E].handler.isActive())return!0;return!1},Ii.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Ii.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Ii.prototype.isMoving=function(){return Boolean(os(this._eventsInProgress))||this.isZooming()},Ii.prototype._blockedByActive=function(E,z,R){for(var U in E)if(U!==R&&(!z||z.indexOf(U)<0))return!0;return!1},Ii.prototype.handleWindowEvent=function(E){this.handleEvent(E,E.type+"Window")},Ii.prototype._getMapTouches=function(E){for(var z=[],R=0,U=E;R<U.length;R+=1){var ne=U[R],le=ne.target;this._el.contains(le)&&z.push(ne)}return z},Ii.prototype.handleEvent=function(E,z){if(E.type!=="blur"){this._updatingCamera=!0;for(var R=E.type==="renderFrame"?void 0:E,U={needsRenderFrame:!1},ne={},le={},pe=E.touches?this._getMapTouches(E.touches):void 0,ye=pe?u.touchPos(this._el,pe):u.mousePos(this._el,E),Te=0,Ne=this._handlers;Te<Ne.length;Te+=1){var qe=Ne[Te],tt=qe.handlerName,yt=qe.handler,St=qe.allowed;if(yt.isEnabled()){var _t=void 0;this._blockedByActive(le,St,tt)?yt.reset():yt[z||E.type]&&(_t=yt[z||E.type](E,ye,pe),this.mergeHandlerResult(U,ne,_t,tt,R),_t&&_t.needsRenderFrame&&this._triggerRenderFrame()),(_t||yt.isActive())&&(le[tt]=yt)}}var Tt={};for(var gt in this._previousActiveHandlers)le[gt]||(Tt[gt]=R);this._previousActiveHandlers=le,(Object.keys(Tt).length||Fs(U))&&(this._changes.push([U,ne,Tt]),this._triggerRenderFrame()),(Object.keys(le).length||Fs(U))&&this._map._stop(!0),this._updatingCamera=!1;var Dt=U.cameraAnimation;Dt&&(this._inertia.clear(),this._fireEvents({},{}),this._changes=[],Dt(this._map))}else this.stop()},Ii.prototype.mergeHandlerResult=function(E,z,R,U,ne){if(R){e.extend(E,R);var le={handlerName:U,originalEvent:R.originalEvent||ne};R.zoomDelta!==void 0&&(z.zoom=le),R.panDelta!==void 0&&(z.drag=le),R.pitchDelta!==void 0&&(z.pitch=le),R.bearingDelta!==void 0&&(z.rotate=le)}},Ii.prototype._applyChanges=function(){for(var E={},z={},R={},U=0,ne=this._changes;U<ne.length;U+=1){var le=ne[U],pe=le[0],ye=le[1],Te=le[2];pe.panDelta&&(E.panDelta=(E.panDelta||new e.Point(0,0))._add(pe.panDelta)),pe.zoomDelta&&(E.zoomDelta=(E.zoomDelta||0)+pe.zoomDelta),pe.bearingDelta&&(E.bearingDelta=(E.bearingDelta||0)+pe.bearingDelta),pe.pitchDelta&&(E.pitchDelta=(E.pitchDelta||0)+pe.pitchDelta),pe.around!==void 0&&(E.around=pe.around),pe.pinchAround!==void 0&&(E.pinchAround=pe.pinchAround),pe.noInertia&&(E.noInertia=pe.noInertia),e.extend(z,ye),e.extend(R,Te)}this._updateMapTransform(E,z,R),this._changes=[]},Ii.prototype._updateMapTransform=function(E,z,R){var U=this._map,ne=U.transform;if(!Fs(E))return this._fireEvents(z,R);var le=E.panDelta,pe=E.zoomDelta,ye=E.bearingDelta,Te=E.pitchDelta,Ne=E.around,qe=E.pinchAround;qe!==void 0&&(Ne=qe),U._stop(!0),Ne=Ne||U.transform.centerPoint;var tt=ne.pointLocation(le?Ne.sub(le):Ne);ye&&(ne.bearing+=ye),Te&&(ne.pitch+=Te),pe&&(ne.zoom+=pe),ne.setLocationAtPoint(tt,Ne),this._map._update(),E.noInertia||this._inertia.record(E),this._fireEvents(z,R)},Ii.prototype._fireEvents=function(E,z){var R=this,U=os(this._eventsInProgress),ne=os(E),le={};for(var pe in E){var ye=E[pe].originalEvent;this._eventsInProgress[pe]||(le[pe+"start"]=ye),this._eventsInProgress[pe]=E[pe]}for(var Te in!U&&ne&&this._fireEvent("movestart",ne.originalEvent),le)this._fireEvent(Te,le[Te]);for(var Ne in E.rotate&&(this._bearingChanged=!0),ne&&this._fireEvent("move",ne.originalEvent),E){var qe=E[Ne].originalEvent;this._fireEvent(Ne,qe)}var tt,yt={};for(var St in this._eventsInProgress){var _t=this._eventsInProgress[St],Tt=_t.handlerName,gt=_t.originalEvent;this._handlersById[Tt].isActive()||(delete this._eventsInProgress[St],tt=z[Tt]||gt,yt[St+"end"]=tt)}for(var Dt in yt)this._fireEvent(Dt,yt[Dt]);var Ot=os(this._eventsInProgress);if((U||ne)&&!Ot){this._updatingCamera=!0;var Bt=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),er=function(ur){return ur!==0&&-R._bearingSnap<ur&&ur<R._bearingSnap};Bt?(er(Bt.bearing||this._map.getBearing())&&(Bt.bearing=0),this._map.easeTo(Bt,{originalEvent:tt})):(this._map.fire(new e.Event("moveend",{originalEvent:tt})),er(this._map.getBearing())&&this._map.resetNorth()),this._bearingChanged=!1,this._updatingCamera=!1}},Ii.prototype._fireEvent=function(E,z){this._map.fire(new e.Event(E,z?{originalEvent:z}:{}))},Ii.prototype._triggerRenderFrame=function(){var E=this;this._frameId===void 0&&(this._frameId=this._map._requestRenderFrame(function(z){delete E._frameId,E.handleEvent(new es("renderFrame",{timeStamp:z})),E._applyChanges()}))};var Bs=function(E){function z(R,U){E.call(this),this._moving=!1,this._zooming=!1,this.transform=R,this._bearingSnap=U.bearingSnap,e.bindAll(["_renderFrameCallback"],this)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.getCenter=function(){return new e.LngLat(this.transform.center.lng,this.transform.center.lat)},z.prototype.setCenter=function(R,U){return this.jumpTo({center:R},U)},z.prototype.panBy=function(R,U,ne){return R=e.Point.convert(R).mult(-1),this.panTo(this.transform.center,e.extend({offset:R},U),ne)},z.prototype.panTo=function(R,U,ne){return this.easeTo(e.extend({center:R},U),ne)},z.prototype.getZoom=function(){return this.transform.zoom},z.prototype.setZoom=function(R,U){return this.jumpTo({zoom:R},U),this},z.prototype.zoomTo=function(R,U,ne){return this.easeTo(e.extend({zoom:R},U),ne)},z.prototype.zoomIn=function(R,U){return this.zoomTo(this.getZoom()+1,R,U),this},z.prototype.zoomOut=function(R,U){return this.zoomTo(this.getZoom()-1,R,U),this},z.prototype.getBearing=function(){return this.transform.bearing},z.prototype.setBearing=function(R,U){return this.jumpTo({bearing:R},U),this},z.prototype.getPadding=function(){return this.transform.padding},z.prototype.setPadding=function(R,U){return this.jumpTo({padding:R},U),this},z.prototype.rotateTo=function(R,U,ne){return this.easeTo(e.extend({bearing:R},U),ne)},z.prototype.resetNorth=function(R,U){return this.rotateTo(0,e.extend({duration:1e3},R),U),this},z.prototype.resetNorthPitch=function(R,U){return this.easeTo(e.extend({bearing:0,pitch:0,duration:1e3},R),U),this},z.prototype.snapToNorth=function(R,U){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(R,U):this},z.prototype.getPitch=function(){return this.transform.pitch},z.prototype.setPitch=function(R,U){return this.jumpTo({pitch:R},U),this},z.prototype.cameraForBounds=function(R,U){return R=e.LngLatBounds.convert(R),this._cameraForBoxAndBearing(R.getNorthWest(),R.getSouthEast(),0,U)},z.prototype._cameraForBoxAndBearing=function(R,U,ne,le){var pe={top:0,bottom:0,right:0,left:0};if(typeof(le=e.extend({padding:pe,offset:[0,0],maxZoom:this.transform.maxZoom},le)).padding=="number"){var ye=le.padding;le.padding={top:ye,bottom:ye,right:ye,left:ye}}le.padding=e.extend(pe,le.padding);var Te=this.transform,Ne=Te.padding,qe=Te.project(e.LngLat.convert(R)),tt=Te.project(e.LngLat.convert(U)),yt=qe.rotate(-ne*Math.PI/180),St=tt.rotate(-ne*Math.PI/180),_t=new e.Point(Math.max(yt.x,St.x),Math.max(yt.y,St.y)),Tt=new e.Point(Math.min(yt.x,St.x),Math.min(yt.y,St.y)),gt=_t.sub(Tt),Dt=(Te.width-(Ne.left+Ne.right+le.padding.left+le.padding.right))/gt.x,Ot=(Te.height-(Ne.top+Ne.bottom+le.padding.top+le.padding.bottom))/gt.y;if(!(Ot<0||Dt<0)){var Bt=Math.min(Te.scaleZoom(Te.scale*Math.min(Dt,Ot)),le.maxZoom),er=e.Point.convert(le.offset),ur=(le.padding.left-le.padding.right)/2,Tr=(le.padding.top-le.padding.bottom)/2,wr=new e.Point(er.x+ur,er.y+Tr).mult(Te.scale/Te.zoomScale(Bt));return{center:Te.unproject(qe.add(tt).div(2).sub(wr)),zoom:Bt,bearing:ne}}e.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},z.prototype.fitBounds=function(R,U,ne){return this._fitInternal(this.cameraForBounds(R,U),U,ne)},z.prototype.fitScreenCoordinates=function(R,U,ne,le,pe){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(e.Point.convert(R)),this.transform.pointLocation(e.Point.convert(U)),ne,le),le,pe)},z.prototype._fitInternal=function(R,U,ne){return R?(delete(U=e.extend(R,U)).padding,U.linear?this.easeTo(U,ne):this.flyTo(U,ne)):this},z.prototype.jumpTo=function(R,U){this.stop();var ne=this.transform,le=!1,pe=!1,ye=!1;return"zoom"in R&&ne.zoom!==+R.zoom&&(le=!0,ne.zoom=+R.zoom),R.center!==void 0&&(ne.center=e.LngLat.convert(R.center)),"bearing"in R&&ne.bearing!==+R.bearing&&(pe=!0,ne.bearing=+R.bearing),"pitch"in R&&ne.pitch!==+R.pitch&&(ye=!0,ne.pitch=+R.pitch),R.padding==null||ne.isPaddingEqual(R.padding)||(ne.padding=R.padding),this.fire(new e.Event("movestart",U)).fire(new e.Event("move",U)),le&&this.fire(new e.Event("zoomstart",U)).fire(new e.Event("zoom",U)).fire(new e.Event("zoomend",U)),pe&&this.fire(new e.Event("rotatestart",U)).fire(new e.Event("rotate",U)).fire(new e.Event("rotateend",U)),ye&&this.fire(new e.Event("pitchstart",U)).fire(new e.Event("pitch",U)).fire(new e.Event("pitchend",U)),this.fire(new e.Event("moveend",U))},z.prototype.easeTo=function(R,U){var ne=this;this._stop(!1,R.easeId),((R=e.extend({offset:[0,0],duration:500,easing:e.ease},R)).animate===!1||!R.essential&&e.browser.prefersReducedMotion)&&(R.duration=0);var le=this.transform,pe=this.getZoom(),ye=this.getBearing(),Te=this.getPitch(),Ne=this.getPadding(),qe="zoom"in R?+R.zoom:pe,tt="bearing"in R?this._normalizeBearing(R.bearing,ye):ye,yt="pitch"in R?+R.pitch:Te,St="padding"in R?R.padding:le.padding,_t=e.Point.convert(R.offset),Tt=le.centerPoint.add(_t),gt=le.pointLocation(Tt),Dt=e.LngLat.convert(R.center||gt);this._normalizeCenter(Dt);var Ot,Bt,er=le.project(gt),ur=le.project(Dt).sub(er),Tr=le.zoomScale(qe-pe);R.around&&(Ot=e.LngLat.convert(R.around),Bt=le.locationPoint(Ot));var wr={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||qe!==pe,this._rotating=this._rotating||ye!==tt,this._pitching=this._pitching||yt!==Te,this._padding=!le.isPaddingEqual(St),this._easeId=R.easeId,this._prepareEase(U,R.noMoveStart,wr),clearTimeout(this._easeEndTimeoutID),this._ease(function(Xr){if(ne._zooming&&(le.zoom=e.number(pe,qe,Xr)),ne._rotating&&(le.bearing=e.number(ye,tt,Xr)),ne._pitching&&(le.pitch=e.number(Te,yt,Xr)),ne._padding&&(le.interpolatePadding(Ne,St,Xr),Tt=le.centerPoint.add(_t)),Ot)le.setLocationAtPoint(Ot,Bt);else{var Wr=le.zoomScale(le.zoom-pe),un=qe>pe?Math.min(2,Tr):Math.max(.5,Tr),an=Math.pow(un,1-Xr),Nn=le.unproject(er.add(ur.mult(Xr*an)).mult(Wr));le.setLocationAtPoint(le.renderWorldCopies?Nn.wrap():Nn,Tt)}ne._fireMoveEvents(U)},function(Xr){ne._afterEase(U,Xr)},R),this},z.prototype._prepareEase=function(R,U,ne){ne===void 0&&(ne={}),this._moving=!0,U||ne.moving||this.fire(new e.Event("movestart",R)),this._zooming&&!ne.zooming&&this.fire(new e.Event("zoomstart",R)),this._rotating&&!ne.rotating&&this.fire(new e.Event("rotatestart",R)),this._pitching&&!ne.pitching&&this.fire(new e.Event("pitchstart",R))},z.prototype._fireMoveEvents=function(R){this.fire(new e.Event("move",R)),this._zooming&&this.fire(new e.Event("zoom",R)),this._rotating&&this.fire(new e.Event("rotate",R)),this._pitching&&this.fire(new e.Event("pitch",R))},z.prototype._afterEase=function(R,U){if(!this._easeId||!U||this._easeId!==U){delete this._easeId;var ne=this._zooming,le=this._rotating,pe=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,ne&&this.fire(new e.Event("zoomend",R)),le&&this.fire(new e.Event("rotateend",R)),pe&&this.fire(new e.Event("pitchend",R)),this.fire(new e.Event("moveend",R))}},z.prototype.flyTo=function(R,U){var ne=this;if(!R.essential&&e.browser.prefersReducedMotion){var le=e.pick(R,["center","zoom","bearing","pitch","around"]);return this.jumpTo(le,U)}this.stop(),R=e.extend({offset:[0,0],speed:1.2,curve:1.42,easing:e.ease},R);var pe=this.transform,ye=this.getZoom(),Te=this.getBearing(),Ne=this.getPitch(),qe=this.getPadding(),tt="zoom"in R?e.clamp(+R.zoom,pe.minZoom,pe.maxZoom):ye,yt="bearing"in R?this._normalizeBearing(R.bearing,Te):Te,St="pitch"in R?+R.pitch:Ne,_t="padding"in R?R.padding:pe.padding,Tt=pe.zoomScale(tt-ye),gt=e.Point.convert(R.offset),Dt=pe.centerPoint.add(gt),Ot=pe.pointLocation(Dt),Bt=e.LngLat.convert(R.center||Ot);this._normalizeCenter(Bt);var er=pe.project(Ot),ur=pe.project(Bt).sub(er),Tr=R.curve,wr=Math.max(pe.width,pe.height),Xr=wr/Tt,Wr=ur.mag();if("minZoom"in R){var un=e.clamp(Math.min(R.minZoom,ye,tt),pe.minZoom,pe.maxZoom),an=wr/pe.zoomScale(un-ye);Tr=Math.sqrt(an/Wr*2)}var Nn=Tr*Tr;function Yn(Zn){var va=(Xr*Xr-wr*wr+(Zn?-1:1)*Nn*Nn*Wr*Wr)/(2*(Zn?Xr:wr)*Nn*Wr);return Math.log(Math.sqrt(va*va+1)-va)}function sa(Zn){return(Math.exp(Zn)-Math.exp(-Zn))/2}function Nr(Zn){return(Math.exp(Zn)+Math.exp(-Zn))/2}var wn=Yn(0),Wn=function(Zn){return Nr(wn)/Nr(wn+Tr*Zn)},Vn=function(Zn){return wr*((Nr(wn)*(sa(va=wn+Tr*Zn)/Nr(va))-sa(wn))/Nn)/Wr;var va},$n=(Yn(1)-wn)/Tr;if(Math.abs(Wr)<1e-6||!isFinite($n)){if(Math.abs(wr-Xr)<1e-6)return this.easeTo(R,U);var ca=Xr<wr?-1:1;$n=Math.abs(Math.log(Xr/wr))/Tr,Vn=function(){return 0},Wn=function(Zn){return Math.exp(ca*Tr*Zn)}}if("duration"in R)R.duration=+R.duration;else{var Ta="screenSpeed"in R?+R.screenSpeed/Tr:+R.speed;R.duration=1e3*$n/Ta}return R.maxDuration&&R.duration>R.maxDuration&&(R.duration=0),this._zooming=!0,this._rotating=Te!==yt,this._pitching=St!==Ne,this._padding=!pe.isPaddingEqual(_t),this._prepareEase(U,!1),this._ease(function(Zn){var va=Zn*$n,da=1/Wn(va);pe.zoom=Zn===1?tt:ye+pe.scaleZoom(da),ne._rotating&&(pe.bearing=e.number(Te,yt,Zn)),ne._pitching&&(pe.pitch=e.number(Ne,St,Zn)),ne._padding&&(pe.interpolatePadding(qe,_t,Zn),Dt=pe.centerPoint.add(gt));var Sa=Zn===1?Bt:pe.unproject(er.add(ur.mult(Vn(va))).mult(da));pe.setLocationAtPoint(pe.renderWorldCopies?Sa.wrap():Sa,Dt),ne._fireMoveEvents(U)},function(){return ne._afterEase(U)},R),this},z.prototype.isEasing=function(){return!!this._easeFrameId},z.prototype.stop=function(){return this._stop()},z.prototype._stop=function(R,U){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var ne=this._onEaseEnd;delete this._onEaseEnd,ne.call(this,U)}if(!R){var le=this.handlers;le&&le.stop()}return this},z.prototype._ease=function(R,U,ne){ne.animate===!1||ne.duration===0?(R(1),U()):(this._easeStart=e.browser.now(),this._easeOptions=ne,this._onEaseFrame=R,this._onEaseEnd=U,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},z.prototype._renderFrameCallback=function(){var R=Math.min((e.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(R)),R<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},z.prototype._normalizeBearing=function(R,U){R=e.wrap(R,-180,180);var ne=Math.abs(R-U);return Math.abs(R-360-U)<ne&&(R-=360),Math.abs(R+360-U)<ne&&(R+=360),R},z.prototype._normalizeCenter=function(R){var U=this.transform;if(U.renderWorldCopies&&!U.lngRange){var ne=R.lng-U.center.lng;R.lng+=ne>180?-360:ne<-180?360:0}},z}(e.Evented),Oi=function(E){E===void 0&&(E={}),this.options=E,e.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};Oi.prototype.getDefaultPosition=function(){return"bottom-right"},Oi.prototype.onAdd=function(E){var z=this.options&&this.options.compact;return this._map=E,this._container=u.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._innerContainer=u.create("div","mapboxgl-ctrl-attrib-inner",this._container),z&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),z===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Oi.prototype.onRemove=function(){u.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Oi.prototype._updateEditLink=function(){var E=this._editLink;E||(E=this._editLink=this._container.querySelector(".mapbox-improve-map"));var z=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||e.config.ACCESS_TOKEN}];if(E){var R=z.reduce(function(U,ne,le){return ne.value&&(U+=ne.key+"="+ne.value+(le<z.length-1?"&":"")),U},"?");E.href=e.config.FEEDBACK_URL+"/"+R+(this._map._hash?this._map._hash.getHashString(!0):""),E.rel="noopener nofollow"}},Oi.prototype._updateData=function(E){!E||E.sourceDataType!=="metadata"&&E.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},Oi.prototype._updateAttributions=function(){if(this._map.style){var E=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?E=E.concat(this.options.customAttribution.map(function(ye){return typeof ye!="string"?"":ye})):typeof this.options.customAttribution=="string"&&E.push(this.options.customAttribution)),this._map.style.stylesheet){var z=this._map.style.stylesheet;this.styleOwner=z.owner,this.styleId=z.id}var R=this._map.style.sourceCaches;for(var U in R){var ne=R[U];if(ne.used){var le=ne.getSource();le.attribution&&E.indexOf(le.attribution)<0&&E.push(le.attribution)}}E.sort(function(ye,Te){return ye.length-Te.length});var pe=(E=E.filter(function(ye,Te){for(var Ne=Te+1;Ne<E.length;Ne++)if(E[Ne].indexOf(ye)>=0)return!1;return!0})).join(" | ");pe!==this._attribHTML&&(this._attribHTML=pe,E.length?(this._innerContainer.innerHTML=pe,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Oi.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var ts=function(){e.bindAll(["_updateLogo"],this),e.bindAll(["_updateCompact"],this)};ts.prototype.onAdd=function(E){this._map=E,this._container=u.create("div","mapboxgl-ctrl");var z=u.create("a","mapboxgl-ctrl-logo");return z.target="_blank",z.rel="noopener nofollow",z.href="https://www.mapbox.com/",z.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),z.setAttribute("rel","noopener nofollow"),this._container.appendChild(z),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},ts.prototype.onRemove=function(){u.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},ts.prototype.getDefaultPosition=function(){return"bottom-left"},ts.prototype._updateLogo=function(E){E&&E.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},ts.prototype._logoRequired=function(){if(this._map.style){var E=this._map.style.sourceCaches;for(var z in E)if(E[z].getSource().mapbox_logo)return!0;return!1}},ts.prototype._updateCompact=function(){var E=this._container.children;if(E.length){var z=E[0];this._map.getCanvasContainer().offsetWidth<250?z.classList.add("mapboxgl-compact"):z.classList.remove("mapboxgl-compact")}};var oa=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};oa.prototype.add=function(E){var z=++this._id;return this._queue.push({callback:E,id:z,cancelled:!1}),z},oa.prototype.remove=function(E){for(var z=this._currentlyRunning,R=0,U=z?this._queue.concat(z):this._queue;R<U.length;R+=1){var ne=U[R];if(ne.id===E)return void(ne.cancelled=!0)}},oa.prototype.run=function(E){E===void 0&&(E=0);var z=this._currentlyRunning=this._queue;this._queue=[];for(var R=0,U=z;R<U.length;R+=1){var ne=U[R];if(!ne.cancelled&&(ne.callback(E),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},oa.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var ga={"FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Ns=e.window.HTMLImageElement,js=e.window.HTMLElement,rs=e.window.ImageBitmap,Eo={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},qo=function(E){function z(U){var ne=this;if((U=e.extend({},Eo,U)).minZoom!=null&&U.maxZoom!=null&&U.minZoom>U.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(U.minPitch!=null&&U.maxPitch!=null&&U.minPitch>U.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(U.minPitch!=null&&U.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(U.maxPitch!=null&&U.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var le=new jt(U.minZoom,U.maxZoom,U.minPitch,U.maxPitch,U.renderWorldCopies);if(E.call(this,le,U),this._interactive=U.interactive,this._maxTileCacheSize=U.maxTileCacheSize,this._failIfMajorPerformanceCaveat=U.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=U.preserveDrawingBuffer,this._antialias=U.antialias,this._trackResize=U.trackResize,this._bearingSnap=U.bearingSnap,this._refreshExpiredTiles=U.refreshExpiredTiles,this._fadeDuration=U.fadeDuration,this._crossSourceCollisions=U.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=U.collectResourceTiming,this._renderTaskQueue=new oa,this._controls=[],this._mapId=e.uniqueId(),this._locale=e.extend({},ga,U.locale),this._requestManager=new e.RequestManager(U.transformRequest,U.accessToken),typeof U.container=="string"){if(this._container=e.window.document.getElementById(U.container),!this._container)throw new Error("Container '"+U.container+"' not found.")}else{if(!(U.container instanceof js))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=U.container}if(U.maxBounds&&this.setMaxBounds(U.maxBounds),e.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return ne._update(!1)}),this.on("moveend",function(){return ne._update(!1)}),this.on("zoom",function(){return ne._update(!0)}),e.window!==void 0&&(e.window.addEventListener("online",this._onWindowOnline,!1),e.window.addEventListener("resize",this._onWindowResize,!1)),this.handlers=new Ii(this,U);var pe=typeof U.hash=="string"&&U.hash||void 0;this._hash=U.hash&&new Er(pe).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:U.center,zoom:U.zoom,bearing:U.bearing,pitch:U.pitch}),U.bounds&&(this.resize(),this.fitBounds(U.bounds,e.extend({},U.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=U.localIdeographFontFamily,U.style&&this.setStyle(U.style,{localIdeographFontFamily:U.localIdeographFontFamily}),U.attributionControl&&this.addControl(new Oi({customAttribution:U.customAttribution})),this.addControl(new ts,U.logoPosition),this.on("style.load",function(){ne.transform.unmodified&&ne.jumpTo(ne.style.stylesheet)}),this.on("data",function(ye){ne._update(ye.dataType==="style"),ne.fire(new e.Event(ye.dataType+"data",ye))}),this.on("dataloading",function(ye){ne.fire(new e.Event(ye.dataType+"dataloading",ye))})}E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z;var R={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return z.prototype._getMapId=function(){return this._mapId},z.prototype.addControl=function(U,ne){if(ne===void 0&&U.getDefaultPosition&&(ne=U.getDefaultPosition()),ne===void 0&&(ne="top-right"),!U||!U.onAdd)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var le=U.onAdd(this);this._controls.push(U);var pe=this._controlPositions[ne];return ne.indexOf("bottom")!==-1?pe.insertBefore(le,pe.firstChild):pe.appendChild(le),this},z.prototype.removeControl=function(U){if(!U||!U.onRemove)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var ne=this._controls.indexOf(U);return ne>-1&&this._controls.splice(ne,1),U.onRemove(this),this},z.prototype.resize=function(U){var ne=this._containerDimensions(),le=ne[0],pe=ne[1];this._resizeCanvas(le,pe),this.transform.resize(le,pe),this.painter.resize(le,pe);var ye=!this._moving;return ye&&(this.stop(),this.fire(new e.Event("movestart",U)).fire(new e.Event("move",U))),this.fire(new e.Event("resize",U)),ye&&this.fire(new e.Event("moveend",U)),this},z.prototype.getBounds=function(){return this.transform.getBounds()},z.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},z.prototype.setMaxBounds=function(U){return this.transform.setMaxBounds(e.LngLatBounds.convert(U)),this._update()},z.prototype.setMinZoom=function(U){if((U=U==null?-2:U)>=-2&&U<=this.transform.maxZoom)return this.transform.minZoom=U,this._update(),this.getZoom()<U&&this.setZoom(U),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},z.prototype.getMinZoom=function(){return this.transform.minZoom},z.prototype.setMaxZoom=function(U){if((U=U==null?22:U)>=this.transform.minZoom)return this.transform.maxZoom=U,this._update(),this.getZoom()>U&&this.setZoom(U),this;throw new Error("maxZoom must be greater than the current minZoom")},z.prototype.getMaxZoom=function(){return this.transform.maxZoom},z.prototype.setMinPitch=function(U){if((U=U==null?0:U)<0)throw new Error("minPitch must be greater than or equal to 0");if(U>=0&&U<=this.transform.maxPitch)return this.transform.minPitch=U,this._update(),this.getPitch()<U&&this.setPitch(U),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},z.prototype.getMinPitch=function(){return this.transform.minPitch},z.prototype.setMaxPitch=function(U){if((U=U==null?60:U)>60)throw new Error("maxPitch must be less than or equal to 60");if(U>=this.transform.minPitch)return this.transform.maxPitch=U,this._update(),this.getPitch()>U&&this.setPitch(U),this;throw new Error("maxPitch must be greater than the current minPitch")},z.prototype.getMaxPitch=function(){return this.transform.maxPitch},z.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},z.prototype.setRenderWorldCopies=function(U){return this.transform.renderWorldCopies=U,this._update()},z.prototype.project=function(U){return this.transform.locationPoint(e.LngLat.convert(U))},z.prototype.unproject=function(U){return this.transform.pointLocation(e.Point.convert(U))},z.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},z.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},z.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},z.prototype._createDelegatedListener=function(U,ne,le){var pe,ye=this;if(U==="mouseenter"||U==="mouseover"){var Te=!1;return{layer:ne,listener:le,delegates:{mousemove:function(qe){var tt=ye.getLayer(ne)?ye.queryRenderedFeatures(qe.point,{layers:[ne]}):[];tt.length?Te||(Te=!0,le.call(ye,new zn(U,ye,qe.originalEvent,{features:tt}))):Te=!1},mouseout:function(){Te=!1}}}}if(U==="mouseleave"||U==="mouseout"){var Ne=!1;return{layer:ne,listener:le,delegates:{mousemove:function(qe){(ye.getLayer(ne)?ye.queryRenderedFeatures(qe.point,{layers:[ne]}):[]).length?Ne=!0:Ne&&(Ne=!1,le.call(ye,new zn(U,ye,qe.originalEvent)))},mouseout:function(qe){Ne&&(Ne=!1,le.call(ye,new zn(U,ye,qe.originalEvent)))}}}}return{layer:ne,listener:le,delegates:(pe={},pe[U]=function(qe){var tt=ye.getLayer(ne)?ye.queryRenderedFeatures(qe.point,{layers:[ne]}):[];tt.length&&(qe.features=tt,le.call(ye,qe),delete qe.features)},pe)}},z.prototype.on=function(U,ne,le){if(le===void 0)return E.prototype.on.call(this,U,ne);var pe=this._createDelegatedListener(U,ne,le);for(var ye in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[U]=this._delegatedListeners[U]||[],this._delegatedListeners[U].push(pe),pe.delegates)this.on(ye,pe.delegates[ye]);return this},z.prototype.once=function(U,ne,le){if(le===void 0)return E.prototype.once.call(this,U,ne);var pe=this._createDelegatedListener(U,ne,le);for(var ye in pe.delegates)this.once(ye,pe.delegates[ye]);return this},z.prototype.off=function(U,ne,le){var pe=this;return le===void 0?E.prototype.off.call(this,U,ne):(this._delegatedListeners&&this._delegatedListeners[U]&&function(ye){for(var Te=ye[U],Ne=0;Ne<Te.length;Ne++){var qe=Te[Ne];if(qe.layer===ne&&qe.listener===le){for(var tt in qe.delegates)pe.off(tt,qe.delegates[tt]);return Te.splice(Ne,1),pe}}}(this._delegatedListeners),this)},z.prototype.queryRenderedFeatures=function(U,ne){if(!this.style)return[];var le;if(ne!==void 0||U===void 0||U instanceof e.Point||Array.isArray(U)||(ne=U,U=void 0),ne=ne||{},(U=U||[[0,0],[this.transform.width,this.transform.height]])instanceof e.Point||typeof U[0]=="number")le=[e.Point.convert(U)];else{var pe=e.Point.convert(U[0]),ye=e.Point.convert(U[1]);le=[pe,new e.Point(ye.x,pe.y),ye,new e.Point(pe.x,ye.y),pe]}return this.style.queryRenderedFeatures(le,ne,this.transform)},z.prototype.querySourceFeatures=function(U,ne){return this.style.querySourceFeatures(U,ne)},z.prototype.setStyle=function(U,ne){return(ne=e.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},ne)).diff!==!1&&ne.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&U?(this._diffStyle(U,ne),this):(this._localIdeographFontFamily=ne.localIdeographFontFamily,this._updateStyle(U,ne))},z.prototype._getUIString=function(U){var ne=this._locale[U];if(ne==null)throw new Error("Missing UI string '"+U+"'");return ne},z.prototype._updateStyle=function(U,ne){return this.style&&(this.style.setEventedParent(null),this.style._remove()),U?(this.style=new qn(this,ne||{}),this.style.setEventedParent(this,{style:this.style}),typeof U=="string"?this.style.loadURL(U):this.style.loadJSON(U),this):(delete this.style,this)},z.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new qn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},z.prototype._diffStyle=function(U,ne){var le=this;if(typeof U=="string"){var pe=this._requestManager.normalizeStyleURL(U),ye=this._requestManager.transformRequest(pe,e.ResourceType.Style);e.getJSON(ye,function(Te,Ne){Te?le.fire(new e.ErrorEvent(Te)):Ne&&le._updateDiff(Ne,ne)})}else typeof U=="object"&&this._updateDiff(U,ne)},z.prototype._updateDiff=function(U,ne){try{this.style.setState(U)&&this._update(!0)}catch(le){e.warnOnce("Unable to perform style diff: "+(le.message||le.error||le)+".  Rebuilding the style from scratch."),this._updateStyle(U,ne)}},z.prototype.getStyle=function(){if(this.style)return this.style.serialize()},z.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():e.warnOnce("There is no style added to the map.")},z.prototype.addSource=function(U,ne){return this._lazyInitEmptyStyle(),this.style.addSource(U,ne),this._update(!0)},z.prototype.isSourceLoaded=function(U){var ne=this.style&&this.style.sourceCaches[U];if(ne!==void 0)return ne.loaded();this.fire(new e.ErrorEvent(new Error("There is no source with ID '"+U+"'")))},z.prototype.areTilesLoaded=function(){var U=this.style&&this.style.sourceCaches;for(var ne in U){var le=U[ne]._tiles;for(var pe in le){var ye=le[pe];if(ye.state!=="loaded"&&ye.state!=="errored")return!1}}return!0},z.prototype.addSourceType=function(U,ne,le){return this._lazyInitEmptyStyle(),this.style.addSourceType(U,ne,le)},z.prototype.removeSource=function(U){return this.style.removeSource(U),this._update(!0)},z.prototype.getSource=function(U){return this.style.getSource(U)},z.prototype.addImage=function(U,ne,le){le===void 0&&(le={});var pe=le.pixelRatio;pe===void 0&&(pe=1);var ye=le.sdf;ye===void 0&&(ye=!1);var Te=le.stretchX,Ne=le.stretchY,qe=le.content;if(this._lazyInitEmptyStyle(),ne instanceof Ns||rs&&ne instanceof rs){var tt=e.browser.getImageData(ne),yt=tt.width,St=tt.height,_t=tt.data;this.style.addImage(U,{data:new e.RGBAImage({width:yt,height:St},_t),pixelRatio:pe,stretchX:Te,stretchY:Ne,content:qe,sdf:ye,version:0})}else{if(ne.width===void 0||ne.height===void 0)return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var Tt=ne.width,gt=ne.height,Dt=ne.data,Ot=ne;this.style.addImage(U,{data:new e.RGBAImage({width:Tt,height:gt},new Uint8Array(Dt)),pixelRatio:pe,stretchX:Te,stretchY:Ne,content:qe,sdf:ye,version:0,userImage:Ot}),Ot.onAdd&&Ot.onAdd(this,U)}},z.prototype.updateImage=function(U,ne){var le=this.style.getImage(U);if(!le)return this.fire(new e.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var pe=ne instanceof Ns||rs&&ne instanceof rs?e.browser.getImageData(ne):ne,ye=pe.width,Te=pe.height,Ne=pe.data;if(ye===void 0||Te===void 0)return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(ye!==le.data.width||Te!==le.data.height)return this.fire(new e.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));var qe=!(ne instanceof Ns||rs&&ne instanceof rs);le.data.replace(Ne,qe),this.style.updateImage(U,le)},z.prototype.hasImage=function(U){return U?!!this.style.getImage(U):(this.fire(new e.ErrorEvent(new Error("Missing required image id"))),!1)},z.prototype.removeImage=function(U){this.style.removeImage(U)},z.prototype.loadImage=function(U,ne){e.getImage(this._requestManager.transformRequest(U,e.ResourceType.Image),ne)},z.prototype.listImages=function(){return this.style.listImages()},z.prototype.addLayer=function(U,ne){return this._lazyInitEmptyStyle(),this.style.addLayer(U,ne),this._update(!0)},z.prototype.moveLayer=function(U,ne){return this.style.moveLayer(U,ne),this._update(!0)},z.prototype.removeLayer=function(U){return this.style.removeLayer(U),this._update(!0)},z.prototype.getLayer=function(U){return this.style.getLayer(U)},z.prototype.setLayerZoomRange=function(U,ne,le){return this.style.setLayerZoomRange(U,ne,le),this._update(!0)},z.prototype.setFilter=function(U,ne,le){return le===void 0&&(le={}),this.style.setFilter(U,ne,le),this._update(!0)},z.prototype.getFilter=function(U){return this.style.getFilter(U)},z.prototype.setPaintProperty=function(U,ne,le,pe){return pe===void 0&&(pe={}),this.style.setPaintProperty(U,ne,le,pe),this._update(!0)},z.prototype.getPaintProperty=function(U,ne){return this.style.getPaintProperty(U,ne)},z.prototype.setLayoutProperty=function(U,ne,le,pe){return pe===void 0&&(pe={}),this.style.setLayoutProperty(U,ne,le,pe),this._update(!0)},z.prototype.getLayoutProperty=function(U,ne){return this.style.getLayoutProperty(U,ne)},z.prototype.setLight=function(U,ne){return ne===void 0&&(ne={}),this._lazyInitEmptyStyle(),this.style.setLight(U,ne),this._update(!0)},z.prototype.getLight=function(){return this.style.getLight()},z.prototype.setFeatureState=function(U,ne){return this.style.setFeatureState(U,ne),this._update()},z.prototype.removeFeatureState=function(U,ne){return this.style.removeFeatureState(U,ne),this._update()},z.prototype.getFeatureState=function(U){return this.style.getFeatureState(U)},z.prototype.getContainer=function(){return this._container},z.prototype.getCanvasContainer=function(){return this._canvasContainer},z.prototype.getCanvas=function(){return this._canvas},z.prototype._containerDimensions=function(){var U=0,ne=0;return this._container&&(U=this._container.clientWidth||400,ne=this._container.clientHeight||300),[U,ne]},z.prototype._detectMissingCSS=function(){e.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&e.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},z.prototype._setupContainer=function(){var U=this._container;U.classList.add("mapboxgl-map"),(this._missingCSSCanary=u.create("div","mapboxgl-canary",U)).style.visibility="hidden",this._detectMissingCSS();var ne=this._canvasContainer=u.create("div","mapboxgl-canvas-container",U);this._interactive&&ne.classList.add("mapboxgl-interactive"),this._canvas=u.create("canvas","mapboxgl-canvas",ne),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var le=this._containerDimensions();this._resizeCanvas(le[0],le[1]);var pe=this._controlContainer=u.create("div","mapboxgl-control-container",U),ye=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(Te){ye[Te]=u.create("div","mapboxgl-ctrl-"+Te,pe)})},z.prototype._resizeCanvas=function(U,ne){var le=e.browser.devicePixelRatio||1;this._canvas.width=le*U,this._canvas.height=le*ne,this._canvas.style.width=U+"px",this._canvas.style.height=ne+"px"},z.prototype._setupPainter=function(){var U=e.extend({},f.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),ne=this._canvas.getContext("webgl",U)||this._canvas.getContext("experimental-webgl",U);ne?(this.painter=new Pa(ne,this.transform),e.webpSupported.testSupport(ne)):this.fire(new e.ErrorEvent(new Error("Failed to initialize WebGL")))},z.prototype._contextLost=function(U){U.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new e.Event("webglcontextlost",{originalEvent:U}))},z.prototype._contextRestored=function(U){this._setupPainter(),this.resize(),this._update(),this.fire(new e.Event("webglcontextrestored",{originalEvent:U}))},z.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},z.prototype._update=function(U){return this.style?(this._styleDirty=this._styleDirty||U,this._sourcesDirty=!0,this.triggerRepaint(),this):this},z.prototype._requestRenderFrame=function(U){return this._update(),this._renderTaskQueue.add(U)},z.prototype._cancelRenderFrame=function(U){this._renderTaskQueue.remove(U)},z.prototype._render=function(U){var ne,le=this,pe=0,ye=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(ne=ye.createQueryEXT(),ye.beginQueryEXT(ye.TIME_ELAPSED_EXT,ne),pe=e.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(U),!this._removed){var Te=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var Ne=this.transform.zoom,qe=e.browser.now();this.style.zoomHistory.update(Ne,qe);var tt=new e.EvaluationParameters(Ne,{now:qe,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),yt=tt.crossFadingFactor();yt===1&&yt===this._crossFadingFactor||(Te=!0,this._crossFadingFactor=yt),this.style.update(tt)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new e.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new e.Event("load"))),this.style&&(this.style.hasTransitions()||Te)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var St=e.browser.now()-pe;ye.endQueryEXT(ye.TIME_ELAPSED_EXT,ne),setTimeout(function(){var Tt=ye.getQueryObjectEXT(ne,ye.QUERY_RESULT_EXT)/1e6;ye.deleteQueryEXT(ne),le.fire(new e.Event("gpu-timing-frame",{cpuTime:St,gpuTime:Tt}))},50)}if(this.listens("gpu-timing-layer")){var _t=this.painter.collectGpuTimers();setTimeout(function(){var Tt=le.painter.queryGpuTimers(_t);le.fire(new e.Event("gpu-timing-layer",{layerTimes:Tt}))},50)}return this._sourcesDirty||this._styleDirty||this._placementDirty||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&(this._fullyLoaded||(this._fullyLoaded=!0),this.fire(new e.Event("idle"))),this}},z.prototype.remove=function(){this._hash&&this._hash.remove();for(var U=0,ne=this._controls;U<ne.length;U+=1)ne[U].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),e.window!==void 0&&(e.window.removeEventListener("resize",this._onWindowResize,!1),e.window.removeEventListener("online",this._onWindowOnline,!1));var le=this.painter.context.gl.getExtension("WEBGL_lose_context");le&&le.loseContext(),$s(this._canvasContainer),$s(this._controlContainer),$s(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new e.Event("remove"))},z.prototype.triggerRepaint=function(){var U=this;this.style&&!this._frame&&(this._frame=e.browser.frame(function(ne){U._frame=null,U._render(ne)}))},z.prototype._onWindowOnline=function(){this._update()},z.prototype._onWindowResize=function(U){this._trackResize&&this.resize({originalEvent:U})._update()},R.showTileBoundaries.get=function(){return!!this._showTileBoundaries},R.showTileBoundaries.set=function(U){this._showTileBoundaries!==U&&(this._showTileBoundaries=U,this._update())},R.showPadding.get=function(){return!!this._showPadding},R.showPadding.set=function(U){this._showPadding!==U&&(this._showPadding=U,this._update())},R.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},R.showCollisionBoxes.set=function(U){this._showCollisionBoxes!==U&&(this._showCollisionBoxes=U,U?this.style._generateCollisionBoxes():this._update())},R.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},R.showOverdrawInspector.set=function(U){this._showOverdrawInspector!==U&&(this._showOverdrawInspector=U,this._update())},R.repaint.get=function(){return!!this._repaint},R.repaint.set=function(U){this._repaint!==U&&(this._repaint=U,this.triggerRepaint())},R.vertices.get=function(){return!!this._vertices},R.vertices.set=function(U){this._vertices=U,this._update()},z.prototype._setCacheLimits=function(U,ne){e.setCacheLimits(U,ne)},R.version.get=function(){return e.version},Object.defineProperties(z.prototype,R),z}(Bs);function $s(E){E.parentNode&&E.parentNode.removeChild(E)}var Ms={showCompass:!0,showZoom:!0,visualizePitch:!1},Wa=function(E){var z=this;this.options=e.extend({},Ms,E),this._container=u.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(R){return R.preventDefault()}),this.options.showZoom&&(e.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(R){return z._map.zoomIn({},{originalEvent:R})}),u.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(R){return z._map.zoomOut({},{originalEvent:R})}),u.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(e.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(R){z.options.visualizePitch?z._map.resetNorthPitch({},{originalEvent:R}):z._map.resetNorth({},{originalEvent:R})}),this._compassIcon=u.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Wa.prototype._updateZoomButtons=function(){var E=this._map.getZoom();this._zoomInButton.disabled=E===this._map.getMaxZoom(),this._zoomOutButton.disabled=E===this._map.getMinZoom()},Wa.prototype._rotateCompassArrow=function(){var E=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=E},Wa.prototype.onAdd=function(E){return this._map=E,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new ti(this._map,this._compass,this.options.visualizePitch)),this._container},Wa.prototype.onRemove=function(){u.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Wa.prototype._createButton=function(E,z){var R=u.create("button",E,this._container);return R.type="button",R.addEventListener("click",z),R},Wa.prototype._setButtonTitle=function(E,z){var R=this._map._getUIString("NavigationControl."+z);E.title=R,E.setAttribute("aria-label",R)};var ti=function(E,z,R){R===void 0&&(R=!1),this._clickTolerance=10,this.element=z,this.mouseRotate=new ka({clickTolerance:E.dragRotate._mouseRotate._clickTolerance}),this.map=E,R&&(this.mousePitch=new ha({clickTolerance:E.dragRotate._mousePitch._clickTolerance})),e.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),u.addEventListener(z,"mousedown",this.mousedown),u.addEventListener(z,"touchstart",this.touchstart,{passive:!1}),u.addEventListener(z,"touchmove",this.touchmove),u.addEventListener(z,"touchend",this.touchend),u.addEventListener(z,"touchcancel",this.reset)};function ms(E,z,R){if(E=new e.LngLat(E.lng,E.lat),z){var U=new e.LngLat(E.lng-360,E.lat),ne=new e.LngLat(E.lng+360,E.lat),le=R.locationPoint(E).distSqr(z);R.locationPoint(U).distSqr(z)<le?E=U:R.locationPoint(ne).distSqr(z)<le&&(E=ne)}for(;Math.abs(E.lng-R.center.lng)>180;){var pe=R.locationPoint(E);if(pe.x>=0&&pe.y>=0&&pe.x<=R.width&&pe.y<=R.height)break;E.lng>R.center.lng?E.lng-=360:E.lng+=360}return E}ti.prototype.down=function(E,z){this.mouseRotate.mousedown(E,z),this.mousePitch&&this.mousePitch.mousedown(E,z),u.disableDrag()},ti.prototype.move=function(E,z){var R=this.map,U=this.mouseRotate.mousemoveWindow(E,z);if(U&&U.bearingDelta&&R.setBearing(R.getBearing()+U.bearingDelta),this.mousePitch){var ne=this.mousePitch.mousemoveWindow(E,z);ne&&ne.pitchDelta&&R.setPitch(R.getPitch()+ne.pitchDelta)}},ti.prototype.off=function(){var E=this.element;u.removeEventListener(E,"mousedown",this.mousedown),u.removeEventListener(E,"touchstart",this.touchstart,{passive:!1}),u.removeEventListener(E,"touchmove",this.touchmove),u.removeEventListener(E,"touchend",this.touchend),u.removeEventListener(E,"touchcancel",this.reset),this.offTemp()},ti.prototype.offTemp=function(){u.enableDrag(),u.removeEventListener(e.window,"mousemove",this.mousemove),u.removeEventListener(e.window,"mouseup",this.mouseup)},ti.prototype.mousedown=function(E){this.down(e.extend({},E,{ctrlKey:!0,preventDefault:function(){return E.preventDefault()}}),u.mousePos(this.element,E)),u.addEventListener(e.window,"mousemove",this.mousemove),u.addEventListener(e.window,"mouseup",this.mouseup)},ti.prototype.mousemove=function(E){this.move(E,u.mousePos(this.element,E))},ti.prototype.mouseup=function(E){this.mouseRotate.mouseupWindow(E),this.mousePitch&&this.mousePitch.mouseupWindow(E),this.offTemp()},ti.prototype.touchstart=function(E){E.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=u.touchPos(this.element,E.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return E.preventDefault()}},this._startPos))},ti.prototype.touchmove=function(E){E.targetTouches.length!==1?this.reset():(this._lastPos=u.touchPos(this.element,E.targetTouches)[0],this.move({preventDefault:function(){return E.preventDefault()}},this._lastPos))},ti.prototype.touchend=function(E){E.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},ti.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var ss={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Ei(E,z,R){var U=E.classList;for(var ne in ss)U.remove("mapboxgl-"+R+"-anchor-"+ne);U.add("mapboxgl-"+R+"-anchor-"+z)}var gs,Ss=function(E){function z(R,U){var ne=this;if(E.call(this),(R instanceof e.window.HTMLElement||U)&&(R=e.extend({element:R},U)),e.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=R&&R.anchor||"center",this._color=R&&R.color||"#3FB1CE",this._draggable=R&&R.draggable||!1,this._state="inactive",this._rotation=R&&R.rotation||0,this._rotationAlignment=R&&R.rotationAlignment||"auto",this._pitchAlignment=R&&R.pitchAlignment&&R.pitchAlignment!=="auto"?R.pitchAlignment:this._rotationAlignment,R&&R.element)this._element=R.element,this._offset=e.Point.convert(R&&R.offset||[0,0]);else{this._defaultMarker=!0,this._element=u.create("div"),this._element.setAttribute("aria-label","Map marker");var le=u.createNS("http://www.w3.org/2000/svg","svg");le.setAttributeNS(null,"display","block"),le.setAttributeNS(null,"height","41px"),le.setAttributeNS(null,"width","27px"),le.setAttributeNS(null,"viewBox","0 0 27 41");var pe=u.createNS("http://www.w3.org/2000/svg","g");pe.setAttributeNS(null,"stroke","none"),pe.setAttributeNS(null,"stroke-width","1"),pe.setAttributeNS(null,"fill","none"),pe.setAttributeNS(null,"fill-rule","evenodd");var ye=u.createNS("http://www.w3.org/2000/svg","g");ye.setAttributeNS(null,"fill-rule","nonzero");var Te=u.createNS("http://www.w3.org/2000/svg","g");Te.setAttributeNS(null,"transform","translate(3.0, 29.0)"),Te.setAttributeNS(null,"fill","#000000");for(var Ne=0,qe=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];Ne<qe.length;Ne+=1){var tt=qe[Ne],yt=u.createNS("http://www.w3.org/2000/svg","ellipse");yt.setAttributeNS(null,"opacity","0.04"),yt.setAttributeNS(null,"cx","10.5"),yt.setAttributeNS(null,"cy","5.80029008"),yt.setAttributeNS(null,"rx",tt.rx),yt.setAttributeNS(null,"ry",tt.ry),Te.appendChild(yt)}var St=u.createNS("http://www.w3.org/2000/svg","g");St.setAttributeNS(null,"fill",this._color);var _t=u.createNS("http://www.w3.org/2000/svg","path");_t.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),St.appendChild(_t);var Tt=u.createNS("http://www.w3.org/2000/svg","g");Tt.setAttributeNS(null,"opacity","0.25"),Tt.setAttributeNS(null,"fill","#000000");var gt=u.createNS("http://www.w3.org/2000/svg","path");gt.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Tt.appendChild(gt);var Dt=u.createNS("http://www.w3.org/2000/svg","g");Dt.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Dt.setAttributeNS(null,"fill","#FFFFFF");var Ot=u.createNS("http://www.w3.org/2000/svg","g");Ot.setAttributeNS(null,"transform","translate(8.0, 8.0)");var Bt=u.createNS("http://www.w3.org/2000/svg","circle");Bt.setAttributeNS(null,"fill","#000000"),Bt.setAttributeNS(null,"opacity","0.25"),Bt.setAttributeNS(null,"cx","5.5"),Bt.setAttributeNS(null,"cy","5.5"),Bt.setAttributeNS(null,"r","5.4999962");var er=u.createNS("http://www.w3.org/2000/svg","circle");er.setAttributeNS(null,"fill","#FFFFFF"),er.setAttributeNS(null,"cx","5.5"),er.setAttributeNS(null,"cy","5.5"),er.setAttributeNS(null,"r","5.4999962"),Ot.appendChild(Bt),Ot.appendChild(er),ye.appendChild(Te),ye.appendChild(St),ye.appendChild(Tt),ye.appendChild(Dt),ye.appendChild(Ot),le.appendChild(ye),this._element.appendChild(le),this._offset=e.Point.convert(R&&R.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(ur){ur.preventDefault()}),this._element.addEventListener("mousedown",function(ur){ur.preventDefault()}),this._element.addEventListener("focus",function(){var ur=ne._map.getContainer();ur.scrollTop=0,ur.scrollLeft=0}),Ei(this._element,this._anchor,"marker"),this._popup=null}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.addTo=function(R){return this.remove(),this._map=R,R.getCanvasContainer().appendChild(this._element),R.on("move",this._update),R.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},z.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),u.remove(this._element),this._popup&&this._popup.remove(),this},z.prototype.getLngLat=function(){return this._lngLat},z.prototype.setLngLat=function(R){return this._lngLat=e.LngLat.convert(R),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},z.prototype.getElement=function(){return this._element},z.prototype.setPopup=function(R){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),R){if(!("offset"in R.options)){var U=Math.sqrt(Math.pow(13.5,2)/2);R.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[U,-1*(24.6+U)],"bottom-right":[-U,-1*(24.6+U)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=R,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},z.prototype._onKeyPress=function(R){var U=R.code,ne=R.charCode||R.keyCode;U!=="Space"&&U!=="Enter"&&ne!==32&&ne!==13||this.togglePopup()},z.prototype._onMapClick=function(R){var U=R.originalEvent.target,ne=this._element;this._popup&&(U===ne||ne.contains(U))&&this.togglePopup()},z.prototype.getPopup=function(){return this._popup},z.prototype.togglePopup=function(){var R=this._popup;return R?(R.isOpen()?R.remove():R.addTo(this._map),this):this},z.prototype._update=function(R){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=ms(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var U="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?U="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(U="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var ne="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?ne="rotateX(0deg)":this._pitchAlignment==="map"&&(ne="rotateX("+this._map.getPitch()+"deg)"),R&&R.type!=="moveend"||(this._pos=this._pos.round()),u.setTransform(this._element,ss[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+ne+" "+U)}},z.prototype.getOffset=function(){return this._offset},z.prototype.setOffset=function(R){return this._offset=e.Point.convert(R),this._update(),this},z.prototype._onMove=function(R){this._pos=R.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new e.Event("dragstart"))),this.fire(new e.Event("drag"))},z.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new e.Event("dragend")),this._state="inactive"},z.prototype._addDragHandler=function(R){this._element.contains(R.originalEvent.target)&&(R.preventDefault(),this._positionDelta=R.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},z.prototype.setDraggable=function(R){return this._draggable=!!R,this._map&&(R?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},z.prototype.isDraggable=function(){return this._draggable},z.prototype.setRotation=function(R){return this._rotation=R||0,this._update(),this},z.prototype.getRotation=function(){return this._rotation},z.prototype.setRotationAlignment=function(R){return this._rotationAlignment=R||"auto",this._update(),this},z.prototype.getRotationAlignment=function(){return this._rotationAlignment},z.prototype.setPitchAlignment=function(R){return this._pitchAlignment=R&&R!=="auto"?R:this._rotationAlignment,this._update(),this},z.prototype.getPitchAlignment=function(){return this._pitchAlignment},z}(e.Evented),bs={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Es=0,ls=!1,el=function(E){function z(R){E.call(this),this.options=e.extend({},bs,R),e.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.onAdd=function(R){var U;return this._map=R,this._container=u.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),U=this._setupUI,gs!==void 0?U(gs):e.window.navigator.permissions!==void 0?e.window.navigator.permissions.query({name:"geolocation"}).then(function(ne){gs=ne.state!=="denied",U(gs)}):(gs=!!e.window.navigator.geolocation,U(gs)),this._container},z.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),u.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Es=0,ls=!1},z.prototype._isOutOfMapMaxBounds=function(R){var U=this._map.getMaxBounds(),ne=R.coords;return U&&(ne.longitude<U.getWest()||ne.longitude>U.getEast()||ne.latitude<U.getSouth()||ne.latitude>U.getNorth())},z.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},z.prototype._onSuccess=function(R){if(this._map){if(this._isOutOfMapMaxBounds(R))return this._setErrorState(),this.fire(new e.Event("outofmaxbounds",R)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=R,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(R),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(R),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("geolocate",R)),this._finish()}},z.prototype._updateCamera=function(R){var U=new e.LngLat(R.coords.longitude,R.coords.latitude),ne=R.coords.accuracy,le=this._map.getBearing(),pe=e.extend({bearing:le},this.options.fitBoundsOptions);this._map.fitBounds(U.toBounds(ne),pe,{geolocateSource:!0})},z.prototype._updateMarker=function(R){if(R){var U=new e.LngLat(R.coords.longitude,R.coords.latitude);this._accuracyCircleMarker.setLngLat(U).addTo(this._map),this._userLocationDotMarker.setLngLat(U).addTo(this._map),this._accuracy=R.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},z.prototype._updateCircleRadius=function(){var R=this._map._container.clientHeight/2,U=this._map.unproject([0,R]),ne=this._map.unproject([1,R]),le=U.distanceTo(ne),pe=Math.ceil(2*this._accuracy/le);this._circleElement.style.width=pe+"px",this._circleElement.style.height=pe+"px"},z.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},z.prototype._onError=function(R){if(this._map){if(this.options.trackUserLocation)if(R.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var U=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=U,this._geolocateButton.setAttribute("aria-label",U),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(R.code===3&&ls)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("error",R)),this._finish()}},z.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},z.prototype._setupUI=function(R){var U=this;if(this._container.addEventListener("contextmenu",function(pe){return pe.preventDefault()}),this._geolocateButton=u.create("button","mapboxgl-ctrl-geolocate",this._container),u.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",R===!1){e.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var ne=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=ne,this._geolocateButton.setAttribute("aria-label",ne)}else{var le=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=le,this._geolocateButton.setAttribute("aria-label",le)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=u.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Ss(this._dotElement),this._circleElement=u.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ss({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(pe){var ye=pe.originalEvent&&pe.originalEvent.type==="resize";pe.geolocateSource||U._watchState!=="ACTIVE_LOCK"||ye||(U._watchState="BACKGROUND",U._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),U._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),U.fire(new e.Event("trackuserlocationend")))})},z.prototype.trigger=function(){if(!this._setup)return e.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new e.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Es--,ls=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new e.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new e.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var R;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Es>1?(R={maximumAge:6e5,timeout:0},ls=!0):(R=this.options.positionOptions,ls=!1),this._geolocationWatchID=e.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,R)}}else e.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},z.prototype._clearWatch=function(){e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},z}(e.Evented),cl={maxWidth:100,unit:"metric"},vs=function(E){this.options=e.extend({},cl,E),e.bindAll(["_onMove","setUnit"],this)};function tl(E,z,R){var U=R&&R.maxWidth||100,ne=E._container.clientHeight/2,le=E.unproject([0,ne]),pe=E.unproject([U,ne]),ye=le.distanceTo(pe);if(R&&R.unit==="imperial"){var Te=3.2808*ye;Te>5280?Ls(z,U,Te/5280,E._getUIString("ScaleControl.Miles")):Ls(z,U,Te,E._getUIString("ScaleControl.Feet"))}else R&&R.unit==="nautical"?Ls(z,U,ye/1852,E._getUIString("ScaleControl.NauticalMiles")):ye>=1e3?Ls(z,U,ye/1e3,E._getUIString("ScaleControl.Kilometers")):Ls(z,U,ye,E._getUIString("ScaleControl.Meters"))}function Ls(E,z,R,U){var ne,le,pe,ye=(ne=R,le=Math.pow(10,(""+Math.floor(ne)).length-1),pe=(pe=ne/le)>=10?10:pe>=5?5:pe>=3?3:pe>=2?2:pe>=1?1:function(Ne){var qe=Math.pow(10,Math.ceil(-Math.log(Ne)/Math.LN10));return Math.round(Ne*qe)/qe}(pe),le*pe),Te=ye/R;E.style.width=z*Te+"px",E.innerHTML=ye+"&nbsp;"+U}vs.prototype.getDefaultPosition=function(){return"bottom-left"},vs.prototype._onMove=function(){tl(this._map,this._container,this.options)},vs.prototype.onAdd=function(E){return this._map=E,this._container=u.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",E.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},vs.prototype.onRemove=function(){u.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},vs.prototype.setUnit=function(E){this.options.unit=E,tl(this._map,this._container,this.options)};var eo=function(E){this._fullscreen=!1,E&&E.container&&(E.container instanceof e.window.HTMLElement?this._container=E.container:e.warnOnce("Full screen control 'container' must be a DOM element.")),e.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in e.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in e.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in e.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in e.window.document&&(this._fullscreenchange="MSFullscreenChange")};eo.prototype.onAdd=function(E){return this._map=E,this._container||(this._container=this._map.getContainer()),this._controlContainer=u.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",e.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},eo.prototype.onRemove=function(){u.remove(this._controlContainer),this._map=null,e.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},eo.prototype._checkFullscreenSupport=function(){return!!(e.window.document.fullscreenEnabled||e.window.document.mozFullScreenEnabled||e.window.document.msFullscreenEnabled||e.window.document.webkitFullscreenEnabled)},eo.prototype._setupUI=function(){var E=this._fullscreenButton=u.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);u.create("span","mapboxgl-ctrl-icon",E).setAttribute("aria-hidden",!0),E.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),e.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},eo.prototype._updateTitle=function(){var E=this._getTitle();this._fullscreenButton.setAttribute("aria-label",E),this._fullscreenButton.title=E},eo.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},eo.prototype._isFullscreen=function(){return this._fullscreen},eo.prototype._changeIcon=function(){(e.window.document.fullscreenElement||e.window.document.mozFullScreenElement||e.window.document.webkitFullscreenElement||e.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},eo.prototype._onClickFullscreen=function(){this._isFullscreen()?e.window.document.exitFullscreen?e.window.document.exitFullscreen():e.window.document.mozCancelFullScreen?e.window.document.mozCancelFullScreen():e.window.document.msExitFullscreen?e.window.document.msExitFullscreen():e.window.document.webkitCancelFullScreen&&e.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var ul={closeButton:!0,closeOnClick:!0,className:"",maxWidth:"240px"},fl=function(E){function z(R){E.call(this),this.options=e.extend(Object.create(ul),R),e.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return E&&(z.__proto__=E),z.prototype=Object.create(E&&E.prototype),z.prototype.constructor=z,z.prototype.addTo=function(R){return this._map&&this.remove(),this._map=R,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new e.Event("open")),this},z.prototype.isOpen=function(){return!!this._map},z.prototype.remove=function(){return this._content&&u.remove(this._content),this._container&&(u.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new e.Event("close")),this},z.prototype.getLngLat=function(){return this._lngLat},z.prototype.setLngLat=function(R){return this._lngLat=e.LngLat.convert(R),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},z.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},z.prototype.getElement=function(){return this._container},z.prototype.setText=function(R){return this.setDOMContent(e.window.document.createTextNode(R))},z.prototype.setHTML=function(R){var U,ne=e.window.document.createDocumentFragment(),le=e.window.document.createElement("body");for(le.innerHTML=R;U=le.firstChild;)ne.appendChild(U);return this.setDOMContent(ne)},z.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},z.prototype.setMaxWidth=function(R){return this.options.maxWidth=R,this._update(),this},z.prototype.setDOMContent=function(R){return this._createContent(),this._content.appendChild(R),this._update(),this},z.prototype.addClassName=function(R){this._container&&this._container.classList.add(R)},z.prototype.removeClassName=function(R){this._container&&this._container.classList.remove(R)},z.prototype.toggleClassName=function(R){if(this._container)return this._container.classList.toggle(R)},z.prototype._createContent=function(){this._content&&u.remove(this._content),this._content=u.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=u.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},z.prototype._onMouseUp=function(R){this._update(R.point)},z.prototype._onMouseMove=function(R){this._update(R.point)},z.prototype._onDrag=function(R){this._update(R.point)},z.prototype._update=function(R){var U=this,ne=this._lngLat||this._trackPointer;if(this._map&&ne&&this._content&&(this._container||(this._container=u.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=u.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(yt){return U._container.classList.add(yt)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=ms(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||R)){var le=this._pos=this._trackPointer&&R?R:this._map.project(this._lngLat),pe=this.options.anchor,ye=function yt(St){if(St){if(typeof St=="number"){var _t=Math.round(Math.sqrt(.5*Math.pow(St,2)));return{center:new e.Point(0,0),top:new e.Point(0,St),"top-left":new e.Point(_t,_t),"top-right":new e.Point(-_t,_t),bottom:new e.Point(0,-St),"bottom-left":new e.Point(_t,-_t),"bottom-right":new e.Point(-_t,-_t),left:new e.Point(St,0),right:new e.Point(-St,0)}}if(St instanceof e.Point||Array.isArray(St)){var Tt=e.Point.convert(St);return{center:Tt,top:Tt,"top-left":Tt,"top-right":Tt,bottom:Tt,"bottom-left":Tt,"bottom-right":Tt,left:Tt,right:Tt}}return{center:e.Point.convert(St.center||[0,0]),top:e.Point.convert(St.top||[0,0]),"top-left":e.Point.convert(St["top-left"]||[0,0]),"top-right":e.Point.convert(St["top-right"]||[0,0]),bottom:e.Point.convert(St.bottom||[0,0]),"bottom-left":e.Point.convert(St["bottom-left"]||[0,0]),"bottom-right":e.Point.convert(St["bottom-right"]||[0,0]),left:e.Point.convert(St.left||[0,0]),right:e.Point.convert(St.right||[0,0])}}return yt(new e.Point(0,0))}(this.options.offset);if(!pe){var Te,Ne=this._container.offsetWidth,qe=this._container.offsetHeight;Te=le.y+ye.bottom.y<qe?["top"]:le.y>this._map.transform.height-qe?["bottom"]:[],le.x<Ne/2?Te.push("left"):le.x>this._map.transform.width-Ne/2&&Te.push("right"),pe=Te.length===0?"bottom":Te.join("-")}var tt=le.add(ye[pe]).round();u.setTransform(this._container,ss[pe]+" translate("+tt.x+"px,"+tt.y+"px)"),Ei(this._container,pe,"popup")}},z.prototype._onClose=function(){this.remove()},z}(e.Evented),oe={version:e.version,supported:f,setRTLTextPlugin:e.setRTLTextPlugin,getRTLTextPluginStatus:e.getRTLTextPluginStatus,Map:qo,NavigationControl:Wa,GeolocateControl:el,AttributionControl:Oi,ScaleControl:vs,FullscreenControl:eo,Popup:fl,Marker:Ss,Style:qn,LngLat:e.LngLat,LngLatBounds:e.LngLatBounds,Point:e.Point,MercatorCoordinate:e.MercatorCoordinate,Evented:e.Evented,config:e.config,prewarm:function(){nt().acquire(Et)},clearPrewarmedResources:function(){var E=It;E&&(E.isPreloaded()&&E.numActive()===1?(E.release(Et),It=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return e.config.ACCESS_TOKEN},set accessToken(E){e.config.ACCESS_TOKEN=E},get baseApiUrl(){return e.config.API_URL},set baseApiUrl(E){e.config.API_URL=E},get workerCount(){return mt.workerCount},set workerCount(E){mt.workerCount=E},get maxParallelImageRequests(){return e.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(E){e.config.MAX_PARALLEL_IMAGE_REQUESTS=E},clearStorage:function(E){e.clearTileCache(E)},workerUrl:""};return oe}),g})},{}],452:[function(h,N,H){var t=h("./normalize"),m=h("gl-mat4/create"),g=h("gl-mat4/clone"),p=h("gl-mat4/determinant"),e=h("gl-mat4/invert"),f=h("gl-mat4/transpose"),u={length:h("gl-vec3/length"),normalize:h("gl-vec3/normalize"),dot:h("gl-vec3/dot"),cross:h("gl-vec3/cross")},i=m(),s=m(),o=[0,0,0,0],a=[[0,0,0],[0,0,0],[0,0,0]],c=[0,0,0];function r(n,d,l,y,v){n[0]=d[0]*y+l[0]*v,n[1]=d[1]*y+l[1]*v,n[2]=d[2]*y+l[2]*v}N.exports=function(n,d,l,y,v,_){if(d||(d=[0,0,0]),l||(l=[0,0,0]),y||(y=[0,0,0]),v||(v=[0,0,0,1]),_||(_=[0,0,0,1]),!t(i,n)||(g(s,i),s[3]=0,s[7]=0,s[11]=0,s[15]=1,Math.abs(p(s)<1e-8)))return!1;var x,T,A,S,w,L,k,C=i[3],M=i[7],P=i[11],O=i[12],F=i[13],j=i[14],W=i[15];if(C!==0||M!==0||P!==0){if(o[0]=C,o[1]=M,o[2]=P,o[3]=W,!e(s,s))return!1;f(s,s),x=v,A=s,S=(T=o)[0],w=T[1],L=T[2],k=T[3],x[0]=A[0]*S+A[4]*w+A[8]*L+A[12]*k,x[1]=A[1]*S+A[5]*w+A[9]*L+A[13]*k,x[2]=A[2]*S+A[6]*w+A[10]*L+A[14]*k,x[3]=A[3]*S+A[7]*w+A[11]*L+A[15]*k}else v[0]=v[1]=v[2]=0,v[3]=1;if(d[0]=O,d[1]=F,d[2]=j,function(Q,X){Q[0][0]=X[0],Q[0][1]=X[1],Q[0][2]=X[2],Q[1][0]=X[4],Q[1][1]=X[5],Q[1][2]=X[6],Q[2][0]=X[8],Q[2][1]=X[9],Q[2][2]=X[10]}(a,i),l[0]=u.length(a[0]),u.normalize(a[0],a[0]),y[0]=u.dot(a[0],a[1]),r(a[1],a[1],a[0],1,-y[0]),l[1]=u.length(a[1]),u.normalize(a[1],a[1]),y[0]/=l[1],y[1]=u.dot(a[0],a[2]),r(a[2],a[2],a[0],1,-y[1]),y[2]=u.dot(a[1],a[2]),r(a[2],a[2],a[1],1,-y[2]),l[2]=u.length(a[2]),u.normalize(a[2],a[2]),y[1]/=l[2],y[2]/=l[2],u.cross(c,a[1],a[2]),u.dot(a[0],c)<0)for(var Z=0;Z<3;Z++)l[Z]*=-1,a[Z][0]*=-1,a[Z][1]*=-1,a[Z][2]*=-1;return _[0]=.5*Math.sqrt(Math.max(1+a[0][0]-a[1][1]-a[2][2],0)),_[1]=.5*Math.sqrt(Math.max(1-a[0][0]+a[1][1]-a[2][2],0)),_[2]=.5*Math.sqrt(Math.max(1-a[0][0]-a[1][1]+a[2][2],0)),_[3]=.5*Math.sqrt(Math.max(1+a[0][0]+a[1][1]+a[2][2],0)),a[2][1]>a[1][2]&&(_[0]=-_[0]),a[0][2]>a[2][0]&&(_[1]=-_[1]),a[1][0]>a[0][1]&&(_[2]=-_[2]),!0}},{"./normalize":453,"gl-mat4/clone":278,"gl-mat4/create":280,"gl-mat4/determinant":281,"gl-mat4/invert":293,"gl-mat4/transpose":306,"gl-vec3/cross":360,"gl-vec3/dot":365,"gl-vec3/length":375,"gl-vec3/normalize":382}],453:[function(h,N,H){N.exports=function(t,m){var g=m[15];if(g===0)return!1;for(var p=1/g,e=0;e<16;e++)t[e]=m[e]*p;return!0}},{}],454:[function(h,N,H){var t=h("gl-vec3/lerp"),m=h("mat4-recompose"),g=h("mat4-decompose"),p=h("gl-mat4/determinant"),e=h("quat-slerp"),f=s(),u=s(),i=s();function s(){return{translate:o(),scale:o(1),skew:o(),perspective:[0,0,0,1],quaternion:[0,0,0,1]}}function o(a){return[a||0,a||0,a||0]}N.exports=function(a,c,r,n){if(p(c)===0||p(r)===0)return!1;var d=g(c,f.translate,f.scale,f.skew,f.perspective,f.quaternion),l=g(r,u.translate,u.scale,u.skew,u.perspective,u.quaternion);return!(!d||!l)&&(t(i.translate,f.translate,u.translate,n),t(i.skew,f.skew,u.skew,n),t(i.scale,f.scale,u.scale,n),t(i.perspective,f.perspective,u.perspective,n),e(i.quaternion,f.quaternion,u.quaternion,n),m(a,i.translate,i.scale,i.skew,i.perspective,i.quaternion),!0)}},{"gl-mat4/determinant":281,"gl-vec3/lerp":376,"mat4-decompose":452,"mat4-recompose":455,"quat-slerp":515}],455:[function(h,N,H){var t={identity:h("gl-mat4/identity"),translate:h("gl-mat4/translate"),multiply:h("gl-mat4/multiply"),create:h("gl-mat4/create"),scale:h("gl-mat4/scale"),fromRotationTranslation:h("gl-mat4/fromRotationTranslation")},m=(t.create(),t.create());N.exports=function(g,p,e,f,u,i){return t.identity(g),t.fromRotationTranslation(g,i,p),g[3]=u[0],g[7]=u[1],g[11]=u[2],g[15]=u[3],t.identity(m),f[2]!==0&&(m[9]=f[2],t.multiply(g,g,m)),f[1]!==0&&(m[9]=0,m[8]=f[1],t.multiply(g,g,m)),f[0]!==0&&(m[8]=0,m[4]=f[0],t.multiply(g,g,m)),t.scale(g,g,e),g}},{"gl-mat4/create":280,"gl-mat4/fromRotationTranslation":284,"gl-mat4/identity":291,"gl-mat4/multiply":295,"gl-mat4/scale":303,"gl-mat4/translate":305}],456:[function(h,N,H){N.exports=Math.log2||function(t){return Math.log(t)*Math.LOG2E}},{}],457:[function(h,N,H){var t=h("binary-search-bounds"),m=h("mat4-interpolate"),g=h("gl-mat4/invert"),p=h("gl-mat4/rotateX"),e=h("gl-mat4/rotateY"),f=h("gl-mat4/rotateZ"),u=h("gl-mat4/lookAt"),i=h("gl-mat4/translate"),s=(h("gl-mat4/scale"),h("gl-vec3/normalize")),o=[0,0,0];function a(n){this._components=n.slice(),this._time=[0],this.prevMatrix=n.slice(),this.nextMatrix=n.slice(),this.computedMatrix=n.slice(),this.computedInverse=n.slice(),this.computedEye=[0,0,0],this.computedUp=[0,0,0],this.computedCenter=[0,0,0],this.computedRadius=[0],this._limits=[-1/0,1/0]}N.exports=function(n){return new a((n=n||{}).matrix||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])};var c=a.prototype;c.recalcMatrix=function(n){var d=this._time,l=t.le(d,n),y=this.computedMatrix;if(!(l<0)){var v=this._components;if(l===d.length-1)for(var _=16*l,x=0;x<16;++x)y[x]=v[_++];else{var T=d[l+1]-d[l],A=(_=16*l,this.prevMatrix),S=!0;for(x=0;x<16;++x)A[x]=v[_++];var w=this.nextMatrix;for(x=0;x<16;++x)w[x]=v[_++],S=S&&A[x]===w[x];if(T<1e-6||S)for(x=0;x<16;++x)y[x]=A[x];else m(y,A,w,(n-d[l])/T)}var L=this.computedUp;L[0]=y[1],L[1]=y[5],L[2]=y[9],s(L,L);var k=this.computedInverse;g(k,y);var C=this.computedEye,M=k[15];C[0]=k[12]/M,C[1]=k[13]/M,C[2]=k[14]/M;var P=this.computedCenter,O=Math.exp(this.computedRadius[0]);for(x=0;x<3;++x)P[x]=C[x]-y[2+4*x]*O}},c.idle=function(n){if(!(n<this.lastT())){for(var d=this._components,l=d.length-16,y=0;y<16;++y)d.push(d[l++]);this._time.push(n)}},c.flush=function(n){var d=t.gt(this._time,n)-2;d<0||(this._time.splice(0,d),this._components.splice(0,16*d))},c.lastT=function(){return this._time[this._time.length-1]},c.lookAt=function(n,d,l,y){this.recalcMatrix(n),d=d||this.computedEye,l=l||o,y=y||this.computedUp,this.setMatrix(n,u(this.computedMatrix,d,l,y));for(var v=0,_=0;_<3;++_)v+=Math.pow(l[_]-d[_],2);v=Math.log(Math.sqrt(v)),this.computedRadius[0]=v},c.rotate=function(n,d,l,y){this.recalcMatrix(n);var v=this.computedInverse;d&&e(v,v,d),l&&p(v,v,l),y&&f(v,v,y),this.setMatrix(n,g(this.computedMatrix,v))};var r=[0,0,0];c.pan=function(n,d,l,y){r[0]=-(d||0),r[1]=-(l||0),r[2]=-(y||0),this.recalcMatrix(n);var v=this.computedInverse;i(v,v,r),this.setMatrix(n,g(v,v))},c.translate=function(n,d,l,y){r[0]=d||0,r[1]=l||0,r[2]=y||0,this.recalcMatrix(n);var v=this.computedMatrix;i(v,v,r),this.setMatrix(n,v)},c.setMatrix=function(n,d){if(!(n<this.lastT())){this._time.push(n);for(var l=0;l<16;++l)this._components.push(d[l])}},c.setDistance=function(n,d){this.computedRadius[0]=d},c.setDistanceLimits=function(n,d){var l=this._limits;l[0]=n,l[1]=d},c.getDistanceLimits=function(n){var d=this._limits;return n?(n[0]=d[0],n[1]=d[1],n):d}},{"binary-search-bounds":103,"gl-mat4/invert":293,"gl-mat4/lookAt":294,"gl-mat4/rotateX":300,"gl-mat4/rotateY":301,"gl-mat4/rotateZ":302,"gl-mat4/scale":303,"gl-mat4/translate":305,"gl-vec3/normalize":382,"mat4-interpolate":454}],458:[function(h,N,H){N.exports=function(m){var g=m.length;if(g<3){for(var p=new Array(g),e=0;e<g;++e)p[e]=e;return g===2&&m[0][0]===m[1][0]&&m[0][1]===m[1][1]?[0]:p}var f=new Array(g);for(e=0;e<g;++e)f[e]=e;f.sort(function(d,l){var y=m[d][0]-m[l][0];return y||m[d][1]-m[l][1]});var u=[f[0],f[1]],i=[f[0],f[1]];for(e=2;e<g;++e){for(var s=f[e],o=m[s],a=u.length;a>1&&t(m[u[a-2]],m[u[a-1]],o)<=0;)a-=1,u.pop();for(u.push(s),a=i.length;a>1&&t(m[i[a-2]],m[i[a-1]],o)>=0;)a-=1,i.pop();i.push(s)}p=new Array(i.length+u.length-2);for(var c=0,r=(e=0,u.length);e<r;++e)p[c++]=u[e];for(var n=i.length-2;n>0;--n)p[c++]=i[n];return p};var t=h("robust-orientation")[3]},{"robust-orientation":534}],459:[function(h,N,H){N.exports=function(m,g){g||(g=m,m=window);var p=0,e=0,f=0,u={shift:!1,alt:!1,control:!1,meta:!1},i=!1;function s(_){var x=!1;return"altKey"in _&&(x=x||_.altKey!==u.alt,u.alt=!!_.altKey),"shiftKey"in _&&(x=x||_.shiftKey!==u.shift,u.shift=!!_.shiftKey),"ctrlKey"in _&&(x=x||_.ctrlKey!==u.control,u.control=!!_.ctrlKey),"metaKey"in _&&(x=x||_.metaKey!==u.meta,u.meta=!!_.metaKey),x}function o(_,x){var T=t.x(x),A=t.y(x);"buttons"in x&&(_=0|x.buttons),(_!==p||T!==e||A!==f||s(x))&&(p=0|_,e=T||0,f=A||0,g&&g(p,e,f,u))}function a(_){o(0,_)}function c(){(p||e||f||u.shift||u.alt||u.meta||u.control)&&(e=f=0,p=0,u.shift=u.alt=u.control=u.meta=!1,g&&g(0,0,0,u))}function r(_){s(_)&&g&&g(p,e,f,u)}function n(_){t.buttons(_)===0?o(0,_):o(p,_)}function d(_){o(p|t.buttons(_),_)}function l(_){o(p&~t.buttons(_),_)}function y(){i||(i=!0,m.addEventListener("mousemove",n),m.addEventListener("mousedown",d),m.addEventListener("mouseup",l),m.addEventListener("mouseleave",a),m.addEventListener("mouseenter",a),m.addEventListener("mouseout",a),m.addEventListener("mouseover",a),m.addEventListener("blur",c),m.addEventListener("keyup",r),m.addEventListener("keydown",r),m.addEventListener("keypress",r),m!==window&&(window.addEventListener("blur",c),window.addEventListener("keyup",r),window.addEventListener("keydown",r),window.addEventListener("keypress",r)))}y();var v={element:m};return Object.defineProperties(v,{enabled:{get:function(){return i},set:function(_){_?y():function(){!i||(i=!1,m.removeEventListener("mousemove",n),m.removeEventListener("mousedown",d),m.removeEventListener("mouseup",l),m.removeEventListener("mouseleave",a),m.removeEventListener("mouseenter",a),m.removeEventListener("mouseout",a),m.removeEventListener("mouseover",a),m.removeEventListener("blur",c),m.removeEventListener("keyup",r),m.removeEventListener("keydown",r),m.removeEventListener("keypress",r),m!==window&&(window.removeEventListener("blur",c),window.removeEventListener("keyup",r),window.removeEventListener("keydown",r),window.removeEventListener("keypress",r)))}()},enumerable:!0},buttons:{get:function(){return p},enumerable:!0},x:{get:function(){return e},enumerable:!0},y:{get:function(){return f},enumerable:!0},mods:{get:function(){return u},enumerable:!0}}),v};var t=h("mouse-event")},{"mouse-event":461}],460:[function(h,N,H){var t={left:0,top:0};N.exports=function(m,g,p){g=g||m.currentTarget||m.srcElement,Array.isArray(p)||(p=[0,0]);var e=m.clientX||0,f=m.clientY||0,u=(i=g,i===window||i===document||i===document.body?t:i.getBoundingClientRect()),i;return p[0]=e-u.left,p[1]=f-u.top,p}},{}],461:[function(h,N,H){function t(m){return m.target||m.srcElement||window}H.buttons=function(m){if(typeof m=="object"){if("buttons"in m)return m.buttons;if("which"in m){if((g=m.which)===2)return 4;if(g===3)return 2;if(g>0)return 1<<g-1}else if("button"in m){var g;if((g=m.button)===1)return 4;if(g===2)return 2;if(g>=0)return 1<<g}}return 0},H.element=t,H.x=function(m){if(typeof m=="object"){if("offsetX"in m)return m.offsetX;var g=t(m).getBoundingClientRect();return m.clientX-g.left}return 0},H.y=function(m){if(typeof m=="object"){if("offsetY"in m)return m.offsetY;var g=t(m).getBoundingClientRect();return m.clientY-g.top}return 0}},{}],462:[function(h,N,H){var t=h("to-px");N.exports=function(m,g,p){typeof m=="function"&&(p=!!g,g=m,m=window);var e=t("ex",m),f=function(u){p&&u.preventDefault();var i=u.deltaX||0,s=u.deltaY||0,o=u.deltaZ||0,a=1;switch(u.deltaMode){case 1:a=e;break;case 2:a=window.innerHeight}if(s*=a,o*=a,(i*=a)||s||o)return g(i,s,o,u)};return m.addEventListener("wheel",f),f}},{"to-px":585}],463:[function(h,N,H){(function(t,m){(function(){/*! Native Promise Only
    v0.8.1 (c) Kyle Simpson
    MIT License: http://getify.mit-license.org
*/(function(g,p,e){p[g]=p[g]||e(),N!==void 0&&N.exports&&(N.exports=p[g])})("Promise",t!==void 0?t:this,function(){var g,p,e,f=Object.prototype.toString,u=m!==void 0?function(_){return m(_)}:setTimeout;try{Object.defineProperty({},"x",{}),g=function(_,x,T,A){return Object.defineProperty(_,x,{value:T,writable:!0,configurable:A!==!1})}}catch(_){g=function(x,T,A){return x[T]=A,x}}function i(_,x){e.add(_,x),p||(p=u(e.drain))}function s(_){var x,T=typeof _;return _==null||T!="object"&&T!="function"||(x=_.then),typeof x=="function"&&x}function o(){for(var _=0;_<this.chain.length;_++)a(this,this.state===1?this.chain[_].success:this.chain[_].failure,this.chain[_]);this.chain.length=0}function a(_,x,T){var A,S;try{x===!1?T.reject(_.msg):(A=x===!0?_.msg:x.call(void 0,_.msg))===T.promise?T.reject(TypeError("Promise-chain cycle")):(S=s(A))?S.call(A,T.resolve,T.reject):T.resolve(A)}catch(w){T.reject(w)}}function c(_){var x,T=this;if(!T.triggered){T.triggered=!0,T.def&&(T=T.def);try{(x=s(_))?i(function(){var A=new d(T);try{x.call(_,function(){c.apply(A,arguments)},function(){r.apply(A,arguments)})}catch(S){r.call(A,S)}}):(T.msg=_,T.state=1,T.chain.length>0&&i(o,T))}catch(A){r.call(new d(T),A)}}}function r(_){var x=this;x.triggered||(x.triggered=!0,x.def&&(x=x.def),x.msg=_,x.state=2,x.chain.length>0&&i(o,x))}function n(_,x,T,A){for(var S=0;S<x.length;S++)(function(w){_.resolve(x[w]).then(function(L){T(w,L)},A)})(S)}function d(_){this.def=_,this.triggered=!1}function l(_){this.promise=_,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function y(_){if(typeof _!="function")throw TypeError("Not a function");if(this.__NPO__!==0)throw TypeError("Not a promise");this.__NPO__=1;var x=new l(this);this.then=function(T,A){var S={success:typeof T!="function"||T,failure:typeof A=="function"&&A};return S.promise=new this.constructor(function(w,L){if(typeof w!="function"||typeof L!="function")throw TypeError("Not a function");S.resolve=w,S.reject=L}),x.chain.push(S),x.state!==0&&i(o,x),S.promise},this.catch=function(T){return this.then(void 0,T)};try{_.call(void 0,function(T){c.call(x,T)},function(T){r.call(x,T)})}catch(T){r.call(x,T)}}e=function(){var _,x,T;function A(S,w){this.fn=S,this.self=w,this.next=void 0}return{add:function(S,w){T=new A(S,w),x?x.next=T:_=T,x=T,T=void 0},drain:function(){var S=_;for(_=x=p=void 0;S;)S.fn.call(S.self),S=S.next}}}();var v=g({},"constructor",y,!1);return y.prototype=v,g(v,"__NPO__",0,!1),g(y,"resolve",function(_){return _&&typeof _=="object"&&_.__NPO__===1?_:new this(function(x,T){if(typeof x!="function"||typeof T!="function")throw TypeError("Not a function");x(_)})}),g(y,"reject",function(_){return new this(function(x,T){if(typeof x!="function"||typeof T!="function")throw TypeError("Not a function");T(_)})}),g(y,"all",function(_){var x=this;return f.call(_)!="[object Array]"?x.reject(TypeError("Not an array")):_.length===0?x.resolve([]):new x(function(T,A){if(typeof T!="function"||typeof A!="function")throw TypeError("Not a function");var S=_.length,w=Array(S),L=0;n(x,_,function(k,C){w[k]=C,++L===S&&T(w)},A)})}),g(y,"race",function(_){var x=this;return f.call(_)!="[object Array]"?x.reject(TypeError("Not an array")):new x(function(T,A){if(typeof T!="function"||typeof A!="function")throw TypeError("Not a function");n(x,_,function(S,w){T(w)},A)})}),y})}).call(this)}).call(this,typeof La!="undefined"?La:typeof self!="undefined"?self:typeof window!="undefined"?window:{},h("timers").setImmediate)},{timers:582}],464:[function(h,N,H){var t=h("typedarray-pool");N.exports=function(g){function p(a){throw new Error("ndarray-extract-contour: "+a)}typeof g!="object"&&p("Must specify arguments");var e=g.order;Array.isArray(e)||p("Must specify order");var f=g.arrayArguments||1;f<1&&p("Must have at least one array argument");var u=g.scalarArguments||0;u<0&&p("Scalar arg count must be > 0"),typeof g.vertex!="function"&&p("Must specify vertex creation function"),typeof g.cell!="function"&&p("Must specify cell creation function"),typeof g.phase!="function"&&p("Must specify phase function");for(var i=g.getters||[],s=new Array(f),o=0;o<f;++o)i.indexOf(o)>=0?s[o]=!0:s[o]=!1;return function(a,c,r,n,d,l){var y=[l,d].join(",");return(0,m[y])(a,c,r,t.mallocUint32,t.freeUint32)}(g.vertex,g.cell,g.phase,0,e,s)};var m={"false,0,1":function(g,p,e,f,u){return function(i,s,o,a){var c,r=0|i.shape[0],n=0|i.shape[1],d=i.data,l=0|i.offset,y=0|i.stride[0],v=0|i.stride[1],_=l,x=0|-y,T=0,A=0|-v,S=0,w=-y-v|0,L=0,k=0|y,C=v-y*r|0,M=0,P=0,O=0,F=2*r|0,j=f(F),W=f(F),Z=0,Q=0,X=-1,G=-1,Y=0,K=0|-r,D=0|r,B=0,q=-r-1|0,ee=r-1|0,J=0,$=0,te=0;for(M=0;M<r;++M)j[Z++]=e(d[_],s,o,a),_+=k;if(_+=C,n>0){if(P=1,j[Z++]=e(d[_],s,o,a),_+=k,r>0)for(M=1,c=d[_],Q=j[Z]=e(c,s,o,a),Y=j[Z+X],B=j[Z+K],J=j[Z+q],Q===Y&&Q===B&&Q===J||(T=d[_+x],S=d[_+A],L=d[_+w],g(M,P,c,T,S,L,Q,Y,B,J,s,o,a),$=W[Z]=O++),Z+=1,_+=k,M=2;M<r;++M)c=d[_],Q=j[Z]=e(c,s,o,a),Y=j[Z+X],B=j[Z+K],J=j[Z+q],Q===Y&&Q===B&&Q===J||(T=d[_+x],S=d[_+A],L=d[_+w],g(M,P,c,T,S,L,Q,Y,B,J,s,o,a),$=W[Z]=O++,J!==Y&&p(W[Z+X],$,L,T,J,Y,s,o,a)),Z+=1,_+=k;for(_+=C,Z=0,te=X,X=G,G=te,te=K,K=D,D=te,te=q,q=ee,ee=te,P=2;P<n;++P){if(j[Z++]=e(d[_],s,o,a),_+=k,r>0)for(M=1,c=d[_],Q=j[Z]=e(c,s,o,a),Y=j[Z+X],B=j[Z+K],J=j[Z+q],Q===Y&&Q===B&&Q===J||(T=d[_+x],S=d[_+A],L=d[_+w],g(M,P,c,T,S,L,Q,Y,B,J,s,o,a),$=W[Z]=O++,J!==B&&p(W[Z+K],$,S,L,B,J,s,o,a)),Z+=1,_+=k,M=2;M<r;++M)c=d[_],Q=j[Z]=e(c,s,o,a),Y=j[Z+X],B=j[Z+K],J=j[Z+q],Q===Y&&Q===B&&Q===J||(T=d[_+x],S=d[_+A],L=d[_+w],g(M,P,c,T,S,L,Q,Y,B,J,s,o,a),$=W[Z]=O++,J!==B&&p(W[Z+K],$,S,L,B,J,s,o,a),J!==Y&&p(W[Z+X],$,L,T,J,Y,s,o,a)),Z+=1,_+=k;1&P&&(Z=0),te=X,X=G,G=te,te=K,K=D,D=te,te=q,q=ee,ee=te,_+=C}}u(W),u(j)}},"false,1,0":function(g,p,e,f,u){return function(i,s,o,a){var c,r=0|i.shape[0],n=0|i.shape[1],d=i.data,l=0|i.offset,y=0|i.stride[0],v=0|i.stride[1],_=l,x=0|-y,T=0,A=0|-v,S=0,w=-y-v|0,L=0,k=0|v,C=y-v*n|0,M=0,P=0,O=0,F=2*n|0,j=f(F),W=f(F),Z=0,Q=0,X=-1,G=-1,Y=0,K=0|-n,D=0|n,B=0,q=-n-1|0,ee=n-1|0,J=0,$=0,te=0;for(P=0;P<n;++P)j[Z++]=e(d[_],s,o,a),_+=k;if(_+=C,r>0){if(M=1,j[Z++]=e(d[_],s,o,a),_+=k,n>0)for(P=1,c=d[_],Q=j[Z]=e(c,s,o,a),B=j[Z+K],Y=j[Z+X],J=j[Z+q],Q===B&&Q===Y&&Q===J||(T=d[_+x],S=d[_+A],L=d[_+w],g(M,P,c,T,S,L,Q,B,Y,J,s,o,a),$=W[Z]=O++),Z+=1,_+=k,P=2;P<n;++P)c=d[_],Q=j[Z]=e(c,s,o,a),B=j[Z+K],Y=j[Z+X],J=j[Z+q],Q===B&&Q===Y&&Q===J||(T=d[_+x],S=d[_+A],L=d[_+w],g(M,P,c,T,S,L,Q,B,Y,J,s,o,a),$=W[Z]=O++,J!==Y&&p(W[Z+X],$,S,L,Y,J,s,o,a)),Z+=1,_+=k;for(_+=C,Z=0,te=K,K=D,D=te,te=X,X=G,G=te,te=q,q=ee,ee=te,M=2;M<r;++M){if(j[Z++]=e(d[_],s,o,a),_+=k,n>0)for(P=1,c=d[_],Q=j[Z]=e(c,s,o,a),B=j[Z+K],Y=j[Z+X],J=j[Z+q],Q===B&&Q===Y&&Q===J||(T=d[_+x],S=d[_+A],L=d[_+w],g(M,P,c,T,S,L,Q,B,Y,J,s,o,a),$=W[Z]=O++,J!==B&&p(W[Z+K],$,L,T,J,B,s,o,a)),Z+=1,_+=k,P=2;P<n;++P)c=d[_],Q=j[Z]=e(c,s,o,a),B=j[Z+K],Y=j[Z+X],J=j[Z+q],Q===B&&Q===Y&&Q===J||(T=d[_+x],S=d[_+A],L=d[_+w],g(M,P,c,T,S,L,Q,B,Y,J,s,o,a),$=W[Z]=O++,J!==Y&&p(W[Z+X],$,S,L,Y,J,s,o,a),J!==B&&p(W[Z+K],$,L,T,J,B,s,o,a)),Z+=1,_+=k;1&M&&(Z=0),te=K,K=D,D=te,te=X,X=G,G=te,te=q,q=ee,ee=te,_+=C}}u(W),u(j)}}}},{"typedarray-pool":601}],465:[function(h,N,H){var t=h("dup"),m={zero:function(r,n,d,l){var y=r[0];l|=0;var v=0,_=d[0];for(v=0;v<y;++v)n[l]=0,l+=_},fdTemplate1:function(r,n,d,l,y,v,_){var x=r[0],T=d[0],A=-1*T,S=T;l|=0,_|=0;var w=0,L=T,k=v[0];for(w=0;w<x;++w)y[_]=.5*(n[l+A]-n[l+S]),l+=L,_+=k},fdTemplate2:function(r,n,d,l,y,v,_,x,T,A){var S=r[0],w=r[1],L=d[0],k=d[1],C=v[0],M=v[1],P=T[0],O=T[1],F=-1*L,j=L,W=-1*k,Z=k;l|=0,_|=0,A|=0;var Q=0,X=0,G=k,Y=L-w*k,K=M,D=C-w*M,B=O,q=P-w*O;for(X=0;X<S;++X){for(Q=0;Q<w;++Q)y[_]=.5*(n[l+F]-n[l+j]),x[A]=.5*(n[l+W]-n[l+Z]),l+=G,_+=K,A+=B;l+=Y,_+=D,A+=q}}},g={cdiff:function(r){var n={};return function(d,l,y){var v=d.dtype,_=d.order,x=l.dtype,T=l.order,A=y.dtype,S=y.order,w=[v,_.join(),x,T.join(),A,S.join()].join(),L=n[w];return L||(n[w]=L=r([v,_,x,T,A,S])),L(d.shape.slice(0),d.data,d.stride,0|d.offset,l.data,l.stride,0|l.offset,y.data,y.stride,0|y.offset)}},zero:function(r){var n={};return function(d){var l=d.dtype,y=d.order,v=[l,y.join()].join(),_=n[v];return _||(n[v]=_=r([l,y])),_(d.shape.slice(0),d.data,d.stride,0|d.offset)}},fdTemplate1:function(r){var n={};return function(d,l){var y=d.dtype,v=d.order,_=l.dtype,x=l.order,T=[y,v.join(),_,x.join()].join(),A=n[T];return A||(n[T]=A=r([y,v,_,x])),A(d.shape.slice(0),d.data,d.stride,0|d.offset,l.data,l.stride,0|l.offset)}},fdTemplate2:function(r){var n={};return function(d,l,y){var v=d.dtype,_=d.order,x=l.dtype,T=l.order,A=y.dtype,S=y.order,w=[v,_.join(),x,T.join(),A,S.join()].join(),L=n[w];return L||(n[w]=L=r([v,_,x,T,A,S])),L(d.shape.slice(0),d.data,d.stride,0|d.offset,l.data,l.stride,0|l.offset,y.data,y.stride,0|y.offset)}}};function p(r){return(0,g[r.funcName])(e.bind(void 0,r))}function e(r){return m[r.funcName]}function f(r){return p({funcName:r.funcName})}var u={},i={},s=f({funcName:"cdiff"}),o=f({funcName:"zero"});function a(r){return r in u?u[r]:u[r]=f({funcName:"fdTemplate"+r})}function c(r,n,d,l){return function(y,v){var _=v.shape.slice();return _[0]>2&&_[1]>2&&l(v.pick(-1,-1).lo(1,1).hi(_[0]-2,_[1]-2),y.pick(-1,-1,0).lo(1,1).hi(_[0]-2,_[1]-2),y.pick(-1,-1,1).lo(1,1).hi(_[0]-2,_[1]-2)),_[1]>2&&(d(v.pick(0,-1).lo(1).hi(_[1]-2),y.pick(0,-1,1).lo(1).hi(_[1]-2)),n(y.pick(0,-1,0).lo(1).hi(_[1]-2))),_[1]>2&&(d(v.pick(_[0]-1,-1).lo(1).hi(_[1]-2),y.pick(_[0]-1,-1,1).lo(1).hi(_[1]-2)),n(y.pick(_[0]-1,-1,0).lo(1).hi(_[1]-2))),_[0]>2&&(d(v.pick(-1,0).lo(1).hi(_[0]-2),y.pick(-1,0,0).lo(1).hi(_[0]-2)),n(y.pick(-1,0,1).lo(1).hi(_[0]-2))),_[0]>2&&(d(v.pick(-1,_[1]-1).lo(1).hi(_[0]-2),y.pick(-1,_[1]-1,0).lo(1).hi(_[0]-2)),n(y.pick(-1,_[1]-1,1).lo(1).hi(_[0]-2))),y.set(0,0,0,0),y.set(0,0,1,0),y.set(_[0]-1,0,0,0),y.set(_[0]-1,0,1,0),y.set(0,_[1]-1,0,0),y.set(0,_[1]-1,1,0),y.set(_[0]-1,_[1]-1,0,0),y.set(_[0]-1,_[1]-1,1,0),y}}N.exports=function(r,n,d){return Array.isArray(d)||(d=t(n.dimension,typeof d=="string"?d:"clamp")),n.size===0?r:n.dimension===0?(r.set(0),r):function(l){var y=l.join();if(T=i[y])return T;for(var v=l.length,_=[s,o],x=1;x<=v;++x)_.push(a(x));var T=c.apply(void 0,_);return i[y]=T,T}(d)(r,n)}},{dup:182}],466:[function(h,N,H){function t(e,f){var u=Math.floor(f),i=f-u,s=0<=u&&u<e.shape[0],o=0<=u+1&&u+1<e.shape[0];return(1-i)*(s?+e.get(u):0)+i*(o?+e.get(u+1):0)}function m(e,f,u){var i=Math.floor(f),s=f-i,o=0<=i&&i<e.shape[0],a=0<=i+1&&i+1<e.shape[0],c=Math.floor(u),r=u-c,n=0<=c&&c<e.shape[1],d=0<=c+1&&c+1<e.shape[1],l=o&&n?e.get(i,c):0,y=o&&d?e.get(i,c+1):0;return(1-r)*((1-s)*l+s*(a&&n?e.get(i+1,c):0))+r*((1-s)*y+s*(a&&d?e.get(i+1,c+1):0))}function g(e,f,u,i){var s=Math.floor(f),o=f-s,a=0<=s&&s<e.shape[0],c=0<=s+1&&s+1<e.shape[0],r=Math.floor(u),n=u-r,d=0<=r&&r<e.shape[1],l=0<=r+1&&r+1<e.shape[1],y=Math.floor(i),v=i-y,_=0<=y&&y<e.shape[2],x=0<=y+1&&y+1<e.shape[2],T=a&&d&&_?e.get(s,r,y):0,A=a&&l&&_?e.get(s,r+1,y):0,S=c&&d&&_?e.get(s+1,r,y):0,w=c&&l&&_?e.get(s+1,r+1,y):0,L=a&&d&&x?e.get(s,r,y+1):0,k=a&&l&&x?e.get(s,r+1,y+1):0;return(1-v)*((1-n)*((1-o)*T+o*S)+n*((1-o)*A+o*w))+v*((1-n)*((1-o)*L+o*(c&&d&&x?e.get(s+1,r,y+1):0))+n*((1-o)*k+o*(c&&l&&x?e.get(s+1,r+1,y+1):0)))}function p(e){var f,u,i=0|e.shape.length,s=new Array(i),o=new Array(i),a=new Array(i),c=new Array(i);for(f=0;f<i;++f)u=+arguments[f+1],s[f]=Math.floor(u),o[f]=u-s[f],a[f]=0<=s[f]&&s[f]<e.shape[f],c[f]=0<=s[f]+1&&s[f]+1<e.shape[f];var r,n,d,l=0;e:for(f=0;f<1<<i;++f){for(n=1,d=e.offset,r=0;r<i;++r)if(f&1<<r){if(!c[r])continue e;n*=o[r],d+=e.stride[r]*(s[r]+1)}else{if(!a[r])continue e;n*=1-o[r],d+=e.stride[r]*s[r]}l+=n*e.data[d]}return l}N.exports=function(e,f,u,i){switch(e.shape.length){case 0:return 0;case 1:return t(e,f);case 2:return m(e,f,u);case 3:return g(e,f,u,i);default:return p.apply(void 0,arguments)}},N.exports.d1=t,N.exports.d2=m,N.exports.d3=g},{}],467:[function(h,N,H){var t={"float64,2,1,0":function(){return function(f,u,i,s,o){var a=f[0],c=f[1],r=f[2],n=i[0],d=i[1],l=i[2];s|=0;var y=0,v=0,_=0,x=l,T=d-r*l,A=n-c*d;for(_=0;_<a;++_){for(v=0;v<c;++v){for(y=0;y<r;++y)u[s]/=o,s+=x;s+=T}s+=A}}},"uint8,2,0,1,float64,2,1,0":function(){return function(f,u,i,s,o,a,c,r){for(var n=f[0],d=f[1],l=f[2],y=i[0],v=i[1],_=i[2],x=a[0],T=a[1],A=a[2],S=s|=0,w=c|=0,L=0|f[0];L>0;){L<64?(n=L,L=0):(n=64,L-=64);for(var k=0|f[1];k>0;){k<64?(d=k,k=0):(d=64,k-=64),s=S+L*y+k*v,c=w+L*x+k*T;var C=0,M=0,P=0,O=_,F=y-l*_,j=v-n*y,W=A,Z=x-l*A,Q=T-n*x;for(P=0;P<d;++P){for(M=0;M<n;++M){for(C=0;C<l;++C)u[s]=o[c]*r,s+=O,c+=W;s+=F,c+=Z}s+=j,c+=Q}}}}},"float32,1,0,float32,1,0":function(){return function(f,u,i,s,o,a,c){var r=f[0],n=f[1],d=i[0],l=i[1],y=a[0],v=a[1];s|=0,c|=0;var _=0,x=0,T=l,A=d-n*l,S=v,w=y-n*v;for(x=0;x<r;++x){for(_=0;_<n;++_)u[s]=o[c],s+=T,c+=S;s+=A,c+=w}}},"float32,1,0,float32,0,1":function(){return function(f,u,i,s,o,a,c){for(var r=f[0],n=f[1],d=i[0],l=i[1],y=a[0],v=a[1],_=s|=0,x=c|=0,T=0|f[1];T>0;){T<64?(n=T,T=0):(n=64,T-=64);for(var A=0|f[0];A>0;){A<64?(r=A,A=0):(r=64,A-=64),s=_+T*l+A*d,c=x+T*v+A*y;var S=0,w=0,L=l,k=d-n*l,C=v,M=y-n*v;for(w=0;w<r;++w){for(S=0;S<n;++S)u[s]=o[c],s+=L,c+=C;s+=k,c+=M}}}}},"uint8,2,0,1,uint8,1,2,0":function(){return function(f,u,i,s,o,a,c){for(var r=f[0],n=f[1],d=f[2],l=i[0],y=i[1],v=i[2],_=a[0],x=a[1],T=a[2],A=s|=0,S=c|=0,w=0|f[2];w>0;){w<64?(d=w,w=0):(d=64,w-=64);for(var L=0|f[0];L>0;){L<64?(r=L,L=0):(r=64,L-=64);for(var k=0|f[1];k>0;){k<64?(n=k,k=0):(n=64,k-=64),s=A+w*v+L*l+k*y,c=S+w*T+L*_+k*x;var C=0,M=0,P=0,O=v,F=l-d*v,j=y-r*l,W=T,Z=_-d*T,Q=x-r*_;for(P=0;P<n;++P){for(M=0;M<r;++M){for(C=0;C<d;++C)u[s]=o[c],s+=O,c+=W;s+=F,c+=Z}s+=j,c+=Q}}}}}},"uint8,2,0,1,array,2,0,1":function(){return function(f,u,i,s,o,a,c){var r=f[0],n=f[1],d=f[2],l=i[0],y=i[1],v=i[2],_=a[0],x=a[1],T=a[2];s|=0,c|=0;var A=0,S=0,w=0,L=v,k=l-d*v,C=y-r*l,M=T,P=_-d*T,O=x-r*_;for(w=0;w<n;++w){for(S=0;S<r;++S){for(A=0;A<d;++A)u[s]=o[c],s+=L,c+=M;s+=k,c+=P}s+=C,c+=O}}}},m=function(f,u){var i=u.join(",");return(0,t[i])()},g={mul:function(f){var u={};return function(i,s,o){var a=i.dtype,c=i.order,r=s.dtype,n=s.order,d=o.dtype,l=o.order,y=[a,c.join(),r,n.join(),d,l.join()].join(),v=u[y];return v||(u[y]=v=f([a,c,r,n,d,l])),v(i.shape.slice(0),i.data,i.stride,0|i.offset,s.data,s.stride,0|s.offset,o.data,o.stride,0|o.offset)}},muls:function(f){var u={};return function(i,s,o){var a=i.dtype,c=i.order,r=s.dtype,n=s.order,d=[a,c.join(),r,n.join()].join(),l=u[d];return l||(u[d]=l=f([a,c,r,n])),l(i.shape.slice(0),i.data,i.stride,0|i.offset,s.data,s.stride,0|s.offset,o)}},mulseq:function(f){var u={};return function(i,s){var o=i.dtype,a=i.order,c=[o,a.join()].join(),r=u[c];return r||(u[c]=r=f([o,a])),r(i.shape.slice(0),i.data,i.stride,0|i.offset,s)}},div:function(f){var u={};return function(i,s,o){var a=i.dtype,c=i.order,r=s.dtype,n=s.order,d=o.dtype,l=o.order,y=[a,c.join(),r,n.join(),d,l.join()].join(),v=u[y];return v||(u[y]=v=f([a,c,r,n,d,l])),v(i.shape.slice(0),i.data,i.stride,0|i.offset,s.data,s.stride,0|s.offset,o.data,o.stride,0|o.offset)}},divs:function(f){var u={};return function(i,s,o){var a=i.dtype,c=i.order,r=s.dtype,n=s.order,d=[a,c.join(),r,n.join()].join(),l=u[d];return l||(u[d]=l=f([a,c,r,n])),l(i.shape.slice(0),i.data,i.stride,0|i.offset,s.data,s.stride,0|s.offset,o)}},divseq:function(f){var u={};return function(i,s){var o=i.dtype,a=i.order,c=[o,a.join()].join(),r=u[c];return r||(u[c]=r=f([o,a])),r(i.shape.slice(0),i.data,i.stride,0|i.offset,s)}},assign:function(f){var u={};return function(i,s){var o=i.dtype,a=i.order,c=s.dtype,r=s.order,n=[o,a.join(),c,r.join()].join(),d=u[n];return d||(u[n]=d=f([o,a,c,r])),d(i.shape.slice(0),i.data,i.stride,0|i.offset,s.data,s.stride,0|s.offset)}}};function p(f){return u={funcName:f.funcName},(0,g[u.funcName])(m.bind(void 0,u));var u}var e={mul:"*",div:"/"};(function(){for(var f in e)H[f]=p({funcName:f}),H[f+"s"]=p({funcName:f+"s"}),H[f+"seq"]=p({funcName:f+"seq"})})(),H.assign=p({funcName:"assign"})},{}],468:[function(h,N,H){var t=h("ndarray"),m=h("./doConvert.js");N.exports=function(g,p){for(var e=[],f=g,u=1;Array.isArray(f);)e.push(f.length),u*=f.length,f=f[0];return e.length===0?t():(p||(p=t(new Float64Array(u),e)),m(p,g),p)}},{"./doConvert.js":469,ndarray:472}],469:[function(h,N,H){var t,m=function(){return function(g,p,e,f,u){var i=g[0],s=g[1],o=g[2],a=e[0],c=e[1],r=e[2],n=[0,0,0];f|=0;var d=0,l=0,y=0,v=r,_=c-o*r,x=a-s*c;for(y=0;y<i;++y){for(l=0;l<s;++l){for(d=0;d<o;++d){var T,A=u;for(T=0;T<n.length-1;++T)A=A[n[T]];p[f]=A[n[n.length-1]],f+=v,++n[2]}f+=_,n[2]-=o,++n[1]}f+=x,n[1]-=s,++n[0]}}};N.exports=(t={funcName:"convert"},function(g){var p={};return function(e,f){var u=e.dtype,i=e.order,s=[u,i.join()].join(),o=p[s];return o||(p[s]=o=g([u,i])),o(e.shape.slice(0),e.data,e.stride,0|e.offset,f)}}(m.bind(void 0,t)))},{}],470:[function(h,N,H){var t=h("typedarray-pool");function m(f){switch(f){case"uint32":return[t.mallocUint32,t.freeUint32];default:return null}}var g={"uint32,1,0":function(f,u){return function(i,s,o,a,c,r,n,d,l,y,v){var _,x,T,A,S,w,L,k,C=i*c+a,M=f(d);for(_=i+1;_<=s;++_){for(x=_,T=C+=c,S=0,w=C,A=0;A<d;++A)M[S++]=o[w],w+=l;e:for(;x-- >i;){S=0,w=T-c;t:for(A=0;A<d;++A){if((L=o[w])<(k=M[S]))break e;if(L>k)break t;w+=y,S+=v}for(S=T,w=T-c,A=0;A<d;++A)o[S]=o[w],S+=l,w+=l;T-=c}for(S=T,w=0,A=0;A<d;++A)o[S]=M[w++],S+=l}u(M)}}},p={"uint32,1,0":function(f,u,i){return function s(o,a,c,r,n,d,l,y,v,_,x){var T,A,S,w,L,k,C,M,P,O,F,j,W,Z,Q,X,G,Y,K,D,B,q,ee,J,$,te=(a-o+1)/6|0,ie=o+te,ae=a-te,he=o+a>>1,se=he-te,de=he+te,ce=ie,ve=se,ke=he,Ee=de,be=ae,xe=o+1,ue=a-1,me=!0,we=0,Me=0,Se=0,De=y,Fe=u(De),Ye=u(De);F=n*ce,j=n*ve,$=r;e:for(O=0;O<y;++O){if(M=j+$,(Se=c[C=F+$]-c[M])>0){A=ce,ce=ve,ve=A;break e}if(Se<0)break e;$+=_}F=n*Ee,j=n*be,$=r;e:for(O=0;O<y;++O){if(M=j+$,(Se=c[C=F+$]-c[M])>0){A=Ee,Ee=be,be=A;break e}if(Se<0)break e;$+=_}F=n*ce,j=n*ke,$=r;e:for(O=0;O<y;++O){if(M=j+$,(Se=c[C=F+$]-c[M])>0){A=ce,ce=ke,ke=A;break e}if(Se<0)break e;$+=_}F=n*ve,j=n*ke,$=r;e:for(O=0;O<y;++O){if(M=j+$,(Se=c[C=F+$]-c[M])>0){A=ve,ve=ke,ke=A;break e}if(Se<0)break e;$+=_}F=n*ce,j=n*Ee,$=r;e:for(O=0;O<y;++O){if(M=j+$,(Se=c[C=F+$]-c[M])>0){A=ce,ce=Ee,Ee=A;break e}if(Se<0)break e;$+=_}F=n*ke,j=n*Ee,$=r;e:for(O=0;O<y;++O){if(M=j+$,(Se=c[C=F+$]-c[M])>0){A=ke,ke=Ee,Ee=A;break e}if(Se<0)break e;$+=_}F=n*ve,j=n*be,$=r;e:for(O=0;O<y;++O){if(M=j+$,(Se=c[C=F+$]-c[M])>0){A=ve,ve=be,be=A;break e}if(Se<0)break e;$+=_}F=n*ve,j=n*ke,$=r;e:for(O=0;O<y;++O){if(M=j+$,(Se=c[C=F+$]-c[M])>0){A=ve,ve=ke,ke=A;break e}if(Se<0)break e;$+=_}F=n*Ee,j=n*be,$=r;e:for(O=0;O<y;++O){if(M=j+$,(Se=c[C=F+$]-c[M])>0){A=Ee,Ee=be,be=A;break e}if(Se<0)break e;$+=_}for(F=n*ce,j=n*ve,W=n*ke,Z=n*Ee,Q=n*be,X=n*ie,G=n*he,Y=n*ae,J=0,$=r,O=0;O<y;++O)C=F+$,M=j+$,P=W+$,K=Z+$,D=Q+$,B=X+$,q=G+$,ee=Y+$,Fe[J]=c[M],Ye[J]=c[K],me=me&&Fe[J]===Ye[J],S=c[C],w=c[P],L=c[D],c[B]=S,c[q]=w,c[ee]=L,++J,$+=v;for(F=n*se,j=n*o,$=r,O=0;O<y;++O)M=j+$,c[C=F+$]=c[M],$+=v;for(F=n*de,j=n*a,$=r,O=0;O<y;++O)M=j+$,c[C=F+$]=c[M],$+=v;if(me)for(k=xe;k<=ue;++k){for(C=r+k*n,J=0,O=0;O<y&&(Se=c[C]-Fe[J])==0;++O)J+=x,C+=_;if(Se!==0)if(Se<0){if(k!==xe)for(F=n*k,j=n*xe,$=r,O=0;O<y;++O)M=j+$,T=c[C=F+$],c[C]=c[M],c[M]=T,$+=v;++xe}else for(;;){for(C=r+ue*n,J=0,O=0;O<y&&(Se=c[C]-Fe[J])==0;++O)J+=x,C+=_;if(!(Se>0)){if(Se<0){for(F=n*k,j=n*xe,W=n*ue,$=r,O=0;O<y;++O)M=j+$,P=W+$,T=c[C=F+$],c[C]=c[M],c[M]=c[P],c[P]=T,$+=v;++xe,--ue;break}for(F=n*k,j=n*ue,$=r,O=0;O<y;++O)M=j+$,T=c[C=F+$],c[C]=c[M],c[M]=T,$+=v;--ue;break}ue--}}else for(k=xe;k<=ue;++k){for(C=r+k*n,J=0,O=0;O<y&&(we=c[C]-Fe[J])==0;++O)J+=x,C+=_;if(we<0){if(k!==xe)for(F=n*k,j=n*xe,$=r,O=0;O<y;++O)M=j+$,T=c[C=F+$],c[C]=c[M],c[M]=T,$+=v;++xe}else{for(C=r+k*n,J=0,O=0;O<y&&(Me=c[C]-Ye[J])==0;++O)J+=x,C+=_;if(Me>0)for(;;){for(C=r+ue*n,J=0,O=0;O<y&&(Se=c[C]-Ye[J])==0;++O)J+=x,C+=_;if(!(Se>0)){for(C=r+ue*n,J=0,O=0;O<y&&(Se=c[C]-Fe[J])==0;++O)J+=x,C+=_;if(Se<0){for(F=n*k,j=n*xe,W=n*ue,$=r,O=0;O<y;++O)M=j+$,P=W+$,T=c[C=F+$],c[C]=c[M],c[M]=c[P],c[P]=T,$+=v;++xe,--ue}else{for(F=n*k,j=n*ue,$=r,O=0;O<y;++O)M=j+$,T=c[C=F+$],c[C]=c[M],c[M]=T,$+=v;--ue}break}if(--ue<k)break}}}for(F=n*o,j=n*(xe-1),J=0,$=r,O=0;O<y;++O)M=j+$,c[C=F+$]=c[M],c[M]=Fe[J],++J,$+=v;for(F=n*a,j=n*(ue+1),J=0,$=r,O=0;O<y;++O)M=j+$,c[C=F+$]=c[M],c[M]=Ye[J],++J,$+=v;if(xe-2-o<=32?f(o,xe-2,c,r,n,d,l,y,v,_,x):s(o,xe-2,c,r,n,d,l,y,v,_,x),a-(ue+2)<=32?f(ue+2,a,c,r,n,d,l,y,v,_,x):s(ue+2,a,c,r,n,d,l,y,v,_,x),me)return i(Fe),void i(Ye);if(xe<ie&&ue>ae){e:for(;;){for(C=r+xe*n,J=0,$=r,O=0;O<y;++O){if(c[C]!==Fe[J])break e;++J,C+=v}++xe}e:for(;;){for(C=r+ue*n,J=0,$=r,O=0;O<y;++O){if(c[C]!==Ye[J])break e;++J,C+=v}--ue}for(k=xe;k<=ue;++k){for(C=r+k*n,J=0,O=0;O<y&&(we=c[C]-Fe[J])==0;++O)J+=x,C+=_;if(we===0){if(k!==xe)for(F=n*k,j=n*xe,$=r,O=0;O<y;++O)M=j+$,T=c[C=F+$],c[C]=c[M],c[M]=T,$+=v;++xe}else{for(C=r+k*n,J=0,O=0;O<y&&(Me=c[C]-Ye[J])==0;++O)J+=x,C+=_;if(Me===0)for(;;){for(C=r+ue*n,J=0,O=0;O<y&&(Se=c[C]-Ye[J])==0;++O)J+=x,C+=_;if(Se!==0){for(C=r+ue*n,J=0,O=0;O<y&&(Se=c[C]-Fe[J])==0;++O)J+=x,C+=_;if(Se<0){for(F=n*k,j=n*xe,W=n*ue,$=r,O=0;O<y;++O)M=j+$,P=W+$,T=c[C=F+$],c[C]=c[M],c[M]=c[P],c[P]=T,$+=v;++xe,--ue}else{for(F=n*k,j=n*ue,$=r,O=0;O<y;++O)M=j+$,T=c[C=F+$],c[C]=c[M],c[M]=T,$+=v;--ue}break}if(--ue<k)break}}}}i(Fe),i(Ye),ue-xe<=32?f(xe,ue,c,r,n,d,l,y,v,_,x):s(xe,ue,c,r,n,d,l,y,v,_,x)}}},e={"uint32,1,0":function(f,u){return function(i){var s=i.data,o=0|i.offset,a=i.shape,c=i.stride,r=0|c[0],n=0|a[0],d=0|c[1],l=0|a[1],y=d,v=d;n<=32?f(0,n-1,s,o,r,d,n,l,y,v,1):u(0,n-1,s,o,r,d,n,l,y,v,1)}}};N.exports=function(f,u){var i=[u,f].join(","),s=e[i],o=function(c,r){var n=m(r),d=[r,c].join(","),l=g[d];return n?l(n[0],n[1]):l()}(f,u),a=function(c,r,n){var d=m(r),l=[r,c].join(","),y=p[l];return c.length>1&&d?y(n,d[0],d[1]):y(n)}(f,u,o);return s(o,a)}},{"typedarray-pool":601}],471:[function(h,N,H){var t=h("./lib/compile_sort.js"),m={};N.exports=function(g){var p=g.order,e=g.dtype,f=[p,e].join(":"),u=m[f];return u||(m[f]=u=t(p,e)),u(g),g}},{"./lib/compile_sort.js":470}],472:[function(h,N,H){var t=h("is-buffer"),m=typeof Float64Array!="undefined";function g(i,s){return i[0]-s[0]}function p(){var i,s=this.stride,o=new Array(s.length);for(i=0;i<o.length;++i)o[i]=[Math.abs(s[i]),i];o.sort(g);var a=new Array(o.length);for(i=0;i<a.length;++i)a[i]=o[i][1];return a}var e={T:function(i){function s(a){this.data=a}var o=s.prototype;return o.dtype=i,o.index=function(){return-1},o.size=0,o.dimension=-1,o.shape=o.stride=o.order=[],o.lo=o.hi=o.transpose=o.step=function(){return new s(this.data)},o.get=o.set=function(){},o.pick=function(){return null},function(a){return new s(a)}},0:function(i,s){function o(c,r){this.data=c,this.offset=r}var a=o.prototype;return a.dtype=i,a.index=function(){return this.offset},a.dimension=0,a.size=1,a.shape=a.stride=a.order=[],a.lo=a.hi=a.transpose=a.step=function(){return new o(this.data,this.offset)},a.pick=function(){return s(this.data)},a.valueOf=a.get=function(){return i==="generic"?this.data.get(this.offset):this.data[this.offset]},a.set=function(c){return i==="generic"?this.data.set(this.offset,c):this.data[this.offset]=c},function(c,r,n,d){return new o(c,d)}},1:function(i,s,o){function a(r,n,d,l){this.data=r,this.shape=[n],this.stride=[d],this.offset=0|l}var c=a.prototype;return c.dtype=i,c.dimension=1,Object.defineProperty(c,"size",{get:function(){return this.shape[0]}}),c.order=[0],c.set=function(r,n){return i==="generic"?this.data.set(this.offset+this.stride[0]*r,n):this.data[this.offset+this.stride[0]*r]=n},c.get=function(r){return i==="generic"?this.data.get(this.offset+this.stride[0]*r):this.data[this.offset+this.stride[0]*r]},c.index=function(r){return this.offset+this.stride[0]*r},c.hi=function(r){return new a(this.data,typeof r!="number"||r<0?this.shape[0]:0|r,this.stride[0],this.offset)},c.lo=function(r){var n=this.offset,d=0,l=this.shape[0],y=this.stride[0];return typeof r=="number"&&r>=0&&(n+=y*(d=0|r),l-=d),new a(this.data,l,y,n)},c.step=function(r){var n=this.shape[0],d=this.stride[0],l=this.offset,y=0,v=Math.ceil;return typeof r=="number"&&((y=0|r)<0?(l+=d*(n-1),n=v(-n/y)):n=v(n/y),d*=y),new a(this.data,n,d,l)},c.transpose=function(r){r=r===void 0?0:0|r;var n=this.shape,d=this.stride;return new a(this.data,n[r],d[r],this.offset)},c.pick=function(r){var n=[],d=[],l=this.offset;return typeof r=="number"&&r>=0?l=l+this.stride[0]*r|0:(n.push(this.shape[0]),d.push(this.stride[0])),(0,s[n.length+1])(this.data,n,d,l)},function(r,n,d,l){return new a(r,n[0],d[0],l)}},2:function(i,s,o){function a(r,n,d,l,y,v){this.data=r,this.shape=[n,d],this.stride=[l,y],this.offset=0|v}var c=a.prototype;return c.dtype=i,c.dimension=2,Object.defineProperty(c,"size",{get:function(){return this.shape[0]*this.shape[1]}}),Object.defineProperty(c,"order",{get:function(){return Math.abs(this.stride[0])>Math.abs(this.stride[1])?[1,0]:[0,1]}}),c.set=function(r,n,d){return i==="generic"?this.data.set(this.offset+this.stride[0]*r+this.stride[1]*n,d):this.data[this.offset+this.stride[0]*r+this.stride[1]*n]=d},c.get=function(r,n){return i==="generic"?this.data.get(this.offset+this.stride[0]*r+this.stride[1]*n):this.data[this.offset+this.stride[0]*r+this.stride[1]*n]},c.index=function(r,n){return this.offset+this.stride[0]*r+this.stride[1]*n},c.hi=function(r,n){return new a(this.data,typeof r!="number"||r<0?this.shape[0]:0|r,typeof n!="number"||n<0?this.shape[1]:0|n,this.stride[0],this.stride[1],this.offset)},c.lo=function(r,n){var d=this.offset,l=0,y=this.shape[0],v=this.shape[1],_=this.stride[0],x=this.stride[1];return typeof r=="number"&&r>=0&&(d+=_*(l=0|r),y-=l),typeof n=="number"&&n>=0&&(d+=x*(l=0|n),v-=l),new a(this.data,y,v,_,x,d)},c.step=function(r,n){var d=this.shape[0],l=this.shape[1],y=this.stride[0],v=this.stride[1],_=this.offset,x=0,T=Math.ceil;return typeof r=="number"&&((x=0|r)<0?(_+=y*(d-1),d=T(-d/x)):d=T(d/x),y*=x),typeof n=="number"&&((x=0|n)<0?(_+=v*(l-1),l=T(-l/x)):l=T(l/x),v*=x),new a(this.data,d,l,y,v,_)},c.transpose=function(r,n){r=r===void 0?0:0|r,n=n===void 0?1:0|n;var d=this.shape,l=this.stride;return new a(this.data,d[r],d[n],l[r],l[n],this.offset)},c.pick=function(r,n){var d=[],l=[],y=this.offset;return typeof r=="number"&&r>=0?y=y+this.stride[0]*r|0:(d.push(this.shape[0]),l.push(this.stride[0])),typeof n=="number"&&n>=0?y=y+this.stride[1]*n|0:(d.push(this.shape[1]),l.push(this.stride[1])),(0,s[d.length+1])(this.data,d,l,y)},function(r,n,d,l){return new a(r,n[0],n[1],d[0],d[1],l)}},3:function(i,s,o){function a(r,n,d,l,y,v,_,x){this.data=r,this.shape=[n,d,l],this.stride=[y,v,_],this.offset=0|x}var c=a.prototype;return c.dtype=i,c.dimension=3,Object.defineProperty(c,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]}}),Object.defineProperty(c,"order",{get:function(){var r=Math.abs(this.stride[0]),n=Math.abs(this.stride[1]),d=Math.abs(this.stride[2]);return r>n?n>d?[2,1,0]:r>d?[1,2,0]:[1,0,2]:r>d?[2,0,1]:d>n?[0,1,2]:[0,2,1]}}),c.set=function(r,n,d,l){return i==="generic"?this.data.set(this.offset+this.stride[0]*r+this.stride[1]*n+this.stride[2]*d,l):this.data[this.offset+this.stride[0]*r+this.stride[1]*n+this.stride[2]*d]=l},c.get=function(r,n,d){return i==="generic"?this.data.get(this.offset+this.stride[0]*r+this.stride[1]*n+this.stride[2]*d):this.data[this.offset+this.stride[0]*r+this.stride[1]*n+this.stride[2]*d]},c.index=function(r,n,d){return this.offset+this.stride[0]*r+this.stride[1]*n+this.stride[2]*d},c.hi=function(r,n,d){return new a(this.data,typeof r!="number"||r<0?this.shape[0]:0|r,typeof n!="number"||n<0?this.shape[1]:0|n,typeof d!="number"||d<0?this.shape[2]:0|d,this.stride[0],this.stride[1],this.stride[2],this.offset)},c.lo=function(r,n,d){var l=this.offset,y=0,v=this.shape[0],_=this.shape[1],x=this.shape[2],T=this.stride[0],A=this.stride[1],S=this.stride[2];return typeof r=="number"&&r>=0&&(l+=T*(y=0|r),v-=y),typeof n=="number"&&n>=0&&(l+=A*(y=0|n),_-=y),typeof d=="number"&&d>=0&&(l+=S*(y=0|d),x-=y),new a(this.data,v,_,x,T,A,S,l)},c.step=function(r,n,d){var l=this.shape[0],y=this.shape[1],v=this.shape[2],_=this.stride[0],x=this.stride[1],T=this.stride[2],A=this.offset,S=0,w=Math.ceil;return typeof r=="number"&&((S=0|r)<0?(A+=_*(l-1),l=w(-l/S)):l=w(l/S),_*=S),typeof n=="number"&&((S=0|n)<0?(A+=x*(y-1),y=w(-y/S)):y=w(y/S),x*=S),typeof d=="number"&&((S=0|d)<0?(A+=T*(v-1),v=w(-v/S)):v=w(v/S),T*=S),new a(this.data,l,y,v,_,x,T,A)},c.transpose=function(r,n,d){r=r===void 0?0:0|r,n=n===void 0?1:0|n,d=d===void 0?2:0|d;var l=this.shape,y=this.stride;return new a(this.data,l[r],l[n],l[d],y[r],y[n],y[d],this.offset)},c.pick=function(r,n,d){var l=[],y=[],v=this.offset;return typeof r=="number"&&r>=0?v=v+this.stride[0]*r|0:(l.push(this.shape[0]),y.push(this.stride[0])),typeof n=="number"&&n>=0?v=v+this.stride[1]*n|0:(l.push(this.shape[1]),y.push(this.stride[1])),typeof d=="number"&&d>=0?v=v+this.stride[2]*d|0:(l.push(this.shape[2]),y.push(this.stride[2])),(0,s[l.length+1])(this.data,l,y,v)},function(r,n,d,l){return new a(r,n[0],n[1],n[2],d[0],d[1],d[2],l)}},4:function(i,s,o){function a(r,n,d,l,y,v,_,x,T,A){this.data=r,this.shape=[n,d,l,y],this.stride=[v,_,x,T],this.offset=0|A}var c=a.prototype;return c.dtype=i,c.dimension=4,Object.defineProperty(c,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]*this.shape[3]}}),Object.defineProperty(c,"order",{get:o}),c.set=function(r,n,d,l,y){return i==="generic"?this.data.set(this.offset+this.stride[0]*r+this.stride[1]*n+this.stride[2]*d+this.stride[3]*l,y):this.data[this.offset+this.stride[0]*r+this.stride[1]*n+this.stride[2]*d+this.stride[3]*l]=y},c.get=function(r,n,d,l){return i==="generic"?this.data.get(this.offset+this.stride[0]*r+this.stride[1]*n+this.stride[2]*d+this.stride[3]*l):this.data[this.offset+this.stride[0]*r+this.stride[1]*n+this.stride[2]*d+this.stride[3]*l]},c.index=function(r,n,d,l){return this.offset+this.stride[0]*r+this.stride[1]*n+this.stride[2]*d+this.stride[3]*l},c.hi=function(r,n,d,l){return new a(this.data,typeof r!="number"||r<0?this.shape[0]:0|r,typeof n!="number"||n<0?this.shape[1]:0|n,typeof d!="number"||d<0?this.shape[2]:0|d,typeof l!="number"||l<0?this.shape[3]:0|l,this.stride[0],this.stride[1],this.stride[2],this.stride[3],this.offset)},c.lo=function(r,n,d,l){var y=this.offset,v=0,_=this.shape[0],x=this.shape[1],T=this.shape[2],A=this.shape[3],S=this.stride[0],w=this.stride[1],L=this.stride[2],k=this.stride[3];return typeof r=="number"&&r>=0&&(y+=S*(v=0|r),_-=v),typeof n=="number"&&n>=0&&(y+=w*(v=0|n),x-=v),typeof d=="number"&&d>=0&&(y+=L*(v=0|d),T-=v),typeof l=="number"&&l>=0&&(y+=k*(v=0|l),A-=v),new a(this.data,_,x,T,A,S,w,L,k,y)},c.step=function(r,n,d,l){var y=this.shape[0],v=this.shape[1],_=this.shape[2],x=this.shape[3],T=this.stride[0],A=this.stride[1],S=this.stride[2],w=this.stride[3],L=this.offset,k=0,C=Math.ceil;return typeof r=="number"&&((k=0|r)<0?(L+=T*(y-1),y=C(-y/k)):y=C(y/k),T*=k),typeof n=="number"&&((k=0|n)<0?(L+=A*(v-1),v=C(-v/k)):v=C(v/k),A*=k),typeof d=="number"&&((k=0|d)<0?(L+=S*(_-1),_=C(-_/k)):_=C(_/k),S*=k),typeof l=="number"&&((k=0|l)<0?(L+=w*(x-1),x=C(-x/k)):x=C(x/k),w*=k),new a(this.data,y,v,_,x,T,A,S,w,L)},c.transpose=function(r,n,d,l){r=r===void 0?0:0|r,n=n===void 0?1:0|n,d=d===void 0?2:0|d,l=l===void 0?3:0|l;var y=this.shape,v=this.stride;return new a(this.data,y[r],y[n],y[d],y[l],v[r],v[n],v[d],v[l],this.offset)},c.pick=function(r,n,d,l){var y=[],v=[],_=this.offset;return typeof r=="number"&&r>=0?_=_+this.stride[0]*r|0:(y.push(this.shape[0]),v.push(this.stride[0])),typeof n=="number"&&n>=0?_=_+this.stride[1]*n|0:(y.push(this.shape[1]),v.push(this.stride[1])),typeof d=="number"&&d>=0?_=_+this.stride[2]*d|0:(y.push(this.shape[2]),v.push(this.stride[2])),typeof l=="number"&&l>=0?_=_+this.stride[3]*l|0:(y.push(this.shape[3]),v.push(this.stride[3])),(0,s[y.length+1])(this.data,y,v,_)},function(r,n,d,l){return new a(r,n[0],n[1],n[2],n[3],d[0],d[1],d[2],d[3],l)}},5:function(i,s,o){function a(r,n,d,l,y,v,_,x,T,A,S,w){this.data=r,this.shape=[n,d,l,y,v],this.stride=[_,x,T,A,S],this.offset=0|w}var c=a.prototype;return c.dtype=i,c.dimension=5,Object.defineProperty(c,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]*this.shape[3]*this.shape[4]}}),Object.defineProperty(c,"order",{get:o}),c.set=function(r,n,d,l,y,v){return i==="generic"?this.data.set(this.offset+this.stride[0]*r+this.stride[1]*n+this.stride[2]*d+this.stride[3]*l+this.stride[4]*y,v):this.data[this.offset+this.stride[0]*r+this.stride[1]*n+this.stride[2]*d+this.stride[3]*l+this.stride[4]*y]=v},c.get=function(r,n,d,l,y){return i==="generic"?this.data.get(this.offset+this.stride[0]*r+this.stride[1]*n+this.stride[2]*d+this.stride[3]*l+this.stride[4]*y):this.data[this.offset+this.stride[0]*r+this.stride[1]*n+this.stride[2]*d+this.stride[3]*l+this.stride[4]*y]},c.index=function(r,n,d,l,y){return this.offset+this.stride[0]*r+this.stride[1]*n+this.stride[2]*d+this.stride[3]*l+this.stride[4]*y},c.hi=function(r,n,d,l,y){return new a(this.data,typeof r!="number"||r<0?this.shape[0]:0|r,typeof n!="number"||n<0?this.shape[1]:0|n,typeof d!="number"||d<0?this.shape[2]:0|d,typeof l!="number"||l<0?this.shape[3]:0|l,typeof y!="number"||y<0?this.shape[4]:0|y,this.stride[0],this.stride[1],this.stride[2],this.stride[3],this.stride[4],this.offset)},c.lo=function(r,n,d,l,y){var v=this.offset,_=0,x=this.shape[0],T=this.shape[1],A=this.shape[2],S=this.shape[3],w=this.shape[4],L=this.stride[0],k=this.stride[1],C=this.stride[2],M=this.stride[3],P=this.stride[4];return typeof r=="number"&&r>=0&&(v+=L*(_=0|r),x-=_),typeof n=="number"&&n>=0&&(v+=k*(_=0|n),T-=_),typeof d=="number"&&d>=0&&(v+=C*(_=0|d),A-=_),typeof l=="number"&&l>=0&&(v+=M*(_=0|l),S-=_),typeof y=="number"&&y>=0&&(v+=P*(_=0|y),w-=_),new a(this.data,x,T,A,S,w,L,k,C,M,P,v)},c.step=function(r,n,d,l,y){var v=this.shape[0],_=this.shape[1],x=this.shape[2],T=this.shape[3],A=this.shape[4],S=this.stride[0],w=this.stride[1],L=this.stride[2],k=this.stride[3],C=this.stride[4],M=this.offset,P=0,O=Math.ceil;return typeof r=="number"&&((P=0|r)<0?(M+=S*(v-1),v=O(-v/P)):v=O(v/P),S*=P),typeof n=="number"&&((P=0|n)<0?(M+=w*(_-1),_=O(-_/P)):_=O(_/P),w*=P),typeof d=="number"&&((P=0|d)<0?(M+=L*(x-1),x=O(-x/P)):x=O(x/P),L*=P),typeof l=="number"&&((P=0|l)<0?(M+=k*(T-1),T=O(-T/P)):T=O(T/P),k*=P),typeof y=="number"&&((P=0|y)<0?(M+=C*(A-1),A=O(-A/P)):A=O(A/P),C*=P),new a(this.data,v,_,x,T,A,S,w,L,k,C,M)},c.transpose=function(r,n,d,l,y){r=r===void 0?0:0|r,n=n===void 0?1:0|n,d=d===void 0?2:0|d,l=l===void 0?3:0|l,y=y===void 0?4:0|y;var v=this.shape,_=this.stride;return new a(this.data,v[r],v[n],v[d],v[l],v[y],_[r],_[n],_[d],_[l],_[y],this.offset)},c.pick=function(r,n,d,l,y){var v=[],_=[],x=this.offset;return typeof r=="number"&&r>=0?x=x+this.stride[0]*r|0:(v.push(this.shape[0]),_.push(this.stride[0])),typeof n=="number"&&n>=0?x=x+this.stride[1]*n|0:(v.push(this.shape[1]),_.push(this.stride[1])),typeof d=="number"&&d>=0?x=x+this.stride[2]*d|0:(v.push(this.shape[2]),_.push(this.stride[2])),typeof l=="number"&&l>=0?x=x+this.stride[3]*l|0:(v.push(this.shape[3]),_.push(this.stride[3])),typeof y=="number"&&y>=0?x=x+this.stride[4]*y|0:(v.push(this.shape[4]),_.push(this.stride[4])),(0,s[v.length+1])(this.data,v,_,x)},function(r,n,d,l){return new a(r,n[0],n[1],n[2],n[3],n[4],d[0],d[1],d[2],d[3],d[4],l)}}};function f(i,s){var o=s===-1?"T":String(s),a=e[o];return s===-1?a(i):s===0?a(i,u[i][0]):a(i,u[i],p)}var u={generic:[],buffer:[],array:[],float32:[],float64:[],int8:[],int16:[],int32:[],uint8_clamped:[],uint8:[],uint16:[],uint32:[],bigint64:[],biguint64:[]};N.exports=function(i,s,o,a){if(i===void 0)return(0,u.array[0])([]);typeof i=="number"&&(i=[i]),s===void 0&&(s=[i.length]);var c=s.length;if(o===void 0){o=new Array(c);for(var r=c-1,n=1;r>=0;--r)o[r]=n,n*=s[r]}if(a===void 0)for(a=0,r=0;r<c;++r)o[r]<0&&(a-=(s[r]-1)*o[r]);for(var d=function(y){if(t(y))return"buffer";if(m)switch(Object.prototype.toString.call(y)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(y)?"array":"generic"}(i),l=u[d];l.length<=c+1;)l.push(f(d,l.length-1));return(0,l[c+1])(i,s,o,a)}},{"is-buffer":443}],473:[function(h,N,H){var t=h("double-bits"),m=Math.pow(2,-1074);N.exports=function(g,p){if(isNaN(g)||isNaN(p))return NaN;if(g===p)return g;if(g===0)return p<0?-m:m;var e=t.hi(g),f=t.lo(g);return p>g==g>0?f===-1>>>0?(e+=1,f=0):f+=1:f===0?(f=-1>>>0,e-=1):f-=1,t.pack(f,e)}},{"double-bits":179}],474:[function(h,N,H){var t=Math.PI,m=u(120);function g(i,s,o,a){return["C",i,s,o,a,o,a]}function p(i,s,o,a,c,r){return["C",i/3+2/3*o,s/3+2/3*a,c/3+2/3*o,r/3+2/3*a,c,r]}function e(i,s,o,a,c,r,n,d,l,y){if(y)C=y[0],M=y[1],L=y[2],k=y[3];else{var v=f(i,s,-c);i=v.x,s=v.y;var _=(i-(d=(v=f(d,l,-c)).x))/2,x=(s-(l=v.y))/2,T=_*_/(o*o)+x*x/(a*a);T>1&&(o*=T=Math.sqrt(T),a*=T);var A=o*o,S=a*a,w=(r==n?-1:1)*Math.sqrt(Math.abs((A*S-A*x*x-S*_*_)/(A*x*x+S*_*_)));w==1/0&&(w=1);var L=w*o*x/a+(i+d)/2,k=w*-a*_/o+(s+l)/2,C=Math.asin(((s-k)/a).toFixed(9)),M=Math.asin(((l-k)/a).toFixed(9));(C=i<L?t-C:C)<0&&(C=2*t+C),(M=d<L?t-M:M)<0&&(M=2*t+M),n&&C>M&&(C-=2*t),!n&&M>C&&(M-=2*t)}if(Math.abs(M-C)>m){var P=M,O=d,F=l;M=C+m*(n&&M>C?1:-1);var j=e(d=L+o*Math.cos(M),l=k+a*Math.sin(M),o,a,c,0,n,O,F,[M,P,L,k])}var W=Math.tan((M-C)/4),Z=4/3*o*W,Q=4/3*a*W,X=[2*i-(i+Z*Math.sin(C)),2*s-(s-Q*Math.cos(C)),d+Z*Math.sin(M),l-Q*Math.cos(M),d,l];if(y)return X;j&&(X=X.concat(j));for(var G=0;G<X.length;){var Y=f(X[G],X[G+1],c);X[G++]=Y.x,X[G++]=Y.y}return X}function f(i,s,o){return{x:i*Math.cos(o)-s*Math.sin(o),y:i*Math.sin(o)+s*Math.cos(o)}}function u(i){return i*(t/180)}N.exports=function(i){for(var s,o=[],a=0,c=0,r=0,n=0,d=null,l=null,y=0,v=0,_=0,x=i.length;_<x;_++){var T=i[_],A=T[0];switch(A){case"M":r=T[1],n=T[2];break;case"A":(T=e(y,v,T[1],T[2],u(T[3]),T[4],T[5],T[6],T[7])).unshift("C"),T.length>7&&(o.push(T.splice(0,7)),T.unshift("C"));break;case"S":var S=y,w=v;s!="C"&&s!="S"||(S+=S-a,w+=w-c),T=["C",S,w,T[1],T[2],T[3],T[4]];break;case"T":s=="Q"||s=="T"?(d=2*y-d,l=2*v-l):(d=y,l=v),T=p(y,v,d,l,T[1],T[2]);break;case"Q":d=T[1],l=T[2],T=p(y,v,T[1],T[2],T[3],T[4]);break;case"L":T=g(y,v,T[1],T[2]);break;case"H":T=g(y,v,T[1],v);break;case"V":T=g(y,v,y,T[1]);break;case"Z":T=g(y,v,r,n)}s=A,y=T[T.length-2],v=T[T.length-1],T.length>4?(a=T[T.length-4],c=T[T.length-3]):(a=y,c=v),o.push(T)}return o}},{}],475:[function(h,N,H){H.vertexNormals=function(t,m,g){for(var p=m.length,e=new Array(p),f=g===void 0?1e-6:g,u=0;u<p;++u)e[u]=[0,0,0];for(u=0;u<t.length;++u)for(var i=t[u],s=0,o=i[i.length-1],a=i[0],c=0;c<i.length;++c){s=o,o=a,a=i[(c+1)%i.length];for(var r=m[s],n=m[o],d=m[a],l=new Array(3),y=0,v=new Array(3),_=0,x=0;x<3;++x)l[x]=r[x]-n[x],y+=l[x]*l[x],v[x]=d[x]-n[x],_+=v[x]*v[x];if(y*_>f){var T=e[o],A=1/Math.sqrt(y*_);for(x=0;x<3;++x){var S=(x+1)%3,w=(x+2)%3;T[x]+=A*(v[S]*l[w]-v[w]*l[S])}}}for(u=0;u<p;++u){T=e[u];var L=0;for(x=0;x<3;++x)L+=T[x]*T[x];if(L>f)for(A=1/Math.sqrt(L),x=0;x<3;++x)T[x]*=A;else for(x=0;x<3;++x)T[x]=0}return e},H.faceNormals=function(t,m,g){for(var p=t.length,e=new Array(p),f=g===void 0?1e-6:g,u=0;u<p;++u){for(var i=t[u],s=new Array(3),o=0;o<3;++o)s[o]=m[i[o]];var a=new Array(3),c=new Array(3);for(o=0;o<3;++o)a[o]=s[1][o]-s[0][o],c[o]=s[2][o]-s[0][o];var r=new Array(3),n=0;for(o=0;o<3;++o){var d=(o+1)%3,l=(o+2)%3;r[o]=a[d]*c[l]-a[l]*c[d],n+=r[o]*r[o]}for(n=n>f?1/Math.sqrt(n):0,o=0;o<3;++o)r[o]*=n;e[u]=r}return e}},{}],476:[function(h,N,H){var t=Object.getOwnPropertySymbols,m=Object.prototype.hasOwnProperty,g=Object.prototype.propertyIsEnumerable;function p(e){if(e==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}N.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de",Object.getOwnPropertyNames(e)[0]==="5")return!1;for(var f={},u=0;u<10;u++)f["_"+String.fromCharCode(u)]=u;if(Object.getOwnPropertyNames(f).map(function(s){return f[s]}).join("")!=="0123456789")return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(s){i[s]=s}),Object.keys(Object.assign({},i)).join("")==="abcdefghijklmnopqrst"}catch(s){return!1}}()?Object.assign:function(e,f){for(var u,i,s=p(e),o=1;o<arguments.length;o++){for(var a in u=Object(arguments[o]))m.call(u,a)&&(s[a]=u[a]);if(t){i=t(u);for(var c=0;c<i.length;c++)g.call(u,i[c])&&(s[i[c]]=u[i[c]])}}return s}},{}],477:[function(h,N,H){N.exports=function(t,m,g,p,e,f,u,i,s,o){var a=m+f+o;if(c>0){var c=Math.sqrt(a+1);t[0]=.5*(u-s)/c,t[1]=.5*(i-p)/c,t[2]=.5*(g-f)/c,t[3]=.5*c}else{var r=Math.max(m,f,o);c=Math.sqrt(2*r-a+1),m>=r?(t[0]=.5*c,t[1]=.5*(e+g)/c,t[2]=.5*(i+p)/c,t[3]=.5*(u-s)/c):f>=r?(t[0]=.5*(g+e)/c,t[1]=.5*c,t[2]=.5*(s+u)/c,t[3]=.5*(i-p)/c):(t[0]=.5*(p+i)/c,t[1]=.5*(u+s)/c,t[2]=.5*c,t[3]=.5*(g-e)/c)}return t}},{}],478:[function(h,N,H){N.exports=function(a){var c=(a=a||{}).center||[0,0,0],r=a.rotation||[0,0,0,1],n=a.radius||1;c=[].slice.call(c,0,3),i(r=[].slice.call(r,0,4),r);var d=new s(r,c,Math.log(n));return d.setDistanceLimits(a.zoomMin,a.zoomMax),("eye"in a||"up"in a)&&d.lookAt(0,a.eye,a.center,a.up),d};var t=h("filtered-vector"),m=h("gl-mat4/lookAt"),g=h("gl-mat4/fromQuat"),p=h("gl-mat4/invert"),e=h("./lib/quatFromFrame");function f(a,c,r){return Math.sqrt(Math.pow(a,2)+Math.pow(c,2)+Math.pow(r,2))}function u(a,c,r,n){return Math.sqrt(Math.pow(a,2)+Math.pow(c,2)+Math.pow(r,2)+Math.pow(n,2))}function i(a,c){var r=c[0],n=c[1],d=c[2],l=c[3],y=u(r,n,d,l);y>1e-6?(a[0]=r/y,a[1]=n/y,a[2]=d/y,a[3]=l/y):(a[0]=a[1]=a[2]=0,a[3]=1)}function s(a,c,r){this.radius=t([r]),this.center=t(c),this.rotation=t(a),this.computedRadius=this.radius.curve(0),this.computedCenter=this.center.curve(0),this.computedRotation=this.rotation.curve(0),this.computedUp=[.1,0,0],this.computedEye=[.1,0,0],this.computedMatrix=[.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.recalcMatrix(0)}var o=s.prototype;o.lastT=function(){return Math.max(this.radius.lastT(),this.center.lastT(),this.rotation.lastT())},o.recalcMatrix=function(a){this.radius.curve(a),this.center.curve(a),this.rotation.curve(a);var c=this.computedRotation;i(c,c);var r=this.computedMatrix;g(r,c);var n=this.computedCenter,d=this.computedEye,l=this.computedUp,y=Math.exp(this.computedRadius[0]);d[0]=n[0]+y*r[2],d[1]=n[1]+y*r[6],d[2]=n[2]+y*r[10],l[0]=r[1],l[1]=r[5],l[2]=r[9];for(var v=0;v<3;++v){for(var _=0,x=0;x<3;++x)_+=r[v+4*x]*d[x];r[12+v]=-_}},o.getMatrix=function(a,c){this.recalcMatrix(a);var r=this.computedMatrix;if(c){for(var n=0;n<16;++n)c[n]=r[n];return c}return r},o.idle=function(a){this.center.idle(a),this.radius.idle(a),this.rotation.idle(a)},o.flush=function(a){this.center.flush(a),this.radius.flush(a),this.rotation.flush(a)},o.pan=function(a,c,r,n){c=c||0,r=r||0,n=n||0,this.recalcMatrix(a);var d=this.computedMatrix,l=d[1],y=d[5],v=d[9],_=f(l,y,v);l/=_,y/=_,v/=_;var x=d[0],T=d[4],A=d[8],S=x*l+T*y+A*v,w=f(x-=l*S,T-=y*S,A-=v*S);x/=w,T/=w,A/=w,d[2],d[6],d[10];var L=x*c+l*r,k=T*c+y*r,C=A*c+v*r;this.center.move(a,L,k,C);var M=Math.exp(this.computedRadius[0]);M=Math.max(1e-4,M+n),this.radius.set(a,Math.log(M))},o.rotate=function(a,c,r,n){this.recalcMatrix(a),c=c||0,r=r||0;var d=this.computedMatrix,l=d[0],y=d[4],v=d[8],_=d[1],x=d[5],T=d[9],A=d[2],S=d[6],w=d[10],L=c*l+r*_,k=c*y+r*x,C=c*v+r*T,M=-(S*C-w*k),P=-(w*L-A*C),O=-(A*k-S*L),F=Math.sqrt(Math.max(0,1-Math.pow(M,2)-Math.pow(P,2)-Math.pow(O,2))),j=u(M,P,O,F);j>1e-6?(M/=j,P/=j,O/=j,F/=j):(M=P=O=0,F=1);var W=this.computedRotation,Z=W[0],Q=W[1],X=W[2],G=W[3],Y=Z*F+G*M+Q*O-X*P,K=Q*F+G*P+X*M-Z*O,D=X*F+G*O+Z*P-Q*M,B=G*F-Z*M-Q*P-X*O;if(n){M=A,P=S,O=w;var q=Math.sin(n)/f(M,P,O);M*=q,P*=q,O*=q,B=B*(F=Math.cos(c))-(Y=Y*F+B*M+K*O-D*P)*M-(K=K*F+B*P+D*M-Y*O)*P-(D=D*F+B*O+Y*P-K*M)*O}var ee=u(Y,K,D,B);ee>1e-6?(Y/=ee,K/=ee,D/=ee,B/=ee):(Y=K=D=0,B=1),this.rotation.set(a,Y,K,D,B)},o.lookAt=function(a,c,r,n){this.recalcMatrix(a),r=r||this.computedCenter,c=c||this.computedEye,n=n||this.computedUp;var d=this.computedMatrix;m(d,c,r,n);var l=this.computedRotation;e(l,d[0],d[1],d[2],d[4],d[5],d[6],d[8],d[9],d[10]),i(l,l),this.rotation.set(a,l[0],l[1],l[2],l[3]);for(var y=0,v=0;v<3;++v)y+=Math.pow(r[v]-c[v],2);this.radius.set(a,.5*Math.log(Math.max(y,1e-6))),this.center.set(a,r[0],r[1],r[2])},o.translate=function(a,c,r,n){this.center.move(a,c||0,r||0,n||0)},o.setMatrix=function(a,c){var r=this.computedRotation;e(r,c[0],c[1],c[2],c[4],c[5],c[6],c[8],c[9],c[10]),i(r,r),this.rotation.set(a,r[0],r[1],r[2],r[3]);var n=this.computedMatrix;p(n,c);var d=n[15];if(Math.abs(d)>1e-6){var l=n[12]/d,y=n[13]/d,v=n[14]/d;this.recalcMatrix(a);var _=Math.exp(this.computedRadius[0]);this.center.set(a,l-n[2]*_,y-n[6]*_,v-n[10]*_),this.radius.idle(a)}else this.center.idle(a),this.radius.idle(a)},o.setDistance=function(a,c){c>0&&this.radius.set(a,Math.log(c))},o.setDistanceLimits=function(a,c){a=a>0?Math.log(a):-1/0,c=c>0?Math.log(c):1/0,c=Math.max(c,a),this.radius.bounds[0][0]=a,this.radius.bounds[1][0]=c},o.getDistanceLimits=function(a){var c=this.radius.bounds;return a?(a[0]=Math.exp(c[0][0]),a[1]=Math.exp(c[1][0]),a):[Math.exp(c[0][0]),Math.exp(c[1][0])]},o.toJSON=function(){return this.recalcMatrix(this.lastT()),{center:this.computedCenter.slice(),rotation:this.computedRotation.slice(),distance:Math.log(this.computedRadius[0]),zoomMin:this.radius.bounds[0][0],zoomMax:this.radius.bounds[1][0]}},o.fromJSON=function(a){var c=this.lastT(),r=a.center;r&&this.center.set(c,r[0],r[1],r[2]);var n=a.rotation;n&&this.rotation.set(c,n[0],n[1],n[2],n[3]);var d=a.distance;d&&d>0&&this.radius.set(c,Math.log(d)),this.setDistanceLimits(a.zoomMin,a.zoomMax)}},{"./lib/quatFromFrame":477,"filtered-vector":247,"gl-mat4/fromQuat":282,"gl-mat4/invert":293,"gl-mat4/lookAt":294}],479:[function(h,N,H){var t=h("repeat-string");N.exports=function(m,g,p){return t(p=p!==void 0?p+"":" ",g)+m}},{"repeat-string":527}],480:[function(h,N,H){function t(p,e){if(typeof p!="string")return[p];var f=[p];typeof e=="string"||Array.isArray(e)?e={brackets:e}:e||(e={});var u=e.brackets?Array.isArray(e.brackets)?e.brackets:[e.brackets]:["{}","[]","()"],i=e.escape||"___",s=!!e.flat;u.forEach(function(a){var c=new RegExp(["\\",a[0],"[^\\",a[0],"\\",a[1],"]*\\",a[1]].join("")),r=[];function n(d,l,y){var v=f.push(d.slice(a[0].length,-a[1].length))-1;return r.push(v),i+v+i}f.forEach(function(d,l){for(var y,v=0;d!=y;)if(y=d,d=d.replace(c,n),v++>1e4)throw Error("References have circular dependency. Please, check them.");f[l]=d}),r=r.reverse(),f=f.map(function(d){return r.forEach(function(l){d=d.replace(new RegExp("(\\"+i+l+"\\"+i+")","g"),a[0]+"$1"+a[1])}),d})});var o=new RegExp("\\"+i+"([0-9]+)\\"+i);return s?f:function a(c,r,n){for(var d,l=[],y=0;d=o.exec(c);){if(y++>1e4)throw Error("Circular references in parenthesis");l.push(c.slice(0,d.index)),l.push(a(r[d[1]],r)),c=c.slice(d.index+d[0].length)}return l.push(c),l}(f[0],f)}function m(p,e){if(e&&e.flat){var f,u=e&&e.escape||"___",i=p[0];if(!i)return"";for(var s=new RegExp("\\"+u+"([0-9]+)\\"+u),o=0;i!=f;){if(o++>1e4)throw Error("Circular references in "+p);f=i,i=i.replace(s,a)}return i}return p.reduce(function c(r,n){return Array.isArray(n)&&(n=n.reduce(c,"")),r+n},"");function a(c,r){if(p[r]==null)throw Error("Reference "+r+"is undefined");return p[r]}}function g(p,e){return Array.isArray(p)?m(p,e):t(p,e)}g.parse=t,g.stringify=m,N.exports=g},{}],481:[function(h,N,H){var t=h("pick-by-alias");N.exports=function(m){var g;return arguments.length>1&&(m=arguments),typeof m=="string"?m=m.split(/\s/).map(parseFloat):typeof m=="number"&&(m=[m]),m.length&&typeof m[0]=="number"?g=m.length===1?{width:m[0],height:m[0],x:0,y:0}:m.length===2?{width:m[0],height:m[1],x:0,y:0}:{x:m[0],y:m[1],width:m[2]-m[0]||0,height:m[3]-m[1]||0}:m&&(m=t(m,{left:"x l left Left",top:"y t top Top",width:"w width W Width",height:"h height W Width",bottom:"b bottom Bottom",right:"r right Right"}),g={x:m.left||0,y:m.top||0},m.width==null?m.right?g.width=m.right-g.x:g.width=0:g.width=m.width,m.height==null?m.bottom?g.height=m.bottom-g.y:g.height=0:g.height=m.height),g}},{"pick-by-alias":485}],482:[function(h,N,H){N.exports=function(p){var e=[];return p.replace(m,function(f,u,i){var s=u.toLowerCase();for(i=function(o){var a=o.match(g);return a?a.map(Number):[]}(i),s=="m"&&i.length>2&&(e.push([u].concat(i.splice(0,2))),s="l",u=u=="m"?"l":"L");;){if(i.length==t[s])return i.unshift(u),e.push(i);if(i.length<t[s])throw new Error("malformed path data");e.push([u].concat(i.splice(0,t[s])))}}),e};var t={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},m=/([astvzqmhlc])([^astvzqmhlc]*)/gi,g=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi},{}],483:[function(h,N,H){N.exports=function(t,m){m||(m=[0,""]),t=String(t);var g=parseFloat(t,10);return m[0]=g,m[1]=t.match(/[\d.\-\+]*\s*(.*)/)[1]||"",m}},{}],484:[function(h,N,H){(function(t){(function(){(function(){var m,g,p,e,f,u;typeof performance!="undefined"&&performance!==null&&performance.now?N.exports=function(){return performance.now()}:t!=null&&t.hrtime?(N.exports=function(){return(m()-f)/1e6},g=t.hrtime,e=(m=function(){var i;return 1e9*(i=g())[0]+i[1]})(),u=1e9*t.uptime(),f=e-u):Date.now?(N.exports=function(){return Date.now()-p},p=Date.now()):(N.exports=function(){return new Date().getTime()-p},p=new Date().getTime())}).call(this)}).call(this)}).call(this,h("_process"))},{_process:514}],485:[function(h,N,H){N.exports=function(g,p,e){var f,u,i={};if(typeof p=="string"&&(p=m(p)),Array.isArray(p)){var s={};for(u=0;u<p.length;u++)s[p[u]]=!0;p=s}for(f in p)p[f]=m(p[f]);var o={};for(f in p){var a=p[f];if(Array.isArray(a))for(u=0;u<a.length;u++){var c=a[u];if(e&&(o[c]=!0),c in g){if(i[f]=g[c],e)for(var r=u;r<a.length;r++)o[a[r]]=!0;break}}else f in g&&(p[f]&&(i[f]=g[f]),e&&(o[f]=!0))}if(e)for(f in g)o[f]||(i[f]=g[f]);return i};var t={};function m(g){return t[g]?t[g]:(typeof g=="string"&&(g=t[g]=g.split(/\s*,\s*|\s+/)),g)}},{}],486:[function(h,N,H){N.exports=function(m,g){for(var p=0|g.length,e=m.length,f=[new Array(p),new Array(p)],u=0;u<p;++u)f[0][u]=[],f[1][u]=[];for(u=0;u<e;++u){var i=m[u];f[0][i[0]].push(i),f[1][i[1]].push(i)}var s=[];for(u=0;u<p;++u)f[0][u].length+f[1][u].length===0&&s.push([u]);function o(y,v){var _=f[v][y[v]];_.splice(_.indexOf(y),1)}function a(y,v,_){for(var x,T,A,S=0;S<2;++S)if(f[S][v].length>0){x=f[S][v][0],A=S;break}T=x[1^A];for(var w=0;w<2;++w)for(var L=f[w][v],k=0;k<L.length;++k){var C=L[k],M=C[1^w];t(g[y],g[v],g[T],g[M])>0&&(x=C,T=M,A=w)}return _||x&&o(x,A),T}function c(y,v){var _=f[v][y][0],x=[y];o(_,v);for(var T=_[1^v];;){for(;T!==y;)x.push(T),T=a(x[x.length-2],T,!1);if(f[0][y].length+f[1][y].length===0)break;var A=x[x.length-1],S=y,w=x[1],L=a(A,S,!0);if(t(g[A],g[S],g[w],g[L])<0)break;x.push(y),T=a(A,S)}return x}function r(y,v){return v[1]===v[v.length-1]}for(u=0;u<p;++u)for(var n=0;n<2;++n){for(var d=[];f[n][u].length>0;){f[0][u].length;var l=c(u,n);r(0,l)?d.push.apply(d,l):(d.length>0&&s.push(d),d=l)}d.length>0&&s.push(d)}return s};var t=h("compare-angle")},{"compare-angle":138}],487:[function(h,N,H){N.exports=function(m,g){for(var p=t(m,g.length),e=new Array(g.length),f=new Array(g.length),u=[],i=0;i<g.length;++i){var s=p[i].length;f[i]=s,e[i]=!0,s<=1&&u.push(i)}for(;u.length>0;){var o=u.pop();e[o]=!1;var a=p[o];for(i=0;i<a.length;++i){var c=a[i];--f[c]==0&&u.push(c)}}var r=new Array(g.length),n=[];for(i=0;i<g.length;++i)e[i]?(o=n.length,r[i]=o,n.push(g[i])):r[i]=-1;var d=[];for(i=0;i<m.length;++i){var l=m[i];e[l[0]]&&e[l[1]]&&d.push([r[l[0]],r[l[1]]])}return[d,n]};var t=h("edges-to-adjacency-list")},{"edges-to-adjacency-list":184}],488:[function(h,N,H){N.exports=function(s,o){var a=u(s,o);s=a[0];for(var c=(o=a[1]).length,r=(s.length,t(s,o.length)),n=0;n<c;++n)if(r[n].length%2==1)throw new Error("planar-graph-to-polyline: graph must be manifold");var d=m(s,o),l=(d=d.filter(function(te){for(var ie=te.length,ae=[0],he=0;he<ie;++he){var se=o[te[he]],de=o[te[(he+1)%ie]],ce=p(-se[0],se[1]),ve=p(-se[0],de[1]),ke=p(de[0],se[1]),Ee=p(de[0],de[1]);ae=e(ae,e(e(ce,ve),e(ke,Ee)))}return ae[ae.length-1]>0})).length,y=new Array(l),v=new Array(l);for(n=0;n<l;++n){y[n]=n;var _=new Array(l),x=d[n].map(function(te){return o[te]}),T=g([x]),A=0;e:for(var S=0;S<l;++S)if(_[S]=0,n!==S){for(var w=(J=d[S]).length,L=0;L<w;++L){var k=T(o[J[L]]);if(k!==0){k<0&&(_[S]=1,A+=1);continue e}}_[S]=1,A+=1}v[n]=[A,n,_]}for(v.sort(function(te,ie){return ie[0]-te[0]}),n=0;n<l;++n){var C=(_=v[n])[1],M=_[2];for(S=0;S<l;++S)M[S]&&(y[S]=C)}var P=function(te){for(var ie=new Array(te),ae=0;ae<te;++ae)ie[ae]=[];return ie}(l);for(n=0;n<l;++n)P[n].push(y[n]),P[y[n]].push(n);var O={},F=i(c,!1);for(n=0;n<l;++n)for(w=(J=d[n]).length,S=0;S<w;++S){var j=J[S],W=J[(S+1)%w],Z=Math.min(j,W)+":"+Math.max(j,W);if(Z in O){var Q=O[Z];P[Q].push(n),P[n].push(Q),F[j]=F[W]=!0}else O[Z]=n}function X(te){for(var ie=te.length,ae=0;ae<ie;++ae)if(!F[te[ae]])return!1;return!0}var G=[],Y=i(l,-1);for(n=0;n<l;++n)y[n]!==n||X(d[n])?Y[n]=-1:(G.push(n),Y[n]=0);for(a=[];G.length>0;){var K=G.pop(),D=P[K];f(D,function(te,ie){return te-ie});var B,q=D.length,ee=Y[K];if(ee===0){var J=d[K];B=[J]}for(n=0;n<q;++n){var $=D[n];Y[$]>=0||(Y[$]=1^ee,G.push($),ee===0&&(X(J=d[$])||(J.reverse(),B.push(J))))}ee===0&&a.push(B)}return a};var t=h("edges-to-adjacency-list"),m=h("planar-dual"),g=h("point-in-big-polygon"),p=h("two-product"),e=h("robust-sum"),f=h("uniq"),u=h("./lib/trim-leaves");function i(s,o){for(var a=new Array(s),c=0;c<s;++c)a[c]=o;return a}},{"./lib/trim-leaves":487,"edges-to-adjacency-list":184,"planar-dual":486,"point-in-big-polygon":489,"robust-sum":539,"two-product":588,uniq:603}],489:[function(h,N,H){N.exports=function(i){for(var s=i.length,o=[],a=[],c=0;c<s;++c)for(var r=i[c],n=r.length,d=n-1,l=0;l<n;d=l++){var y=r[d],v=r[l];y[0]===v[0]?a.push([y,v]):o.push([y,v])}if(o.length===0)return a.length===0?u:(_=f(a),function(A){return _(A[0],A[1])?0:1});var _,x=m(o),T=function(A,S){return function(w){var L=p.le(S,w[0]);if(L<0)return 1;var k=A[L];if(!k){if(!(L>0&&S[L]===w[0]))return 1;k=A[L-1]}for(var C=1;k;){var M=k.key,P=t(w,M[0],M[1]);if(M[0][0]<M[1][0])if(P<0)k=k.left;else{if(!(P>0))return 0;C=-1,k=k.right}else if(P>0)k=k.left;else{if(!(P<0))return 0;C=1,k=k.right}}return C}}(x.slabs,x.coordinates);return a.length===0?T:function(A,S){return function(w){return A(w[0],w[1])?0:S(w)}}(f(a),T)};var t=h("robust-orientation")[3],m=h("slab-decomposition"),g=h("interval-tree-1d"),p=h("binary-search-bounds");function e(){return!0}function f(i){for(var s={},o=0;o<i.length;++o){var a=i[o],c=a[0][0],r=a[0][1],n=a[1][1],d=[Math.min(r,n),Math.max(r,n)];c in s?s[c].push(d):s[c]=[d]}var l={},y=Object.keys(s);for(o=0;o<y.length;++o){var v=s[y[o]];l[y[o]]=g(v)}return function(_){return function(x,T){var A=_[x];return!!A&&!!A.queryPoint(T,e)}}(l)}function u(i){return 1}},{"binary-search-bounds":103,"interval-tree-1d":440,"robust-orientation":534,"slab-decomposition":551}],490:[function(h,N,H){/*
 * @copyright 2016 Sean Connelly (@voidqk), http://syntheti.cc
 * @license MIT
 * @preserve Project Home: https://github.com/voidqk/polybooljs
 */var t,m=h("./lib/build-log"),g=h("./lib/epsilon"),p=h("./lib/intersecter"),e=h("./lib/segment-chainer"),f=h("./lib/segment-selector"),u=h("./lib/geojson"),i=!1,s=g();function o(a,c,r){var n=t.segments(a),d=t.segments(c),l=r(t.combine(n,d));return t.polygon(l)}t={buildLog:function(a){return a===!0?i=m():a===!1&&(i=!1),i!==!1&&i.list},epsilon:function(a){return s.epsilon(a)},segments:function(a){var c=p(!0,s,i);return a.regions.forEach(c.addRegion),{segments:c.calculate(a.inverted),inverted:a.inverted}},combine:function(a,c){return{combined:p(!1,s,i).calculate(a.segments,a.inverted,c.segments,c.inverted),inverted1:a.inverted,inverted2:c.inverted}},selectUnion:function(a){return{segments:f.union(a.combined,i),inverted:a.inverted1||a.inverted2}},selectIntersect:function(a){return{segments:f.intersect(a.combined,i),inverted:a.inverted1&&a.inverted2}},selectDifference:function(a){return{segments:f.difference(a.combined,i),inverted:a.inverted1&&!a.inverted2}},selectDifferenceRev:function(a){return{segments:f.differenceRev(a.combined,i),inverted:!a.inverted1&&a.inverted2}},selectXor:function(a){return{segments:f.xor(a.combined,i),inverted:a.inverted1!==a.inverted2}},polygon:function(a){return{regions:e(a.segments,s,i),inverted:a.inverted}},polygonFromGeoJSON:function(a){return u.toPolygon(t,a)},polygonToGeoJSON:function(a){return u.fromPolygon(t,s,a)},union:function(a,c){return o(a,c,t.selectUnion)},intersect:function(a,c){return o(a,c,t.selectIntersect)},difference:function(a,c){return o(a,c,t.selectDifference)},differenceRev:function(a,c){return o(a,c,t.selectDifferenceRev)},xor:function(a,c){return o(a,c,t.selectXor)}},typeof window=="object"&&(window.PolyBool=t),N.exports=t},{"./lib/build-log":491,"./lib/epsilon":492,"./lib/geojson":493,"./lib/intersecter":494,"./lib/segment-chainer":496,"./lib/segment-selector":497}],491:[function(h,N,H){N.exports=function(){var t,m=0,g=!1;function p(e,f){return t.list.push({type:e,data:f?JSON.parse(JSON.stringify(f)):void 0}),t}return t={list:[],segmentId:function(){return m++},checkIntersection:function(e,f){return p("check",{seg1:e,seg2:f})},segmentChop:function(e,f){return p("div_seg",{seg:e,pt:f}),p("chop",{seg:e,pt:f})},statusRemove:function(e){return p("pop_seg",{seg:e})},segmentUpdate:function(e){return p("seg_update",{seg:e})},segmentNew:function(e,f){return p("new_seg",{seg:e,primary:f})},segmentRemove:function(e){return p("rem_seg",{seg:e})},tempStatus:function(e,f,u){return p("temp_status",{seg:e,above:f,below:u})},rewind:function(e){return p("rewind",{seg:e})},status:function(e,f,u){return p("status",{seg:e,above:f,below:u})},vert:function(e){return e===g?t:(g=e,p("vert",{x:e}))},log:function(e){return typeof e!="string"&&(e=JSON.stringify(e,!1,"  ")),p("log",{txt:e})},reset:function(){return p("reset")},selected:function(e){return p("selected",{segs:e})},chainStart:function(e){return p("chain_start",{seg:e})},chainRemoveHead:function(e,f){return p("chain_rem_head",{index:e,pt:f})},chainRemoveTail:function(e,f){return p("chain_rem_tail",{index:e,pt:f})},chainNew:function(e,f){return p("chain_new",{pt1:e,pt2:f})},chainMatch:function(e){return p("chain_match",{index:e})},chainClose:function(e){return p("chain_close",{index:e})},chainAddHead:function(e,f){return p("chain_add_head",{index:e,pt:f})},chainAddTail:function(e,f){return p("chain_add_tail",{index:e,pt:f})},chainConnect:function(e,f){return p("chain_con",{index1:e,index2:f})},chainReverse:function(e){return p("chain_rev",{index:e})},chainJoin:function(e,f){return p("chain_join",{index1:e,index2:f})},done:function(){return p("done")}}}},{}],492:[function(h,N,H){N.exports=function(t){typeof t!="number"&&(t=1e-10);var m={epsilon:function(g){return typeof g=="number"&&(t=g),t},pointAboveOrOnLine:function(g,p,e){var f=p[0],u=p[1],i=e[0],s=e[1],o=g[0];return(i-f)*(g[1]-u)-(s-u)*(o-f)>=-t},pointBetween:function(g,p,e){var f=g[1]-p[1],u=e[0]-p[0],i=g[0]-p[0],s=e[1]-p[1],o=i*u+f*s;return!(o<t)&&!(o-(u*u+s*s)>-t)},pointsSameX:function(g,p){return Math.abs(g[0]-p[0])<t},pointsSameY:function(g,p){return Math.abs(g[1]-p[1])<t},pointsSame:function(g,p){return m.pointsSameX(g,p)&&m.pointsSameY(g,p)},pointsCompare:function(g,p){return m.pointsSameX(g,p)?m.pointsSameY(g,p)?0:g[1]<p[1]?-1:1:g[0]<p[0]?-1:1},pointsCollinear:function(g,p,e){var f=g[0]-p[0],u=g[1]-p[1],i=p[0]-e[0],s=p[1]-e[1];return Math.abs(f*s-i*u)<t},linesIntersect:function(g,p,e,f){var u=p[0]-g[0],i=p[1]-g[1],s=f[0]-e[0],o=f[1]-e[1],a=u*o-i*s;if(Math.abs(a)<t)return!1;var c=g[0]-e[0],r=g[1]-e[1],n=(s*r-o*c)/a,d=(u*r-i*c)/a,l={alongA:0,alongB:0,pt:[g[0]+n*u,g[1]+n*i]};return l.alongA=n<=-t?-2:n<t?-1:n-1<=-t?0:n-1<t?1:2,l.alongB=d<=-t?-2:d<t?-1:d-1<=-t?0:d-1<t?1:2,l},pointInsideRegion:function(g,p){for(var e=g[0],f=g[1],u=p[p.length-1][0],i=p[p.length-1][1],s=!1,o=0;o<p.length;o++){var a=p[o][0],c=p[o][1];c-f>t!=i-f>t&&(u-a)*(f-c)/(i-c)+a-e>t&&(s=!s),u=a,i=c}return s}};return m}},{}],493:[function(h,N,H){var t={toPolygon:function(m,g){function p(u){if(u.length<=0)return m.segments({inverted:!1,regions:[]});function i(a){var c=a.slice(0,a.length-1);return m.segments({inverted:!1,regions:[c]})}for(var s=i(u[0]),o=1;o<u.length;o++)s=m.selectDifference(m.combine(s,i(u[o])));return s}if(g.type==="Polygon")return m.polygon(p(g.coordinates));if(g.type==="MultiPolygon"){for(var e=m.segments({inverted:!1,regions:[]}),f=0;f<g.coordinates.length;f++)e=m.selectUnion(m.combine(e,p(g.coordinates[f])));return m.polygon(e)}throw new Error("PolyBool: Cannot convert GeoJSON object to PolyBool polygon")},fromPolygon:function(m,g,p){function e(d,l){return g.pointInsideRegion([.5*(d[0][0]+d[1][0]),.5*(d[0][1]+d[1][1])],l)}function f(d){return{region:d,children:[]}}p=m.polygon(m.segments(p));var u=f(null);function i(d,l){for(var y=0;y<d.children.length;y++)if(e(l,(_=d.children[y]).region))return void i(_,l);var v=f(l);for(y=0;y<d.children.length;y++){var _;e((_=d.children[y]).region,l)&&(v.children.push(_),d.children.splice(y,1),y--)}d.children.push(v)}for(var s=0;s<p.regions.length;s++){var o=p.regions[s];o.length<3||i(u,o)}function a(d,l){for(var y=0,v=d[d.length-1][0],_=d[d.length-1][1],x=[],T=0;T<d.length;T++){var A=d[T][0],S=d[T][1];x.push([A,S]),y+=S*v-A*_,v=A,_=S}return y<0!==l&&x.reverse(),x.push([x[0][0],x[0][1]]),x}var c=[];function r(d){var l=[a(d.region,!1)];c.push(l);for(var y=0;y<d.children.length;y++)l.push(n(d.children[y]))}function n(d){for(var l=0;l<d.children.length;l++)r(d.children[l]);return a(d.region,!0)}for(s=0;s<u.children.length;s++)r(u.children[s]);return c.length<=0?{type:"Polygon",coordinates:[]}:c.length==1?{type:"Polygon",coordinates:c[0]}:{type:"MultiPolygon",coordinates:c}}};N.exports=t},{}],494:[function(h,N,H){var t=h("./linked-list");N.exports=function(m,g,p){function e(a,c,r){return{id:p?p.segmentId():-1,start:a,end:c,myFill:{above:r.myFill.above,below:r.myFill.below},otherFill:null}}var f=t.create();function u(a,c){f.insertBefore(a,function(r){return function(n,d,l,y,v,_){var x=g.pointsCompare(d,v);return x!==0?x:g.pointsSame(l,_)?0:n!==y?n?1:-1:g.pointAboveOrOnLine(l,y?v:_,y?_:v)?1:-1}(a.isStart,a.pt,c,r.isStart,r.pt,r.other.pt)<0})}function i(a,c){var r=function(n,d){var l=t.node({isStart:!0,pt:n.start,seg:n,primary:d,other:null,status:null});return u(l,n.end),l}(a,c);return function(n,d,l){var y=t.node({isStart:!1,pt:d.end,seg:d,primary:l,other:n,status:null});n.other=y,u(y,n.pt)}(r,a,c),r}function s(a,c){var r=e(c,a.seg.end,a.seg);return function(n,d){p&&p.segmentChop(n.seg,d),n.other.remove(),n.seg.end=d,n.other.pt=d,u(n.other,n.pt)}(a,c),i(r,a.primary)}function o(a,c){var r=t.create();function n(k){return r.findTransition(function(C){var M,P,O,F,j,W;return M=k,P=C.ev,O=M.seg.start,F=M.seg.end,j=P.seg.start,W=P.seg.end,(g.pointsCollinear(O,j,W)?g.pointsCollinear(F,j,W)||g.pointAboveOrOnLine(F,j,W)?1:-1:g.pointAboveOrOnLine(O,j,W)?1:-1)>0})}function d(k,C){var M=k.seg,P=C.seg,O=M.start,F=M.end,j=P.start,W=P.end;p&&p.checkIntersection(M,P);var Z=g.linesIntersect(O,F,j,W);if(Z===!1){if(!g.pointsCollinear(O,F,j)||g.pointsSame(O,W)||g.pointsSame(F,j))return!1;var Q=g.pointsSame(O,j),X=g.pointsSame(F,W);if(Q&&X)return C;var G=!Q&&g.pointBetween(O,j,W),Y=!X&&g.pointBetween(F,j,W);if(Q)return Y?s(C,F):s(k,W),C;G&&(X||(Y?s(C,F):s(k,W)),s(C,O))}else Z.alongA===0&&(Z.alongB===-1?s(k,j):Z.alongB===0?s(k,Z.pt):Z.alongB===1&&s(k,W)),Z.alongB===0&&(Z.alongA===-1?s(C,O):Z.alongA===0?s(C,Z.pt):Z.alongA===1&&s(C,F));return!1}for(var l=[];!f.isEmpty();){var y=f.getHead();if(p&&p.vert(y.pt[0]),y.isStart){let k=function(){if(_){var C=d(y,_);if(C)return C}return!!x&&d(y,x)};p&&p.segmentNew(y.seg,y.primary);var v=n(y),_=v.before?v.before.ev:null,x=v.after?v.after.ev:null;p&&p.tempStatus(y.seg,!!_&&_.seg,!!x&&x.seg);var T,A=k();if(A){var S;m?(S=y.seg.myFill.below===null||y.seg.myFill.above!==y.seg.myFill.below)&&(A.seg.myFill.above=!A.seg.myFill.above):A.seg.otherFill=y.seg.myFill,p&&p.segmentUpdate(A.seg),y.other.remove(),y.remove()}if(f.getHead()!==y){p&&p.rewind(y.seg);continue}m?(S=y.seg.myFill.below===null||y.seg.myFill.above!==y.seg.myFill.below,y.seg.myFill.below=x?x.seg.myFill.above:a,y.seg.myFill.above=S?!y.seg.myFill.below:y.seg.myFill.below):y.seg.otherFill===null&&(T=x?y.primary===x.primary?x.seg.otherFill.above:x.seg.myFill.above:y.primary?c:a,y.seg.otherFill={above:T,below:T}),p&&p.status(y.seg,!!_&&_.seg,!!x&&x.seg),y.other.status=v.insert(t.node({ev:y}))}else{var w=y.status;if(w===null)throw new Error("PolyBool: Zero-length segment detected; your epsilon is probably too small or too large");if(r.exists(w.prev)&&r.exists(w.next)&&d(w.prev.ev,w.next.ev),p&&p.statusRemove(w.ev.seg),w.remove(),!y.primary){var L=y.seg.myFill;y.seg.myFill=y.seg.otherFill,y.seg.otherFill=L}l.push(y.seg)}f.getHead().remove()}return p&&p.done(),l}return m?{addRegion:function(a){for(var c,r,n,d=a[a.length-1],l=0;l<a.length;l++){c=d,d=a[l];var y=g.pointsCompare(c,d);y!==0&&i((r=y<0?c:d,n=y<0?d:c,{id:p?p.segmentId():-1,start:r,end:n,myFill:{above:null,below:null},otherFill:null}),!0)}},calculate:function(a){return o(a,!1)}}:{calculate:function(a,c,r,n){return a.forEach(function(d){i(e(d.start,d.end,d),!0)}),r.forEach(function(d){i(e(d.start,d.end,d),!1)}),o(c,n)}}}},{"./linked-list":495}],495:[function(h,N,H){N.exports={create:function(){var t={root:{root:!0,next:null},exists:function(m){return m!==null&&m!==t.root},isEmpty:function(){return t.root.next===null},getHead:function(){return t.root.next},insertBefore:function(m,g){for(var p=t.root,e=t.root.next;e!==null;){if(g(e))return m.prev=e.prev,m.next=e,e.prev.next=m,void(e.prev=m);p=e,e=e.next}p.next=m,m.prev=p,m.next=null},findTransition:function(m){for(var g=t.root,p=t.root.next;p!==null&&!m(p);)g=p,p=p.next;return{before:g===t.root?null:g,after:p,insert:function(e){return e.prev=g,e.next=p,g.next=e,p!==null&&(p.prev=e),e}}}};return t},node:function(t){return t.prev=null,t.next=null,t.remove=function(){t.prev.next=t.next,t.next&&(t.next.prev=t.prev),t.prev=null,t.next=null},t}}},{}],496:[function(h,N,H){N.exports=function(t,m,g){var p=[],e=[];return t.forEach(function(f){var u=f.start,i=f.end;if(m.pointsSame(u,i))console.warn("PolyBool: Warning: Zero-length segment detected; your epsilon is probably too small or too large");else{g&&g.chainStart(f);for(var s={index:0,matches_head:!1,matches_pt1:!1},o={index:0,matches_head:!1,matches_pt1:!1},a=s,c=0;c<p.length;c++){var r=(v=p[c])[0],n=(v[1],v[v.length-1]);if(v[v.length-2],m.pointsSame(r,u)){if(k(c,!0,!0))break}else if(m.pointsSame(r,i)){if(k(c,!0,!1))break}else if(m.pointsSame(n,u)){if(k(c,!1,!0))break}else if(m.pointsSame(n,i)&&k(c,!1,!1))break}if(a===s)return p.push([u,i]),void(g&&g.chainNew(u,i));if(a===o){g&&g.chainMatch(s.index);var d=s.index,l=s.matches_pt1?i:u,y=s.matches_head,v=p[d],_=y?v[0]:v[v.length-1],x=y?v[1]:v[v.length-2],T=y?v[v.length-1]:v[0],A=y?v[v.length-2]:v[1];return m.pointsCollinear(x,_,l)&&(y?(g&&g.chainRemoveHead(s.index,l),v.shift()):(g&&g.chainRemoveTail(s.index,l),v.pop()),_=x),m.pointsSame(T,l)?(p.splice(d,1),m.pointsCollinear(A,T,_)&&(y?(g&&g.chainRemoveTail(s.index,_),v.pop()):(g&&g.chainRemoveHead(s.index,_),v.shift())),g&&g.chainClose(s.index),void e.push(v)):void(y?(g&&g.chainAddHead(s.index,l),v.unshift(l)):(g&&g.chainAddTail(s.index,l),v.push(l)))}var S=s.index,w=o.index;g&&g.chainConnect(S,w);var L=p[S].length<p[w].length;s.matches_head?o.matches_head?L?(C(S),M(S,w)):(C(w),M(w,S)):M(w,S):o.matches_head?M(S,w):L?(C(S),M(w,S)):(C(w),M(S,w))}function k(P,O,F){return a.index=P,a.matches_head=O,a.matches_pt1=F,a===s?(a=o,!1):(a=null,!0)}function C(P){g&&g.chainReverse(P),p[P].reverse()}function M(P,O){var F=p[P],j=p[O],W=F[F.length-1],Z=F[F.length-2],Q=j[0],X=j[1];m.pointsCollinear(Z,W,Q)&&(g&&g.chainRemoveTail(P,W),F.pop(),W=Z),m.pointsCollinear(W,Q,X)&&(g&&g.chainRemoveHead(O,Q),j.shift()),g&&g.chainJoin(P,O),p[P]=F.concat(j),p.splice(O,1)}}),e}},{}],497:[function(h,N,H){function t(g,p,e){var f=[];return g.forEach(function(u){var i=(u.myFill.above?8:0)+(u.myFill.below?4:0)+(u.otherFill&&u.otherFill.above?2:0)+(u.otherFill&&u.otherFill.below?1:0);p[i]!==0&&f.push({id:e?e.segmentId():-1,start:u.start,end:u.end,myFill:{above:p[i]===1,below:p[i]===2},otherFill:null})}),e&&e.selected(f),f}var m={union:function(g,p){return t(g,[0,2,1,0,2,2,0,0,1,0,1,0,0,0,0,0],p)},intersect:function(g,p){return t(g,[0,0,0,0,0,2,0,2,0,0,1,1,0,2,1,0],p)},difference:function(g,p){return t(g,[0,0,0,0,2,0,2,0,1,1,0,0,0,1,2,0],p)},differenceRev:function(g,p){return t(g,[0,2,1,0,0,0,1,1,0,2,0,2,0,0,0,0],p)},xor:function(g,p){return t(g,[0,2,1,0,2,0,0,1,1,0,0,2,0,1,2,0],p)}};N.exports=m},{}],498:[function(h,N,H){var t=new Float64Array(4),m=new Float64Array(4),g=new Float64Array(4);N.exports=function(p,e,f,u,i){t.length<u.length&&(t=new Float64Array(u.length),m=new Float64Array(u.length),g=new Float64Array(u.length));for(var s=0;s<u.length;++s)t[s]=p[s]-u[s],m[s]=e[s]-p[s],g[s]=f[s]-p[s];var o=0,a=0,c=0,r=0,n=0,d=0;for(s=0;s<u.length;++s){var l=m[s],y=g[s],v=t[s];o+=l*l,a+=l*y,c+=y*y,r+=v*l,n+=v*y,d+=v*v}var _,x,T,A,S,w=Math.abs(o*c-a*a),L=a*n-c*r,k=a*r-o*n;if(L+k<=w)if(L<0)k<0&&r<0?(k=0,-r>=o?(L=1,_=o+2*r+d):_=r*(L=-r/o)+d):(L=0,n>=0?(k=0,_=d):-n>=c?(k=1,_=c+2*n+d):_=n*(k=-n/c)+d);else if(k<0)k=0,r>=0?(L=0,_=d):-r>=o?(L=1,_=o+2*r+d):_=r*(L=-r/o)+d;else{var C=1/w;_=(L*=C)*(o*L+a*(k*=C)+2*r)+k*(a*L+c*k+2*n)+d}else L<0?(T=c+n)>(x=a+r)?(A=T-x)>=(S=o-2*a+c)?(L=1,k=0,_=o+2*r+d):_=(L=A/S)*(o*L+a*(k=1-L)+2*r)+k*(a*L+c*k+2*n)+d:(L=0,T<=0?(k=1,_=c+2*n+d):n>=0?(k=0,_=d):_=n*(k=-n/c)+d):k<0?(T=o+r)>(x=a+n)?(A=T-x)>=(S=o-2*a+c)?(k=1,L=0,_=c+2*n+d):_=(L=1-(k=A/S))*(o*L+a*k+2*r)+k*(a*L+c*k+2*n)+d:(k=0,T<=0?(L=1,_=o+2*r+d):r>=0?(L=0,_=d):_=r*(L=-r/o)+d):(A=c+n-a-r)<=0?(L=0,k=1,_=c+2*n+d):A>=(S=o-2*a+c)?(L=1,k=0,_=o+2*r+d):_=(L=A/S)*(o*L+a*(k=1-L)+2*r)+k*(a*L+c*k+2*n)+d;var M=1-L-k;for(s=0;s<u.length;++s)i[s]=M*p[s]+L*e[s]+k*f[s];return _<0?0:_}},{}],499:[function(h,N,H){var t=h("stream").Transform,m=h("stream-parser");function g(){t.call(this,{readableObjectMode:!0})}function p(e,f,u){Error.call(this),Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.message=e,f&&(this.code=f),u&&(this.statusCode=u)}g.prototype=Object.create(t.prototype),g.prototype.constructor=g,m(g.prototype),H.ParserStream=g,H.sliceEq=function(e,f,u){for(var i=f,s=0;s<u.length;)if(e[i++]!==u[s++])return!1;return!0},H.str2arr=function(e,f){var u=[],i=0;if(f&&f==="hex")for(;i<e.length;)u.push(parseInt(e.slice(i,i+2),16)),i+=2;else for(;i<e.length;i++)u.push(255&e.charCodeAt(i));return u},H.readUInt16LE=function(e,f){return e[f]|e[f+1]<<8},H.readUInt16BE=function(e,f){return e[f+1]|e[f]<<8},H.readUInt32LE=function(e,f){return e[f]|e[f+1]<<8|e[f+2]<<16|16777216*e[f+3]},H.readUInt32BE=function(e,f){return e[f+3]|e[f+2]<<8|e[f+1]<<16|16777216*e[f]},p.prototype=Object.create(Error.prototype),p.prototype.constructor=p,H.ProbeError=p},{stream:554,"stream-parser":570}],500:[function(h,N,H){function t(p,e){var f=new Error(p);return f.code=e,f}function m(p){try{return decodeURIComponent(escape(p))}catch(e){return p}}function g(p,e,f){this.input=p.subarray(e,f),this.start=e;var u=String.fromCharCode.apply(null,this.input.subarray(0,4));if(u!=="II*\0"&&u!=="MM\0*")throw t("invalid TIFF signature","EBADDATA");this.big_endian=u[0]==="M"}g.prototype.each=function(p){this.aborted=!1;var e=this.read_uint32(4);for(this.ifds_to_read=[{id:0,offset:e}];this.ifds_to_read.length>0&&!this.aborted;){var f=this.ifds_to_read.shift();f.offset&&this.scan_ifd(f.id,f.offset,p)}},g.prototype.read_uint16=function(p){var e=this.input;if(p+2>e.length)throw t("unexpected EOF","EBADDATA");return this.big_endian?256*e[p]+e[p+1]:e[p]+256*e[p+1]},g.prototype.read_uint32=function(p){var e=this.input;if(p+4>e.length)throw t("unexpected EOF","EBADDATA");return this.big_endian?16777216*e[p]+65536*e[p+1]+256*e[p+2]+e[p+3]:e[p]+256*e[p+1]+65536*e[p+2]+16777216*e[p+3]},g.prototype.is_subifd_link=function(p,e){return p===0&&e===34665||p===0&&e===34853||p===34665&&e===40965},g.prototype.exif_format_length=function(p){switch(p){case 1:case 2:case 6:case 7:return 1;case 3:case 8:return 2;case 4:case 9:case 11:return 4;case 5:case 10:case 12:return 8;default:return 0}},g.prototype.exif_format_read=function(p,e){var f;switch(p){case 1:case 2:return f=this.input[e];case 6:return(f=this.input[e])|33554430*(128&f);case 3:return f=this.read_uint16(e);case 8:return(f=this.read_uint16(e))|131070*(32768&f);case 4:return f=this.read_uint32(e);case 9:return 0|(f=this.read_uint32(e));case 5:case 10:case 11:case 12:case 7:default:return null}},g.prototype.scan_ifd=function(p,e,f){var u=this.read_uint16(e);e+=2;for(var i=0;i<u;i++){var s=this.read_uint16(e),o=this.read_uint16(e+2),a=this.read_uint32(e+4),c=this.exif_format_length(o),r=a*c,n=r<=4?e+8:this.read_uint32(e+8),d=!1;if(n+r>this.input.length)throw t("unexpected EOF","EBADDATA");for(var l=[],y=n,v=0;v<a;v++,y+=c){var _=this.exif_format_read(o,y);if(_===null){l=null;break}l.push(_)}if(Array.isArray(l)&&o===2&&(l=m(String.fromCharCode.apply(null,l)))&&l[l.length-1]==="\0"&&(l=l.slice(0,-1)),this.is_subifd_link(p,s)&&Array.isArray(l)&&Number.isInteger(l[0])&&l[0]>0&&(this.ifds_to_read.push({id:s,offset:l[0]}),d=!0),f({is_big_endian:this.big_endian,ifd:p,tag:s,format:o,count:a,entry_offset:e+this.start,data_length:r,data_offset:n+this.start,value:l,is_subifd_link:d})===!1)return void(this.aborted=!0);e+=12}p===0&&this.ifds_to_read.push({id:1,offset:this.read_uint32(e)})},N.exports.ExifParser=g,N.exports.get_orientation=function(p){var e=0;try{return new g(p,0,p.length).each(function(f){if(f.ifd===0&&f.tag===274&&Array.isArray(f.value))return e=f.value[0],!1}),e}catch(f){return-1}}},{}],501:[function(h,N,H){var t=h("./common").readUInt16BE,m=h("./common").readUInt32BE;function g(s,o){if(s.length<4+o)return null;var a=m(s,o);return s.length<a+o||a<8?null:{boxtype:String.fromCharCode.apply(null,s.slice(o+4,o+8)),data:s.slice(o+8,o+a),end:o+a}}function p(s,o){for(var a=0;;){var c=g(s,a);if(!c)break;switch(c.boxtype){case"ispe":o.sizes.push({width:m(c.data,4),height:m(c.data,8)});break;case"irot":o.transforms.push({type:"irot",value:3&c.data[0]});break;case"imir":o.transforms.push({type:"imir",value:1&c.data[0]})}a=c.end}}function e(s,o,a){for(var c=0,r=0;r<a;r++)c=256*c+(s[o+r]||0);return c}function f(s,o){for(var a=s[4]>>4&15,c=15&s[4],r=s[5]>>4&15,n=t(s,6),d=8,l=0;l<n;l++){var y=t(s,d),v=t(s,d+=2),_=e(s,d+=2,r),x=t(s,d+=r);if(d+=2,v===0&&x===1){var T=e(s,d,a),A=e(s,d+a,c);o.item_loc[y]={length:A,offset:T+_}}d+=x*(a+c)}}function u(s,o){for(var a=t(s,4),c=6,r=0;r<a;r++){var n=g(s,c);if(!n)break;if(n.boxtype==="infe"){for(var d=t(n.data,4),l="",y=8;y<n.data.length&&n.data[y];y++)l+=String.fromCharCode(n.data[y]);o.item_inf[l]=d}c=n.end}}function i(s,o){for(var a=0;;){var c=g(s,a);if(!c)break;c.boxtype==="ipco"&&p(c.data,o),a=c.end}}N.exports.unbox=g,N.exports.readSizeFromMeta=function(s){var o={sizes:[],transforms:[],item_inf:{},item_loc:{}};if(function(y,v){for(var _=4;;){var x=g(y,_);if(!x)break;x.boxtype==="iprp"&&i(x.data,v),x.boxtype==="iloc"&&f(x.data,v),x.boxtype==="iinf"&&u(x.data,v),_=x.end}}(s,o),o.sizes.length){var a,c,r,n=(a=o.sizes,c=a.reduce(function(y,v){return y.width>v.width||y.width===v.width&&y.height>v.height?y:v}),r=a.reduce(function(y,v){return y.height>v.height||y.height===v.height&&y.width>v.width?y:v}),c.width>r.height||c.width===r.height&&c.height>r.width?c:r),d=1;o.transforms.forEach(function(y){var v={1:6,2:5,3:8,4:7,5:4,6:3,7:2,8:1},_={1:4,2:3,3:2,4:1,5:6,6:5,7:8,8:7};if(y.type==="imir"&&(d=y.value===0?_[d]:v[d=v[d=_[d]]]),y.type==="irot")for(var x=0;x<y.value;x++)d=v[d]});var l=null;return o.item_inf.Exif&&(l=o.item_loc[o.item_inf.Exif]),{width:n.width,height:n.height,orientation:o.transforms.length?d:null,variants:o.sizes,exif_location:l}}},N.exports.getMimeType=function(s){var o=String.fromCharCode.apply(null,s.slice(0,4)),a={};a[o]=!0;for(var c=8;c<s.length;c+=4)a[String.fromCharCode.apply(null,s.slice(c,c+4))]=!0;if(a.mif1||a.msf1||a.miaf)return o==="avif"||o==="avis"||o==="avio"?{type:"avif",mime:"image/avif"}:o==="heic"||o==="heix"?{type:"heic",mime:"image/heic"}:o==="hevc"||o==="hevx"?{type:"heic",mime:"image/heic-sequence"}:a.avif||a.avis?{type:"avif",mime:"image/avif"}:a.heic||a.heix||a.hevc||a.hevx||a.heis?a.msf1?{type:"heif",mime:"image/heif-sequence"}:{type:"heif",mime:"image/heif"}:{type:"avif",mime:"image/avif"}}},{"./common":499}],502:[function(h,N,H){var t=h("../common").str2arr,m=h("../common").sliceEq,g=h("../common").readUInt32BE,p=h("../miaf_utils"),e=h("../exif_utils"),f=t("ftyp");N.exports=function(u){if(m(u,4,f)){var i=p.unbox(u,0);if(i){var s=p.getMimeType(i.data);if(s){for(var o,a=i.end;;){var c=p.unbox(u,a);if(!c)break;if(a=c.end,c.boxtype==="mdat")return;if(c.boxtype==="meta"){o=c.data;break}}if(o){var r=p.readSizeFromMeta(o);if(r){var n={width:r.width,height:r.height,type:s.type,mime:s.mime,wUnits:"px",hUnits:"px"};if(r.variants.length>1&&(n.variants=r.variants),r.orientation&&(n.orientation=r.orientation),r.exif_location&&r.exif_location.offset+r.exif_location.length<=u.length){var d=g(u,r.exif_location.offset),l=u.slice(r.exif_location.offset+d+4,r.exif_location.offset+r.exif_location.length),y=e.get_orientation(l);y>0&&(n.orientation=y)}return n}}}}}}},{"../common":499,"../exif_utils":500,"../miaf_utils":501}],503:[function(h,N,H){var t=h("../common").str2arr,m=h("../common").sliceEq,g=h("../common").readUInt16LE,p=t("BM");N.exports=function(e){if(!(e.length<26)&&m(e,0,p))return{width:g(e,18),height:g(e,22),type:"bmp",mime:"image/bmp",wUnits:"px",hUnits:"px"}}},{"../common":499}],504:[function(h,N,H){var t=h("../common").str2arr,m=h("../common").sliceEq,g=h("../common").readUInt16LE,p=t("GIF87a"),e=t("GIF89a");N.exports=function(f){if(!(f.length<10)&&(m(f,0,p)||m(f,0,e)))return{width:g(f,6),height:g(f,8),type:"gif",mime:"image/gif",wUnits:"px",hUnits:"px"}}},{"../common":499}],505:[function(h,N,H){var t=h("../common").readUInt16LE;N.exports=function(m){var g=t(m,0),p=t(m,2),e=t(m,4);if(g===0&&p===1&&e){for(var f=[],u={width:0,height:0},i=0;i<e;i++){var s=m[6+16*i]||256,o=m[6+16*i+1]||256,a={width:s,height:o};f.push(a),(s>u.width||o>u.height)&&(u=a)}return{width:u.width,height:u.height,variants:f,type:"ico",mime:"image/x-icon",wUnits:"px",hUnits:"px"}}}},{"../common":499}],506:[function(h,N,H){var t=h("../common").readUInt16BE,m=h("../common").str2arr,g=h("../common").sliceEq,p=h("../exif_utils"),e=m("Exif\0\0");N.exports=function(f){if(!(f.length<2)&&f[0]===255&&f[1]===216)for(var u=2;;){if(f.length-u<2||f[u++]!==255)return;for(var i,s,o=f[u++];o===255;)o=f[u++];if(208<=o&&o<=217||o===1)i=0;else{if(!(192<=o&&o<=254)||f.length-u<2)return;i=t(f,u)-2,u+=2}if(o===217||o===218)return;if(o===225&&i>=10&&g(f,u,e)&&(s=p.get_orientation(f.slice(u+6,u+i))),i>=5&&192<=o&&o<=207&&o!==196&&o!==200&&o!==204){if(f.length-u<i)return;var a={width:t(f,u+3),height:t(f,u+1),type:"jpg",mime:"image/jpeg",wUnits:"px",hUnits:"px"};return s>0&&(a.orientation=s),a}u+=i}}},{"../common":499,"../exif_utils":500}],507:[function(h,N,H){var t=h("../common").str2arr,m=h("../common").sliceEq,g=h("../common").readUInt32BE,p=t(`\x89PNG\r

`),e=t("IHDR");N.exports=function(f){if(!(f.length<24)&&m(f,0,p)&&m(f,12,e))return{width:g(f,16),height:g(f,20),type:"png",mime:"image/png",wUnits:"px",hUnits:"px"}}},{"../common":499}],508:[function(h,N,H){var t=h("../common").str2arr,m=h("../common").sliceEq,g=h("../common").readUInt32BE,p=t("8BPS\0");N.exports=function(e){if(!(e.length<22)&&m(e,0,p))return{width:g(e,18),height:g(e,14),type:"psd",mime:"image/vnd.adobe.photoshop",wUnits:"px",hUnits:"px"}}},{"../common":499}],509:[function(h,N,H){function t(s){return typeof s=="number"&&isFinite(s)&&s>0}var m=/<[-_.:a-zA-Z0-9][^>]*>/,g=/^<([-_.:a-zA-Z0-9]+:)?svg\s/,p=/[^-]\bwidth="([^%]+?)"|[^-]\bwidth='([^%]+?)'/,e=/\bheight="([^%]+?)"|\bheight='([^%]+?)'/,f=/\bview[bB]ox="(.+?)"|\bview[bB]ox='(.+?)'/,u=/in$|mm$|cm$|pt$|pc$|px$|em$|ex$/;function i(s){return u.test(s)?s.match(u)[0]:"px"}N.exports=function(s){if(function(T){var A,S=0,w=T.length;for(T[0]===239&&T[1]===187&&T[2]===191&&(S=3);S<w&&((A=T[S])===32||A===9||A===13||A===10);)S++;return S!==w&&T[S]===60}(s)){for(var o="",a=0;a<s.length;a++)o+=String.fromCharCode(s[a]);var c=(o.match(m)||[""])[0];if(g.test(c)){var r=function(T){var A=T.match(p),S=T.match(e),w=T.match(f);return{width:A&&(A[1]||A[2]),height:S&&(S[1]||S[2]),viewbox:w&&(w[1]||w[2])}}(c),n=parseFloat(r.width),d=parseFloat(r.height);if(r.width&&r.height)return!t(n)||!t(d)?void 0:{width:n,height:d,type:"svg",mime:"image/svg+xml",wUnits:i(r.width),hUnits:i(r.height)};var l=(r.viewbox||"").split(" "),y={width:l[2],height:l[3]},v=parseFloat(y.width),_=parseFloat(y.height);if(t(v)&&t(_)&&i(y.width)===i(y.height)){var x=v/_;return r.width?t(n)?{width:n,height:n/x,type:"svg",mime:"image/svg+xml",wUnits:i(r.width),hUnits:i(r.width)}:void 0:r.height?t(d)?{width:d*x,height:d,type:"svg",mime:"image/svg+xml",wUnits:i(r.height),hUnits:i(r.height)}:void 0:{width:v,height:_,type:"svg",mime:"image/svg+xml",wUnits:i(y.width),hUnits:i(y.height)}}}}}},{}],510:[function(h,N,H){var t=h("../common").str2arr,m=h("../common").sliceEq,g=h("../common").readUInt16LE,p=h("../common").readUInt16BE,e=h("../common").readUInt32LE,f=h("../common").readUInt32BE,u=t("II*\0"),i=t("MM\0*");function s(c,r,n){return n?p(c,r):g(c,r)}function o(c,r,n){return n?f(c,r):e(c,r)}function a(c,r,n){var d=s(c,r+2,n);return o(c,r+4,n)!==1||d!==3&&d!==4?null:d===3?s(c,r+8,n):o(c,r+8,n)}N.exports=function(c){if(!(c.length<8)&&(m(c,0,u)||m(c,0,i))){var r=c[0]===77,n=o(c,4,r)-8;if(!(n<0)){var d=n+8;if(!(c.length-d<2)){var l=12*s(c,d+0,r);if(!(l<=0||(d+=2,c.length-d<l))){var y,v,_,x;for(y=0;y<l;y+=12)(x=s(c,d+y,r))===256?v=a(c,d+y,r):x===257&&(_=a(c,d+y,r));return v&&_?{width:v,height:_,type:"tiff",mime:"image/tiff",wUnits:"px",hUnits:"px"}:void 0}}}}}},{"../common":499}],511:[function(h,N,H){var t=h("../common").str2arr,m=h("../common").sliceEq,g=h("../common").readUInt16LE,p=h("../common").readUInt32LE,e=h("../exif_utils"),f=t("RIFF"),u=t("WEBP");function i(a,c){if(a[c+3]===157&&a[c+4]===1&&a[c+5]===42)return{width:16383&g(a,c+6),height:16383&g(a,c+8),type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}function s(a,c){if(a[c]===47){var r=p(a,c+1);return{width:1+(16383&r),height:1+(r>>14&16383),type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}}function o(a,c){return{width:1+(a[c+6]<<16|a[c+5]<<8|a[c+4]),height:1+(a[c+9]<<c|a[c+8]<<8|a[c+7]),type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}N.exports=function(a){if(!(a.length<16)&&(m(a,0,f)||m(a,8,u))){var c=12,r=null,n=0,d=p(a,4)+8;if(!(d>a.length)){for(;c+8<d;)if(a[c]!==0){var l=String.fromCharCode.apply(null,a.slice(c,c+4)),y=p(a,c+4);l==="VP8 "&&y>=10?r=r||i(a,c+8):l==="VP8L"&&y>=9?r=r||s(a,c+8):l==="VP8X"&&y>=10?r=r||o(a,c+8):l==="EXIF"&&(n=e.get_orientation(a.slice(c+8,c+8+y)),c=1/0),c+=8+y}else c++;if(r)return n>0&&(r.orientation=n),r}}}},{"../common":499,"../exif_utils":500}],512:[function(h,N,H){N.exports={avif:h("./parse_sync/avif"),bmp:h("./parse_sync/bmp"),gif:h("./parse_sync/gif"),ico:h("./parse_sync/ico"),jpeg:h("./parse_sync/jpeg"),png:h("./parse_sync/png"),psd:h("./parse_sync/psd"),svg:h("./parse_sync/svg"),tiff:h("./parse_sync/tiff"),webp:h("./parse_sync/webp")}},{"./parse_sync/avif":502,"./parse_sync/bmp":503,"./parse_sync/gif":504,"./parse_sync/ico":505,"./parse_sync/jpeg":506,"./parse_sync/png":507,"./parse_sync/psd":508,"./parse_sync/svg":509,"./parse_sync/tiff":510,"./parse_sync/webp":511}],513:[function(h,N,H){var t=h("./lib/parsers_sync");N.exports=function(m){return function(g){for(var p=Object.keys(t),e=0;e<p.length;e++){var f=t[p[e]](g);if(f)return f}return null}(m)},N.exports.parsers=t},{"./lib/parsers_sync":512}],514:[function(h,N,H){var t,m,g=N.exports={};function p(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}function f(d){if(t===setTimeout)return setTimeout(d,0);if((t===p||!t)&&setTimeout)return t=setTimeout,setTimeout(d,0);try{return t(d,0)}catch(l){try{return t.call(null,d,0)}catch(y){return t.call(this,d,0)}}}(function(){try{t=typeof setTimeout=="function"?setTimeout:p}catch(d){t=p}try{m=typeof clearTimeout=="function"?clearTimeout:e}catch(d){m=e}})();var u,i=[],s=!1,o=-1;function a(){s&&u&&(s=!1,u.length?i=u.concat(i):o=-1,i.length&&c())}function c(){if(!s){var d=f(a);s=!0;for(var l=i.length;l;){for(u=i,i=[];++o<l;)u&&u[o].run();o=-1,l=i.length}u=null,s=!1,function(y){if(m===clearTimeout)return clearTimeout(y);if((m===e||!m)&&clearTimeout)return m=clearTimeout,clearTimeout(y);try{m(y)}catch(v){try{return m.call(null,y)}catch(_){return m.call(this,y)}}}(d)}}function r(d,l){this.fun=d,this.array=l}function n(){}g.nextTick=function(d){var l=new Array(arguments.length-1);if(arguments.length>1)for(var y=1;y<arguments.length;y++)l[y-1]=arguments[y];i.push(new r(d,l)),i.length!==1||s||f(c)},r.prototype.run=function(){this.fun.apply(null,this.array)},g.title="browser",g.browser=!0,g.env={},g.argv=[],g.version="",g.versions={},g.on=n,g.addListener=n,g.once=n,g.off=n,g.removeListener=n,g.removeAllListeners=n,g.emit=n,g.prependListener=n,g.prependOnceListener=n,g.listeners=function(d){return[]},g.binding=function(d){throw new Error("process.binding is not supported")},g.cwd=function(){return"/"},g.chdir=function(d){throw new Error("process.chdir is not supported")},g.umask=function(){return 0}},{}],515:[function(h,N,H){N.exports=h("gl-quat/slerp")},{"gl-quat/slerp":322}],516:[function(h,N,H){(function(t){(function(){for(var m=h("performance-now"),g=typeof window=="undefined"?t:window,p=["moz","webkit"],e="AnimationFrame",f=g["request"+e],u=g["cancel"+e]||g["cancelRequest"+e],i=0;!f&&i<p.length;i++)f=g[p[i]+"Request"+e],u=g[p[i]+"Cancel"+e]||g[p[i]+"CancelRequest"+e];if(!f||!u){var s=0,o=0,a=[];f=function(c){if(a.length===0){var r=m(),n=Math.max(0,1e3/60-(r-s));s=n+r,setTimeout(function(){var d=a.slice(0);a.length=0;for(var l=0;l<d.length;l++)if(!d[l].cancelled)try{d[l].callback(s)}catch(y){setTimeout(function(){throw y},0)}},Math.round(n))}return a.push({handle:++o,callback:c,cancelled:!1}),o},u=function(c){for(var r=0;r<a.length;r++)a[r].handle===c&&(a[r].cancelled=!0)}}N.exports=function(c){return f.call(g,c)},N.exports.cancel=function(){u.apply(g,arguments)},N.exports.polyfill=function(c){c||(c=g),c.requestAnimationFrame=f,c.cancelAnimationFrame=u}}).call(this)}).call(this,typeof La!="undefined"?La:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"performance-now":484}],517:[function(h,N,H){var t=h("big-rat/add");N.exports=function(m,g){for(var p=m.length,e=new Array(p),f=0;f<p;++f)e[f]=t(m[f],g[f]);return e}},{"big-rat/add":87}],518:[function(h,N,H){N.exports=function(m){for(var g=new Array(m.length),p=0;p<m.length;++p)g[p]=t(m[p]);return g};var t=h("big-rat")},{"big-rat":90}],519:[function(h,N,H){var t=h("big-rat"),m=h("big-rat/mul");N.exports=function(g,p){for(var e=t(p),f=g.length,u=new Array(f),i=0;i<f;++i)u[i]=m(g[i],e);return u}},{"big-rat":90,"big-rat/mul":99}],520:[function(h,N,H){var t=h("big-rat/sub");N.exports=function(m,g){for(var p=m.length,e=new Array(p),f=0;f<p;++f)e[f]=t(m[f],g[f]);return e}},{"big-rat/sub":101}],521:[function(h,N,H){var t=h("compare-cell"),m=h("compare-oriented-cell"),g=h("cell-orientation");N.exports=function(p){p.sort(m);for(var e=p.length,f=0,u=0;u<e;++u){var i=p[u],s=g(i);if(s!==0){if(f>0){var o=p[f-1];if(t(i,o)===0&&g(o)!==s){f-=1;continue}}p[f++]=i}}return p.length=f,p}},{"cell-orientation":123,"compare-cell":139,"compare-oriented-cell":140}],522:[function(h,N,H){var t=h("array-bounds"),m=h("color-normalize"),g=h("update-diff"),p=h("pick-by-alias"),e=h("object-assign"),f=h("flatten-vertex-data"),u=h("to-float32"),i=u.float32,s=u.fract32;N.exports=function(a,c){if(typeof a=="function"?(c||(c={}),c.regl=a):c=a,c.length&&(c.positions=c),!(a=c.regl).hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");var r,n,d,l,y,v,_=a._gl,x={color:"black",capSize:5,lineWidth:1,opacity:1,viewport:null,range:null,offset:0,count:0,bounds:null,positions:[],errors:[]},T=[];return l=a.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array(0)}),n=a.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),d=a.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),y=a.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),v=a.buffer({usage:"static",type:"float",data:o}),L(c),r=a({vert:`
		precision highp float;

		attribute vec2 position, positionFract;
		attribute vec4 error;
		attribute vec4 color;

		attribute vec2 direction, lineOffset, capOffset;

		uniform vec4 viewport;
		uniform float lineWidth, capSize;
		uniform vec2 scale, scaleFract, translate, translateFract;

		varying vec4 fragColor;

		void main() {
			fragColor = color / 255.;

			vec2 pixelOffset = lineWidth * lineOffset + (capSize + lineWidth) * capOffset;

			vec2 dxy = -step(.5, direction.xy) * error.xz + step(direction.xy, vec2(-.5)) * error.yw;

			vec2 position = position + dxy;

			vec2 pos = (position + translate) * scale
				+ (positionFract + translateFract) * scale
				+ (position + translate) * scaleFract
				+ (positionFract + translateFract) * scaleFract;

			pos += pixelOffset / viewport.zw;

			gl_Position = vec4(pos * 2. - 1., 0, 1);
		}
		`,frag:`
		precision highp float;

		varying vec4 fragColor;

		uniform float opacity;

		void main() {
			gl_FragColor = fragColor;
			gl_FragColor.a *= opacity;
		}
		`,uniforms:{range:a.prop("range"),lineWidth:a.prop("lineWidth"),capSize:a.prop("capSize"),opacity:a.prop("opacity"),scale:a.prop("scale"),translate:a.prop("translate"),scaleFract:a.prop("scaleFract"),translateFract:a.prop("translateFract"),viewport:function(C,M){return[M.viewport.x,M.viewport.y,C.viewportWidth,C.viewportHeight]}},attributes:{color:{buffer:l,offset:function(C,M){return 4*M.offset},divisor:1},position:{buffer:n,offset:function(C,M){return 8*M.offset},divisor:1},positionFract:{buffer:d,offset:function(C,M){return 8*M.offset},divisor:1},error:{buffer:y,offset:function(C,M){return 16*M.offset},divisor:1},direction:{buffer:v,stride:24,offset:0},lineOffset:{buffer:v,stride:24,offset:8},capOffset:{buffer:v,stride:24,offset:16}},primitive:"triangles",blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:!1},scissor:{enable:!0,box:a.prop("viewport")},viewport:a.prop("viewport"),stencil:!1,instances:a.prop("count"),count:o.length}),e(A,{update:L,draw:S,destroy:k,regl:a,gl:_,canvas:_.canvas,groups:T}),A;function A(C){C?L(C):C===null&&k(),S()}function S(C){if(typeof C=="number")return w(C);C&&!Array.isArray(C)&&(C=[C]),a._refresh(),T.forEach(function(M,P){M&&(C&&(C[P]?M.draw=!0:M.draw=!1),M.draw?w(P):M.draw=!0)})}function w(C){typeof C=="number"&&(C=T[C]),C!=null&&C&&C.count&&C.color&&C.opacity&&C.positions&&C.positions.length>1&&(C.scaleRatio=[C.scale[0]*C.viewport.width,C.scale[1]*C.viewport.height],r(C),C.after&&C.after(C))}function L(C){if(C){C.length!=null?typeof C[0]=="number"&&(C=[{positions:C}]):Array.isArray(C)||(C=[C]);var M=0,P=0;if(A.groups=T=C.map(function(X,G){var Y=T[G];return X&&(typeof X=="function"?X={after:X}:typeof X[0]=="number"&&(X={positions:X}),X=p(X,{color:"color colors fill",capSize:"capSize cap capsize cap-size",lineWidth:"lineWidth line-width width line thickness",opacity:"opacity alpha",range:"range dataBox",viewport:"viewport viewBox",errors:"errors error",positions:"positions position data points"}),Y||(T[G]=Y={id:G,scale:null,translate:null,scaleFract:null,translateFract:null,draw:!0},X=e({},x,X)),g(Y,X,[{lineWidth:function(K){return .5*+K},capSize:function(K){return .5*+K},opacity:parseFloat,errors:function(K){return K=f(K),P+=K.length,K},positions:function(K,D){return K=f(K,"float64"),D.count=Math.floor(K.length/2),D.bounds=t(K,2),D.offset=M,M+=D.count,K}},{color:function(K,D){var B=D.count;if(K||(K="transparent"),!Array.isArray(K)||typeof K[0]=="number"){var q=K;K=Array(B);for(var ee=0;ee<B;ee++)K[ee]=q}if(K.length<B)throw Error("Not enough colors");for(var J=new Uint8Array(4*B),$=0;$<B;$++){var te=m(K[$],"uint8");J.set(te,4*$)}return J},range:function(K,D,B){var q=D.bounds;return K||(K=q),D.scale=[1/(K[2]-K[0]),1/(K[3]-K[1])],D.translate=[-K[0],-K[1]],D.scaleFract=s(D.scale),D.translateFract=s(D.translate),K},viewport:function(K){var D;return Array.isArray(K)?D={x:K[0],y:K[1],width:K[2]-K[0],height:K[3]-K[1]}:K?(D={x:K.x||K.left||0,y:K.y||K.top||0},K.right?D.width=K.right-D.x:D.width=K.w||K.width||0,K.bottom?D.height=K.bottom-D.y:D.height=K.h||K.height||0):D={x:0,y:0,width:_.drawingBufferWidth,height:_.drawingBufferHeight},D}}])),Y}),M||P){var O=T.reduce(function(X,G,Y){return X+(G?G.count:0)},0),F=new Float64Array(2*O),j=new Uint8Array(4*O),W=new Float32Array(4*O);T.forEach(function(X,G){if(X){var Y=X.positions,K=X.count,D=X.offset,B=X.color,q=X.errors;K&&(j.set(B,4*D),W.set(q,4*D),F.set(Y,2*D))}});var Z=i(F);n(Z);var Q=s(F,Z);d(Q),l(j),y(W)}}}function k(){n.destroy(),d.destroy(),l.destroy(),y.destroy(),v.destroy()}};var o=[[1,0,0,1,0,0],[1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,1,0,0],[1,0,0,1,0,0],[1,0,-1,0,0,1],[1,0,-1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,1],[1,0,-1,0,0,1],[-1,0,-1,0,0,1],[-1,0,-1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,1],[-1,0,-1,0,0,1],[0,1,1,0,0,0],[0,1,-1,0,0,0],[0,-1,-1,0,0,0],[0,-1,-1,0,0,0],[0,1,1,0,0,0],[0,-1,1,0,0,0],[0,1,0,-1,1,0],[0,1,0,-1,-1,0],[0,1,0,1,-1,0],[0,1,0,1,1,0],[0,1,0,-1,1,0],[0,1,0,1,-1,0],[0,-1,0,-1,1,0],[0,-1,0,-1,-1,0],[0,-1,0,1,-1,0],[0,-1,0,1,1,0],[0,-1,0,-1,1,0],[0,-1,0,1,-1,0]]},{"array-bounds":76,"color-normalize":131,"flatten-vertex-data":248,"object-assign":476,"pick-by-alias":485,"to-float32":584,"update-diff":605}],523:[function(h,N,H){var t=h("color-normalize"),m=h("array-bounds"),g=h("object-assign"),p=h("glslify"),e=h("pick-by-alias"),f=h("flatten-vertex-data"),u=h("earcut"),i=h("array-normalize"),s=h("to-float32"),o=s.float32,a=s.fract32,c=h("es6-weak-map"),r=h("parse-rect"),n=h("array-find-index");function d(l,y){if(!(this instanceof d))return new d(l,y);if(typeof l=="function"?(y||(y={}),y.regl=l):y=l,y.length&&(y.positions=y),!(l=y.regl).hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");this.gl=l._gl,this.regl=l,this.passes=[],this.shaders=d.shaders.has(l)?d.shaders.get(l):d.shaders.set(l,d.createShaders(l)).get(l),this.update(y)}N.exports=d,d.dashMult=2,d.maxPatternLength=256,d.precisionThreshold=3e6,d.maxPoints=1e4,d.maxLines=2048,d.shaders=new c,d.createShaders=function(l){var y,v=l.buffer({usage:"static",type:"float",data:[0,1,0,0,1,1,1,0]}),_={primitive:"triangle strip",instances:l.prop("count"),count:4,offset:0,uniforms:{miterMode:function(T,A){return A.join==="round"?2:1},miterLimit:l.prop("miterLimit"),scale:l.prop("scale"),scaleFract:l.prop("scaleFract"),translateFract:l.prop("translateFract"),translate:l.prop("translate"),thickness:l.prop("thickness"),dashTexture:l.prop("dashTexture"),opacity:l.prop("opacity"),pixelRatio:l.context("pixelRatio"),id:l.prop("id"),dashLength:l.prop("dashLength"),viewport:function(T,A){return[A.viewport.x,A.viewport.y,T.viewportWidth,T.viewportHeight]},depth:l.prop("depth")},blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:function(T,A){return!A.overlay}},stencil:{enable:!1},scissor:{enable:!0,box:l.prop("viewport")},viewport:l.prop("viewport")},x=l(g({vert:p([`precision highp float;
#define GLSLIFY 1

attribute vec2 aCoord, bCoord, aCoordFract, bCoordFract;
attribute vec4 color;
attribute float lineEnd, lineTop;

uniform vec2 scale, scaleFract, translate, translateFract;
uniform float thickness, pixelRatio, id, depth;
uniform vec4 viewport;

varying vec4 fragColor;
varying vec2 tangent;

vec2 project(vec2 position, vec2 positionFract, vec2 scale, vec2 scaleFract, vec2 translate, vec2 translateFract) {
	// the order is important
	return position * scale + translate
       + positionFract * scale + translateFract
       + position * scaleFract
       + positionFract * scaleFract;
}

void main() {
	float lineStart = 1. - lineEnd;
	float lineOffset = lineTop * 2. - 1.;

	vec2 diff = (bCoord + bCoordFract - aCoord - aCoordFract);
	tangent = normalize(diff * scale * viewport.zw);
	vec2 normal = vec2(-tangent.y, tangent.x);

	vec2 position = project(aCoord, aCoordFract, scale, scaleFract, translate, translateFract) * lineStart
		+ project(bCoord, bCoordFract, scale, scaleFract, translate, translateFract) * lineEnd

		+ thickness * normal * .5 * lineOffset / viewport.zw;

	gl_Position = vec4(position * 2.0 - 1.0, depth, 1);

	fragColor = color / 255.;
}
`]),frag:p([`precision highp float;
#define GLSLIFY 1

uniform float dashLength, pixelRatio, thickness, opacity, id;
uniform sampler2D dashTexture;

varying vec4 fragColor;
varying vec2 tangent;

void main() {
	float alpha = 1.;

	float t = fract(dot(tangent, gl_FragCoord.xy) / dashLength) * .5 + .25;
	float dash = texture2D(dashTexture, vec2(t, .5)).r;

	gl_FragColor = fragColor;
	gl_FragColor.a *= alpha * opacity * dash;
}
`]),attributes:{lineEnd:{buffer:v,divisor:0,stride:8,offset:0},lineTop:{buffer:v,divisor:0,stride:8,offset:4},aCoord:{buffer:l.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:l.prop("positionBuffer"),stride:8,offset:16,divisor:1},aCoordFract:{buffer:l.prop("positionFractBuffer"),stride:8,offset:8,divisor:1},bCoordFract:{buffer:l.prop("positionFractBuffer"),stride:8,offset:16,divisor:1},color:{buffer:l.prop("colorBuffer"),stride:4,offset:0,divisor:1}}},_));try{y=l(g({cull:{enable:!0,face:"back"},vert:p([`precision highp float;
#define GLSLIFY 1

attribute vec2 aCoord, bCoord, nextCoord, prevCoord;
attribute vec4 aColor, bColor;
attribute float lineEnd, lineTop;

uniform vec2 scale, translate;
uniform float thickness, pixelRatio, id, depth;
uniform vec4 viewport;
uniform float miterLimit, miterMode;

varying vec4 fragColor;
varying vec4 startCutoff, endCutoff;
varying vec2 tangent;
varying vec2 startCoord, endCoord;
varying float enableStartMiter, enableEndMiter;

const float REVERSE_THRESHOLD = -.875;
const float MIN_DIFF = 1e-6;

// TODO: possible optimizations: avoid overcalculating all for vertices and calc just one instead
// TODO: precalculate dot products, normalize things beforehead etc.
// TODO: refactor to rectangular algorithm

float distToLine(vec2 p, vec2 a, vec2 b) {
	vec2 diff = b - a;
	vec2 perp = normalize(vec2(-diff.y, diff.x));
	return dot(p - a, perp);
}

bool isNaN( float val ){
  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true;
}

void main() {
	vec2 aCoord = aCoord, bCoord = bCoord, prevCoord = prevCoord, nextCoord = nextCoord;

  vec2 adjustedScale;
  adjustedScale.x = (abs(scale.x) < MIN_DIFF) ? MIN_DIFF : scale.x;
  adjustedScale.y = (abs(scale.y) < MIN_DIFF) ? MIN_DIFF : scale.y;

  vec2 scaleRatio = adjustedScale * viewport.zw;
	vec2 normalWidth = thickness / scaleRatio;

	float lineStart = 1. - lineEnd;
	float lineBot = 1. - lineTop;

	fragColor = (lineStart * aColor + lineEnd * bColor) / 255.;

	if (isNaN(aCoord.x) || isNaN(aCoord.y) || isNaN(bCoord.x) || isNaN(bCoord.y)) return;

	if (aCoord == prevCoord) prevCoord = aCoord + normalize(bCoord - aCoord);
	if (bCoord == nextCoord) nextCoord = bCoord - normalize(bCoord - aCoord);

	vec2 prevDiff = aCoord - prevCoord;
	vec2 currDiff = bCoord - aCoord;
	vec2 nextDiff = nextCoord - bCoord;

	vec2 prevTangent = normalize(prevDiff * scaleRatio);
	vec2 currTangent = normalize(currDiff * scaleRatio);
	vec2 nextTangent = normalize(nextDiff * scaleRatio);

	vec2 prevNormal = vec2(-prevTangent.y, prevTangent.x);
	vec2 currNormal = vec2(-currTangent.y, currTangent.x);
	vec2 nextNormal = vec2(-nextTangent.y, nextTangent.x);

	vec2 startJoinDirection = normalize(prevTangent - currTangent);
	vec2 endJoinDirection = normalize(currTangent - nextTangent);

	// collapsed/unidirectional segment cases
	// FIXME: there should be more elegant solution
	vec2 prevTanDiff = abs(prevTangent - currTangent);
	vec2 nextTanDiff = abs(nextTangent - currTangent);
	if (max(prevTanDiff.x, prevTanDiff.y) < MIN_DIFF) {
		startJoinDirection = currNormal;
	}
	if (max(nextTanDiff.x, nextTanDiff.y) < MIN_DIFF) {
		endJoinDirection = currNormal;
	}
	if (aCoord == bCoord) {
		endJoinDirection = startJoinDirection;
		currNormal = prevNormal;
		currTangent = prevTangent;
	}

	tangent = currTangent;

	//calculate join shifts relative to normals
	float startJoinShift = dot(currNormal, startJoinDirection);
	float endJoinShift = dot(currNormal, endJoinDirection);

	float startMiterRatio = abs(1. / startJoinShift);
	float endMiterRatio = abs(1. / endJoinShift);

	vec2 startJoin = startJoinDirection * startMiterRatio;
	vec2 endJoin = endJoinDirection * endMiterRatio;

	vec2 startTopJoin, startBotJoin, endTopJoin, endBotJoin;
	startTopJoin = sign(startJoinShift) * startJoin * .5;
	startBotJoin = -startTopJoin;

	endTopJoin = sign(endJoinShift) * endJoin * .5;
	endBotJoin = -endTopJoin;

	vec2 aTopCoord = aCoord + normalWidth * startTopJoin;
	vec2 bTopCoord = bCoord + normalWidth * endTopJoin;
	vec2 aBotCoord = aCoord + normalWidth * startBotJoin;
	vec2 bBotCoord = bCoord + normalWidth * endBotJoin;

	//miter anti-clipping
	float baClipping = distToLine(bCoord, aCoord, aBotCoord) / dot(normalize(normalWidth * endBotJoin), normalize(normalWidth.yx * vec2(-startBotJoin.y, startBotJoin.x)));
	float abClipping = distToLine(aCoord, bCoord, bTopCoord) / dot(normalize(normalWidth * startBotJoin), normalize(normalWidth.yx * vec2(-endBotJoin.y, endBotJoin.x)));

	//prevent close to reverse direction switch
	bool prevReverse = dot(currTangent, prevTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, prevNormal)) * min(length(prevDiff), length(currDiff)) <  length(normalWidth * currNormal);
	bool nextReverse = dot(currTangent, nextTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, nextNormal)) * min(length(nextDiff), length(currDiff)) <  length(normalWidth * currNormal);

	if (prevReverse) {
		//make join rectangular
		vec2 miterShift = normalWidth * startJoinDirection * miterLimit * .5;
		float normalAdjust = 1. - min(miterLimit / startMiterRatio, 1.);
		aBotCoord = aCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;
		aTopCoord = aCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;
	}
	else if (!nextReverse && baClipping > 0. && baClipping < length(normalWidth * endBotJoin)) {
		//handle miter clipping
		bTopCoord -= normalWidth * endTopJoin;
		bTopCoord += normalize(endTopJoin * normalWidth) * baClipping;
	}

	if (nextReverse) {
		//make join rectangular
		vec2 miterShift = normalWidth * endJoinDirection * miterLimit * .5;
		float normalAdjust = 1. - min(miterLimit / endMiterRatio, 1.);
		bBotCoord = bCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;
		bTopCoord = bCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;
	}
	else if (!prevReverse && abClipping > 0. && abClipping < length(normalWidth * startBotJoin)) {
		//handle miter clipping
		aBotCoord -= normalWidth * startBotJoin;
		aBotCoord += normalize(startBotJoin * normalWidth) * abClipping;
	}

	vec2 aTopPosition = (aTopCoord) * adjustedScale + translate;
	vec2 aBotPosition = (aBotCoord) * adjustedScale + translate;

	vec2 bTopPosition = (bTopCoord) * adjustedScale + translate;
	vec2 bBotPosition = (bBotCoord) * adjustedScale + translate;

	//position is normalized 0..1 coord on the screen
	vec2 position = (aTopPosition * lineTop + aBotPosition * lineBot) * lineStart + (bTopPosition * lineTop + bBotPosition * lineBot) * lineEnd;

	startCoord = aCoord * scaleRatio + translate * viewport.zw + viewport.xy;
	endCoord = bCoord * scaleRatio + translate * viewport.zw + viewport.xy;

	gl_Position = vec4(position  * 2.0 - 1.0, depth, 1);

	enableStartMiter = step(dot(currTangent, prevTangent), .5);
	enableEndMiter = step(dot(currTangent, nextTangent), .5);

	//bevel miter cutoffs
	if (miterMode == 1.) {
		if (enableStartMiter == 1.) {
			vec2 startMiterWidth = vec2(startJoinDirection) * thickness * miterLimit * .5;
			startCutoff = vec4(aCoord, aCoord);
			startCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;
			startCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			startCutoff += viewport.xyxy;
			startCutoff += startMiterWidth.xyxy;
		}

		if (enableEndMiter == 1.) {
			vec2 endMiterWidth = vec2(endJoinDirection) * thickness * miterLimit * .5;
			endCutoff = vec4(bCoord, bCoord);
			endCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;
			endCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			endCutoff += viewport.xyxy;
			endCutoff += endMiterWidth.xyxy;
		}
	}

	//round miter cutoffs
	else if (miterMode == 2.) {
		if (enableStartMiter == 1.) {
			vec2 startMiterWidth = vec2(startJoinDirection) * thickness * abs(dot(startJoinDirection, currNormal)) * .5;
			startCutoff = vec4(aCoord, aCoord);
			startCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;
			startCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			startCutoff += viewport.xyxy;
			startCutoff += startMiterWidth.xyxy;
		}

		if (enableEndMiter == 1.) {
			vec2 endMiterWidth = vec2(endJoinDirection) * thickness * abs(dot(endJoinDirection, currNormal)) * .5;
			endCutoff = vec4(bCoord, bCoord);
			endCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;
			endCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			endCutoff += viewport.xyxy;
			endCutoff += endMiterWidth.xyxy;
		}
	}
}
`]),frag:p([`precision highp float;
#define GLSLIFY 1

uniform float dashLength, pixelRatio, thickness, opacity, id, miterMode;
uniform sampler2D dashTexture;

varying vec4 fragColor;
varying vec2 tangent;
varying vec4 startCutoff, endCutoff;
varying vec2 startCoord, endCoord;
varying float enableStartMiter, enableEndMiter;

float distToLine(vec2 p, vec2 a, vec2 b) {
	vec2 diff = b - a;
	vec2 perp = normalize(vec2(-diff.y, diff.x));
	return dot(p - a, perp);
}

void main() {
	float alpha = 1., distToStart, distToEnd;
	float cutoff = thickness * .5;

	//bevel miter
	if (miterMode == 1.) {
		if (enableStartMiter == 1.) {
			distToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);
			if (distToStart < -1.) {
				discard;
				return;
			}
			alpha *= min(max(distToStart + 1., 0.), 1.);
		}

		if (enableEndMiter == 1.) {
			distToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);
			if (distToEnd < -1.) {
				discard;
				return;
			}
			alpha *= min(max(distToEnd + 1., 0.), 1.);
		}
	}

	// round miter
	else if (miterMode == 2.) {
		if (enableStartMiter == 1.) {
			distToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);
			if (distToStart < 0.) {
				float radius = length(gl_FragCoord.xy - startCoord);

				if(radius > cutoff + .5) {
					discard;
					return;
				}

				alpha -= smoothstep(cutoff - .5, cutoff + .5, radius);
			}
		}

		if (enableEndMiter == 1.) {
			distToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);
			if (distToEnd < 0.) {
				float radius = length(gl_FragCoord.xy - endCoord);

				if(radius > cutoff + .5) {
					discard;
					return;
				}

				alpha -= smoothstep(cutoff - .5, cutoff + .5, radius);
			}
		}
	}

	float t = fract(dot(tangent, gl_FragCoord.xy) / dashLength) * .5 + .25;
	float dash = texture2D(dashTexture, vec2(t, .5)).r;

	gl_FragColor = fragColor;
	gl_FragColor.a *= alpha * opacity * dash;
}
`]),attributes:{lineEnd:{buffer:v,divisor:0,stride:8,offset:0},lineTop:{buffer:v,divisor:0,stride:8,offset:4},aColor:{buffer:l.prop("colorBuffer"),stride:4,offset:0,divisor:1},bColor:{buffer:l.prop("colorBuffer"),stride:4,offset:4,divisor:1},prevCoord:{buffer:l.prop("positionBuffer"),stride:8,offset:0,divisor:1},aCoord:{buffer:l.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:l.prop("positionBuffer"),stride:8,offset:16,divisor:1},nextCoord:{buffer:l.prop("positionBuffer"),stride:8,offset:24,divisor:1}}},_))}catch(T){y=x}return{fill:l({primitive:"triangle",elements:function(T,A){return A.triangles},offset:0,vert:p([`precision highp float;
#define GLSLIFY 1

attribute vec2 position, positionFract;

uniform vec4 color;
uniform vec2 scale, scaleFract, translate, translateFract;
uniform float pixelRatio, id;
uniform vec4 viewport;
uniform float opacity;

varying vec4 fragColor;

const float MAX_LINES = 256.;

void main() {
	float depth = (MAX_LINES - 4. - id) / (MAX_LINES);

	vec2 position = position * scale + translate
       + positionFract * scale + translateFract
       + position * scaleFract
       + positionFract * scaleFract;

	gl_Position = vec4(position * 2.0 - 1.0, depth, 1);

	fragColor = color / 255.;
	fragColor.a *= opacity;
}
`]),frag:p([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
	gl_FragColor = fragColor;
}
`]),uniforms:{scale:l.prop("scale"),color:l.prop("fill"),scaleFract:l.prop("scaleFract"),translateFract:l.prop("translateFract"),translate:l.prop("translate"),opacity:l.prop("opacity"),pixelRatio:l.context("pixelRatio"),id:l.prop("id"),viewport:function(T,A){return[A.viewport.x,A.viewport.y,T.viewportWidth,T.viewportHeight]}},attributes:{position:{buffer:l.prop("positionBuffer"),stride:8,offset:8},positionFract:{buffer:l.prop("positionFractBuffer"),stride:8,offset:8}},blend:_.blend,depth:{enable:!1},scissor:_.scissor,stencil:_.stencil,viewport:_.viewport}),rect:x,miter:y}},d.defaults={dashes:null,join:"miter",miterLimit:1,thickness:10,cap:"square",color:"black",opacity:1,overlay:!1,viewport:null,range:null,close:!1,fill:null},d.prototype.render=function(){for(var l,y=[],v=arguments.length;v--;)y[v]=arguments[v];y.length&&(l=this).update.apply(l,y),this.draw()},d.prototype.draw=function(){for(var l=this,y=[],v=arguments.length;v--;)y[v]=arguments[v];return(y.length?y:this.passes).forEach(function(_,x){var T;if(_&&Array.isArray(_))return(T=l).draw.apply(T,_);typeof _=="number"&&(_=l.passes[_]),_&&_.count>1&&_.opacity&&(l.regl._refresh(),_.fill&&_.triangles&&_.triangles.length>2&&l.shaders.fill(_),_.thickness&&(_.scale[0]*_.viewport.width>d.precisionThreshold||_.scale[1]*_.viewport.height>d.precisionThreshold||_.join==="rect"||!_.join&&(_.thickness<=2||_.count>=d.maxPoints)?l.shaders.rect(_):l.shaders.miter(_)))}),this},d.prototype.update=function(l){var y=this;if(l){l.length!=null?typeof l[0]=="number"&&(l=[{positions:l}]):Array.isArray(l)||(l=[l]);var v=this.regl,_=this.gl;if(l.forEach(function(w,L){var k=y.passes[L];if(w!==void 0)if(w!==null){if(typeof w[0]=="number"&&(w={positions:w}),w=e(w,{positions:"positions points data coords",thickness:"thickness lineWidth lineWidths line-width linewidth width stroke-width strokewidth strokeWidth",join:"lineJoin linejoin join type mode",miterLimit:"miterlimit miterLimit",dashes:"dash dashes dasharray dash-array dashArray",color:"color colour stroke colors colours stroke-color strokeColor",fill:"fill fill-color fillColor",opacity:"alpha opacity",overlay:"overlay crease overlap intersect",close:"closed close closed-path closePath",range:"range dataBox",viewport:"viewport viewBox",hole:"holes hole hollow",splitNull:"splitNull"}),k||(y.passes[L]=k={id:L,scale:null,scaleFract:null,translate:null,translateFract:null,count:0,hole:[],depth:0,dashLength:1,dashTexture:v.texture({channels:1,data:new Uint8Array([255]),width:1,height:1,mag:"linear",min:"linear"}),colorBuffer:v.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array}),positionBuffer:v.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),positionFractBuffer:v.buffer({usage:"dynamic",type:"float",data:new Uint8Array})},w=g({},d.defaults,w)),w.thickness!=null&&(k.thickness=parseFloat(w.thickness)),w.opacity!=null&&(k.opacity=parseFloat(w.opacity)),w.miterLimit!=null&&(k.miterLimit=parseFloat(w.miterLimit)),w.overlay!=null&&(k.overlay=!!w.overlay,L<d.maxLines&&(k.depth=2*(d.maxLines-1-L%d.maxLines)/d.maxLines-1)),w.join!=null&&(k.join=w.join),w.hole!=null&&(k.hole=w.hole),w.fill!=null&&(k.fill=w.fill?t(w.fill,"uint8"):null),w.viewport!=null&&(k.viewport=r(w.viewport)),k.viewport||(k.viewport=r([_.drawingBufferWidth,_.drawingBufferHeight])),w.close!=null&&(k.close=w.close),w.positions===null&&(w.positions=[]),w.positions){var C,M;if(w.positions.x&&w.positions.y){var P=w.positions.x,O=w.positions.y;M=k.count=Math.max(P.length,O.length),C=new Float64Array(2*M);for(var F=0;F<M;F++)C[2*F]=P[F],C[2*F+1]=O[F]}else C=f(w.positions,"float64"),M=k.count=Math.floor(C.length/2);var j=k.bounds=m(C,2);if(k.fill){for(var W=[],Z={},Q=0,X=0,G=0,Y=k.count;X<Y;X++){var K=C[2*X],D=C[2*X+1];isNaN(K)||isNaN(D)||K==null||D==null?(K=C[2*Q],D=C[2*Q+1],Z[X]=Q):Q=X,W[G++]=K,W[G++]=D}if(w.splitNull){k.count-1 in Z||(Z[k.count]=k.count-1);var B=Object.keys(Z).map(Number).sort(function(xt,Qt){return xt-Qt}),q=[],ee=0,J=k.hole!=null?k.hole[0]:null;if(J!=null){var $=n(B,function(xt){return xt>=J});(B=B.slice(0,$)).push(J)}for(var te=function(xt){var Qt=W.slice(2*ee,2*B[xt]).concat(J?W.slice(2*J):[]),$t=(k.hole||[]).map(function(He){return He-J+(B[xt]-ee)}),Ue=u(Qt,$t);Ue=Ue.map(function(He){return He+ee+(He+ee<B[xt]?0:J-B[xt])}),q.push.apply(q,Ue),ee=B[xt]+1},ie=0;ie<B.length;ie++)te(ie);for(var ae=0,he=q.length;ae<he;ae++)Z[q[ae]]!=null&&(q[ae]=Z[q[ae]]);k.triangles=q}else{for(var se=u(W,k.hole||[]),de=0,ce=se.length;de<ce;de++)Z[se[de]]!=null&&(se[de]=Z[se[de]]);k.triangles=se}}var ve=new Float64Array(C);i(ve,2,j);var ke=new Float64Array(2*M+6);k.close?C[0]===C[2*M-2]&&C[1]===C[2*M-1]?(ke[0]=ve[2*M-4],ke[1]=ve[2*M-3]):(ke[0]=ve[2*M-2],ke[1]=ve[2*M-1]):(ke[0]=ve[0],ke[1]=ve[1]),ke.set(ve,2),k.close?C[0]===C[2*M-2]&&C[1]===C[2*M-1]?(ke[2*M+2]=ve[2],ke[2*M+3]=ve[3],k.count-=1):(ke[2*M+2]=ve[0],ke[2*M+3]=ve[1],ke[2*M+4]=ve[2],ke[2*M+5]=ve[3]):(ke[2*M+2]=ve[2*M-2],ke[2*M+3]=ve[2*M-1],ke[2*M+4]=ve[2*M-2],ke[2*M+5]=ve[2*M-1]);var Ee=o(ke);k.positionBuffer(Ee);var be=a(ke,Ee);k.positionFractBuffer(be)}if(w.range?k.range=w.range:k.range||(k.range=k.bounds),(w.range||w.positions)&&k.count){var xe=k.bounds,ue=xe[2]-xe[0],me=xe[3]-xe[1],we=k.range[2]-k.range[0],Me=k.range[3]-k.range[1];k.scale=[ue/we,me/Me],k.translate=[-k.range[0]/we+xe[0]/we||0,-k.range[1]/Me+xe[1]/Me||0],k.scaleFract=a(k.scale),k.translateFract=a(k.translate)}if(w.dashes){var Se,De=0;if(!w.dashes||w.dashes.length<2)De=1,Se=new Uint8Array([255,255,255,255,255,255,255,255]);else{De=0;for(var Fe=0;Fe<w.dashes.length;++Fe)De+=w.dashes[Fe];Se=new Uint8Array(De*d.dashMult);for(var Ye=0,et=255,Oe=0;Oe<2;Oe++)for(var je=0;je<w.dashes.length;++je){for(var We=0,Ge=w.dashes[je]*d.dashMult*.5;We<Ge;++We)Se[Ye++]=et;et^=255}}k.dashLength=De,k.dashTexture({channels:1,data:Se,width:Se.length,height:1,mag:"linear",min:"linear"},0,0)}if(w.color){var Qe=k.count,it=w.color;it||(it="transparent");var lt=new Uint8Array(4*Qe+4);if(Array.isArray(it)&&typeof it[0]!="number"){for(var Lt=0;Lt<Qe;Lt++){var wt=t(it[Lt],"uint8");lt.set(wt,4*Lt)}lt.set(t(it[0],"uint8"),4*Qe)}else for(var rt=t(it,"uint8"),$e=0;$e<Qe+1;$e++)lt.set(rt,4*$e);k.colorBuffer({usage:"dynamic",type:"uint8",data:lt})}}else y.passes[L]=null}),l.length<this.passes.length){for(var x=l.length;x<this.passes.length;x++){var T=this.passes[x];T&&(T.colorBuffer.destroy(),T.positionBuffer.destroy(),T.dashTexture.destroy())}this.passes.length=l.length}for(var A=[],S=0;S<this.passes.length;S++)this.passes[S]!==null&&A.push(this.passes[S]);return this.passes=A,this}},d.prototype.destroy=function(){return this.passes.forEach(function(l){l.colorBuffer.destroy(),l.positionBuffer.destroy(),l.dashTexture.destroy()}),this.passes.length=0,this}},{"array-bounds":76,"array-find-index":77,"array-normalize":78,"color-normalize":131,earcut:183,"es6-weak-map":238,"flatten-vertex-data":248,glslify:434,"object-assign":476,"parse-rect":481,"pick-by-alias":485,"to-float32":584}],524:[function(h,N,H){function t(x,T){return function(A){if(Array.isArray(A))return A}(x)||function(A,S){var w=A==null?null:typeof Symbol!="undefined"&&A[Symbol.iterator]||A["@@iterator"];if(w!=null){var L,k,C=[],M=!0,P=!1;try{for(w=w.call(A);!(M=(L=w.next()).done)&&(C.push(L.value),!S||C.length!==S);M=!0);}catch(O){P=!0,k=O}finally{try{M||w.return==null||w.return()}finally{if(P)throw k}}return C}}(x,T)||g(x,T)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function m(x){return function(T){if(Array.isArray(T))return p(T)}(x)||function(T){if(typeof Symbol!="undefined"&&T[Symbol.iterator]!=null||T["@@iterator"]!=null)return Array.from(T)}(x)||g(x)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function g(x,T){if(x){if(typeof x=="string")return p(x,T);var A=Object.prototype.toString.call(x).slice(8,-1);return A==="Object"&&x.constructor&&(A=x.constructor.name),A==="Map"||A==="Set"?Array.from(x):A==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(A)?p(x,T):void 0}}function p(x,T){(T==null||T>x.length)&&(T=x.length);for(var A=0,S=new Array(T);A<T;A++)S[A]=x[A];return S}var e=h("color-normalize"),f=h("array-bounds"),u=h("color-id"),i=h("@plotly/point-cluster"),s=h("object-assign"),o=h("glslify"),a=h("pick-by-alias"),c=h("update-diff"),r=h("flatten-vertex-data"),n=h("is-iexplorer"),d=h("to-float32"),l=h("parse-rect"),y=v;function v(x,T){var A=this;if(!(this instanceof v))return new v(x,T);typeof x=="function"?(T||(T={}),T.regl=x):(T=x,x=null),T&&T.length&&(T.positions=T);var S,w=(x=T.regl)._gl,L=[];this.tooManyColors=n,S=x.texture({data:new Uint8Array(1020),width:255,height:1,type:"uint8",format:"rgba",wrapS:"clamp",wrapT:"clamp",mag:"nearest",min:"nearest"}),s(this,{regl:x,gl:w,groups:[],markerCache:[null],markerTextures:[null],palette:L,paletteIds:{},paletteTexture:S,maxColors:255,maxSize:100,canvas:w.canvas}),this.update(T);var k={uniforms:{constPointSize:!!T.constPointSize,opacity:x.prop("opacity"),paletteSize:function(P,O){return[A.tooManyColors?0:255,S.height]},pixelRatio:x.context("pixelRatio"),scale:x.prop("scale"),scaleFract:x.prop("scaleFract"),translate:x.prop("translate"),translateFract:x.prop("translateFract"),markerTexture:x.prop("markerTexture"),paletteTexture:S},attributes:{x:function(P,O){return O.xAttr||{buffer:O.positionBuffer,stride:8,offset:0}},y:function(P,O){return O.yAttr||{buffer:O.positionBuffer,stride:8,offset:4}},xFract:function(P,O){return O.xAttr?{constant:[0,0]}:{buffer:O.positionFractBuffer,stride:8,offset:0}},yFract:function(P,O){return O.yAttr?{constant:[0,0]}:{buffer:O.positionFractBuffer,stride:8,offset:4}},size:function(P,O){return O.size.length?{buffer:O.sizeBuffer,stride:2,offset:0}:{constant:[Math.round(255*O.size/A.maxSize)]}},borderSize:function(P,O){return O.borderSize.length?{buffer:O.sizeBuffer,stride:2,offset:1}:{constant:[Math.round(255*O.borderSize/A.maxSize)]}},colorId:function(P,O){return O.color.length?{buffer:O.colorBuffer,stride:A.tooManyColors?8:4,offset:0}:{constant:A.tooManyColors?L.slice(4*O.color,4*O.color+4):[O.color]}},borderColorId:function(P,O){return O.borderColor.length?{buffer:O.colorBuffer,stride:A.tooManyColors?8:4,offset:A.tooManyColors?4:2}:{constant:A.tooManyColors?L.slice(4*O.borderColor,4*O.borderColor+4):[O.borderColor]}},isActive:function(P,O){return O.activation===!0?{constant:[1]}:O.activation?O.activation:{constant:[0]}}},blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},scissor:{enable:!0,box:x.prop("viewport")},viewport:x.prop("viewport"),stencil:{enable:!1},depth:{enable:!1},elements:x.prop("elements"),count:x.prop("count"),offset:x.prop("offset"),primitive:"points"},C=s({},k);C.frag=o([`precision highp float;
#define GLSLIFY 1

uniform float opacity;
uniform sampler2D markerTexture;

varying vec4 fragColor, fragBorderColor;
varying float fragWidth, fragBorderColorLevel, fragColorLevel;

float smoothStep(float x, float y) {
  return 1.0 / (1.0 + exp(50.0*(x - y)));
}

void main() {
  float dist = texture2D(markerTexture, gl_PointCoord).r, delta = fragWidth;

  // max-distance alpha
  if (dist < 0.003) discard;

  // null-border case
  if (fragBorderColorLevel == fragColorLevel || fragBorderColor.a == 0.) {
    float colorAmt = smoothstep(.5 - delta, .5 + delta, dist);
    gl_FragColor = vec4(fragColor.rgb, colorAmt * fragColor.a * opacity);
  }
  else {
    float borderColorAmt = smoothstep(fragBorderColorLevel - delta, fragBorderColorLevel + delta, dist);
    float colorAmt = smoothstep(fragColorLevel - delta, fragColorLevel + delta, dist);

    vec4 color = fragBorderColor;
    color.a *= borderColorAmt;
    color = mix(color, fragColor, colorAmt);
    color.a *= opacity;

    gl_FragColor = color;
  }

}
`]),C.vert=o([`precision highp float;
#define GLSLIFY 1

attribute float x, y, xFract, yFract;
attribute float size, borderSize;
attribute vec4 colorId, borderColorId;
attribute float isActive;

uniform bool constPointSize;
uniform float pixelRatio;
uniform vec2 scale, scaleFract, translate, translateFract, paletteSize;
uniform sampler2D paletteTexture;

const float maxSize = 100.;
const float borderLevel = .5;

varying vec4 fragColor, fragBorderColor;
varying float fragPointSize, fragBorderRadius, fragWidth, fragBorderColorLevel, fragColorLevel;

float pointSizeScale = (constPointSize) ? 2. : pixelRatio;

bool isDirect = (paletteSize.x < 1.);

vec4 getColor(vec4 id) {
  return isDirect ? id / 255. : texture2D(paletteTexture,
    vec2(
      (id.x + .5) / paletteSize.x,
      (id.y + .5) / paletteSize.y
    )
  );
}

void main() {
  // ignore inactive points
  if (isActive == 0.) return;

  vec2 position = vec2(x, y);
  vec2 positionFract = vec2(xFract, yFract);

  vec4 color = getColor(colorId);
  vec4 borderColor = getColor(borderColorId);

  float size = size * maxSize / 255.;
  float borderSize = borderSize * maxSize / 255.;

  gl_PointSize = 2. * size * pointSizeScale;
  fragPointSize = size * pixelRatio;

  vec2 pos = (position + translate) * scale
      + (positionFract + translateFract) * scale
      + (position + translate) * scaleFract
      + (positionFract + translateFract) * scaleFract;

  gl_Position = vec4(pos * 2. - 1., 0., 1.);

  fragColor = color;
  fragBorderColor = borderColor;
  fragWidth = 1. / gl_PointSize;

  fragBorderColorLevel = clamp(borderLevel - borderLevel * borderSize / size, 0., 1.);
  fragColorLevel = clamp(borderLevel + (1. - borderLevel) * borderSize / size, 0., 1.);
}`]),this.drawMarker=x(C);var M=s({},k);M.frag=o([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor, fragBorderColor;
varying float fragBorderRadius, fragWidth;

uniform float opacity;

float smoothStep(float edge0, float edge1, float x) {
	float t;
	t = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);
	return t * t * (3.0 - 2.0 * t);
}

void main() {
	float radius, alpha = 1.0, delta = fragWidth;

	radius = length(2.0 * gl_PointCoord.xy - 1.0);

	if (radius > 1.0 + delta) {
		discard;
	}

	alpha -= smoothstep(1.0 - delta, 1.0 + delta, radius);

	float borderRadius = fragBorderRadius;
	float ratio = smoothstep(borderRadius - delta, borderRadius + delta, radius);
	vec4 color = mix(fragColor, fragBorderColor, ratio);
	color.a *= alpha * opacity;
	gl_FragColor = color;
}
`]),M.vert=o([`precision highp float;
#define GLSLIFY 1

attribute float x, y, xFract, yFract;
attribute float size, borderSize;
attribute vec4 colorId, borderColorId;
attribute float isActive;

uniform bool constPointSize;
uniform float pixelRatio;
uniform vec2 paletteSize, scale, scaleFract, translate, translateFract;
uniform sampler2D paletteTexture;

const float maxSize = 100.;

varying vec4 fragColor, fragBorderColor;
varying float fragBorderRadius, fragWidth;

float pointSizeScale = (constPointSize) ? 2. : pixelRatio;

bool isDirect = (paletteSize.x < 1.);

vec4 getColor(vec4 id) {
  return isDirect ? id / 255. : texture2D(paletteTexture,
    vec2(
      (id.x + .5) / paletteSize.x,
      (id.y + .5) / paletteSize.y
    )
  );
}

void main() {
  // ignore inactive points
  if (isActive == 0.) return;

  vec2 position = vec2(x, y);
  vec2 positionFract = vec2(xFract, yFract);

  vec4 color = getColor(colorId);
  vec4 borderColor = getColor(borderColorId);

  float size = size * maxSize / 255.;
  float borderSize = borderSize * maxSize / 255.;

  gl_PointSize = (size + borderSize) * pointSizeScale;

  vec2 pos = (position + translate) * scale
      + (positionFract + translateFract) * scale
      + (position + translate) * scaleFract
      + (positionFract + translateFract) * scaleFract;

  gl_Position = vec4(pos * 2. - 1., 0., 1.);

  fragBorderRadius = 1. - 2. * borderSize / (size + borderSize);
  fragColor = color;
  fragBorderColor = borderColor.a == 0. || borderSize == 0. ? vec4(color.rgb, 0.) : borderColor;
  fragWidth = 1. / gl_PointSize;
}
`]),n&&(M.frag=M.frag.replace("smoothstep","smoothStep"),C.frag=C.frag.replace("smoothstep","smoothStep")),this.drawCircle=x(M)}v.defaults={color:"black",borderColor:"transparent",borderSize:0,size:12,opacity:1,marker:void 0,viewport:null,range:null,pixelSize:null,count:0,offset:0,bounds:null,positions:[],snap:1e4},v.prototype.render=function(){return arguments.length&&this.update.apply(this,arguments),this.draw(),this},v.prototype.draw=function(){for(var x=this,T=arguments.length,A=new Array(T),S=0;S<T;S++)A[S]=arguments[S];var w=this.groups;if(A.length===1&&Array.isArray(A[0])&&(A[0][0]===null||Array.isArray(A[0][0]))&&(A=A[0]),this.regl._refresh(),A.length)for(var L=0;L<A.length;L++)this.drawItem(L,A[L]);else w.forEach(function(k,C){x.drawItem(C)});return this},v.prototype.drawItem=function(x,T){var A=this.groups,S=A[x];if(typeof T=="number"&&(x=T,S=A[T],T=null),S&&S.count&&S.opacity){S.activation[0]&&this.drawCircle(this.getMarkerDrawOptions(0,S,T));for(var w=[],L=1;L<S.activation.length;L++)S.activation[L]&&(S.activation[L]===!0||S.activation[L].data.length)&&w.push.apply(w,m(this.getMarkerDrawOptions(L,S,T)));w.length&&this.drawMarker(w)}},v.prototype.getMarkerDrawOptions=function(x,T,A){var S=T.range,w=T.tree,L=T.viewport,k=T.activation,C=T.selectionBuffer,M=T.count;if(this.regl,!w)return A?[s({},T,{markerTexture:this.markerTextures[x],activation:k[x],count:A.length,elements:A,offset:0})]:[s({},T,{markerTexture:this.markerTextures[x],activation:k[x],offset:0})];var P=[],O=w.range(S,{lod:!0,px:[(S[2]-S[0])/L.width,(S[3]-S[1])/L.height]});if(A){for(var F=k[x].data,j=new Uint8Array(M),W=0;W<A.length;W++){var Z=A[W];j[Z]=F?F[Z]:1}C.subdata(j)}for(var Q=O.length;Q--;){var X=t(O[Q],2),G=X[0],Y=X[1];P.push(s({},T,{markerTexture:this.markerTextures[x],activation:A?C:k[x],offset:G,count:Y-G}))}return P},v.prototype.update=function(){for(var x=this,T=arguments.length,A=new Array(T),S=0;S<T;S++)A[S]=arguments[S];if(A.length){A.length===1&&Array.isArray(A[0])&&(A=A[0]);var w=this.groups,L=this.gl,k=this.regl,C=this.maxSize,M=this.maxColors,P=this.palette;this.groups=w=A.map(function(O,F){var j=w[F];if(O===void 0)return j;O===null?O={positions:null}:typeof O=="function"?O={ondraw:O}:typeof O[0]=="number"&&(O={positions:O}),(O=a(O,{positions:"positions data points",snap:"snap cluster lod tree",size:"sizes size radius",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",color:"colors color fill fill-color fillColor",borderColor:"borderColors borderColor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range dataBox databox",viewport:"viewport viewPort viewBox viewbox",opacity:"opacity alpha transparency",bounds:"bound bounds boundaries limits",tooManyColors:"tooManyColors palette paletteMode optimizePalette enablePalette"})).positions===null&&(O.positions=[]),O.tooManyColors!=null&&(x.tooManyColors=O.tooManyColors),j||(w[F]=j={id:F,scale:null,translate:null,scaleFract:null,translateFract:null,activation:[],selectionBuffer:k.buffer({data:new Uint8Array(0),usage:"stream",type:"uint8"}),sizeBuffer:k.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),colorBuffer:k.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),positionBuffer:k.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"}),positionFractBuffer:k.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"})},O=s({},v.defaults,O)),O.positions&&!("marker"in O)&&(O.marker=j.marker,delete j.marker),O.marker&&!("positions"in O)&&(O.positions=j.positions,delete j.positions);var W=0,Z=0;if(c(j,O,[{snap:!0,size:function(ce,ve){return ce==null&&(ce=v.defaults.size),W+=ce&&ce.length?1:0,ce},borderSize:function(ce,ve){return ce==null&&(ce=v.defaults.borderSize),W+=ce&&ce.length?1:0,ce},opacity:parseFloat,color:function(ce,ve){return ce==null&&(ce=v.defaults.color),ce=x.updateColor(ce),Z++,ce},borderColor:function(ce,ve){return ce==null&&(ce=v.defaults.borderColor),ce=x.updateColor(ce),Z++,ce},bounds:function(ce,ve,ke){return"range"in ke||(ke.range=null),ce},positions:function(ce,ve,ke){var Ee=ve.snap,be=ve.positionBuffer,xe=ve.positionFractBuffer,ue=ve.selectionBuffer;if(ce.x||ce.y)return ce.x.length?ve.xAttr={buffer:k.buffer(ce.x),offset:0,stride:4,count:ce.x.length}:ve.xAttr={buffer:ce.x.buffer,offset:4*ce.x.offset||0,stride:4*(ce.x.stride||1),count:ce.x.count},ce.y.length?ve.yAttr={buffer:k.buffer(ce.y),offset:0,stride:4,count:ce.y.length}:ve.yAttr={buffer:ce.y.buffer,offset:4*ce.y.offset||0,stride:4*(ce.y.stride||1),count:ce.y.count},ve.count=Math.max(ve.xAttr.count,ve.yAttr.count),ce;ce=r(ce,"float64");var me=ve.count=Math.floor(ce.length/2),we=ve.bounds=me?f(ce,2):null;if(ke.range||ve.range||(delete ve.range,ke.range=we),ke.marker||ve.marker||(delete ve.marker,ke.marker=null),Ee&&(Ee===!0||me>Ee)?ve.tree=i(ce,{bounds:we}):Ee&&Ee.length&&(ve.tree=Ee),ve.tree){var Me={primitive:"points",usage:"static",data:ve.tree,type:"uint32"};ve.elements?ve.elements(Me):ve.elements=k.elements(Me)}var Se=d.float32(ce);return be({data:Se,usage:"dynamic"}),xe({data:d.fract32(ce,Se),usage:"dynamic"}),ue({data:new Uint8Array(me),type:"uint8",usage:"stream"}),ce}},{marker:function(ce,ve,ke){var Ee=ve.activation;if(Ee.forEach(function(Se){return Se&&Se.destroy&&Se.destroy()}),Ee.length=0,ce&&typeof ce[0]!="number"){for(var be=[],xe=0,ue=Math.min(ce.length,ve.count);xe<ue;xe++){var me=x.addMarker(ce[xe]);be[me]||(be[me]=new Uint8Array(ve.count)),be[me][xe]=1}for(var we=0;we<be.length;we++)if(be[we]){var Me={data:be[we],type:"uint8",usage:"static"};Ee[we]?Ee[we](Me):Ee[we]=k.buffer(Me),Ee[we].data=be[we]}}else Ee[x.addMarker(ce)]=!0;return ce},range:function(ce,ve,ke){var Ee=ve.bounds;if(Ee)return ce||(ce=Ee),ve.scale=[1/(ce[2]-ce[0]),1/(ce[3]-ce[1])],ve.translate=[-ce[0],-ce[1]],ve.scaleFract=d.fract(ve.scale),ve.translateFract=d.fract(ve.translate),ce},viewport:function(ce){return l(ce||[L.drawingBufferWidth,L.drawingBufferHeight])}}]),W){var Q=j,X=Q.count,G=Q.size,Y=Q.borderSize,K=Q.sizeBuffer,D=new Uint8Array(2*X);if(G.length||Y.length)for(var B=0;B<X;B++)D[2*B]=Math.round(255*(G[B]==null?G:G[B])/C),D[2*B+1]=Math.round(255*(Y[B]==null?Y:Y[B])/C);K({data:D,usage:"dynamic"})}if(Z){var q,ee=j,J=ee.count,$=ee.color,te=ee.borderColor,ie=ee.colorBuffer;if(x.tooManyColors){if($.length||te.length){q=new Uint8Array(8*J);for(var ae=0;ae<J;ae++){var he=$[ae];q[8*ae]=P[4*he],q[8*ae+1]=P[4*he+1],q[8*ae+2]=P[4*he+2],q[8*ae+3]=P[4*he+3];var se=te[ae];q[8*ae+4]=P[4*se],q[8*ae+5]=P[4*se+1],q[8*ae+6]=P[4*se+2],q[8*ae+7]=P[4*se+3]}}}else if($.length||te.length){q=new Uint8Array(4*J+2);for(var de=0;de<J;de++)$[de]!=null&&(q[4*de]=$[de]%M,q[4*de+1]=Math.floor($[de]/M)),te[de]!=null&&(q[4*de+2]=te[de]%M,q[4*de+3]=Math.floor(te[de]/M))}ie({data:q||new Uint8Array(0),type:"uint8",usage:"dynamic"})}return j})}},v.prototype.addMarker=function(x){var T,A=this.markerTextures,S=this.regl,w=this.markerCache,L=x==null?0:w.indexOf(x);if(L>=0)return L;if(x instanceof Uint8Array||x instanceof Uint8ClampedArray)T=x;else{T=new Uint8Array(x.length);for(var k=0,C=x.length;k<C;k++)T[k]=255*x[k]}var M=Math.floor(Math.sqrt(T.length));return L=A.length,w.push(x),A.push(S.texture({channels:1,data:T,radius:M,mag:"linear",min:"linear"})),L},v.prototype.updateColor=function(x){var T=this.paletteIds,A=this.palette,S=this.maxColors;Array.isArray(x)||(x=[x]);var w=[];if(typeof x[0]=="number"){var L=[];if(Array.isArray(x))for(var k=0;k<x.length;k+=4)L.push(x.slice(k,k+4));else for(var C=0;C<x.length;C+=4)L.push(x.subarray(C,C+4));x=L}for(var M=0;M<x.length;M++){var P=x[M];P=e(P,"uint8");var O=u(P,!1);if(T[O]==null){var F=A.length;T[O]=Math.floor(F/4),A[F]=P[0],A[F+1]=P[1],A[F+2]=P[2],A[F+3]=P[3]}w[M]=T[O]}return!this.tooManyColors&&A.length>4*S&&(this.tooManyColors=!0),this.updatePalette(A),w.length===1?w[0]:w},v.prototype.updatePalette=function(x){if(!this.tooManyColors){var T=this.maxColors,A=this.paletteTexture,S=Math.ceil(.25*x.length/T);if(S>1)for(var w=.25*(x=x.slice()).length%T;w<S*T;w++)x.push(0,0,0,0);A.height<S&&A.resize(T,S),A.subimage({width:Math.min(.25*x.length,T),height:S,data:x},0,0)}},v.prototype.destroy=function(){return this.groups.forEach(function(x){x.sizeBuffer.destroy(),x.positionBuffer.destroy(),x.positionFractBuffer.destroy(),x.colorBuffer.destroy(),x.activation.forEach(function(T){return T&&T.destroy&&T.destroy()}),x.selectionBuffer.destroy(),x.elements&&x.elements.destroy()}),this.groups.length=0,this.paletteTexture.destroy(),this.markerTextures.forEach(function(x){return x&&x.destroy&&x.destroy()}),this};var _=h("object-assign");N.exports=function(x,T){var A=new y(x,T),S=A.render.bind(A);return _(S,{render:S,update:A.update.bind(A),draw:A.draw.bind(A),destroy:A.destroy.bind(A),regl:A.regl,gl:A.gl,canvas:A.gl.canvas,groups:A.groups,markers:A.markerCache,palette:A.palette}),S}},{"@plotly/point-cluster":59,"array-bounds":76,"color-id":129,"color-normalize":131,"flatten-vertex-data":248,glslify:434,"is-iexplorer":444,"object-assign":476,"parse-rect":481,"pick-by-alias":485,"to-float32":584,"update-diff":605}],525:[function(h,N,H){var t=h("regl-scatter2d"),m=h("pick-by-alias"),g=h("array-bounds"),p=h("raf"),e=h("array-range"),f=h("parse-rect"),u=h("flatten-vertex-data");function i(c,r){if(!(this instanceof i))return new i(c,r);this.traces=[],this.passes={},this.regl=c,this.scatter=t(c),this.canvas=this.scatter.canvas}function s(c,r,n){return(c.id!=null?c.id:c)<<16|(255&r)<<8|255&n}function o(c,r,n){var d,l,y,v,_=c[r],x=c[n];return _.length>2?(_[0],_[2],d=_[1],l=_[3]):_.length?(d=_[0],l=_[1]):(_.x,d=_.y,_.x+_.width,l=_.y+_.height),x.length>2?(y=x[0],v=x[2],x[1],x[3]):x.length?(y=x[0],v=x[1]):(y=x.x,x.y,v=x.x+x.width,x.y+x.height),[y,d,v,l]}function a(c){if(typeof c=="number")return[c,c,c,c];if(c.length===2)return[c[0],c[1],c[0],c[1]];var r=f(c);return[r.x,r.y,r.x+r.width,r.y+r.height]}N.exports=i,i.prototype.render=function(){for(var c,r=this,n=[],d=arguments.length;d--;)n[d]=arguments[d];return n.length&&(c=this).update.apply(c,n),this.regl.attributes.preserveDrawingBuffer?this.draw():(this.dirty?this.planned==null&&(this.planned=p(function(){r.draw(),r.dirty=!0,r.planned=null})):(this.draw(),this.dirty=!0,p(function(){r.dirty=!1})),this)},i.prototype.update=function(){for(var c,r=[],n=arguments.length;n--;)r[n]=arguments[n];if(r.length){for(var d=0;d<r.length;d++)this.updateItem(d,r[d]);this.traces=this.traces.filter(Boolean);for(var l=[],y=0,v=0;v<this.traces.length;v++){for(var _=this.traces[v],x=this.traces[v].passes,T=0;T<x.length;T++)l.push(this.passes[x[T]]);_.passOffset=y,y+=_.passes.length}return(c=this.scatter).update.apply(c,l),this}},i.prototype.updateItem=function(c,r){var n=this.regl;if(r===null)return this.traces[c]=null,this;if(!r)return this;var d,l=m(r,{data:"data items columns rows values dimensions samples x",snap:"snap cluster",size:"sizes size radius",color:"colors color fill fill-color fillColor",opacity:"opacity alpha transparency opaque",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",borderColor:"borderColors borderColor bordercolor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range ranges databox dataBox",viewport:"viewport viewBox viewbox",domain:"domain domains area areas",padding:"pad padding paddings pads margin margins",transpose:"transpose transposed",diagonal:"diagonal diag showDiagonal",upper:"upper up top upperhalf upperHalf showupperhalf showUpper showUpperHalf",lower:"lower low bottom lowerhalf lowerHalf showlowerhalf showLowerHalf showLower"}),y=this.traces[c]||(this.traces[c]={id:c,buffer:n.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),color:"black",marker:null,size:12,borderColor:"transparent",borderSize:1,viewport:f([n._gl.drawingBufferWidth,n._gl.drawingBufferHeight]),padding:[0,0,0,0],opacity:1,diagonal:!0,upper:!0,lower:!0});if(l.color!=null&&(y.color=l.color),l.size!=null&&(y.size=l.size),l.marker!=null&&(y.marker=l.marker),l.borderColor!=null&&(y.borderColor=l.borderColor),l.borderSize!=null&&(y.borderSize=l.borderSize),l.opacity!=null&&(y.opacity=l.opacity),l.viewport&&(y.viewport=f(l.viewport)),l.diagonal!=null&&(y.diagonal=l.diagonal),l.upper!=null&&(y.upper=l.upper),l.lower!=null&&(y.lower=l.lower),l.data){y.buffer(u(l.data)),y.columns=l.data.length,y.count=l.data[0].length,y.bounds=[];for(var v=0;v<y.columns;v++)y.bounds[v]=g(l.data[v],1)}l.range&&(y.range=l.range,d=y.range&&typeof y.range[0]!="number"),l.domain&&(y.domain=l.domain);var _=!1;l.padding!=null&&(Array.isArray(l.padding)&&l.padding.length===y.columns&&typeof l.padding[l.padding.length-1]=="number"?(y.padding=l.padding.map(a),_=!0):y.padding=a(l.padding));var x=y.columns,T=y.count,A=y.viewport.width,S=y.viewport.height,w=y.viewport.x,L=y.viewport.y,k=A/x,C=S/x;y.passes=[];for(var M=0;M<x;M++)for(var P=0;P<x;P++)if((y.diagonal||P!==M)&&(y.upper||!(M>P))&&(y.lower||!(M<P))){var O=s(y.id,M,P),F=this.passes[O]||(this.passes[O]={});if(l.data&&(l.transpose?F.positions={x:{buffer:y.buffer,offset:P,count:T,stride:x},y:{buffer:y.buffer,offset:M,count:T,stride:x}}:F.positions={x:{buffer:y.buffer,offset:P*T,count:T},y:{buffer:y.buffer,offset:M*T,count:T}},F.bounds=o(y.bounds,M,P)),l.domain||l.viewport||l.data){var j=_?o(y.padding,M,P):y.padding;if(y.domain){var W=o(y.domain,M,P),Z=W[0],Q=W[1],X=W[2],G=W[3];F.viewport=[w+Z*A+j[0],L+Q*S+j[1],w+X*A-j[2],L+G*S-j[3]]}else F.viewport=[w+P*k+k*j[0],L+M*C+C*j[1],w+(P+1)*k-k*j[2],L+(M+1)*C-C*j[3]]}l.color&&(F.color=y.color),l.size&&(F.size=y.size),l.marker&&(F.marker=y.marker),l.borderSize&&(F.borderSize=y.borderSize),l.borderColor&&(F.borderColor=y.borderColor),l.opacity&&(F.opacity=y.opacity),l.range&&(F.range=d?o(y.range,M,P):y.range||F.bounds),y.passes.push(O)}return this},i.prototype.draw=function(){for(var c,r=[],n=arguments.length;n--;)r[n]=arguments[n];if(r.length){for(var d=[],l=0;l<r.length;l++)if(typeof r[l]=="number"){var y=this.traces[r[l]],v=y.passes,_=y.passOffset;d.push.apply(d,e(_,_+v.length))}else if(r[l].length){var x=r[l],T=this.traces[l],A=T.passes,S=T.passOffset;A=A.map(function(w,L){d[S+L]=x})}(c=this.scatter).draw.apply(c,d)}else this.scatter.draw();return this},i.prototype.destroy=function(){return this.traces.forEach(function(c){c.buffer&&c.buffer.destroy&&c.buffer.destroy()}),this.traces=null,this.passes=null,this.scatter.destroy(),this}},{"array-bounds":76,"array-range":79,"flatten-vertex-data":248,"parse-rect":481,"pick-by-alias":485,raf:516,"regl-scatter2d":524}],526:[function(h,N,H){(function(t,m){typeof H=="object"&&N!==void 0?N.exports=m():t.createREGL=m()})(this,function(){function t(Be,Je){this.id=q++,this.type=Be,this.data=Je}function m(Be){return"["+function Je(_e){if(_e.length===0)return[];var Le=_e.charAt(0),Ce=_e.charAt(_e.length-1);if(1<_e.length&&Le===Ce&&(Le==='"'||Le==="'"))return['"'+_e.substr(1,_e.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(Le=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(_e))return Je(_e.substr(0,Le.index)).concat(Je(Le[1])).concat(Je(_e.substr(Le.index+Le[0].length)));if((Le=_e.split(".")).length===1)return['"'+_e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];for(_e=[],Ce=0;Ce<Le.length;++Ce)_e=_e.concat(Je(Le[Ce]));return _e}(Be).join("][")+"]"}function g(Be){return typeof Be=="string"?Be.split():Be}function p(Be){return typeof Be=="string"?document.querySelector(Be):Be}function e(Be){var Je,_e,Le,Ce,Pe=Be||{};Be={};var Xe=[],ut=[],kt=typeof window=="undefined"?1:window.devicePixelRatio,ft=!1,Et=function(It){},mt=function(){};if(typeof Pe=="string"?Je=document.querySelector(Pe):typeof Pe=="object"&&(typeof Pe.nodeName=="string"&&typeof Pe.appendChild=="function"&&typeof Pe.getBoundingClientRect=="function"?Je=Pe:typeof Pe.drawArrays=="function"||typeof Pe.drawElements=="function"?Le=(Ce=Pe).canvas:("gl"in Pe?Ce=Pe.gl:"canvas"in Pe?Le=p(Pe.canvas):"container"in Pe&&(_e=p(Pe.container)),"attributes"in Pe&&(Be=Pe.attributes),"extensions"in Pe&&(Xe=g(Pe.extensions)),"optionalExtensions"in Pe&&(ut=g(Pe.optionalExtensions)),"onDone"in Pe&&(Et=Pe.onDone),"profile"in Pe&&(ft=!!Pe.profile),"pixelRatio"in Pe&&(kt=+Pe.pixelRatio))),Je&&(Je.nodeName.toLowerCase()==="canvas"?Le=Je:_e=Je),!Ce){if(!Le){if(!(Je=function(It,vt,nt){function At(){var Kt=window.innerWidth,Ie=window.innerHeight;It!==document.body&&(Kt=(Ie=Nt.getBoundingClientRect()).right-Ie.left,Ie=Ie.bottom-Ie.top),Nt.width=nt*Kt,Nt.height=nt*Ie}var Ft,Nt=document.createElement("canvas");return B(Nt.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),It.appendChild(Nt),It===document.body&&(Nt.style.position="absolute",B(It.style,{margin:0,padding:0})),It!==document.body&&typeof ResizeObserver=="function"?(Ft=new ResizeObserver(function(){setTimeout(At)})).observe(It):window.addEventListener("resize",At,!1),At(),{canvas:Nt,onDestroy:function(){Ft?Ft.disconnect():window.removeEventListener("resize",At),It.removeChild(Nt)}}}(_e||document.body,0,kt)))return null;Le=Je.canvas,mt=Je.onDestroy}Be.premultipliedAlpha===void 0&&(Be.premultipliedAlpha=!0),Ce=function(It,vt){function nt(At){try{return It.getContext(At,vt)}catch(Ft){return null}}return nt("webgl")||nt("experimental-webgl")||nt("webgl-experimental")}(Le,Be)}return Ce?{gl:Ce,canvas:Le,container:_e,extensions:Xe,optionalExtensions:ut,pixelRatio:kt,profile:ft,onDone:Et,onDestroy:mt}:(mt(),Et("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function f(Be,Je){for(var _e=Array(Be),Le=0;Le<Be;++Le)_e[Le]=Je(Le);return _e}function u(Be){var Je,_e;return Je=(65535<Be)<<4,Je|=_e=(255<(Be>>>=Je))<<3,(Je|=_e=(15<(Be>>>=_e))<<2)|(_e=(3<(Be>>>=_e))<<1)|Be>>>_e>>1}function i(){function Be(Le){e:{for(var Ce=16;268435456>=Ce;Ce*=16)if(Le<=Ce){Le=Ce;break e}Le=0}return 0<(Ce=_e[u(Le)>>2]).length?Ce.pop():new ArrayBuffer(Le)}function Je(Le){_e[u(Le.byteLength)>>2].push(Le)}var _e=f(8,function(){return[]});return{alloc:Be,free:Je,allocType:function(Le,Ce){var Pe=null;switch(Le){case 5120:Pe=new Int8Array(Be(Ce),0,Ce);break;case 5121:Pe=new Uint8Array(Be(Ce),0,Ce);break;case 5122:Pe=new Int16Array(Be(2*Ce),0,Ce);break;case 5123:Pe=new Uint16Array(Be(2*Ce),0,Ce);break;case 5124:Pe=new Int32Array(Be(4*Ce),0,Ce);break;case 5125:Pe=new Uint32Array(Be(4*Ce),0,Ce);break;case 5126:Pe=new Float32Array(Be(4*Ce),0,Ce);break;default:return null}return Pe.length!==Ce?Pe.subarray(0,Ce):Pe},freeType:function(Le){Je(Le.buffer)}}}function s(Be){return!!Be&&typeof Be=="object"&&Array.isArray(Be.shape)&&Array.isArray(Be.stride)&&typeof Be.offset=="number"&&Be.shape.length===Be.stride.length&&(Array.isArray(Be.data)||ae(Be.data))}function o(Be,Je,_e,Le,Ce,Pe){for(var Xe=0;Xe<Je;++Xe)for(var ut=Be[Xe],kt=0;kt<_e;++kt)for(var ft=ut[kt],Et=0;Et<Le;++Et)Ce[Pe++]=ft[Et]}function a(Be){return 0|de[Object.prototype.toString.call(Be)]}function c(Be,Je){for(var _e=0;_e<Je.length;++_e)Be[_e]=Je[_e]}function r(Be,Je,_e,Le,Ce,Pe,Xe){for(var ut=0,kt=0;kt<_e;++kt)for(var ft=0;ft<Le;++ft)Be[ut++]=Je[Ce*kt+Pe*ft+Xe]}function n(Be,Je,_e,Le){function Ce(mt){this.id=kt++,this.buffer=Be.createBuffer(),this.type=mt,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=5121,this.persistentData=null,_e.profile&&(this.stats={size:0})}function Pe(mt,It,vt){mt.byteLength=It.byteLength,Be.bufferData(mt.type,It,vt)}function Xe(mt,It,vt,nt,At,Ft){if(mt.usage=vt,Array.isArray(It)){if(mt.dtype=nt||5126,0<It.length)if(Array.isArray(It[0])){At=Ee(It);for(var Nt=nt=1;Nt<At.length;++Nt)nt*=At[Nt];mt.dimension=nt,Pe(mt,It=ke(It,At,mt.dtype),vt),Ft?mt.persistentData=It:te.freeType(It)}else typeof It[0]=="number"?(mt.dimension=At,c(At=te.allocType(mt.dtype,It.length),It),Pe(mt,At,vt),Ft?mt.persistentData=At:te.freeType(At)):ae(It[0])&&(mt.dimension=It[0].length,mt.dtype=nt||a(It[0])||5126,Pe(mt,It=ke(It,[It.length,It[0].length],mt.dtype),vt),Ft?mt.persistentData=It:te.freeType(It))}else if(ae(It))mt.dtype=nt||a(It),mt.dimension=At,Pe(mt,It,vt),Ft&&(mt.persistentData=new Uint8Array(new Uint8Array(It.buffer)));else if(s(It)){At=It.shape;var Kt=It.stride,Ie=(Nt=It.offset,0),ot=0,bt=0,Pt=0;At.length===1?(Ie=At[0],ot=1,bt=Kt[0],Pt=0):At.length===2&&(Ie=At[0],ot=At[1],bt=Kt[0],Pt=Kt[1]),mt.dtype=nt||a(It.data)||5126,mt.dimension=ot,r(At=te.allocType(mt.dtype,Ie*ot),It.data,Ie,ot,bt,Pt,Nt),Pe(mt,At,vt),Ft?mt.persistentData=At:te.freeType(At)}else It instanceof ArrayBuffer&&(mt.dtype=5121,mt.dimension=At,Pe(mt,It,vt),Ft&&(mt.persistentData=new Uint8Array(new Uint8Array(It))))}function ut(mt){Je.bufferCount--,Le(mt),Be.deleteBuffer(mt.buffer),mt.buffer=null,delete ft[mt.id]}var kt=0,ft={};Ce.prototype.bind=function(){Be.bindBuffer(this.type,this.buffer)},Ce.prototype.destroy=function(){ut(this)};var Et=[];return _e.profile&&(Je.getTotalBufferSize=function(){var mt=0;return Object.keys(ft).forEach(function(It){mt+=ft[It].stats.size}),mt}),{create:function(mt,It,vt,nt){function At(Nt){var Kt=35044,Ie=null,ot=0,bt=0,Pt=1;return Array.isArray(Nt)||ae(Nt)||s(Nt)||Nt instanceof ArrayBuffer?Ie=Nt:typeof Nt=="number"?ot=0|Nt:Nt&&("data"in Nt&&(Ie=Nt.data),"usage"in Nt&&(Kt=ve[Nt.usage]),"type"in Nt&&(bt=ce[Nt.type]),"dimension"in Nt&&(Pt=0|Nt.dimension),"length"in Nt&&(ot=0|Nt.length)),Ft.bind(),Ie?Xe(Ft,Ie,Kt,bt,Pt,nt):(ot&&Be.bufferData(Ft.type,ot,Kt),Ft.dtype=bt||5121,Ft.usage=Kt,Ft.dimension=Pt,Ft.byteLength=ot),_e.profile&&(Ft.stats.size=Ft.byteLength*be[Ft.dtype]),At}Je.bufferCount++;var Ft=new Ce(It);return ft[Ft.id]=Ft,vt||At(mt),At._reglType="buffer",At._buffer=Ft,At.subdata=function(Nt,Kt){var Ie,ot=0|(Kt||0);if(Ft.bind(),ae(Nt)||Nt instanceof ArrayBuffer)Be.bufferSubData(Ft.type,ot,Nt);else if(Array.isArray(Nt)){if(0<Nt.length)if(typeof Nt[0]=="number"){var bt=te.allocType(Ft.dtype,Nt.length);c(bt,Nt),Be.bufferSubData(Ft.type,ot,bt),te.freeType(bt)}else(Array.isArray(Nt[0])||ae(Nt[0]))&&(Ie=Ee(Nt),bt=ke(Nt,Ie,Ft.dtype),Be.bufferSubData(Ft.type,ot,bt),te.freeType(bt))}else if(s(Nt)){Ie=Nt.shape;var Pt=Nt.stride,Vt=bt=0,nr=0,Yt=0;Ie.length===1?(bt=Ie[0],Vt=1,nr=Pt[0],Yt=0):Ie.length===2&&(bt=Ie[0],Vt=Ie[1],nr=Pt[0],Yt=Pt[1]),Ie=Array.isArray(Nt.data)?Ft.dtype:a(Nt.data),r(Ie=te.allocType(Ie,bt*Vt),Nt.data,bt,Vt,nr,Yt,Nt.offset),Be.bufferSubData(Ft.type,ot,Ie),te.freeType(Ie)}return At},_e.profile&&(At.stats=Ft.stats),At.destroy=function(){ut(Ft)},At},createStream:function(mt,It){var vt=Et.pop();return vt||(vt=new Ce(mt)),vt.bind(),Xe(vt,It,35040,0,1,!1),vt},destroyStream:function(mt){Et.push(mt)},clear:function(){he(ft).forEach(ut),Et.forEach(ut)},getBuffer:function(mt){return mt&&mt._buffer instanceof Ce?mt._buffer:null},restore:function(){he(ft).forEach(function(mt){mt.buffer=Be.createBuffer(),Be.bindBuffer(mt.type,mt.buffer),Be.bufferData(mt.type,mt.persistentData||mt.byteLength,mt.usage)})},_initBuffer:Xe}}function d(Be,Je,_e,Le){function Ce(mt){this.id=kt++,ut[this.id]=this,this.buffer=mt,this.primType=4,this.type=this.vertCount=0}function Pe(mt,It,vt,nt,At,Ft,Nt){var Kt;if(mt.buffer.bind(),It?((Kt=Nt)||ae(It)&&(!s(It)||ae(It.data))||(Kt=Je.oes_element_index_uint?5125:5123),_e._initBuffer(mt.buffer,It,vt,Kt,3)):(Be.bufferData(34963,Ft,vt),mt.buffer.dtype=Kt||5121,mt.buffer.usage=vt,mt.buffer.dimension=3,mt.buffer.byteLength=Ft),Kt=Nt,!Nt){switch(mt.buffer.dtype){case 5121:case 5120:Kt=5121;break;case 5123:case 5122:Kt=5123;break;case 5125:case 5124:Kt=5125}mt.buffer.dtype=Kt}mt.type=Kt,0>(It=At)&&(It=mt.buffer.byteLength,Kt===5123?It>>=1:Kt===5125&&(It>>=2)),mt.vertCount=It,It=nt,0>nt&&(It=4,(nt=mt.buffer.dimension)===1&&(It=0),nt===2&&(It=1),nt===3&&(It=4)),mt.primType=It}function Xe(mt){Le.elementsCount--,delete ut[mt.id],mt.buffer.destroy(),mt.buffer=null}var ut={},kt=0,ft={uint8:5121,uint16:5123};Je.oes_element_index_uint&&(ft.uint32=5125),Ce.prototype.bind=function(){this.buffer.bind()};var Et=[];return{create:function(mt,It){function vt(Ft){if(Ft)if(typeof Ft=="number")nt(Ft),At.primType=4,At.vertCount=0|Ft,At.type=5121;else{var Nt=null,Kt=35044,Ie=-1,ot=-1,bt=0,Pt=0;Array.isArray(Ft)||ae(Ft)||s(Ft)?Nt=Ft:("data"in Ft&&(Nt=Ft.data),"usage"in Ft&&(Kt=ve[Ft.usage]),"primitive"in Ft&&(Ie=xe[Ft.primitive]),"count"in Ft&&(ot=0|Ft.count),"type"in Ft&&(Pt=ft[Ft.type]),"length"in Ft?bt=0|Ft.length:(bt=ot,Pt===5123||Pt===5122?bt*=2:Pt!==5125&&Pt!==5124||(bt*=4))),Pe(At,Nt,Kt,Ie,ot,bt,Pt)}else nt(),At.primType=4,At.vertCount=0,At.type=5121;return vt}var nt=_e.create(null,34963,!0),At=new Ce(nt._buffer);return Le.elementsCount++,vt(mt),vt._reglType="elements",vt._elements=At,vt.subdata=function(Ft,Nt){return nt.subdata(Ft,Nt),vt},vt.destroy=function(){Xe(At)},vt},createStream:function(mt){var It=Et.pop();return It||(It=new Ce(_e.create(null,34963,!0,!1)._buffer)),Pe(It,mt,35040,-1,-1,0,0),It},destroyStream:function(mt){Et.push(mt)},getElements:function(mt){return typeof mt=="function"&&mt._elements instanceof Ce?mt._elements:null},clear:function(){he(ut).forEach(Xe)}}}function l(Be){for(var Je=te.allocType(5123,Be.length),_e=0;_e<Be.length;++_e)if(isNaN(Be[_e]))Je[_e]=65535;else if(1/0===Be[_e])Je[_e]=31744;else if(-1/0===Be[_e])Je[_e]=64512;else{ue[0]=Be[_e];var Le=(Pe=me[0])>>>31<<15,Ce=(Pe<<1>>>24)-127,Pe=Pe>>13&1023;Je[_e]=-24>Ce?Le:-14>Ce?Le+(Pe+1024>>-14-Ce):15<Ce?Le+31744:Le+(Ce+15<<10)+Pe}return Je}function y(Be){return Array.isArray(Be)||ae(Be)}function v(Be){return"[object "+Be+"]"}function _(Be){return Array.isArray(Be)&&(Be.length===0||typeof Be[0]=="number")}function x(Be){return!(!Array.isArray(Be)||Be.length===0||!y(Be[0]))}function T(Be){return Object.prototype.toString.call(Be)}function A(Be){if(!Be)return!1;var Je=T(Be);return 0<=We.indexOf(Je)||_(Be)||x(Be)||s(Be)}function S(Be,Je){Be.type===36193?(Be.data=l(Je),te.freeType(Je)):Be.data=Je}function w(Be,Je,_e,Le,Ce,Pe){if(Be=Qe[Be]!==void 0?Qe[Be]:Se[Be]*Ge[Je],Pe&&(Be*=6),Ce){for(Le=0;1<=_e;)Le+=Be*_e*_e,_e/=2;return Le}return Be*_e*Le}function L(Be,Je,_e,Le,Ce,Pe,Xe){function ut(){this.format=this.internalformat=6408,this.type=5121,this.flipY=this.premultiplyAlpha=this.compressed=!1,this.unpackAlignment=1,this.colorSpace=37444,this.channels=this.height=this.width=0}function kt(Zt,Ct){Zt.internalformat=Ct.internalformat,Zt.format=Ct.format,Zt.type=Ct.type,Zt.compressed=Ct.compressed,Zt.premultiplyAlpha=Ct.premultiplyAlpha,Zt.flipY=Ct.flipY,Zt.unpackAlignment=Ct.unpackAlignment,Zt.colorSpace=Ct.colorSpace,Zt.width=Ct.width,Zt.height=Ct.height,Zt.channels=Ct.channels}function ft(Zt,Ct){if(typeof Ct=="object"&&Ct){"premultiplyAlpha"in Ct&&(Zt.premultiplyAlpha=Ct.premultiplyAlpha),"flipY"in Ct&&(Zt.flipY=Ct.flipY),"alignment"in Ct&&(Zt.unpackAlignment=Ct.alignment),"colorSpace"in Ct&&(Zt.colorSpace=zr[Ct.colorSpace]),"type"in Ct&&(Zt.type=xr[Ct.type]);var Ht=Zt.width,cr=Zt.height,_r=Zt.channels,Vr=!1;"shape"in Ct?(Ht=Ct.shape[0],cr=Ct.shape[1],Ct.shape.length===3&&(_r=Ct.shape[2],Vr=!0)):("radius"in Ct&&(Ht=cr=Ct.radius),"width"in Ct&&(Ht=Ct.width),"height"in Ct&&(cr=Ct.height),"channels"in Ct&&(_r=Ct.channels,Vr=!0)),Zt.width=0|Ht,Zt.height=0|cr,Zt.channels=0|_r,Ht=!1,"format"in Ct&&(Ht=Ct.format,cr=Zt.internalformat=Br[Ht],Zt.format=Qr[cr],Ht in xr&&!("type"in Ct)&&(Zt.type=xr[Ht]),Ht in Jr&&(Zt.compressed=!0),Ht=!0),!Vr&&Ht?Zt.channels=Se[Zt.format]:Vr&&!Ht&&Zt.channels!==Me[Zt.format]&&(Zt.format=Zt.internalformat=Me[Zt.channels])}}function Et(Zt){Be.pixelStorei(37440,Zt.flipY),Be.pixelStorei(37441,Zt.premultiplyAlpha),Be.pixelStorei(37443,Zt.colorSpace),Be.pixelStorei(3317,Zt.unpackAlignment)}function mt(){ut.call(this),this.yOffset=this.xOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function It(Zt,Ct){var Ht=null;if(A(Ct)?Ht=Ct:Ct&&(ft(Zt,Ct),"x"in Ct&&(Zt.xOffset=0|Ct.x),"y"in Ct&&(Zt.yOffset=0|Ct.y),A(Ct.data)&&(Ht=Ct.data)),Ct.copy){var cr=Ce.viewportWidth,_r=Ce.viewportHeight;Zt.width=Zt.width||cr-Zt.xOffset,Zt.height=Zt.height||_r-Zt.yOffset,Zt.needsCopy=!0}else if(Ht){if(ae(Ht))Zt.channels=Zt.channels||4,Zt.data=Ht,"type"in Ct||Zt.type!==5121||(Zt.type=0|de[Object.prototype.toString.call(Ht)]);else if(_(Ht)){switch(Zt.channels=Zt.channels||4,_r=(cr=Ht).length,Zt.type){case 5121:case 5123:case 5125:case 5126:(_r=te.allocType(Zt.type,_r)).set(cr),Zt.data=_r;break;case 36193:Zt.data=l(cr)}Zt.alignment=1,Zt.needsFree=!0}else if(s(Ht)){cr=Ht.data,Array.isArray(cr)||Zt.type!==5121||(Zt.type=0|de[Object.prototype.toString.call(cr)]),_r=Ht.shape;var Vr,jr,vr,br,Ar=Ht.stride;_r.length===3?(vr=_r[2],br=Ar[2]):br=vr=1,Vr=_r[0],jr=_r[1],_r=Ar[0],Ar=Ar[1],Zt.alignment=1,Zt.width=Vr,Zt.height=jr,Zt.channels=vr,Zt.format=Zt.internalformat=Me[vr],Zt.needsFree=!0,Vr=br,Ht=Ht.offset,vr=Zt.width,br=Zt.height,jr=Zt.channels;for(var kr=te.allocType(Zt.type===36193?5126:Zt.type,vr*br*jr),Cr=0,Hr=0;Hr<br;++Hr)for(var ln=0;ln<vr;++ln)for(var xn=0;xn<jr;++xn)kr[Cr++]=cr[_r*ln+Ar*Hr+Vr*xn+Ht];S(Zt,kr)}else if(T(Ht)===De||T(Ht)===Fe||T(Ht)===Ye)T(Ht)===De||T(Ht)===Fe?Zt.element=Ht:Zt.element=Ht.canvas,Zt.width=Zt.element.width,Zt.height=Zt.element.height,Zt.channels=4;else if(T(Ht)===et)Zt.element=Ht,Zt.width=Ht.width,Zt.height=Ht.height,Zt.channels=4;else if(T(Ht)===Oe)Zt.element=Ht,Zt.width=Ht.naturalWidth,Zt.height=Ht.naturalHeight,Zt.channels=4;else if(T(Ht)===je)Zt.element=Ht,Zt.width=Ht.videoWidth,Zt.height=Ht.videoHeight,Zt.channels=4;else if(x(Ht)){for(cr=Zt.width||Ht[0].length,_r=Zt.height||Ht.length,Ar=Zt.channels,Ar=y(Ht[0][0])?Ar||Ht[0][0].length:Ar||1,Vr=se.shape(Ht),vr=1,br=0;br<Vr.length;++br)vr*=Vr[br];vr=te.allocType(Zt.type===36193?5126:Zt.type,vr),se.flatten(Ht,Vr,"",vr),S(Zt,vr),Zt.alignment=1,Zt.width=cr,Zt.height=_r,Zt.channels=Ar,Zt.format=Zt.internalformat=Me[Ar],Zt.needsFree=!0}}else Zt.width=Zt.width||1,Zt.height=Zt.height||1,Zt.channels=Zt.channels||4}function vt(Zt,Ct,Ht,cr,_r){var Vr=Zt.element,jr=Zt.data,vr=Zt.internalformat,br=Zt.format,Ar=Zt.type,kr=Zt.width,Cr=Zt.height;Et(Zt),Vr?Be.texSubImage2D(Ct,_r,Ht,cr,br,Ar,Vr):Zt.compressed?Be.compressedTexSubImage2D(Ct,_r,Ht,cr,vr,kr,Cr,jr):Zt.needsCopy?(Le(),Be.copyTexSubImage2D(Ct,_r,Ht,cr,Zt.xOffset,Zt.yOffset,kr,Cr)):Be.texSubImage2D(Ct,_r,Ht,cr,kr,Cr,br,Ar,jr)}function nt(){return $r.pop()||new mt}function At(Zt){Zt.needsFree&&te.freeType(Zt.data),mt.call(Zt),$r.push(Zt)}function Ft(){ut.call(this),this.genMipmaps=!1,this.mipmapHint=4352,this.mipmask=0,this.images=Array(16)}function Nt(Zt,Ct,Ht){var cr=Zt.images[0]=nt();Zt.mipmask=1,cr.width=Zt.width=Ct,cr.height=Zt.height=Ht,cr.channels=Zt.channels=4}function Kt(Zt,Ct){var Ht=null;if(A(Ct))kt(Ht=Zt.images[0]=nt(),Zt),It(Ht,Ct),Zt.mipmask=1;else if(ft(Zt,Ct),Array.isArray(Ct.mipmap))for(var cr=Ct.mipmap,_r=0;_r<cr.length;++_r)kt(Ht=Zt.images[_r]=nt(),Zt),Ht.width>>=_r,Ht.height>>=_r,It(Ht,cr[_r]),Zt.mipmask|=1<<_r;else kt(Ht=Zt.images[0]=nt(),Zt),It(Ht,Ct),Zt.mipmask=1;kt(Zt,Zt.images[0])}function Ie(Zt,Ct){for(var Ht=Zt.images,cr=0;cr<Ht.length&&Ht[cr];++cr){var _r=Ht[cr],Vr=Ct,jr=cr,vr=_r.element,br=_r.data,Ar=_r.internalformat,kr=_r.format,Cr=_r.type,Hr=_r.width,ln=_r.height;Et(_r),vr?Be.texImage2D(Vr,jr,kr,kr,Cr,vr):_r.compressed?Be.compressedTexImage2D(Vr,jr,Ar,Hr,ln,0,br):_r.needsCopy?(Le(),Be.copyTexImage2D(Vr,jr,kr,_r.xOffset,_r.yOffset,Hr,ln,0)):Be.texImage2D(Vr,jr,kr,Hr,ln,0,kr,Cr,br||null)}}function ot(){var Zt=Kr.pop()||new Ft;ut.call(Zt);for(var Ct=Zt.mipmask=0;16>Ct;++Ct)Zt.images[Ct]=null;return Zt}function bt(Zt){for(var Ct=Zt.images,Ht=0;Ht<Ct.length;++Ht)Ct[Ht]&&At(Ct[Ht]),Ct[Ht]=null;Kr.push(Zt)}function Pt(){this.magFilter=this.minFilter=9728,this.wrapT=this.wrapS=33071,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=4352}function Vt(Zt,Ct){"min"in Ct&&(Zt.minFilter=yr[Ct.min],0<=we.indexOf(Zt.minFilter)&&!("faces"in Ct)&&(Zt.genMipmaps=!0)),"mag"in Ct&&(Zt.magFilter=fr[Ct.mag]);var Ht=Zt.wrapS,cr=Zt.wrapT;if("wrap"in Ct){var _r=Ct.wrap;typeof _r=="string"?Ht=cr=sr[_r]:Array.isArray(_r)&&(Ht=sr[_r[0]],cr=sr[_r[1]])}else"wrapS"in Ct&&(Ht=sr[Ct.wrapS]),"wrapT"in Ct&&(cr=sr[Ct.wrapT]);if(Zt.wrapS=Ht,Zt.wrapT=cr,"anisotropic"in Ct&&(Zt.anisotropic=Ct.anisotropic),"mipmap"in Ct){switch(Ht=!1,typeof Ct.mipmap){case"string":Zt.mipmapHint=mr[Ct.mipmap],Ht=Zt.genMipmaps=!0;break;case"boolean":Ht=Zt.genMipmaps=Ct.mipmap;break;case"object":Zt.genMipmaps=!1,Ht=!0}!Ht||"min"in Ct||(Zt.minFilter=9984)}}function nr(Zt,Ct){Be.texParameteri(Ct,10241,Zt.minFilter),Be.texParameteri(Ct,10240,Zt.magFilter),Be.texParameteri(Ct,10242,Zt.wrapS),Be.texParameteri(Ct,10243,Zt.wrapT),Je.ext_texture_filter_anisotropic&&Be.texParameteri(Ct,34046,Zt.anisotropic),Zt.genMipmaps&&(Be.hint(33170,Zt.mipmapHint),Be.generateMipmap(Ct))}function Yt(Zt){ut.call(this),this.mipmask=0,this.internalformat=6408,this.id=en++,this.refCount=1,this.target=Zt,this.texture=Be.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Pt,Xe.profile&&(this.stats={size:0})}function Xt(Zt){Be.activeTexture(33984),Be.bindTexture(Zt.target,Zt.texture)}function ar(){var Zt=Rn[0];Zt?Be.bindTexture(Zt.target,Zt.texture):Be.bindTexture(3553,null)}function hr(Zt){var Ct=Zt.texture,Ht=Zt.unit,cr=Zt.target;0<=Ht&&(Be.activeTexture(33984+Ht),Be.bindTexture(cr,null),Rn[Ht]=null),Be.deleteTexture(Ct),Zt.texture=null,Zt.params=null,Zt.pixels=null,Zt.refCount=0,delete Tn[Zt.id],Pe.textureCount--}var mr={"don't care":4352,"dont care":4352,nice:4354,fast:4353},sr={repeat:10497,clamp:33071,mirror:33648},fr={nearest:9728,linear:9729},yr=B({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},fr),zr={none:0,browser:37444},xr={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},Br={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},Jr={};Je.ext_srgb&&(Br.srgb=35904,Br.srgba=35906),Je.oes_texture_float&&(xr.float32=xr.float=5126),Je.oes_texture_half_float&&(xr.float16=xr["half float"]=36193),Je.webgl_depth_texture&&(B(Br,{depth:6402,"depth stencil":34041}),B(xr,{uint16:5123,uint32:5125,"depth stencil":34042})),Je.webgl_compressed_texture_s3tc&&B(Jr,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779}),Je.webgl_compressed_texture_atc&&B(Jr,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),Je.webgl_compressed_texture_pvrtc&&B(Jr,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),Je.webgl_compressed_texture_etc1&&(Jr["rgb etc1"]=36196);var fn=Array.prototype.slice.call(Be.getParameter(34467));Object.keys(Jr).forEach(function(Zt){var Ct=Jr[Zt];0<=fn.indexOf(Ct)&&(Br[Zt]=Ct)});var Cn=Object.keys(Br);_e.textureFormats=Cn;var Pn=[];Object.keys(Br).forEach(function(Zt){Pn[Br[Zt]]=Zt});var An=[];Object.keys(xr).forEach(function(Zt){An[xr[Zt]]=Zt});var rn=[];Object.keys(fr).forEach(function(Zt){rn[fr[Zt]]=Zt});var Fr=[];Object.keys(yr).forEach(function(Zt){Fr[yr[Zt]]=Zt});var Lr=[];Object.keys(sr).forEach(function(Zt){Lr[sr[Zt]]=Zt});var Qr=Cn.reduce(function(Zt,Ct){var Ht=Br[Ct];return Ht===6409||Ht===6406||Ht===6409||Ht===6410||Ht===6402||Ht===34041||Je.ext_srgb&&(Ht===35904||Ht===35906)?Zt[Ht]=Ht:Ht===32855||0<=Ct.indexOf("rgba")?Zt[Ht]=6408:Zt[Ht]=6407,Zt},{}),$r=[],Kr=[],en=0,Tn={},Mn=_e.maxTextureUnits,Rn=Array(Mn).map(function(){return null});return B(Yt.prototype,{bind:function(){this.bindCount+=1;var Zt=this.unit;if(0>Zt){for(var Ct=0;Ct<Mn;++Ct){var Ht=Rn[Ct];if(Ht){if(0<Ht.bindCount)continue;Ht.unit=-1}Rn[Ct]=this,Zt=Ct;break}Xe.profile&&Pe.maxTextureUnits<Zt+1&&(Pe.maxTextureUnits=Zt+1),this.unit=Zt,Be.activeTexture(33984+Zt),Be.bindTexture(this.target,this.texture)}return Zt},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&hr(this)}}),Xe.profile&&(Pe.getTotalTextureSize=function(){var Zt=0;return Object.keys(Tn).forEach(function(Ct){Zt+=Tn[Ct].stats.size}),Zt}),{create2D:function(Zt,Ct){function Ht(_r,Vr){var jr=cr.texInfo;Pt.call(jr);var vr=ot();return typeof _r=="number"?Nt(vr,0|_r,typeof Vr=="number"?0|Vr:0|_r):_r?(Vt(jr,_r),Kt(vr,_r)):Nt(vr,1,1),jr.genMipmaps&&(vr.mipmask=(vr.width<<1)-1),cr.mipmask=vr.mipmask,kt(cr,vr),cr.internalformat=vr.internalformat,Ht.width=vr.width,Ht.height=vr.height,Xt(cr),Ie(vr,3553),nr(jr,3553),ar(),bt(vr),Xe.profile&&(cr.stats.size=w(cr.internalformat,cr.type,vr.width,vr.height,jr.genMipmaps,!1)),Ht.format=Pn[cr.internalformat],Ht.type=An[cr.type],Ht.mag=rn[jr.magFilter],Ht.min=Fr[jr.minFilter],Ht.wrapS=Lr[jr.wrapS],Ht.wrapT=Lr[jr.wrapT],Ht}var cr=new Yt(3553);return Tn[cr.id]=cr,Pe.textureCount++,Ht(Zt,Ct),Ht.subimage=function(_r,Vr,jr,vr){Vr|=0,jr|=0,vr|=0;var br=nt();return kt(br,cr),br.width=0,br.height=0,It(br,_r),br.width=br.width||(cr.width>>vr)-Vr,br.height=br.height||(cr.height>>vr)-jr,Xt(cr),vt(br,3553,Vr,jr,vr),ar(),At(br),Ht},Ht.resize=function(_r,Vr){var jr=0|_r,vr=0|Vr||jr;if(jr===cr.width&&vr===cr.height)return Ht;Ht.width=cr.width=jr,Ht.height=cr.height=vr,Xt(cr);for(var br=0;cr.mipmask>>br;++br){var Ar=jr>>br,kr=vr>>br;if(!Ar||!kr)break;Be.texImage2D(3553,br,cr.format,Ar,kr,0,cr.format,cr.type,null)}return ar(),Xe.profile&&(cr.stats.size=w(cr.internalformat,cr.type,jr,vr,!1,!1)),Ht},Ht._reglType="texture2d",Ht._texture=cr,Xe.profile&&(Ht.stats=cr.stats),Ht.destroy=function(){cr.decRef()},Ht},createCube:function(Zt,Ct,Ht,cr,_r,Vr){function jr(Ar,kr,Cr,Hr,ln,xn){var Zr,yn=vr.texInfo;for(Pt.call(yn),Zr=0;6>Zr;++Zr)br[Zr]=ot();if(typeof Ar!="number"&&Ar){if(typeof Ar=="object")if(kr)Kt(br[0],Ar),Kt(br[1],kr),Kt(br[2],Cr),Kt(br[3],Hr),Kt(br[4],ln),Kt(br[5],xn);else if(Vt(yn,Ar),ft(vr,Ar),"faces"in Ar)for(Ar=Ar.faces,Zr=0;6>Zr;++Zr)kt(br[Zr],vr),Kt(br[Zr],Ar[Zr]);else for(Zr=0;6>Zr;++Zr)Kt(br[Zr],Ar)}else for(Ar=0|Ar||1,Zr=0;6>Zr;++Zr)Nt(br[Zr],Ar,Ar);for(kt(vr,br[0]),vr.mipmask=yn.genMipmaps?(br[0].width<<1)-1:br[0].mipmask,vr.internalformat=br[0].internalformat,jr.width=br[0].width,jr.height=br[0].height,Xt(vr),Zr=0;6>Zr;++Zr)Ie(br[Zr],34069+Zr);for(nr(yn,34067),ar(),Xe.profile&&(vr.stats.size=w(vr.internalformat,vr.type,jr.width,jr.height,yn.genMipmaps,!0)),jr.format=Pn[vr.internalformat],jr.type=An[vr.type],jr.mag=rn[yn.magFilter],jr.min=Fr[yn.minFilter],jr.wrapS=Lr[yn.wrapS],jr.wrapT=Lr[yn.wrapT],Zr=0;6>Zr;++Zr)bt(br[Zr]);return jr}var vr=new Yt(34067);Tn[vr.id]=vr,Pe.cubeCount++;var br=Array(6);return jr(Zt,Ct,Ht,cr,_r,Vr),jr.subimage=function(Ar,kr,Cr,Hr,ln){Cr|=0,Hr|=0,ln|=0;var xn=nt();return kt(xn,vr),xn.width=0,xn.height=0,It(xn,kr),xn.width=xn.width||(vr.width>>ln)-Cr,xn.height=xn.height||(vr.height>>ln)-Hr,Xt(vr),vt(xn,34069+Ar,Cr,Hr,ln),ar(),At(xn),jr},jr.resize=function(Ar){if((Ar|=0)!==vr.width){jr.width=vr.width=Ar,jr.height=vr.height=Ar,Xt(vr);for(var kr=0;6>kr;++kr)for(var Cr=0;vr.mipmask>>Cr;++Cr)Be.texImage2D(34069+kr,Cr,vr.format,Ar>>Cr,Ar>>Cr,0,vr.format,vr.type,null);return ar(),Xe.profile&&(vr.stats.size=w(vr.internalformat,vr.type,jr.width,jr.height,!1,!0)),jr}},jr._reglType="textureCube",jr._texture=vr,Xe.profile&&(jr.stats=vr.stats),jr.destroy=function(){vr.decRef()},jr},clear:function(){for(var Zt=0;Zt<Mn;++Zt)Be.activeTexture(33984+Zt),Be.bindTexture(3553,null),Rn[Zt]=null;he(Tn).forEach(hr),Pe.cubeCount=0,Pe.textureCount=0},getTexture:function(Zt){return null},restore:function(){for(var Zt=0;Zt<Mn;++Zt){var Ct=Rn[Zt];Ct&&(Ct.bindCount=0,Ct.unit=-1,Rn[Zt]=null)}he(Tn).forEach(function(Ht){Ht.texture=Be.createTexture(),Be.bindTexture(Ht.target,Ht.texture);for(var cr=0;32>cr;++cr)if((Ht.mipmask&1<<cr)!=0)if(Ht.target===3553)Be.texImage2D(3553,cr,Ht.internalformat,Ht.width>>cr,Ht.height>>cr,0,Ht.internalformat,Ht.type,null);else for(var _r=0;6>_r;++_r)Be.texImage2D(34069+_r,cr,Ht.internalformat,Ht.width>>cr,Ht.height>>cr,0,Ht.internalformat,Ht.type,null);nr(Ht.texInfo,Ht.target)})},refresh:function(){for(var Zt=0;Zt<Mn;++Zt){var Ct=Rn[Zt];Ct&&(Ct.bindCount=0,Ct.unit=-1,Rn[Zt]=null),Be.activeTexture(33984+Zt),Be.bindTexture(3553,null),Be.bindTexture(34067,null)}}}}function k(Be,Je,_e,Le,Ce,Pe){function Xe(Yt,Xt,ar){this.target=Yt,this.texture=Xt,this.renderbuffer=ar;var hr=Yt=0;Xt?(Yt=Xt.width,hr=Xt.height):ar&&(Yt=ar.width,hr=ar.height),this.width=Yt,this.height=hr}function ut(Yt){Yt&&(Yt.texture&&Yt.texture._texture.decRef(),Yt.renderbuffer&&Yt.renderbuffer._renderbuffer.decRef())}function kt(Yt,Xt,ar){Yt&&(Yt.texture?Yt.texture._texture.refCount+=1:Yt.renderbuffer._renderbuffer.refCount+=1)}function ft(Yt,Xt){Xt&&(Xt.texture?Be.framebufferTexture2D(36160,Yt,Xt.target,Xt.texture._texture.texture,0):Be.framebufferRenderbuffer(36160,Yt,36161,Xt.renderbuffer._renderbuffer.renderbuffer))}function Et(Yt){var Xt=3553,ar=null,hr=null,mr=Yt;return typeof Yt=="object"&&(mr=Yt.data,"target"in Yt&&(Xt=0|Yt.target)),(Yt=mr._reglType)==="texture2d"||Yt==="textureCube"?ar=mr:Yt==="renderbuffer"&&(hr=mr,Xt=36161),new Xe(Xt,ar,hr)}function mt(Yt,Xt,ar,hr,mr){return ar?((Yt=Le.create2D({width:Yt,height:Xt,format:hr,type:mr}))._texture.refCount=0,new Xe(3553,Yt,null)):((Yt=Ce.create({width:Yt,height:Xt,format:hr}))._renderbuffer.refCount=0,new Xe(36161,null,Yt))}function It(Yt){return Yt&&(Yt.texture||Yt.renderbuffer)}function vt(Yt,Xt,ar){Yt&&(Yt.texture?Yt.texture.resize(Xt,ar):Yt.renderbuffer&&Yt.renderbuffer.resize(Xt,ar),Yt.width=Xt,Yt.height=ar)}function nt(){this.id=Vt++,nr[this.id]=this,this.framebuffer=Be.createFramebuffer(),this.height=this.width=0,this.colorAttachments=[],this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function At(Yt){Yt.colorAttachments.forEach(ut),ut(Yt.depthAttachment),ut(Yt.stencilAttachment),ut(Yt.depthStencilAttachment)}function Ft(Yt){Be.deleteFramebuffer(Yt.framebuffer),Yt.framebuffer=null,Pe.framebufferCount--,delete nr[Yt.id]}function Nt(Yt){var Xt;Be.bindFramebuffer(36160,Yt.framebuffer);var ar=Yt.colorAttachments;for(Xt=0;Xt<ar.length;++Xt)ft(36064+Xt,ar[Xt]);for(Xt=ar.length;Xt<_e.maxColorAttachments;++Xt)Be.framebufferTexture2D(36160,36064+Xt,3553,null,0);Be.framebufferTexture2D(36160,33306,3553,null,0),Be.framebufferTexture2D(36160,36096,3553,null,0),Be.framebufferTexture2D(36160,36128,3553,null,0),ft(36096,Yt.depthAttachment),ft(36128,Yt.stencilAttachment),ft(33306,Yt.depthStencilAttachment),Be.checkFramebufferStatus(36160),Be.isContextLost(),Be.bindFramebuffer(36160,Ie.next?Ie.next.framebuffer:null),Ie.cur=Ie.next,Be.getError()}function Kt(Yt,Xt){function ar(mr,sr){var fr,yr=0,zr=0,xr=!0,Br=!0;fr=null;var Jr=!0,fn="rgba",Cn="uint8",Pn=1,An=null,rn=null,Fr=null,Lr=!1;typeof mr=="number"?(yr=0|mr,zr=0|sr||yr):mr?("shape"in mr?(yr=(zr=mr.shape)[0],zr=zr[1]):("radius"in mr&&(yr=zr=mr.radius),"width"in mr&&(yr=mr.width),"height"in mr&&(zr=mr.height)),("color"in mr||"colors"in mr)&&(fr=mr.color||mr.colors,Array.isArray(fr)),fr||("colorCount"in mr&&(Pn=0|mr.colorCount),"colorTexture"in mr&&(Jr=!!mr.colorTexture,fn="rgba4"),"colorType"in mr&&(Cn=mr.colorType,!Jr)&&(Cn==="half float"||Cn==="float16"?fn="rgba16f":Cn!=="float"&&Cn!=="float32"||(fn="rgba32f")),"colorFormat"in mr&&(fn=mr.colorFormat,0<=ot.indexOf(fn)?Jr=!0:0<=bt.indexOf(fn)&&(Jr=!1))),("depthTexture"in mr||"depthStencilTexture"in mr)&&(Lr=!(!mr.depthTexture&&!mr.depthStencilTexture)),"depth"in mr&&(typeof mr.depth=="boolean"?xr=mr.depth:(An=mr.depth,Br=!1)),"stencil"in mr&&(typeof mr.stencil=="boolean"?Br=mr.stencil:(rn=mr.stencil,xr=!1)),"depthStencil"in mr&&(typeof mr.depthStencil=="boolean"?xr=Br=mr.depthStencil:(Fr=mr.depthStencil,Br=xr=!1))):yr=zr=1;var Qr=null,$r=null,Kr=null,en=null;if(Array.isArray(fr))Qr=fr.map(Et);else if(fr)Qr=[Et(fr)];else for(Qr=Array(Pn),fr=0;fr<Pn;++fr)Qr[fr]=mt(yr,zr,Jr,fn,Cn);for(yr=yr||Qr[0].width,zr=zr||Qr[0].height,An?$r=Et(An):xr&&!Br&&($r=mt(yr,zr,Lr,"depth","uint32")),rn?Kr=Et(rn):Br&&!xr&&(Kr=mt(yr,zr,!1,"stencil","uint8")),Fr?en=Et(Fr):!An&&!rn&&Br&&xr&&(en=mt(yr,zr,Lr,"depth stencil","depth stencil")),xr=null,fr=0;fr<Qr.length;++fr)kt(Qr[fr]),Qr[fr]&&Qr[fr].texture&&(Br=Lt[Qr[fr].texture._texture.format]*wt[Qr[fr].texture._texture.type],xr===null&&(xr=Br));return kt($r),kt(Kr),kt(en),At(hr),hr.width=yr,hr.height=zr,hr.colorAttachments=Qr,hr.depthAttachment=$r,hr.stencilAttachment=Kr,hr.depthStencilAttachment=en,ar.color=Qr.map(It),ar.depth=It($r),ar.stencil=It(Kr),ar.depthStencil=It(en),ar.width=hr.width,ar.height=hr.height,Nt(hr),ar}var hr=new nt;return Pe.framebufferCount++,ar(Yt,Xt),B(ar,{resize:function(mr,sr){var fr=Math.max(0|mr,1),yr=Math.max(0|sr||fr,1);if(fr===hr.width&&yr===hr.height)return ar;for(var zr=hr.colorAttachments,xr=0;xr<zr.length;++xr)vt(zr[xr],fr,yr);return vt(hr.depthAttachment,fr,yr),vt(hr.stencilAttachment,fr,yr),vt(hr.depthStencilAttachment,fr,yr),hr.width=ar.width=fr,hr.height=ar.height=yr,Nt(hr),ar},_reglType:"framebuffer",_framebuffer:hr,destroy:function(){Ft(hr),At(hr)},use:function(mr){Ie.setFBO({framebuffer:ar},mr)}})}var Ie={cur:null,next:null,dirty:!1,setFBO:null},ot=["rgba"],bt=["rgba4","rgb565","rgb5 a1"];Je.ext_srgb&&bt.push("srgba"),Je.ext_color_buffer_half_float&&bt.push("rgba16f","rgb16f"),Je.webgl_color_buffer_float&&bt.push("rgba32f");var Pt=["uint8"];Je.oes_texture_half_float&&Pt.push("half float","float16"),Je.oes_texture_float&&Pt.push("float","float32");var Vt=0,nr={};return B(Ie,{getFramebuffer:function(Yt){return typeof Yt=="function"&&Yt._reglType==="framebuffer"&&(Yt=Yt._framebuffer)instanceof nt?Yt:null},create:Kt,createCube:function(Yt){function Xt(hr){var mr,sr={color:null},fr=0,yr=null;mr="rgba";var zr="uint8",xr=1;if(typeof hr=="number"?fr=0|hr:hr?("shape"in hr?fr=hr.shape[0]:("radius"in hr&&(fr=0|hr.radius),"width"in hr?fr=0|hr.width:"height"in hr&&(fr=0|hr.height)),("color"in hr||"colors"in hr)&&(yr=hr.color||hr.colors,Array.isArray(yr)),yr||("colorCount"in hr&&(xr=0|hr.colorCount),"colorType"in hr&&(zr=hr.colorType),"colorFormat"in hr&&(mr=hr.colorFormat)),"depth"in hr&&(sr.depth=hr.depth),"stencil"in hr&&(sr.stencil=hr.stencil),"depthStencil"in hr&&(sr.depthStencil=hr.depthStencil)):fr=1,yr)if(Array.isArray(yr))for(hr=[],mr=0;mr<yr.length;++mr)hr[mr]=yr[mr];else hr=[yr];else for(hr=Array(xr),yr={radius:fr,format:mr,type:zr},mr=0;mr<xr;++mr)hr[mr]=Le.createCube(yr);for(sr.color=Array(hr.length),mr=0;mr<hr.length;++mr)xr=hr[mr],fr=fr||xr.width,sr.color[mr]={target:34069,data:hr[mr]};for(mr=0;6>mr;++mr){for(xr=0;xr<hr.length;++xr)sr.color[xr].target=34069+mr;0<mr&&(sr.depth=ar[0].depth,sr.stencil=ar[0].stencil,sr.depthStencil=ar[0].depthStencil),ar[mr]?ar[mr](sr):ar[mr]=Kt(sr)}return B(Xt,{width:fr,height:fr,color:hr})}var ar=Array(6);return Xt(Yt),B(Xt,{faces:ar,resize:function(hr){var mr=0|hr;if(mr===Xt.width)return Xt;var sr=Xt.color;for(hr=0;hr<sr.length;++hr)sr[hr].resize(mr);for(hr=0;6>hr;++hr)ar[hr].resize(mr);return Xt.width=Xt.height=mr,Xt},_reglType:"framebufferCube",destroy:function(){ar.forEach(function(hr){hr.destroy()})}})},clear:function(){he(nr).forEach(Ft)},restore:function(){Ie.cur=null,Ie.next=null,Ie.dirty=!0,he(nr).forEach(function(Yt){Yt.framebuffer=Be.createFramebuffer(),Nt(Yt)})}})}function C(){this.w=this.z=this.y=this.x=this.state=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.divisor=this.stride=this.offset=0}function M(Be,Je,_e,Le,Ce,Pe,Xe){function ut(){this.id=++Et,this.attributes=[],this.elements=null,this.ownsElements=!1,this.offset=this.count=0,this.instances=-1,this.primitive=4;var vt=Je.oes_vertex_array_object;this.vao=vt?vt.createVertexArrayOES():null,mt[this.id]=this,this.buffers=[]}var kt=_e.maxAttributes,ft=Array(kt);for(_e=0;_e<kt;++_e)ft[_e]=new C;var Et=0,mt={},It={Record:C,scope:{},state:ft,currentVAO:null,targetVAO:null,restore:Je.oes_vertex_array_object?function(){Je.oes_vertex_array_object&&he(mt).forEach(function(vt){vt.refresh()})}:function(){},createVAO:function(vt){function nt(Ft){var Nt;Array.isArray(Ft)?(Nt=Ft,At.elements&&At.ownsElements&&At.elements.destroy(),At.elements=null,At.ownsElements=!1,At.offset=0,At.count=0,At.instances=-1,At.primitive=4):(Ft.elements?(Nt=Ft.elements,At.ownsElements?(typeof Nt=="function"&&Nt._reglType==="elements"?At.elements.destroy():At.elements(Nt),At.ownsElements=!1):Pe.getElements(Ft.elements)?(At.elements=Ft.elements,At.ownsElements=!1):(At.elements=Pe.create(Ft.elements),At.ownsElements=!0)):(At.elements=null,At.ownsElements=!1),Nt=Ft.attributes,At.offset=0,At.count=-1,At.instances=-1,At.primitive=4,At.elements&&(At.count=At.elements._elements.vertCount,At.primitive=At.elements._elements.primType),"offset"in Ft&&(At.offset=0|Ft.offset),"count"in Ft&&(At.count=0|Ft.count),"instances"in Ft&&(At.instances=0|Ft.instances),"primitive"in Ft&&(At.primitive=xe[Ft.primitive])),Ft={};var Kt=At.attributes;Kt.length=Nt.length;for(var Ie=0;Ie<Nt.length;++Ie){var ot,bt=Nt[Ie],Pt=Kt[Ie]=new C,Vt=bt.data||bt;Array.isArray(Vt)||ae(Vt)||s(Vt)?(At.buffers[Ie]&&(ot=At.buffers[Ie],ae(Vt)&&ot._buffer.byteLength>=Vt.byteLength?ot.subdata(Vt):(ot.destroy(),At.buffers[Ie]=null)),At.buffers[Ie]||(ot=At.buffers[Ie]=Ce.create(bt,34962,!1,!0)),Pt.buffer=Ce.getBuffer(ot),Pt.size=0|Pt.buffer.dimension,Pt.normalized=!1,Pt.type=Pt.buffer.dtype,Pt.offset=0,Pt.stride=0,Pt.divisor=0,Pt.state=1,Ft[Ie]=1):Ce.getBuffer(bt)?(Pt.buffer=Ce.getBuffer(bt),Pt.size=0|Pt.buffer.dimension,Pt.normalized=!1,Pt.type=Pt.buffer.dtype,Pt.offset=0,Pt.stride=0,Pt.divisor=0,Pt.state=1):Ce.getBuffer(bt.buffer)?(Pt.buffer=Ce.getBuffer(bt.buffer),Pt.size=0|(+bt.size||Pt.buffer.dimension),Pt.normalized=!!bt.normalized||!1,Pt.type="type"in bt?ce[bt.type]:Pt.buffer.dtype,Pt.offset=0|(bt.offset||0),Pt.stride=0|(bt.stride||0),Pt.divisor=0|(bt.divisor||0),Pt.state=1):"x"in bt&&(Pt.x=+bt.x||0,Pt.y=+bt.y||0,Pt.z=+bt.z||0,Pt.w=+bt.w||0,Pt.state=2)}for(ot=0;ot<At.buffers.length;++ot)!Ft[ot]&&At.buffers[ot]&&(At.buffers[ot].destroy(),At.buffers[ot]=null);return At.refresh(),nt}var At=new ut;return Le.vaoCount+=1,nt.destroy=function(){for(var Ft=0;Ft<At.buffers.length;++Ft)At.buffers[Ft]&&At.buffers[Ft].destroy();At.buffers.length=0,At.ownsElements&&(At.elements.destroy(),At.elements=null,At.ownsElements=!1),At.destroy()},nt._vao=At,nt._reglType="vao",nt(vt)},getVAO:function(vt){return typeof vt=="function"&&vt._vao?vt._vao:null},destroyBuffer:function(vt){for(var nt=0;nt<ft.length;++nt){var At=ft[nt];At.buffer===vt&&(Be.disableVertexAttribArray(nt),At.buffer=null)}},setVAO:Je.oes_vertex_array_object?function(vt){if(vt!==It.currentVAO){var nt=Je.oes_vertex_array_object;vt?nt.bindVertexArrayOES(vt.vao):nt.bindVertexArrayOES(null),It.currentVAO=vt}}:function(vt){if(vt!==It.currentVAO){if(vt)vt.bindAttrs();else{for(var nt=Je.angle_instanced_arrays,At=0;At<ft.length;++At){var Ft=ft[At];Ft.buffer?(Be.enableVertexAttribArray(At),Ft.buffer.bind(),Be.vertexAttribPointer(At,Ft.size,Ft.type,Ft.normalized,Ft.stride,Ft.offfset),nt&&Ft.divisor&&nt.vertexAttribDivisorANGLE(At,Ft.divisor)):(Be.disableVertexAttribArray(At),Be.vertexAttrib4f(At,Ft.x,Ft.y,Ft.z,Ft.w))}Xe.elements?Be.bindBuffer(34963,Xe.elements.buffer.buffer):Be.bindBuffer(34963,null)}It.currentVAO=vt}},clear:Je.oes_vertex_array_object?function(){he(mt).forEach(function(vt){vt.destroy()})}:function(){}};return ut.prototype.bindAttrs=function(){for(var vt=Je.angle_instanced_arrays,nt=this.attributes,At=0;At<nt.length;++At){var Ft=nt[At];Ft.buffer?(Be.enableVertexAttribArray(At),Be.bindBuffer(34962,Ft.buffer.buffer),Be.vertexAttribPointer(At,Ft.size,Ft.type,Ft.normalized,Ft.stride,Ft.offset),vt&&Ft.divisor&&vt.vertexAttribDivisorANGLE(At,Ft.divisor)):(Be.disableVertexAttribArray(At),Be.vertexAttrib4f(At,Ft.x,Ft.y,Ft.z,Ft.w))}for(vt=nt.length;vt<kt;++vt)Be.disableVertexAttribArray(vt);(vt=Pe.getElements(this.elements))?Be.bindBuffer(34963,vt.buffer.buffer):Be.bindBuffer(34963,null)},ut.prototype.refresh=function(){var vt=Je.oes_vertex_array_object;vt&&(vt.bindVertexArrayOES(this.vao),this.bindAttrs(),It.currentVAO=null,vt.bindVertexArrayOES(null))},ut.prototype.destroy=function(){if(this.vao){var vt=Je.oes_vertex_array_object;this===It.currentVAO&&(It.currentVAO=null,vt.bindVertexArrayOES(null)),vt.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),mt[this.id]&&(delete mt[this.id],--Le.vaoCount)},It}function P(Be,Je,_e,Le){function Ce(nt,At,Ft,Nt){this.name=nt,this.id=At,this.location=Ft,this.info=Nt}function Pe(nt,At){for(var Ft=0;Ft<nt.length;++Ft)if(nt[Ft].id===At.id)return void(nt[Ft].location=At.location);nt.push(At)}function Xe(nt,At,Ft){if(!(Kt=(Ft=nt===35632?ft:Et)[At])){var Nt=Je.str(At),Kt=Be.createShader(nt);Be.shaderSource(Kt,Nt),Be.compileShader(Kt),Ft[At]=Kt}return Kt}function ut(nt,At){this.id=vt++,this.fragId=nt,this.vertId=At,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,Le.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function kt(nt,At,Ft){var Nt;Nt=Xe(35632,nt.fragId);var Kt=Xe(35633,nt.vertId);if(At=nt.program=Be.createProgram(),Be.attachShader(At,Nt),Be.attachShader(At,Kt),Ft)for(Nt=0;Nt<Ft.length;++Nt)Kt=Ft[Nt],Be.bindAttribLocation(At,Kt[0],Kt[1]);Be.linkProgram(At),Kt=Be.getProgramParameter(At,35718),Le.profile&&(nt.stats.uniformsCount=Kt);var Ie=nt.uniforms;for(Nt=0;Nt<Kt;++Nt)if(Ft=Be.getActiveUniform(At,Nt)){if(1<Ft.size)for(var ot=0;ot<Ft.size;++ot){var bt=Ft.name.replace("[0]","["+ot+"]");Pe(Ie,new Ce(bt,Je.id(bt),Be.getUniformLocation(At,bt),Ft))}ot=Ft.name,1<Ft.size&&(ot=ot.replace("[0]","")),Pe(Ie,new Ce(ot,Je.id(ot),Be.getUniformLocation(At,ot),Ft))}for(Kt=Be.getProgramParameter(At,35721),Le.profile&&(nt.stats.attributesCount=Kt),nt=nt.attributes,Nt=0;Nt<Kt;++Nt)(Ft=Be.getActiveAttrib(At,Nt))&&Pe(nt,new Ce(Ft.name,Je.id(Ft.name),Be.getAttribLocation(At,Ft.name),Ft))}var ft={},Et={},mt={},It=[],vt=0;return Le.profile&&(_e.getMaxUniformsCount=function(){var nt=0;return It.forEach(function(At){At.stats.uniformsCount>nt&&(nt=At.stats.uniformsCount)}),nt},_e.getMaxAttributesCount=function(){var nt=0;return It.forEach(function(At){At.stats.attributesCount>nt&&(nt=At.stats.attributesCount)}),nt}),{clear:function(){var nt=Be.deleteShader.bind(Be);he(ft).forEach(nt),ft={},he(Et).forEach(nt),Et={},It.forEach(function(At){Be.deleteProgram(At.program)}),It.length=0,mt={},_e.shaderCount=0},program:function(nt,At,Ft,Nt){var Kt=mt[At];Kt||(Kt=mt[At]={});var Ie=Kt[nt];if(Ie&&(Ie.refCount++,!Nt))return Ie;var ot=new ut(At,nt);return _e.shaderCount++,kt(ot,Ft,Nt),Ie||(Kt[nt]=ot),It.push(ot),B(ot,{destroy:function(){if(ot.refCount--,0>=ot.refCount){Be.deleteProgram(ot.program);var bt=It.indexOf(ot);It.splice(bt,1),_e.shaderCount--}0>=Kt[ot.vertId].refCount&&(Be.deleteShader(Et[ot.vertId]),delete Et[ot.vertId],delete mt[ot.fragId][ot.vertId]),Object.keys(mt[ot.fragId]).length||(Be.deleteShader(ft[ot.fragId]),delete ft[ot.fragId],delete mt[ot.fragId])}})},restore:function(){ft={},Et={};for(var nt=0;nt<It.length;++nt)kt(It[nt],null,It[nt].attributes.map(function(At){return[At.location,At.name]}))},shader:Xe,frag:-1,vert:-1}}function O(Be,Je,_e,Le,Ce,Pe,Xe){function ut(kt){var ft;ft=Je.next===null?5121:Je.next.colorAttachments[0].texture._texture.type;var Et=0,mt=0,It=Le.framebufferWidth,vt=Le.framebufferHeight,nt=null;return ae(kt)?nt=kt:kt&&(Et=0|kt.x,mt=0|kt.y,It=0|(kt.width||Le.framebufferWidth-Et),vt=0|(kt.height||Le.framebufferHeight-mt),nt=kt.data||null),_e(),kt=It*vt*4,nt||(ft===5121?nt=new Uint8Array(kt):ft===5126&&(nt=nt||new Float32Array(kt))),Be.pixelStorei(3333,4),Be.readPixels(Et,mt,It,vt,6408,ft,nt),nt}return function(kt){return kt&&"framebuffer"in kt?function(ft){var Et;return Je.setFBO({framebuffer:ft.framebuffer},function(){Et=ut(ft)}),Et}(kt):ut(kt)}}function F(Be){return Array.prototype.slice.call(Be)}function j(Be){return F(Be).join("")}function W(Be){return Array.isArray(Be)||ae(Be)||s(Be)}function Z(Be){return Be.sort(function(Je,_e){return Je==="viewport"?-1:_e==="viewport"?1:Je<_e?-1:1})}function Q(Be,Je,_e,Le){this.thisDep=Be,this.contextDep=Je,this.propDep=_e,this.append=Le}function X(Be){return Be&&!(Be.thisDep||Be.contextDep||Be.propDep)}function G(Be){return new Q(!1,!1,!1,Be)}function Y(Be,Je){var _e=Be.type;if(_e===0)return new Q(!0,1<=(_e=Be.data.length),2<=_e,Je);if(_e===4)return new Q((_e=Be.data).thisDep,_e.contextDep,_e.propDep,Je);if(_e===5)return new Q(!1,!1,!1,Je);if(_e===6){for(var Le=_e=!1,Ce=!1,Pe=0;Pe<Be.data.length;++Pe){var Xe=Be.data[Pe];Xe.type===1?Ce=!0:Xe.type===2?Le=!0:Xe.type===3?_e=!0:Xe.type===0?(_e=!0,1<=(Xe=Xe.data)&&(Le=!0),2<=Xe&&(Ce=!0)):Xe.type===4&&(_e=_e||Xe.data.thisDep,Le=Le||Xe.data.contextDep,Ce=Ce||Xe.data.propDep)}return new Q(_e,Le,Ce,Je)}return new Q(_e===3,_e===2,_e===1,Je)}function K(Be,Je,_e,Le,Ce,Pe,Xe,ut,kt,ft,Et,mt,It,vt,nt){function At(Ct){return Ct.replace(".","_")}function Ft(Ct,Ht,cr){var _r=At(Ct);Kr.push(Ct),$r[_r]=Qr[_r]=!!cr,en[_r]=Ht}function Nt(Ct,Ht,cr){var _r=At(Ct);Kr.push(Ct),Array.isArray(cr)?(Qr[_r]=cr.slice(),$r[_r]=cr.slice()):Qr[_r]=$r[_r]=cr,Tn[_r]=Ht}function Kt(){var Ct=function(){function kr(){var Ir=[],Gr=[];return B(function(){Ir.push.apply(Ir,F(arguments))},{def:function(){var mn="v"+Hr++;return Gr.push(mn),0<arguments.length&&(Ir.push(mn,"="),Ir.push.apply(Ir,F(arguments)),Ir.push(";")),mn},toString:function(){return j([0<Gr.length?"var "+Gr.join(",")+";":"",j(Ir)])}})}function Cr(){function Ir(ia,qn){mn(ia,qn,"=",Gr.def(ia,qn),";")}var Gr=kr(),mn=kr(),hn=Gr.toString,Ln=mn.toString;return B(function(){Gr.apply(Gr,F(arguments))},{def:Gr.def,entry:Gr,exit:mn,save:Ir,set:function(ia,qn,gn){Ir(ia,qn),Gr(ia,qn,"=",gn,";")},toString:function(){return hn()+Ln()}})}var Hr=0,ln=[],xn=[],Zr=kr(),yn={};return{global:Zr,link:function(Ir){for(var Gr=0;Gr<xn.length;++Gr)if(xn[Gr]===Ir)return ln[Gr];return Gr="g"+Hr++,ln.push(Gr),xn.push(Ir),Gr},block:kr,proc:function(Ir,Gr){function mn(){var qn="a"+hn.length;return hn.push(qn),qn}var hn=[];Gr=Gr||0;for(var Ln=0;Ln<Gr;++Ln)mn();var ia=(Ln=Cr()).toString;return yn[Ir]=B(Ln,{arg:mn,toString:function(){return j(["function(",hn.join(),"){",ia(),"}"])}})},scope:Cr,cond:function(){var Ir=j(arguments),Gr=Cr(),mn=Cr(),hn=Gr.toString,Ln=mn.toString;return B(Gr,{then:function(){return Gr.apply(Gr,F(arguments)),this},else:function(){return mn.apply(mn,F(arguments)),this},toString:function(){var ia=Ln();return ia&&(ia="else{"+ia+"}"),j(["if(",Ir,"){",hn(),"}",ia])}})},compile:function(){var Ir=['"use strict";',Zr,"return {"];Object.keys(yn).forEach(function(mn){Ir.push('"',mn,'":',yn[mn].toString(),",")}),Ir.push("}");var Gr=j(Ir).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`);return Function.apply(null,ln.concat(Gr)).apply(null,xn)}}}(),Ht=Ct.link,cr=Ct.global;Ct.id=Zt++,Ct.batchId="0";var _r=Ht(Mn),Vr=Ct.shared={props:"a0"};Object.keys(Mn).forEach(function(kr){Vr[kr]=cr.def(_r,".",kr)});var jr=Ct.next={},vr=Ct.current={};Object.keys(Tn).forEach(function(kr){Array.isArray(Qr[kr])&&(jr[kr]=cr.def(Vr.next,".",kr),vr[kr]=cr.def(Vr.current,".",kr))});var br=Ct.constants={};Object.keys(Rn).forEach(function(kr){br[kr]=cr.def(JSON.stringify(Rn[kr]))}),Ct.invoke=function(kr,Cr){switch(Cr.type){case 0:var Hr=["this",Vr.context,Vr.props,Ct.batchId];return kr.def(Ht(Cr.data),".call(",Hr.slice(0,Math.max(Cr.data.length+1,4)),")");case 1:return kr.def(Vr.props,Cr.data);case 2:return kr.def(Vr.context,Cr.data);case 3:return kr.def("this",Cr.data);case 4:return Cr.data.append(Ct,kr),Cr.data.ref;case 5:return Cr.data.toString();case 6:return Cr.data.map(function(ln){return Ct.invoke(kr,ln)})}},Ct.attribCache={};var Ar={};return Ct.scopeAttrib=function(kr){if((kr=Je.id(kr))in Ar)return Ar[kr];var Cr=ft.scope[kr];return Cr||(Cr=ft.scope[kr]=new Pn),Ar[kr]=Ht(Cr)},Ct}function Ie(Ct,Ht){var cr=Ct.static,_r=Ct.dynamic;if("framebuffer"in cr){var Vr=cr.framebuffer;return Vr?(Vr=ut.getFramebuffer(Vr),G(function(vr,br){var Ar=vr.link(Vr),kr=vr.shared;return br.set(kr.framebuffer,".next",Ar),kr=kr.context,br.set(kr,".framebufferWidth",Ar+".width"),br.set(kr,".framebufferHeight",Ar+".height"),Ar})):G(function(vr,br){var Ar=vr.shared;return br.set(Ar.framebuffer,".next","null"),Ar=Ar.context,br.set(Ar,".framebufferWidth",Ar+".drawingBufferWidth"),br.set(Ar,".framebufferHeight",Ar+".drawingBufferHeight"),"null"})}if("framebuffer"in _r){var jr=_r.framebuffer;return Y(jr,function(vr,br){var Ar=vr.invoke(br,jr),kr=vr.shared,Cr=kr.framebuffer;return Ar=br.def(Cr,".getFramebuffer(",Ar,")"),br.set(Cr,".next",Ar),kr=kr.context,br.set(kr,".framebufferWidth",Ar+"?"+Ar+".width:"+kr+".drawingBufferWidth"),br.set(kr,".framebufferHeight",Ar+"?"+Ar+".height:"+kr+".drawingBufferHeight"),Ar})}return null}function ot(Ct,Ht,cr){function _r(kr){if(kr in Vr){var Cr=Je.id(Vr[kr]);return(kr=G(function(){return Cr})).id=Cr,kr}if(kr in jr){var Hr=jr[kr];return Y(Hr,function(ln,xn){var Zr=ln.invoke(xn,Hr);return xn.def(ln.shared.strings,".id(",Zr,")")})}return null}var Vr=Ct.static,jr=Ct.dynamic,vr=_r("frag"),br=_r("vert"),Ar=null;return X(vr)&&X(br)?(Ar=Et.program(br.id,vr.id,null,cr),Ct=G(function(kr,Cr){return kr.link(Ar)})):Ct=new Q(vr&&vr.thisDep||br&&br.thisDep,vr&&vr.contextDep||br&&br.contextDep,vr&&vr.propDep||br&&br.propDep,function(kr,Cr){var Hr,ln,xn=kr.shared.shader;return Hr=vr?vr.append(kr,Cr):Cr.def(xn,".","frag"),ln=br?br.append(kr,Cr):Cr.def(xn,".","vert"),Cr.def(xn+".program("+ln+","+Hr+")")}),{frag:vr,vert:br,progVar:Ct,program:Ar}}function bt(Ct,Ht){function cr(Zr,yn){if(Zr in _r){var Ir=0|_r[Zr];return yn?jr.offset=Ir:jr.instances=Ir,G(function(mn,hn){return yn&&(mn.OFFSET=Ir),Ir})}if(Zr in Vr){var Gr=Vr[Zr];return Y(Gr,function(mn,hn){var Ln=mn.invoke(hn,Gr);return yn&&(mn.OFFSET=Ln),Ln})}if(yn){if(Ar)return G(function(mn,hn){return mn.OFFSET=0});if(vr)return new Q(br.thisDep,br.contextDep,br.propDep,function(mn,hn){return hn.def(mn.shared.vao+".currentVAO?"+mn.shared.vao+".currentVAO.offset:0")})}else if(vr)return new Q(br.thisDep,br.contextDep,br.propDep,function(mn,hn){return hn.def(mn.shared.vao+".currentVAO?"+mn.shared.vao+".currentVAO.instances:-1")});return null}var _r=Ct.static,Vr=Ct.dynamic,jr={},vr=!1,br=function(){if("vao"in _r){var Zr=_r.vao;return Zr!==null&&ft.getVAO(Zr)===null&&(Zr=ft.createVAO(Zr)),vr=!0,jr.vao=Zr,G(function(Ir){var Gr=ft.getVAO(Zr);return Gr?Ir.link(Gr):"null"})}if("vao"in Vr){vr=!0;var yn=Vr.vao;return Y(yn,function(Ir,Gr){var mn=Ir.invoke(Gr,yn);return Gr.def(Ir.shared.vao+".getVAO("+mn+")")})}return null}(),Ar=!1,kr=function(){if("elements"in _r){var Zr=_r.elements;if(jr.elements=Zr,W(Zr)){var yn=jr.elements=Pe.create(Zr,!0);Zr=Pe.getElements(yn),Ar=!0}else Zr&&(Zr=Pe.getElements(Zr),Ar=!0);return(yn=G(function(Gr,mn){if(Zr){var hn=Gr.link(Zr);return Gr.ELEMENTS=hn}return Gr.ELEMENTS=null})).value=Zr,yn}if("elements"in Vr){Ar=!0;var Ir=Vr.elements;return Y(Ir,function(Gr,mn){var hn=(Ln=Gr.shared).isBufferArgs,Ln=Ln.elements,ia=Gr.invoke(mn,Ir),qn=mn.def("null");return hn=mn.def(hn,"(",ia,")"),ia=Gr.cond(hn).then(qn,"=",Ln,".createStream(",ia,");").else(qn,"=",Ln,".getElements(",ia,");"),mn.entry(ia),mn.exit(Gr.cond(hn).then(Ln,".destroyStream(",qn,");")),Gr.ELEMENTS=qn})}return vr?new Q(br.thisDep,br.contextDep,br.propDep,function(Gr,mn){return mn.def(Gr.shared.vao+".currentVAO?"+Gr.shared.elements+".getElements("+Gr.shared.vao+".currentVAO.elements):null")}):null}(),Cr=cr("offset",!0),Hr=function(){if("primitive"in _r){var Zr=_r.primitive;return jr.primitive=Zr,G(function(Ir,Gr){return xe[Zr]})}if("primitive"in Vr){var yn=Vr.primitive;return Y(yn,function(Ir,Gr){var mn=Ir.constants.primTypes,hn=Ir.invoke(Gr,yn);return Gr.def(mn,"[",hn,"]")})}return Ar?X(kr)?kr.value?G(function(Ir,Gr){return Gr.def(Ir.ELEMENTS,".primType")}):G(function(){return 4}):new Q(kr.thisDep,kr.contextDep,kr.propDep,function(Ir,Gr){var mn=Ir.ELEMENTS;return Gr.def(mn,"?",mn,".primType:",4)}):vr?new Q(br.thisDep,br.contextDep,br.propDep,function(Ir,Gr){return Gr.def(Ir.shared.vao+".currentVAO?"+Ir.shared.vao+".currentVAO.primitive:4")}):null}(),ln=function(){if("count"in _r){var Zr=0|_r.count;return jr.count=Zr,G(function(){return Zr})}if("count"in Vr){var yn=Vr.count;return Y(yn,function(Ir,Gr){return Ir.invoke(Gr,yn)})}return Ar?X(kr)?kr?Cr?new Q(Cr.thisDep,Cr.contextDep,Cr.propDep,function(Ir,Gr){return Gr.def(Ir.ELEMENTS,".vertCount-",Ir.OFFSET)}):G(function(Ir,Gr){return Gr.def(Ir.ELEMENTS,".vertCount")}):G(function(){return-1}):new Q(kr.thisDep||Cr.thisDep,kr.contextDep||Cr.contextDep,kr.propDep||Cr.propDep,function(Ir,Gr){var mn=Ir.ELEMENTS;return Ir.OFFSET?Gr.def(mn,"?",mn,".vertCount-",Ir.OFFSET,":-1"):Gr.def(mn,"?",mn,".vertCount:-1")}):vr?new Q(br.thisDep,br.contextDep,br.propDep,function(Ir,Gr){return Gr.def(Ir.shared.vao,".currentVAO?",Ir.shared.vao,".currentVAO.count:-1")}):null}(),xn=cr("instances",!1);return{elements:kr,primitive:Hr,count:ln,instances:xn,offset:Cr,vao:br,vaoActive:vr,elementsActive:Ar,static:jr}}function Pt(Ct,Ht){var cr=Ct.static,_r=Ct.dynamic,Vr={};return Object.keys(cr).forEach(function(jr){var vr=cr[jr],br=Je.id(jr),Ar=new Pn;if(W(vr))Ar.state=1,Ar.buffer=Ce.getBuffer(Ce.create(vr,34962,!1,!0)),Ar.type=0;else if(Cr=Ce.getBuffer(vr))Ar.state=1,Ar.buffer=Cr,Ar.type=0;else if("constant"in vr){var kr=vr.constant;Ar.buffer="null",Ar.state=2,typeof kr=="number"?Ar.x=kr:rt.forEach(function(Ir,Gr){Gr<kr.length&&(Ar[Ir]=kr[Gr])})}else{var Cr=W(vr.buffer)?Ce.getBuffer(Ce.create(vr.buffer,34962,!1,!0)):Ce.getBuffer(vr.buffer),Hr=0|vr.offset,ln=0|vr.stride,xn=0|vr.size,Zr=!!vr.normalized,yn=0;"type"in vr&&(yn=ce[vr.type]),vr=0|vr.divisor,Ar.buffer=Cr,Ar.state=1,Ar.size=xn,Ar.normalized=Zr,Ar.type=yn||Cr.dtype,Ar.offset=Hr,Ar.stride=ln,Ar.divisor=vr}Vr[jr]=G(function(Ir,Gr){var mn=Ir.attribCache;if(br in mn)return mn[br];var hn={isStream:!1};return Object.keys(Ar).forEach(function(Ln){hn[Ln]=Ar[Ln]}),Ar.buffer&&(hn.buffer=Ir.link(Ar.buffer),hn.type=hn.type||hn.buffer+".dtype"),mn[br]=hn})}),Object.keys(_r).forEach(function(jr){var vr=_r[jr];Vr[jr]=Y(vr,function(br,Ar){function kr(mn){Ar(Zr[mn],"=",Cr,".",mn,"|0;")}var Cr=br.invoke(Ar,vr),Hr=br.shared,ln=br.constants,xn=Hr.isBufferArgs,Zr=(Hr=Hr.buffer,{isStream:Ar.def(!1)}),yn=new Pn;yn.state=1,Object.keys(yn).forEach(function(mn){Zr[mn]=Ar.def(""+yn[mn])});var Ir=Zr.buffer,Gr=Zr.type;return Ar("if(",xn,"(",Cr,")){",Zr.isStream,"=true;",Ir,"=",Hr,".createStream(",34962,",",Cr,");",Gr,"=",Ir,".dtype;","}else{",Ir,"=",Hr,".getBuffer(",Cr,");","if(",Ir,"){",Gr,"=",Ir,".dtype;",'}else if("constant" in ',Cr,"){",Zr.state,"=",2,";","if(typeof "+Cr+'.constant === "number"){',Zr[rt[0]],"=",Cr,".constant;",rt.slice(1).map(function(mn){return Zr[mn]}).join("="),"=0;","}else{",rt.map(function(mn,hn){return Zr[mn]+"="+Cr+".constant.length>"+hn+"?"+Cr+".constant["+hn+"]:0;"}).join(""),"}}else{","if(",xn,"(",Cr,".buffer)){",Ir,"=",Hr,".createStream(",34962,",",Cr,".buffer);","}else{",Ir,"=",Hr,".getBuffer(",Cr,".buffer);","}",Gr,'="type" in ',Cr,"?",ln.glTypes,"[",Cr,".type]:",Ir,".dtype;",Zr.normalized,"=!!",Cr,".normalized;"),kr("size"),kr("offset"),kr("stride"),kr("divisor"),Ar("}}"),Ar.exit("if(",Zr.isStream,"){",Hr,".destroyStream(",Ir,");","}"),Zr})}),Vr}function Vt(Ct,Ht,cr,_r,Vr){function jr(yn){var Ir=br[yn];Ir&&(kr[yn]=Ir)}var vr=function(yn,Ir){if(typeof(Gr=yn.static).frag=="string"&&typeof Gr.vert=="string"){if(0<Object.keys(Ir.dynamic).length)return null;var Gr=Ir.static,mn=Object.keys(Gr);if(0<mn.length&&typeof Gr[mn[0]]=="number"){for(var hn=[],Ln=0;Ln<mn.length;++Ln)hn.push([0|Gr[mn[Ln]],mn[Ln]]);return hn}}return null}(Ct,Ht),br=function(yn,Ir,Gr){function mn(qn){if(qn in hn){var gn=hn[qn];qn=!0;var ta,fa,Za=0|gn.x,Pi=0|gn.y;return"width"in gn?ta=0|gn.width:qn=!1,"height"in gn?fa=0|gn.height:qn=!1,new Q(!qn&&Ir&&Ir.thisDep,!qn&&Ir&&Ir.contextDep,!qn&&Ir&&Ir.propDep,function(yi,Aa){var ja=yi.shared.context,co=ta;"width"in gn||(co=Aa.def(ja,".","framebufferWidth","-",Za));var Bo=fa;return"height"in gn||(Bo=Aa.def(ja,".","framebufferHeight","-",Pi)),[Za,Pi,co,Bo]})}if(qn in Ln){var ni=Ln[qn];return qn=Y(ni,function(yi,Aa){var ja=yi.invoke(Aa,ni),co=yi.shared.context,Bo=Aa.def(ja,".x|0"),Wo=Aa.def(ja,".y|0");return[Bo,Wo,Aa.def('"width" in ',ja,"?",ja,".width|0:","(",co,".","framebufferWidth","-",Bo,")"),ja=Aa.def('"height" in ',ja,"?",ja,".height|0:","(",co,".","framebufferHeight","-",Wo,")")]}),Ir&&(qn.thisDep=qn.thisDep||Ir.thisDep,qn.contextDep=qn.contextDep||Ir.contextDep,qn.propDep=qn.propDep||Ir.propDep),qn}return Ir?new Q(Ir.thisDep,Ir.contextDep,Ir.propDep,function(yi,Aa){var ja=yi.shared.context;return[0,0,Aa.def(ja,".","framebufferWidth"),Aa.def(ja,".","framebufferHeight")]}):null}var hn=yn.static,Ln=yn.dynamic;if(yn=mn("viewport")){var ia=yn;yn=new Q(yn.thisDep,yn.contextDep,yn.propDep,function(qn,gn){var ta=ia.append(qn,gn),fa=qn.shared.context;return gn.set(fa,".viewportWidth",ta[2]),gn.set(fa,".viewportHeight",ta[3]),ta})}return{viewport:yn,scissor_box:mn("scissor.box")}}(Ct,Hr=Ie(Ct)),Ar=bt(Ct),kr=function(yn,Ir){var Gr=yn.static,mn=yn.dynamic,hn={};return Kr.forEach(function(Ln){function ia(gn,ta){if(Ln in Gr){var fa=gn(Gr[Ln]);hn[qn]=G(function(){return fa})}else if(Ln in mn){var Za=mn[Ln];hn[qn]=Y(Za,function(Pi,ni){return ta(Pi,ni,Pi.invoke(ni,Za))})}}var qn=At(Ln);switch(Ln){case"cull.enable":case"blend.enable":case"dither":case"stencil.enable":case"depth.enable":case"scissor.enable":case"polygonOffset.enable":case"sample.alpha":case"sample.enable":case"depth.mask":return ia(function(gn){return gn},function(gn,ta,fa){return fa});case"depth.func":return ia(function(gn){return Qt[gn]},function(gn,ta,fa){return ta.def(gn.constants.compareFuncs,"[",fa,"]")});case"depth.range":return ia(function(gn){return gn},function(gn,ta,fa){return[ta.def("+",fa,"[0]"),ta=ta.def("+",fa,"[1]")]});case"blend.func":return ia(function(gn){return[xt["srcRGB"in gn?gn.srcRGB:gn.src],xt["dstRGB"in gn?gn.dstRGB:gn.dst],xt["srcAlpha"in gn?gn.srcAlpha:gn.src],xt["dstAlpha"in gn?gn.dstAlpha:gn.dst]]},function(gn,ta,fa){function Za(Aa,ja){return ta.def('"',Aa,ja,'" in ',fa,"?",fa,".",Aa,ja,":",fa,".",Aa)}gn=gn.constants.blendFuncs;var Pi=Za("src","RGB"),ni=Za("dst","RGB"),yi=(Pi=ta.def(gn,"[",Pi,"]"),ta.def(gn,"[",Za("src","Alpha"),"]"));return[Pi,ni=ta.def(gn,"[",ni,"]"),yi,gn=ta.def(gn,"[",Za("dst","Alpha"),"]")]});case"blend.equation":return ia(function(gn){return typeof gn=="string"?[An[gn],An[gn]]:typeof gn=="object"?[An[gn.rgb],An[gn.alpha]]:void 0},function(gn,ta,fa){var Za=gn.constants.blendEquations,Pi=ta.def(),ni=ta.def();return(gn=gn.cond("typeof ",fa,'==="string"')).then(Pi,"=",ni,"=",Za,"[",fa,"];"),gn.else(Pi,"=",Za,"[",fa,".rgb];",ni,"=",Za,"[",fa,".alpha];"),ta(gn),[Pi,ni]});case"blend.color":return ia(function(gn){return f(4,function(ta){return+gn[ta]})},function(gn,ta,fa){return f(4,function(Za){return ta.def("+",fa,"[",Za,"]")})});case"stencil.mask":return ia(function(gn){return 0|gn},function(gn,ta,fa){return ta.def(fa,"|0")});case"stencil.func":return ia(function(gn){return[Qt[gn.cmp||"keep"],gn.ref||0,"mask"in gn?gn.mask:-1]},function(gn,ta,fa){return[gn=ta.def('"cmp" in ',fa,"?",gn.constants.compareFuncs,"[",fa,".cmp]",":",7680),ta.def(fa,".ref|0"),ta=ta.def('"mask" in ',fa,"?",fa,".mask|0:-1")]});case"stencil.opFront":case"stencil.opBack":return ia(function(gn){return[Ln==="stencil.opBack"?1029:1028,$t[gn.fail||"keep"],$t[gn.zfail||"keep"],$t[gn.zpass||"keep"]]},function(gn,ta,fa){function Za(ni){return ta.def('"',ni,'" in ',fa,"?",Pi,"[",fa,".",ni,"]:",7680)}var Pi=gn.constants.stencilOps;return[Ln==="stencil.opBack"?1029:1028,Za("fail"),Za("zfail"),Za("zpass")]});case"polygonOffset.offset":return ia(function(gn){return[0|gn.factor,0|gn.units]},function(gn,ta,fa){return[ta.def(fa,".factor|0"),ta=ta.def(fa,".units|0")]});case"cull.face":return ia(function(gn){var ta=0;return gn==="front"?ta=1028:gn==="back"&&(ta=1029),ta},function(gn,ta,fa){return ta.def(fa,'==="front"?',1028,":",1029)});case"lineWidth":return ia(function(gn){return gn},function(gn,ta,fa){return fa});case"frontFace":return ia(function(gn){return Ue[gn]},function(gn,ta,fa){return ta.def(fa+'==="cw"?2304:2305')});case"colorMask":return ia(function(gn){return gn.map(function(ta){return!!ta})},function(gn,ta,fa){return f(4,function(Za){return"!!"+fa+"["+Za+"]"})});case"sample.coverage":return ia(function(gn){return["value"in gn?gn.value:1,!!gn.invert]},function(gn,ta,fa){return[ta.def('"value" in ',fa,"?+",fa,".value:1"),ta=ta.def("!!",fa,".invert")]})}}),hn}(Ct),Cr=ot(Ct,0,vr);jr("viewport"),jr(At("scissor.box"));var Hr,ln=0<Object.keys(kr).length;if((Hr={framebuffer:Hr,draw:Ar,shader:Cr,state:kr,dirty:ln,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}}).profile=function(yn){var Ir,Gr=yn.static;if(yn=yn.dynamic,"profile"in Gr){var mn=!!Gr.profile;(Ir=G(function(Ln,ia){return mn})).enable=mn}else if("profile"in yn){var hn=yn.profile;Ir=Y(hn,function(Ln,ia){return Ln.invoke(ia,hn)})}return Ir}(Ct),Hr.uniforms=function(yn,Ir){var Gr=yn.static,mn=yn.dynamic,hn={};return Object.keys(Gr).forEach(function(Ln){var ia,qn=Gr[Ln];if(typeof qn=="number"||typeof qn=="boolean")ia=G(function(){return qn});else if(typeof qn=="function"){var gn=qn._reglType;gn==="texture2d"||gn==="textureCube"?ia=G(function(ta){return ta.link(qn)}):gn!=="framebuffer"&&gn!=="framebufferCube"||(ia=G(function(ta){return ta.link(qn.color[0])}))}else y(qn)&&(ia=G(function(ta){return ta.global.def("[",f(qn.length,function(fa){return qn[fa]}),"]")}));ia.value=qn,hn[Ln]=ia}),Object.keys(mn).forEach(function(Ln){var ia=mn[Ln];hn[Ln]=Y(ia,function(qn,gn){return qn.invoke(gn,ia)})}),hn}(cr),Hr.drawVAO=Hr.scopeVAO=Ar.vao,!Hr.drawVAO&&Cr.program&&!vr&&_e.angle_instanced_arrays&&Ar.static.elements){var xn=!0;if(Ct=Cr.program.attributes.map(function(yn){return yn=Ht.static[yn],xn=xn&&!!yn,yn}),xn&&0<Ct.length){var Zr=ft.getVAO(ft.createVAO({attributes:Ct,elements:Ar.static.elements}));Hr.drawVAO=new Q(null,null,null,function(yn,Ir){return yn.link(Zr)}),Hr.useVAO=!0}}return vr?Hr.useVAO=!0:Hr.attributes=Pt(Ht),Hr.context=function(yn){var Ir=yn.static,Gr=yn.dynamic,mn={};return Object.keys(Ir).forEach(function(hn){var Ln=Ir[hn];mn[hn]=G(function(ia,qn){return typeof Ln=="number"||typeof Ln=="boolean"?""+Ln:ia.link(Ln)})}),Object.keys(Gr).forEach(function(hn){var Ln=Gr[hn];mn[hn]=Y(Ln,function(ia,qn){return ia.invoke(qn,Ln)})}),mn}(_r),Hr}function nr(Ct,Ht,cr){var _r=Ct.shared.context,Vr=Ct.scope();Object.keys(cr).forEach(function(jr){Ht.save(_r,"."+jr);var vr=cr[jr].append(Ct,Ht);Array.isArray(vr)?Vr(_r,".",jr,"=[",vr.join(),"];"):Vr(_r,".",jr,"=",vr,";")}),Ht(Vr)}function Yt(Ct,Ht,cr,_r){var Vr,jr=(br=Ct.shared).gl,vr=br.framebuffer;Fr&&(Vr=Ht.def(br.extensions,".webgl_draw_buffers"));var br=(Ar=Ct.constants).drawBuffer,Ar=Ar.backBuffer;Ct=cr?cr.append(Ct,Ht):Ht.def(vr,".next"),_r||Ht("if(",Ct,"!==",vr,".cur){"),Ht("if(",Ct,"){",jr,".bindFramebuffer(",36160,",",Ct,".framebuffer);"),Fr&&Ht(Vr,".drawBuffersWEBGL(",br,"[",Ct,".colorAttachments.length]);"),Ht("}else{",jr,".bindFramebuffer(",36160,",null);"),Fr&&Ht(Vr,".drawBuffersWEBGL(",Ar,");"),Ht("}",vr,".cur=",Ct,";"),_r||Ht("}")}function Xt(Ct,Ht,cr){var _r=Ct.shared,Vr=_r.gl,jr=Ct.current,vr=Ct.next,br=_r.current,Ar=_r.next,kr=Ct.cond(br,".dirty");Kr.forEach(function(Cr){var Hr,ln;if(!((Cr=At(Cr))in cr.state))if(Cr in vr){Hr=vr[Cr],ln=jr[Cr];var xn=f(Qr[Cr].length,function(Zr){return kr.def(Hr,"[",Zr,"]")});kr(Ct.cond(xn.map(function(Zr,yn){return Zr+"!=="+ln+"["+yn+"]"}).join("||")).then(Vr,".",Tn[Cr],"(",xn,");",xn.map(function(Zr,yn){return ln+"["+yn+"]="+Zr}).join(";"),";"))}else Hr=kr.def(Ar,".",Cr),xn=Ct.cond(Hr,"!==",br,".",Cr),kr(xn),Cr in en?xn(Ct.cond(Hr).then(Vr,".enable(",en[Cr],");").else(Vr,".disable(",en[Cr],");"),br,".",Cr,"=",Hr,";"):xn(Vr,".",Tn[Cr],"(",Hr,");",br,".",Cr,"=",Hr,";")}),Object.keys(cr.state).length===0&&kr(br,".dirty=false;"),Ht(kr)}function ar(Ct,Ht,cr,_r){var Vr=Ct.shared,jr=Ct.current,vr=Vr.current,br=Vr.gl;Z(Object.keys(cr)).forEach(function(Ar){var kr=cr[Ar];if(!_r||_r(kr)){var Cr=kr.append(Ct,Ht);if(en[Ar]){var Hr=en[Ar];X(kr)?Ht(br,Cr?".enable(":".disable(",Hr,");"):Ht(Ct.cond(Cr).then(br,".enable(",Hr,");").else(br,".disable(",Hr,");")),Ht(vr,".",Ar,"=",Cr,";")}else if(y(Cr)){var ln=jr[Ar];Ht(br,".",Tn[Ar],"(",Cr,");",Cr.map(function(xn,Zr){return ln+"["+Zr+"]="+xn}).join(";"),";")}else Ht(br,".",Tn[Ar],"(",Cr,");",vr,".",Ar,"=",Cr,";")}})}function hr(Ct,Ht){rn&&(Ct.instancing=Ht.def(Ct.shared.extensions,".angle_instanced_arrays"))}function mr(Ct,Ht,cr,_r,Vr){function jr(){return typeof performance=="undefined"?"Date.now()":"performance.now()"}function vr(yn){yn(kr=Ht.def(),"=",jr(),";"),typeof Vr=="string"?yn(ln,".count+=",Vr,";"):yn(ln,".count++;"),vt&&(_r?yn(Cr=Ht.def(),"=",Zr,".getNumPendingQueries();"):yn(Zr,".beginQuery(",ln,");"))}function br(yn){yn(ln,".cpuTime+=",jr(),"-",kr,";"),vt&&(_r?yn(Zr,".pushScopeStats(",Cr,",",Zr,".getNumPendingQueries(),",ln,");"):yn(Zr,".endQuery();"))}function Ar(yn){var Ir=Ht.def(xn,".profile");Ht(xn,".profile=",yn,";"),Ht.exit(xn,".profile=",Ir,";")}var kr,Cr,Hr=Ct.shared,ln=Ct.stats,xn=Hr.current,Zr=Hr.timer;if(cr=cr.profile){if(X(cr))return void(cr.enable?(vr(Ht),br(Ht.exit),Ar("true")):Ar("false"));Ar(cr=cr.append(Ct,Ht))}else cr=Ht.def(xn,".profile");vr(Hr=Ct.block()),Ht("if(",cr,"){",Hr,"}"),br(Ct=Ct.block()),Ht.exit("if(",cr,"){",Ct,"}")}function sr(Ct,Ht,cr,_r,Vr){function jr(br,Ar,kr){function Cr(){Ht("if(!",Zr,".buffer){",ln,".enableVertexAttribArray(",xn,");}");var mn,hn=kr.type;mn=kr.size?Ht.def(kr.size,"||",Ar):Ar,Ht("if(",Zr,".type!==",hn,"||",Zr,".size!==",mn,"||",Gr.map(function(Ln){return Zr+"."+Ln+"!=="+kr[Ln]}).join("||"),"){",ln,".bindBuffer(",34962,",",yn,".buffer);",ln,".vertexAttribPointer(",[xn,mn,hn,kr.normalized,kr.stride,kr.offset],");",Zr,".type=",hn,";",Zr,".size=",mn,";",Gr.map(function(Ln){return Zr+"."+Ln+"="+kr[Ln]+";"}).join(""),"}"),rn&&(hn=kr.divisor,Ht("if(",Zr,".divisor!==",hn,"){",Ct.instancing,".vertexAttribDivisorANGLE(",[xn,hn],");",Zr,".divisor=",hn,";}"))}function Hr(){Ht("if(",Zr,".buffer){",ln,".disableVertexAttribArray(",xn,");",Zr,".buffer=null;","}if(",rt.map(function(mn,hn){return Zr+"."+mn+"!=="+Ir[hn]}).join("||"),"){",ln,".vertexAttrib4f(",xn,",",Ir,");",rt.map(function(mn,hn){return Zr+"."+mn+"="+Ir[hn]+";"}).join(""),"}")}var ln=vr.gl,xn=Ht.def(br,".location"),Zr=Ht.def(vr.attributes,"[",xn,"]");br=kr.state;var yn=kr.buffer,Ir=[kr.x,kr.y,kr.z,kr.w],Gr=["buffer","normalized","offset","stride"];br===1?Cr():br===2?Hr():(Ht("if(",br,"===",1,"){"),Cr(),Ht("}else{"),Hr(),Ht("}"))}var vr=Ct.shared;_r.forEach(function(br){var Ar,kr=br.name,Cr=cr.attributes[kr];if(Cr){if(!Vr(Cr))return;Ar=Cr.append(Ct,Ht)}else{if(!Vr(He))return;var Hr=Ct.scopeAttrib(kr);Ar={},Object.keys(new Pn).forEach(function(ln){Ar[ln]=Ht.def(Hr,".",ln)})}jr(Ct.link(br),function(ln){switch(ln){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}(br.info.type),Ar)})}function fr(Ct,Ht,cr,_r,Vr,jr){for(var vr,br=Ct.shared,Ar=br.gl,kr={},Cr=0;Cr<_r.length;++Cr){var Hr=(Gr=_r[Cr]).name,ln=Gr.info.type,xn=Gr.info.size,Zr=cr.uniforms[Hr];if(1<xn){if(!Zr)continue;var yn=Hr.replace("[0]","");if(kr[yn])continue;kr[yn]=1}var Ir,Gr=Ct.link(Gr)+".location";if(Zr){if(!Vr(Zr))continue;if(X(Zr)){if(Hr=Zr.value,ln===35678||ln===35680)Ht(Ar,".uniform1i(",Gr,",",(ln=Ct.link(Hr._texture||Hr.color[0]._texture))+".bind());"),Ht.exit(ln,".unbind();");else if(ln===35674||ln===35675||ln===35676)xn=Ct.global.def("new Float32Array(["+Array.prototype.slice.call(Hr)+"])"),Hr=2,ln===35675?Hr=3:ln===35676&&(Hr=4),Ht(Ar,".uniformMatrix",Hr,"fv(",Gr,",false,",xn,");");else{switch(ln){case 5126:vr="1f";break;case 35664:vr="2f";break;case 35665:vr="3f";break;case 35666:vr="4f";break;case 35670:case 5124:vr="1i";break;case 35671:case 35667:vr="2i";break;case 35672:case 35668:vr="3i";break;case 35673:vr="4i";break;case 35669:vr="4i"}1<xn?(vr+="v",Hr=Ct.global.def("["+Array.prototype.slice.call(Hr)+"]")):Hr=y(Hr)?Array.prototype.slice.call(Hr):Hr,Ht(Ar,".uniform",vr,"(",Gr,",",Hr,");")}continue}Ir=Zr.append(Ct,Ht)}else{if(!Vr(He))continue;Ir=Ht.def(br.uniforms,"[",Je.id(Hr),"]")}switch(ln===35678?Ht("if(",Ir,"&&",Ir,'._reglType==="framebuffer"){',Ir,"=",Ir,".color[0];","}"):ln===35680&&Ht("if(",Ir,"&&",Ir,'._reglType==="framebufferCube"){',Ir,"=",Ir,".color[0];","}"),Hr=1,ln){case 35678:case 35680:ln=Ht.def(Ir,"._texture"),Ht(Ar,".uniform1i(",Gr,",",ln,".bind());"),Ht.exit(ln,".unbind();");continue;case 5124:case 35670:vr="1i";break;case 35667:case 35671:vr="2i",Hr=2;break;case 35668:case 35672:vr="3i",Hr=3;break;case 35669:case 35673:vr="4i",Hr=4;break;case 5126:vr="1f";break;case 35664:vr="2f",Hr=2;break;case 35665:vr="3f",Hr=3;break;case 35666:vr="4f",Hr=4;break;case 35674:vr="Matrix2fv";break;case 35675:vr="Matrix3fv";break;case 35676:vr="Matrix4fv"}if(vr.indexOf("Matrix")===-1&&1<xn&&(vr+="v",Hr=1),vr.charAt(0)==="M"){Ht(Ar,".uniform",vr,"(",Gr,","),Gr=Math.pow(ln-35674+2,2);var mn=Ct.global.def("new Float32Array(",Gr,")");Array.isArray(Ir)?Ht("false,(",f(Gr,function(Ln){return mn+"["+Ln+"]="+Ir[Ln]}),",",mn,")"):Ht("false,(Array.isArray(",Ir,")||",Ir," instanceof Float32Array)?",Ir,":(",f(Gr,function(Ln){return mn+"["+Ln+"]="+Ir+"["+Ln+"]"}),",",mn,")"),Ht(");")}else{if(1<Hr){ln=[];var hn=[];for(xn=0;xn<Hr;++xn)Array.isArray(Ir)?hn.push(Ir[xn]):hn.push(Ht.def(Ir+"["+xn+"]")),jr&&ln.push(Ht.def());jr&&Ht("if(!",Ct.batchId,"||",ln.map(function(Ln,ia){return Ln+"!=="+hn[ia]}).join("||"),"){",ln.map(function(Ln,ia){return Ln+"="+hn[ia]+";"}).join("")),Ht(Ar,".uniform",vr,"(",Gr,",",hn.join(","),");")}else jr&&(ln=Ht.def(),Ht("if(!",Ct.batchId,"||",ln,"!==",Ir,"){",ln,"=",Ir,";")),Ht(Ar,".uniform",vr,"(",Gr,",",Ir,");");jr&&Ht("}")}}}function yr(Ct,Ht,cr,_r){function Vr(hn){var Ln=ln[hn];return Ln?Ln.contextDep&&_r.contextDynamic||Ln.propDep?Ln.append(Ct,cr):Ln.append(Ct,Ht):Ht.def(Hr,".",hn)}function jr(){function hn(){cr(Ar,".drawElementsInstancedANGLE(",[Zr,Ir,Gr,yn+"<<(("+Gr+"-5121)>>1)",br],");")}function Ln(){cr(Ar,".drawArraysInstancedANGLE(",[Zr,yn,Ir,br],");")}xn&&xn!=="null"?mn?hn():(cr("if(",xn,"){"),hn(),cr("}else{"),Ln(),cr("}")):Ln()}function vr(){function hn(){cr(Cr+".drawElements("+[Zr,Ir,Gr,yn+"<<(("+Gr+"-5121)>>1)"]+");")}function Ln(){cr(Cr+".drawArrays("+[Zr,yn,Ir]+");")}xn&&xn!=="null"?mn?hn():(cr("if(",xn,"){"),hn(),cr("}else{"),Ln(),cr("}")):Ln()}var br,Ar,kr=Ct.shared,Cr=kr.gl,Hr=kr.draw,ln=_r.draw,xn=function(){var hn=ln.elements,Ln=Ht;return hn?((hn.contextDep&&_r.contextDynamic||hn.propDep)&&(Ln=cr),hn=hn.append(Ct,Ln),ln.elementsActive&&Ln("if("+hn+")"+Cr+".bindBuffer(34963,"+hn+".buffer.buffer);")):(hn=Ln.def(),Ln(hn,"=",Hr,".","elements",";","if(",hn,"){",Cr,".bindBuffer(",34963,",",hn,".buffer.buffer);}","else if(",kr.vao,".currentVAO){",hn,"=",Ct.shared.elements+".getElements("+kr.vao,".currentVAO.elements);",Lr?"":"if("+hn+")"+Cr+".bindBuffer(34963,"+hn+".buffer.buffer);","}")),hn}(),Zr=Vr("primitive"),yn=Vr("offset"),Ir=function(){var hn=ln.count,Ln=Ht;return hn?((hn.contextDep&&_r.contextDynamic||hn.propDep)&&(Ln=cr),hn=hn.append(Ct,Ln)):hn=Ln.def(Hr,".","count"),hn}();if(typeof Ir=="number"){if(Ir===0)return}else cr("if(",Ir,"){"),cr.exit("}");rn&&(br=Vr("instances"),Ar=Ct.instancing);var Gr=xn+".type",mn=ln.elements&&X(ln.elements)&&!ln.vaoActive;rn&&(typeof br!="number"||0<=br)?typeof br=="string"?(cr("if(",br,">0){"),jr(),cr("}else if(",br,"<0){"),vr(),cr("}")):jr():vr()}function zr(Ct,Ht,cr,_r,Vr){return Vr=(Ht=Kt()).proc("body",Vr),rn&&(Ht.instancing=Vr.def(Ht.shared.extensions,".angle_instanced_arrays")),Ct(Ht,Vr,cr,_r),Ht.compile().body}function xr(Ct,Ht,cr,_r){hr(Ct,Ht),cr.useVAO?cr.drawVAO?Ht(Ct.shared.vao,".setVAO(",cr.drawVAO.append(Ct,Ht),");"):Ht(Ct.shared.vao,".setVAO(",Ct.shared.vao,".targetVAO);"):(Ht(Ct.shared.vao,".setVAO(null);"),sr(Ct,Ht,cr,_r.attributes,function(){return!0})),fr(Ct,Ht,cr,_r.uniforms,function(){return!0},!1),yr(Ct,Ht,Ht,cr)}function Br(Ct,Ht,cr,_r){function Vr(){return!0}Ct.batchId="a1",hr(Ct,Ht),sr(Ct,Ht,cr,_r.attributes,Vr),fr(Ct,Ht,cr,_r.uniforms,Vr,!1),yr(Ct,Ht,Ht,cr)}function Jr(Ct,Ht,cr,_r){function Vr(Hr){return Hr.contextDep&&vr||Hr.propDep}function jr(Hr){return!Vr(Hr)}hr(Ct,Ht);var vr=cr.contextDep,br=Ht.def(),Ar=Ht.def();Ct.shared.props=Ar,Ct.batchId=br;var kr=Ct.scope(),Cr=Ct.scope();Ht(kr.entry,"for(",br,"=0;",br,"<","a1",";++",br,"){",Ar,"=","a0","[",br,"];",Cr,"}",kr.exit),cr.needsContext&&nr(Ct,Cr,cr.context),cr.needsFramebuffer&&Yt(Ct,Cr,cr.framebuffer),ar(Ct,Cr,cr.state,Vr),cr.profile&&Vr(cr.profile)&&mr(Ct,Cr,cr,!1,!0),_r?(cr.useVAO?cr.drawVAO?Vr(cr.drawVAO)?Cr(Ct.shared.vao,".setVAO(",cr.drawVAO.append(Ct,Cr),");"):kr(Ct.shared.vao,".setVAO(",cr.drawVAO.append(Ct,kr),");"):kr(Ct.shared.vao,".setVAO(",Ct.shared.vao,".targetVAO);"):(kr(Ct.shared.vao,".setVAO(null);"),sr(Ct,kr,cr,_r.attributes,jr),sr(Ct,Cr,cr,_r.attributes,Vr)),fr(Ct,kr,cr,_r.uniforms,jr,!1),fr(Ct,Cr,cr,_r.uniforms,Vr,!0),yr(Ct,kr,Cr,cr)):(Ht=Ct.global.def("{}"),_r=cr.shader.progVar.append(Ct,Cr),Ar=Cr.def(_r,".id"),kr=Cr.def(Ht,"[",Ar,"]"),Cr(Ct.shared.gl,".useProgram(",_r,".program);","if(!",kr,"){",kr,"=",Ht,"[",Ar,"]=",Ct.link(function(Hr){return zr(Br,Ct,cr,Hr,2)}),"(",_r,");}",kr,".call(this,a0[",br,"],",br,");"))}function fn(Ct,Ht){function cr(vr){var br=Ht.shader[vr];br&&_r.set(Vr.shader,"."+vr,br.append(Ct,_r))}var _r=Ct.proc("scope",3);Ct.batchId="a2";var Vr=Ct.shared,jr=Vr.current;nr(Ct,_r,Ht.context),Ht.framebuffer&&Ht.framebuffer.append(Ct,_r),Z(Object.keys(Ht.state)).forEach(function(vr){var br=Ht.state[vr].append(Ct,_r);y(br)?br.forEach(function(Ar,kr){_r.set(Ct.next[vr],"["+kr+"]",Ar)}):_r.set(Vr.next,"."+vr,br)}),mr(Ct,_r,Ht,!0,!0),["elements","offset","count","instances","primitive"].forEach(function(vr){var br=Ht.draw[vr];br&&_r.set(Vr.draw,"."+vr,""+br.append(Ct,_r))}),Object.keys(Ht.uniforms).forEach(function(vr){var br=Ht.uniforms[vr].append(Ct,_r);Array.isArray(br)&&(br="["+br.join()+"]"),_r.set(Vr.uniforms,"["+Je.id(vr)+"]",br)}),Object.keys(Ht.attributes).forEach(function(vr){var br=Ht.attributes[vr].append(Ct,_r),Ar=Ct.scopeAttrib(vr);Object.keys(new Pn).forEach(function(kr){_r.set(Ar,"."+kr,br[kr])})}),Ht.scopeVAO&&_r.set(Vr.vao,".targetVAO",Ht.scopeVAO.append(Ct,_r)),cr("vert"),cr("frag"),0<Object.keys(Ht.state).length&&(_r(jr,".dirty=true;"),_r.exit(jr,".dirty=true;")),_r("a1(",Ct.shared.context,",a0,",Ct.batchId,");")}function Cn(Ct,Ht,cr){var _r=Ht.static[cr];if(_r&&function(Cr){if(typeof Cr=="object"&&!y(Cr)){for(var Hr=Object.keys(Cr),ln=0;ln<Hr.length;++ln)if(ee.isDynamic(Cr[Hr[ln]]))return!0;return!1}}(_r)){var Vr=Ct.global,jr=Object.keys(_r),vr=!1,br=!1,Ar=!1,kr=Ct.global.def("{}");jr.forEach(function(Cr){var Hr=_r[Cr];if(ee.isDynamic(Hr))typeof Hr=="function"&&(Hr=_r[Cr]=ee.unbox(Hr)),Cr=Y(Hr,null),vr=vr||Cr.thisDep,Ar=Ar||Cr.propDep,br=br||Cr.contextDep;else{switch(Vr(kr,".",Cr,"="),typeof Hr){case"number":Vr(Hr);break;case"string":Vr('"',Hr,'"');break;case"object":Array.isArray(Hr)&&Vr("[",Hr.join(),"]");break;default:Vr(Ct.link(Hr))}Vr(";")}}),Ht.dynamic[cr]=new ee.DynamicVariable(4,{thisDep:vr,contextDep:br,propDep:Ar,ref:kr,append:function(Cr,Hr){jr.forEach(function(ln){var xn=_r[ln];ee.isDynamic(xn)&&(xn=Cr.invoke(Hr,xn),Hr(kr,".",ln,"=",xn,";"))})}}),delete Ht.static[cr]}}var Pn=ft.Record,An={add:32774,subtract:32778,"reverse subtract":32779};_e.ext_blend_minmax&&(An.min=32775,An.max=32776);var rn=_e.angle_instanced_arrays,Fr=_e.webgl_draw_buffers,Lr=_e.oes_vertex_array_object,Qr={dirty:!0,profile:nt.profile},$r={},Kr=[],en={},Tn={};Ft("dither",3024),Ft("blend.enable",3042),Nt("blend.color","blendColor",[0,0,0,0]),Nt("blend.equation","blendEquationSeparate",[32774,32774]),Nt("blend.func","blendFuncSeparate",[1,0,1,0]),Ft("depth.enable",2929,!0),Nt("depth.func","depthFunc",513),Nt("depth.range","depthRange",[0,1]),Nt("depth.mask","depthMask",!0),Nt("colorMask","colorMask",[!0,!0,!0,!0]),Ft("cull.enable",2884),Nt("cull.face","cullFace",1029),Nt("frontFace","frontFace",2305),Nt("lineWidth","lineWidth",1),Ft("polygonOffset.enable",32823),Nt("polygonOffset.offset","polygonOffset",[0,0]),Ft("sample.alpha",32926),Ft("sample.enable",32928),Nt("sample.coverage","sampleCoverage",[1,!1]),Ft("stencil.enable",2960),Nt("stencil.mask","stencilMask",-1),Nt("stencil.func","stencilFunc",[519,0,-1]),Nt("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]),Nt("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]),Ft("scissor.enable",3089),Nt("scissor.box","scissor",[0,0,Be.drawingBufferWidth,Be.drawingBufferHeight]),Nt("viewport","viewport",[0,0,Be.drawingBufferWidth,Be.drawingBufferHeight]);var Mn={gl:Be,context:It,strings:Je,next:$r,current:Qr,draw:mt,elements:Pe,buffer:Ce,shader:Et,attributes:ft.state,vao:ft,uniforms:kt,framebuffer:ut,extensions:_e,timer:vt,isBufferArgs:W},Rn={primTypes:xe,compareFuncs:Qt,blendFuncs:xt,blendEquations:An,stencilOps:$t,glTypes:ce,orientationType:Ue};Fr&&(Rn.backBuffer=[1029],Rn.drawBuffer=f(Le.maxDrawbuffers,function(Ct){return Ct===0?[0]:f(Ct,function(Ht){return 36064+Ht})}));var Zt=0;return{next:$r,current:Qr,procs:function(){var Ct=Kt(),Ht=Ct.proc("poll"),cr=Ct.proc("refresh"),_r=Ct.block();Ht(_r),cr(_r);var Vr,jr=Ct.shared,vr=jr.gl,br=jr.next,Ar=jr.current;_r(Ar,".dirty=false;"),Yt(Ct,Ht),Yt(Ct,cr,null,!0),rn&&(Vr=Ct.link(rn)),_e.oes_vertex_array_object&&cr(Ct.link(_e.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var kr=0;kr<Le.maxAttributes;++kr){var Cr=cr.def(jr.attributes,"[",kr,"]"),Hr=Ct.cond(Cr,".buffer");Hr.then(vr,".enableVertexAttribArray(",kr,");",vr,".bindBuffer(",34962,",",Cr,".buffer.buffer);",vr,".vertexAttribPointer(",kr,",",Cr,".size,",Cr,".type,",Cr,".normalized,",Cr,".stride,",Cr,".offset);").else(vr,".disableVertexAttribArray(",kr,");",vr,".vertexAttrib4f(",kr,",",Cr,".x,",Cr,".y,",Cr,".z,",Cr,".w);",Cr,".buffer=null;"),cr(Hr),rn&&cr(Vr,".vertexAttribDivisorANGLE(",kr,",",Cr,".divisor);")}return cr(Ct.shared.vao,".currentVAO=null;",Ct.shared.vao,".setVAO(",Ct.shared.vao,".targetVAO);"),Object.keys(en).forEach(function(ln){var xn=en[ln],Zr=_r.def(br,".",ln),yn=Ct.block();yn("if(",Zr,"){",vr,".enable(",xn,")}else{",vr,".disable(",xn,")}",Ar,".",ln,"=",Zr,";"),cr(yn),Ht("if(",Zr,"!==",Ar,".",ln,"){",yn,"}")}),Object.keys(Tn).forEach(function(ln){var xn,Zr,yn=Tn[ln],Ir=Qr[ln],Gr=Ct.block();Gr(vr,".",yn,"("),y(Ir)?(yn=Ir.length,xn=Ct.global.def(br,".",ln),Zr=Ct.global.def(Ar,".",ln),Gr(f(yn,function(mn){return xn+"["+mn+"]"}),");",f(yn,function(mn){return Zr+"["+mn+"]="+xn+"["+mn+"];"}).join("")),Ht("if(",f(yn,function(mn){return xn+"["+mn+"]!=="+Zr+"["+mn+"]"}).join("||"),"){",Gr,"}")):(xn=_r.def(br,".",ln),Zr=_r.def(Ar,".",ln),Gr(xn,");",Ar,".",ln,"=",xn,";"),Ht("if(",xn,"!==",Zr,"){",Gr,"}")),cr(Gr)}),Ct.compile()}(),compile:function(Ct,Ht,cr,_r,Vr){var jr=Kt();jr.stats=jr.link(Vr),Object.keys(Ht.static).forEach(function(br){Cn(jr,Ht,br)}),$e.forEach(function(br){Cn(jr,Ct,br)});var vr=Vt(Ct,Ht,cr,_r);return function(br,Ar){var kr=br.proc("draw",1);hr(br,kr),nr(br,kr,Ar.context),Yt(br,kr,Ar.framebuffer),Xt(br,kr,Ar),ar(br,kr,Ar.state),mr(br,kr,Ar,!1,!0);var Cr=Ar.shader.progVar.append(br,kr);if(kr(br.shared.gl,".useProgram(",Cr,".program);"),Ar.shader.program)xr(br,kr,Ar,Ar.shader.program);else{kr(br.shared.vao,".setVAO(null);");var Hr=br.global.def("{}"),ln=kr.def(Cr,".id"),xn=kr.def(Hr,"[",ln,"]");kr(br.cond(xn).then(xn,".call(this,a0);").else(xn,"=",Hr,"[",ln,"]=",br.link(function(Zr){return zr(xr,br,Ar,Zr,1)}),"(",Cr,");",xn,".call(this,a0);"))}0<Object.keys(Ar.state).length&&kr(br.shared.current,".dirty=true;"),br.shared.vao&&kr(br.shared.vao,".setVAO(null);")}(jr,vr),fn(jr,vr),function(br,Ar){function kr(Ir){return Ir.contextDep&&Hr||Ir.propDep}var Cr=br.proc("batch",2);br.batchId="0",hr(br,Cr);var Hr=!1,ln=!0;Object.keys(Ar.context).forEach(function(Ir){Hr=Hr||Ar.context[Ir].propDep}),Hr||(nr(br,Cr,Ar.context),ln=!1);var xn=!1;if((Zr=Ar.framebuffer)?(Zr.propDep?Hr=xn=!0:Zr.contextDep&&Hr&&(xn=!0),xn||Yt(br,Cr,Zr)):Yt(br,Cr,null),Ar.state.viewport&&Ar.state.viewport.propDep&&(Hr=!0),Xt(br,Cr,Ar),ar(br,Cr,Ar.state,function(Ir){return!kr(Ir)}),Ar.profile&&kr(Ar.profile)||mr(br,Cr,Ar,!1,"a1"),Ar.contextDep=Hr,Ar.needsContext=ln,Ar.needsFramebuffer=xn,(ln=Ar.shader.progVar).contextDep&&Hr||ln.propDep)Jr(br,Cr,Ar,null);else if(ln=ln.append(br,Cr),Cr(br.shared.gl,".useProgram(",ln,".program);"),Ar.shader.program)Jr(br,Cr,Ar,Ar.shader.program);else{Cr(br.shared.vao,".setVAO(null);");var Zr=br.global.def("{}"),yn=(xn=Cr.def(ln,".id"),Cr.def(Zr,"[",xn,"]"));Cr(br.cond(yn).then(yn,".call(this,a0,a1);").else(yn,"=",Zr,"[",xn,"]=",br.link(function(Ir){return zr(Jr,br,Ar,Ir,2)}),"(",ln,");",yn,".call(this,a0,a1);"))}0<Object.keys(Ar.state).length&&Cr(br.shared.current,".dirty=true;"),br.shared.vao&&Cr(br.shared.vao,".setVAO(null);")}(jr,vr),B(jr.compile(),{destroy:function(){vr.shader.program.destroy()}})}}}function D(Be,Je){for(var _e=0;_e<Be.length;++_e)if(Be[_e]===Je)return _e;return-1}var B=function(Be,Je){for(var _e=Object.keys(Je),Le=0;Le<_e.length;++Le)Be[_e[Le]]=Je[_e[Le]];return Be},q=0,ee={DynamicVariable:t,define:function(Be,Je){return new t(Be,m(Je+""))},isDynamic:function(Be){return typeof Be=="function"&&!Be._reglType||Be instanceof t},unbox:function Be(Je,_e){return typeof Je=="function"?new t(0,Je):typeof Je=="number"||typeof Je=="boolean"?new t(5,Je):Array.isArray(Je)?new t(6,Je.map(function(Le,Ce){return Be(Le)})):Je instanceof t?Je:void 0},accessor:m},J={next:typeof requestAnimationFrame=="function"?function(Be){return requestAnimationFrame(Be)}:function(Be){return setTimeout(Be,16)},cancel:typeof cancelAnimationFrame=="function"?function(Be){return cancelAnimationFrame(Be)}:clearTimeout},$=typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date},te=i();te.zero=i();var ie=function(Be,Je){var _e=1;Je.ext_texture_filter_anisotropic&&(_e=Be.getParameter(34047));var Le=1,Ce=1;Je.webgl_draw_buffers&&(Le=Be.getParameter(34852),Ce=Be.getParameter(36063));var Pe=!!Je.oes_texture_float;if(Pe){Pe=Be.createTexture(),Be.bindTexture(3553,Pe),Be.texImage2D(3553,0,6408,1,1,0,6408,5126,null);var Xe=Be.createFramebuffer();if(Be.bindFramebuffer(36160,Xe),Be.framebufferTexture2D(36160,36064,3553,Pe,0),Be.bindTexture(3553,null),Be.checkFramebufferStatus(36160)!==36053)Pe=!1;else{Be.viewport(0,0,1,1),Be.clearColor(1,0,0,1),Be.clear(16384);var ut=te.allocType(5126,4);Be.readPixels(0,0,1,1,6408,5126,ut),Be.getError()?Pe=!1:(Be.deleteFramebuffer(Xe),Be.deleteTexture(Pe),Pe=ut[0]===1),te.freeType(ut)}}return ut=!0,typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))||(ut=Be.createTexture(),Xe=te.allocType(5121,36),Be.activeTexture(33984),Be.bindTexture(34067,ut),Be.texImage2D(34069,0,6408,3,3,0,6408,5121,Xe),te.freeType(Xe),Be.bindTexture(34067,null),Be.deleteTexture(ut),ut=!Be.getError()),{colorBits:[Be.getParameter(3410),Be.getParameter(3411),Be.getParameter(3412),Be.getParameter(3413)],depthBits:Be.getParameter(3414),stencilBits:Be.getParameter(3415),subpixelBits:Be.getParameter(3408),extensions:Object.keys(Je).filter(function(kt){return!!Je[kt]}),maxAnisotropic:_e,maxDrawbuffers:Le,maxColorAttachments:Ce,pointSizeDims:Be.getParameter(33901),lineWidthDims:Be.getParameter(33902),maxViewportDims:Be.getParameter(3386),maxCombinedTextureUnits:Be.getParameter(35661),maxCubeMapSize:Be.getParameter(34076),maxRenderbufferSize:Be.getParameter(34024),maxTextureUnits:Be.getParameter(34930),maxTextureSize:Be.getParameter(3379),maxAttributes:Be.getParameter(34921),maxVertexUniforms:Be.getParameter(36347),maxVertexTextureUnits:Be.getParameter(35660),maxVaryingVectors:Be.getParameter(36348),maxFragmentUniforms:Be.getParameter(36349),glsl:Be.getParameter(35724),renderer:Be.getParameter(7937),vendor:Be.getParameter(7936),version:Be.getParameter(7938),readFloat:Pe,npotTextureCube:ut}},ae=function(Be){return Be instanceof Uint8Array||Be instanceof Uint16Array||Be instanceof Uint32Array||Be instanceof Int8Array||Be instanceof Int16Array||Be instanceof Int32Array||Be instanceof Float32Array||Be instanceof Float64Array||Be instanceof Uint8ClampedArray},he=function(Be){return Object.keys(Be).map(function(Je){return Be[Je]})},se={shape:function(Be){for(var Je=[];Be.length;Be=Be[0])Je.push(Be.length);return Je},flatten:function(Be,Je,_e,Le){var Ce=1;if(Je.length)for(var Pe=0;Pe<Je.length;++Pe)Ce*=Je[Pe];else Ce=0;switch(_e=Le||te.allocType(_e,Ce),Je.length){case 0:break;case 1:for(Le=Je[0],Je=0;Je<Le;++Je)_e[Je]=Be[Je];break;case 2:for(Le=Je[0],Je=Je[1],Pe=Ce=0;Pe<Le;++Pe)for(var Xe=Be[Pe],ut=0;ut<Je;++ut)_e[Ce++]=Xe[ut];break;case 3:o(Be,Je[0],Je[1],Je[2],_e,0);break;default:(function kt(ft,Et,mt,It,vt){for(var nt=1,At=mt+1;At<Et.length;++At)nt*=Et[At];var Ft=Et[mt];if(Et.length-mt==4){var Nt=Et[mt+1],Kt=Et[mt+2];for(Et=Et[mt+3],At=0;At<Ft;++At)o(ft[At],Nt,Kt,Et,It,vt),vt+=nt}else for(At=0;At<Ft;++At)kt(ft[At],Et,mt+1,It,vt),vt+=nt})(Be,Je,0,_e,0)}return _e}},de={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},ce={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},ve={dynamic:35048,stream:35040,static:35044},ke=se.flatten,Ee=se.shape,be=[];be[5120]=1,be[5122]=2,be[5124]=4,be[5121]=1,be[5123]=2,be[5125]=4,be[5126]=4;var xe={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},ue=new Float32Array(1),me=new Uint32Array(ue.buffer),we=[9984,9986,9985,9987],Me=[0,6409,6410,6407,6408],Se={};Se[6409]=Se[6406]=Se[6402]=1,Se[34041]=Se[6410]=2,Se[6407]=Se[35904]=3,Se[6408]=Se[35906]=4;var De=v("HTMLCanvasElement"),Fe=v("OffscreenCanvas"),Ye=v("CanvasRenderingContext2D"),et=v("ImageBitmap"),Oe=v("HTMLImageElement"),je=v("HTMLVideoElement"),We=Object.keys(de).concat([De,Fe,Ye,et,Oe,je]),Ge=[];Ge[5121]=1,Ge[5126]=4,Ge[36193]=2,Ge[5123]=2,Ge[5125]=4;var Qe=[];Qe[32854]=2,Qe[32855]=2,Qe[36194]=2,Qe[34041]=4,Qe[33776]=.5,Qe[33777]=.5,Qe[33778]=1,Qe[33779]=1,Qe[35986]=.5,Qe[35987]=1,Qe[34798]=1,Qe[35840]=.5,Qe[35841]=.25,Qe[35842]=.5,Qe[35843]=.25,Qe[36196]=.5;var it=[];it[32854]=2,it[32855]=2,it[36194]=2,it[33189]=2,it[36168]=1,it[34041]=4,it[35907]=4,it[34836]=16,it[34842]=8,it[34843]=6;var lt=function(Be,Je,_e,Le,Ce){function Pe(mt){this.id=ft++,this.refCount=1,this.renderbuffer=mt,this.format=32854,this.height=this.width=0,Ce.profile&&(this.stats={size:0})}function Xe(mt){var It=mt.renderbuffer;Be.bindRenderbuffer(36161,null),Be.deleteRenderbuffer(It),mt.renderbuffer=null,mt.refCount=0,delete Et[mt.id],Le.renderbufferCount--}var ut={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};Je.ext_srgb&&(ut.srgba=35907),Je.ext_color_buffer_half_float&&(ut.rgba16f=34842,ut.rgb16f=34843),Je.webgl_color_buffer_float&&(ut.rgba32f=34836);var kt=[];Object.keys(ut).forEach(function(mt){kt[ut[mt]]=mt});var ft=0,Et={};return Pe.prototype.decRef=function(){0>=--this.refCount&&Xe(this)},Ce.profile&&(Le.getTotalRenderbufferSize=function(){var mt=0;return Object.keys(Et).forEach(function(It){mt+=Et[It].stats.size}),mt}),{create:function(mt,It){function vt(At,Ft){var Nt=0,Kt=0,Ie=32854;if(typeof At=="object"&&At?("shape"in At?(Nt=0|(Kt=At.shape)[0],Kt=0|Kt[1]):("radius"in At&&(Nt=Kt=0|At.radius),"width"in At&&(Nt=0|At.width),"height"in At&&(Kt=0|At.height)),"format"in At&&(Ie=ut[At.format])):typeof At=="number"?(Nt=0|At,Kt=typeof Ft=="number"?0|Ft:Nt):At||(Nt=Kt=1),Nt!==nt.width||Kt!==nt.height||Ie!==nt.format)return vt.width=nt.width=Nt,vt.height=nt.height=Kt,nt.format=Ie,Be.bindRenderbuffer(36161,nt.renderbuffer),Be.renderbufferStorage(36161,Ie,Nt,Kt),Ce.profile&&(nt.stats.size=it[nt.format]*nt.width*nt.height),vt.format=kt[nt.format],vt}var nt=new Pe(Be.createRenderbuffer());return Et[nt.id]=nt,Le.renderbufferCount++,vt(mt,It),vt.resize=function(At,Ft){var Nt=0|At,Kt=0|Ft||Nt;return Nt===nt.width&&Kt===nt.height||(vt.width=nt.width=Nt,vt.height=nt.height=Kt,Be.bindRenderbuffer(36161,nt.renderbuffer),Be.renderbufferStorage(36161,nt.format,Nt,Kt),Ce.profile&&(nt.stats.size=it[nt.format]*nt.width*nt.height)),vt},vt._reglType="renderbuffer",vt._renderbuffer=nt,Ce.profile&&(vt.stats=nt.stats),vt.destroy=function(){nt.decRef()},vt},clear:function(){he(Et).forEach(Xe)},restore:function(){he(Et).forEach(function(mt){mt.renderbuffer=Be.createRenderbuffer(),Be.bindRenderbuffer(36161,mt.renderbuffer),Be.renderbufferStorage(36161,mt.format,mt.width,mt.height)}),Be.bindRenderbuffer(36161,null)}}},Lt=[];Lt[6408]=4,Lt[6407]=3;var wt=[];wt[5121]=1,wt[5126]=4,wt[36193]=2;var rt=["x","y","z","w"],$e="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),xt={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Qt={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},$t={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Ue={cw:2304,ccw:2305},He=new Q(!1,!1,!1,function(){});return function(Be){function Je(){if(Br.length===0)Ie&&Ie.update(),Pn=null;else{Pn=J.next(Je),Et();for(var rn=Br.length-1;0<=rn;--rn){var Fr=Br[rn];Fr&&Fr(Vt,null,0)}vt.flush(),Ie&&Ie.update()}}function _e(){!Pn&&0<Br.length&&(Pn=J.next(Je))}function Le(){Pn&&(J.cancel(Je),Pn=null)}function Ce(rn){rn.preventDefault(),Le(),Jr.forEach(function(Fr){Fr()})}function Pe(rn){vt.getError(),At.restore(),hr.restore(),Yt.restore(),mr.restore(),sr.restore(),fr.restore(),ar.restore(),Ie&&Ie.restore(),yr.procs.refresh(),_e(),fn.forEach(function(Fr){Fr()})}function Xe(rn){function Fr(Ct,Ht){var cr={},_r={};return Object.keys(Ct).forEach(function(Vr){var jr=Ct[Vr];if(ee.isDynamic(jr))_r[Vr]=ee.unbox(jr,Vr);else{if(Ht&&Array.isArray(jr)){for(var vr=0;vr<jr.length;++vr)if(ee.isDynamic(jr[vr]))return void(_r[Vr]=ee.unbox(jr,Vr))}cr[Vr]=jr}}),{dynamic:_r,static:cr}}var Lr=Fr(rn.context||{},!0),Qr=Fr(rn.uniforms||{},!0),$r=Fr(rn.attributes||{},!1);rn=Fr(function(Ct){function Ht(_r){if(_r in cr){var Vr=cr[_r];delete cr[_r],Object.keys(Vr).forEach(function(jr){cr[_r+"."+jr]=Vr[jr]})}}var cr=B({},Ct);return delete cr.uniforms,delete cr.attributes,delete cr.context,delete cr.vao,"stencil"in cr&&cr.stencil.op&&(cr.stencil.opBack=cr.stencil.opFront=cr.stencil.op,delete cr.stencil.op),Ht("blend"),Ht("depth"),Ht("cull"),Ht("stencil"),Ht("polygonOffset"),Ht("scissor"),Ht("sample"),"vao"in Ct&&(cr.vao=Ct.vao),cr}(rn),!1);var Kr={gpuTime:0,cpuTime:0,count:0},en=yr.compile(rn,$r,Qr,Lr,Kr),Tn=en.draw,Mn=en.batch,Rn=en.scope,Zt=[];return B(function(Ct,Ht){var cr;if(typeof Ct=="function")return Rn.call(this,null,Ct,0);if(typeof Ht=="function")if(typeof Ct=="number")for(cr=0;cr<Ct;++cr)Rn.call(this,null,Ht,cr);else{if(!Array.isArray(Ct))return Rn.call(this,Ct,Ht,0);for(cr=0;cr<Ct.length;++cr)Rn.call(this,Ct[cr],Ht,cr)}else if(typeof Ct=="number"){if(0<Ct)return Mn.call(this,function(_r){for(;Zt.length<_r;)Zt.push(null);return Zt}(0|Ct),0|Ct)}else{if(!Array.isArray(Ct))return Tn.call(this,Ct);if(Ct.length)return Mn.call(this,Ct,Ct.length)}},{stats:Kr,destroy:function(){en.destroy()}})}function ut(rn,Fr){var Lr=0;yr.procs.poll();var Qr=Fr.color;Qr&&(vt.clearColor(+Qr[0]||0,+Qr[1]||0,+Qr[2]||0,+Qr[3]||0),Lr|=16384),"depth"in Fr&&(vt.clearDepth(+Fr.depth),Lr|=256),"stencil"in Fr&&(vt.clearStencil(0|Fr.stencil),Lr|=1024),vt.clear(Lr)}function kt(rn){return Br.push(rn),_e(),{cancel:function(){var Fr=D(Br,rn);Br[Fr]=function Lr(){var Qr=D(Br,Lr);Br[Qr]=Br[Br.length-1],--Br.length,0>=Br.length&&Le()}}}}function ft(){var rn=zr.viewport,Fr=zr.scissor_box;rn[0]=rn[1]=Fr[0]=Fr[1]=0,Vt.viewportWidth=Vt.framebufferWidth=Vt.drawingBufferWidth=rn[2]=Fr[2]=vt.drawingBufferWidth,Vt.viewportHeight=Vt.framebufferHeight=Vt.drawingBufferHeight=rn[3]=Fr[3]=vt.drawingBufferHeight}function Et(){Vt.tick+=1,Vt.time=It(),ft(),yr.procs.poll()}function mt(){mr.refresh(),ft(),yr.procs.refresh(),Ie&&Ie.update()}function It(){return($()-ot)/1e3}if(!(Be=e(Be)))return null;var vt=Be.gl,nt=vt.getContextAttributes();vt.isContextLost();var At=function(rn,Fr){function Lr(en){var Tn;en=en.toLowerCase();try{Tn=Qr[en]=rn.getExtension(en)}catch(Mn){}return!!Tn}for(var Qr={},$r=0;$r<Fr.extensions.length;++$r){var Kr=Fr.extensions[$r];if(!Lr(Kr))return Fr.onDestroy(),Fr.onDone('"'+Kr+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return Fr.optionalExtensions.forEach(Lr),{extensions:Qr,restore:function(){Object.keys(Qr).forEach(function(en){if(Qr[en]&&!Lr(en))throw Error("(regl): error restoring extension "+en)})}}}(vt,Be);if(!At)return null;var Ft=function(){var rn={"":0},Fr=[""];return{id:function(Lr){var Qr=rn[Lr];return Qr||(Qr=rn[Lr]=Fr.length,Fr.push(Lr),Qr)},str:function(Lr){return Fr[Lr]}}}(),Nt={vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},Kt=At.extensions,Ie=function(rn,Fr){function Lr(){this.endQueryIndex=this.startQueryIndex=-1,this.sum=0,this.stats=null}function Qr(Zt,Ct,Ht){var cr=en.pop()||new Lr;cr.startQueryIndex=Zt,cr.endQueryIndex=Ct,cr.sum=0,cr.stats=Ht,Tn.push(cr)}if(!Fr.ext_disjoint_timer_query)return null;var $r=[],Kr=[],en=[],Tn=[],Mn=[],Rn=[];return{beginQuery:function(Zt){var Ct=$r.pop()||Fr.ext_disjoint_timer_query.createQueryEXT();Fr.ext_disjoint_timer_query.beginQueryEXT(35007,Ct),Kr.push(Ct),Qr(Kr.length-1,Kr.length,Zt)},endQuery:function(){Fr.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:Qr,update:function(){var Zt,Ct;if((Zt=Kr.length)!==0){Rn.length=Math.max(Rn.length,Zt+1),Mn.length=Math.max(Mn.length,Zt+1),Mn[0]=0;var Ht=Rn[0]=0;for(Ct=Zt=0;Ct<Kr.length;++Ct){var cr=Kr[Ct];Fr.ext_disjoint_timer_query.getQueryObjectEXT(cr,34919)?(Ht+=Fr.ext_disjoint_timer_query.getQueryObjectEXT(cr,34918),$r.push(cr)):Kr[Zt++]=cr,Mn[Ct+1]=Ht,Rn[Ct+1]=Zt}for(Kr.length=Zt,Ct=Zt=0;Ct<Tn.length;++Ct){var _r=(Ht=Tn[Ct]).startQueryIndex;cr=Ht.endQueryIndex,Ht.sum+=Mn[cr]-Mn[_r],_r=Rn[_r],(cr=Rn[cr])===_r?(Ht.stats.gpuTime+=Ht.sum/1e6,en.push(Ht)):(Ht.startQueryIndex=_r,Ht.endQueryIndex=cr,Tn[Zt++]=Ht)}Tn.length=Zt}},getNumPendingQueries:function(){return Kr.length},clear:function(){$r.push.apply($r,Kr);for(var Zt=0;Zt<$r.length;Zt++)Fr.ext_disjoint_timer_query.deleteQueryEXT($r[Zt]);Kr.length=0,$r.length=0},restore:function(){Kr.length=0,$r.length=0}}}(0,Kt),ot=$(),bt=vt.drawingBufferWidth,Pt=vt.drawingBufferHeight,Vt={tick:0,time:0,viewportWidth:bt,viewportHeight:Pt,framebufferWidth:bt,framebufferHeight:Pt,drawingBufferWidth:bt,drawingBufferHeight:Pt,pixelRatio:Be.pixelRatio},nr=(bt={elements:null,primitive:4,count:-1,offset:0,instances:-1},ie(vt,Kt)),Yt=n(vt,Nt,Be,function(rn){return ar.destroyBuffer(rn)}),Xt=d(vt,Kt,Yt,Nt),ar=M(vt,Kt,nr,Nt,Yt,Xt,bt),hr=P(vt,Ft,Nt,Be),mr=L(vt,Kt,nr,function(){yr.procs.poll()},Vt,Nt,Be),sr=lt(vt,Kt,0,Nt,Be),fr=k(vt,Kt,nr,mr,sr,Nt),yr=K(vt,Ft,Kt,nr,Yt,Xt,0,fr,{},ar,hr,bt,Vt,Ie,Be),zr=(Ft=O(vt,fr,yr.procs.poll,Vt),yr.next),xr=vt.canvas,Br=[],Jr=[],fn=[],Cn=[Be.onDestroy],Pn=null;xr&&(xr.addEventListener("webglcontextlost",Ce,!1),xr.addEventListener("webglcontextrestored",Pe,!1));var An=fr.setFBO=Xe({framebuffer:ee.define.call(null,1,"framebuffer")});return mt(),nt=B(Xe,{clear:function(rn){if("framebuffer"in rn)if(rn.framebuffer&&rn.framebuffer_reglType==="framebufferCube")for(var Fr=0;6>Fr;++Fr)An(B({framebuffer:rn.framebuffer.faces[Fr]},rn),ut);else An(rn,ut);else ut(0,rn)},prop:ee.define.bind(null,1),context:ee.define.bind(null,2),this:ee.define.bind(null,3),draw:Xe({}),buffer:function(rn){return Yt.create(rn,34962,!1,!1)},elements:function(rn){return Xt.create(rn,!1)},texture:mr.create2D,cube:mr.createCube,renderbuffer:sr.create,framebuffer:fr.create,framebufferCube:fr.createCube,vao:ar.createVAO,attributes:nt,frame:kt,on:function(rn,Fr){var Lr;switch(rn){case"frame":return kt(Fr);case"lost":Lr=Jr;break;case"restore":Lr=fn;break;case"destroy":Lr=Cn}return Lr.push(Fr),{cancel:function(){for(var Qr=0;Qr<Lr.length;++Qr)if(Lr[Qr]===Fr){Lr[Qr]=Lr[Lr.length-1],Lr.pop();break}}}},limits:nr,hasExtension:function(rn){return 0<=nr.extensions.indexOf(rn.toLowerCase())},read:Ft,destroy:function(){Br.length=0,Le(),xr&&(xr.removeEventListener("webglcontextlost",Ce),xr.removeEventListener("webglcontextrestored",Pe)),hr.clear(),fr.clear(),sr.clear(),ar.clear(),mr.clear(),Xt.clear(),Yt.clear(),Ie&&Ie.clear(),Cn.forEach(function(rn){rn()})},_gl:vt,_refresh:mt,poll:function(){Et(),Ie&&Ie.update()},now:It,stats:Nt}),Be.onDone(null,nt),nt}})},{}],527:[function(h,N,H){var t,m="";N.exports=function(g,p){if(typeof g!="string")throw new TypeError("expected a string");if(p===1)return g;if(p===2)return g+g;var e=g.length*p;if(t!==g||t===void 0)t=g,m="";else if(m.length>=e)return m.substr(0,e);for(;e>m.length&&p>1;)1&p&&(m+=g),p>>=1,g+=g;return m=(m+=g).substr(0,e)}},{}],528:[function(h,N,H){(function(t){(function(){N.exports=t.performance&&t.performance.now?function(){return performance.now()}:Date.now||function(){return+new Date}}).call(this)}).call(this,typeof La!="undefined"?La:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],529:[function(h,N,H){N.exports=function(t){for(var m=t.length,g=t[t.length-1],p=m,e=m-2;e>=0;--e){var f=g,u=t[e];(s=u-((g=f+u)-f))&&(t[--p]=g,g=s)}var i=0;for(e=p;e<m;++e){var s;f=t[e],(s=(u=g)-((g=f+u)-f))&&(t[i++]=s)}return t[i++]=g,t.length=i,t}},{}],530:[function(h,N,H){var t=h("two-product"),m=h("robust-sum"),g=h("robust-scale"),p=h("robust-compress");function e(o,a,c,r){return function(n){return r(o(c(n[0][0],n[1][1]),c(-n[0][1],n[1][0])))}}function f(o,a,c,r){return function(n){return r(o(a(o(c(n[1][1],n[2][2]),c(-n[1][2],n[2][1])),n[0][0]),o(a(o(c(n[1][0],n[2][2]),c(-n[1][2],n[2][0])),-n[0][1]),a(o(c(n[1][0],n[2][1]),c(-n[1][1],n[2][0])),n[0][2]))))}}function u(o){return(o===2?e:o===3?f:void 0)(m,g,t,p)}var i=[function(){return[0]},function(o){return[o[0][0]]}];function s(o,a,c,r,n,d){return function(l){switch(l.length){case 0:return o(l);case 1:return a(l);case 2:return c(l);case 3:return r(l)}var y=n[l.length];return y||(y=n[l.length]=d(l.length)),y(l)}}(function(){for(;i.length<4;)i.push(u(i.length));N.exports=s.apply(void 0,i.concat([i,u]));for(var o=0;o<i.length;++o)N.exports[o]=i[o]})()},{"robust-compress":529,"robust-scale":536,"robust-sum":539,"two-product":588}],531:[function(h,N,H){var t=h("two-product"),m=h("robust-sum");N.exports=function(g,p){for(var e=t(g[0],p[0]),f=1;f<g.length;++f)e=m(e,t(g[f],p[f]));return e}},{"robust-sum":539,"two-product":588}],532:[function(h,N,H){var t=h("two-product"),m=h("robust-sum"),g=h("robust-subtract"),p=h("robust-scale");function e(r){return(r===3?f:r===4?u:r===5?i:s)(m,g,t,p)}function f(r,n,d,l){return function(y,v,_){var x=d(y[0],y[0]),T=l(x,v[0]),A=l(x,_[0]),S=d(v[0],v[0]),w=l(S,y[0]),L=l(S,_[0]),k=d(_[0],_[0]),C=l(k,y[0]),M=l(k,v[0]),P=r(n(M,L),n(w,T)),O=n(C,A),F=n(P,O);return F[F.length-1]}}function u(r,n,d,l){return function(y,v,_,x){var T=r(d(y[0],y[0]),d(y[1],y[1])),A=l(T,v[0]),S=l(T,_[0]),w=l(T,x[0]),L=r(d(v[0],v[0]),d(v[1],v[1])),k=l(L,y[0]),C=l(L,_[0]),M=l(L,x[0]),P=r(d(_[0],_[0]),d(_[1],_[1])),O=l(P,y[0]),F=l(P,v[0]),j=l(P,x[0]),W=r(d(x[0],x[0]),d(x[1],x[1])),Z=l(W,y[0]),Q=l(W,v[0]),X=l(W,_[0]),G=r(r(l(n(X,j),v[1]),r(l(n(Q,M),-_[1]),l(n(F,C),x[1]))),r(l(n(Q,M),y[1]),r(l(n(Z,w),-v[1]),l(n(k,A),x[1])))),Y=r(r(l(n(X,j),y[1]),r(l(n(Z,w),-_[1]),l(n(O,S),x[1]))),r(l(n(F,C),y[1]),r(l(n(O,S),-v[1]),l(n(k,A),_[1])))),K=n(G,Y);return K[K.length-1]}}function i(r,n,d,l){return function(y,v,_,x,T){var A=r(d(y[0],y[0]),r(d(y[1],y[1]),d(y[2],y[2]))),S=l(A,v[0]),w=l(A,_[0]),L=l(A,x[0]),k=l(A,T[0]),C=r(d(v[0],v[0]),r(d(v[1],v[1]),d(v[2],v[2]))),M=l(C,y[0]),P=l(C,_[0]),O=l(C,x[0]),F=l(C,T[0]),j=r(d(_[0],_[0]),r(d(_[1],_[1]),d(_[2],_[2]))),W=l(j,y[0]),Z=l(j,v[0]),Q=l(j,x[0]),X=l(j,T[0]),G=r(d(x[0],x[0]),r(d(x[1],x[1]),d(x[2],x[2]))),Y=l(G,y[0]),K=l(G,v[0]),D=l(G,_[0]),B=l(G,T[0]),q=r(d(T[0],T[0]),r(d(T[1],T[1]),d(T[2],T[2]))),ee=l(q,y[0]),J=l(q,v[0]),$=l(q,_[0]),te=l(q,x[0]),ie=r(r(r(l(r(l(n(te,B),_[1]),r(l(n($,X),-x[1]),l(n(D,Q),T[1]))),v[2]),r(l(r(l(n(te,B),v[1]),r(l(n(J,F),-x[1]),l(n(K,O),T[1]))),-_[2]),l(r(l(n($,X),v[1]),r(l(n(J,F),-_[1]),l(n(Z,P),T[1]))),x[2]))),r(l(r(l(n(D,Q),v[1]),r(l(n(K,O),-_[1]),l(n(Z,P),x[1]))),-T[2]),r(l(r(l(n(te,B),v[1]),r(l(n(J,F),-x[1]),l(n(K,O),T[1]))),y[2]),l(r(l(n(te,B),y[1]),r(l(n(ee,k),-x[1]),l(n(Y,L),T[1]))),-v[2])))),r(r(l(r(l(n(J,F),y[1]),r(l(n(ee,k),-v[1]),l(n(M,S),T[1]))),x[2]),r(l(r(l(n(K,O),y[1]),r(l(n(Y,L),-v[1]),l(n(M,S),x[1]))),-T[2]),l(r(l(n(D,Q),v[1]),r(l(n(K,O),-_[1]),l(n(Z,P),x[1]))),y[2]))),r(l(r(l(n(D,Q),y[1]),r(l(n(Y,L),-_[1]),l(n(W,w),x[1]))),-v[2]),r(l(r(l(n(K,O),y[1]),r(l(n(Y,L),-v[1]),l(n(M,S),x[1]))),_[2]),l(r(l(n(Z,P),y[1]),r(l(n(W,w),-v[1]),l(n(M,S),_[1]))),-x[2]))))),ae=r(r(r(l(r(l(n(te,B),_[1]),r(l(n($,X),-x[1]),l(n(D,Q),T[1]))),y[2]),l(r(l(n(te,B),y[1]),r(l(n(ee,k),-x[1]),l(n(Y,L),T[1]))),-_[2])),r(l(r(l(n($,X),y[1]),r(l(n(ee,k),-_[1]),l(n(W,w),T[1]))),x[2]),l(r(l(n(D,Q),y[1]),r(l(n(Y,L),-_[1]),l(n(W,w),x[1]))),-T[2]))),r(r(l(r(l(n($,X),v[1]),r(l(n(J,F),-_[1]),l(n(Z,P),T[1]))),y[2]),l(r(l(n($,X),y[1]),r(l(n(ee,k),-_[1]),l(n(W,w),T[1]))),-v[2])),r(l(r(l(n(J,F),y[1]),r(l(n(ee,k),-v[1]),l(n(M,S),T[1]))),_[2]),l(r(l(n(Z,P),y[1]),r(l(n(W,w),-v[1]),l(n(M,S),_[1]))),-T[2])))),he=n(ie,ae);return he[he.length-1]}}function s(r,n,d,l){return function(y,v,_,x,T,A){var S=r(r(d(y[0],y[0]),d(y[1],y[1])),r(d(y[2],y[2]),d(y[3],y[3]))),w=l(S,v[0]),L=l(S,_[0]),k=l(S,x[0]),C=l(S,T[0]),M=l(S,A[0]),P=r(r(d(v[0],v[0]),d(v[1],v[1])),r(d(v[2],v[2]),d(v[3],v[3]))),O=l(P,y[0]),F=l(P,_[0]),j=l(P,x[0]),W=l(P,T[0]),Z=l(P,A[0]),Q=r(r(d(_[0],_[0]),d(_[1],_[1])),r(d(_[2],_[2]),d(_[3],_[3]))),X=l(Q,y[0]),G=l(Q,v[0]),Y=l(Q,x[0]),K=l(Q,T[0]),D=l(Q,A[0]),B=r(r(d(x[0],x[0]),d(x[1],x[1])),r(d(x[2],x[2]),d(x[3],x[3]))),q=l(B,y[0]),ee=l(B,v[0]),J=l(B,_[0]),$=l(B,T[0]),te=l(B,A[0]),ie=r(r(d(T[0],T[0]),d(T[1],T[1])),r(d(T[2],T[2]),d(T[3],T[3]))),ae=l(ie,y[0]),he=l(ie,v[0]),se=l(ie,_[0]),de=l(ie,x[0]),ce=l(ie,A[0]),ve=r(r(d(A[0],A[0]),d(A[1],A[1])),r(d(A[2],A[2]),d(A[3],A[3]))),ke=l(ve,y[0]),Ee=l(ve,v[0]),be=l(ve,_[0]),xe=l(ve,x[0]),ue=l(ve,T[0]),me=r(r(r(l(r(r(l(r(l(n(ue,ce),x[1]),r(l(n(xe,te),-T[1]),l(n(de,$),A[1]))),_[2]),l(r(l(n(ue,ce),_[1]),r(l(n(be,D),-T[1]),l(n(se,K),A[1]))),-x[2])),r(l(r(l(n(xe,te),_[1]),r(l(n(be,D),-x[1]),l(n(J,Y),A[1]))),T[2]),l(r(l(n(de,$),_[1]),r(l(n(se,K),-x[1]),l(n(J,Y),T[1]))),-A[2]))),v[3]),r(l(r(r(l(r(l(n(ue,ce),x[1]),r(l(n(xe,te),-T[1]),l(n(de,$),A[1]))),v[2]),l(r(l(n(ue,ce),v[1]),r(l(n(Ee,Z),-T[1]),l(n(he,W),A[1]))),-x[2])),r(l(r(l(n(xe,te),v[1]),r(l(n(Ee,Z),-x[1]),l(n(ee,j),A[1]))),T[2]),l(r(l(n(de,$),v[1]),r(l(n(he,W),-x[1]),l(n(ee,j),T[1]))),-A[2]))),-_[3]),l(r(r(l(r(l(n(ue,ce),_[1]),r(l(n(be,D),-T[1]),l(n(se,K),A[1]))),v[2]),l(r(l(n(ue,ce),v[1]),r(l(n(Ee,Z),-T[1]),l(n(he,W),A[1]))),-_[2])),r(l(r(l(n(be,D),v[1]),r(l(n(Ee,Z),-_[1]),l(n(G,F),A[1]))),T[2]),l(r(l(n(se,K),v[1]),r(l(n(he,W),-_[1]),l(n(G,F),T[1]))),-A[2]))),x[3]))),r(r(l(r(r(l(r(l(n(xe,te),_[1]),r(l(n(be,D),-x[1]),l(n(J,Y),A[1]))),v[2]),l(r(l(n(xe,te),v[1]),r(l(n(Ee,Z),-x[1]),l(n(ee,j),A[1]))),-_[2])),r(l(r(l(n(be,D),v[1]),r(l(n(Ee,Z),-_[1]),l(n(G,F),A[1]))),x[2]),l(r(l(n(J,Y),v[1]),r(l(n(ee,j),-_[1]),l(n(G,F),x[1]))),-A[2]))),-T[3]),l(r(r(l(r(l(n(de,$),_[1]),r(l(n(se,K),-x[1]),l(n(J,Y),T[1]))),v[2]),l(r(l(n(de,$),v[1]),r(l(n(he,W),-x[1]),l(n(ee,j),T[1]))),-_[2])),r(l(r(l(n(se,K),v[1]),r(l(n(he,W),-_[1]),l(n(G,F),T[1]))),x[2]),l(r(l(n(J,Y),v[1]),r(l(n(ee,j),-_[1]),l(n(G,F),x[1]))),-T[2]))),A[3])),r(l(r(r(l(r(l(n(ue,ce),x[1]),r(l(n(xe,te),-T[1]),l(n(de,$),A[1]))),v[2]),l(r(l(n(ue,ce),v[1]),r(l(n(Ee,Z),-T[1]),l(n(he,W),A[1]))),-x[2])),r(l(r(l(n(xe,te),v[1]),r(l(n(Ee,Z),-x[1]),l(n(ee,j),A[1]))),T[2]),l(r(l(n(de,$),v[1]),r(l(n(he,W),-x[1]),l(n(ee,j),T[1]))),-A[2]))),y[3]),l(r(r(l(r(l(n(ue,ce),x[1]),r(l(n(xe,te),-T[1]),l(n(de,$),A[1]))),y[2]),l(r(l(n(ue,ce),y[1]),r(l(n(ke,M),-T[1]),l(n(ae,C),A[1]))),-x[2])),r(l(r(l(n(xe,te),y[1]),r(l(n(ke,M),-x[1]),l(n(q,k),A[1]))),T[2]),l(r(l(n(de,$),y[1]),r(l(n(ae,C),-x[1]),l(n(q,k),T[1]))),-A[2]))),-v[3])))),r(r(r(l(r(r(l(r(l(n(ue,ce),v[1]),r(l(n(Ee,Z),-T[1]),l(n(he,W),A[1]))),y[2]),l(r(l(n(ue,ce),y[1]),r(l(n(ke,M),-T[1]),l(n(ae,C),A[1]))),-v[2])),r(l(r(l(n(Ee,Z),y[1]),r(l(n(ke,M),-v[1]),l(n(O,w),A[1]))),T[2]),l(r(l(n(he,W),y[1]),r(l(n(ae,C),-v[1]),l(n(O,w),T[1]))),-A[2]))),x[3]),l(r(r(l(r(l(n(xe,te),v[1]),r(l(n(Ee,Z),-x[1]),l(n(ee,j),A[1]))),y[2]),l(r(l(n(xe,te),y[1]),r(l(n(ke,M),-x[1]),l(n(q,k),A[1]))),-v[2])),r(l(r(l(n(Ee,Z),y[1]),r(l(n(ke,M),-v[1]),l(n(O,w),A[1]))),x[2]),l(r(l(n(ee,j),y[1]),r(l(n(q,k),-v[1]),l(n(O,w),x[1]))),-A[2]))),-T[3])),r(l(r(r(l(r(l(n(de,$),v[1]),r(l(n(he,W),-x[1]),l(n(ee,j),T[1]))),y[2]),l(r(l(n(de,$),y[1]),r(l(n(ae,C),-x[1]),l(n(q,k),T[1]))),-v[2])),r(l(r(l(n(he,W),y[1]),r(l(n(ae,C),-v[1]),l(n(O,w),T[1]))),x[2]),l(r(l(n(ee,j),y[1]),r(l(n(q,k),-v[1]),l(n(O,w),x[1]))),-T[2]))),A[3]),l(r(r(l(r(l(n(xe,te),_[1]),r(l(n(be,D),-x[1]),l(n(J,Y),A[1]))),v[2]),l(r(l(n(xe,te),v[1]),r(l(n(Ee,Z),-x[1]),l(n(ee,j),A[1]))),-_[2])),r(l(r(l(n(be,D),v[1]),r(l(n(Ee,Z),-_[1]),l(n(G,F),A[1]))),x[2]),l(r(l(n(J,Y),v[1]),r(l(n(ee,j),-_[1]),l(n(G,F),x[1]))),-A[2]))),y[3]))),r(r(l(r(r(l(r(l(n(xe,te),_[1]),r(l(n(be,D),-x[1]),l(n(J,Y),A[1]))),y[2]),l(r(l(n(xe,te),y[1]),r(l(n(ke,M),-x[1]),l(n(q,k),A[1]))),-_[2])),r(l(r(l(n(be,D),y[1]),r(l(n(ke,M),-_[1]),l(n(X,L),A[1]))),x[2]),l(r(l(n(J,Y),y[1]),r(l(n(q,k),-_[1]),l(n(X,L),x[1]))),-A[2]))),-v[3]),l(r(r(l(r(l(n(xe,te),v[1]),r(l(n(Ee,Z),-x[1]),l(n(ee,j),A[1]))),y[2]),l(r(l(n(xe,te),y[1]),r(l(n(ke,M),-x[1]),l(n(q,k),A[1]))),-v[2])),r(l(r(l(n(Ee,Z),y[1]),r(l(n(ke,M),-v[1]),l(n(O,w),A[1]))),x[2]),l(r(l(n(ee,j),y[1]),r(l(n(q,k),-v[1]),l(n(O,w),x[1]))),-A[2]))),_[3])),r(l(r(r(l(r(l(n(be,D),v[1]),r(l(n(Ee,Z),-_[1]),l(n(G,F),A[1]))),y[2]),l(r(l(n(be,D),y[1]),r(l(n(ke,M),-_[1]),l(n(X,L),A[1]))),-v[2])),r(l(r(l(n(Ee,Z),y[1]),r(l(n(ke,M),-v[1]),l(n(O,w),A[1]))),_[2]),l(r(l(n(G,F),y[1]),r(l(n(X,L),-v[1]),l(n(O,w),_[1]))),-A[2]))),-x[3]),l(r(r(l(r(l(n(J,Y),v[1]),r(l(n(ee,j),-_[1]),l(n(G,F),x[1]))),y[2]),l(r(l(n(J,Y),y[1]),r(l(n(q,k),-_[1]),l(n(X,L),x[1]))),-v[2])),r(l(r(l(n(ee,j),y[1]),r(l(n(q,k),-v[1]),l(n(O,w),x[1]))),_[2]),l(r(l(n(G,F),y[1]),r(l(n(X,L),-v[1]),l(n(O,w),_[1]))),-x[2]))),A[3]))))),we=r(r(r(l(r(r(l(r(l(n(ue,ce),x[1]),r(l(n(xe,te),-T[1]),l(n(de,$),A[1]))),_[2]),l(r(l(n(ue,ce),_[1]),r(l(n(be,D),-T[1]),l(n(se,K),A[1]))),-x[2])),r(l(r(l(n(xe,te),_[1]),r(l(n(be,D),-x[1]),l(n(J,Y),A[1]))),T[2]),l(r(l(n(de,$),_[1]),r(l(n(se,K),-x[1]),l(n(J,Y),T[1]))),-A[2]))),y[3]),r(l(r(r(l(r(l(n(ue,ce),x[1]),r(l(n(xe,te),-T[1]),l(n(de,$),A[1]))),y[2]),l(r(l(n(ue,ce),y[1]),r(l(n(ke,M),-T[1]),l(n(ae,C),A[1]))),-x[2])),r(l(r(l(n(xe,te),y[1]),r(l(n(ke,M),-x[1]),l(n(q,k),A[1]))),T[2]),l(r(l(n(de,$),y[1]),r(l(n(ae,C),-x[1]),l(n(q,k),T[1]))),-A[2]))),-_[3]),l(r(r(l(r(l(n(ue,ce),_[1]),r(l(n(be,D),-T[1]),l(n(se,K),A[1]))),y[2]),l(r(l(n(ue,ce),y[1]),r(l(n(ke,M),-T[1]),l(n(ae,C),A[1]))),-_[2])),r(l(r(l(n(be,D),y[1]),r(l(n(ke,M),-_[1]),l(n(X,L),A[1]))),T[2]),l(r(l(n(se,K),y[1]),r(l(n(ae,C),-_[1]),l(n(X,L),T[1]))),-A[2]))),x[3]))),r(r(l(r(r(l(r(l(n(xe,te),_[1]),r(l(n(be,D),-x[1]),l(n(J,Y),A[1]))),y[2]),l(r(l(n(xe,te),y[1]),r(l(n(ke,M),-x[1]),l(n(q,k),A[1]))),-_[2])),r(l(r(l(n(be,D),y[1]),r(l(n(ke,M),-_[1]),l(n(X,L),A[1]))),x[2]),l(r(l(n(J,Y),y[1]),r(l(n(q,k),-_[1]),l(n(X,L),x[1]))),-A[2]))),-T[3]),l(r(r(l(r(l(n(de,$),_[1]),r(l(n(se,K),-x[1]),l(n(J,Y),T[1]))),y[2]),l(r(l(n(de,$),y[1]),r(l(n(ae,C),-x[1]),l(n(q,k),T[1]))),-_[2])),r(l(r(l(n(se,K),y[1]),r(l(n(ae,C),-_[1]),l(n(X,L),T[1]))),x[2]),l(r(l(n(J,Y),y[1]),r(l(n(q,k),-_[1]),l(n(X,L),x[1]))),-T[2]))),A[3])),r(l(r(r(l(r(l(n(ue,ce),_[1]),r(l(n(be,D),-T[1]),l(n(se,K),A[1]))),v[2]),l(r(l(n(ue,ce),v[1]),r(l(n(Ee,Z),-T[1]),l(n(he,W),A[1]))),-_[2])),r(l(r(l(n(be,D),v[1]),r(l(n(Ee,Z),-_[1]),l(n(G,F),A[1]))),T[2]),l(r(l(n(se,K),v[1]),r(l(n(he,W),-_[1]),l(n(G,F),T[1]))),-A[2]))),y[3]),l(r(r(l(r(l(n(ue,ce),_[1]),r(l(n(be,D),-T[1]),l(n(se,K),A[1]))),y[2]),l(r(l(n(ue,ce),y[1]),r(l(n(ke,M),-T[1]),l(n(ae,C),A[1]))),-_[2])),r(l(r(l(n(be,D),y[1]),r(l(n(ke,M),-_[1]),l(n(X,L),A[1]))),T[2]),l(r(l(n(se,K),y[1]),r(l(n(ae,C),-_[1]),l(n(X,L),T[1]))),-A[2]))),-v[3])))),r(r(r(l(r(r(l(r(l(n(ue,ce),v[1]),r(l(n(Ee,Z),-T[1]),l(n(he,W),A[1]))),y[2]),l(r(l(n(ue,ce),y[1]),r(l(n(ke,M),-T[1]),l(n(ae,C),A[1]))),-v[2])),r(l(r(l(n(Ee,Z),y[1]),r(l(n(ke,M),-v[1]),l(n(O,w),A[1]))),T[2]),l(r(l(n(he,W),y[1]),r(l(n(ae,C),-v[1]),l(n(O,w),T[1]))),-A[2]))),_[3]),l(r(r(l(r(l(n(be,D),v[1]),r(l(n(Ee,Z),-_[1]),l(n(G,F),A[1]))),y[2]),l(r(l(n(be,D),y[1]),r(l(n(ke,M),-_[1]),l(n(X,L),A[1]))),-v[2])),r(l(r(l(n(Ee,Z),y[1]),r(l(n(ke,M),-v[1]),l(n(O,w),A[1]))),_[2]),l(r(l(n(G,F),y[1]),r(l(n(X,L),-v[1]),l(n(O,w),_[1]))),-A[2]))),-T[3])),r(l(r(r(l(r(l(n(se,K),v[1]),r(l(n(he,W),-_[1]),l(n(G,F),T[1]))),y[2]),l(r(l(n(se,K),y[1]),r(l(n(ae,C),-_[1]),l(n(X,L),T[1]))),-v[2])),r(l(r(l(n(he,W),y[1]),r(l(n(ae,C),-v[1]),l(n(O,w),T[1]))),_[2]),l(r(l(n(G,F),y[1]),r(l(n(X,L),-v[1]),l(n(O,w),_[1]))),-T[2]))),A[3]),l(r(r(l(r(l(n(de,$),_[1]),r(l(n(se,K),-x[1]),l(n(J,Y),T[1]))),v[2]),l(r(l(n(de,$),v[1]),r(l(n(he,W),-x[1]),l(n(ee,j),T[1]))),-_[2])),r(l(r(l(n(se,K),v[1]),r(l(n(he,W),-_[1]),l(n(G,F),T[1]))),x[2]),l(r(l(n(J,Y),v[1]),r(l(n(ee,j),-_[1]),l(n(G,F),x[1]))),-T[2]))),y[3]))),r(r(l(r(r(l(r(l(n(de,$),_[1]),r(l(n(se,K),-x[1]),l(n(J,Y),T[1]))),y[2]),l(r(l(n(de,$),y[1]),r(l(n(ae,C),-x[1]),l(n(q,k),T[1]))),-_[2])),r(l(r(l(n(se,K),y[1]),r(l(n(ae,C),-_[1]),l(n(X,L),T[1]))),x[2]),l(r(l(n(J,Y),y[1]),r(l(n(q,k),-_[1]),l(n(X,L),x[1]))),-T[2]))),-v[3]),l(r(r(l(r(l(n(de,$),v[1]),r(l(n(he,W),-x[1]),l(n(ee,j),T[1]))),y[2]),l(r(l(n(de,$),y[1]),r(l(n(ae,C),-x[1]),l(n(q,k),T[1]))),-v[2])),r(l(r(l(n(he,W),y[1]),r(l(n(ae,C),-v[1]),l(n(O,w),T[1]))),x[2]),l(r(l(n(ee,j),y[1]),r(l(n(q,k),-v[1]),l(n(O,w),x[1]))),-T[2]))),_[3])),r(l(r(r(l(r(l(n(se,K),v[1]),r(l(n(he,W),-_[1]),l(n(G,F),T[1]))),y[2]),l(r(l(n(se,K),y[1]),r(l(n(ae,C),-_[1]),l(n(X,L),T[1]))),-v[2])),r(l(r(l(n(he,W),y[1]),r(l(n(ae,C),-v[1]),l(n(O,w),T[1]))),_[2]),l(r(l(n(G,F),y[1]),r(l(n(X,L),-v[1]),l(n(O,w),_[1]))),-T[2]))),-x[3]),l(r(r(l(r(l(n(J,Y),v[1]),r(l(n(ee,j),-_[1]),l(n(G,F),x[1]))),y[2]),l(r(l(n(J,Y),y[1]),r(l(n(q,k),-_[1]),l(n(X,L),x[1]))),-v[2])),r(l(r(l(n(ee,j),y[1]),r(l(n(q,k),-v[1]),l(n(O,w),x[1]))),_[2]),l(r(l(n(G,F),y[1]),r(l(n(X,L),-v[1]),l(n(O,w),_[1]))),-x[2]))),T[3]))))),Me=n(me,we);return Me[Me.length-1]}}var o=[function(){return 0},function(){return 0},function(){return 0}];function a(r){var n=o[r.length];return n||(n=o[r.length]=e(r.length)),n.apply(void 0,r)}function c(r,n,d,l,y,v,_,x){return function(T,A,S,w,L,k){switch(arguments.length){case 0:case 1:return 0;case 2:return l(T,A);case 3:return y(T,A,S);case 4:return v(T,A,S,w);case 5:return _(T,A,S,w,L);case 6:return x(T,A,S,w,L,k)}for(var C=new Array(arguments.length),M=0;M<arguments.length;++M)C[M]=arguments[M];return r(C)}}(function(){for(;o.length<=6;)o.push(e(o.length));N.exports=c.apply(void 0,[a].concat(o));for(var r=0;r<=6;++r)N.exports[r]=o[r]})()},{"robust-scale":536,"robust-subtract":538,"robust-sum":539,"two-product":588}],533:[function(h,N,H){var t=h("robust-determinant");function m(u){var i=u===2?g:p;return i(u<3?t[u]:t)}function g(u){return function(i,s){return[u([[+s[0],+i[0][1]],[+s[1],+i[1][1]]]),u([[+i[0][0],+s[0]],[+i[1][0],+s[1]]]),u(i)]}}function p(u){return function(i,s){return[u([[+s[0],+i[0][1],+i[0][2]],[+s[1],+i[1][1],+i[1][2]],[+s[2],+i[2][1],+i[2][2]]]),u([[+i[0][0],+s[0],+i[0][2]],[+i[1][0],+s[1],+i[1][2]],[+i[2][0],+s[2],+i[2][2]]]),u([[+i[0][0],+i[0][1],+s[0]],[+i[1][0],+i[1][1],+s[1]],[+i[2][0],+i[2][1],+s[2]]]),u(i)]}}var e=[function(){return[[0]]},function(u,i){return[[i[0]],[u[0][0]]]}];function f(u,i,s,o,a,c){return function(r,n){switch(r.length){case 0:return u(r,n);case 1:return i(r,n);case 2:return s(r,n);case 3:return o(r,n)}var d=a[r.length];return d||(d=a[r.length]=c(r.length)),d(r,n)}}(function(){for(;e.length<=3;)e.push(m(e.length));N.exports=f.apply(void 0,e.concat([e,m]));for(var u=0;u<3;++u)N.exports[u]=e[u]})()},{"robust-determinant":530}],534:[function(h,N,H){var t=h("two-product"),m=h("robust-sum"),g=h("robust-scale"),p=h("robust-subtract");function e(n,d,l,y){return function(v,_,x){var T=n(n(d(_[1],x[0]),d(-x[1],_[0])),n(d(v[1],_[0]),d(-_[1],v[0]))),A=n(d(v[1],x[0]),d(-x[1],v[0])),S=y(T,A);return S[S.length-1]}}function f(n,d,l,y){return function(v,_,x,T){var A=n(n(l(n(d(x[1],T[0]),d(-T[1],x[0])),_[2]),n(l(n(d(_[1],T[0]),d(-T[1],_[0])),-x[2]),l(n(d(_[1],x[0]),d(-x[1],_[0])),T[2]))),n(l(n(d(_[1],T[0]),d(-T[1],_[0])),v[2]),n(l(n(d(v[1],T[0]),d(-T[1],v[0])),-_[2]),l(n(d(v[1],_[0]),d(-_[1],v[0])),T[2])))),S=n(n(l(n(d(x[1],T[0]),d(-T[1],x[0])),v[2]),n(l(n(d(v[1],T[0]),d(-T[1],v[0])),-x[2]),l(n(d(v[1],x[0]),d(-x[1],v[0])),T[2]))),n(l(n(d(_[1],x[0]),d(-x[1],_[0])),v[2]),n(l(n(d(v[1],x[0]),d(-x[1],v[0])),-_[2]),l(n(d(v[1],_[0]),d(-_[1],v[0])),x[2])))),w=y(A,S);return w[w.length-1]}}function u(n,d,l,y){return function(v,_,x,T,A){var S=n(n(n(l(n(l(n(d(T[1],A[0]),d(-A[1],T[0])),x[2]),n(l(n(d(x[1],A[0]),d(-A[1],x[0])),-T[2]),l(n(d(x[1],T[0]),d(-T[1],x[0])),A[2]))),_[3]),n(l(n(l(n(d(T[1],A[0]),d(-A[1],T[0])),_[2]),n(l(n(d(_[1],A[0]),d(-A[1],_[0])),-T[2]),l(n(d(_[1],T[0]),d(-T[1],_[0])),A[2]))),-x[3]),l(n(l(n(d(x[1],A[0]),d(-A[1],x[0])),_[2]),n(l(n(d(_[1],A[0]),d(-A[1],_[0])),-x[2]),l(n(d(_[1],x[0]),d(-x[1],_[0])),A[2]))),T[3]))),n(l(n(l(n(d(x[1],T[0]),d(-T[1],x[0])),_[2]),n(l(n(d(_[1],T[0]),d(-T[1],_[0])),-x[2]),l(n(d(_[1],x[0]),d(-x[1],_[0])),T[2]))),-A[3]),n(l(n(l(n(d(T[1],A[0]),d(-A[1],T[0])),_[2]),n(l(n(d(_[1],A[0]),d(-A[1],_[0])),-T[2]),l(n(d(_[1],T[0]),d(-T[1],_[0])),A[2]))),v[3]),l(n(l(n(d(T[1],A[0]),d(-A[1],T[0])),v[2]),n(l(n(d(v[1],A[0]),d(-A[1],v[0])),-T[2]),l(n(d(v[1],T[0]),d(-T[1],v[0])),A[2]))),-_[3])))),n(n(l(n(l(n(d(_[1],A[0]),d(-A[1],_[0])),v[2]),n(l(n(d(v[1],A[0]),d(-A[1],v[0])),-_[2]),l(n(d(v[1],_[0]),d(-_[1],v[0])),A[2]))),T[3]),n(l(n(l(n(d(_[1],T[0]),d(-T[1],_[0])),v[2]),n(l(n(d(v[1],T[0]),d(-T[1],v[0])),-_[2]),l(n(d(v[1],_[0]),d(-_[1],v[0])),T[2]))),-A[3]),l(n(l(n(d(x[1],T[0]),d(-T[1],x[0])),_[2]),n(l(n(d(_[1],T[0]),d(-T[1],_[0])),-x[2]),l(n(d(_[1],x[0]),d(-x[1],_[0])),T[2]))),v[3]))),n(l(n(l(n(d(x[1],T[0]),d(-T[1],x[0])),v[2]),n(l(n(d(v[1],T[0]),d(-T[1],v[0])),-x[2]),l(n(d(v[1],x[0]),d(-x[1],v[0])),T[2]))),-_[3]),n(l(n(l(n(d(_[1],T[0]),d(-T[1],_[0])),v[2]),n(l(n(d(v[1],T[0]),d(-T[1],v[0])),-_[2]),l(n(d(v[1],_[0]),d(-_[1],v[0])),T[2]))),x[3]),l(n(l(n(d(_[1],x[0]),d(-x[1],_[0])),v[2]),n(l(n(d(v[1],x[0]),d(-x[1],v[0])),-_[2]),l(n(d(v[1],_[0]),d(-_[1],v[0])),x[2]))),-T[3]))))),w=n(n(n(l(n(l(n(d(T[1],A[0]),d(-A[1],T[0])),x[2]),n(l(n(d(x[1],A[0]),d(-A[1],x[0])),-T[2]),l(n(d(x[1],T[0]),d(-T[1],x[0])),A[2]))),v[3]),l(n(l(n(d(T[1],A[0]),d(-A[1],T[0])),v[2]),n(l(n(d(v[1],A[0]),d(-A[1],v[0])),-T[2]),l(n(d(v[1],T[0]),d(-T[1],v[0])),A[2]))),-x[3])),n(l(n(l(n(d(x[1],A[0]),d(-A[1],x[0])),v[2]),n(l(n(d(v[1],A[0]),d(-A[1],v[0])),-x[2]),l(n(d(v[1],x[0]),d(-x[1],v[0])),A[2]))),T[3]),l(n(l(n(d(x[1],T[0]),d(-T[1],x[0])),v[2]),n(l(n(d(v[1],T[0]),d(-T[1],v[0])),-x[2]),l(n(d(v[1],x[0]),d(-x[1],v[0])),T[2]))),-A[3]))),n(n(l(n(l(n(d(x[1],A[0]),d(-A[1],x[0])),_[2]),n(l(n(d(_[1],A[0]),d(-A[1],_[0])),-x[2]),l(n(d(_[1],x[0]),d(-x[1],_[0])),A[2]))),v[3]),l(n(l(n(d(x[1],A[0]),d(-A[1],x[0])),v[2]),n(l(n(d(v[1],A[0]),d(-A[1],v[0])),-x[2]),l(n(d(v[1],x[0]),d(-x[1],v[0])),A[2]))),-_[3])),n(l(n(l(n(d(_[1],A[0]),d(-A[1],_[0])),v[2]),n(l(n(d(v[1],A[0]),d(-A[1],v[0])),-_[2]),l(n(d(v[1],_[0]),d(-_[1],v[0])),A[2]))),x[3]),l(n(l(n(d(_[1],x[0]),d(-x[1],_[0])),v[2]),n(l(n(d(v[1],x[0]),d(-x[1],v[0])),-_[2]),l(n(d(v[1],_[0]),d(-_[1],v[0])),x[2]))),-A[3])))),L=y(S,w);return L[L.length-1]}}function i(n){return(n===3?e:n===4?f:u)(m,t,g,p)}var s=i(3),o=i(4),a=[function(){return 0},function(){return 0},function(n,d){return d[0]-n[0]},function(n,d,l){var y,v=(n[1]-l[1])*(d[0]-l[0]),_=(n[0]-l[0])*(d[1]-l[1]),x=v-_;if(v>0){if(_<=0)return x;y=v+_}else{if(!(v<0)||_>=0)return x;y=-(v+_)}var T=33306690738754716e-32*y;return x>=T||x<=-T?x:s(n,d,l)},function(n,d,l,y){var v=n[0]-y[0],_=d[0]-y[0],x=l[0]-y[0],T=n[1]-y[1],A=d[1]-y[1],S=l[1]-y[1],w=n[2]-y[2],L=d[2]-y[2],k=l[2]-y[2],C=_*S,M=x*A,P=x*T,O=v*S,F=v*A,j=_*T,W=w*(C-M)+L*(P-O)+k*(F-j),Z=7771561172376103e-31*((Math.abs(C)+Math.abs(M))*Math.abs(w)+(Math.abs(P)+Math.abs(O))*Math.abs(L)+(Math.abs(F)+Math.abs(j))*Math.abs(k));return W>Z||-W>Z?W:o(n,d,l,y)}];function c(n){var d=a[n.length];return d||(d=a[n.length]=i(n.length)),d.apply(void 0,n)}function r(n,d,l,y,v,_,x){return function(T,A,S,w,L){switch(arguments.length){case 0:case 1:return 0;case 2:return y(T,A);case 3:return v(T,A,S);case 4:return _(T,A,S,w);case 5:return x(T,A,S,w,L)}for(var k=new Array(arguments.length),C=0;C<arguments.length;++C)k[C]=arguments[C];return n(k)}}(function(){for(;a.length<=5;)a.push(i(a.length));N.exports=r.apply(void 0,[c].concat(a));for(var n=0;n<=5;++n)N.exports[n]=a[n]})()},{"robust-scale":536,"robust-subtract":538,"robust-sum":539,"two-product":588}],535:[function(h,N,H){var t=h("robust-sum"),m=h("robust-scale");N.exports=function(g,p){if(g.length===1)return m(p,g[0]);if(p.length===1)return m(g,p[0]);if(g.length===0||p.length===0)return[0];var e=[0];if(g.length<p.length)for(var f=0;f<g.length;++f)e=t(e,m(p,g[f]));else for(f=0;f<p.length;++f)e=t(e,m(g,p[f]));return e}},{"robust-scale":536,"robust-sum":539}],536:[function(h,N,H){var t=h("two-product"),m=h("two-sum");N.exports=function(g,p){var e=g.length;if(e===1){var f=t(g[0],p);return f[0]?f:[f[1]]}var u=new Array(2*e),i=[.1,.1],s=[.1,.1],o=0;t(g[0],p,i),i[0]&&(u[o++]=i[0]);for(var a=1;a<e;++a){t(g[a],p,s);var c=i[1];m(c,s[0],i),i[0]&&(u[o++]=i[0]);var r=s[1],n=i[1],d=r+n,l=n-(d-r);i[1]=d,l&&(u[o++]=l)}return i[1]&&(u[o++]=i[1]),o===0&&(u[o++]=0),u.length=o,u}},{"two-product":588,"two-sum":589}],537:[function(h,N,H){N.exports=function(m,g,p,e){var f=t(m,p,e),u=t(g,p,e);if(f>0&&u>0||f<0&&u<0)return!1;var i=t(p,m,g),s=t(e,m,g);return i>0&&s>0||i<0&&s<0?!1:f===0&&u===0&&i===0&&s===0?function(o,a,c,r){for(var n=0;n<2;++n){var d=o[n],l=a[n],y=Math.min(d,l),v=Math.max(d,l),_=c[n],x=r[n],T=Math.min(_,x);if(Math.max(_,x)<y||v<T)return!1}return!0}(m,g,p,e):!0};var t=h("robust-orientation")[3]},{"robust-orientation":534}],538:[function(h,N,H){N.exports=function(t,m){var g=0|t.length,p=0|m.length;if(g===1&&p===1)return function(S,w){var L=S+w,k=L-S,C=S-(L-k)+(w-k);return C?[C,L]:[L]}(t[0],-m[0]);var e,f,u=new Array(g+p),i=0,s=0,o=0,a=Math.abs,c=t[s],r=a(c),n=-m[o],d=a(n);r<d?(f=c,(s+=1)<g&&(c=t[s],r=a(c))):(f=n,(o+=1)<p&&(n=-m[o],d=a(n))),s<g&&r<d||o>=p?(e=c,(s+=1)<g&&(c=t[s],r=a(c))):(e=n,(o+=1)<p&&(n=-m[o],d=a(n)));for(var l,y,v=e+f,_=v-e,x=f-_,T=x,A=v;s<g&&o<p;)r<d?(e=c,(s+=1)<g&&(c=t[s],r=a(c))):(e=n,(o+=1)<p&&(n=-m[o],d=a(n))),(x=(f=T)-(_=(v=e+f)-e))&&(u[i++]=x),T=A-((l=A+v)-(y=l-A))+(v-y),A=l;for(;s<g;)(x=(f=T)-(_=(v=(e=c)+f)-e))&&(u[i++]=x),T=A-((l=A+v)-(y=l-A))+(v-y),A=l,(s+=1)<g&&(c=t[s]);for(;o<p;)(x=(f=T)-(_=(v=(e=n)+f)-e))&&(u[i++]=x),T=A-((l=A+v)-(y=l-A))+(v-y),A=l,(o+=1)<p&&(n=-m[o]);return T&&(u[i++]=T),A&&(u[i++]=A),i||(u[i++]=0),u.length=i,u}},{}],539:[function(h,N,H){N.exports=function(t,m){var g=0|t.length,p=0|m.length;if(g===1&&p===1)return function(S,w){var L=S+w,k=L-S,C=S-(L-k)+(w-k);return C?[C,L]:[L]}(t[0],m[0]);var e,f,u=new Array(g+p),i=0,s=0,o=0,a=Math.abs,c=t[s],r=a(c),n=m[o],d=a(n);r<d?(f=c,(s+=1)<g&&(c=t[s],r=a(c))):(f=n,(o+=1)<p&&(n=m[o],d=a(n))),s<g&&r<d||o>=p?(e=c,(s+=1)<g&&(c=t[s],r=a(c))):(e=n,(o+=1)<p&&(n=m[o],d=a(n)));for(var l,y,v=e+f,_=v-e,x=f-_,T=x,A=v;s<g&&o<p;)r<d?(e=c,(s+=1)<g&&(c=t[s],r=a(c))):(e=n,(o+=1)<p&&(n=m[o],d=a(n))),(x=(f=T)-(_=(v=e+f)-e))&&(u[i++]=x),T=A-((l=A+v)-(y=l-A))+(v-y),A=l;for(;s<g;)(x=(f=T)-(_=(v=(e=c)+f)-e))&&(u[i++]=x),T=A-((l=A+v)-(y=l-A))+(v-y),A=l,(s+=1)<g&&(c=t[s]);for(;o<p;)(x=(f=T)-(_=(v=(e=n)+f)-e))&&(u[i++]=x),T=A-((l=A+v)-(y=l-A))+(v-y),A=l,(o+=1)<p&&(n=m[o]);return T&&(u[i++]=T),A&&(u[i++]=A),i||(u[i++]=0),u.length=i,u}},{}],540:[function(h,N,H){var t=h("buffer"),m=t.Buffer;function g(e,f){for(var u in e)f[u]=e[u]}function p(e,f,u){return m(e,f,u)}m.from&&m.alloc&&m.allocUnsafe&&m.allocUnsafeSlow?N.exports=t:(g(t,H),H.Buffer=p),p.prototype=Object.create(m.prototype),g(m,p),p.from=function(e,f,u){if(typeof e=="number")throw new TypeError("Argument must not be a number");return m(e,f,u)},p.alloc=function(e,f,u){if(typeof e!="number")throw new TypeError("Argument must be a number");var i=m(e);return f!==void 0?typeof u=="string"?i.fill(f,u):i.fill(f):i.fill(0),i},p.allocUnsafe=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return m(e)},p.allocUnsafeSlow=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return t.SlowBuffer(e)}},{buffer:117}],541:[function(h,N,H){N.exports=function(t){return t<0?-1:t>0?1:0}},{}],542:[function(h,N,H){N.exports=function(g){return m(t(g))};var t=h("boundary-cells"),m=h("reduce-simplicial-complex")},{"boundary-cells":107,"reduce-simplicial-complex":521}],543:[function(h,N,H){N.exports=function(e,f,u,i){if(u=u||0,i===void 0&&(i=function(l){for(var y=l.length,v=0,_=0;_<y;++_)v=0|Math.max(v,l[_].length);return v-1}(e)),e.length===0||i<1)return{cells:[],vertexIds:[],vertexWeights:[]};var s=function(l,y){for(var v=l.length,_=m.mallocUint8(v),x=0;x<v;++x)_[x]=l[x]<y|0;return _}(f,+u),o=function(l,y){for(var v=l.length,_=y*(y+1)/2*v|0,x=m.mallocUint32(2*_),T=0,A=0;A<v;++A)for(var S=l[A],w=(y=S.length,0);w<y;++w)for(var L=0;L<w;++L){var k=S[L],C=S[w];x[T++]=0|Math.min(k,C),x[T++]=0|Math.max(k,C)}g(t(x,[T/2|0,2]));var M=2;for(A=2;A<T;A+=2)x[A-2]===x[A]&&x[A-1]===x[A+1]||(x[M++]=x[A],x[M++]=x[A+1]);return t(x,[M/2|0,2])}(e,i),a=function(l,y,v,_){for(var x=l.data,T=l.shape[0],A=m.mallocDouble(T),S=0,w=0;w<T;++w){var L=x[2*w],k=x[2*w+1];if(v[L]!==v[k]){var C=y[L],M=y[k];x[2*S]=L,x[2*S+1]=k,A[S++]=(M-_)/(M-C)}}return l.shape[0]=S,t(A,[S])}(o,f,s,+u),c=function(l,y){var v=m.mallocInt32(2*y),_=l.shape[0],x=l.data;v[0]=0;for(var T=0,A=0;A<_;++A){var S=x[2*A];if(S!==T){for(v[2*T+1]=A;++T<S;)v[2*T]=A,v[2*T+1]=A;v[2*T]=A}}for(v[2*T+1]=_;++T<y;)v[2*T]=v[2*T+1]=_;return v}(o,0|f.length),r=p(i)(e,o.data,c,s),n=function(l){for(var y=0|l.shape[0],v=l.data,_=new Array(y),x=0;x<y;++x)_[x]=[v[2*x],v[2*x+1]];return _}(o),d=[].slice.call(a.data,0,a.shape[0]);return m.free(s),m.free(o.data),m.free(a.data),m.free(c),{cells:r,vertexIds:n,vertexWeights:d}};var t=h("ndarray"),m=h("typedarray-pool"),g=h("ndarray-sort"),p=h("./lib/codegen")},{"./lib/codegen":544,ndarray:472,"ndarray-sort":471,"typedarray-pool":601}],544:[function(h,N,H){N.exports=function(m){return t[m]()};var t=[function(){return function(m,g,p,e){for(var f=m.length,u=0;u<f;++u)m[u].length;return[]}},function(){function m(g,p,e,f){for(var u=0|Math.min(e,f),i=0|Math.max(e,f),s=g[2*u],o=g[2*u+1];s<o;){var a=s+o>>1,c=p[2*a+1];if(c===i)return a;i<c?o=a:s=a+1}return s}return function(g,p,e,f){for(var u=g.length,i=[],s=0;s<u;++s){var o=g[s];if(o.length===2){var a=(f[o[0]]<<0)+(f[o[1]]<<1);if(a===0||a===3)continue;switch(a){case 0:break;case 1:i.push([m(e,p,o[0],o[1])]);break;case 2:i.push([m(e,p,o[1],o[0])])}}}return i}},function(){function m(g,p,e,f){for(var u=0|Math.min(e,f),i=0|Math.max(e,f),s=g[2*u],o=g[2*u+1];s<o;){var a=s+o>>1,c=p[2*a+1];if(c===i)return a;i<c?o=a:s=a+1}return s}return function(g,p,e,f){for(var u=g.length,i=[],s=0;s<u;++s){var o=g[s],a=o.length;if(a===3){if((c=(f[o[0]]<<0)+(f[o[1]]<<1)+(f[o[2]]<<2))==0||c===7)continue;switch(c){case 0:break;case 1:i.push([m(e,p,o[0],o[2]),m(e,p,o[0],o[1])]);break;case 2:i.push([m(e,p,o[1],o[0]),m(e,p,o[1],o[2])]);break;case 3:i.push([m(e,p,o[0],o[2]),m(e,p,o[1],o[2])]);break;case 4:i.push([m(e,p,o[2],o[1]),m(e,p,o[2],o[0])]);break;case 5:i.push([m(e,p,o[2],o[1]),m(e,p,o[0],o[1])]);break;case 6:i.push([m(e,p,o[1],o[0]),m(e,p,o[2],o[0])])}}else if(a===2){var c;if((c=(f[o[0]]<<0)+(f[o[1]]<<1))==0||c===3)continue;switch(c){case 0:break;case 1:i.push([m(e,p,o[0],o[1])]);break;case 2:i.push([m(e,p,o[1],o[0])])}}}return i}},function(){function m(g,p,e,f){for(var u=0|Math.min(e,f),i=0|Math.max(e,f),s=g[2*u],o=g[2*u+1];s<o;){var a=s+o>>1,c=p[2*a+1];if(c===i)return a;i<c?o=a:s=a+1}return s}return function(g,p,e,f){for(var u=g.length,i=[],s=0;s<u;++s){var o=g[s],a=o.length;if(a===4){if((c=(f[o[0]]<<0)+(f[o[1]]<<1)+(f[o[2]]<<2)+(f[o[3]]<<3))==0||c===15)continue;switch(c){case 0:break;case 1:i.push([m(e,p,o[0],o[1]),m(e,p,o[0],o[2]),m(e,p,o[0],o[3])]);break;case 2:i.push([m(e,p,o[1],o[2]),m(e,p,o[1],o[0]),m(e,p,o[1],o[3])]);break;case 3:i.push([m(e,p,o[1],o[2]),m(e,p,o[0],o[2]),m(e,p,o[0],o[3])],[m(e,p,o[1],o[3]),m(e,p,o[1],o[2]),m(e,p,o[0],o[3])]);break;case 4:i.push([m(e,p,o[2],o[0]),m(e,p,o[2],o[1]),m(e,p,o[2],o[3])]);break;case 5:i.push([m(e,p,o[0],o[1]),m(e,p,o[2],o[1]),m(e,p,o[0],o[3])],[m(e,p,o[2],o[1]),m(e,p,o[2],o[3]),m(e,p,o[0],o[3])]);break;case 6:i.push([m(e,p,o[2],o[0]),m(e,p,o[1],o[0]),m(e,p,o[1],o[3])],[m(e,p,o[2],o[3]),m(e,p,o[2],o[0]),m(e,p,o[1],o[3])]);break;case 7:i.push([m(e,p,o[0],o[3]),m(e,p,o[1],o[3]),m(e,p,o[2],o[3])]);break;case 8:i.push([m(e,p,o[3],o[1]),m(e,p,o[3],o[0]),m(e,p,o[3],o[2])]);break;case 9:i.push([m(e,p,o[3],o[1]),m(e,p,o[0],o[1]),m(e,p,o[0],o[2])],[m(e,p,o[3],o[2]),m(e,p,o[3],o[1]),m(e,p,o[0],o[2])]);break;case 10:i.push([m(e,p,o[1],o[0]),m(e,p,o[3],o[0]),m(e,p,o[1],o[2])],[m(e,p,o[3],o[0]),m(e,p,o[3],o[2]),m(e,p,o[1],o[2])]);break;case 11:i.push([m(e,p,o[1],o[2]),m(e,p,o[0],o[2]),m(e,p,o[3],o[2])]);break;case 12:i.push([m(e,p,o[3],o[0]),m(e,p,o[2],o[0]),m(e,p,o[2],o[1])],[m(e,p,o[3],o[1]),m(e,p,o[3],o[0]),m(e,p,o[2],o[1])]);break;case 13:i.push([m(e,p,o[0],o[1]),m(e,p,o[2],o[1]),m(e,p,o[3],o[1])]);break;case 14:i.push([m(e,p,o[2],o[0]),m(e,p,o[1],o[0]),m(e,p,o[3],o[0])])}}else if(a===3){if((c=(f[o[0]]<<0)+(f[o[1]]<<1)+(f[o[2]]<<2))==0||c===7)continue;switch(c){case 0:break;case 1:i.push([m(e,p,o[0],o[2]),m(e,p,o[0],o[1])]);break;case 2:i.push([m(e,p,o[1],o[0]),m(e,p,o[1],o[2])]);break;case 3:i.push([m(e,p,o[0],o[2]),m(e,p,o[1],o[2])]);break;case 4:i.push([m(e,p,o[2],o[1]),m(e,p,o[2],o[0])]);break;case 5:i.push([m(e,p,o[2],o[1]),m(e,p,o[0],o[1])]);break;case 6:i.push([m(e,p,o[1],o[0]),m(e,p,o[2],o[0])])}}else if(a===2){var c;if((c=(f[o[0]]<<0)+(f[o[1]]<<1))==0||c===3)continue;switch(c){case 0:break;case 1:i.push([m(e,p,o[0],o[1])]);break;case 2:i.push([m(e,p,o[1],o[0])])}}}return i}}]},{}],545:[function(h,N,H){var t=h("bit-twiddle"),m=h("union-find");function g(o,a){var c=o.length,r=o.length-a.length,n=Math.min;if(r)return r;switch(c){case 0:return 0;case 1:return o[0]-a[0];case 2:return(y=o[0]+o[1]-a[0]-a[1])||n(o[0],o[1])-n(a[0],a[1]);case 3:var d=o[0]+o[1],l=a[0]+a[1];if(y=d+o[2]-(l+a[2]))return y;var y,v=n(o[0],o[1]),_=n(a[0],a[1]);return(y=n(v,o[2])-n(_,a[2]))||n(v+o[2],d)-n(_+a[2],l);default:var x=o.slice(0);x.sort();var T=a.slice(0);T.sort();for(var A=0;A<c;++A)if(r=x[A]-T[A])return r;return 0}}function p(o,a){return g(o[0],a[0])}function e(o,a){if(a){for(var c=o.length,r=new Array(c),n=0;n<c;++n)r[n]=[o[n],a[n]];for(r.sort(p),n=0;n<c;++n)o[n]=r[n][0],a[n]=r[n][1];return o}return o.sort(g),o}function f(o){if(o.length===0)return[];for(var a=1,c=o.length,r=1;r<c;++r){var n=o[r];if(g(n,o[r-1])){if(r===a){a++;continue}o[a++]=n}}return o.length=a,o}function u(o,a){for(var c=0,r=o.length-1,n=-1;c<=r;){var d=c+r>>1,l=g(o[d],a);l<=0?(l===0&&(n=d),c=d+1):l>0&&(r=d-1)}return n}function i(o,a){for(var c=new Array(o.length),r=0,n=c.length;r<n;++r)c[r]=[];for(var d=[],l=(r=0,a.length);r<l;++r)for(var y=a[r],v=y.length,_=1,x=1<<v;_<x;++_){d.length=t.popCount(_);for(var T=0,A=0;A<v;++A)_&1<<A&&(d[T++]=y[A]);var S=u(o,d);if(!(S<0))for(;c[S++].push(r),!(S>=o.length||g(o[S],d)!==0););}return c}function s(o,a){if(a<0)return[];for(var c=[],r=(1<<a+1)-1,n=0;n<o.length;++n)for(var d=o[n],l=r;l<1<<d.length;l=t.nextCombination(l)){for(var y=new Array(a+1),v=0,_=0;_<d.length;++_)l&1<<_&&(y[v++]=d[_]);c.push(y)}return e(c)}H.dimension=function(o){for(var a=0,c=Math.max,r=0,n=o.length;r<n;++r)a=c(a,o[r].length);return a-1},H.countVertices=function(o){for(var a=-1,c=Math.max,r=0,n=o.length;r<n;++r)for(var d=o[r],l=0,y=d.length;l<y;++l)a=c(a,d[l]);return a+1},H.cloneCells=function(o){for(var a=new Array(o.length),c=0,r=o.length;c<r;++c)a[c]=o[c].slice(0);return a},H.compareCells=g,H.normalize=e,H.unique=f,H.findCell=u,H.incidence=i,H.dual=function(o,a){if(!a)return i(f(s(o,0)),o);for(var c=new Array(a),r=0;r<a;++r)c[r]=[];r=0;for(var n=o.length;r<n;++r)for(var d=o[r],l=0,y=d.length;l<y;++l)c[d[l]].push(r);return c},H.explode=function(o){for(var a=[],c=0,r=o.length;c<r;++c)for(var n=o[c],d=0|n.length,l=1,y=1<<d;l<y;++l){for(var v=[],_=0;_<d;++_)l>>>_&1&&v.push(n[_]);a.push(v)}return e(a)},H.skeleton=s,H.boundary=function(o){for(var a=[],c=0,r=o.length;c<r;++c)for(var n=o[c],d=0,l=n.length;d<l;++d){for(var y=new Array(n.length-1),v=0,_=0;v<l;++v)v!==d&&(y[_++]=n[v]);a.push(y)}return e(a)},H.connectedComponents=function(o,a){return a?function(c,r){for(var n=new m(r),d=0;d<c.length;++d)for(var l=c[d],y=0;y<l.length;++y)for(var v=y+1;v<l.length;++v)n.link(l[y],l[v]);var _=[],x=n.ranks;for(d=0;d<x.length;++d)x[d]=-1;for(d=0;d<c.length;++d){var T=n.find(c[d][0]);x[T]<0?(x[T]=_.length,_.push([c[d].slice(0)])):_[x[T]].push(c[d].slice(0))}return _}(o,a):function(c){for(var r=f(e(s(c,0))),n=new m(r.length),d=0;d<c.length;++d)for(var l=c[d],y=0;y<l.length;++y)for(var v=u(r,[l[y]]),_=y+1;_<l.length;++_)n.link(v,u(r,[l[_]]));var x=[],T=n.ranks;for(d=0;d<T.length;++d)T[d]=-1;for(d=0;d<c.length;++d){var A=n.find(u(r,[c[d][0]]));T[A]<0?(T[A]=x.length,x.push([c[d].slice(0)])):x[T[A]].push(c[d].slice(0))}return x}(o)}},{"bit-twiddle":104,"union-find":602}],546:[function(h,N,H){arguments[4][104][0].apply(H,arguments)},{dup:104}],547:[function(h,N,H){arguments[4][545][0].apply(H,arguments)},{"bit-twiddle":546,dup:545,"union-find":548}],548:[function(h,N,H){function t(m){this.roots=new Array(m),this.ranks=new Array(m);for(var g=0;g<m;++g)this.roots[g]=g,this.ranks[g]=0}N.exports=t,t.prototype.length=function(){return this.roots.length},t.prototype.makeSet=function(){var m=this.roots.length;return this.roots.push(m),this.ranks.push(0),m},t.prototype.find=function(m){for(var g=this.roots;g[m]!==m;){var p=g[m];g[m]=g[p],m=p}return m},t.prototype.link=function(m,g){var p=this.find(m),e=this.find(g);if(p!==e){var f=this.ranks,u=this.roots,i=f[p],s=f[e];i<s?u[p]=e:s<i?u[e]=p:(u[e]=p,++f[p])}}},{}],549:[function(h,N,H){N.exports=function(g,p,e){for(var f=p.length,u=g.length,i=new Array(f),s=new Array(f),o=new Array(f),a=new Array(f),c=0;c<f;++c)i[c]=s[c]=-1,o[c]=1/0,a[c]=!1;for(c=0;c<u;++c){var r=g[c];if(r.length!==2)throw new Error("Input must be a graph");var n=r[1],d=r[0];s[d]!==-1?s[d]=-2:s[d]=n,i[n]!==-1?i[n]=-2:i[n]=d}function l(j){if(a[j])return 1/0;var W,Z,Q,X,G,Y=i[j],K=s[j];return Y<0||K<0?1/0:(W=p[j],Z=p[Y],Q=p[K],X=Math.abs(t(W,Z,Q)),G=Math.sqrt(Math.pow(Z[0]-Q[0],2)+Math.pow(Z[1]-Q[1],2)),X/G)}function y(j,W){var Z=L[j],Q=L[W];L[j]=Q,L[W]=Z,k[Z]=W,k[Q]=j}function v(j){return o[L[j]]}function _(j){return 1&j?j-1>>1:(j>>1)-1}function x(j){for(var W=v(j);;){var Z=W,Q=2*j+1,X=2*(j+1),G=j;if(Q<C){var Y=v(Q);Y<Z&&(G=Q,Z=Y)}if(X<C&&v(X)<Z&&(G=X),G===j)return j;y(j,G),j=G}}function T(j){for(var W=v(j);j>0;){var Z=_(j);if(Z>=0&&W<v(Z)){y(j,Z),j=Z;continue}return j}}function A(){if(C>0){var j=L[0];return y(0,C-1),C-=1,x(0),j}return-1}function S(j,W){var Z=L[j];return o[Z]===W?j:(o[Z]=-1/0,T(j),A(),o[Z]=W,T((C+=1)-1))}function w(j){if(!a[j]){a[j]=!0;var W=i[j],Z=s[j];i[Z]>=0&&(i[Z]=W),s[W]>=0&&(s[W]=Z),k[W]>=0&&S(k[W],l(W)),k[Z]>=0&&S(k[Z],l(Z))}}var L=[],k=new Array(f);for(c=0;c<f;++c)(o[c]=l(c))<1/0?(k[c]=L.length,L.push(c)):k[c]=-1;var C=L.length;for(c=C>>1;c>=0;--c)x(c);for(;;){var M=A();if(M<0||o[M]>e)break;w(M)}var P=[];for(c=0;c<f;++c)a[c]||(k[c]=P.length,P.push(p[c].slice()));P.length;function O(j,W){if(j[W]<0)return W;var Z=W,Q=W;do{var X=j[Q];if(!a[Q]||X<0||X===Q||(X=j[Q=X],!a[Q]||X<0||X===Q))break;Q=X,Z=j[Z]}while(Z!==Q);for(var G=W;G!==Q;G=j[G])j[G]=Q;return Q}var F=[];return g.forEach(function(j){var W=O(i,j[0]),Z=O(s,j[1]);if(W>=0&&Z>=0&&W!==Z){var Q=k[W],X=k[Z];Q!==X&&F.push([Q,X])}}),m.unique(m.normalize(F)),{positions:P,edges:F}};var t=h("robust-orientation"),m=h("simplicial-complex")},{"robust-orientation":534,"simplicial-complex":547}],550:[function(h,N,H){N.exports=function(g,p){var e,f,u,i;if(p[0][0]<p[1][0])e=p[0],f=p[1];else{if(!(p[0][0]>p[1][0]))return m(p,g);e=p[1],f=p[0]}if(g[0][0]<g[1][0])u=g[0],i=g[1];else{if(!(g[0][0]>g[1][0]))return-m(g,p);u=g[1],i=g[0]}var s=t(e,f,i),o=t(e,f,u);if(s<0){if(o<=0)return s}else if(s>0){if(o>=0)return s}else if(o)return o;if(s=t(i,u,f),o=t(i,u,e),s<0){if(o<=0)return s}else if(s>0){if(o>=0)return s}else if(o)return o;return f[0]-i[0]};var t=h("robust-orientation");function m(g,p){var e,f,u,i;if(p[0][0]<p[1][0])e=p[0],f=p[1];else{if(!(p[0][0]>p[1][0])){var s=Math.min(g[0][1],g[1][1]),o=Math.max(g[0][1],g[1][1]),a=Math.min(p[0][1],p[1][1]),c=Math.max(p[0][1],p[1][1]);return o<a?o-a:s>c?s-c:o-c}e=p[1],f=p[0]}g[0][1]<g[1][1]?(u=g[0],i=g[1]):(u=g[1],i=g[0]);var r=t(f,e,u);return r||(r=t(f,e,i))||i-f}},{"robust-orientation":534}],551:[function(h,N,H){N.exports=function(o){for(var a=o.length,c=2*a,r=new Array(c),n=0;n<a;++n){var d=o[n],l=d[0][0]<d[1][0];r[2*n]=new s(d[0][0],d,l,n),r[2*n+1]=new s(d[1][0],d,!l,n)}r.sort(function(w,L){var k=w.x-L.x;return k||(k=w.create-L.create)||Math.min(w.segment[0][1],w.segment[1][1])-Math.min(L.segment[0][1],L.segment[1][1])});var y=m(p),v=[],_=[],x=[];for(n=0;n<c;){for(var T=r[n].x,A=[];n<c;){var S=r[n];if(S.x!==T)break;n+=1,S.segment[0][0]===S.x&&S.segment[1][0]===S.x?S.create&&(S.segment[0][1]<S.segment[1][1]?(A.push(new i(S.segment[0][1],S.index,!0,!0)),A.push(new i(S.segment[1][1],S.index,!1,!1))):(A.push(new i(S.segment[1][1],S.index,!0,!1)),A.push(new i(S.segment[0][1],S.index,!1,!0)))):y=S.create?y.insert(S.segment,S.index):y.remove(S.segment)}v.push(y.root),_.push(T),x.push(A)}return new e(v,_,x)};var t=h("binary-search-bounds"),m=h("functional-red-black-tree"),g=h("robust-orientation"),p=h("./lib/order-segments");function e(o,a,c){this.slabs=o,this.coordinates=a,this.horizontal=c}function f(o,a){return o.y-a}function u(o,a){for(var c=null;o;){var r,n,d=o.key;d[0][0]<d[1][0]?(r=d[0],n=d[1]):(r=d[1],n=d[0]);var l=g(r,n,a);if(l<0)o=o.left;else if(l>0)if(a[0]!==d[1][0])c=o,o=o.right;else{if(y=u(o.right,a))return y;o=o.left}else{if(a[0]!==d[1][0])return o;var y;if(y=u(o.right,a))return y;o=o.left}}return c}function i(o,a,c,r){this.y=o,this.index=a,this.start=c,this.closed=r}function s(o,a,c,r){this.x=o,this.segment=a,this.create=c,this.index=r}e.prototype.castUp=function(o){var a=t.le(this.coordinates,o[0]);if(a<0)return-1;this.slabs[a];var c=u(this.slabs[a],o),r=-1;if(c&&(r=c.value),this.coordinates[a]===o[0]){var n=null;if(c&&(n=c.key),a>0){var d=u(this.slabs[a-1],o);d&&(n?p(d.key,n)>0&&(n=d.key,r=d.value):(r=d.value,n=d.key))}var l=this.horizontal[a];if(l.length>0){var y=t.ge(l,o[1],f);if(y<l.length){var v=l[y];if(o[1]===v.y){if(v.closed)return v.index;for(;y<l.length-1&&l[y+1].y===o[1];)if((v=l[y+=1]).closed)return v.index;if(v.y===o[1]&&!v.start){if((y+=1)>=l.length)return r;v=l[y]}}if(v.start)if(n){var _=g(n[0],n[1],[o[0],v.y]);n[0][0]>n[1][0]&&(_=-_),_>0&&(r=v.index)}else r=v.index;else v.y!==o[1]&&(r=v.index)}}}return r}},{"./lib/order-segments":550,"binary-search-bounds":103,"functional-red-black-tree":251,"robust-orientation":534}],552:[function(h,N,H){var t=h("robust-dot-product"),m=h("robust-sum");function g(e,f){var u=m(t(e,f),[f[f.length-1]]);return u[u.length-1]}function p(e,f,u,i){var s=-f/(i-f);s<0?s=0:s>1&&(s=1);for(var o=1-s,a=e.length,c=new Array(a),r=0;r<a;++r)c[r]=s*e[r]+o*u[r];return c}N.exports=function(e,f){for(var u=[],i=[],s=g(e[e.length-1],f),o=e[e.length-1],a=e[0],c=0;c<e.length;++c,o=a){var r=g(a=e[c],f);if(s<0&&r>0||s>0&&r<0){var n=p(o,r,a,s);u.push(n),i.push(n.slice())}r<0?i.push(a.slice()):r>0?u.push(a.slice()):(u.push(a.slice()),i.push(a.slice())),s=r}return{positive:u,negative:i}},N.exports.positive=function(e,f){for(var u=[],i=g(e[e.length-1],f),s=e[e.length-1],o=e[0],a=0;a<e.length;++a,s=o){var c=g(o=e[a],f);(i<0&&c>0||i>0&&c<0)&&u.push(p(s,c,o,i)),c>=0&&u.push(o.slice()),i=c}return u},N.exports.negative=function(e,f){for(var u=[],i=g(e[e.length-1],f),s=e[e.length-1],o=e[0],a=0;a<e.length;++a,s=o){var c=g(o=e[a],f);(i<0&&c>0||i>0&&c<0)&&u.push(p(s,c,o,i)),c<=0&&u.push(o.slice()),i=c}return u}},{"robust-dot-product":531,"robust-sum":539}],553:[function(h,N,H){(function(){var t={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function m(u){return p(f(u),arguments)}function g(u,i){return m.apply(null,[u].concat(i||[]))}function p(u,i){var s,o,a,c,r,n,d,l,y,v=1,_=u.length,x="";for(o=0;o<_;o++)if(typeof u[o]=="string")x+=u[o];else if(typeof u[o]=="object"){if((c=u[o]).keys)for(s=i[v],a=0;a<c.keys.length;a++){if(s==null)throw new Error(m('[sprintf] Cannot access property "%s" of undefined value "%s"',c.keys[a],c.keys[a-1]));s=s[c.keys[a]]}else s=c.param_no?i[c.param_no]:i[v++];if(t.not_type.test(c.type)&&t.not_primitive.test(c.type)&&s instanceof Function&&(s=s()),t.numeric_arg.test(c.type)&&typeof s!="number"&&isNaN(s))throw new TypeError(m("[sprintf] expecting number but found %T",s));switch(t.number.test(c.type)&&(l=s>=0),c.type){case"b":s=parseInt(s,10).toString(2);break;case"c":s=String.fromCharCode(parseInt(s,10));break;case"d":case"i":s=parseInt(s,10);break;case"j":s=JSON.stringify(s,null,c.width?parseInt(c.width):0);break;case"e":s=c.precision?parseFloat(s).toExponential(c.precision):parseFloat(s).toExponential();break;case"f":s=c.precision?parseFloat(s).toFixed(c.precision):parseFloat(s);break;case"g":s=c.precision?String(Number(s.toPrecision(c.precision))):parseFloat(s);break;case"o":s=(parseInt(s,10)>>>0).toString(8);break;case"s":s=String(s),s=c.precision?s.substring(0,c.precision):s;break;case"t":s=String(!!s),s=c.precision?s.substring(0,c.precision):s;break;case"T":s=Object.prototype.toString.call(s).slice(8,-1).toLowerCase(),s=c.precision?s.substring(0,c.precision):s;break;case"u":s=parseInt(s,10)>>>0;break;case"v":s=s.valueOf(),s=c.precision?s.substring(0,c.precision):s;break;case"x":s=(parseInt(s,10)>>>0).toString(16);break;case"X":s=(parseInt(s,10)>>>0).toString(16).toUpperCase()}t.json.test(c.type)?x+=s:(!t.number.test(c.type)||l&&!c.sign?y="":(y=l?"+":"-",s=s.toString().replace(t.sign,"")),n=c.pad_char?c.pad_char==="0"?"0":c.pad_char.charAt(1):" ",d=c.width-(y+s).length,r=c.width&&d>0?n.repeat(d):"",x+=c.align?y+s+r:n==="0"?y+r+s:r+y+s)}return x}var e=Object.create(null);function f(u){if(e[u])return e[u];for(var i,s=u,o=[],a=0;s;){if((i=t.text.exec(s))!==null)o.push(i[0]);else if((i=t.modulo.exec(s))!==null)o.push("%");else{if((i=t.placeholder.exec(s))===null)throw new SyntaxError("[sprintf] unexpected placeholder");if(i[2]){a|=1;var c=[],r=i[2],n=[];if((n=t.key.exec(r))===null)throw new SyntaxError("[sprintf] failed to parse named argument key");for(c.push(n[1]);(r=r.substring(n[0].length))!=="";)if((n=t.key_access.exec(r))!==null)c.push(n[1]);else{if((n=t.index_access.exec(r))===null)throw new SyntaxError("[sprintf] failed to parse named argument key");c.push(n[1])}i[2]=c}else a|=2;if(a===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");o.push({placeholder:i[0],param_no:i[1],keys:i[2],sign:i[3],pad_char:i[4],align:i[5],width:i[6],precision:i[7],type:i[8]})}s=s.substring(i[0].length)}return e[u]=o}H!==void 0&&(H.sprintf=m,H.vsprintf=g),typeof window!="undefined"&&(window.sprintf=m,window.vsprintf=g)})()},{}],554:[function(h,N,H){N.exports=m;var t=h("events").EventEmitter;function m(){t.call(this)}h("inherits")(m,t),m.Readable=h("readable-stream/lib/_stream_readable.js"),m.Writable=h("readable-stream/lib/_stream_writable.js"),m.Duplex=h("readable-stream/lib/_stream_duplex.js"),m.Transform=h("readable-stream/lib/_stream_transform.js"),m.PassThrough=h("readable-stream/lib/_stream_passthrough.js"),m.finished=h("readable-stream/lib/internal/streams/end-of-stream.js"),m.pipeline=h("readable-stream/lib/internal/streams/pipeline.js"),m.Stream=m,m.prototype.pipe=function(g,p){var e=this;function f(r){g.writable&&g.write(r)===!1&&e.pause&&e.pause()}function u(){e.readable&&e.resume&&e.resume()}e.on("data",f),g.on("drain",u),g._isStdio||p&&p.end===!1||(e.on("end",s),e.on("close",o));var i=!1;function s(){i||(i=!0,g.end())}function o(){i||(i=!0,typeof g.destroy=="function"&&g.destroy())}function a(r){if(c(),t.listenerCount(this,"error")===0)throw r}function c(){e.removeListener("data",f),g.removeListener("drain",u),e.removeListener("end",s),e.removeListener("close",o),e.removeListener("error",a),g.removeListener("error",a),e.removeListener("end",c),e.removeListener("close",c),g.removeListener("close",c)}return e.on("error",a),g.on("error",a),e.on("end",c),e.on("close",c),g.on("close",c),g.emit("pipe",e),g}},{events:116,inherits:439,"readable-stream/lib/_stream_duplex.js":556,"readable-stream/lib/_stream_passthrough.js":557,"readable-stream/lib/_stream_readable.js":558,"readable-stream/lib/_stream_transform.js":559,"readable-stream/lib/_stream_writable.js":560,"readable-stream/lib/internal/streams/end-of-stream.js":564,"readable-stream/lib/internal/streams/pipeline.js":566}],555:[function(h,N,H){var t={};function m(p,e,f){f||(f=Error);var u=function(i){var s,o;function a(c,r,n){return i.call(this,function(d,l,y){return typeof e=="string"?e:e(d,l,y)}(c,r,n))||this}return o=i,(s=a).prototype=Object.create(o.prototype),s.prototype.constructor=s,s.__proto__=o,a}(f);u.prototype.name=f.name,u.prototype.code=p,t[p]=u}function g(p,e){if(Array.isArray(p)){var f=p.length;return p=p.map(function(u){return String(u)}),f>2?"one of ".concat(e," ").concat(p.slice(0,f-1).join(", "),", or ")+p[f-1]:f===2?"one of ".concat(e," ").concat(p[0]," or ").concat(p[1]):"of ".concat(e," ").concat(p[0])}return"of ".concat(e," ").concat(String(p))}m("ERR_INVALID_OPT_VALUE",function(p,e){return'The value "'+e+'" is invalid for option "'+p+'"'},TypeError),m("ERR_INVALID_ARG_TYPE",function(p,e,f){var u,i,s;if(typeof e=="string"&&(i="not ",e.substr(0,i.length)===i)?(u="must not be",e=e.replace(/^not /,"")):u="must be",function(a,c,r){return(r===void 0||r>a.length)&&(r=a.length),a.substring(r-c.length,r)===c}(p," argument"))s="The ".concat(p," ").concat(u," ").concat(g(e,"type"));else{var o=function(a,c,r){return typeof r!="number"&&(r=0),!(r+c.length>a.length)&&a.indexOf(c,r)!==-1}(p,".")?"property":"argument";s='The "'.concat(p,'" ').concat(o," ").concat(u," ").concat(g(e,"type"))}return s+=". Received type ".concat(typeof f)},TypeError),m("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),m("ERR_METHOD_NOT_IMPLEMENTED",function(p){return"The "+p+" method is not implemented"}),m("ERR_STREAM_PREMATURE_CLOSE","Premature close"),m("ERR_STREAM_DESTROYED",function(p){return"Cannot call "+p+" after a stream was destroyed"}),m("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),m("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),m("ERR_STREAM_WRITE_AFTER_END","write after end"),m("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),m("ERR_UNKNOWN_ENCODING",function(p){return"Unknown encoding: "+p},TypeError),m("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),N.exports.codes=t},{}],556:[function(h,N,H){(function(t){(function(){var m=Object.keys||function(a){var c=[];for(var r in a)c.push(r);return c};N.exports=i;var g=h("./_stream_readable"),p=h("./_stream_writable");h("inherits")(i,g);for(var e=m(p.prototype),f=0;f<e.length;f++){var u=e[f];i.prototype[u]||(i.prototype[u]=p.prototype[u])}function i(a){if(!(this instanceof i))return new i(a);g.call(this,a),p.call(this,a),this.allowHalfOpen=!0,a&&(a.readable===!1&&(this.readable=!1),a.writable===!1&&(this.writable=!1),a.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",s)))}function s(){this._writableState.ended||t.nextTick(o,this)}function o(a){a.end()}Object.defineProperty(i.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(i.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(i.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(i.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(a){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=a,this._writableState.destroyed=a)}})}).call(this)}).call(this,h("_process"))},{"./_stream_readable":558,"./_stream_writable":560,_process:514,inherits:439}],557:[function(h,N,H){N.exports=m;var t=h("./_stream_transform");function m(g){if(!(this instanceof m))return new m(g);t.call(this,g)}h("inherits")(m,t),m.prototype._transform=function(g,p,e){e(null,g)}},{"./_stream_transform":559,inherits:439}],558:[function(h,N,H){(function(t,m){(function(){var g;N.exports=w,w.ReadableState=S,h("events").EventEmitter;var p=function(D,B){return D.listeners(B).length},e=h("./internal/streams/stream"),f=h("buffer").Buffer,u=m.Uint8Array||function(){},i,s=h("util");i=s&&s.debuglog?s.debuglog("stream"):function(){};var o,a,c,r=h("./internal/streams/buffer_list"),n=h("./internal/streams/destroy"),d=h("./internal/streams/state").getHighWaterMark,l=h("../errors").codes,y=l.ERR_INVALID_ARG_TYPE,v=l.ERR_STREAM_PUSH_AFTER_EOF,_=l.ERR_METHOD_NOT_IMPLEMENTED,x=l.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;h("inherits")(w,e);var T=n.errorOrDestroy,A=["error","close","destroy","pause","resume"];function S(D,B,q){g=g||h("./_stream_duplex"),D=D||{},typeof q!="boolean"&&(q=B instanceof g),this.objectMode=!!D.objectMode,q&&(this.objectMode=this.objectMode||!!D.readableObjectMode),this.highWaterMark=d(this,D,"readableHighWaterMark",q),this.buffer=new r,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=D.emitClose!==!1,this.autoDestroy=!!D.autoDestroy,this.destroyed=!1,this.defaultEncoding=D.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,D.encoding&&(o||(o=h("string_decoder/").StringDecoder),this.decoder=new o(D.encoding),this.encoding=D.encoding)}function w(D){if(g=g||h("./_stream_duplex"),!(this instanceof w))return new w(D);var B=this instanceof g;this._readableState=new S(D,this,B),this.readable=!0,D&&(typeof D.read=="function"&&(this._read=D.read),typeof D.destroy=="function"&&(this._destroy=D.destroy)),e.call(this)}function L(D,B,q,ee,J){i("readableAddChunk",B);var $,te=D._readableState;if(B===null)te.reading=!1,function(ie,ae){if(i("onEofChunk"),!ae.ended){if(ae.decoder){var he=ae.decoder.end();he&&he.length&&(ae.buffer.push(he),ae.length+=ae.objectMode?1:he.length)}ae.ended=!0,ae.sync?M(ie):(ae.needReadable=!1,ae.emittedReadable||(ae.emittedReadable=!0,P(ie)))}}(D,te);else if(J||($=function(ie,ae){var he;se=ae,f.isBuffer(se)||se instanceof u||typeof ae=="string"||ae===void 0||ie.objectMode||(he=new y("chunk",["string","Buffer","Uint8Array"],ae));var se;return he}(te,B)),$)T(D,$);else if(te.objectMode||B&&B.length>0)if(typeof B=="string"||te.objectMode||Object.getPrototypeOf(B)===f.prototype||(B=function(ie){return f.from(ie)}(B)),ee)te.endEmitted?T(D,new x):k(D,te,B,!0);else if(te.ended)T(D,new v);else{if(te.destroyed)return!1;te.reading=!1,te.decoder&&!q?(B=te.decoder.write(B),te.objectMode||B.length!==0?k(D,te,B,!1):O(D,te)):k(D,te,B,!1)}else ee||(te.reading=!1,O(D,te));return!te.ended&&(te.length<te.highWaterMark||te.length===0)}function k(D,B,q,ee){B.flowing&&B.length===0&&!B.sync?(B.awaitDrain=0,D.emit("data",q)):(B.length+=B.objectMode?1:q.length,ee?B.buffer.unshift(q):B.buffer.push(q),B.needReadable&&M(D)),O(D,B)}Object.defineProperty(w.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(D){this._readableState&&(this._readableState.destroyed=D)}}),w.prototype.destroy=n.destroy,w.prototype._undestroy=n.undestroy,w.prototype._destroy=function(D,B){B(D)},w.prototype.push=function(D,B){var q,ee=this._readableState;return ee.objectMode?q=!0:typeof D=="string"&&((B=B||ee.defaultEncoding)!==ee.encoding&&(D=f.from(D,B),B=""),q=!0),L(this,D,B,!1,q)},w.prototype.unshift=function(D){return L(this,D,null,!0,!1)},w.prototype.isPaused=function(){return this._readableState.flowing===!1},w.prototype.setEncoding=function(D){o||(o=h("string_decoder/").StringDecoder);var B=new o(D);this._readableState.decoder=B,this._readableState.encoding=this._readableState.decoder.encoding;for(var q=this._readableState.buffer.head,ee="";q!==null;)ee+=B.write(q.data),q=q.next;return this._readableState.buffer.clear(),ee!==""&&this._readableState.buffer.push(ee),this._readableState.length=ee.length,this};function C(D,B){return D<=0||B.length===0&&B.ended?0:B.objectMode?1:D!=D?B.flowing&&B.length?B.buffer.head.data.length:B.length:(D>B.highWaterMark&&(B.highWaterMark=function(q){return q>=1073741824?q=1073741824:(q--,q|=q>>>1,q|=q>>>2,q|=q>>>4,q|=q>>>8,q|=q>>>16,q++),q}(D)),D<=B.length?D:B.ended?B.length:(B.needReadable=!0,0))}function M(D){var B=D._readableState;i("emitReadable",B.needReadable,B.emittedReadable),B.needReadable=!1,B.emittedReadable||(i("emitReadable",B.flowing),B.emittedReadable=!0,t.nextTick(P,D))}function P(D){var B=D._readableState;i("emitReadable_",B.destroyed,B.length,B.ended),B.destroyed||!B.length&&!B.ended||(D.emit("readable"),B.emittedReadable=!1),B.needReadable=!B.flowing&&!B.ended&&B.length<=B.highWaterMark,Q(D)}function O(D,B){B.readingMore||(B.readingMore=!0,t.nextTick(F,D,B))}function F(D,B){for(;!B.reading&&!B.ended&&(B.length<B.highWaterMark||B.flowing&&B.length===0);){var q=B.length;if(i("maybeReadMore read 0"),D.read(0),q===B.length)break}B.readingMore=!1}function j(D){var B=D._readableState;B.readableListening=D.listenerCount("readable")>0,B.resumeScheduled&&!B.paused?B.flowing=!0:D.listenerCount("data")>0&&D.resume()}function W(D){i("readable nexttick read 0"),D.read(0)}function Z(D,B){i("resume",B.reading),B.reading||D.read(0),B.resumeScheduled=!1,D.emit("resume"),Q(D),B.flowing&&!B.reading&&D.read(0)}function Q(D){var B=D._readableState;for(i("flow",B.flowing);B.flowing&&D.read()!==null;);}function X(D,B){return B.length===0?null:(B.objectMode?q=B.buffer.shift():!D||D>=B.length?(q=B.decoder?B.buffer.join(""):B.buffer.length===1?B.buffer.first():B.buffer.concat(B.length),B.buffer.clear()):q=B.buffer.consume(D,B.decoder),q);var q}function G(D){var B=D._readableState;i("endReadable",B.endEmitted),B.endEmitted||(B.ended=!0,t.nextTick(Y,B,D))}function Y(D,B){if(i("endReadableNT",D.endEmitted,D.length),!D.endEmitted&&D.length===0&&(D.endEmitted=!0,B.readable=!1,B.emit("end"),D.autoDestroy)){var q=B._writableState;(!q||q.autoDestroy&&q.finished)&&B.destroy()}}function K(D,B){for(var q=0,ee=D.length;q<ee;q++)if(D[q]===B)return q;return-1}w.prototype.read=function(D){i("read",D),D=parseInt(D,10);var B=this._readableState,q=D;if(D!==0&&(B.emittedReadable=!1),D===0&&B.needReadable&&((B.highWaterMark!==0?B.length>=B.highWaterMark:B.length>0)||B.ended))return i("read: emitReadable",B.length,B.ended),B.length===0&&B.ended?G(this):M(this),null;if((D=C(D,B))===0&&B.ended)return B.length===0&&G(this),null;var ee,J=B.needReadable;return i("need readable",J),(B.length===0||B.length-D<B.highWaterMark)&&i("length less than watermark",J=!0),B.ended||B.reading?i("reading or ended",J=!1):J&&(i("do read"),B.reading=!0,B.sync=!0,B.length===0&&(B.needReadable=!0),this._read(B.highWaterMark),B.sync=!1,B.reading||(D=C(q,B))),(ee=D>0?X(D,B):null)===null?(B.needReadable=B.length<=B.highWaterMark,D=0):(B.length-=D,B.awaitDrain=0),B.length===0&&(B.ended||(B.needReadable=!0),q!==D&&B.ended&&G(this)),ee!==null&&this.emit("data",ee),ee},w.prototype._read=function(D){T(this,new _("_read()"))},w.prototype.pipe=function(D,B){var q=this,ee=this._readableState;switch(ee.pipesCount){case 0:ee.pipes=D;break;case 1:ee.pipes=[ee.pipes,D];break;default:ee.pipes.push(D)}ee.pipesCount+=1,i("pipe count=%d opts=%j",ee.pipesCount,B);var J=(!B||B.end!==!1)&&D!==t.stdout&&D!==t.stderr?te:ve;function $(ke,Ee){i("onunpipe"),ke===q&&Ee&&Ee.hasUnpiped===!1&&(Ee.hasUnpiped=!0,i("cleanup"),D.removeListener("close",de),D.removeListener("finish",ce),D.removeListener("drain",ie),D.removeListener("error",se),D.removeListener("unpipe",$),q.removeListener("end",te),q.removeListener("end",ve),q.removeListener("data",he),ae=!0,!ee.awaitDrain||D._writableState&&!D._writableState.needDrain||ie())}function te(){i("onend"),D.end()}ee.endEmitted?t.nextTick(J):q.once("end",J),D.on("unpipe",$);var ie=function(ke){return function(){var Ee=ke._readableState;i("pipeOnDrain",Ee.awaitDrain),Ee.awaitDrain&&Ee.awaitDrain--,Ee.awaitDrain===0&&p(ke,"data")&&(Ee.flowing=!0,Q(ke))}}(q);D.on("drain",ie);var ae=!1;function he(ke){i("ondata");var Ee=D.write(ke);i("dest.write",Ee),Ee===!1&&((ee.pipesCount===1&&ee.pipes===D||ee.pipesCount>1&&K(ee.pipes,D)!==-1)&&!ae&&(i("false write response, pause",ee.awaitDrain),ee.awaitDrain++),q.pause())}function se(ke){i("onerror",ke),ve(),D.removeListener("error",se),p(D,"error")===0&&T(D,ke)}function de(){D.removeListener("finish",ce),ve()}function ce(){i("onfinish"),D.removeListener("close",de),ve()}function ve(){i("unpipe"),q.unpipe(D)}return q.on("data",he),function(ke,Ee,be){if(typeof ke.prependListener=="function")return ke.prependListener(Ee,be);ke._events&&ke._events[Ee]?Array.isArray(ke._events[Ee])?ke._events[Ee].unshift(be):ke._events[Ee]=[be,ke._events[Ee]]:ke.on(Ee,be)}(D,"error",se),D.once("close",de),D.once("finish",ce),D.emit("pipe",q),ee.flowing||(i("pipe resume"),q.resume()),D},w.prototype.unpipe=function(D){var B=this._readableState,q={hasUnpiped:!1};if(B.pipesCount===0)return this;if(B.pipesCount===1)return D&&D!==B.pipes||(D||(D=B.pipes),B.pipes=null,B.pipesCount=0,B.flowing=!1,D&&D.emit("unpipe",this,q)),this;if(!D){var ee=B.pipes,J=B.pipesCount;B.pipes=null,B.pipesCount=0,B.flowing=!1;for(var $=0;$<J;$++)ee[$].emit("unpipe",this,{hasUnpiped:!1});return this}var te=K(B.pipes,D);return te===-1||(B.pipes.splice(te,1),B.pipesCount-=1,B.pipesCount===1&&(B.pipes=B.pipes[0]),D.emit("unpipe",this,q)),this},w.prototype.on=function(D,B){var q=e.prototype.on.call(this,D,B),ee=this._readableState;return D==="data"?(ee.readableListening=this.listenerCount("readable")>0,ee.flowing!==!1&&this.resume()):D==="readable"&&(ee.endEmitted||ee.readableListening||(ee.readableListening=ee.needReadable=!0,ee.flowing=!1,ee.emittedReadable=!1,i("on readable",ee.length,ee.reading),ee.length?M(this):ee.reading||t.nextTick(W,this))),q},w.prototype.addListener=w.prototype.on,w.prototype.removeListener=function(D,B){var q=e.prototype.removeListener.call(this,D,B);return D==="readable"&&t.nextTick(j,this),q},w.prototype.removeAllListeners=function(D){var B=e.prototype.removeAllListeners.apply(this,arguments);return D!=="readable"&&D!==void 0||t.nextTick(j,this),B},w.prototype.resume=function(){var D=this._readableState;return D.flowing||(i("resume"),D.flowing=!D.readableListening,function(B,q){q.resumeScheduled||(q.resumeScheduled=!0,t.nextTick(Z,B,q))}(this,D)),D.paused=!1,this},w.prototype.pause=function(){return i("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(i("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},w.prototype.wrap=function(D){var B=this,q=this._readableState,ee=!1;for(var J in D.on("end",function(){if(i("wrapped end"),q.decoder&&!q.ended){var te=q.decoder.end();te&&te.length&&B.push(te)}B.push(null)}),D.on("data",function(te){i("wrapped data"),q.decoder&&(te=q.decoder.write(te)),q.objectMode&&te==null||(q.objectMode||te&&te.length)&&(B.push(te)||(ee=!0,D.pause()))}),D)this[J]===void 0&&typeof D[J]=="function"&&(this[J]=function(te){return function(){return D[te].apply(D,arguments)}}(J));for(var $=0;$<A.length;$++)D.on(A[$],this.emit.bind(this,A[$]));return this._read=function(te){i("wrapped _read",te),ee&&(ee=!1,D.resume())},this},typeof Symbol=="function"&&(w.prototype[Symbol.asyncIterator]=function(){return a===void 0&&(a=h("./internal/streams/async_iterator")),a(this)}),Object.defineProperty(w.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(w.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(w.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(D){this._readableState&&(this._readableState.flowing=D)}}),w._fromList=X,Object.defineProperty(w.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(w.from=function(D,B){return c===void 0&&(c=h("./internal/streams/from")),c(w,D,B)})}).call(this)}).call(this,h("_process"),typeof La!="undefined"?La:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"../errors":555,"./_stream_duplex":556,"./internal/streams/async_iterator":561,"./internal/streams/buffer_list":562,"./internal/streams/destroy":563,"./internal/streams/from":565,"./internal/streams/state":567,"./internal/streams/stream":568,_process:514,buffer:117,events:116,inherits:439,"string_decoder/":569,util:115}],559:[function(h,N,H){N.exports=i;var t=h("../errors").codes,m=t.ERR_METHOD_NOT_IMPLEMENTED,g=t.ERR_MULTIPLE_CALLBACK,p=t.ERR_TRANSFORM_ALREADY_TRANSFORMING,e=t.ERR_TRANSFORM_WITH_LENGTH_0,f=h("./_stream_duplex");function u(a,c){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(n===null)return this.emit("error",new g);r.writechunk=null,r.writecb=null,c!=null&&this.push(c),n(a);var d=this._readableState;d.reading=!1,(d.needReadable||d.length<d.highWaterMark)&&this._read(d.highWaterMark)}function i(a){if(!(this instanceof i))return new i(a);f.call(this,a),this._transformState={afterTransform:u.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,a&&(typeof a.transform=="function"&&(this._transform=a.transform),typeof a.flush=="function"&&(this._flush=a.flush)),this.on("prefinish",s)}function s(){var a=this;typeof this._flush!="function"||this._readableState.destroyed?o(this,null,null):this._flush(function(c,r){o(a,c,r)})}function o(a,c,r){if(c)return a.emit("error",c);if(r!=null&&a.push(r),a._writableState.length)throw new e;if(a._transformState.transforming)throw new p;return a.push(null)}h("inherits")(i,f),i.prototype.push=function(a,c){return this._transformState.needTransform=!1,f.prototype.push.call(this,a,c)},i.prototype._transform=function(a,c,r){r(new m("_transform()"))},i.prototype._write=function(a,c,r){var n=this._transformState;if(n.writecb=r,n.writechunk=a,n.writeencoding=c,!n.transforming){var d=this._readableState;(n.needTransform||d.needReadable||d.length<d.highWaterMark)&&this._read(d.highWaterMark)}},i.prototype._read=function(a){var c=this._transformState;c.writechunk===null||c.transforming?c.needTransform=!0:(c.transforming=!0,this._transform(c.writechunk,c.writeencoding,c.afterTransform))},i.prototype._destroy=function(a,c){f.prototype._destroy.call(this,a,function(r){c(r)})}},{"../errors":555,"./_stream_duplex":556,inherits:439}],560:[function(h,N,H){(function(t,m){(function(){function g(F){var j=this;this.next=null,this.entry=null,this.finish=function(){(function(W,Z,Q){var X=W.entry;for(W.entry=null;X;){var G=X.callback;Z.pendingcb--,G(Q),X=X.next}Z.corkedRequestsFree.next=W})(j,F)}}var p;N.exports=w,w.WritableState=S;var e={deprecate:h("util-deprecate")},f=h("./internal/streams/stream"),u=h("buffer").Buffer,i=m.Uint8Array||function(){},s,o=h("./internal/streams/destroy"),a=h("./internal/streams/state").getHighWaterMark,c=h("../errors").codes,r=c.ERR_INVALID_ARG_TYPE,n=c.ERR_METHOD_NOT_IMPLEMENTED,d=c.ERR_MULTIPLE_CALLBACK,l=c.ERR_STREAM_CANNOT_PIPE,y=c.ERR_STREAM_DESTROYED,v=c.ERR_STREAM_NULL_VALUES,_=c.ERR_STREAM_WRITE_AFTER_END,x=c.ERR_UNKNOWN_ENCODING,T=o.errorOrDestroy;function A(){}function S(F,j,W){p=p||h("./_stream_duplex"),F=F||{},typeof W!="boolean"&&(W=j instanceof p),this.objectMode=!!F.objectMode,W&&(this.objectMode=this.objectMode||!!F.writableObjectMode),this.highWaterMark=a(this,F,"writableHighWaterMark",W),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var Z=F.decodeStrings===!1;this.decodeStrings=!Z,this.defaultEncoding=F.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(Q){(function(X,G){var Y=X._writableState,K=Y.sync,D=Y.writecb;if(typeof D!="function")throw new d;if(function(q){q.writing=!1,q.writecb=null,q.length-=q.writelen,q.writelen=0}(Y),G)(function(q,ee,J,$,te){--ee.pendingcb,J?(t.nextTick(te,$),t.nextTick(O,q,ee),q._writableState.errorEmitted=!0,T(q,$)):(te($),q._writableState.errorEmitted=!0,T(q,$),O(q,ee))})(X,Y,K,G,D);else{var B=M(Y)||X.destroyed;B||Y.corked||Y.bufferProcessing||!Y.bufferedRequest||C(X,Y),K?t.nextTick(k,X,Y,B,D):k(X,Y,B,D)}})(j,Q)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=F.emitClose!==!1,this.autoDestroy=!!F.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new g(this)}function w(F){var j=this instanceof(p=p||h("./_stream_duplex"));if(!j&&!s.call(w,this))return new w(F);this._writableState=new S(F,this,j),this.writable=!0,F&&(typeof F.write=="function"&&(this._write=F.write),typeof F.writev=="function"&&(this._writev=F.writev),typeof F.destroy=="function"&&(this._destroy=F.destroy),typeof F.final=="function"&&(this._final=F.final)),f.call(this)}function L(F,j,W,Z,Q,X,G){j.writelen=Z,j.writecb=G,j.writing=!0,j.sync=!0,j.destroyed?j.onwrite(new y("write")):W?F._writev(Q,j.onwrite):F._write(Q,X,j.onwrite),j.sync=!1}function k(F,j,W,Z){W||function(Q,X){X.length===0&&X.needDrain&&(X.needDrain=!1,Q.emit("drain"))}(F,j),j.pendingcb--,Z(),O(F,j)}function C(F,j){j.bufferProcessing=!0;var W=j.bufferedRequest;if(F._writev&&W&&W.next){var Z=j.bufferedRequestCount,Q=new Array(Z),X=j.corkedRequestsFree;X.entry=W;for(var G=0,Y=!0;W;)Q[G]=W,W.isBuf||(Y=!1),W=W.next,G+=1;Q.allBuffers=Y,L(F,j,!0,j.length,Q,"",X.finish),j.pendingcb++,j.lastBufferedRequest=null,X.next?(j.corkedRequestsFree=X.next,X.next=null):j.corkedRequestsFree=new g(j),j.bufferedRequestCount=0}else{for(;W;){var K=W.chunk,D=W.encoding,B=W.callback;if(L(F,j,!1,j.objectMode?1:K.length,K,D,B),W=W.next,j.bufferedRequestCount--,j.writing)break}W===null&&(j.lastBufferedRequest=null)}j.bufferedRequest=W,j.bufferProcessing=!1}function M(F){return F.ending&&F.length===0&&F.bufferedRequest===null&&!F.finished&&!F.writing}function P(F,j){F._final(function(W){j.pendingcb--,W&&T(F,W),j.prefinished=!0,F.emit("prefinish"),O(F,j)})}function O(F,j){var W=M(j);if(W&&(function(Q,X){X.prefinished||X.finalCalled||(typeof Q._final!="function"||X.destroyed?(X.prefinished=!0,Q.emit("prefinish")):(X.pendingcb++,X.finalCalled=!0,t.nextTick(P,Q,X)))}(F,j),j.pendingcb===0&&(j.finished=!0,F.emit("finish"),j.autoDestroy))){var Z=F._readableState;(!Z||Z.autoDestroy&&Z.endEmitted)&&F.destroy()}return W}h("inherits")(w,f),S.prototype.getBuffer=function(){for(var F=this.bufferedRequest,j=[];F;)j.push(F),F=F.next;return j},function(){try{Object.defineProperty(S.prototype,"buffer",{get:e.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(F){}}(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(s=Function.prototype[Symbol.hasInstance],Object.defineProperty(w,Symbol.hasInstance,{value:function(F){return!!s.call(this,F)||this===w&&F&&F._writableState instanceof S}})):s=function(F){return F instanceof this},w.prototype.pipe=function(){T(this,new l)},w.prototype.write=function(F,j,W){var Z,Q=this._writableState,X=!1,G=!Q.objectMode&&(Z=F,u.isBuffer(Z)||Z instanceof i);return G&&!u.isBuffer(F)&&(F=function(Y){return u.from(Y)}(F)),typeof j=="function"&&(W=j,j=null),G?j="buffer":j||(j=Q.defaultEncoding),typeof W!="function"&&(W=A),Q.ending?function(Y,K){var D=new _;T(Y,D),t.nextTick(K,D)}(this,W):(G||function(Y,K,D,B){var q;return D===null?q=new v:typeof D=="string"||K.objectMode||(q=new r("chunk",["string","Buffer"],D)),!q||(T(Y,q),t.nextTick(B,q),!1)}(this,Q,F,W))&&(Q.pendingcb++,X=function(Y,K,D,B,q,ee){if(!D){var J=function(ae,he,se){return ae.objectMode||ae.decodeStrings===!1||typeof he!="string"||(he=u.from(he,se)),he}(K,B,q);B!==J&&(D=!0,q="buffer",B=J)}var $=K.objectMode?1:B.length;K.length+=$;var te=K.length<K.highWaterMark;if(te||(K.needDrain=!0),K.writing||K.corked){var ie=K.lastBufferedRequest;K.lastBufferedRequest={chunk:B,encoding:q,isBuf:D,callback:ee,next:null},ie?ie.next=K.lastBufferedRequest:K.bufferedRequest=K.lastBufferedRequest,K.bufferedRequestCount+=1}else L(Y,K,!1,$,B,q,ee);return te}(this,Q,G,F,j,W)),X},w.prototype.cork=function(){this._writableState.corked++},w.prototype.uncork=function(){var F=this._writableState;F.corked&&(F.corked--,F.writing||F.corked||F.bufferProcessing||!F.bufferedRequest||C(this,F))},w.prototype.setDefaultEncoding=function(F){if(typeof F=="string"&&(F=F.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((F+"").toLowerCase())>-1))throw new x(F);return this._writableState.defaultEncoding=F,this},Object.defineProperty(w.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(w.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),w.prototype._write=function(F,j,W){W(new n("_write()"))},w.prototype._writev=null,w.prototype.end=function(F,j,W){var Z=this._writableState;return typeof F=="function"?(W=F,F=null,j=null):typeof j=="function"&&(W=j,j=null),F!=null&&this.write(F,j),Z.corked&&(Z.corked=1,this.uncork()),Z.ending||function(Q,X,G){X.ending=!0,O(Q,X),G&&(X.finished?t.nextTick(G):Q.once("finish",G)),X.ended=!0,Q.writable=!1}(this,Z,W),this},Object.defineProperty(w.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(w.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(F){this._writableState&&(this._writableState.destroyed=F)}}),w.prototype.destroy=o.destroy,w.prototype._undestroy=o.undestroy,w.prototype._destroy=function(F,j){j(F)}}).call(this)}).call(this,h("_process"),typeof La!="undefined"?La:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"../errors":555,"./_stream_duplex":556,"./internal/streams/destroy":563,"./internal/streams/state":567,"./internal/streams/stream":568,_process:514,buffer:117,inherits:439,"util-deprecate":606}],561:[function(h,N,H){(function(t){(function(){var m;function g(y,v,_){return v in y?Object.defineProperty(y,v,{value:_,enumerable:!0,configurable:!0,writable:!0}):y[v]=_,y}var p=h("./end-of-stream"),e=Symbol("lastResolve"),f=Symbol("lastReject"),u=Symbol("error"),i=Symbol("ended"),s=Symbol("lastPromise"),o=Symbol("handlePromise"),a=Symbol("stream");function c(y,v){return{value:y,done:v}}function r(y){var v=y[e];if(v!==null){var _=y[a].read();_!==null&&(y[s]=null,y[e]=null,y[f]=null,v(c(_,!1)))}}function n(y){t.nextTick(r,y)}var d=Object.getPrototypeOf(function(){}),l=Object.setPrototypeOf((g(m={get stream(){return this[a]},next:function(){var y=this,v=this[u];if(v!==null)return Promise.reject(v);if(this[i])return Promise.resolve(c(void 0,!0));if(this[a].destroyed)return new Promise(function(A,S){t.nextTick(function(){y[u]?S(y[u]):A(c(void 0,!0))})});var _,x=this[s];if(x)_=new Promise(function(A,S){return function(w,L){A.then(function(){S[i]?w(c(void 0,!0)):S[o](w,L)},L)}}(x,this));else{var T=this[a].read();if(T!==null)return Promise.resolve(c(T,!1));_=new Promise(this[o])}return this[s]=_,_}},Symbol.asyncIterator,function(){return this}),g(m,"return",function(){var y=this;return new Promise(function(v,_){y[a].destroy(null,function(x){x?_(x):v(c(void 0,!0))})})}),m),d);N.exports=function(y){var v,_=Object.create(l,(g(v={},a,{value:y,writable:!0}),g(v,e,{value:null,writable:!0}),g(v,f,{value:null,writable:!0}),g(v,u,{value:null,writable:!0}),g(v,i,{value:y._readableState.endEmitted,writable:!0}),g(v,o,{value:function(x,T){var A=_[a].read();A?(_[s]=null,_[e]=null,_[f]=null,x(c(A,!1))):(_[e]=x,_[f]=T)},writable:!0}),v));return _[s]=null,p(y,function(x){if(x&&x.code!=="ERR_STREAM_PREMATURE_CLOSE"){var T=_[f];return T!==null&&(_[s]=null,_[e]=null,_[f]=null,T(x)),void(_[u]=x)}var A=_[e];A!==null&&(_[s]=null,_[e]=null,_[f]=null,A(c(void 0,!0))),_[i]=!0}),y.on("readable",n.bind(null,_)),_}}).call(this)}).call(this,h("_process"))},{"./end-of-stream":564,_process:514}],562:[function(h,N,H){function t(u,i){var s=Object.keys(u);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(u);i&&(o=o.filter(function(a){return Object.getOwnPropertyDescriptor(u,a).enumerable})),s.push.apply(s,o)}return s}function m(u,i,s){return i in u?Object.defineProperty(u,i,{value:s,enumerable:!0,configurable:!0,writable:!0}):u[i]=s,u}function g(u,i){for(var s=0;s<i.length;s++){var o=i[s];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(u,o.key,o)}}var p=h("buffer").Buffer,e=h("util").inspect,f=e&&e.custom||"inspect";N.exports=function(){function u(){(function(o,a){if(!(o instanceof a))throw new TypeError("Cannot call a class as a function")})(this,u),this.head=null,this.tail=null,this.length=0}var i,s;return i=u,(s=[{key:"push",value:function(o){var a={data:o,next:null};this.length>0?this.tail.next=a:this.head=a,this.tail=a,++this.length}},{key:"unshift",value:function(o){var a={data:o,next:this.head};this.length===0&&(this.tail=a),this.head=a,++this.length}},{key:"shift",value:function(){if(this.length!==0){var o=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,o}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(o){if(this.length===0)return"";for(var a=this.head,c=""+a.data;a=a.next;)c+=o+a.data;return c}},{key:"concat",value:function(o){if(this.length===0)return p.alloc(0);for(var a,c,r,n=p.allocUnsafe(o>>>0),d=this.head,l=0;d;)a=d.data,c=n,r=l,p.prototype.copy.call(a,c,r),l+=d.data.length,d=d.next;return n}},{key:"consume",value:function(o,a){var c;return o<this.head.data.length?(c=this.head.data.slice(0,o),this.head.data=this.head.data.slice(o)):c=o===this.head.data.length?this.shift():a?this._getString(o):this._getBuffer(o),c}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(o){var a=this.head,c=1,r=a.data;for(o-=r.length;a=a.next;){var n=a.data,d=o>n.length?n.length:o;if(d===n.length?r+=n:r+=n.slice(0,o),(o-=d)==0){d===n.length?(++c,a.next?this.head=a.next:this.head=this.tail=null):(this.head=a,a.data=n.slice(d));break}++c}return this.length-=c,r}},{key:"_getBuffer",value:function(o){var a=p.allocUnsafe(o),c=this.head,r=1;for(c.data.copy(a),o-=c.data.length;c=c.next;){var n=c.data,d=o>n.length?n.length:o;if(n.copy(a,a.length-o,0,d),(o-=d)==0){d===n.length?(++r,c.next?this.head=c.next:this.head=this.tail=null):(this.head=c,c.data=n.slice(d));break}++r}return this.length-=r,a}},{key:f,value:function(o,a){return e(this,function(c){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?t(Object(n),!0).forEach(function(d){m(c,d,n[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach(function(d){Object.defineProperty(c,d,Object.getOwnPropertyDescriptor(n,d))})}return c}({},a,{depth:0,customInspect:!1}))}}])&&g(i.prototype,s),u}()},{buffer:117,util:115}],563:[function(h,N,H){(function(t){(function(){function m(e,f){p(e,f),g(e)}function g(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function p(e,f){e.emit("error",f)}N.exports={destroy:function(e,f){var u=this,i=this._readableState&&this._readableState.destroyed,s=this._writableState&&this._writableState.destroyed;return i||s?(f?f(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,t.nextTick(p,this,e)):t.nextTick(p,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(o){!f&&o?u._writableState?u._writableState.errorEmitted?t.nextTick(g,u):(u._writableState.errorEmitted=!0,t.nextTick(m,u,o)):t.nextTick(m,u,o):f?(t.nextTick(g,u),f(o)):t.nextTick(g,u)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,f){var u=e._readableState,i=e._writableState;u&&u.autoDestroy||i&&i.autoDestroy?e.destroy(f):e.emit("error",f)}}}).call(this)}).call(this,h("_process"))},{_process:514}],564:[function(h,N,H){var t=h("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function m(){}N.exports=function g(p,e,f){if(typeof e=="function")return g(p,null,e);e||(e={}),f=function(y){var v=!1;return function(){if(!v){v=!0;for(var _=arguments.length,x=new Array(_),T=0;T<_;T++)x[T]=arguments[T];y.apply(this,x)}}}(f||m);var u=e.readable||e.readable!==!1&&p.readable,i=e.writable||e.writable!==!1&&p.writable,s=function(){p.writable||a()},o=p._writableState&&p._writableState.finished,a=function(){i=!1,o=!0,u||f.call(p)},c=p._readableState&&p._readableState.endEmitted,r=function(){u=!1,c=!0,i||f.call(p)},n=function(y){f.call(p,y)},d=function(){var y;return u&&!c?(p._readableState&&p._readableState.ended||(y=new t),f.call(p,y)):i&&!o?(p._writableState&&p._writableState.ended||(y=new t),f.call(p,y)):void 0},l=function(){p.req.on("finish",a)};return function(y){return y.setHeader&&typeof y.abort=="function"}(p)?(p.on("complete",a),p.on("abort",d),p.req?l():p.on("request",l)):i&&!p._writableState&&(p.on("end",s),p.on("close",s)),p.on("end",r),p.on("finish",a),e.error!==!1&&p.on("error",n),p.on("close",d),function(){p.removeListener("complete",a),p.removeListener("abort",d),p.removeListener("request",l),p.req&&p.req.removeListener("finish",a),p.removeListener("end",s),p.removeListener("close",s),p.removeListener("finish",a),p.removeListener("end",r),p.removeListener("error",n),p.removeListener("close",d)}}},{"../../../errors":555}],565:[function(h,N,H){N.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],566:[function(h,N,H){var t,m=h("../../../errors").codes,g=m.ERR_MISSING_ARGS,p=m.ERR_STREAM_DESTROYED;function e(o){if(o)throw o}function f(o,a,c,r){r=function(l){var y=!1;return function(){y||(y=!0,l.apply(void 0,arguments))}}(r);var n=!1;o.on("close",function(){n=!0}),t===void 0&&(t=h("./end-of-stream")),t(o,{readable:a,writable:c},function(l){if(l)return r(l);n=!0,r()});var d=!1;return function(l){if(!n&&!d)return d=!0,function(y){return y.setHeader&&typeof y.abort=="function"}(o)?o.abort():typeof o.destroy=="function"?o.destroy():void r(l||new p("pipe"))}}function u(o){o()}function i(o,a){return o.pipe(a)}function s(o){return o.length?typeof o[o.length-1]!="function"?e:o.pop():e}N.exports=function(){for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];var r,n=s(a);if(Array.isArray(a[0])&&(a=a[0]),a.length<2)throw new g("streams");var d=a.map(function(l,y){var v=y<a.length-1;return f(l,v,y>0,function(_){r||(r=_),_&&d.forEach(u),v||(d.forEach(u),n(r))})});return a.reduce(i)}},{"../../../errors":555,"./end-of-stream":564}],567:[function(h,N,H){var t=h("../../../errors").codes.ERR_INVALID_OPT_VALUE;N.exports={getHighWaterMark:function(m,g,p,e){var f=function(u,i,s){return u.highWaterMark!=null?u.highWaterMark:i?u[s]:null}(g,e,p);if(f!=null){if(!isFinite(f)||Math.floor(f)!==f||f<0)throw new t(e?p:"highWaterMark",f);return Math.floor(f)}return m.objectMode?16:16384}}},{"../../../errors":555}],568:[function(h,N,H){N.exports=h("events").EventEmitter},{events:116}],569:[function(h,N,H){var t=h("safe-buffer").Buffer,m=t.isEncoding||function(c){switch((c=""+c)&&c.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function g(c){var r;switch(this.encoding=function(n){var d=function(l){if(!l)return"utf8";for(var y;;)switch(l){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return l;default:if(y)return;l=(""+l).toLowerCase(),y=!0}}(n);if(typeof d!="string"&&(t.isEncoding===m||!m(n)))throw new Error("Unknown encoding: "+n);return d||n}(c),this.encoding){case"utf16le":this.text=f,this.end=u,r=4;break;case"utf8":this.fillLast=e,r=4;break;case"base64":this.text=i,this.end=s,r=3;break;default:return this.write=o,void(this.end=a)}this.lastNeed=0,this.lastTotal=0,this.lastChar=t.allocUnsafe(r)}function p(c){return c<=127?0:c>>5==6?2:c>>4==14?3:c>>3==30?4:c>>6==2?-1:-2}function e(c){var r=this.lastTotal-this.lastNeed,n=function(d,l,y){if((192&l[0])!=128)return d.lastNeed=0,"\uFFFD";if(d.lastNeed>1&&l.length>1){if((192&l[1])!=128)return d.lastNeed=1,"\uFFFD";if(d.lastNeed>2&&l.length>2&&(192&l[2])!=128)return d.lastNeed=2,"\uFFFD"}}(this,c);return n!==void 0?n:this.lastNeed<=c.length?(c.copy(this.lastChar,r,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(c.copy(this.lastChar,r,0,c.length),void(this.lastNeed-=c.length))}function f(c,r){if((c.length-r)%2==0){var n=c.toString("utf16le",r);if(n){var d=n.charCodeAt(n.length-1);if(d>=55296&&d<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=c[c.length-2],this.lastChar[1]=c[c.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=c[c.length-1],c.toString("utf16le",r,c.length-1)}function u(c){var r=c&&c.length?this.write(c):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return r+this.lastChar.toString("utf16le",0,n)}return r}function i(c,r){var n=(c.length-r)%3;return n===0?c.toString("base64",r):(this.lastNeed=3-n,this.lastTotal=3,n===1?this.lastChar[0]=c[c.length-1]:(this.lastChar[0]=c[c.length-2],this.lastChar[1]=c[c.length-1]),c.toString("base64",r,c.length-n))}function s(c){var r=c&&c.length?this.write(c):"";return this.lastNeed?r+this.lastChar.toString("base64",0,3-this.lastNeed):r}function o(c){return c.toString(this.encoding)}function a(c){return c&&c.length?this.write(c):""}H.StringDecoder=g,g.prototype.write=function(c){if(c.length===0)return"";var r,n;if(this.lastNeed){if((r=this.fillLast(c))===void 0)return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<c.length?r?r+this.text(c,n):this.text(c,n):r||""},g.prototype.end=function(c){var r=c&&c.length?this.write(c):"";return this.lastNeed?r+"\uFFFD":r},g.prototype.text=function(c,r){var n=function(l,y,v){var _=y.length-1;if(_<v)return 0;var x=p(y[_]);return x>=0?(x>0&&(l.lastNeed=x-1),x):--_<v||x===-2?0:(x=p(y[_]))>=0?(x>0&&(l.lastNeed=x-2),x):--_<v||x===-2?0:(x=p(y[_]))>=0?(x>0&&(x===2?x=0:l.lastNeed=x-3),x):0}(this,c,r);if(!this.lastNeed)return c.toString("utf8",r);this.lastTotal=n;var d=c.length-(n-this.lastNeed);return c.copy(this.lastChar,0,d),c.toString("utf8",r,d)},g.prototype.fillLast=function(c){if(this.lastNeed<=c.length)return c.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);c.copy(this.lastChar,this.lastTotal-this.lastNeed,0,c.length),this.lastNeed-=c.length}},{"safe-buffer":540}],570:[function(h,N,H){(function(t,m){(function(){var g=h("assert"),p=h("debug")("stream-parser");N.exports=function(n){var d=n&&typeof n._transform=="function",l=n&&typeof n._write=="function";if(!d&&!l)throw new Error("must pass a Writable or Transform stream in");p("extending Parser into stream"),n._bytes=f,n._skipBytes=u,d&&(n._passthrough=i),d?n._transform=o:n._write=s};function e(n){p("initializing parser stream"),n._parserBytesLeft=0,n._parserBuffers=[],n._parserBuffered=0,n._parserState=-1,n._parserCallback=null,typeof n.push=="function"&&(n._parserOutput=n.push.bind(n)),n._parserInit=!0}function f(n,d){g(!this._parserCallback,'there is already a "callback" set!'),g(isFinite(n)&&n>0,'can only buffer a finite number of bytes > 0, got "'+n+'"'),this._parserInit||e(this),p("buffering %o bytes",n),this._parserBytesLeft=n,this._parserCallback=d,this._parserState=0}function u(n,d){g(!this._parserCallback,'there is already a "callback" set!'),g(n>0,'can only skip > 0 bytes, got "'+n+'"'),this._parserInit||e(this),p("skipping %o bytes",n),this._parserBytesLeft=n,this._parserCallback=d,this._parserState=1}function i(n,d){g(!this._parserCallback,'There is already a "callback" set!'),g(n>0,'can only pass through > 0 bytes, got "'+n+'"'),this._parserInit||e(this),p("passing through %o bytes",n),this._parserBytesLeft=n,this._parserCallback=d,this._parserState=2}function s(n,d,l){this._parserInit||e(this),p("write(%o bytes)",n.length),typeof d=="function"&&(l=d),c(this,n,null,l)}function o(n,d,l){this._parserInit||e(this),p("transform(%o bytes)",n.length),typeof d!="function"&&(d=this._parserOutput),c(this,n,d,l)}function a(n,d,l,y){if(n._parserBytesLeft-=d.length,p("%o bytes left for stream piece",n._parserBytesLeft),n._parserState===0?(n._parserBuffers.push(d),n._parserBuffered+=d.length):n._parserState===2&&l(d),n._parserBytesLeft!==0)return y;var v=n._parserCallback;if(v&&n._parserState===0&&n._parserBuffers.length>1&&(d=m.concat(n._parserBuffers,n._parserBuffered)),n._parserState!==0&&(d=null),n._parserCallback=null,n._parserBuffered=0,n._parserState=-1,n._parserBuffers.splice(0),v){var _=[];d&&_.push(d),l&&_.push(l);var x=v.length>_.length;x&&_.push(r(y));var T=v.apply(n,_);if(!x||y===T)return y}}var c=r(function n(d,l,y,v){return d._parserBytesLeft<=0?v(new Error("got data but not currently parsing anything")):l.length<=d._parserBytesLeft?function(){return a(d,l,y,v)}:function(){var _=l.slice(0,d._parserBytesLeft);return a(d,_,y,function(x){return x?v(x):l.length>_.length?function(){return n(d,l.slice(_.length),y,v)}:void 0})}});function r(n){return function(){for(var d=n.apply(this,arguments);typeof d=="function";)d=d();return d}}}).call(this)}).call(this,h("_process"),h("buffer").Buffer)},{_process:514,assert:80,buffer:117,debug:571}],571:[function(h,N,H){(function(t){(function(){function m(){var g;try{g=H.storage.debug}catch(p){}return!g&&t!==void 0&&"env"in t&&(g=t.env.DEBUG),g}(H=N.exports=h("./debug")).log=function(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},H.formatArgs=function(g){var p=this.useColors;if(g[0]=(p?"%c":"")+this.namespace+(p?" %c":" ")+g[0]+(p?"%c ":" ")+"+"+H.humanize(this.diff),!!p){var e="color: "+this.color;g.splice(1,0,e,"color: inherit");var f=0,u=0;g[0].replace(/%[a-zA-Z%]/g,function(i){i!=="%%"&&(f++,i==="%c"&&(u=f))}),g.splice(u,0,e)}},H.save=function(g){try{g==null?H.storage.removeItem("debug"):H.storage.debug=g}catch(p){}},H.load=m,H.useColors=function(){return typeof window!="undefined"&&window.process&&window.process.type==="renderer"?!0:typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},H.storage=typeof chrome!="undefined"&&chrome.storage!==void 0?chrome.storage.local:function(){try{return window.localStorage}catch(g){}}(),H.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],H.formatters.j=function(g){try{return JSON.stringify(g)}catch(p){return"[UnexpectedJSONParseError]: "+p.message}},H.enable(m())}).call(this)}).call(this,h("_process"))},{"./debug":572,_process:514}],572:[function(h,N,H){var t;function m(g){function p(){if(p.enabled){var e=p,f=+new Date,u=f-(t||f);e.diff=u,e.prev=t,e.curr=f,t=f;for(var i=new Array(arguments.length),s=0;s<i.length;s++)i[s]=arguments[s];i[0]=H.coerce(i[0]),typeof i[0]!="string"&&i.unshift("%O");var o=0;i[0]=i[0].replace(/%([a-zA-Z%])/g,function(c,r){if(c==="%%")return c;o++;var n=H.formatters[r];if(typeof n=="function"){var d=i[o];c=n.call(e,d),i.splice(o,1),o--}return c}),H.formatArgs.call(e,i);var a=p.log||H.log||console.log.bind(console);a.apply(e,i)}}return p.namespace=g,p.enabled=H.enabled(g),p.useColors=H.useColors(),p.color=function(e){var f,u=0;for(f in e)u=(u<<5)-u+e.charCodeAt(f),u|=0;return H.colors[Math.abs(u)%H.colors.length]}(g),typeof H.init=="function"&&H.init(p),p}(H=N.exports=m.debug=m.default=m).coerce=function(g){return g instanceof Error?g.stack||g.message:g},H.disable=function(){H.enable("")},H.enable=function(g){H.save(g),H.names=[],H.skips=[];for(var p=(typeof g=="string"?g:"").split(/[\s,]+/),e=p.length,f=0;f<e;f++)p[f]&&((g=p[f].replace(/\*/g,".*?"))[0]==="-"?H.skips.push(new RegExp("^"+g.substr(1)+"$")):H.names.push(new RegExp("^"+g+"$")))},H.enabled=function(g){var p,e;for(p=0,e=H.skips.length;p<e;p++)if(H.skips[p].test(g))return!1;for(p=0,e=H.names.length;p<e;p++)if(H.names[p].test(g))return!0;return!1},H.humanize=h("ms"),H.names=[],H.skips=[],H.formatters={}},{ms:573}],573:[function(h,N,H){var t=1e3,m=6e4,g=60*m,p=24*g;function e(f,u,i){if(!(f<u))return f<1.5*u?Math.floor(f/u)+" "+i:Math.ceil(f/u)+" "+i+"s"}N.exports=function(f,u){u=u||{};var i,s=typeof f;if(s==="string"&&f.length>0)return function(o){if(!((o=String(o)).length>100)){var a=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(o);if(!!a){var c=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*c;case"days":case"day":case"d":return c*p;case"hours":case"hour":case"hrs":case"hr":case"h":return c*g;case"minutes":case"minute":case"mins":case"min":case"m":return c*m;case"seconds":case"second":case"secs":case"sec":case"s":return c*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}}}(f);if(s==="number"&&isNaN(f)===!1)return u.long?e(i=f,p,"day")||e(i,g,"hour")||e(i,m,"minute")||e(i,t,"second")||i+" ms":function(o){return o>=p?Math.round(o/p)+"d":o>=g?Math.round(o/g)+"h":o>=m?Math.round(o/m)+"m":o>=t?Math.round(o/t)+"s":o+"ms"}(f);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(f))}},{}],574:[function(h,N,H){var t=h("parenthesis");N.exports=function(m,g,p){if(m==null)throw Error("First argument should be a string");if(g==null)throw Error("Separator should be a string or a RegExp");p?(typeof p=="string"||Array.isArray(p))&&(p={ignore:p}):p={},p.escape==null&&(p.escape=!0),p.ignore==null?p.ignore=["[]","()","{}","<>",'""',"''","``","\u201C\u201D","\xAB\xBB"]:(typeof p.ignore=="string"&&(p.ignore=[p.ignore]),p.ignore=p.ignore.map(function(a){return a.length===1&&(a+=a),a}));var e=t.parse(m,{flat:!0,brackets:p.ignore}),f=e[0].split(g);if(p.escape){for(var u=[],i=0;i<f.length;i++){var s=f[i],o=f[i+1];s[s.length-1]==="\\"&&s[s.length-2]!=="\\"?(u.push(s+g+o),i++):u.push(s)}f=u}for(i=0;i<f.length;i++)e[0]=f[i],f[i]=t.stringify(e,{flat:!0});return f}},{parenthesis:480}],575:[function(h,N,H){N.exports=function(t){for(var m=t.length,g=new Array(m),p=new Array(m),e=new Array(m),f=new Array(m),u=new Array(m),i=new Array(m),s=0;s<m;++s)g[s]=-1,p[s]=0,e[s]=!1,f[s]=0,u[s]=-1,i[s]=[];var o,a=0,c=[],r=[];function n(y){var v=[y],_=[y];for(g[y]=p[y]=a,e[y]=!0,a+=1;_.length>0;){y=_[_.length-1];var x=t[y];if(f[y]<x.length){for(var T=f[y];T<x.length;++T){var A=x[T];if(g[A]<0){g[A]=p[A]=a,e[A]=!0,a+=1,v.push(A),_.push(A);break}e[A]&&(p[y]=0|Math.min(p[y],p[A])),u[A]>=0&&i[y].push(u[A])}f[y]=T}else{if(p[y]===g[y]){var S=[],w=[],L=0;for(T=v.length-1;T>=0;--T){var k=v[T];if(e[k]=!1,S.push(k),w.push(i[k]),L+=i[k].length,u[k]=c.length,k===y){v.length=T;break}}c.push(S);var C=new Array(L);for(T=0;T<w.length;T++)for(var M=0;M<w[T].length;M++)C[--L]=w[T][M];r.push(C)}_.pop()}}}for(s=0;s<m;++s)g[s]<0&&n(s);for(s=0;s<r.length;s++){var d=r[s];if(d.length!==0){d.sort(function(y,v){return y-v}),o=[d[0]];for(var l=1;l<d.length;l++)d[l]!==d[l-1]&&o.push(d[l]);r[s]=o}}return{components:c,adjacencyList:r}}},{}],576:[function(h,N,H){N.exports=function(e,f){if(e.dimension<=0)return{positions:[],cells:[]};if(e.dimension===1)return function(s,o){for(var a=m(s,o),c=a.length,r=new Array(c),n=new Array(c),d=0;d<c;++d)r[d]=[a[d]],n[d]=[d];return{positions:r,cells:n}}(e,f);var u=e.order.join()+"-"+e.dtype,i=p[u];return f=+f||0,i||(i=p[u]=function(s,o){var a=s.length+"d",c=g[a];if(c)return c(t,s,o)}(e.order,e.dtype)),i(e,f)};var t=h("ndarray-extract-contour"),m=h("zero-crossings"),g={"2d":function(e,f,u){var i=e({order:f,scalarArguments:3,getters:u==="generic"?[0]:void 0,phase:function(s,o,a,c){return s>c|0},vertex:function(s,o,a,c,r,n,d,l,y,v,_,x,T){var A=(d<<0)+(l<<1)+(y<<2)+(v<<3)|0;if(A!==0&&A!==15)switch(A){case 0:_.push([s-.5,o-.5]);break;case 1:_.push([s-.25-.25*(c+a-2*T)/(a-c),o-.25-.25*(r+a-2*T)/(a-r)]);break;case 2:_.push([s-.75-.25*(-c-a+2*T)/(c-a),o-.25-.25*(n+c-2*T)/(c-n)]);break;case 3:_.push([s-.5,o-.5-.5*(r+a+n+c-4*T)/(a-r+c-n)]);break;case 4:_.push([s-.25-.25*(n+r-2*T)/(r-n),o-.75-.25*(-r-a+2*T)/(r-a)]);break;case 5:_.push([s-.5-.5*(c+a+n+r-4*T)/(a-c+r-n),o-.5]);break;case 6:_.push([s-.5-.25*(-c-a+n+r)/(c-a+r-n),o-.5-.25*(-r-a+n+c)/(r-a+c-n)]);break;case 7:_.push([s-.75-.25*(n+r-2*T)/(r-n),o-.75-.25*(n+c-2*T)/(c-n)]);break;case 8:_.push([s-.75-.25*(-n-r+2*T)/(n-r),o-.75-.25*(-n-c+2*T)/(n-c)]);break;case 9:_.push([s-.5-.25*(c+a+-n-r)/(a-c+n-r),o-.5-.25*(r+a+-n-c)/(a-r+n-c)]);break;case 10:_.push([s-.5-.5*(-c-a-n-r+4*T)/(c-a+n-r),o-.5]);break;case 11:_.push([s-.25-.25*(-n-r+2*T)/(n-r),o-.75-.25*(r+a-2*T)/(a-r)]);break;case 12:_.push([s-.5,o-.5-.5*(-r-a-n-c+4*T)/(r-a+n-c)]);break;case 13:_.push([s-.75-.25*(c+a-2*T)/(a-c),o-.25-.25*(-n-c+2*T)/(n-c)]);break;case 14:_.push([s-.25-.25*(-c-a+2*T)/(c-a),o-.25-.25*(-r-a+2*T)/(r-a)]);break;case 15:_.push([s-.5,o-.5])}},cell:function(s,o,a,c,r,n,d,l,y){r?l.push([s,o]):l.push([o,s])}});return function(s,o){var a=[],c=[];return i(s,a,c,o),{positions:a,cells:c}}}},p={}},{"ndarray-extract-contour":464,"zero-crossings":631}],577:[function(h,N,H){Object.defineProperty(H,"__esModule",{value:!0});var t=function(f,u){if(Array.isArray(f))return f;if(Symbol.iterator in Object(f))return function(i,s){var o=[],a=!0,c=!1,r=void 0;try{for(var n,d=i[Symbol.iterator]();!(a=(n=d.next()).done)&&(o.push(n.value),!s||o.length!==s);a=!0);}catch(l){c=!0,r=l}finally{try{!a&&d.return&&d.return()}finally{if(c)throw r}}return o}(f,u);throw new TypeError("Invalid attempt to destructure non-iterable instance")},m=2*Math.PI,g=function(f,u,i,s,o,a,c){var r=f.x,n=f.y;return{x:s*(r*=u)-o*(n*=i)+a,y:o*r+s*n+c}},p=function(f,u){var i=u===1.5707963267948966?.551915024494:u===-1.5707963267948966?-.551915024494:4/3*Math.tan(u/4),s=Math.cos(f),o=Math.sin(f),a=Math.cos(f+u),c=Math.sin(f+u);return[{x:s-o*i,y:o+s*i},{x:a+c*i,y:c-a*i},{x:a,y:c}]},e=function(f,u,i,s){var o=f*i+u*s;return o>1&&(o=1),o<-1&&(o=-1),(f*s-u*i<0?-1:1)*Math.acos(o)};H.default=function(f){var u=f.px,i=f.py,s=f.cx,o=f.cy,a=f.rx,c=f.ry,r=f.xAxisRotation,n=r===void 0?0:r,d=f.largeArcFlag,l=d===void 0?0:d,y=f.sweepFlag,v=y===void 0?0:y,_=[];if(a===0||c===0)return[];var x=Math.sin(n*m/360),T=Math.cos(n*m/360),A=T*(u-s)/2+x*(i-o)/2,S=-x*(u-s)/2+T*(i-o)/2;if(A===0&&S===0)return[];a=Math.abs(a),c=Math.abs(c);var w=Math.pow(A,2)/Math.pow(a,2)+Math.pow(S,2)/Math.pow(c,2);w>1&&(a*=Math.sqrt(w),c*=Math.sqrt(w));var L=function(Z,Q,X,G,Y,K,D,B,q,ee,J,$){var te=Math.pow(Y,2),ie=Math.pow(K,2),ae=Math.pow(J,2),he=Math.pow($,2),se=te*ie-te*he-ie*ae;se<0&&(se=0),se/=te*he+ie*ae;var de=(se=Math.sqrt(se)*(D===B?-1:1))*Y/K*$,ce=se*-K/Y*J,ve=ee*de-q*ce+(Z+X)/2,ke=q*de+ee*ce+(Q+G)/2,Ee=(J-de)/Y,be=($-ce)/K,xe=(-J-de)/Y,ue=(-$-ce)/K,me=e(1,0,Ee,be),we=e(Ee,be,xe,ue);return B===0&&we>0&&(we-=m),B===1&&we<0&&(we+=m),[ve,ke,me,we]}(u,i,s,o,a,c,l,v,x,T,A,S),k=t(L,4),C=k[0],M=k[1],P=k[2],O=k[3],F=Math.abs(O)/(m/4);Math.abs(1-F)<1e-7&&(F=1);var j=Math.max(Math.ceil(F),1);O/=j;for(var W=0;W<j;W++)_.push(p(P,O)),P+=O;return _.map(function(Z){var Q=g(Z[0],a,c,T,x,C,M),X=Q.x,G=Q.y,Y=g(Z[1],a,c,T,x,C,M),K=Y.x,D=Y.y,B=g(Z[2],a,c,T,x,C,M);return{x1:X,y1:G,x2:K,y2:D,x:B.x,y:B.y}})},N.exports=H.default},{}],578:[function(h,N,H){var t=h("parse-svg-path"),m=h("abs-svg-path"),g=h("normalize-svg-path"),p=h("is-svg-path"),e=h("assert");N.exports=function(f){if(Array.isArray(f)&&f.length===1&&typeof f[0]=="string"&&(f=f[0]),typeof f=="string"&&(e(p(f),"String is not an SVG path."),f=t(f)),e(Array.isArray(f),"Argument should be a string or an array of path segments."),f=m(f),!(f=g(f)).length)return[0,0,0,0];for(var u=[1/0,1/0,-1/0,-1/0],i=0,s=f.length;i<s;i++)for(var o=f[i].slice(1),a=0;a<o.length;a+=2)o[a+0]<u[0]&&(u[0]=o[a+0]),o[a+1]<u[1]&&(u[1]=o[a+1]),o[a+0]>u[2]&&(u[2]=o[a+0]),o[a+1]>u[3]&&(u[3]=o[a+1]);return u}},{"abs-svg-path":71,assert:80,"is-svg-path":449,"normalize-svg-path":579,"parse-svg-path":482}],579:[function(h,N,H){N.exports=function(p){for(var e,f=[],u=0,i=0,s=0,o=0,a=null,c=null,r=0,n=0,d=0,l=p.length;d<l;d++){var y=p[d],v=y[0];switch(v){case"M":s=y[1],o=y[2];break;case"A":var _=t({px:r,py:n,cx:y[6],cy:y[7],rx:y[1],ry:y[2],xAxisRotation:y[3],largeArcFlag:y[4],sweepFlag:y[5]});if(!_.length)continue;for(var x,T=0;T<_.length;T++)x=_[T],y=["C",x.x1,x.y1,x.x2,x.y2,x.x,x.y],T<_.length-1&&f.push(y);break;case"S":var A=r,S=n;e!="C"&&e!="S"||(A+=A-u,S+=S-i),y=["C",A,S,y[1],y[2],y[3],y[4]];break;case"T":e=="Q"||e=="T"?(a=2*r-a,c=2*n-c):(a=r,c=n),y=g(r,n,a,c,y[1],y[2]);break;case"Q":a=y[1],c=y[2],y=g(r,n,y[1],y[2],y[3],y[4]);break;case"L":y=m(r,n,y[1],y[2]);break;case"H":y=m(r,n,y[1],n);break;case"V":y=m(r,n,r,y[1]);break;case"Z":y=m(r,n,s,o)}e=v,r=y[y.length-2],n=y[y.length-1],y.length>4?(u=y[y.length-4],i=y[y.length-3]):(u=r,i=n),f.push(y)}return f};var t=h("svg-arc-to-cubic-bezier");function m(p,e,f,u){return["C",p,e,f,u,f,u]}function g(p,e,f,u,i,s){return["C",p/3+2/3*f,e/3+2/3*u,i/3+2/3*f,s/3+2/3*u,i,s]}},{"svg-arc-to-cubic-bezier":577}],580:[function(h,N,H){var t,m=h("svg-path-bounds"),g=h("parse-svg-path"),p=h("draw-svg-path"),e=h("is-svg-path"),f=h("bitmap-sdf"),u=document.createElement("canvas"),i=u.getContext("2d");N.exports=function(s,o){if(!e(s))throw Error("Argument should be valid svg path string");o||(o={});var a,c;o.shape?(a=o.shape[0],c=o.shape[1]):(a=u.width=o.w||o.width||200,c=u.height=o.h||o.height||200);var r=Math.min(a,c),n=o.stroke||0,d=o.viewbox||o.viewBox||m(s),l=[a/(d[2]-d[0]),c/(d[3]-d[1])],y=Math.min(l[0]||0,l[1]||0)/2;if(i.fillStyle="black",i.fillRect(0,0,a,c),i.fillStyle="white",n&&(typeof n!="number"&&(n=1),i.strokeStyle=n>0?"white":"black",i.lineWidth=Math.abs(n)),i.translate(.5*a,.5*c),i.scale(y,y),function(){if(t!=null)return t;var x=document.createElement("canvas").getContext("2d");if(x.canvas.width=x.canvas.height=1,!window.Path2D)return t=!1;var T=new Path2D("M0,0h1v1h-1v-1Z");x.fillStyle="black",x.fill(T);var A=x.getImageData(0,0,1,1);return t=A&&A.data&&A.data[3]===255}()){var v=new Path2D(s);i.fill(v),n&&i.stroke(v)}else{var _=g(s);p(i,_),i.fill(),n&&i.stroke()}return i.setTransform(1,0,0,1,0,0),f(i,{cutoff:o.cutoff!=null?o.cutoff:.5,radius:o.radius!=null?o.radius:.5*r})}},{"bitmap-sdf":105,"draw-svg-path":180,"is-svg-path":449,"parse-svg-path":482,"svg-path-bounds":578}],581:[function(h,N,H){(function(t){(function(){N.exports=function e(f,u,i){i=i||{};var s=p[f];s||(s=p[f]={" ":{data:new Float32Array(0),shape:.2}});var o=s[u];if(!o)if(u.length<=1||!/\d/.test(u))o=s[u]=function(T){for(var A=T.cells,S=T.positions,w=new Float32Array(6*A.length),L=0,k=0,C=0;C<A.length;++C)for(var M=A[C],P=0;P<3;++P){var O=S[M[P]];w[L++]=O[0],w[L++]=O[1]+1.4,k=Math.max(O[0],k)}return{data:w,shape:k}}(m(u,{triangles:!0,font:f,textAlign:i.textAlign||"left",textBaseline:"alphabetic",styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0}}));else{for(var a=u.split(/(\d|\s)/),c=new Array(a.length),r=0,n=0,d=0;d<a.length;++d)c[d]=e(f,a[d]),r+=c[d].data.length,n+=c[d].shape,d>0&&(n+=.02);var l=new Float32Array(r),y=0,v=-.5*n;for(d=0;d<c.length;++d){for(var _=c[d].data,x=0;x<_.length;x+=2)l[y++]=_[x]+v,l[y++]=_[x+1];v+=c[d].shape+.02}o=s[u]={data:l,shape:n}}return o};var m=h("vectorize-text"),g=window||t.global||{},p=g.__TEXT_CACHE||{};g.__TEXT_CACHE={}}).call(this)}).call(this,h("_process"))},{_process:514,"vectorize-text":607}],582:[function(h,N,H){(function(t,m){(function(){var g=h("process/browser.js").nextTick,p=Function.prototype.apply,e=Array.prototype.slice,f={},u=0;function i(s,o){this._id=s,this._clearFn=o}H.setTimeout=function(){return new i(p.call(setTimeout,window,arguments),clearTimeout)},H.setInterval=function(){return new i(p.call(setInterval,window,arguments),clearInterval)},H.clearTimeout=H.clearInterval=function(s){s.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(window,this._id)},H.enroll=function(s,o){clearTimeout(s._idleTimeoutId),s._idleTimeout=o},H.unenroll=function(s){clearTimeout(s._idleTimeoutId),s._idleTimeout=-1},H._unrefActive=H.active=function(s){clearTimeout(s._idleTimeoutId);var o=s._idleTimeout;o>=0&&(s._idleTimeoutId=setTimeout(function(){s._onTimeout&&s._onTimeout()},o))},H.setImmediate=typeof t=="function"?t:function(s){var o=u++,a=!(arguments.length<2)&&e.call(arguments,1);return f[o]=!0,g(function(){f[o]&&(a?s.apply(null,a):s.call(null),H.clearImmediate(o))}),o},H.clearImmediate=typeof m=="function"?m:function(s){delete f[s]}}).call(this)}).call(this,h("timers").setImmediate,h("timers").clearImmediate)},{"process/browser.js":514,timers:582}],583:[function(h,N,H){(function(t){var m=/^\s+/,g=/\s+$/,p=0,e=t.round,f=t.min,u=t.max,i=t.random;function s(q,ee){if(ee=ee||{},(q=q||"")instanceof s)return q;if(!(this instanceof s))return new s(q,ee);var J=function($){var te={r:0,g:0,b:0},ie=1,ae=null,he=null,se=null,de=!1,ce=!1;typeof $=="string"&&($=function(be){be=be.replace(m,"").replace(g,"").toLowerCase();var xe,ue=!1;if(C[be])be=C[be],ue=!0;else if(be=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};return(xe=D.rgb.exec(be))?{r:xe[1],g:xe[2],b:xe[3]}:(xe=D.rgba.exec(be))?{r:xe[1],g:xe[2],b:xe[3],a:xe[4]}:(xe=D.hsl.exec(be))?{h:xe[1],s:xe[2],l:xe[3]}:(xe=D.hsla.exec(be))?{h:xe[1],s:xe[2],l:xe[3],a:xe[4]}:(xe=D.hsv.exec(be))?{h:xe[1],s:xe[2],v:xe[3]}:(xe=D.hsva.exec(be))?{h:xe[1],s:xe[2],v:xe[3],a:xe[4]}:(xe=D.hex8.exec(be))?{r:j(xe[1]),g:j(xe[2]),b:j(xe[3]),a:X(xe[4]),format:ue?"name":"hex8"}:(xe=D.hex6.exec(be))?{r:j(xe[1]),g:j(xe[2]),b:j(xe[3]),format:ue?"name":"hex"}:(xe=D.hex4.exec(be))?{r:j(xe[1]+""+xe[1]),g:j(xe[2]+""+xe[2]),b:j(xe[3]+""+xe[3]),a:X(xe[4]+""+xe[4]),format:ue?"name":"hex8"}:(xe=D.hex3.exec(be))?{r:j(xe[1]+""+xe[1]),g:j(xe[2]+""+xe[2]),b:j(xe[3]+""+xe[3]),format:ue?"name":"hex"}:!1}($)),typeof $=="object"&&(B($.r)&&B($.g)&&B($.b)?(ve=$.r,ke=$.g,Ee=$.b,te={r:255*O(ve,255),g:255*O(ke,255),b:255*O(Ee,255)},de=!0,ce=String($.r).substr(-1)==="%"?"prgb":"rgb"):B($.h)&&B($.s)&&B($.v)?(ae=Z($.s),he=Z($.v),te=function(be,xe,ue){be=6*O(be,360),xe=O(xe,100),ue=O(ue,100);var me=t.floor(be),we=be-me,Me=ue*(1-xe),Se=ue*(1-we*xe),De=ue*(1-(1-we)*xe),Fe=me%6;return{r:255*[ue,Se,Me,Me,De,ue][Fe],g:255*[De,ue,ue,Se,Me,Me][Fe],b:255*[Me,Me,De,ue,ue,Se][Fe]}}($.h,ae,he),de=!0,ce="hsv"):B($.h)&&B($.s)&&B($.l)&&(ae=Z($.s),se=Z($.l),te=function(be,xe,ue){var me,we,Me;function Se(Ye,et,Oe){return Oe<0&&(Oe+=1),Oe>1&&(Oe-=1),Oe<1/6?Ye+6*(et-Ye)*Oe:Oe<.5?et:Oe<2/3?Ye+(et-Ye)*(2/3-Oe)*6:Ye}if(be=O(be,360),xe=O(xe,100),ue=O(ue,100),xe===0)me=we=Me=ue;else{var De=ue<.5?ue*(1+xe):ue+xe-ue*xe,Fe=2*ue-De;me=Se(Fe,De,be+1/3),we=Se(Fe,De,be),Me=Se(Fe,De,be-1/3)}return{r:255*me,g:255*we,b:255*Me}}($.h,ae,se),de=!0,ce="hsl"),$.hasOwnProperty("a")&&(ie=$.a));var ve,ke,Ee;return ie=P(ie),{ok:de,format:$.format||ce,r:f(255,u(te.r,0)),g:f(255,u(te.g,0)),b:f(255,u(te.b,0)),a:ie}}(q);this._originalInput=q,this._r=J.r,this._g=J.g,this._b=J.b,this._a=J.a,this._roundA=e(100*this._a)/100,this._format=ee.format||J.format,this._gradientType=ee.gradientType,this._r<1&&(this._r=e(this._r)),this._g<1&&(this._g=e(this._g)),this._b<1&&(this._b=e(this._b)),this._ok=J.ok,this._tc_id=p++}function o(q,ee,J){q=O(q,255),ee=O(ee,255),J=O(J,255);var $,te,ie=u(q,ee,J),ae=f(q,ee,J),he=(ie+ae)/2;if(ie==ae)$=te=0;else{var se=ie-ae;switch(te=he>.5?se/(2-ie-ae):se/(ie+ae),ie){case q:$=(ee-J)/se+(ee<J?6:0);break;case ee:$=(J-q)/se+2;break;case J:$=(q-ee)/se+4}$/=6}return{h:$,s:te,l:he}}function a(q,ee,J){q=O(q,255),ee=O(ee,255),J=O(J,255);var $,te,ie=u(q,ee,J),ae=f(q,ee,J),he=ie,se=ie-ae;if(te=ie===0?0:se/ie,ie==ae)$=0;else{switch(ie){case q:$=(ee-J)/se+(ee<J?6:0);break;case ee:$=(J-q)/se+2;break;case J:$=(q-ee)/se+4}$/=6}return{h:$,s:te,v:he}}function c(q,ee,J,$){var te=[W(e(q).toString(16)),W(e(ee).toString(16)),W(e(J).toString(16))];return $&&te[0].charAt(0)==te[0].charAt(1)&&te[1].charAt(0)==te[1].charAt(1)&&te[2].charAt(0)==te[2].charAt(1)?te[0].charAt(0)+te[1].charAt(0)+te[2].charAt(0):te.join("")}function r(q,ee,J,$){return[W(Q($)),W(e(q).toString(16)),W(e(ee).toString(16)),W(e(J).toString(16))].join("")}function n(q,ee){ee=ee===0?0:ee||10;var J=s(q).toHsl();return J.s-=ee/100,J.s=F(J.s),s(J)}function d(q,ee){ee=ee===0?0:ee||10;var J=s(q).toHsl();return J.s+=ee/100,J.s=F(J.s),s(J)}function l(q){return s(q).desaturate(100)}function y(q,ee){ee=ee===0?0:ee||10;var J=s(q).toHsl();return J.l+=ee/100,J.l=F(J.l),s(J)}function v(q,ee){ee=ee===0?0:ee||10;var J=s(q).toRgb();return J.r=u(0,f(255,J.r-e(-ee/100*255))),J.g=u(0,f(255,J.g-e(-ee/100*255))),J.b=u(0,f(255,J.b-e(-ee/100*255))),s(J)}function _(q,ee){ee=ee===0?0:ee||10;var J=s(q).toHsl();return J.l-=ee/100,J.l=F(J.l),s(J)}function x(q,ee){var J=s(q).toHsl(),$=(J.h+ee)%360;return J.h=$<0?360+$:$,s(J)}function T(q){var ee=s(q).toHsl();return ee.h=(ee.h+180)%360,s(ee)}function A(q){var ee=s(q).toHsl(),J=ee.h;return[s(q),s({h:(J+120)%360,s:ee.s,l:ee.l}),s({h:(J+240)%360,s:ee.s,l:ee.l})]}function S(q){var ee=s(q).toHsl(),J=ee.h;return[s(q),s({h:(J+90)%360,s:ee.s,l:ee.l}),s({h:(J+180)%360,s:ee.s,l:ee.l}),s({h:(J+270)%360,s:ee.s,l:ee.l})]}function w(q){var ee=s(q).toHsl(),J=ee.h;return[s(q),s({h:(J+72)%360,s:ee.s,l:ee.l}),s({h:(J+216)%360,s:ee.s,l:ee.l})]}function L(q,ee,J){ee=ee||6,J=J||30;var $=s(q).toHsl(),te=360/J,ie=[s(q)];for($.h=($.h-(te*ee>>1)+720)%360;--ee;)$.h=($.h+te)%360,ie.push(s($));return ie}function k(q,ee){ee=ee||6;for(var J=s(q).toHsv(),$=J.h,te=J.s,ie=J.v,ae=[],he=1/ee;ee--;)ae.push(s({h:$,s:te,v:ie})),ie=(ie+he)%1;return ae}s.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var q=this.toRgb();return(299*q.r+587*q.g+114*q.b)/1e3},getLuminance:function(){var q,ee,J,$=this.toRgb();return q=$.r/255,ee=$.g/255,J=$.b/255,.2126*(q<=.03928?q/12.92:t.pow((q+.055)/1.055,2.4))+.7152*(ee<=.03928?ee/12.92:t.pow((ee+.055)/1.055,2.4))+.0722*(J<=.03928?J/12.92:t.pow((J+.055)/1.055,2.4))},setAlpha:function(q){return this._a=P(q),this._roundA=e(100*this._a)/100,this},toHsv:function(){var q=a(this._r,this._g,this._b);return{h:360*q.h,s:q.s,v:q.v,a:this._a}},toHsvString:function(){var q=a(this._r,this._g,this._b),ee=e(360*q.h),J=e(100*q.s),$=e(100*q.v);return this._a==1?"hsv("+ee+", "+J+"%, "+$+"%)":"hsva("+ee+", "+J+"%, "+$+"%, "+this._roundA+")"},toHsl:function(){var q=o(this._r,this._g,this._b);return{h:360*q.h,s:q.s,l:q.l,a:this._a}},toHslString:function(){var q=o(this._r,this._g,this._b),ee=e(360*q.h),J=e(100*q.s),$=e(100*q.l);return this._a==1?"hsl("+ee+", "+J+"%, "+$+"%)":"hsla("+ee+", "+J+"%, "+$+"%, "+this._roundA+")"},toHex:function(q){return c(this._r,this._g,this._b,q)},toHexString:function(q){return"#"+this.toHex(q)},toHex8:function(q){return function(ee,J,$,te,ie){var ae=[W(e(ee).toString(16)),W(e(J).toString(16)),W(e($).toString(16)),W(Q(te))];return ie&&ae[0].charAt(0)==ae[0].charAt(1)&&ae[1].charAt(0)==ae[1].charAt(1)&&ae[2].charAt(0)==ae[2].charAt(1)&&ae[3].charAt(0)==ae[3].charAt(1)?ae[0].charAt(0)+ae[1].charAt(0)+ae[2].charAt(0)+ae[3].charAt(0):ae.join("")}(this._r,this._g,this._b,this._a,q)},toHex8String:function(q){return"#"+this.toHex8(q)},toRgb:function(){return{r:e(this._r),g:e(this._g),b:e(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+e(this._r)+", "+e(this._g)+", "+e(this._b)+")":"rgba("+e(this._r)+", "+e(this._g)+", "+e(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:e(100*O(this._r,255))+"%",g:e(100*O(this._g,255))+"%",b:e(100*O(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+e(100*O(this._r,255))+"%, "+e(100*O(this._g,255))+"%, "+e(100*O(this._b,255))+"%)":"rgba("+e(100*O(this._r,255))+"%, "+e(100*O(this._g,255))+"%, "+e(100*O(this._b,255))+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":!(this._a<1)&&(M[c(this._r,this._g,this._b,!0)]||!1)},toFilter:function(q){var ee="#"+r(this._r,this._g,this._b,this._a),J=ee,$=this._gradientType?"GradientType = 1, ":"";if(q){var te=s(q);J="#"+r(te._r,te._g,te._b,te._a)}return"progid:DXImageTransform.Microsoft.gradient("+$+"startColorstr="+ee+",endColorstr="+J+")"},toString:function(q){var ee=!!q;q=q||this._format;var J=!1,$=this._a<1&&this._a>=0;return ee||!$||q!=="hex"&&q!=="hex6"&&q!=="hex3"&&q!=="hex4"&&q!=="hex8"&&q!=="name"?(q==="rgb"&&(J=this.toRgbString()),q==="prgb"&&(J=this.toPercentageRgbString()),q!=="hex"&&q!=="hex6"||(J=this.toHexString()),q==="hex3"&&(J=this.toHexString(!0)),q==="hex4"&&(J=this.toHex8String(!0)),q==="hex8"&&(J=this.toHex8String()),q==="name"&&(J=this.toName()),q==="hsl"&&(J=this.toHslString()),q==="hsv"&&(J=this.toHsvString()),J||this.toHexString()):q==="name"&&this._a===0?this.toName():this.toRgbString()},clone:function(){return s(this.toString())},_applyModification:function(q,ee){var J=q.apply(null,[this].concat([].slice.call(ee)));return this._r=J._r,this._g=J._g,this._b=J._b,this.setAlpha(J._a),this},lighten:function(){return this._applyModification(y,arguments)},brighten:function(){return this._applyModification(v,arguments)},darken:function(){return this._applyModification(_,arguments)},desaturate:function(){return this._applyModification(n,arguments)},saturate:function(){return this._applyModification(d,arguments)},greyscale:function(){return this._applyModification(l,arguments)},spin:function(){return this._applyModification(x,arguments)},_applyCombination:function(q,ee){return q.apply(null,[this].concat([].slice.call(ee)))},analogous:function(){return this._applyCombination(L,arguments)},complement:function(){return this._applyCombination(T,arguments)},monochromatic:function(){return this._applyCombination(k,arguments)},splitcomplement:function(){return this._applyCombination(w,arguments)},triad:function(){return this._applyCombination(A,arguments)},tetrad:function(){return this._applyCombination(S,arguments)}},s.fromRatio=function(q,ee){if(typeof q=="object"){var J={};for(var $ in q)q.hasOwnProperty($)&&(J[$]=$==="a"?q[$]:Z(q[$]));q=J}return s(q,ee)},s.equals=function(q,ee){return!(!q||!ee)&&s(q).toRgbString()==s(ee).toRgbString()},s.random=function(){return s.fromRatio({r:i(),g:i(),b:i()})},s.mix=function(q,ee,J){J=J===0?0:J||50;var $=s(q).toRgb(),te=s(ee).toRgb(),ie=J/100;return s({r:(te.r-$.r)*ie+$.r,g:(te.g-$.g)*ie+$.g,b:(te.b-$.b)*ie+$.b,a:(te.a-$.a)*ie+$.a})},s.readability=function(q,ee){var J=s(q),$=s(ee);return(t.max(J.getLuminance(),$.getLuminance())+.05)/(t.min(J.getLuminance(),$.getLuminance())+.05)},s.isReadable=function(q,ee,J){var $,te,ie=s.readability(q,ee);switch(te=!1,($=function(ae){var he,se;return he=((ae=ae||{level:"AA",size:"small"}).level||"AA").toUpperCase(),se=(ae.size||"small").toLowerCase(),he!=="AA"&&he!=="AAA"&&(he="AA"),se!=="small"&&se!=="large"&&(se="small"),{level:he,size:se}}(J)).level+$.size){case"AAsmall":case"AAAlarge":te=ie>=4.5;break;case"AAlarge":te=ie>=3;break;case"AAAsmall":te=ie>=7}return te},s.mostReadable=function(q,ee,J){var $,te,ie,ae,he=null,se=0;te=(J=J||{}).includeFallbackColors,ie=J.level,ae=J.size;for(var de=0;de<ee.length;de++)($=s.readability(q,ee[de]))>se&&(se=$,he=s(ee[de]));return s.isReadable(q,he,{level:ie,size:ae})||!te?he:(J.includeFallbackColors=!1,s.mostReadable(q,["#fff","#000"],J))};var C=s.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},M=s.hexNames=function(q){var ee={};for(var J in q)q.hasOwnProperty(J)&&(ee[q[J]]=J);return ee}(C);function P(q){return q=parseFloat(q),(isNaN(q)||q<0||q>1)&&(q=1),q}function O(q,ee){(function($){return typeof $=="string"&&$.indexOf(".")!=-1&&parseFloat($)===1})(q)&&(q="100%");var J=function($){return typeof $=="string"&&$.indexOf("%")!=-1}(q);return q=f(ee,u(0,parseFloat(q))),J&&(q=parseInt(q*ee,10)/100),t.abs(q-ee)<1e-6?1:q%ee/parseFloat(ee)}function F(q){return f(1,u(0,q))}function j(q){return parseInt(q,16)}function W(q){return q.length==1?"0"+q:""+q}function Z(q){return q<=1&&(q=100*q+"%"),q}function Q(q){return t.round(255*parseFloat(q)).toString(16)}function X(q){return j(q)/255}var G,Y,K,D=(Y="[\\s|\\(]+("+(G="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+G+")[,|\\s]+("+G+")\\s*\\)?",K="[\\s|\\(]+("+G+")[,|\\s]+("+G+")[,|\\s]+("+G+")[,|\\s]+("+G+")\\s*\\)?",{CSS_UNIT:new RegExp(G),rgb:new RegExp("rgb"+Y),rgba:new RegExp("rgba"+K),hsl:new RegExp("hsl"+Y),hsla:new RegExp("hsla"+K),hsv:new RegExp("hsv"+Y),hsva:new RegExp("hsva"+K),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function B(q){return!!D.CSS_UNIT.exec(q)}N!==void 0&&N.exports?N.exports=s:window.tinycolor=s})(Math)},{}],584:[function(h,N,H){N.exports=m,N.exports.float32=N.exports.float=m,N.exports.fract32=N.exports.fract=function(g,p){if(g.length){if(g instanceof Float32Array)return new Float32Array(g.length);p instanceof Float32Array||(p=m(g));for(var e=0,f=p.length;e<f;e++)p[e]=g[e]-p[e];return p}return m(g-m(g))};var t=new Float32Array(1);function m(g){return g.length?g instanceof Float32Array?g:new Float32Array(g):(t[0]=g,t[0])}},{}],585:[function(h,N,H){var t=h("parse-unit");N.exports=g;function m(p,e){var f=t(getComputedStyle(p).getPropertyValue(e));return f[0]*g(f[1],p)}function g(p,e){switch(e=e||document.body,p=(p||"px").trim().toLowerCase(),e!==window&&e!==document||(e=document.body),p){case"%":return e.clientHeight/100;case"ch":case"ex":return function(f,u){var i=document.createElement("div");i.style["font-size"]="128"+f,u.appendChild(i);var s=m(i,"font-size")/128;return u.removeChild(i),s}(p,e);case"em":return m(e,"font-size");case"rem":return m(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return 96;case"cm":return 96/2.54;case"mm":return 96/25.4;case"pt":return 96/72;case"pc":return 16}return 1}},{"parse-unit":483}],586:[function(h,N,H){(function(t,m){m(typeof H=="object"&&N!==void 0?H:(t=t||self).topojson=t.topojson||{})})(this,function(t){function m(r){return r}function g(r){if(r==null)return m;var n,d,l=r.scale[0],y=r.scale[1],v=r.translate[0],_=r.translate[1];return function(x,T){T||(n=d=0);var A=2,S=x.length,w=new Array(S);for(w[0]=(n+=x[0])*l+v,w[1]=(d+=x[1])*y+_;A<S;)w[A]=x[A],++A;return w}}function p(r){var n,d=g(r.transform),l=1/0,y=l,v=-l,_=-l;function x(A){(A=d(A))[0]<l&&(l=A[0]),A[0]>v&&(v=A[0]),A[1]<y&&(y=A[1]),A[1]>_&&(_=A[1])}function T(A){switch(A.type){case"GeometryCollection":A.geometries.forEach(T);break;case"Point":x(A.coordinates);break;case"MultiPoint":A.coordinates.forEach(x)}}for(n in r.arcs.forEach(function(A){for(var S,w=-1,L=A.length;++w<L;)(S=d(A[w],w))[0]<l&&(l=S[0]),S[0]>v&&(v=S[0]),S[1]<y&&(y=S[1]),S[1]>_&&(_=S[1])}),r.objects)T(r.objects[n]);return[l,y,v,_]}function e(r,n){var d=n.id,l=n.bbox,y=n.properties==null?{}:n.properties,v=f(r,n);return d==null&&l==null?{type:"Feature",properties:y,geometry:v}:l==null?{type:"Feature",id:d,properties:y,geometry:v}:{type:"Feature",id:d,bbox:l,properties:y,geometry:v}}function f(r,n){var d=g(r.transform),l=r.arcs;function y(A,S){S.length&&S.pop();for(var w=l[A<0?~A:A],L=0,k=w.length;L<k;++L)S.push(d(w[L],L));A<0&&function(C,M){for(var P,O=C.length,F=O-M;F<--O;)P=C[F],C[F++]=C[O],C[O]=P}(S,k)}function v(A){return d(A)}function _(A){for(var S=[],w=0,L=A.length;w<L;++w)y(A[w],S);return S.length<2&&S.push(S[0]),S}function x(A){for(var S=_(A);S.length<4;)S.push(S[0]);return S}function T(A){return A.map(x)}return function A(S){var w,L=S.type;switch(L){case"GeometryCollection":return{type:L,geometries:S.geometries.map(A)};case"Point":w=v(S.coordinates);break;case"MultiPoint":w=S.coordinates.map(v);break;case"LineString":w=_(S.arcs);break;case"MultiLineString":w=S.arcs.map(_);break;case"Polygon":w=T(S.arcs);break;case"MultiPolygon":w=S.arcs.map(T);break;default:return null}return{type:L,coordinates:w}}(n)}function u(r,n){var d={},l={},y={},v=[],_=-1;function x(T,A){for(var S in T){var w=T[S];delete A[w.start],delete w.start,delete w.end,w.forEach(function(L){d[L<0?~L:L]=1}),v.push(w)}}return n.forEach(function(T,A){var S,w=r.arcs[T<0?~T:T];w.length<3&&!w[1][0]&&!w[1][1]&&(S=n[++_],n[_]=T,n[A]=S)}),n.forEach(function(T){var A,S,w=function(P){var O,F=r.arcs[P<0?~P:P],j=F[0];return r.transform?(O=[0,0],F.forEach(function(W){O[0]+=W[0],O[1]+=W[1]})):O=F[F.length-1],P<0?[O,j]:[j,O]}(T),L=w[0],k=w[1];if(A=y[L])if(delete y[A.end],A.push(T),A.end=k,S=l[k]){delete l[S.start];var C=S===A?A:A.concat(S);l[C.start=A.start]=y[C.end=S.end]=C}else l[A.start]=y[A.end]=A;else if(A=l[k])if(delete l[A.start],A.unshift(T),A.start=L,S=y[L]){delete y[S.end];var M=S===A?A:S.concat(A);l[M.start=S.start]=y[M.end=A.end]=M}else l[A.start]=y[A.end]=A;else l[(A=[T]).start=L]=y[A.end=k]=A}),x(y,l),x(l,y),n.forEach(function(T){d[T<0?~T:T]||v.push([T])}),v}function i(r,n,d){var l,y,v;if(arguments.length>1)l=s(r,n,d);else for(y=0,l=new Array(v=r.arcs.length);y<v;++y)l[y]=y;return{type:"MultiLineString",arcs:u(r,l)}}function s(r,n,d){var l,y=[],v=[];function _(A){var S=A<0?~A:A;(v[S]||(v[S]=[])).push({i:A,g:l})}function x(A){A.forEach(_)}function T(A){A.forEach(x)}return function A(S){switch(l=S,S.type){case"GeometryCollection":S.geometries.forEach(A);break;case"LineString":x(S.arcs);break;case"MultiLineString":case"Polygon":T(S.arcs);break;case"MultiPolygon":(function(w){w.forEach(T)})(S.arcs)}}(n),v.forEach(d==null?function(A){y.push(A[0].i)}:function(A){d(A[0].g,A[A.length-1].g)&&y.push(A[0].i)}),y}function o(r,n){var d={},l=[],y=[];function v(x){x.forEach(function(T){T.forEach(function(A){(d[A=A<0?~A:A]||(d[A]=[])).push(x)})}),l.push(x)}function _(x){return function(T){for(var A,S=-1,w=T.length,L=T[w-1],k=0;++S<w;)A=L,L=T[S],k+=A[0]*L[1]-A[1]*L[0];return Math.abs(k)}(f(r,{type:"Polygon",arcs:[x]}).coordinates[0])}return n.forEach(function x(T){switch(T.type){case"GeometryCollection":T.geometries.forEach(x);break;case"Polygon":v(T.arcs);break;case"MultiPolygon":T.arcs.forEach(v)}}),l.forEach(function(x){if(!x._){var T=[],A=[x];for(x._=1,y.push(T);x=A.pop();)T.push(x),x.forEach(function(S){S.forEach(function(w){d[w<0?~w:w].forEach(function(L){L._||(L._=1,A.push(L))})})})}}),l.forEach(function(x){delete x._}),{type:"MultiPolygon",arcs:y.map(function(x){var T,A=[];if(x.forEach(function(C){C.forEach(function(M){M.forEach(function(P){d[P<0?~P:P].length<2&&A.push(P)})})}),(T=(A=u(r,A)).length)>1)for(var S,w,L=1,k=_(A[0]);L<T;++L)(S=_(A[L]))>k&&(w=A[0],A[0]=A[L],A[L]=w,k=S);return A}).filter(function(x){return x.length>0})}}function a(r,n){for(var d=0,l=r.length;d<l;){var y=d+l>>>1;r[y]<n?d=y+1:l=y}return d}function c(r){if(r==null)return m;var n,d,l=r.scale[0],y=r.scale[1],v=r.translate[0],_=r.translate[1];return function(x,T){T||(n=d=0);var A=2,S=x.length,w=new Array(S),L=Math.round((x[0]-v)/l),k=Math.round((x[1]-_)/y);for(w[0]=L-n,n=L,w[1]=k-d,d=k;A<S;)w[A]=x[A],++A;return w}}t.bbox=p,t.feature=function(r,n){return typeof n=="string"&&(n=r.objects[n]),n.type==="GeometryCollection"?{type:"FeatureCollection",features:n.geometries.map(function(d){return e(r,d)})}:e(r,n)},t.merge=function(r){return f(r,o.apply(this,arguments))},t.mergeArcs=o,t.mesh=function(r){return f(r,i.apply(this,arguments))},t.meshArcs=i,t.neighbors=function(r){var n={},d=r.map(function(){return[]});function l(C,M){C.forEach(function(P){P<0&&(P=~P);var O=n[P];O?O.push(M):n[P]=[M]})}function y(C,M){C.forEach(function(P){l(P,M)})}var v={LineString:l,MultiLineString:y,Polygon:y,MultiPolygon:function(C,M){C.forEach(function(P){y(P,M)})}};for(var _ in r.forEach(function C(M,P){M.type==="GeometryCollection"?M.geometries.forEach(function(O){C(O,P)}):M.type in v&&v[M.type](M.arcs,P)}),n)for(var x=n[_],T=x.length,A=0;A<T;++A)for(var S=A+1;S<T;++S){var w,L=x[A],k=x[S];(w=d[L])[_=a(w,k)]!==k&&w.splice(_,0,k),(w=d[k])[_=a(w,L)]!==L&&w.splice(_,0,L)}return d},t.quantize=function(r,n){if(r.transform)throw new Error("already quantized");if(n&&n.scale)x=r.bbox;else{if(!((d=Math.floor(n))>=2))throw new Error("n must be \u22652");var d,l=(x=r.bbox||p(r))[0],y=x[1],v=x[2],_=x[3];n={scale:[v-l?(v-l)/(d-1):1,_-y?(_-y)/(d-1):1],translate:[l,y]}}var x,T,A=c(n),S=r.objects,w={};function L(C){return A(C)}function k(C){var M;switch(C.type){case"GeometryCollection":M={type:"GeometryCollection",geometries:C.geometries.map(k)};break;case"Point":M={type:"Point",coordinates:L(C.coordinates)};break;case"MultiPoint":M={type:"MultiPoint",coordinates:C.coordinates.map(L)};break;default:return C}return C.id!=null&&(M.id=C.id),C.bbox!=null&&(M.bbox=C.bbox),C.properties!=null&&(M.properties=C.properties),M}for(T in S)w[T]=k(S[T]);return{type:"Topology",bbox:x,transform:n,objects:w,arcs:r.arcs.map(function(C){var M,P=0,O=1,F=C.length,j=new Array(F);for(j[0]=A(C[0],0);++P<F;)((M=A(C[P],P))[0]||M[1])&&(j[O++]=M);return O===1&&(j[O++]=[0,0]),j.length=O,j})}},t.transform=g,t.untransform=c,Object.defineProperty(t,"__esModule",{value:!0})})},{}],587:[function(h,N,H){N.exports=function(r){var n=(r=r||{}).center||[0,0,0],d=r.up||[0,1,0],l=r.right||s(d),y=r.radius||1,v=r.theta||0,_=r.phi||0;if(n=[].slice.call(n,0,3),d=[].slice.call(d,0,3),e(d,d),l=[].slice.call(l,0,3),e(l,l),"eye"in r){var x=r.eye,T=[x[0]-n[0],x[1]-n[1],x[2]-n[2]];p(l,T,d),u(l[0],l[1],l[2])<1e-6?l=s(d):e(l,l),y=u(T[0],T[1],T[2]);var A=f(d,T)/y,S=f(l,T)/y;_=Math.acos(A),v=Math.acos(S)}return y=Math.log(y),new o(r.zoomMin,r.zoomMax,n,d,l,y,v,_)};var t=h("filtered-vector"),m=h("gl-mat4/invert"),g=h("gl-mat4/rotate"),p=h("gl-vec3/cross"),e=h("gl-vec3/normalize"),f=h("gl-vec3/dot");function u(r,n,d){return Math.sqrt(Math.pow(r,2)+Math.pow(n,2)+Math.pow(d,2))}function i(r){return Math.min(1,Math.max(-1,r))}function s(r){var n=Math.abs(r[0]),d=Math.abs(r[1]),l=Math.abs(r[2]),y=[0,0,0];n>Math.max(d,l)?y[2]=1:d>Math.max(n,l)?y[0]=1:y[1]=1;for(var v=0,_=0,x=0;x<3;++x)v+=r[x]*r[x],_+=y[x]*r[x];for(x=0;x<3;++x)y[x]-=_/v*r[x];return e(y,y),y}function o(r,n,d,l,y,v,_,x){this.center=t(d),this.up=t(l),this.right=t(y),this.radius=t([v]),this.angle=t([_,x]),this.angle.bounds=[[-1/0,-Math.PI/2],[1/0,Math.PI/2]],this.setDistanceLimits(r,n),this.computedCenter=this.center.curve(0),this.computedUp=this.up.curve(0),this.computedRight=this.right.curve(0),this.computedRadius=this.radius.curve(0),this.computedAngle=this.angle.curve(0),this.computedToward=[0,0,0],this.computedEye=[0,0,0],this.computedMatrix=new Array(16);for(var T=0;T<16;++T)this.computedMatrix[T]=.5;this.recalcMatrix(0)}var a=o.prototype;a.setDistanceLimits=function(r,n){r=r>0?Math.log(r):-1/0,n=n>0?Math.log(n):1/0,n=Math.max(n,r),this.radius.bounds[0][0]=r,this.radius.bounds[1][0]=n},a.getDistanceLimits=function(r){var n=this.radius.bounds[0];return r?(r[0]=Math.exp(n[0][0]),r[1]=Math.exp(n[1][0]),r):[Math.exp(n[0][0]),Math.exp(n[1][0])]},a.recalcMatrix=function(r){this.center.curve(r),this.up.curve(r),this.right.curve(r),this.radius.curve(r),this.angle.curve(r);for(var n=this.computedUp,d=this.computedRight,l=0,y=0,v=0;v<3;++v)y+=n[v]*d[v],l+=n[v]*n[v];var _=Math.sqrt(l),x=0;for(v=0;v<3;++v)d[v]-=n[v]*y/l,x+=d[v]*d[v],n[v]/=_;var T=Math.sqrt(x);for(v=0;v<3;++v)d[v]/=T;var A=this.computedToward;p(A,n,d),e(A,A);var S=Math.exp(this.computedRadius[0]),w=this.computedAngle[0],L=this.computedAngle[1],k=Math.cos(w),C=Math.sin(w),M=Math.cos(L),P=Math.sin(L),O=this.computedCenter,F=k*M,j=C*M,W=P,Z=-k*P,Q=-C*P,X=M,G=this.computedEye,Y=this.computedMatrix;for(v=0;v<3;++v){var K=F*d[v]+j*A[v]+W*n[v];Y[4*v+1]=Z*d[v]+Q*A[v]+X*n[v],Y[4*v+2]=K,Y[4*v+3]=0}var D=Y[1],B=Y[5],q=Y[9],ee=Y[2],J=Y[6],$=Y[10],te=B*$-q*J,ie=q*ee-D*$,ae=D*J-B*ee,he=u(te,ie,ae);for(te/=he,ie/=he,ae/=he,Y[0]=te,Y[4]=ie,Y[8]=ae,v=0;v<3;++v)G[v]=O[v]+Y[2+4*v]*S;for(v=0;v<3;++v){x=0;for(var se=0;se<3;++se)x+=Y[v+4*se]*G[se];Y[12+v]=-x}Y[15]=1},a.getMatrix=function(r,n){this.recalcMatrix(r);var d=this.computedMatrix;if(n){for(var l=0;l<16;++l)n[l]=d[l];return n}return d};var c=[0,0,0];a.rotate=function(r,n,d,l){if(this.angle.move(r,n,d),l){this.recalcMatrix(r);var y=this.computedMatrix;c[0]=y[2],c[1]=y[6],c[2]=y[10];for(var v=this.computedUp,_=this.computedRight,x=this.computedToward,T=0;T<3;++T)y[4*T]=v[T],y[4*T+1]=_[T],y[4*T+2]=x[T];for(g(y,y,l,c),T=0;T<3;++T)v[T]=y[4*T],_[T]=y[4*T+1];this.up.set(r,v[0],v[1],v[2]),this.right.set(r,_[0],_[1],_[2])}},a.pan=function(r,n,d,l){n=n||0,d=d||0,l=l||0,this.recalcMatrix(r);var y=this.computedMatrix,v=(Math.exp(this.computedRadius[0]),y[1]),_=y[5],x=y[9],T=u(v,_,x);v/=T,_/=T,x/=T;var A=y[0],S=y[4],w=y[8],L=A*v+S*_+w*x,k=u(A-=v*L,S-=_*L,w-=x*L),C=(A/=k)*n+v*d,M=(S/=k)*n+_*d,P=(w/=k)*n+x*d;this.center.move(r,C,M,P);var O=Math.exp(this.computedRadius[0]);O=Math.max(1e-4,O+l),this.radius.set(r,Math.log(O))},a.translate=function(r,n,d,l){this.center.move(r,n||0,d||0,l||0)},a.setMatrix=function(r,n,d,l){var y=1;typeof d=="number"&&(y=0|d),(y<0||y>3)&&(y=1);var v=(y+2)%3;n||(this.recalcMatrix(r),n=this.computedMatrix);var _=n[y],x=n[y+4],T=n[y+8];if(l){var A=Math.abs(_),S=Math.abs(x),w=Math.abs(T),L=Math.max(A,S,w);A===L?(_=_<0?-1:1,x=T=0):w===L?(T=T<0?-1:1,_=x=0):(x=x<0?-1:1,_=T=0)}else{var k=u(_,x,T);_/=k,x/=k,T/=k}var C,M,P=n[v],O=n[v+4],F=n[v+8],j=P*_+O*x+F*T,W=u(P-=_*j,O-=x*j,F-=T*j),Z=x*(F/=W)-T*(O/=W),Q=T*(P/=W)-_*F,X=_*O-x*P,G=u(Z,Q,X);if(Z/=G,Q/=G,X/=G,this.center.jump(r,ke,Ee,be),this.radius.idle(r),this.up.jump(r,_,x,T),this.right.jump(r,P,O,F),y===2){var Y=n[1],K=n[5],D=n[9],B=Y*P+K*O+D*F,q=Y*Z+K*Q+D*X;C=te<0?-Math.PI/2:Math.PI/2,M=Math.atan2(q,B)}else{var ee=n[2],J=n[6],$=n[10],te=ee*_+J*x+$*T,ie=ee*P+J*O+$*F,ae=ee*Z+J*Q+$*X;C=Math.asin(i(te)),M=Math.atan2(ae,ie)}this.angle.jump(r,M,C),this.recalcMatrix(r);var he=n[2],se=n[6],de=n[10],ce=this.computedMatrix;m(ce,n);var ve=ce[15],ke=ce[12]/ve,Ee=ce[13]/ve,be=ce[14]/ve,xe=Math.exp(this.computedRadius[0]);this.center.jump(r,ke-he*xe,Ee-se*xe,be-de*xe)},a.lastT=function(){return Math.max(this.center.lastT(),this.up.lastT(),this.right.lastT(),this.radius.lastT(),this.angle.lastT())},a.idle=function(r){this.center.idle(r),this.up.idle(r),this.right.idle(r),this.radius.idle(r),this.angle.idle(r)},a.flush=function(r){this.center.flush(r),this.up.flush(r),this.right.flush(r),this.radius.flush(r),this.angle.flush(r)},a.setDistance=function(r,n){n>0&&this.radius.set(r,Math.log(n))},a.lookAt=function(r,n,d,l){this.recalcMatrix(r),n=n||this.computedEye,d=d||this.computedCenter;var y=(l=l||this.computedUp)[0],v=l[1],_=l[2],x=u(y,v,_);if(!(x<1e-6)){y/=x,v/=x,_/=x;var T=n[0]-d[0],A=n[1]-d[1],S=n[2]-d[2],w=u(T,A,S);if(!(w<1e-6)){T/=w,A/=w,S/=w;var L=this.computedRight,k=L[0],C=L[1],M=L[2],P=y*k+v*C+_*M,O=u(k-=P*y,C-=P*v,M-=P*_);if(!(O<.01&&(O=u(k=v*S-_*A,C=_*T-y*S,M=y*A-v*T))<1e-6)){k/=O,C/=O,M/=O,this.up.set(r,y,v,_),this.right.set(r,k,C,M),this.center.set(r,d[0],d[1],d[2]),this.radius.set(r,Math.log(w));var F=v*M-_*C,j=_*k-y*M,W=y*C-v*k,Z=u(F,j,W),Q=y*T+v*A+_*S,X=k*T+C*A+M*S,G=(F/=Z)*T+(j/=Z)*A+(W/=Z)*S,Y=Math.asin(i(Q)),K=Math.atan2(G,X),D=this.angle._state,B=D[D.length-1],q=D[D.length-2];B%=2*Math.PI;var ee=Math.abs(B+2*Math.PI-K),J=Math.abs(B-K),$=Math.abs(B-2*Math.PI-K);ee<J&&(B+=2*Math.PI),$<J&&(B-=2*Math.PI),this.angle.jump(this.angle.lastT(),B,q),this.angle.set(r,K,Y)}}}}},{"filtered-vector":247,"gl-mat4/invert":293,"gl-mat4/rotate":299,"gl-vec3/cross":360,"gl-vec3/dot":365,"gl-vec3/normalize":382}],588:[function(h,N,H){N.exports=function(m,g,p){var e=m*g,f=t*m,u=f-(f-m),i=m-u,s=t*g,o=s-(s-g),a=g-o,c=i*a-(e-u*o-i*o-u*a);return p?(p[0]=c,p[1]=e,p):[c,e]};var t=+(Math.pow(2,27)+1)},{}],589:[function(h,N,H){N.exports=function(t,m,g){var p=t+m,e=p-t,f=m-e,u=t-(p-e);return g?(g[0]=u+f,g[1]=p,g):[u+f,p]}},{}],590:[function(h,N,H){var t=h("../prototype/is");N.exports=function(m){if(typeof m!="function"||!hasOwnProperty.call(m,"length"))return!1;try{if(typeof m.length!="number"||typeof m.call!="function"||typeof m.apply!="function")return!1}catch(g){return!1}return!t(m)}},{"../prototype/is":597}],591:[function(h,N,H){var t=h("../value/is"),m=h("../object/is"),g=h("../string/coerce"),p=h("./to-short-string"),e=function(f,u){return f.replace("%v",p(u))};N.exports=function(f,u,i){if(!m(i))throw new TypeError(e(u,f));if(!t(f)){if("default"in i)return i.default;if(i.isOptional)return null}var s=g(i.errorMessage);throw t(s)||(s=u),new TypeError(e(s,f))}},{"../object/is":594,"../string/coerce":598,"../value/is":600,"./to-short-string":593}],592:[function(h,N,H){N.exports=function(t){try{return t.toString()}catch(m){try{return String(t)}catch(g){return null}}}},{}],593:[function(h,N,H){var t=h("./safe-to-string"),m=/[\n\r\u2028\u2029]/g;N.exports=function(g){var p=t(g);return p===null?"<Non-coercible to string value>":(p.length>100&&(p=p.slice(0,99)+"\u2026"),p=p.replace(m,function(e){switch(e){case`
`:return"\\n";case"\r":return"\\r";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw new Error("Unexpected character")}}))}},{"./safe-to-string":592}],594:[function(h,N,H){var t=h("../value/is"),m={object:!0,function:!0,undefined:!0};N.exports=function(g){return!!t(g)&&hasOwnProperty.call(m,typeof g)}},{"../value/is":600}],595:[function(h,N,H){var t=h("../lib/resolve-exception"),m=h("./is");N.exports=function(g){return m(g)?g:t(g,"%v is not a plain function",arguments[1])}},{"../lib/resolve-exception":591,"./is":596}],596:[function(h,N,H){var t=h("../function/is"),m=/^\s*class[\s{/}]/,g=Function.prototype.toString;N.exports=function(p){return!!t(p)&&!m.test(g.call(p))}},{"../function/is":590}],597:[function(h,N,H){var t=h("../object/is");N.exports=function(m){if(!t(m))return!1;try{return!!m.constructor&&m.constructor.prototype===m}catch(g){return!1}}},{"../object/is":594}],598:[function(h,N,H){var t=h("../value/is"),m=h("../object/is"),g=Object.prototype.toString;N.exports=function(p){if(!t(p))return null;if(m(p)){var e=p.toString;if(typeof e!="function"||e===g)return null}try{return""+p}catch(f){return null}}},{"../object/is":594,"../value/is":600}],599:[function(h,N,H){var t=h("../lib/resolve-exception"),m=h("./is");N.exports=function(g){return m(g)?g:t(g,"Cannot use %v",arguments[1])}},{"../lib/resolve-exception":591,"./is":600}],600:[function(h,N,H){N.exports=function(t){return t!=null}},{}],601:[function(h,N,H){(function(t){(function(){var m=h("bit-twiddle"),g=h("dup"),p=h("buffer").Buffer;t.__TYPEDARRAY_POOL||(t.__TYPEDARRAY_POOL={UINT8:g([32,0]),UINT16:g([32,0]),UINT32:g([32,0]),BIGUINT64:g([32,0]),INT8:g([32,0]),INT16:g([32,0]),INT32:g([32,0]),BIGINT64:g([32,0]),FLOAT:g([32,0]),DOUBLE:g([32,0]),DATA:g([32,0]),UINT8C:g([32,0]),BUFFER:g([32,0])});var e=typeof Uint8ClampedArray!="undefined",f=typeof BigUint64Array!="undefined",u=typeof BigInt64Array!="undefined",i=t.__TYPEDARRAY_POOL;i.UINT8C||(i.UINT8C=g([32,0])),i.BIGUINT64||(i.BIGUINT64=g([32,0])),i.BIGINT64||(i.BIGINT64=g([32,0])),i.BUFFER||(i.BUFFER=g([32,0]));var s=i.DATA,o=i.BUFFER;function a(k){if(k){var C=k.length||k.byteLength,M=m.log2(C);s[M].push(k)}}function c(k){k=m.nextPow2(k);var C=m.log2(k),M=s[C];return M.length>0?M.pop():new ArrayBuffer(k)}function r(k){return new Uint8Array(c(k),0,k)}function n(k){return new Uint16Array(c(2*k),0,k)}function d(k){return new Uint32Array(c(4*k),0,k)}function l(k){return new Int8Array(c(k),0,k)}function y(k){return new Int16Array(c(2*k),0,k)}function v(k){return new Int32Array(c(4*k),0,k)}function _(k){return new Float32Array(c(4*k),0,k)}function x(k){return new Float64Array(c(8*k),0,k)}function T(k){return e?new Uint8ClampedArray(c(k),0,k):r(k)}function A(k){return f?new BigUint64Array(c(8*k),0,k):null}function S(k){return u?new BigInt64Array(c(8*k),0,k):null}function w(k){return new DataView(c(k),0,k)}function L(k){k=m.nextPow2(k);var C=m.log2(k),M=o[C];return M.length>0?M.pop():new p(k)}H.free=function(k){if(p.isBuffer(k))o[m.log2(k.length)].push(k);else{if(Object.prototype.toString.call(k)!=="[object ArrayBuffer]"&&(k=k.buffer),!k)return;var C=k.length||k.byteLength,M=0|m.log2(C);s[M].push(k)}},H.freeUint8=H.freeUint16=H.freeUint32=H.freeBigUint64=H.freeInt8=H.freeInt16=H.freeInt32=H.freeBigInt64=H.freeFloat32=H.freeFloat=H.freeFloat64=H.freeDouble=H.freeUint8Clamped=H.freeDataView=function(k){a(k.buffer)},H.freeArrayBuffer=a,H.freeBuffer=function(k){o[m.log2(k.length)].push(k)},H.malloc=function(k,C){if(C===void 0||C==="arraybuffer")return c(k);switch(C){case"uint8":return r(k);case"uint16":return n(k);case"uint32":return d(k);case"int8":return l(k);case"int16":return y(k);case"int32":return v(k);case"float":case"float32":return _(k);case"double":case"float64":return x(k);case"uint8_clamped":return T(k);case"bigint64":return S(k);case"biguint64":return A(k);case"buffer":return L(k);case"data":case"dataview":return w(k);default:return null}return null},H.mallocArrayBuffer=c,H.mallocUint8=r,H.mallocUint16=n,H.mallocUint32=d,H.mallocInt8=l,H.mallocInt16=y,H.mallocInt32=v,H.mallocFloat32=H.mallocFloat=_,H.mallocFloat64=H.mallocDouble=x,H.mallocUint8Clamped=T,H.mallocBigUint64=A,H.mallocBigInt64=S,H.mallocDataView=w,H.mallocBuffer=L,H.clearCache=function(){for(var k=0;k<32;++k)i.UINT8[k].length=0,i.UINT16[k].length=0,i.UINT32[k].length=0,i.INT8[k].length=0,i.INT16[k].length=0,i.INT32[k].length=0,i.FLOAT[k].length=0,i.DOUBLE[k].length=0,i.BIGUINT64[k].length=0,i.BIGINT64[k].length=0,i.UINT8C[k].length=0,s[k].length=0,o[k].length=0}}).call(this)}).call(this,typeof La!="undefined"?La:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"bit-twiddle":104,buffer:117,dup:182}],602:[function(h,N,H){function t(g){this.roots=new Array(g),this.ranks=new Array(g);for(var p=0;p<g;++p)this.roots[p]=p,this.ranks[p]=0}N.exports=t;var m=t.prototype;Object.defineProperty(m,"length",{get:function(){return this.roots.length}}),m.makeSet=function(){var g=this.roots.length;return this.roots.push(g),this.ranks.push(0),g},m.find=function(g){for(var p=g,e=this.roots;e[g]!==g;)g=e[g];for(;e[p]!==g;){var f=e[p];e[p]=g,p=f}return g},m.link=function(g,p){var e=this.find(g),f=this.find(p);if(e!==f){var u=this.ranks,i=this.roots,s=u[e],o=u[f];s<o?i[e]=f:o<s?i[f]=e:(i[f]=e,++u[e])}}},{}],603:[function(h,N,H){N.exports=function(t,m,g){return t.length===0?t:m?(g||t.sort(m),function(p,e){for(var f=1,u=p.length,i=p[0],s=p[0],o=1;o<u;++o)if(s=i,e(i=p[o],s)){if(o===f){f++;continue}p[f++]=i}return p.length=f,p}(t,m)):(g||t.sort(),function(p){for(var e=1,f=p.length,u=p[0],i=p[0],s=1;s<f;++s,i=u)if(i=u,(u=p[s])!==i){if(s===e){e++;continue}p[e++]=u}return p.length=e,p}(t))}},{}],604:[function(h,N,H){var t=/[\'\"]/;N.exports=function(m){return m?(t.test(m.charAt(0))&&(m=m.substr(1)),t.test(m.charAt(m.length-1))&&(m=m.substr(0,m.length-1)),m):""}},{}],605:[function(h,N,H){N.exports=function(t,m,g){Array.isArray(g)||(g=[].slice.call(arguments,2));for(var p=0,e=g.length;p<e;p++){var f=g[p];for(var u in f)if((m[u]===void 0||Array.isArray(m[u])||t[u]!==m[u])&&u in m){var i;if(f[u]===!0)i=m[u];else if(f[u]===!1||typeof f[u]=="function"&&(i=f[u](m[u],t,m))===void 0)continue;t[u]=i}}return t}},{}],606:[function(h,N,H){(function(t){(function(){function m(g){try{if(!t.localStorage)return!1}catch(e){return!1}var p=t.localStorage[g];return p!=null&&String(p).toLowerCase()==="true"}N.exports=function(g,p){if(m("noDeprecation"))return g;var e=!1;return function(){if(!e){if(m("throwDeprecation"))throw new Error(p);m("traceDeprecation")?console.trace(p):console.warn(p),e=!0}return g.apply(this,arguments)}}}).call(this)}).call(this,typeof La!="undefined"?La:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],607:[function(h,N,H){N.exports=function(p,e){return typeof e=="object"&&e!==null||(e={}),t(p,e.canvas||m,e.context||g,e)};var t=h("./lib/vtext"),m=null,g=null;typeof document!="undefined"&&((m=document.createElement("canvas")).width=8192,m.height=1024,g=m.getContext("2d"))},{"./lib/vtext":608}],608:[function(h,N,H){N.exports=function(a,c,r,n){var d=64,l=1.25,y={breaklines:!1,bolds:!1,italics:!1,subscripts:!1,superscripts:!1};return n&&(n.size&&n.size>0&&(d=n.size),n.lineSpacing&&n.lineSpacing>0&&(l=n.lineSpacing),n.styletags&&n.styletags.breaklines&&(y.breaklines=!!n.styletags.breaklines),n.styletags&&n.styletags.bolds&&(y.bolds=!!n.styletags.bolds),n.styletags&&n.styletags.italics&&(y.italics=!!n.styletags.italics),n.styletags&&n.styletags.subscripts&&(y.subscripts=!!n.styletags.subscripts),n.styletags&&n.styletags.superscripts&&(y.superscripts=!!n.styletags.superscripts)),r.font=[n.fontStyle,n.fontVariant,n.fontWeight,d+"px",n.font].filter(function(v){return v}).join(" "),r.textAlign="start",r.textBaseline="alphabetic",r.direction="ltr",o(function(v,_,x,T,A,S){x=x.replace(/\n/g,""),x=S.breaklines===!0?x.replace(/\<br\>/g,`
`):x.replace(/\<br\>/g," ");var w="",L=[];for(P=0;P<x.length;++P)L[P]=w;S.bolds===!0&&(L=u("b","b|",x,L)),S.italics===!0&&(L=u("i","i|",x,L)),S.superscripts===!0&&(L=u("sup","+1",x,L)),S.subscripts===!0&&(L=u("sub","-1",x,L));var k=[],C="";for(P=0;P<x.length;++P)L[P]!==null&&(C+=x[P],k.push(L[P]));var M,P,O,F,j,W=C.split(`
`),Z=W.length,Q=Math.round(A*T),X=T,G=2*T,Y=0,K=Z*Q+G;v.height<K&&(v.height=K),_.fillStyle="#000",_.fillRect(0,0,v.width,v.height),_.fillStyle="#fff";var D=0,B="";function q(){if(B!==""){var se=_.measureText(B).width;_.fillText(B,X+O,G+F),O+=se}}function ee(){return Math.round(j)+"px "}function J(se,de){var ce=""+_.font;if(S.subscripts===!0){var ve=se.indexOf("-"),ke=de.indexOf("-"),Ee=ve>-1?parseInt(se[1+ve]):0,be=ke>-1?parseInt(de[1+ke]):0;Ee!==be&&(ce=ce.replace(ee(),"?px "),j*=Math.pow(.75,be-Ee),ce=ce.replace("?px ",ee())),F+=.25*Q*(be-Ee)}if(S.superscripts===!0){var xe=se.indexOf("+"),ue=de.indexOf("+"),me=xe>-1?parseInt(se[1+xe]):0,we=ue>-1?parseInt(de[1+ue]):0;me!==we&&(ce=ce.replace(ee(),"?px "),j*=Math.pow(.75,we-me),ce=ce.replace("?px ",ee())),F-=.25*Q*(we-me)}if(S.bolds===!0){var Me=se.indexOf("b|")>-1,Se=de.indexOf("b|")>-1;!Me&&Se&&(ce=De?ce.replace("italic ","italic bold "):"bold "+ce),Me&&!Se&&(ce=ce.replace("bold ",""))}if(S.italics===!0){var De=se.indexOf("i|")>-1,Fe=de.indexOf("i|")>-1;!De&&Fe&&(ce="italic "+ce),De&&!Fe&&(ce=ce.replace("italic ",""))}_.font=ce}for(M=0;M<Z;++M){var $=W[M]+`
`;for(O=0,F=M*Q,j=T,B="",P=0;P<$.length;++P){var te=P+D<k.length?k[P+D]:k[k.length-1];w===te?B+=$[P]:(q(),B=$[P],te!==void 0&&(J(w,te),w=te))}q(),D+=$.length;var ie=0|Math.round(O+2*X);Y<ie&&(Y=ie)}var ae=Y,he=G+Q*Z;return m(_.getImageData(0,0,ae,he).data,[he,ae,4]).pick(-1,-1,0).transpose(1,0)}(c,r,a,d,l,y),n,d)},N.exports.processPixels=o;var t=h("surface-nets"),m=h("ndarray"),g=h("simplify-planar-graph"),p=h("clean-pslg"),e=h("cdt2d"),f=h("planar-graph-to-polyline");function u(a,c,r,n){for(var d="<"+a+">",l="</"+a+">",y=d.length,v=l.length,_=c[0]==="+"||c[0]==="-",x=0,T=-v;x>-1&&(x=r.indexOf(d,x))!==-1&&(T=r.indexOf(l,x+y))!==-1&&!(T<=x);){for(var A=x;A<T+v;++A)if(A<x+y||A>=T)n[A]=null,r=r.substr(0,A)+" "+r.substr(A+1);else if(n[A]!==null){var S=n[A].indexOf(c[0]);S===-1?n[A]+=c:_&&(n[A]=n[A].substr(0,S+1)+(1+parseInt(n[A][S+1]))+n[A].substr(S+2))}var w=x+y,L=r.substr(w,T-w).indexOf(d);x=L!==-1?L:T+v}return n}function i(a,c){var r=t(a,128);return c?g(r.cells,r.positions,.25):{edges:r.cells,positions:r.positions}}function s(a,c,r,n){var d=i(a,n),l=function(M,P,O){for(var F=P.textAlign||"start",j=P.textBaseline||"alphabetic",W=[1<<30,1<<30],Z=[0,0],Q=M.length,X=0;X<Q;++X)for(var G=M[X],Y=0;Y<2;++Y)W[Y]=0|Math.min(W[Y],G[Y]),Z[Y]=0|Math.max(Z[Y],G[Y]);var K=0;switch(F){case"center":K=-.5*(W[0]+Z[0]);break;case"right":case"end":K=-Z[0];break;case"left":case"start":K=-W[0];break;default:throw new Error("vectorize-text: Unrecognized textAlign: '"+F+"'")}var D=0;switch(j){case"hanging":case"top":D=-W[1];break;case"middle":D=-.5*(W[1]+Z[1]);break;case"alphabetic":case"ideographic":D=-3*O;break;case"bottom":D=-Z[1];break;default:throw new Error("vectorize-text: Unrecoginized textBaseline: '"+j+"'")}var B=1/O;return"lineHeight"in P?B*=+P.lineHeight:"width"in P?B=P.width/(Z[0]-W[0]):"height"in P&&(B=P.height/(Z[1]-W[1])),M.map(function(q){return[B*(q[0]+K),B*(q[1]+D)]})}(d.positions,c,r),y=d.edges,v=c.orientation==="ccw";if(p(l,y),c.polygons||c.polygon||c.polyline){for(var _=f(y,l),x=new Array(_.length),T=0;T<_.length;++T){for(var A=_[T],S=new Array(A.length),w=0;w<A.length;++w){for(var L=A[w],k=new Array(L.length),C=0;C<L.length;++C)k[C]=l[L[C]].slice();v&&k.reverse(),S[w]=k}x[T]=S}return x}return c.triangles||c.triangulate||c.triangle?{cells:e(l,y,{delaunay:!1,exterior:!1,interior:!0}),positions:l}:{edges:y,positions:l}}function o(a,c,r){try{return s(a,c,r,!0)}catch(n){}try{return s(a,c,r,!1)}catch(n){}return c.polygons||c.polyline||c.polygon?[]:c.triangles||c.triangulate||c.triangle?{cells:[],positions:[]}:{edges:[],positions:[]}}},{cdt2d:118,"clean-pslg":127,ndarray:472,"planar-graph-to-polyline":488,"simplify-planar-graph":549,"surface-nets":576}],609:[function(h,N,H){(function(){if(typeof ses=="undefined"||!ses.ok||ses.ok()){typeof ses!="undefined"&&(ses.weakMapPermitHostObjects=d);var t=!1;if(typeof WeakMap=="function"){var m=WeakMap;if(!(typeof navigator!="undefined"&&/Firefox/.test(navigator.userAgent))){var g=new m,p=Object.freeze({});if(g.set(p,1),g.get(p)===1)return void(N.exports=WeakMap);t=!0}}var e=Object.getOwnPropertyNames,f=Object.defineProperty,u=Object.isExtensible,i="weakmap:ident:"+Math.random()+"___";if(typeof crypto!="undefined"&&typeof crypto.getRandomValues=="function"&&typeof ArrayBuffer=="function"&&typeof Uint8Array=="function"){var s=new ArrayBuffer(25),o=new Uint8Array(s);crypto.getRandomValues(o),i="weakmap:rand:"+Array.prototype.map.call(o,function(x){return(x%36).toString(36)}).join("")+"___"}if(f(Object,"getOwnPropertyNames",{value:function(x){return e(x).filter(l)}}),"getPropertyNames"in Object){var a=Object.getPropertyNames;f(Object,"getPropertyNames",{value:function(x){return a(x).filter(l)}})}(function(){var x=Object.freeze;f(Object,"freeze",{value:function(S){return y(S),x(S)}});var T=Object.seal;f(Object,"seal",{value:function(S){return y(S),T(S)}});var A=Object.preventExtensions;f(Object,"preventExtensions",{value:function(S){return y(S),A(S)}})})();var c=!1,r=0,n=function(){this instanceof n||_();var x=[],T=[],A=r++;return Object.create(n.prototype,{get___:{value:v(function(S,w){var L,k=y(S);return k?A in k?k[A]:w:(L=x.indexOf(S))>=0?T[L]:w})},has___:{value:v(function(S){var w=y(S);return w?A in w:x.indexOf(S)>=0})},set___:{value:v(function(S,w){var L,k=y(S);return k?k[A]=w:(L=x.indexOf(S))>=0?T[L]=w:(L=x.length,T[L]=w,x[L]=S),this})},delete___:{value:v(function(S){var w,L,k=y(S);return k?A in k&&delete k[A]:!((w=x.indexOf(S))<0)&&(L=x.length-1,x[w]=void 0,T[w]=T[L],x[w]=x[L],x.length=L,T.length=L,!0)})}})};n.prototype=Object.create(Object.prototype,{get:{value:function(x,T){return this.get___(x,T)},writable:!0,configurable:!0},has:{value:function(x){return this.has___(x)},writable:!0,configurable:!0},set:{value:function(x,T){return this.set___(x,T)},writable:!0,configurable:!0},delete:{value:function(x){return this.delete___(x)},writable:!0,configurable:!0}}),typeof m=="function"?function(){function x(){this instanceof n||_();var T,A=new m,S=void 0,w=!1;return T=t?function(L,k){return A.set(L,k),A.has(L)||(S||(S=new n),S.set(L,k)),this}:function(L,k){if(w)try{A.set(L,k)}catch(C){S||(S=new n),S.set___(L,k)}else A.set(L,k);return this},Object.create(n.prototype,{get___:{value:v(function(L,k){return S?A.has(L)?A.get(L):S.get___(L,k):A.get(L,k)})},has___:{value:v(function(L){return A.has(L)||!!S&&S.has___(L)})},set___:{value:v(T)},delete___:{value:v(function(L){var k=!!A.delete(L);return S&&S.delete___(L)||k})},permitHostObjects___:{value:v(function(L){if(L!==d)throw new Error("bogus call to permitHostObjects___");w=!0})}})}t&&typeof Proxy!="undefined"&&(Proxy=void 0),x.prototype=n.prototype,N.exports=x,Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:!1,configurable:!0,writable:!0})}():(typeof Proxy!="undefined"&&(Proxy=void 0),N.exports=n)}function d(x){x.permitHostObjects___&&x.permitHostObjects___(d)}function l(x){return!(x.substr(0,"weakmap:".length)=="weakmap:"&&x.substr(x.length-3)==="___")}function y(x){if(x!==Object(x))throw new TypeError("Not an object: "+x);var T=x[i];if(T&&T.key===x)return T;if(u(x)){T={key:x};try{return f(x,i,{value:T,writable:!1,enumerable:!1,configurable:!1}),T}catch(A){return}}}function v(x){return x.prototype=null,Object.freeze(x)}function _(){c||typeof console=="undefined"||(c=!0,console.warn("WeakMap should be invoked as new WeakMap(), not WeakMap(). This will be an error in the future."))}})()},{}],610:[function(h,N,H){var t=h("./hidden-store.js");N.exports=function(){var m={};return function(g){if((typeof g!="object"||g===null)&&typeof g!="function")throw new Error("Weakmap-shim: Key must be object");var p=g.valueOf(m);return p&&p.identity===m?p:t(g,m)}}},{"./hidden-store.js":611}],611:[function(h,N,H){N.exports=function(t,m){var g={identity:m},p=t.valueOf;return Object.defineProperty(t,"valueOf",{value:function(e){return e!==m?p.apply(this,arguments):g},writable:!0}),g}},{}],612:[function(h,N,H){var t=h("./create-store.js");N.exports=function(){var m=t();return{get:function(g,p){var e=m(g);return e.hasOwnProperty("value")?e.value:p},set:function(g,p){return m(g).value=p,this},has:function(g){return"value"in m(g)},delete:function(g){return delete m(g).value}}}},{"./create-store.js":610}],613:[function(h,N,H){var t=h("get-canvas-context");N.exports=function(m){return t("webgl",m)}},{"get-canvas-context":252}],614:[function(h,N,H){var t=h("../main"),m=h("object-assign"),g=t.instance();function p(a){this.local=this.regionalOptions[a||""]||this.regionalOptions[""]}p.prototype=new t.baseCalendar,m(p.prototype,{name:"Chinese",jdEpoch:17214255e-1,hasYearZero:!1,minMonth:0,firstMonth:0,minDay:1,regionalOptions:{"":{name:"Chinese",epochs:["BEC","EC"],monthNumbers:function(a,c){if(typeof a=="string"){var r=a.match(f);return r?r[0]:""}var n=this._validateYear(a),d=a.month(),l=""+this.toChineseMonth(n,d);return c&&l.length<2&&(l="0"+l),this.isIntercalaryMonth(n,d)&&(l+="i"),l},monthNames:function(a){if(typeof a=="string"){var c=a.match(u);return c?c[0]:""}var r=this._validateYear(a),n=a.month(),d=["\u4E00\u6708","\u4E8C\u6708","\u4E09\u6708","\u56DB\u6708","\u4E94\u6708","\u516D\u6708","\u4E03\u6708","\u516B\u6708","\u4E5D\u6708","\u5341\u6708","\u5341\u4E00\u6708","\u5341\u4E8C\u6708"][this.toChineseMonth(r,n)-1];return this.isIntercalaryMonth(r,n)&&(d="\u95F0"+d),d},monthNamesShort:function(a){if(typeof a=="string"){var c=a.match(i);return c?c[0]:""}var r=this._validateYear(a),n=a.month(),d=["\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D","\u5341","\u5341\u4E00","\u5341\u4E8C"][this.toChineseMonth(r,n)-1];return this.isIntercalaryMonth(r,n)&&(d="\u95F0"+d),d},parseMonth:function(a,c){a=this._validateYear(a);var r,n=parseInt(c);if(isNaN(n))c[0]==="\u95F0"&&(r=!0,c=c.substring(1)),c[c.length-1]==="\u6708"&&(c=c.substring(0,c.length-1)),n=1+["\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D","\u5341","\u5341\u4E00","\u5341\u4E8C"].indexOf(c);else{var d=c[c.length-1];r=d==="i"||d==="I"}return this.toMonthIndex(a,n,r)},dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},_validateYear:function(a,c){if(a.year&&(a=a.year()),typeof a!="number"||a<1888||a>2111)throw c.replace(/\{0\}/,this.local.name);return a},toMonthIndex:function(a,c,r){var n=this.intercalaryMonth(a);if(r&&c!==n||c<1||c>12)throw t.local.invalidMonth.replace(/\{0\}/,this.local.name);return n?!r&&c<=n?c-1:c:c-1},toChineseMonth:function(a,c){a.year&&(c=(a=a.year()).month());var r=this.intercalaryMonth(a);if(c<0||c>(r?12:11))throw t.local.invalidMonth.replace(/\{0\}/,this.local.name);return r?c<r?c+1:c:c+1},intercalaryMonth:function(a){return a=this._validateYear(a),s[a-s[0]]>>13},isIntercalaryMonth:function(a,c){a.year&&(c=(a=a.year()).month());var r=this.intercalaryMonth(a);return!!r&&r===c},leapYear:function(a){return this.intercalaryMonth(a)!==0},weekOfYear:function(a,c,r){var n,d=this._validateYear(a,t.local.invalidyear),l=o[d-o[0]],y=l>>9&4095,v=l>>5&15,_=31&l;(n=g.newDate(y,v,_)).add(4-(n.dayOfWeek()||7),"d");var x=this.toJD(a,c,r)-n.toJD();return 1+Math.floor(x/7)},monthsInYear:function(a){return this.leapYear(a)?13:12},daysInMonth:function(a,c){a.year&&(c=a.month(),a=a.year()),a=this._validateYear(a);var r=s[a-s[0]];if(c>(r>>13?12:11))throw t.local.invalidMonth.replace(/\{0\}/,this.local.name);return r&1<<12-c?30:29},weekDay:function(a,c,r){return(this.dayOfWeek(a,c,r)||7)<6},toJD:function(a,c,r){var n=this._validate(a,l,r,t.local.invalidDate);a=this._validateYear(n.year()),c=n.month(),r=n.day();var d=this.isIntercalaryMonth(a,c),l=this.toChineseMonth(a,c),y=function(v,_,x,T,A){var S,w,L;if(typeof v=="object")w=v,S=_||{};else{var k;if(!(typeof v=="number"&&v>=1888&&v<=2111))throw new Error("Lunar year outside range 1888-2111");if(!(typeof _=="number"&&_>=1&&_<=12))throw new Error("Lunar month outside range 1 - 12");if(!(typeof x=="number"&&x>=1&&x<=30))throw new Error("Lunar day outside range 1 - 30");typeof T=="object"?(k=!1,S=T):(k=!!T,S=A||{}),w={year:v,month:_,day:x,isIntercalary:k}}L=w.day-1;var C,M=s[w.year-s[0]],P=M>>13;C=P&&(w.month>P||w.isIntercalary)?w.month:w.month-1;for(var O=0;O<C;O++)L+=M&1<<12-O?30:29;var F=o[w.year-o[0]],j=new Date(F>>9&4095,(F>>5&15)-1,(31&F)+L);return S.year=j.getFullYear(),S.month=1+j.getMonth(),S.day=j.getDate(),S}(a,l,r,d);return g.toJD(y.year,y.month,y.day)},fromJD:function(a){var c=g.fromJD(a),r=function(d,l,y,v){var _,x;if(typeof d=="object")_=d,x=l||{};else{if(!(typeof d=="number"&&d>=1888&&d<=2111))throw new Error("Solar year outside range 1888-2111");if(!(typeof l=="number"&&l>=1&&l<=12))throw new Error("Solar month outside range 1 - 12");if(!(typeof y=="number"&&y>=1&&y<=31))throw new Error("Solar day outside range 1 - 31");_={year:d,month:l,day:y},x=v||{}}var T=o[_.year-o[0]],A=_.year<<9|_.month<<5|_.day;x.year=A>=T?_.year:_.year-1,T=o[x.year-o[0]];var S,w=new Date(T>>9&4095,(T>>5&15)-1,31&T),L=new Date(_.year,_.month-1,_.day);S=Math.round((L-w)/864e5);var k,C=s[x.year-s[0]];for(k=0;k<13;k++){var M=C&1<<12-k?30:29;if(S<M)break;S-=M}var P=C>>13;return!P||k<P?(x.isIntercalary=!1,x.month=1+k):k===P?(x.isIntercalary=!0,x.month=k):(x.isIntercalary=!1,x.month=k),x.day=1+S,x}(c.year(),c.month(),c.day()),n=this.toMonthIndex(r.year,r.month,r.isIntercalary);return this.newDate(r.year,n,r.day)},fromString:function(a){var c=a.match(e),r=this._validateYear(+c[1]),n=+c[2],d=!!c[3],l=this.toMonthIndex(r,n,d),y=+c[4];return this.newDate(r,l,y)},add:function(a,c,r){var n=a.year(),d=a.month(),l=this.isIntercalaryMonth(n,d),y=this.toChineseMonth(n,d),v=Object.getPrototypeOf(p.prototype).add.call(this,a,c,r);if(r==="y"){var _=v.year(),x=v.month(),T=this.isIntercalaryMonth(_,y),A=l&&T?this.toMonthIndex(_,y,!0):this.toMonthIndex(_,y,!1);A!==x&&v.month(A)}return v}});var e=/^\s*(-?\d\d\d\d|\d\d)[-/](\d?\d)([iI]?)[-/](\d?\d)/m,f=/^\d?\d[iI]?/m,u=/^\u95f0?\u5341?[\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]?\u6708/m,i=/^\u95f0?\u5341?[\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]?/m;t.calendars.chinese=p;var s=[1887,5780,5802,19157,2742,50359,1198,2646,46378,7466,3412,30122,5482,67949,2396,5294,43597,6732,6954,36181,2772,4954,18781,2396,54427,5274,6730,47781,5800,6868,21210,4790,59703,2350,5270,46667,3402,3496,38325,1388,4782,18735,2350,52374,6804,7498,44457,2906,1388,29294,4700,63789,6442,6804,56138,5802,2772,38235,1210,4698,22827,5418,63125,3476,5802,43701,2484,5302,27223,2646,70954,7466,3412,54698,5482,2412,38062,5294,2636,32038,6954,60245,2772,4826,43357,2394,5274,39501,6730,72357,5800,5844,53978,4790,2358,38039,5270,87627,3402,3496,54708,5484,4782,43311,2350,3222,27978,7498,68965,2904,5484,45677,4700,6444,39573,6804,6986,19285,2772,62811,1210,4698,47403,5418,5780,38570,5546,76469,2420,5302,51799,2646,5414,36501,3412,5546,18869,2412,54446,5276,6732,48422,6822,2900,28010,4826,92509,2394,5274,55883,6730,6820,47956,5812,2778,18779,2358,62615,5270,5450,46757,3492,5556,27318,4718,67887,2350,3222,52554,7498,3428,38252,5468,4700,31022,6444,64149,6804,6986,43861,2772,5338,35421,2650,70955,5418,5780,54954,5546,2740,38074,5302,2646,29991,3366,61011,3412,5546,43445,2412,5294,35406,6732,72998,6820,6996,52586,2778,2396,38045,5274,6698,23333,6820,64338,5812,2746,43355,2358,5270,39499,5450,79525,3492,5548],o=[1887,966732,967231,967733,968265,968766,969297,969798,970298,970829,971330,971830,972362,972863,973395,973896,974397,974928,975428,975929,976461,976962,977462,977994,978494,979026,979526,980026,980558,981059,981559,982091,982593,983124,983624,984124,984656,985157,985656,986189,986690,987191,987722,988222,988753,989254,989754,990286,990788,991288,991819,992319,992851,993352,993851,994383,994885,995385,995917,996418,996918,997450,997949,998481,998982,999483,1000014,1000515,1001016,1001548,1002047,1002578,1003080,1003580,1004111,1004613,1005113,1005645,1006146,1006645,1007177,1007678,1008209,1008710,1009211,1009743,1010243,1010743,1011275,1011775,1012306,1012807,1013308,1013840,1014341,1014841,1015373,1015874,1016404,1016905,1017405,1017937,1018438,1018939,1019471,1019972,1020471,1021002,1021503,1022035,1022535,1023036,1023568,1024069,1024568,1025100,1025601,1026102,1026633,1027133,1027666,1028167,1028666,1029198,1029699,1030199,1030730,1031231,1031763,1032264,1032764,1033296,1033797,1034297,1034828,1035329,1035830,1036362,1036861,1037393,1037894,1038394,1038925,1039427,1039927,1040459,1040959,1041491,1041992,1042492,1043023,1043524,1044024,1044556,1045057,1045558,1046090,1046590,1047121,1047622,1048122,1048654,1049154,1049655,1050187,1050689,1051219,1051720,1052220,1052751,1053252,1053752,1054284,1054786,1055285,1055817,1056317,1056849,1057349,1057850,1058382,1058883,1059383,1059915,1060415,1060947,1061447,1061947,1062479,1062981,1063480,1064012,1064514,1065014,1065545,1066045,1066577,1067078,1067578,1068110,1068611,1069112,1069642,1070142,1070674,1071175,1071675,1072207,1072709,1073209,1073740,1074241,1074741,1075273,1075773,1076305,1076807,1077308,1077839,1078340,1078840,1079372,1079871,1080403,1080904]},{"../main":628,"object-assign":476}],615:[function(h,N,H){var t=h("../main"),m=h("object-assign");function g(p){this.local=this.regionalOptions[p||""]||this.regionalOptions[""]}g.prototype=new t.baseCalendar,m(g.prototype,{name:"Coptic",jdEpoch:18250295e-1,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Coptic",epochs:["BAM","AM"],monthNames:["Thout","Paopi","Hathor","Koiak","Tobi","Meshir","Paremhat","Paremoude","Pashons","Paoni","Epip","Mesori","Pi Kogi Enavot"],monthNamesShort:["Tho","Pao","Hath","Koi","Tob","Mesh","Pat","Pad","Pash","Pao","Epi","Meso","PiK"],dayNames:["Tkyriaka","Pesnau","Pshoment","Peftoou","Ptiou","Psoou","Psabbaton"],dayNamesShort:["Tky","Pes","Psh","Pef","Pti","Pso","Psa"],dayNamesMin:["Tk","Pes","Psh","Pef","Pt","Pso","Psa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(p){var e=this._validate(p,this.minMonth,this.minDay,t.local.invalidYear);return(p=e.year()+(e.year()<0?1:0))%4==3||p%4==-1},monthsInYear:function(p){return this._validate(p,this.minMonth,this.minDay,t.local.invalidYear||t.regionalOptions[""].invalidYear),13},weekOfYear:function(p,e,f){var u=this.newDate(p,e,f);return u.add(-u.dayOfWeek(),"d"),Math.floor((u.dayOfYear()-1)/7)+1},daysInMonth:function(p,e){var f=this._validate(p,e,this.minDay,t.local.invalidMonth);return this.daysPerMonth[f.month()-1]+(f.month()===13&&this.leapYear(f.year())?1:0)},weekDay:function(p,e,f){return(this.dayOfWeek(p,e,f)||7)<6},toJD:function(p,e,f){var u=this._validate(p,e,f,t.local.invalidDate);return(p=u.year())<0&&p++,u.day()+30*(u.month()-1)+365*(p-1)+Math.floor(p/4)+this.jdEpoch-1},fromJD:function(p){var e=Math.floor(p)+.5-this.jdEpoch,f=Math.floor((e-Math.floor((e+366)/1461))/365)+1;f<=0&&f--,e=Math.floor(p)+.5-this.newDate(f,1,1).toJD();var u=Math.floor(e/30)+1,i=e-30*(u-1)+1;return this.newDate(f,u,i)}}),t.calendars.coptic=g},{"../main":628,"object-assign":476}],616:[function(h,N,H){var t=h("../main"),m=h("object-assign");function g(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}g.prototype=new t.baseCalendar,m(g.prototype,{name:"Discworld",jdEpoch:17214255e-1,daysPerMonth:[16,32,32,32,32,32,32,32,32,32,32,32,32],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Discworld",epochs:["BUC","UC"],monthNames:["Ick","Offle","February","March","April","May","June","Grune","August","Spune","Sektober","Ember","December"],monthNamesShort:["Ick","Off","Feb","Mar","Apr","May","Jun","Gru","Aug","Spu","Sek","Emb","Dec"],dayNames:["Sunday","Octeday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Oct","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Oc","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:2,isRTL:!1}},leapYear:function(e){return this._validate(e,this.minMonth,this.minDay,t.local.invalidYear),!1},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,t.local.invalidYear),13},daysInYear:function(e){return this._validate(e,this.minMonth,this.minDay,t.local.invalidYear),400},weekOfYear:function(e,f,u){var i=this.newDate(e,f,u);return i.add(-i.dayOfWeek(),"d"),Math.floor((i.dayOfYear()-1)/8)+1},daysInMonth:function(e,f){var u=this._validate(e,f,this.minDay,t.local.invalidMonth);return this.daysPerMonth[u.month()-1]},daysInWeek:function(){return 8},dayOfWeek:function(e,f,u){return(this._validate(e,f,u,t.local.invalidDate).day()+1)%8},weekDay:function(e,f,u){var i=this.dayOfWeek(e,f,u);return i>=2&&i<=6},extraInfo:function(e,f,u){var i=this._validate(e,f,u,t.local.invalidDate);return{century:p[Math.floor((i.year()-1)/100)+1]||""}},toJD:function(e,f,u){var i=this._validate(e,f,u,t.local.invalidDate);return e=i.year()+(i.year()<0?1:0),f=i.month(),(u=i.day())+(f>1?16:0)+(f>2?32*(f-2):0)+400*(e-1)+this.jdEpoch-1},fromJD:function(e){e=Math.floor(e+.5)-Math.floor(this.jdEpoch)-1;var f=Math.floor(e/400)+1;e-=400*(f-1),e+=e>15?16:0;var u=Math.floor(e/32)+1,i=e-32*(u-1)+1;return this.newDate(f<=0?f-1:f,u,i)}});var p={20:"Fruitbat",21:"Anchovy"};t.calendars.discworld=g},{"../main":628,"object-assign":476}],617:[function(h,N,H){var t=h("../main"),m=h("object-assign");function g(p){this.local=this.regionalOptions[p||""]||this.regionalOptions[""]}g.prototype=new t.baseCalendar,m(g.prototype,{name:"Ethiopian",jdEpoch:17242205e-1,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Ethiopian",epochs:["BEE","EE"],monthNames:["Meskerem","Tikemet","Hidar","Tahesas","Tir","Yekatit","Megabit","Miazia","Genbot","Sene","Hamle","Nehase","Pagume"],monthNamesShort:["Mes","Tik","Hid","Tah","Tir","Yek","Meg","Mia","Gen","Sen","Ham","Neh","Pag"],dayNames:["Ehud","Segno","Maksegno","Irob","Hamus","Arb","Kidame"],dayNamesShort:["Ehu","Seg","Mak","Iro","Ham","Arb","Kid"],dayNamesMin:["Eh","Se","Ma","Ir","Ha","Ar","Ki"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(p){var e=this._validate(p,this.minMonth,this.minDay,t.local.invalidYear);return(p=e.year()+(e.year()<0?1:0))%4==3||p%4==-1},monthsInYear:function(p){return this._validate(p,this.minMonth,this.minDay,t.local.invalidYear||t.regionalOptions[""].invalidYear),13},weekOfYear:function(p,e,f){var u=this.newDate(p,e,f);return u.add(-u.dayOfWeek(),"d"),Math.floor((u.dayOfYear()-1)/7)+1},daysInMonth:function(p,e){var f=this._validate(p,e,this.minDay,t.local.invalidMonth);return this.daysPerMonth[f.month()-1]+(f.month()===13&&this.leapYear(f.year())?1:0)},weekDay:function(p,e,f){return(this.dayOfWeek(p,e,f)||7)<6},toJD:function(p,e,f){var u=this._validate(p,e,f,t.local.invalidDate);return(p=u.year())<0&&p++,u.day()+30*(u.month()-1)+365*(p-1)+Math.floor(p/4)+this.jdEpoch-1},fromJD:function(p){var e=Math.floor(p)+.5-this.jdEpoch,f=Math.floor((e-Math.floor((e+366)/1461))/365)+1;f<=0&&f--,e=Math.floor(p)+.5-this.newDate(f,1,1).toJD();var u=Math.floor(e/30)+1,i=e-30*(u-1)+1;return this.newDate(f,u,i)}}),t.calendars.ethiopian=g},{"../main":628,"object-assign":476}],618:[function(h,N,H){var t=h("../main"),m=h("object-assign");function g(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}function p(e,f){return e-f*Math.floor(e/f)}g.prototype=new t.baseCalendar,m(g.prototype,{name:"Hebrew",jdEpoch:347995.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29,29],hasYearZero:!1,minMonth:1,firstMonth:7,minDay:1,regionalOptions:{"":{name:"Hebrew",epochs:["BAM","AM"],monthNames:["Nisan","Iyar","Sivan","Tammuz","Av","Elul","Tishrei","Cheshvan","Kislev","Tevet","Shevat","Adar","Adar II"],monthNamesShort:["Nis","Iya","Siv","Tam","Av","Elu","Tis","Che","Kis","Tev","She","Ada","Ad2"],dayNames:["Yom Rishon","Yom Sheni","Yom Shlishi","Yom Revi'i","Yom Chamishi","Yom Shishi","Yom Shabbat"],dayNamesShort:["Ris","She","Shl","Rev","Cha","Shi","Sha"],dayNamesMin:["Ri","She","Shl","Re","Ch","Shi","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var f=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear);return this._leapYear(f.year())},_leapYear:function(e){return p(7*(e=e<0?e+1:e)+1,19)<7},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,t.local.invalidYear),this._leapYear(e.year?e.year():e)?13:12},weekOfYear:function(e,f,u){var i=this.newDate(e,f,u);return i.add(-i.dayOfWeek(),"d"),Math.floor((i.dayOfYear()-1)/7)+1},daysInYear:function(e){return e=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear).year(),this.toJD(e===-1?1:e+1,7,1)-this.toJD(e,7,1)},daysInMonth:function(e,f){return e.year&&(f=e.month(),e=e.year()),this._validate(e,f,this.minDay,t.local.invalidMonth),f===12&&this.leapYear(e)||f===8&&p(this.daysInYear(e),10)===5?30:f===9&&p(this.daysInYear(e),10)===3?29:this.daysPerMonth[f-1]},weekDay:function(e,f,u){return this.dayOfWeek(e,f,u)!==6},extraInfo:function(e,f,u){var i=this._validate(e,f,u,t.local.invalidDate);return{yearType:(this.leapYear(i)?"embolismic":"common")+" "+["deficient","regular","complete"][this.daysInYear(i)%10-3]}},toJD:function(e,f,u){var i=this._validate(e,f,u,t.local.invalidDate);e=i.year(),f=i.month(),u=i.day();var s=e<=0?e+1:e,o=this.jdEpoch+this._delay1(s)+this._delay2(s)+u+1;if(f<7){for(var a=7;a<=this.monthsInYear(e);a++)o+=this.daysInMonth(e,a);for(a=1;a<f;a++)o+=this.daysInMonth(e,a)}else for(a=7;a<f;a++)o+=this.daysInMonth(e,a);return o},_delay1:function(e){var f=Math.floor((235*e-234)/19),u=12084+13753*f,i=29*f+Math.floor(u/25920);return p(3*(i+1),7)<3&&i++,i},_delay2:function(e){var f=this._delay1(e-1),u=this._delay1(e);return this._delay1(e+1)-u==356?2:u-f==382?1:0},fromJD:function(e){e=Math.floor(e)+.5;for(var f=Math.floor(98496*(e-this.jdEpoch)/35975351)-1;e>=this.toJD(f===-1?1:f+1,7,1);)f++;for(var u=e<this.toJD(f,1,1)?7:1;e>this.toJD(f,u,this.daysInMonth(f,u));)u++;var i=e-this.toJD(f,u,1)+1;return this.newDate(f,u,i)}}),t.calendars.hebrew=g},{"../main":628,"object-assign":476}],619:[function(h,N,H){var t=h("../main"),m=h("object-assign");function g(p){this.local=this.regionalOptions[p||""]||this.regionalOptions[""]}g.prototype=new t.baseCalendar,m(g.prototype,{name:"Islamic",jdEpoch:19484395e-1,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Islamic",epochs:["BH","AH"],monthNames:["Muharram","Safar","Rabi' al-awwal","Rabi' al-thani","Jumada al-awwal","Jumada al-thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-ahad","Yawm al-ithnayn","Yawm ath-thulaathaa'","Yawm al-arbi'aa'","Yawm al-kham\u012Bs","Yawm al-jum'a","Yawm as-sabt"],dayNamesShort:["Aha","Ith","Thu","Arb","Kha","Jum","Sab"],dayNamesMin:["Ah","It","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(p){return(11*this._validate(p,this.minMonth,this.minDay,t.local.invalidYear).year()+14)%30<11},weekOfYear:function(p,e,f){var u=this.newDate(p,e,f);return u.add(-u.dayOfWeek(),"d"),Math.floor((u.dayOfYear()-1)/7)+1},daysInYear:function(p){return this.leapYear(p)?355:354},daysInMonth:function(p,e){var f=this._validate(p,e,this.minDay,t.local.invalidMonth);return this.daysPerMonth[f.month()-1]+(f.month()===12&&this.leapYear(f.year())?1:0)},weekDay:function(p,e,f){return this.dayOfWeek(p,e,f)!==5},toJD:function(p,e,f){var u=this._validate(p,e,f,t.local.invalidDate);return p=u.year(),e=u.month(),p=p<=0?p+1:p,(f=u.day())+Math.ceil(29.5*(e-1))+354*(p-1)+Math.floor((3+11*p)/30)+this.jdEpoch-1},fromJD:function(p){p=Math.floor(p)+.5;var e=Math.floor((30*(p-this.jdEpoch)+10646)/10631);e=e<=0?e-1:e;var f=Math.min(12,Math.ceil((p-29-this.toJD(e,1,1))/29.5)+1),u=p-this.toJD(e,f,1)+1;return this.newDate(e,f,u)}}),t.calendars.islamic=g},{"../main":628,"object-assign":476}],620:[function(h,N,H){var t=h("../main"),m=h("object-assign");function g(p){this.local=this.regionalOptions[p||""]||this.regionalOptions[""]}g.prototype=new t.baseCalendar,m(g.prototype,{name:"Julian",jdEpoch:17214235e-1,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Julian",epochs:["BC","AD"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(p){var e=this._validate(p,this.minMonth,this.minDay,t.local.invalidYear);return(p=e.year()<0?e.year()+1:e.year())%4==0},weekOfYear:function(p,e,f){var u=this.newDate(p,e,f);return u.add(4-(u.dayOfWeek()||7),"d"),Math.floor((u.dayOfYear()-1)/7)+1},daysInMonth:function(p,e){var f=this._validate(p,e,this.minDay,t.local.invalidMonth);return this.daysPerMonth[f.month()-1]+(f.month()===2&&this.leapYear(f.year())?1:0)},weekDay:function(p,e,f){return(this.dayOfWeek(p,e,f)||7)<6},toJD:function(p,e,f){var u=this._validate(p,e,f,t.local.invalidDate);return p=u.year(),e=u.month(),f=u.day(),p<0&&p++,e<=2&&(p--,e+=12),Math.floor(365.25*(p+4716))+Math.floor(30.6001*(e+1))+f-1524.5},fromJD:function(p){var e=Math.floor(p+.5)+1524,f=Math.floor((e-122.1)/365.25),u=Math.floor(365.25*f),i=Math.floor((e-u)/30.6001),s=i-Math.floor(i<14?1:13),o=f-Math.floor(s>2?4716:4715),a=e-u-Math.floor(30.6001*i);return o<=0&&o--,this.newDate(o,s,a)}}),t.calendars.julian=g},{"../main":628,"object-assign":476}],621:[function(h,N,H){var t=h("../main"),m=h("object-assign");function g(f){this.local=this.regionalOptions[f||""]||this.regionalOptions[""]}function p(f,u){return f-u*Math.floor(f/u)}function e(f,u){return p(f-1,u)+1}g.prototype=new t.baseCalendar,m(g.prototype,{name:"Mayan",jdEpoch:584282.5,hasYearZero:!0,minMonth:0,firstMonth:0,minDay:0,regionalOptions:{"":{name:"Mayan",epochs:["",""],monthNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],monthNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],dayNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesMin:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],digits:null,dateFormat:"YYYY.m.d",firstDay:0,isRTL:!1,haabMonths:["Pop","Uo","Zip","Zotz","Tzec","Xul","Yaxkin","Mol","Chen","Yax","Zac","Ceh","Mac","Kankin","Muan","Pax","Kayab","Cumku","Uayeb"],tzolkinMonths:["Imix","Ik","Akbal","Kan","Chicchan","Cimi","Manik","Lamat","Muluc","Oc","Chuen","Eb","Ben","Ix","Men","Cib","Caban","Etznab","Cauac","Ahau"]}},leapYear:function(f){return this._validate(f,this.minMonth,this.minDay,t.local.invalidYear),!1},formatYear:function(f){f=this._validate(f,this.minMonth,this.minDay,t.local.invalidYear).year();var u=Math.floor(f/400);return f%=400,f+=f<0?400:0,u+"."+Math.floor(f/20)+"."+f%20},forYear:function(f){if((f=f.split(".")).length<3)throw"Invalid Mayan year";for(var u=0,i=0;i<f.length;i++){var s=parseInt(f[i],10);if(Math.abs(s)>19||i>0&&s<0)throw"Invalid Mayan year";u=20*u+s}return u},monthsInYear:function(f){return this._validate(f,this.minMonth,this.minDay,t.local.invalidYear),18},weekOfYear:function(f,u,i){return this._validate(f,u,i,t.local.invalidDate),0},daysInYear:function(f){return this._validate(f,this.minMonth,this.minDay,t.local.invalidYear),360},daysInMonth:function(f,u){return this._validate(f,u,this.minDay,t.local.invalidMonth),20},daysInWeek:function(){return 5},dayOfWeek:function(f,u,i){return this._validate(f,u,i,t.local.invalidDate).day()},weekDay:function(f,u,i){return this._validate(f,u,i,t.local.invalidDate),!0},extraInfo:function(f,u,i){var s=this._validate(f,u,i,t.local.invalidDate).toJD(),o=this._toHaab(s),a=this._toTzolkin(s);return{haabMonthName:this.local.haabMonths[o[0]-1],haabMonth:o[0],haabDay:o[1],tzolkinDayName:this.local.tzolkinMonths[a[0]-1],tzolkinDay:a[0],tzolkinTrecena:a[1]}},_toHaab:function(f){var u=p((f-=this.jdEpoch)+8+340,365);return[Math.floor(u/20)+1,p(u,20)]},_toTzolkin:function(f){return[e((f-=this.jdEpoch)+20,20),e(f+4,13)]},toJD:function(f,u,i){var s=this._validate(f,u,i,t.local.invalidDate);return s.day()+20*s.month()+360*s.year()+this.jdEpoch},fromJD:function(f){f=Math.floor(f)+.5-this.jdEpoch;var u=Math.floor(f/360);f%=360,f+=f<0?360:0;var i=Math.floor(f/20),s=f%20;return this.newDate(u,i,s)}}),t.calendars.mayan=g},{"../main":628,"object-assign":476}],622:[function(h,N,H){var t=h("../main"),m=h("object-assign");function g(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}g.prototype=new t.baseCalendar;var p=t.instance("gregorian");m(g.prototype,{name:"Nanakshahi",jdEpoch:22576735e-1,daysPerMonth:[31,31,31,31,31,30,30,30,30,30,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Nanakshahi",epochs:["BN","AN"],monthNames:["Chet","Vaisakh","Jeth","Harh","Sawan","Bhadon","Assu","Katak","Maghar","Poh","Magh","Phagun"],monthNamesShort:["Che","Vai","Jet","Har","Saw","Bha","Ass","Kat","Mgr","Poh","Mgh","Pha"],dayNames:["Somvaar","Mangalvar","Budhvaar","Veervaar","Shukarvaar","Sanicharvaar","Etvaar"],dayNamesShort:["Som","Mangal","Budh","Veer","Shukar","Sanichar","Et"],dayNamesMin:["So","Ma","Bu","Ve","Sh","Sa","Et"],digits:null,dateFormat:"dd-mm-yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var f=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear||t.regionalOptions[""].invalidYear);return p.leapYear(f.year()+(f.year()<1?1:0)+1469)},weekOfYear:function(e,f,u){var i=this.newDate(e,f,u);return i.add(1-(i.dayOfWeek()||7),"d"),Math.floor((i.dayOfYear()-1)/7)+1},daysInMonth:function(e,f){var u=this._validate(e,f,this.minDay,t.local.invalidMonth);return this.daysPerMonth[u.month()-1]+(u.month()===12&&this.leapYear(u.year())?1:0)},weekDay:function(e,f,u){return(this.dayOfWeek(e,f,u)||7)<6},toJD:function(e,f,u){var i=this._validate(e,f,u,t.local.invalidMonth);(e=i.year())<0&&e++;for(var s=i.day(),o=1;o<i.month();o++)s+=this.daysPerMonth[o-1];return s+p.toJD(e+1468,3,13)},fromJD:function(e){e=Math.floor(e+.5);for(var f=Math.floor((e-(this.jdEpoch-1))/366);e>=this.toJD(f+1,1,1);)f++;for(var u=e-Math.floor(this.toJD(f,1,1)+.5)+1,i=1;u>this.daysInMonth(f,i);)u-=this.daysInMonth(f,i),i++;return this.newDate(f,i,u)}}),t.calendars.nanakshahi=g},{"../main":628,"object-assign":476}],623:[function(h,N,H){var t=h("../main"),m=h("object-assign");function g(p){this.local=this.regionalOptions[p||""]||this.regionalOptions[""]}g.prototype=new t.baseCalendar,m(g.prototype,{name:"Nepali",jdEpoch:17007095e-1,daysPerMonth:[31,31,32,32,31,30,30,29,30,29,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,daysPerYear:365,regionalOptions:{"":{name:"Nepali",epochs:["BBS","ABS"],monthNames:["Baisakh","Jestha","Ashadh","Shrawan","Bhadra","Ashwin","Kartik","Mangsir","Paush","Mangh","Falgun","Chaitra"],monthNamesShort:["Bai","Je","As","Shra","Bha","Ash","Kar","Mang","Pau","Ma","Fal","Chai"],dayNames:["Aaitabaar","Sombaar","Manglbaar","Budhabaar","Bihibaar","Shukrabaar","Shanibaar"],dayNamesShort:["Aaita","Som","Mangl","Budha","Bihi","Shukra","Shani"],dayNamesMin:["Aai","So","Man","Bu","Bi","Shu","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:1,isRTL:!1}},leapYear:function(p){return this.daysInYear(p)!==this.daysPerYear},weekOfYear:function(p,e,f){var u=this.newDate(p,e,f);return u.add(-u.dayOfWeek(),"d"),Math.floor((u.dayOfYear()-1)/7)+1},daysInYear:function(p){if(p=this._validate(p,this.minMonth,this.minDay,t.local.invalidYear).year(),this.NEPALI_CALENDAR_DATA[p]===void 0)return this.daysPerYear;for(var e=0,f=this.minMonth;f<=12;f++)e+=this.NEPALI_CALENDAR_DATA[p][f];return e},daysInMonth:function(p,e){return p.year&&(e=p.month(),p=p.year()),this._validate(p,e,this.minDay,t.local.invalidMonth),this.NEPALI_CALENDAR_DATA[p]===void 0?this.daysPerMonth[e-1]:this.NEPALI_CALENDAR_DATA[p][e]},weekDay:function(p,e,f){return this.dayOfWeek(p,e,f)!==6},toJD:function(p,e,f){var u=this._validate(p,e,f,t.local.invalidDate);p=u.year(),e=u.month(),f=u.day();var i=t.instance(),s=0,o=e,a=p;this._createMissingCalendarData(p);var c=p-(o>9||o===9&&f>=this.NEPALI_CALENDAR_DATA[a][0]?56:57);for(e!==9&&(s=f,o--);o!==9;)o<=0&&(o=12,a--),s+=this.NEPALI_CALENDAR_DATA[a][o],o--;return e===9?(s+=f-this.NEPALI_CALENDAR_DATA[a][0])<0&&(s+=i.daysInYear(c)):s+=this.NEPALI_CALENDAR_DATA[a][9]-this.NEPALI_CALENDAR_DATA[a][0],i.newDate(c,1,1).add(s,"d").toJD()},fromJD:function(p){var e=t.instance().fromJD(p),f=e.year(),u=e.dayOfYear(),i=f+56;this._createMissingCalendarData(i);for(var s=9,o=this.NEPALI_CALENDAR_DATA[i][0],a=this.NEPALI_CALENDAR_DATA[i][s]-o+1;u>a;)++s>12&&(s=1,i++),a+=this.NEPALI_CALENDAR_DATA[i][s];var c=this.NEPALI_CALENDAR_DATA[i][s]-(a-u);return this.newDate(i,s,c)},_createMissingCalendarData:function(p){var e=this.daysPerMonth.slice(0);e.unshift(17);for(var f=p-1;f<p+2;f++)this.NEPALI_CALENDAR_DATA[f]===void 0&&(this.NEPALI_CALENDAR_DATA[f]=e)},NEPALI_CALENDAR_DATA:{1970:[18,31,31,32,31,31,31,30,29,30,29,30,30],1971:[18,31,31,32,31,32,30,30,29,30,29,30,30],1972:[17,31,32,31,32,31,30,30,30,29,29,30,30],1973:[19,30,32,31,32,31,30,30,30,29,30,29,31],1974:[19,31,31,32,30,31,31,30,29,30,29,30,30],1975:[18,31,31,32,32,30,31,30,29,30,29,30,30],1976:[17,31,32,31,32,31,30,30,30,29,29,30,31],1977:[18,31,32,31,32,31,31,29,30,29,30,29,31],1978:[18,31,31,32,31,31,31,30,29,30,29,30,30],1979:[18,31,31,32,32,31,30,30,29,30,29,30,30],1980:[17,31,32,31,32,31,30,30,30,29,29,30,31],1981:[18,31,31,31,32,31,31,29,30,30,29,30,30],1982:[18,31,31,32,31,31,31,30,29,30,29,30,30],1983:[18,31,31,32,32,31,30,30,29,30,29,30,30],1984:[17,31,32,31,32,31,30,30,30,29,29,30,31],1985:[18,31,31,31,32,31,31,29,30,30,29,30,30],1986:[18,31,31,32,31,31,31,30,29,30,29,30,30],1987:[18,31,32,31,32,31,30,30,29,30,29,30,30],1988:[17,31,32,31,32,31,30,30,30,29,29,30,31],1989:[18,31,31,31,32,31,31,30,29,30,29,30,30],1990:[18,31,31,32,31,31,31,30,29,30,29,30,30],1991:[18,31,32,31,32,31,30,30,29,30,29,30,30],1992:[17,31,32,31,32,31,30,30,30,29,30,29,31],1993:[18,31,31,31,32,31,31,30,29,30,29,30,30],1994:[18,31,31,32,31,31,31,30,29,30,29,30,30],1995:[17,31,32,31,32,31,30,30,30,29,29,30,30],1996:[17,31,32,31,32,31,30,30,30,29,30,29,31],1997:[18,31,31,32,31,31,31,30,29,30,29,30,30],1998:[18,31,31,32,31,31,31,30,29,30,29,30,30],1999:[17,31,32,31,32,31,30,30,30,29,29,30,31],2e3:[17,30,32,31,32,31,30,30,30,29,30,29,31],2001:[18,31,31,32,31,31,31,30,29,30,29,30,30],2002:[18,31,31,32,32,31,30,30,29,30,29,30,30],2003:[17,31,32,31,32,31,30,30,30,29,29,30,31],2004:[17,30,32,31,32,31,30,30,30,29,30,29,31],2005:[18,31,31,32,31,31,31,30,29,30,29,30,30],2006:[18,31,31,32,32,31,30,30,29,30,29,30,30],2007:[17,31,32,31,32,31,30,30,30,29,29,30,31],2008:[17,31,31,31,32,31,31,29,30,30,29,29,31],2009:[18,31,31,32,31,31,31,30,29,30,29,30,30],2010:[18,31,31,32,32,31,30,30,29,30,29,30,30],2011:[17,31,32,31,32,31,30,30,30,29,29,30,31],2012:[17,31,31,31,32,31,31,29,30,30,29,30,30],2013:[18,31,31,32,31,31,31,30,29,30,29,30,30],2014:[18,31,31,32,32,31,30,30,29,30,29,30,30],2015:[17,31,32,31,32,31,30,30,30,29,29,30,31],2016:[17,31,31,31,32,31,31,29,30,30,29,30,30],2017:[18,31,31,32,31,31,31,30,29,30,29,30,30],2018:[18,31,32,31,32,31,30,30,29,30,29,30,30],2019:[17,31,32,31,32,31,30,30,30,29,30,29,31],2020:[17,31,31,31,32,31,31,30,29,30,29,30,30],2021:[18,31,31,32,31,31,31,30,29,30,29,30,30],2022:[17,31,32,31,32,31,30,30,30,29,29,30,30],2023:[17,31,32,31,32,31,30,30,30,29,30,29,31],2024:[17,31,31,31,32,31,31,30,29,30,29,30,30],2025:[18,31,31,32,31,31,31,30,29,30,29,30,30],2026:[17,31,32,31,32,31,30,30,30,29,29,30,31],2027:[17,30,32,31,32,31,30,30,30,29,30,29,31],2028:[17,31,31,32,31,31,31,30,29,30,29,30,30],2029:[18,31,31,32,31,32,30,30,29,30,29,30,30],2030:[17,31,32,31,32,31,30,30,30,30,30,30,31],2031:[17,31,32,31,32,31,31,31,31,31,31,31,31],2032:[17,32,32,32,32,32,32,32,32,32,32,32,32],2033:[18,31,31,32,32,31,30,30,29,30,29,30,30],2034:[17,31,32,31,32,31,30,30,30,29,29,30,31],2035:[17,30,32,31,32,31,31,29,30,30,29,29,31],2036:[17,31,31,32,31,31,31,30,29,30,29,30,30],2037:[18,31,31,32,32,31,30,30,29,30,29,30,30],2038:[17,31,32,31,32,31,30,30,30,29,29,30,31],2039:[17,31,31,31,32,31,31,29,30,30,29,30,30],2040:[17,31,31,32,31,31,31,30,29,30,29,30,30],2041:[18,31,31,32,32,31,30,30,29,30,29,30,30],2042:[17,31,32,31,32,31,30,30,30,29,29,30,31],2043:[17,31,31,31,32,31,31,29,30,30,29,30,30],2044:[17,31,31,32,31,31,31,30,29,30,29,30,30],2045:[18,31,32,31,32,31,30,30,29,30,29,30,30],2046:[17,31,32,31,32,31,30,30,30,29,29,30,31],2047:[17,31,31,31,32,31,31,30,29,30,29,30,30],2048:[17,31,31,32,31,31,31,30,29,30,29,30,30],2049:[17,31,32,31,32,31,30,30,30,29,29,30,30],2050:[17,31,32,31,32,31,30,30,30,29,30,29,31],2051:[17,31,31,31,32,31,31,30,29,30,29,30,30],2052:[17,31,31,32,31,31,31,30,29,30,29,30,30],2053:[17,31,32,31,32,31,30,30,30,29,29,30,30],2054:[17,31,32,31,32,31,30,30,30,29,30,29,31],2055:[17,31,31,32,31,31,31,30,29,30,30,29,30],2056:[17,31,31,32,31,32,30,30,29,30,29,30,30],2057:[17,31,32,31,32,31,30,30,30,29,29,30,31],2058:[17,30,32,31,32,31,30,30,30,29,30,29,31],2059:[17,31,31,32,31,31,31,30,29,30,29,30,30],2060:[17,31,31,32,32,31,30,30,29,30,29,30,30],2061:[17,31,32,31,32,31,30,30,30,29,29,30,31],2062:[17,30,32,31,32,31,31,29,30,29,30,29,31],2063:[17,31,31,32,31,31,31,30,29,30,29,30,30],2064:[17,31,31,32,32,31,30,30,29,30,29,30,30],2065:[17,31,32,31,32,31,30,30,30,29,29,30,31],2066:[17,31,31,31,32,31,31,29,30,30,29,29,31],2067:[17,31,31,32,31,31,31,30,29,30,29,30,30],2068:[17,31,31,32,32,31,30,30,29,30,29,30,30],2069:[17,31,32,31,32,31,30,30,30,29,29,30,31],2070:[17,31,31,31,32,31,31,29,30,30,29,30,30],2071:[17,31,31,32,31,31,31,30,29,30,29,30,30],2072:[17,31,32,31,32,31,30,30,29,30,29,30,30],2073:[17,31,32,31,32,31,30,30,30,29,29,30,31],2074:[17,31,31,31,32,31,31,30,29,30,29,30,30],2075:[17,31,31,32,31,31,31,30,29,30,29,30,30],2076:[16,31,32,31,32,31,30,30,30,29,29,30,30],2077:[17,31,32,31,32,31,30,30,30,29,30,29,31],2078:[17,31,31,31,32,31,31,30,29,30,29,30,30],2079:[17,31,31,32,31,31,31,30,29,30,29,30,30],2080:[16,31,32,31,32,31,30,30,30,29,29,30,30],2081:[17,31,31,32,32,31,30,30,30,29,30,30,30],2082:[17,31,32,31,32,31,30,30,30,29,30,30,30],2083:[17,31,31,32,31,31,30,30,30,29,30,30,30],2084:[17,31,31,32,31,31,30,30,30,29,30,30,30],2085:[17,31,32,31,32,31,31,30,30,29,30,30,30],2086:[17,31,32,31,32,31,30,30,30,29,30,30,30],2087:[16,31,31,32,31,31,31,30,30,29,30,30,30],2088:[16,30,31,32,32,30,31,30,30,29,30,30,30],2089:[17,31,32,31,32,31,30,30,30,29,30,30,30],2090:[17,31,32,31,32,31,30,30,30,29,30,30,30],2091:[16,31,31,32,31,31,31,30,30,29,30,30,30],2092:[16,31,31,32,32,31,30,30,30,29,30,30,30],2093:[17,31,32,31,32,31,30,30,30,29,30,30,30],2094:[17,31,31,32,31,31,30,30,30,29,30,30,30],2095:[17,31,31,32,31,31,31,30,29,30,30,30,30],2096:[17,30,31,32,32,31,30,30,29,30,29,30,30],2097:[17,31,32,31,32,31,30,30,30,29,30,30,30],2098:[17,31,31,32,31,31,31,29,30,29,30,30,31],2099:[17,31,31,32,31,31,31,30,29,29,30,30,30],2100:[17,31,32,31,32,30,31,30,29,30,29,30,30]}}),t.calendars.nepali=g},{"../main":628,"object-assign":476}],624:[function(h,N,H){var t=h("../main"),m=h("object-assign");function g(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}function p(e,f){return e-f*Math.floor(e/f)}g.prototype=new t.baseCalendar,m(g.prototype,{name:"Persian",jdEpoch:19483205e-1,daysPerMonth:[31,31,31,31,31,31,30,30,30,30,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Persian",epochs:["BP","AP"],monthNames:["Farvardin","Ordibehesht","Khordad","Tir","Mordad","Shahrivar","Mehr","Aban","Azar","Day","Bahman","Esfand"],monthNamesShort:["Far","Ord","Kho","Tir","Mor","Sha","Meh","Aba","Aza","Day","Bah","Esf"],dayNames:["Yekshambe","Doshambe","Seshambe","Ch\xE6harshambe","Panjshambe","Jom'e","Shambe"],dayNamesShort:["Yek","Do","Se","Ch\xE6","Panj","Jom","Sha"],dayNamesMin:["Ye","Do","Se","Ch","Pa","Jo","Sh"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(e){var f=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear);return 682*((f.year()-(f.year()>0?474:473))%2820+474+38)%2816<682},weekOfYear:function(e,f,u){var i=this.newDate(e,f,u);return i.add(-(i.dayOfWeek()+1)%7,"d"),Math.floor((i.dayOfYear()-1)/7)+1},daysInMonth:function(e,f){var u=this._validate(e,f,this.minDay,t.local.invalidMonth);return this.daysPerMonth[u.month()-1]+(u.month()===12&&this.leapYear(u.year())?1:0)},weekDay:function(e,f,u){return this.dayOfWeek(e,f,u)!==5},toJD:function(e,f,u){var i=this._validate(e,f,u,t.local.invalidDate);e=i.year(),f=i.month(),u=i.day();var s=e-(e>=0?474:473),o=474+p(s,2820);return u+(f<=7?31*(f-1):30*(f-1)+6)+Math.floor((682*o-110)/2816)+365*(o-1)+1029983*Math.floor(s/2820)+this.jdEpoch-1},fromJD:function(e){var f=(e=Math.floor(e)+.5)-this.toJD(475,1,1),u=Math.floor(f/1029983),i=p(f,1029983),s=2820;if(i!==1029982){var o=Math.floor(i/366),a=p(i,366);s=Math.floor((2134*o+2816*a+2815)/1028522)+o+1}var c=s+2820*u+474;c=c<=0?c-1:c;var r=e-this.toJD(c,1,1)+1,n=r<=186?Math.ceil(r/31):Math.ceil((r-6)/30),d=e-this.toJD(c,n,1)+1;return this.newDate(c,n,d)}}),t.calendars.persian=g,t.calendars.jalali=g},{"../main":628,"object-assign":476}],625:[function(h,N,H){var t=h("../main"),m=h("object-assign"),g=t.instance();function p(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}p.prototype=new t.baseCalendar,m(p.prototype,{name:"Taiwan",jdEpoch:24194025e-1,yearsOffset:1911,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Taiwan",epochs:["BROC","ROC"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},leapYear:function(e){var f=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear);return e=this._t2gYear(f.year()),g.leapYear(e)},weekOfYear:function(e,f,u){var i=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear);return e=this._t2gYear(i.year()),g.weekOfYear(e,i.month(),i.day())},daysInMonth:function(e,f){var u=this._validate(e,f,this.minDay,t.local.invalidMonth);return this.daysPerMonth[u.month()-1]+(u.month()===2&&this.leapYear(u.year())?1:0)},weekDay:function(e,f,u){return(this.dayOfWeek(e,f,u)||7)<6},toJD:function(e,f,u){var i=this._validate(e,f,u,t.local.invalidDate);return e=this._t2gYear(i.year()),g.toJD(e,i.month(),i.day())},fromJD:function(e){var f=g.fromJD(e),u=this._g2tYear(f.year());return this.newDate(u,f.month(),f.day())},_t2gYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&e<=-1?1:0)},_g2tYear:function(e){return e-this.yearsOffset-(e>=1&&e<=this.yearsOffset?1:0)}}),t.calendars.taiwan=p},{"../main":628,"object-assign":476}],626:[function(h,N,H){var t=h("../main"),m=h("object-assign"),g=t.instance();function p(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}p.prototype=new t.baseCalendar,m(p.prototype,{name:"Thai",jdEpoch:15230985e-1,yearsOffset:543,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Thai",epochs:["BBE","BE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var f=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear);return e=this._t2gYear(f.year()),g.leapYear(e)},weekOfYear:function(e,f,u){var i=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear);return e=this._t2gYear(i.year()),g.weekOfYear(e,i.month(),i.day())},daysInMonth:function(e,f){var u=this._validate(e,f,this.minDay,t.local.invalidMonth);return this.daysPerMonth[u.month()-1]+(u.month()===2&&this.leapYear(u.year())?1:0)},weekDay:function(e,f,u){return(this.dayOfWeek(e,f,u)||7)<6},toJD:function(e,f,u){var i=this._validate(e,f,u,t.local.invalidDate);return e=this._t2gYear(i.year()),g.toJD(e,i.month(),i.day())},fromJD:function(e){var f=g.fromJD(e),u=this._g2tYear(f.year());return this.newDate(u,f.month(),f.day())},_t2gYear:function(e){return e-this.yearsOffset-(e>=1&&e<=this.yearsOffset?1:0)},_g2tYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&e<=-1?1:0)}}),t.calendars.thai=p},{"../main":628,"object-assign":476}],627:[function(h,N,H){var t=h("../main"),m=h("object-assign");function g(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}g.prototype=new t.baseCalendar,m(g.prototype,{name:"UmmAlQura",hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Umm al-Qura",epochs:["BH","AH"],monthNames:["Al-Muharram","Safar","Rabi' al-awwal","Rabi' Al-Thani","Jumada Al-Awwal","Jumada Al-Thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-Ahad","Yawm al-Ithnain","Yawm al-Thal\u0101th\u0101\u2019","Yawm al-Arba\u2018\u0101\u2019","Yawm al-Kham\u012Bs","Yawm al-Jum\u2018a","Yawm al-Sabt"],dayNamesMin:["Ah","Ith","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!0}},leapYear:function(e){var f=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear);return this.daysInYear(f.year())===355},weekOfYear:function(e,f,u){var i=this.newDate(e,f,u);return i.add(-i.dayOfWeek(),"d"),Math.floor((i.dayOfYear()-1)/7)+1},daysInYear:function(e){for(var f=0,u=1;u<=12;u++)f+=this.daysInMonth(e,u);return f},daysInMonth:function(e,f){for(var u=this._validate(e,f,this.minDay,t.local.invalidMonth).toJD()-24e5+.5,i=0,s=0;s<p.length;s++){if(p[s]>u)return p[i]-p[i-1];i++}return 30},weekDay:function(e,f,u){return this.dayOfWeek(e,f,u)!==5},toJD:function(e,f,u){var i=this._validate(e,f,u,t.local.invalidDate),s=12*(i.year()-1)+i.month()-15292;return i.day()+p[s-1]-1+24e5-.5},fromJD:function(e){for(var f=e-24e5+.5,u=0,i=0;i<p.length&&!(p[i]>f);i++)u++;var s=u+15292,o=Math.floor((s-1)/12),a=o+1,c=s-12*o,r=f-p[u-1]+1;return this.newDate(a,c,r)},isValid:function(e,f,u){var i=t.baseCalendar.prototype.isValid.apply(this,arguments);return i&&(i=(e=e.year!=null?e.year:e)>=1276&&e<=1500),i},_validate:function(e,f,u,i){var s=t.baseCalendar.prototype._validate.apply(this,arguments);if(s.year<1276||s.year>1500)throw i.replace(/\{0\}/,this.local.name);return s}}),t.calendars.ummalqura=g;var p=[20,50,79,109,138,168,197,227,256,286,315,345,374,404,433,463,492,522,551,581,611,641,670,700,729,759,788,818,847,877,906,936,965,995,1024,1054,1083,1113,1142,1172,1201,1231,1260,1290,1320,1350,1379,1409,1438,1468,1497,1527,1556,1586,1615,1645,1674,1704,1733,1763,1792,1822,1851,1881,1910,1940,1969,1999,2028,2058,2087,2117,2146,2176,2205,2235,2264,2294,2323,2353,2383,2413,2442,2472,2501,2531,2560,2590,2619,2649,2678,2708,2737,2767,2796,2826,2855,2885,2914,2944,2973,3003,3032,3062,3091,3121,3150,3180,3209,3239,3268,3298,3327,3357,3386,3416,3446,3476,3505,3535,3564,3594,3623,3653,3682,3712,3741,3771,3800,3830,3859,3889,3918,3948,3977,4007,4036,4066,4095,4125,4155,4185,4214,4244,4273,4303,4332,4362,4391,4421,4450,4480,4509,4539,4568,4598,4627,4657,4686,4716,4745,4775,4804,4834,4863,4893,4922,4952,4981,5011,5040,5070,5099,5129,5158,5188,5218,5248,5277,5307,5336,5366,5395,5425,5454,5484,5513,5543,5572,5602,5631,5661,5690,5720,5749,5779,5808,5838,5867,5897,5926,5956,5985,6015,6044,6074,6103,6133,6162,6192,6221,6251,6281,6311,6340,6370,6399,6429,6458,6488,6517,6547,6576,6606,6635,6665,6694,6724,6753,6783,6812,6842,6871,6901,6930,6960,6989,7019,7048,7078,7107,7137,7166,7196,7225,7255,7284,7314,7344,7374,7403,7433,7462,7492,7521,7551,7580,7610,7639,7669,7698,7728,7757,7787,7816,7846,7875,7905,7934,7964,7993,8023,8053,8083,8112,8142,8171,8201,8230,8260,8289,8319,8348,8378,8407,8437,8466,8496,8525,8555,8584,8614,8643,8673,8702,8732,8761,8791,8821,8850,8880,8909,8938,8968,8997,9027,9056,9086,9115,9145,9175,9205,9234,9264,9293,9322,9352,9381,9410,9440,9470,9499,9529,9559,9589,9618,9648,9677,9706,9736,9765,9794,9824,9853,9883,9913,9943,9972,10002,10032,10061,10090,10120,10149,10178,10208,10237,10267,10297,10326,10356,10386,10415,10445,10474,10504,10533,10562,10592,10621,10651,10680,10710,10740,10770,10799,10829,10858,10888,10917,10947,10976,11005,11035,11064,11094,11124,11153,11183,11213,11242,11272,11301,11331,11360,11389,11419,11448,11478,11507,11537,11567,11596,11626,11655,11685,11715,11744,11774,11803,11832,11862,11891,11921,11950,11980,12010,12039,12069,12099,12128,12158,12187,12216,12246,12275,12304,12334,12364,12393,12423,12453,12483,12512,12542,12571,12600,12630,12659,12688,12718,12747,12777,12807,12837,12866,12896,12926,12955,12984,13014,13043,13072,13102,13131,13161,13191,13220,13250,13280,13310,13339,13368,13398,13427,13456,13486,13515,13545,13574,13604,13634,13664,13693,13723,13752,13782,13811,13840,13870,13899,13929,13958,13988,14018,14047,14077,14107,14136,14166,14195,14224,14254,14283,14313,14342,14372,14401,14431,14461,14490,14520,14550,14579,14609,14638,14667,14697,14726,14756,14785,14815,14844,14874,14904,14933,14963,14993,15021,15051,15081,15110,15140,15169,15199,15228,15258,15287,15317,15347,15377,15406,15436,15465,15494,15524,15553,15582,15612,15641,15671,15701,15731,15760,15790,15820,15849,15878,15908,15937,15966,15996,16025,16055,16085,16114,16144,16174,16204,16233,16262,16292,16321,16350,16380,16409,16439,16468,16498,16528,16558,16587,16617,16646,16676,16705,16734,16764,16793,16823,16852,16882,16912,16941,16971,17001,17030,17060,17089,17118,17148,17177,17207,17236,17266,17295,17325,17355,17384,17414,17444,17473,17502,17532,17561,17591,17620,17650,17679,17709,17738,17768,17798,17827,17857,17886,17916,17945,17975,18004,18034,18063,18093,18122,18152,18181,18211,18241,18270,18300,18330,18359,18388,18418,18447,18476,18506,18535,18565,18595,18625,18654,18684,18714,18743,18772,18802,18831,18860,18890,18919,18949,18979,19008,19038,19068,19098,19127,19156,19186,19215,19244,19274,19303,19333,19362,19392,19422,19452,19481,19511,19540,19570,19599,19628,19658,19687,19717,19746,19776,19806,19836,19865,19895,19924,19954,19983,20012,20042,20071,20101,20130,20160,20190,20219,20249,20279,20308,20338,20367,20396,20426,20455,20485,20514,20544,20573,20603,20633,20662,20692,20721,20751,20780,20810,20839,20869,20898,20928,20957,20987,21016,21046,21076,21105,21135,21164,21194,21223,21253,21282,21312,21341,21371,21400,21430,21459,21489,21519,21548,21578,21607,21637,21666,21696,21725,21754,21784,21813,21843,21873,21902,21932,21962,21991,22021,22050,22080,22109,22138,22168,22197,22227,22256,22286,22316,22346,22375,22405,22434,22464,22493,22522,22552,22581,22611,22640,22670,22700,22730,22759,22789,22818,22848,22877,22906,22936,22965,22994,23024,23054,23083,23113,23143,23173,23202,23232,23261,23290,23320,23349,23379,23408,23438,23467,23497,23527,23556,23586,23616,23645,23674,23704,23733,23763,23792,23822,23851,23881,23910,23940,23970,23999,24029,24058,24088,24117,24147,24176,24206,24235,24265,24294,24324,24353,24383,24413,24442,24472,24501,24531,24560,24590,24619,24648,24678,24707,24737,24767,24796,24826,24856,24885,24915,24944,24974,25003,25032,25062,25091,25121,25150,25180,25210,25240,25269,25299,25328,25358,25387,25416,25446,25475,25505,25534,25564,25594,25624,25653,25683,25712,25742,25771,25800,25830,25859,25888,25918,25948,25977,26007,26037,26067,26096,26126,26155,26184,26214,26243,26272,26302,26332,26361,26391,26421,26451,26480,26510,26539,26568,26598,26627,26656,26686,26715,26745,26775,26805,26834,26864,26893,26923,26952,26982,27011,27041,27070,27099,27129,27159,27188,27218,27248,27277,27307,27336,27366,27395,27425,27454,27484,27513,27542,27572,27602,27631,27661,27691,27720,27750,27779,27809,27838,27868,27897,27926,27956,27985,28015,28045,28074,28104,28134,28163,28193,28222,28252,28281,28310,28340,28369,28399,28428,28458,28488,28517,28547,28577,28607,28636,28665,28695,28724,28754,28783,28813,28843,28872,28901,28931,28960,28990,29019,29049,29078,29108,29137,29167,29196,29226,29255,29285,29315,29345,29375,29404,29434,29463,29492,29522,29551,29580,29610,29640,29669,29699,29729,29759,29788,29818,29847,29876,29906,29935,29964,29994,30023,30053,30082,30112,30141,30171,30200,30230,30259,30289,30318,30348,30378,30408,30437,30467,30496,30526,30555,30585,30614,30644,30673,30703,30732,30762,30791,30821,30850,30880,30909,30939,30968,30998,31027,31057,31086,31116,31145,31175,31204,31234,31263,31293,31322,31352,31381,31411,31441,31471,31500,31530,31559,31589,31618,31648,31676,31706,31736,31766,31795,31825,31854,31884,31913,31943,31972,32002,32031,32061,32090,32120,32150,32180,32209,32239,32268,32298,32327,32357,32386,32416,32445,32475,32504,32534,32563,32593,32622,32652,32681,32711,32740,32770,32799,32829,32858,32888,32917,32947,32976,33006,33035,33065,33094,33124,33153,33183,33213,33243,33272,33302,33331,33361,33390,33420,33450,33479,33509,33539,33568,33598,33627,33657,33686,33716,33745,33775,33804,33834,33863,33893,33922,33952,33981,34011,34040,34069,34099,34128,34158,34187,34217,34247,34277,34306,34336,34365,34395,34424,34454,34483,34512,34542,34571,34601,34631,34660,34690,34719,34749,34778,34808,34837,34867,34896,34926,34955,34985,35015,35044,35074,35103,35133,35162,35192,35222,35251,35280,35310,35340,35370,35399,35429,35458,35488,35517,35547,35576,35605,35635,35665,35694,35723,35753,35782,35811,35841,35871,35901,35930,35960,35989,36019,36048,36078,36107,36136,36166,36195,36225,36254,36284,36314,36343,36373,36403,36433,36462,36492,36521,36551,36580,36610,36639,36669,36698,36728,36757,36786,36816,36845,36875,36904,36934,36963,36993,37022,37052,37081,37111,37141,37170,37200,37229,37259,37288,37318,37347,37377,37406,37436,37465,37495,37524,37554,37584,37613,37643,37672,37701,37731,37760,37790,37819,37849,37878,37908,37938,37967,37997,38027,38056,38085,38115,38144,38174,38203,38233,38262,38292,38322,38351,38381,38410,38440,38469,38499,38528,38558,38587,38617,38646,38676,38705,38735,38764,38794,38823,38853,38882,38912,38941,38971,39001,39030,39059,39089,39118,39148,39178,39208,39237,39267,39297,39326,39355,39385,39414,39444,39473,39503,39532,39562,39592,39621,39650,39680,39709,39739,39768,39798,39827,39857,39886,39916,39946,39975,40005,40035,40064,40094,40123,40153,40182,40212,40241,40271,40300,40330,40359,40389,40418,40448,40477,40507,40536,40566,40595,40625,40655,40685,40714,40744,40773,40803,40832,40862,40892,40921,40951,40980,41009,41039,41068,41098,41127,41157,41186,41216,41245,41275,41304,41334,41364,41393,41422,41452,41481,41511,41540,41570,41599,41629,41658,41688,41718,41748,41777,41807,41836,41865,41894,41924,41953,41983,42012,42042,42072,42102,42131,42161,42190,42220,42249,42279,42308,42337,42367,42397,42426,42456,42485,42515,42545,42574,42604,42633,42662,42692,42721,42751,42780,42810,42839,42869,42899,42929,42958,42988,43017,43046,43076,43105,43135,43164,43194,43223,43253,43283,43312,43342,43371,43401,43430,43460,43489,43519,43548,43578,43607,43637,43666,43696,43726,43755,43785,43814,43844,43873,43903,43932,43962,43991,44021,44050,44080,44109,44139,44169,44198,44228,44258,44287,44317,44346,44375,44405,44434,44464,44493,44523,44553,44582,44612,44641,44671,44700,44730,44759,44788,44818,44847,44877,44906,44936,44966,44996,45025,45055,45084,45114,45143,45172,45202,45231,45261,45290,45320,45350,45380,45409,45439,45468,45498,45527,45556,45586,45615,45644,45674,45704,45733,45763,45793,45823,45852,45882,45911,45940,45970,45999,46028,46058,46088,46117,46147,46177,46206,46236,46265,46295,46324,46354,46383,46413,46442,46472,46501,46531,46560,46590,46620,46649,46679,46708,46738,46767,46797,46826,46856,46885,46915,46944,46974,47003,47033,47063,47092,47122,47151,47181,47210,47240,47269,47298,47328,47357,47387,47417,47446,47476,47506,47535,47565,47594,47624,47653,47682,47712,47741,47771,47800,47830,47860,47890,47919,47949,47978,48008,48037,48066,48096,48125,48155,48184,48214,48244,48273,48303,48333,48362,48392,48421,48450,48480,48509,48538,48568,48598,48627,48657,48687,48717,48746,48776,48805,48834,48864,48893,48922,48952,48982,49011,49041,49071,49100,49130,49160,49189,49218,49248,49277,49306,49336,49365,49395,49425,49455,49484,49514,49543,49573,49602,49632,49661,49690,49720,49749,49779,49809,49838,49868,49898,49927,49957,49986,50016,50045,50075,50104,50133,50163,50192,50222,50252,50281,50311,50340,50370,50400,50429,50459,50488,50518,50547,50576,50606,50635,50665,50694,50724,50754,50784,50813,50843,50872,50902,50931,50960,50990,51019,51049,51078,51108,51138,51167,51197,51227,51256,51286,51315,51345,51374,51403,51433,51462,51492,51522,51552,51582,51611,51641,51670,51699,51729,51758,51787,51816,51846,51876,51906,51936,51965,51995,52025,52054,52083,52113,52142,52171,52200,52230,52260,52290,52319,52349,52379,52408,52438,52467,52497,52526,52555,52585,52614,52644,52673,52703,52733,52762,52792,52822,52851,52881,52910,52939,52969,52998,53028,53057,53087,53116,53146,53176,53205,53235,53264,53294,53324,53353,53383,53412,53441,53471,53500,53530,53559,53589,53619,53648,53678,53708,53737,53767,53796,53825,53855,53884,53913,53943,53973,54003,54032,54062,54092,54121,54151,54180,54209,54239,54268,54297,54327,54357,54387,54416,54446,54476,54505,54535,54564,54593,54623,54652,54681,54711,54741,54770,54800,54830,54859,54889,54919,54948,54977,55007,55036,55066,55095,55125,55154,55184,55213,55243,55273,55302,55332,55361,55391,55420,55450,55479,55508,55538,55567,55597,55627,55657,55686,55716,55745,55775,55804,55834,55863,55892,55922,55951,55981,56011,56040,56070,56100,56129,56159,56188,56218,56247,56276,56306,56335,56365,56394,56424,56454,56483,56513,56543,56572,56601,56631,56660,56690,56719,56749,56778,56808,56837,56867,56897,56926,56956,56985,57015,57044,57074,57103,57133,57162,57192,57221,57251,57280,57310,57340,57369,57399,57429,57458,57487,57517,57546,57576,57605,57634,57664,57694,57723,57753,57783,57813,57842,57871,57901,57930,57959,57989,58018,58048,58077,58107,58137,58167,58196,58226,58255,58285,58314,58343,58373,58402,58432,58461,58491,58521,58551,58580,58610,58639,58669,58698,58727,58757,58786,58816,58845,58875,58905,58934,58964,58994,59023,59053,59082,59111,59141,59170,59200,59229,59259,59288,59318,59348,59377,59407,59436,59466,59495,59525,59554,59584,59613,59643,59672,59702,59731,59761,59791,59820,59850,59879,59909,59939,59968,59997,60027,60056,60086,60115,60145,60174,60204,60234,60264,60293,60323,60352,60381,60411,60440,60469,60499,60528,60558,60588,60618,60648,60677,60707,60736,60765,60795,60824,60853,60883,60912,60942,60972,61002,61031,61061,61090,61120,61149,61179,61208,61237,61267,61296,61326,61356,61385,61415,61445,61474,61504,61533,61563,61592,61621,61651,61680,61710,61739,61769,61799,61828,61858,61888,61917,61947,61976,62006,62035,62064,62094,62123,62153,62182,62212,62242,62271,62301,62331,62360,62390,62419,62448,62478,62507,62537,62566,62596,62625,62655,62685,62715,62744,62774,62803,62832,62862,62891,62921,62950,62980,63009,63039,63069,63099,63128,63157,63187,63216,63246,63275,63305,63334,63363,63393,63423,63453,63482,63512,63541,63571,63600,63630,63659,63689,63718,63747,63777,63807,63836,63866,63895,63925,63955,63984,64014,64043,64073,64102,64131,64161,64190,64220,64249,64279,64309,64339,64368,64398,64427,64457,64486,64515,64545,64574,64603,64633,64663,64692,64722,64752,64782,64811,64841,64870,64899,64929,64958,64987,65017,65047,65076,65106,65136,65166,65195,65225,65254,65283,65313,65342,65371,65401,65431,65460,65490,65520,65549,65579,65608,65638,65667,65697,65726,65755,65785,65815,65844,65874,65903,65933,65963,65992,66022,66051,66081,66110,66140,66169,66199,66228,66258,66287,66317,66346,66376,66405,66435,66465,66494,66524,66553,66583,66612,66641,66671,66700,66730,66760,66789,66819,66849,66878,66908,66937,66967,66996,67025,67055,67084,67114,67143,67173,67203,67233,67262,67292,67321,67351,67380,67409,67439,67468,67497,67527,67557,67587,67617,67646,67676,67705,67735,67764,67793,67823,67852,67882,67911,67941,67971,68e3,68030,68060,68089,68119,68148,68177,68207,68236,68266,68295,68325,68354,68384,68414,68443,68473,68502,68532,68561,68591,68620,68650,68679,68708,68738,68768,68797,68827,68857,68886,68916,68946,68975,69004,69034,69063,69092,69122,69152,69181,69211,69240,69270,69300,69330,69359,69388,69418,69447,69476,69506,69535,69565,69595,69624,69654,69684,69713,69743,69772,69802,69831,69861,69890,69919,69949,69978,70008,70038,70067,70097,70126,70156,70186,70215,70245,70274,70303,70333,70362,70392,70421,70451,70481,70510,70540,70570,70599,70629,70658,70687,70717,70746,70776,70805,70835,70864,70894,70924,70954,70983,71013,71042,71071,71101,71130,71159,71189,71218,71248,71278,71308,71337,71367,71397,71426,71455,71485,71514,71543,71573,71602,71632,71662,71691,71721,71751,71781,71810,71839,71869,71898,71927,71957,71986,72016,72046,72075,72105,72135,72164,72194,72223,72253,72282,72311,72341,72370,72400,72429,72459,72489,72518,72548,72577,72607,72637,72666,72695,72725,72754,72784,72813,72843,72872,72902,72931,72961,72991,73020,73050,73080,73109,73139,73168,73197,73227,73256,73286,73315,73345,73375,73404,73434,73464,73493,73523,73552,73581,73611,73640,73669,73699,73729,73758,73788,73818,73848,73877,73907,73936,73965,73995,74024,74053,74083,74113,74142,74172,74202,74231,74261,74291,74320,74349,74379,74408,74437,74467,74497,74526,74556,74586,74615,74645,74675,74704,74733,74763,74792,74822,74851,74881,74910,74940,74969,74999,75029,75058,75088,75117,75147,75176,75206,75235,75264,75294,75323,75353,75383,75412,75442,75472,75501,75531,75560,75590,75619,75648,75678,75707,75737,75766,75796,75826,75856,75885,75915,75944,75974,76003,76032,76062,76091,76121,76150,76180,76210,76239,76269,76299,76328,76358,76387,76416,76446,76475,76505,76534,76564,76593,76623,76653,76682,76712,76741,76771,76801,76830,76859,76889,76918,76948,76977,77007,77036,77066,77096,77125,77155,77185,77214,77243,77273,77302,77332,77361,77390,77420,77450,77479,77509,77539,77569,77598,77627,77657,77686,77715,77745,77774,77804,77833,77863,77893,77923,77952,77982,78011,78041,78070,78099,78129,78158,78188,78217,78247,78277,78307,78336,78366,78395,78425,78454,78483,78513,78542,78572,78601,78631,78661,78690,78720,78750,78779,78808,78838,78867,78897,78926,78956,78985,79015,79044,79074,79104,79133,79163,79192,79222,79251,79281,79310,79340,79369,79399,79428,79458,79487,79517,79546,79576,79606,79635,79665,79695,79724,79753,79783,79812,79841,79871,79900,79930,79960,79990]},{"../main":628,"object-assign":476}],628:[function(h,N,H){var t=h("object-assign");function m(){this.regionalOptions=[],this.regionalOptions[""]={invalidCalendar:"Calendar {0} not found",invalidDate:"Invalid {0} date",invalidMonth:"Invalid {0} month",invalidYear:"Invalid {0} year",differentCalendars:"Cannot mix {0} and {1} dates"},this.local=this.regionalOptions[""],this.calendars={},this._localCals={}}function g(i,s,o,a){if(this._calendar=i,this._year=s,this._month=o,this._day=a,this._calendar._validateLevel===0&&!this._calendar.isValid(this._year,this._month,this._day))throw(u.local.invalidDate||u.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name)}function p(i,s){return"000000".substring(0,s-(i=""+i).length)+i}function e(){this.shortYearCutoff="+10"}function f(i){this.local=this.regionalOptions[i]||this.regionalOptions[""]}t(m.prototype,{instance:function(i,s){i=(i||"gregorian").toLowerCase(),s=s||"";var o=this._localCals[i+"-"+s];if(!o&&this.calendars[i]&&(o=new this.calendars[i](s),this._localCals[i+"-"+s]=o),!o)throw(this.local.invalidCalendar||this.regionalOptions[""].invalidCalendar).replace(/\{0\}/,i);return o},newDate:function(i,s,o,a,c){return(a=(i!=null&&i.year?i.calendar():typeof a=="string"?this.instance(a,c):a)||this.instance()).newDate(i,s,o)},substituteDigits:function(i){return function(s){return(s+"").replace(/[0-9]/g,function(o){return i[o]})}},substituteChineseDigits:function(i,s){return function(o){for(var a="",c=0;o>0;){var r=o%10;a=(r===0?"":i[r]+s[c])+a,c++,o=Math.floor(o/10)}return a.indexOf(i[1]+s[1])===0&&(a=a.substr(1)),a||i[0]}}}),t(g.prototype,{newDate:function(i,s,o){return this._calendar.newDate(i==null?this:i,s,o)},year:function(i){return arguments.length===0?this._year:this.set(i,"y")},month:function(i){return arguments.length===0?this._month:this.set(i,"m")},day:function(i){return arguments.length===0?this._day:this.set(i,"d")},date:function(i,s,o){if(!this._calendar.isValid(i,s,o))throw(u.local.invalidDate||u.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name);return this._year=i,this._month=s,this._day=o,this},leapYear:function(){return this._calendar.leapYear(this)},epoch:function(){return this._calendar.epoch(this)},formatYear:function(){return this._calendar.formatYear(this)},monthOfYear:function(){return this._calendar.monthOfYear(this)},weekOfYear:function(){return this._calendar.weekOfYear(this)},daysInYear:function(){return this._calendar.daysInYear(this)},dayOfYear:function(){return this._calendar.dayOfYear(this)},daysInMonth:function(){return this._calendar.daysInMonth(this)},dayOfWeek:function(){return this._calendar.dayOfWeek(this)},weekDay:function(){return this._calendar.weekDay(this)},extraInfo:function(){return this._calendar.extraInfo(this)},add:function(i,s){return this._calendar.add(this,i,s)},set:function(i,s){return this._calendar.set(this,i,s)},compareTo:function(i){if(this._calendar.name!==i._calendar.name)throw(u.local.differentCalendars||u.regionalOptions[""].differentCalendars).replace(/\{0\}/,this._calendar.local.name).replace(/\{1\}/,i._calendar.local.name);var s=this._year!==i._year?this._year-i._year:this._month!==i._month?this.monthOfYear()-i.monthOfYear():this._day-i._day;return s===0?0:s<0?-1:1},calendar:function(){return this._calendar},toJD:function(){return this._calendar.toJD(this)},fromJD:function(i){return this._calendar.fromJD(i)},toJSDate:function(){return this._calendar.toJSDate(this)},fromJSDate:function(i){return this._calendar.fromJSDate(i)},toString:function(){return(this.year()<0?"-":"")+p(Math.abs(this.year()),4)+"-"+p(this.month(),2)+"-"+p(this.day(),2)}}),t(e.prototype,{_validateLevel:0,newDate:function(i,s,o){return i==null?this.today():(i.year&&(this._validate(i,s,o,u.local.invalidDate||u.regionalOptions[""].invalidDate),o=i.day(),s=i.month(),i=i.year()),new g(this,i,s,o))},today:function(){return this.fromJSDate(new Date)},epoch:function(i){return this._validate(i,this.minMonth,this.minDay,u.local.invalidYear||u.regionalOptions[""].invalidYear).year()<0?this.local.epochs[0]:this.local.epochs[1]},formatYear:function(i){var s=this._validate(i,this.minMonth,this.minDay,u.local.invalidYear||u.regionalOptions[""].invalidYear);return(s.year()<0?"-":"")+p(Math.abs(s.year()),4)},monthsInYear:function(i){return this._validate(i,this.minMonth,this.minDay,u.local.invalidYear||u.regionalOptions[""].invalidYear),12},monthOfYear:function(i,s){var o=this._validate(i,s,this.minDay,u.local.invalidMonth||u.regionalOptions[""].invalidMonth);return(o.month()+this.monthsInYear(o)-this.firstMonth)%this.monthsInYear(o)+this.minMonth},fromMonthOfYear:function(i,s){var o=(s+this.firstMonth-2*this.minMonth)%this.monthsInYear(i)+this.minMonth;return this._validate(i,o,this.minDay,u.local.invalidMonth||u.regionalOptions[""].invalidMonth),o},daysInYear:function(i){var s=this._validate(i,this.minMonth,this.minDay,u.local.invalidYear||u.regionalOptions[""].invalidYear);return this.leapYear(s)?366:365},dayOfYear:function(i,s,o){var a=this._validate(i,s,o,u.local.invalidDate||u.regionalOptions[""].invalidDate);return a.toJD()-this.newDate(a.year(),this.fromMonthOfYear(a.year(),this.minMonth),this.minDay).toJD()+1},daysInWeek:function(){return 7},dayOfWeek:function(i,s,o){var a=this._validate(i,s,o,u.local.invalidDate||u.regionalOptions[""].invalidDate);return(Math.floor(this.toJD(a))+2)%this.daysInWeek()},extraInfo:function(i,s,o){return this._validate(i,s,o,u.local.invalidDate||u.regionalOptions[""].invalidDate),{}},add:function(i,s,o){return this._validate(i,this.minMonth,this.minDay,u.local.invalidDate||u.regionalOptions[""].invalidDate),this._correctAdd(i,this._add(i,s,o),s,o)},_add:function(i,s,o){if(this._validateLevel++,o==="d"||o==="w"){var a=i.toJD()+s*(o==="w"?this.daysInWeek():1),c=i.calendar().fromJD(a);return this._validateLevel--,[c.year(),c.month(),c.day()]}try{var r=i.year()+(o==="y"?s:0),n=i.monthOfYear()+(o==="m"?s:0);c=i.day(),o==="y"?(i.month()!==this.fromMonthOfYear(r,n)&&(n=this.newDate(r,i.month(),this.minDay).monthOfYear()),n=Math.min(n,this.monthsInYear(r)),c=Math.min(c,this.daysInMonth(r,this.fromMonthOfYear(r,n)))):o==="m"&&(function(l){for(;n<l.minMonth;)r--,n+=l.monthsInYear(r);for(var y=l.monthsInYear(r);n>y-1+l.minMonth;)r++,n-=y,y=l.monthsInYear(r)}(this),c=Math.min(c,this.daysInMonth(r,this.fromMonthOfYear(r,n))));var d=[r,this.fromMonthOfYear(r,n),c];return this._validateLevel--,d}catch(l){throw this._validateLevel--,l}},_correctAdd:function(i,s,o,a){if(!(this.hasYearZero||a!=="y"&&a!=="m"||s[0]!==0&&i.year()>0==s[0]>0)){var c={y:[1,1,"y"],m:[1,this.monthsInYear(-1),"m"],w:[this.daysInWeek(),this.daysInYear(-1),"d"],d:[1,this.daysInYear(-1),"d"]}[a],r=o<0?-1:1;s=this._add(i,o*c[0]+r*c[1],c[2])}return i.date(s[0],s[1],s[2])},set:function(i,s,o){this._validate(i,this.minMonth,this.minDay,u.local.invalidDate||u.regionalOptions[""].invalidDate);var a=o==="y"?s:i.year(),c=o==="m"?s:i.month(),r=o==="d"?s:i.day();return o!=="y"&&o!=="m"||(r=Math.min(r,this.daysInMonth(a,c))),i.date(a,c,r)},isValid:function(i,s,o){this._validateLevel++;var a=this.hasYearZero||i!==0;if(a){var c=this.newDate(i,s,this.minDay);a=s>=this.minMonth&&s-this.minMonth<this.monthsInYear(c)&&o>=this.minDay&&o-this.minDay<this.daysInMonth(c)}return this._validateLevel--,a},toJSDate:function(i,s,o){var a=this._validate(i,s,o,u.local.invalidDate||u.regionalOptions[""].invalidDate);return u.instance().fromJD(this.toJD(a)).toJSDate()},fromJSDate:function(i){return this.fromJD(u.instance().fromJSDate(i).toJD())},_validate:function(i,s,o,a){if(i.year){if(this._validateLevel===0&&this.name!==i.calendar().name)throw(u.local.differentCalendars||u.regionalOptions[""].differentCalendars).replace(/\{0\}/,this.local.name).replace(/\{1\}/,i.calendar().local.name);return i}try{if(this._validateLevel++,this._validateLevel===1&&!this.isValid(i,s,o))throw a.replace(/\{0\}/,this.local.name);var c=this.newDate(i,s,o);return this._validateLevel--,c}catch(r){throw this._validateLevel--,r}}}),f.prototype=new e,t(f.prototype,{name:"Gregorian",jdEpoch:17214255e-1,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Gregorian",epochs:["BCE","CE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(i){var s=this._validate(i,this.minMonth,this.minDay,u.local.invalidYear||u.regionalOptions[""].invalidYear);return(i=s.year()+(s.year()<0?1:0))%4==0&&(i%100!=0||i%400==0)},weekOfYear:function(i,s,o){var a=this.newDate(i,s,o);return a.add(4-(a.dayOfWeek()||7),"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInMonth:function(i,s){var o=this._validate(i,s,this.minDay,u.local.invalidMonth||u.regionalOptions[""].invalidMonth);return this.daysPerMonth[o.month()-1]+(o.month()===2&&this.leapYear(o.year())?1:0)},weekDay:function(i,s,o){return(this.dayOfWeek(i,s,o)||7)<6},toJD:function(i,s,o){var a=this._validate(i,s,o,u.local.invalidDate||u.regionalOptions[""].invalidDate);i=a.year(),s=a.month(),o=a.day(),i<0&&i++,s<3&&(s+=12,i--);var c=Math.floor(i/100),r=2-c+Math.floor(c/4);return Math.floor(365.25*(i+4716))+Math.floor(30.6001*(s+1))+o+r-1524.5},fromJD:function(i){var s=Math.floor(i+.5),o=Math.floor((s-186721625e-2)/36524.25),a=(o=s+1+o-Math.floor(o/4))+1524,c=Math.floor((a-122.1)/365.25),r=Math.floor(365.25*c),n=Math.floor((a-r)/30.6001),d=a-r-Math.floor(30.6001*n),l=n-(n>13.5?13:1),y=c-(l>2.5?4716:4715);return y<=0&&y--,this.newDate(y,l,d)},toJSDate:function(i,s,o){var a=this._validate(i,s,o,u.local.invalidDate||u.regionalOptions[""].invalidDate),c=new Date(a.year(),a.month()-1,a.day());return c.setHours(0),c.setMinutes(0),c.setSeconds(0),c.setMilliseconds(0),c.setHours(c.getHours()>12?c.getHours()+2:0),c},fromJSDate:function(i){return this.newDate(i.getFullYear(),i.getMonth()+1,i.getDate())}});var u=N.exports=new m;u.cdate=g,u.baseCalendar=e,u.calendars.gregorian=f},{"object-assign":476}],629:[function(h,N,H){var t=h("object-assign"),m=h("./main");t(m.regionalOptions[""],{invalidArguments:"Invalid arguments",invalidFormat:"Cannot format a date from another calendar",missingNumberAt:"Missing number at position {0}",unknownNameAt:"Unknown name at position {0}",unexpectedLiteralAt:"Unexpected literal at position {0}",unexpectedText:"Additional text found at end"}),m.local=m.regionalOptions[""],t(m.cdate.prototype,{formatDate:function(g,p){return typeof g!="string"&&(p=g,g=""),this._calendar.formatDate(g||"",this,p)}}),t(m.baseCalendar.prototype,{UNIX_EPOCH:m.instance().newDate(1970,1,1).toJD(),SECS_PER_DAY:86400,TICKS_EPOCH:m.instance().jdEpoch,TICKS_PER_DAY:864e9,ATOM:"yyyy-mm-dd",COOKIE:"D, dd M yyyy",FULL:"DD, MM d, yyyy",ISO_8601:"yyyy-mm-dd",JULIAN:"J",RFC_822:"D, d M yy",RFC_850:"DD, dd-M-yy",RFC_1036:"D, d M yy",RFC_1123:"D, d M yyyy",RFC_2822:"D, d M yyyy",RSS:"D, d M yy",TICKS:"!",TIMESTAMP:"@",W3C:"yyyy-mm-dd",formatDate:function(g,p,e){if(typeof g!="string"&&(e=p,p=g,g=""),!p)return"";if(p.calendar()!==this)throw m.local.invalidFormat||m.regionalOptions[""].invalidFormat;g=g||this.local.dateFormat;for(var f,u,i,s,o=(e=e||{}).dayNamesShort||this.local.dayNamesShort,a=e.dayNames||this.local.dayNames,c=e.monthNumbers||this.local.monthNumbers,r=e.monthNamesShort||this.local.monthNamesShort,n=e.monthNames||this.local.monthNames,d=(e.calculateWeek||this.local.calculateWeek,function(L,k){for(var C=1;w+C<g.length&&g.charAt(w+C)===L;)C++;return w+=C-1,Math.floor(C/(k||1))>1}),l=function(L,k,C,M){var P=""+k;if(d(L,M))for(;P.length<C;)P="0"+P;return P},y=this,v=function(L){return typeof c=="function"?c.call(y,L,d("m")):T(l("m",L.month(),2))},_=function(L,k){return k?typeof n=="function"?n.call(y,L):n[L.month()-y.minMonth]:typeof r=="function"?r.call(y,L):r[L.month()-y.minMonth]},x=this.local.digits,T=function(L){return e.localNumbers&&x?x(L):L},A="",S=!1,w=0;w<g.length;w++)if(S)g.charAt(w)!=="'"||d("'")?A+=g.charAt(w):S=!1;else switch(g.charAt(w)){case"d":A+=T(l("d",p.day(),2));break;case"D":A+=(f="D",u=p.dayOfWeek(),i=o,s=a,d(f)?s[u]:i[u]);break;case"o":A+=l("o",p.dayOfYear(),3);break;case"w":A+=l("w",p.weekOfYear(),2);break;case"m":A+=v(p);break;case"M":A+=_(p,d("M"));break;case"y":A+=d("y",2)?p.year():(p.year()%100<10?"0":"")+p.year()%100;break;case"Y":d("Y",2),A+=p.formatYear();break;case"J":A+=p.toJD();break;case"@":A+=(p.toJD()-this.UNIX_EPOCH)*this.SECS_PER_DAY;break;case"!":A+=(p.toJD()-this.TICKS_EPOCH)*this.TICKS_PER_DAY;break;case"'":d("'")?A+="'":S=!0;break;default:A+=g.charAt(w)}return A},parseDate:function(g,p,e){if(p==null)throw m.local.invalidArguments||m.regionalOptions[""].invalidArguments;if((p=typeof p=="object"?p.toString():p+"")==="")return null;g=g||this.local.dateFormat;var f=(e=e||{}).shortYearCutoff||this.shortYearCutoff;f=typeof f!="string"?f:this.today().year()%100+parseInt(f,10);for(var u=e.dayNamesShort||this.local.dayNamesShort,i=e.dayNames||this.local.dayNames,s=e.parseMonth||this.local.parseMonth,o=e.monthNumbers||this.local.monthNumbers,a=e.monthNamesShort||this.local.monthNamesShort,c=e.monthNames||this.local.monthNames,r=-1,n=-1,d=-1,l=-1,y=-1,v=!1,_=!1,x=function(F,j){for(var W=1;M+W<g.length&&g.charAt(M+W)===F;)W++;return M+=W-1,Math.floor(W/(j||1))>1},T=function(F,j){var W=x(F,j),Z=[2,3,W?4:2,W?4:2,10,11,20]["oyYJ@!".indexOf(F)+1],Q=new RegExp("^-?\\d{1,"+Z+"}"),X=p.substring(C).match(Q);if(!X)throw(m.local.missingNumberAt||m.regionalOptions[""].missingNumberAt).replace(/\{0\}/,C);return C+=X[0].length,parseInt(X[0],10)},A=this,S=function(){if(typeof o=="function"){x("m");var F=o.call(A,p.substring(C));return C+=F.length,F}return T("m")},w=function(F,j,W,Z){for(var Q=x(F,Z)?W:j,X=0;X<Q.length;X++)if(p.substr(C,Q[X].length).toLowerCase()===Q[X].toLowerCase())return C+=Q[X].length,X+A.minMonth;throw(m.local.unknownNameAt||m.regionalOptions[""].unknownNameAt).replace(/\{0\}/,C)},L=function(){if(typeof c=="function"){var F=x("M")?c.call(A,p.substring(C)):a.call(A,p.substring(C));return C+=F.length,F}return w("M",a,c)},k=function(){if(p.charAt(C)!==g.charAt(M))throw(m.local.unexpectedLiteralAt||m.regionalOptions[""].unexpectedLiteralAt).replace(/\{0\}/,C);C++},C=0,M=0;M<g.length;M++)if(_)g.charAt(M)!=="'"||x("'")?k():_=!1;else switch(g.charAt(M)){case"d":l=T("d");break;case"D":w("D",u,i);break;case"o":y=T("o");break;case"w":T("w");break;case"m":d=S();break;case"M":d=L();break;case"y":var P=M;v=!x("y",2),M=P,n=T("y",2);break;case"Y":n=T("Y",2);break;case"J":r=T("J")+.5,p.charAt(C)==="."&&(C++,T("J"));break;case"@":r=T("@")/this.SECS_PER_DAY+this.UNIX_EPOCH;break;case"!":r=T("!")/this.TICKS_PER_DAY+this.TICKS_EPOCH;break;case"*":C=p.length;break;case"'":x("'")?k():_=!0;break;default:k()}if(C<p.length)throw m.local.unexpectedText||m.regionalOptions[""].unexpectedText;if(n===-1?n=this.today().year():n<100&&v&&(n+=f===-1?1900:this.today().year()-this.today().year()%100-(n<=f?0:100)),typeof d=="string"&&(d=s.call(this,n,d)),y>-1){d=1,l=y;for(var O=this.daysInMonth(n,d);l>O;O=this.daysInMonth(n,d))d++,l-=O}return r>-1?this.fromJD(r):this.newDate(n,d,l)},determineDate:function(g,p,e,f,u){e&&typeof e!="object"&&(u=f,f=e,e=null),typeof f!="string"&&(u=f,f="");var i=this;return p=p?p.newDate():null,g=g==null?p:typeof g=="string"?function(s){try{return i.parseDate(f,s,u)}catch(r){}for(var o=((s=s.toLowerCase()).match(/^c/)&&e?e.newDate():null)||i.today(),a=/([+-]?[0-9]+)\s*(d|w|m|y)?/g,c=a.exec(s);c;)o.add(parseInt(c[1],10),c[2]||"d"),c=a.exec(s);return o}(g):typeof g=="number"?isNaN(g)||g===1/0||g===-1/0?p:i.today().add(g,"d"):i.newDate(g)}})},{"./main":628,"object-assign":476}],630:[function(h,N,H){var t,m=function(){return function(g,p,e,f,u,i){var s=g[0],o=e[0],a=[0],c=o;f|=0;var r=0,n=o;for(r=0;r<s;++r){var d=p[f]-i,l=p[f+c]-i;d>=0!=l>=0&&u.push(a[0]+.5+.5*(d+l)/(d-l)),f+=n,++a[0]}}};N.exports=(t={funcName:"zeroCrossings"},function(g){var p={};return function(e,f,u){var i=e.dtype,s=e.order,o=[i,s.join()].join(),a=p[o];return a||(p[o]=a=g([i,s])),a(e.shape.slice(0),e.data,e.stride,0|e.offset,f,u)}}(m.bind(void 0,t)))},{}],631:[function(h,N,H){N.exports=function(m,g){var p=[];return g=+g||0,t(m.hi(m.shape[0]-1),p,g),p};var t=h("./lib/zc-core")},{"./lib/zc-core":630}],632:[function(h,N,H){N.exports=[{path:"",backoff:0},{path:"M-2.4,-3V3L0.6,0Z",backoff:.6},{path:"M-3.7,-2.5V2.5L1.3,0Z",backoff:1.3},{path:"M-4.45,-3L-1.65,-0.2V0.2L-4.45,3L1.55,0Z",backoff:1.55},{path:"M-2.2,-2.2L-0.2,-0.2V0.2L-2.2,2.2L-1.4,3L1.6,0L-1.4,-3Z",backoff:1.6},{path:"M-4.4,-2.1L-0.6,-0.2V0.2L-4.4,2.1L-4,3L2,0L-4,-3Z",backoff:2},{path:"M2,0A2,2 0 1,1 0,-2A2,2 0 0,1 2,0Z",backoff:0,noRotate:!0},{path:"M2,2V-2H-2V2Z",backoff:0,noRotate:!0}]},{}],633:[function(h,N,H){var t=h("./arrow_paths"),m=h("../../plots/font_attributes"),g=h("../../plots/cartesian/constants"),p=h("../../plot_api/plot_template").templatedArray;h("../../constants/axis_placeable_objects"),N.exports=p("annotation",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},text:{valType:"string",editType:"calc+arraydraw"},textangle:{valType:"angle",dflt:0,editType:"calc+arraydraw"},font:m({editType:"calc+arraydraw",colorEditType:"arraydraw"}),width:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},height:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},align:{valType:"enumerated",values:["left","center","right"],dflt:"center",editType:"arraydraw"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"arraydraw"},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},bordercolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},borderpad:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},borderwidth:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},showarrow:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},arrowcolor:{valType:"color",editType:"arraydraw"},arrowhead:{valType:"integer",min:0,max:t.length,dflt:1,editType:"arraydraw"},startarrowhead:{valType:"integer",min:0,max:t.length,dflt:1,editType:"arraydraw"},arrowside:{valType:"flaglist",flags:["end","start"],extras:["none"],dflt:"end",editType:"arraydraw"},arrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},startarrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},arrowwidth:{valType:"number",min:.1,editType:"calc+arraydraw"},standoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},startstandoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},ax:{valType:"any",editType:"calc+arraydraw"},ay:{valType:"any",editType:"calc+arraydraw"},axref:{valType:"enumerated",dflt:"pixel",values:["pixel",g.idRegex.x.toString()],editType:"calc"},ayref:{valType:"enumerated",dflt:"pixel",values:["pixel",g.idRegex.y.toString()],editType:"calc"},xref:{valType:"enumerated",values:["paper",g.idRegex.x.toString()],editType:"calc"},x:{valType:"any",editType:"calc+arraydraw"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"auto",editType:"calc+arraydraw"},xshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},yref:{valType:"enumerated",values:["paper",g.idRegex.y.toString()],editType:"calc"},y:{valType:"any",editType:"calc+arraydraw"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"auto",editType:"calc+arraydraw"},yshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},clicktoshow:{valType:"enumerated",values:[!1,"onoff","onout"],dflt:!1,editType:"arraydraw"},xclick:{valType:"any",editType:"arraydraw"},yclick:{valType:"any",editType:"arraydraw"},hovertext:{valType:"string",editType:"arraydraw"},hoverlabel:{bgcolor:{valType:"color",editType:"arraydraw"},bordercolor:{valType:"color",editType:"arraydraw"},font:m({editType:"arraydraw"}),editType:"arraydraw"},captureevents:{valType:"boolean",editType:"arraydraw"},editType:"calc",_deprecated:{ref:{valType:"string",editType:"calc"}}})},{"../../constants/axis_placeable_objects":756,"../../plot_api/plot_template":827,"../../plots/cartesian/constants":845,"../../plots/font_attributes":867,"./arrow_paths":632}],634:[function(h,N,H){var t=h("../../lib"),m=h("../../plots/cartesian/axes"),g=h("./draw").draw;function p(f){var u=f._fullLayout;t.filterVisible(u.annotations).forEach(function(i){var s=m.getFromId(f,i.xref),o=m.getFromId(f,i.yref),a=m.getRefType(i.xref),c=m.getRefType(i.yref);i._extremes={},a==="range"&&e(i,s),c==="range"&&e(i,o)})}function e(f,u){var i,s=u._id,o=s.charAt(0),a=f[o],c=f["a"+o],r=f[o+"ref"],n=f["a"+o+"ref"],d=f["_"+o+"padplus"],l=f["_"+o+"padminus"],y={x:1,y:-1}[o]*f[o+"shift"],v=3*f.arrowsize*f.arrowwidth||0,_=v+y,x=v-y,T=3*f.startarrowsize*f.arrowwidth||0,A=T+y,S=T-y;if(n===r){var w=m.findExtremes(u,[u.r2c(a)],{ppadplus:_,ppadminus:x}),L=m.findExtremes(u,[u.r2c(c)],{ppadplus:Math.max(d,A),ppadminus:Math.max(l,S)});i={min:[w.min[0],L.min[0]],max:[w.max[0],L.max[0]]}}else A=c?A+c:A,S=c?S-c:S,i=m.findExtremes(u,[u.r2c(a)],{ppadplus:Math.max(d,_,A),ppadminus:Math.max(l,x,S)});f._extremes[s]=i}N.exports=function(f){var u=f._fullLayout;if(t.filterVisible(u.annotations).length&&f._fullData.length)return t.syncOrAsync([g,p],f)}},{"../../lib":787,"../../plots/cartesian/axes":838,"./draw":639}],635:[function(h,N,H){var t=h("../../lib"),m=h("../../registry"),g=h("../../plot_api/plot_template").arrayEditor;function p(f,u){var i,s,o,a,c,r,n,d=f._fullLayout.annotations,l=[],y=[],v=[],_=(u||[]).length;for(i=0;i<d.length;i++)if(a=(o=d[i]).clicktoshow){for(s=0;s<_;s++)if(r=(c=u[s]).xaxis,n=c.yaxis,r._id===o.xref&&n._id===o.yref&&r.d2r(c.x)===e(o._xclick,r)&&n.d2r(c.y)===e(o._yclick,n)){(o.visible?a==="onout"?y:v:l).push(i);break}s===_&&o.visible&&a==="onout"&&y.push(i)}return{on:l,off:y,explicitOff:v}}function e(f,u){return u.type==="log"?u.l2r(f):u.d2r(f)}N.exports={hasClickToShow:function(f,u){var i=p(f,u);return i.on.length>0||i.explicitOff.length>0},onClick:function(f,u){var i,s,o=p(f,u),a=o.on,c=o.off.concat(o.explicitOff),r={},n=f._fullLayout.annotations;if(!(!a.length&&!c.length)){for(i=0;i<a.length;i++)(s=g(f.layout,"annotations",n[a[i]])).modifyItem("visible",!0),t.extendFlat(r,s.getUpdateObj());for(i=0;i<c.length;i++)(s=g(f.layout,"annotations",n[c[i]])).modifyItem("visible",!1),t.extendFlat(r,s.getUpdateObj());return m.call("update",f,{},r)}}}},{"../../lib":787,"../../plot_api/plot_template":827,"../../registry":915}],636:[function(h,N,H){var t=h("../../lib"),m=h("../color");N.exports=function(g,p,e,f){f("opacity");var u=f("bgcolor"),i=f("bordercolor"),s=m.opacity(i);f("borderpad");var o=f("borderwidth"),a=f("showarrow");if(f("text",a?" ":e._dfltTitle.annotation),f("textangle"),t.coerceFont(f,"font",e.font),f("width"),f("align"),f("height")&&f("valign"),a){var c,r,n=f("arrowside");n.indexOf("end")!==-1&&(c=f("arrowhead"),r=f("arrowsize")),n.indexOf("start")!==-1&&(f("startarrowhead",c),f("startarrowsize",r)),f("arrowcolor",s?p.bordercolor:m.defaultLine),f("arrowwidth",2*(s&&o||1)),f("standoff"),f("startstandoff")}var d=f("hovertext"),l=e.hoverlabel||{};if(d){var y=f("hoverlabel.bgcolor",l.bgcolor||(m.opacity(u)?m.rgb(u):m.defaultLine)),v=f("hoverlabel.bordercolor",l.bordercolor||m.contrast(y));t.coerceFont(f,"hoverlabel.font",{family:l.font.family,size:l.font.size,color:l.font.color||v})}f("captureevents",!!d)}},{"../../lib":787,"../color":650}],637:[function(h,N,H){var t=h("fast-isnumeric"),m=h("../../lib/to_log_range");N.exports=function(g,p,e,f){p=p||{};var u=e==="log"&&p.type==="linear",i=e==="linear"&&p.type==="log";if(u||i)for(var s,o,a=g._fullLayout.annotations,c=p._id.charAt(0),r=0;r<a.length;r++)s=a[r],o="annotations["+r+"].",s[c+"ref"]===p._id&&n(c),s["a"+c+"ref"]===p._id&&n("a"+c);function n(d){var l=s[d],y=null;y=u?m(l,p.range):Math.pow(10,l),t(y)||(y=null),f(o+d,y)}}},{"../../lib/to_log_range":815,"fast-isnumeric":246}],638:[function(h,N,H){var t=h("../../lib"),m=h("../../plots/cartesian/axes"),g=h("../../plots/array_container_defaults"),p=h("./common_defaults"),e=h("./attributes");function f(u,i,s){function o(L,k){return t.coerce(u,i,e,L,k)}var a=o("visible"),c=o("clicktoshow");if(a||c){p(u,i,s,o);for(var r=i.showarrow,n=["x","y"],d=[-10,-30],l={_fullLayout:s},y=0;y<2;y++){var v=n[y],_=m.coerceRef(u,i,l,v,"","paper");if(_!=="paper"&&m.getFromId(l,_)._annIndices.push(i._index),m.coercePosition(i,l,o,_,v,.5),r){var x="a"+v,T=m.coerceRef(u,i,l,x,"pixel",["pixel","paper"]);T!=="pixel"&&T!==_&&(T=i[x]="pixel");var A=T==="pixel"?d[y]:.4;m.coercePosition(i,l,o,T,x,A)}o(v+"anchor"),o(v+"shift")}if(t.noneOrAll(u,i,["x","y"]),r&&t.noneOrAll(u,i,["ax","ay"]),c){var S=o("xclick"),w=o("yclick");i._xclick=S===void 0?i.x:m.cleanPosition(S,l,i.xref),i._yclick=w===void 0?i.y:m.cleanPosition(w,l,i.yref)}}}N.exports=function(u,i){g(u,i,{name:"annotations",handleItemDefaults:f})}},{"../../lib":787,"../../plots/array_container_defaults":833,"../../plots/cartesian/axes":838,"./attributes":633,"./common_defaults":636}],639:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../registry"),g=h("../../plots/plots"),p=h("../../lib"),e=p.strTranslate,f=h("../../plots/cartesian/axes"),u=h("../color"),i=h("../drawing"),s=h("../fx"),o=h("../../lib/svg_text_utils"),a=h("../../lib/setcursor"),c=h("../dragelement"),r=h("../../plot_api/plot_template").arrayEditor,n=h("./draw_arrow_head");function d(v,_){var x=v._fullLayout.annotations[_]||{},T=f.getFromId(v,x.xref),A=f.getFromId(v,x.yref);T&&T.setScale(),A&&A.setScale(),y(v,x,_,!1,T,A)}function l(v,_,x,T,A){var S=A[x],w=A[x+"ref"],L=x.indexOf("y")!==-1,k=f.getRefType(w)==="domain",C=L?T.h:T.w;return v?k?S+(L?-_:_)/v._length:v.p2r(v.r2p(S)+_):S+(L?-_:_)/C}function y(v,_,x,T,A,S){var w,L,k=v._fullLayout,C=v._fullLayout._size,M=v._context.edits;T?(w="annotation-"+T,L=T+".annotations"):(w="annotation",L="annotations");var P=r(v.layout,L,_),O=P.modifyBase,F=P.modifyItem,j=P.getUpdateObj;k._infolayer.selectAll("."+w+'[data-index="'+x+'"]').remove();var W="clip"+k._uid+"_ann"+x;if(_._input&&_.visible!==!1){var Z={x:{},y:{}},Q=+_.textangle||0,X=k._infolayer.append("g").classed(w,!0).attr("data-index",String(x)).style("opacity",_.opacity),G=X.append("g").classed("annotation-text-g",!0),Y=M[_.showarrow?"annotationTail":"annotationPosition"],K=_.captureevents||M.annotationText||Y,D=G.append("g").style("pointer-events",K?"all":null).call(a,"pointer").on("click",function(){v._dragging=!1,v.emit("plotly_clickannotation",se(t.event))});_.hovertext&&D.on("mouseover",function(){var ve=_.hoverlabel,ke=ve.font,Ee=this.getBoundingClientRect(),be=v.getBoundingClientRect();s.loneHover({x0:Ee.left-be.left,x1:Ee.right-be.left,y:(Ee.top+Ee.bottom)/2-be.top,text:_.hovertext,color:ve.bgcolor,borderColor:ve.bordercolor,fontFamily:ke.family,fontSize:ke.size,fontColor:ke.color},{container:k._hoverlayer.node(),outerContainer:k._paper.node(),gd:v})}).on("mouseout",function(){s.loneUnhover(k._hoverlayer.node())});var B=_.borderwidth,q=_.borderpad,ee=B+q,J=D.append("rect").attr("class","bg").style("stroke-width",B+"px").call(u.stroke,_.bordercolor).call(u.fill,_.bgcolor),$=_.width||_.height,te=k._topclips.selectAll("#"+W).data($?[0]:[]);te.enter().append("clipPath").classed("annclip",!0).attr("id",W).append("rect"),te.exit().remove();var ie=_.font,ae=k._meta?p.templateString(_.text,k._meta):_.text,he=D.append("text").classed("annotation-text",!0).text(ae);M.annotationText?he.call(o.makeEditable,{delegate:D,gd:v}).call(de).on("edit",function(ve){_.text=ve,this.call(de),F("text",ve),A&&A.autorange&&O(A._name+".autorange",!0),S&&S.autorange&&O(S._name+".autorange",!0),m.call("_guiRelayout",v,j())}):he.call(de)}else t.selectAll("#"+W).remove();function se(ve){var ke={index:x,annotation:_._input,fullAnnotation:_,event:ve};return T&&(ke.subplotId=T),ke}function de(ve){return ve.call(i.font,ie).attr({"text-anchor":{left:"start",right:"end"}[_.align]||"middle"}),o.convertToTspans(ve,v,ce),ve}function ce(){var ve=he.selectAll("a");ve.size()===1&&ve.text()===he.text()&&D.insert("a",":first-child").attr({"xlink:xlink:href":ve.attr("xlink:href"),"xlink:xlink:show":ve.attr("xlink:show")}).style({cursor:"pointer"}).node().appendChild(J.node());var ke=D.select(".annotation-text-math-group"),Ee=!ke.empty(),be=i.bBox((Ee?ke:he).node()),xe=be.width,ue=be.height,me=_.width||xe,we=_.height||ue,Me=Math.round(me+2*ee),Se=Math.round(we+2*ee);function De(nt,At){return At==="auto"&&(At=nt<1/3?"left":nt>2/3?"right":"center"),{center:0,middle:0,left:.5,bottom:-.5,right:-.5,top:.5}[At]}for(var Fe=!1,Ye=["x","y"],et=0;et<Ye.length;et++){var Oe,je,We,Ge,Qe,it=Ye[et],lt=_[it+"ref"]||it,Lt=_["a"+it+"ref"],wt={x:A,y:S}[it],rt=(Q+(it==="x"?0:-90))*Math.PI/180,$e=Me*Math.cos(rt),xt=Se*Math.sin(rt),Qt=Math.abs($e)+Math.abs(xt),$t=_[it+"anchor"],Ue=_[it+"shift"]*(it==="x"?1:-1),He=Z[it],Be=f.getRefType(lt);if(wt&&Be!=="domain"){var Je=wt.r2fraction(_[it]);(Je<0||Je>1)&&(Lt===lt?((Je=wt.r2fraction(_["a"+it]))<0||Je>1)&&(Fe=!0):Fe=!0),Oe=wt._offset+wt.r2p(_[it]),Ge=.5}else{var _e=Be==="domain";it==="x"?(We=_[it],Oe=_e?wt._offset+wt._length*We:Oe=C.l+C.w*We):(We=1-_[it],Oe=_e?wt._offset+wt._length*We:Oe=C.t+C.h*We),Ge=_.showarrow?.5:We}if(_.showarrow){He.head=Oe;var Le=_["a"+it];if(Qe=$e*De(.5,_.xanchor)-xt*De(.5,_.yanchor),Lt===lt){var Ce=f.getRefType(Lt);Ce==="domain"?(it==="y"&&(Le=1-Le),He.tail=wt._offset+wt._length*Le):Ce==="paper"?it==="y"?(Le=1-Le,He.tail=C.t+C.h*Le):He.tail=C.l+C.w*Le:He.tail=wt._offset+wt.r2p(Le),je=Qe}else He.tail=Oe+Le,je=Qe+Le;He.text=He.tail+Qe;var Pe=k[it==="x"?"width":"height"];if(lt==="paper"&&(He.head=p.constrain(He.head,1,Pe-1)),Lt==="pixel"){var Xe=-Math.max(He.tail-3,He.text),ut=Math.min(He.tail+3,He.text)-Pe;Xe>0?(He.tail+=Xe,He.text+=Xe):ut>0&&(He.tail-=ut,He.text-=ut)}He.tail+=Ue,He.head+=Ue}else je=Qe=Qt*De(Ge,$t),He.text=Oe+Qe;He.text+=Ue,Qe+=Ue,je+=Ue,_["_"+it+"padplus"]=Qt/2+je,_["_"+it+"padminus"]=Qt/2-je,_["_"+it+"size"]=Qt,_["_"+it+"shift"]=Qe}if(Fe)D.remove();else{var kt=0,ft=0;if(_.align!=="left"&&(kt=(me-xe)*(_.align==="center"?.5:1)),_.valign!=="top"&&(ft=(we-ue)*(_.valign==="middle"?.5:1)),Ee)ke.select("svg").attr({x:ee+kt-1,y:ee+ft}).call(i.setClipUrl,$?W:null,v);else{var Et=ee+ft-be.top,mt=ee+kt-be.left;he.call(o.positionText,mt,Et).call(i.setClipUrl,$?W:null,v)}te.select("rect").call(i.setRect,ee,ee,me,we),J.call(i.setRect,B/2,B/2,Me-B,Se-B),D.call(i.setTranslate,Math.round(Z.x.text-Me/2),Math.round(Z.y.text-Se/2)),G.attr({transform:"rotate("+Q+","+Z.x.text+","+Z.y.text+")"});var It,vt=function(nt,At){X.selectAll(".annotation-arrow-g").remove();var Ft=Z.x.head,Nt=Z.y.head,Kt=Z.x.tail+nt,Ie=Z.y.tail+At,ot=Z.x.text+nt,bt=Z.y.text+At,Pt=p.rotationXYMatrix(Q,ot,bt),Vt=p.apply2DTransform(Pt),nr=p.apply2DTransform2(Pt),Yt=+J.attr("width"),Xt=+J.attr("height"),ar=ot-.5*Yt,hr=ar+Yt,mr=bt-.5*Xt,sr=mr+Xt,fr=[[ar,mr,ar,sr],[ar,sr,hr,sr],[hr,sr,hr,mr],[hr,mr,ar,mr]].map(nr);if(!fr.reduce(function(Lr,Qr){return Lr^!!p.segmentsIntersect(Ft,Nt,Ft+1e6,Nt+1e6,Qr[0],Qr[1],Qr[2],Qr[3])},!1)){fr.forEach(function(Lr){var Qr=p.segmentsIntersect(Kt,Ie,Ft,Nt,Lr[0],Lr[1],Lr[2],Lr[3]);Qr&&(Kt=Qr.x,Ie=Qr.y)});var yr=_.arrowwidth,zr=_.arrowcolor,xr=_.arrowside,Br=X.append("g").style({opacity:u.opacity(zr)}).classed("annotation-arrow-g",!0),Jr=Br.append("path").attr("d","M"+Kt+","+Ie+"L"+Ft+","+Nt).style("stroke-width",yr+"px").call(u.stroke,u.rgb(zr));if(n(Jr,xr,_),M.annotationPosition&&Jr.node().parentNode&&!T){var fn=Ft,Cn=Nt;if(_.standoff){var Pn=Math.sqrt(Math.pow(Ft-Kt,2)+Math.pow(Nt-Ie,2));fn+=_.standoff*(Kt-Ft)/Pn,Cn+=_.standoff*(Ie-Nt)/Pn}var An,rn,Fr=Br.append("path").classed("annotation-arrow",!0).classed("anndrag",!0).classed("cursor-move",!0).attr({d:"M3,3H-3V-3H3ZM0,0L"+(Kt-fn)+","+(Ie-Cn),transform:e(fn,Cn)}).style("stroke-width",yr+6+"px").call(u.stroke,"rgba(0,0,0,0)").call(u.fill,"rgba(0,0,0,0)");c.init({element:Fr.node(),gd:v,prepFn:function(){var Lr=i.getTranslate(D);An=Lr.x,rn=Lr.y,A&&A.autorange&&O(A._name+".autorange",!0),S&&S.autorange&&O(S._name+".autorange",!0)},moveFn:function(Lr,Qr){var $r=Vt(An,rn),Kr=$r[0]+Lr,en=$r[1]+Qr;D.call(i.setTranslate,Kr,en),F("x",l(A,Lr,"x",C,_)),F("y",l(S,Qr,"y",C,_)),_.axref===_.xref&&F("ax",l(A,Lr,"ax",C,_)),_.ayref===_.yref&&F("ay",l(S,Qr,"ay",C,_)),Br.attr("transform",e(Lr,Qr)),G.attr({transform:"rotate("+Q+","+Kr+","+en+")"})},doneFn:function(){m.call("_guiRelayout",v,j());var Lr=document.querySelector(".js-notes-box-panel");Lr&&Lr.redraw(Lr.selectedObj)}})}}};_.showarrow&&vt(0,0),Y&&c.init({element:D.node(),gd:v,prepFn:function(){It=G.attr("transform")},moveFn:function(nt,At){var Ft="pointer";if(_.showarrow)_.axref===_.xref?F("ax",l(A,nt,"ax",C,_)):F("ax",_.ax+nt),_.ayref===_.yref?F("ay",l(S,At,"ay",C.w,_)):F("ay",_.ay+At),vt(nt,At);else{if(T)return;var Nt,Kt;if(A)Nt=l(A,nt,"x",C,_);else{var Ie=_._xsize/C.w,ot=_.x+(_._xshift-_.xshift)/C.w-Ie/2;Nt=c.align(ot+nt/C.w,Ie,0,1,_.xanchor)}if(S)Kt=l(S,At,"y",C,_);else{var bt=_._ysize/C.h,Pt=_.y-(_._yshift+_.yshift)/C.h-bt/2;Kt=c.align(Pt-At/C.h,bt,0,1,_.yanchor)}F("x",Nt),F("y",Kt),A&&S||(Ft=c.getCursor(A?.5:Nt,S?.5:Kt,_.xanchor,_.yanchor))}G.attr({transform:e(nt,At)+It}),a(D,Ft)},clickFn:function(nt,At){_.captureevents&&v.emit("plotly_clickannotation",se(At))},doneFn:function(){a(D),m.call("_guiRelayout",v,j());var nt=document.querySelector(".js-notes-box-panel");nt&&nt.redraw(nt.selectedObj)}})}}}N.exports={draw:function(v){var _=v._fullLayout;_._infolayer.selectAll(".annotation").remove();for(var x=0;x<_.annotations.length;x++)_.annotations[x].visible&&d(v,x);return g.previousPromises(v)},drawOne:d,drawRaw:y}},{"../../lib":787,"../../lib/setcursor":808,"../../lib/svg_text_utils":813,"../../plot_api/plot_template":827,"../../plots/cartesian/axes":838,"../../plots/plots":901,"../../registry":915,"../color":650,"../dragelement":669,"../drawing":672,"../fx":690,"./draw_arrow_head":640,"@plotly/d3":58}],640:[function(h,N,H){var t=h("@plotly/d3"),m=h("../color"),g=h("./arrow_paths"),p=h("../../lib"),e=p.strScale,f=p.strRotate,u=p.strTranslate;N.exports=function(i,s,o){var a,c,r,n,d=i.node(),l=g[o.arrowhead||0],y=g[o.startarrowhead||0],v=(o.arrowwidth||1)*(o.arrowsize||1),_=(o.arrowwidth||1)*(o.startarrowsize||1),x=s.indexOf("start")>=0,T=s.indexOf("end")>=0,A=l.backoff*v+o.standoff,S=y.backoff*_+o.startstandoff;if(d.nodeName==="line"){a={x:+i.attr("x1"),y:+i.attr("y1")},c={x:+i.attr("x2"),y:+i.attr("y2")};var w=a.x-c.x,L=a.y-c.y;if(n=(r=Math.atan2(L,w))+Math.PI,A&&S&&A+S>Math.sqrt(w*w+L*L))return void X();if(A){if(A*A>w*w+L*L)return void X();var k=A*Math.cos(r),C=A*Math.sin(r);c.x+=k,c.y+=C,i.attr({x2:c.x,y2:c.y})}if(S){if(S*S>w*w+L*L)return void X();var M=S*Math.cos(r),P=S*Math.sin(r);a.x-=M,a.y-=P,i.attr({x1:a.x,y1:a.y})}}else if(d.nodeName==="path"){var O=d.getTotalLength(),F="";if(O<A+S)return void X();var j=d.getPointAtLength(0),W=d.getPointAtLength(.1);r=Math.atan2(j.y-W.y,j.x-W.x),a=d.getPointAtLength(Math.min(S,O)),F="0px,"+S+"px,";var Z=d.getPointAtLength(O),Q=d.getPointAtLength(O-.1);n=Math.atan2(Z.y-Q.y,Z.x-Q.x),c=d.getPointAtLength(Math.max(0,O-A)),F+=O-(F?S+A:A)+"px,"+O+"px",i.style("stroke-dasharray",F)}function X(){i.style("stroke-dasharray","0px,100px")}function G(Y,K,D,B){Y.path&&(Y.noRotate&&(D=0),t.select(d.parentNode).append("path").attr({class:i.attr("class"),d:Y.path,transform:u(K.x,K.y)+f(180*D/Math.PI)+e(B)}).style({fill:m.rgb(o.arrowcolor),"stroke-width":0}))}x&&G(y,a,r,_),T&&G(l,c,n,v)}},{"../../lib":787,"../color":650,"./arrow_paths":632,"@plotly/d3":58}],641:[function(h,N,H){var t=h("./draw"),m=h("./click");N.exports={moduleType:"component",name:"annotations",layoutAttributes:h("./attributes"),supplyLayoutDefaults:h("./defaults"),includeBasePlot:h("../../plots/cartesian/include_components")("annotations"),calcAutorange:h("./calc_autorange"),draw:t.draw,drawOne:t.drawOne,drawRaw:t.drawRaw,hasClickToShow:m.hasClickToShow,onClick:m.onClick,convertCoords:h("./convert_coords")}},{"../../plots/cartesian/include_components":851,"./attributes":633,"./calc_autorange":634,"./click":635,"./convert_coords":637,"./defaults":638,"./draw":639}],642:[function(h,N,H){var t=h("../annotations/attributes"),m=h("../../plot_api/edit_types").overrideAll,g=h("../../plot_api/plot_template").templatedArray;N.exports=m(g("annotation",{visible:t.visible,x:{valType:"any"},y:{valType:"any"},z:{valType:"any"},ax:{valType:"number"},ay:{valType:"number"},xanchor:t.xanchor,xshift:t.xshift,yanchor:t.yanchor,yshift:t.yshift,text:t.text,textangle:t.textangle,font:t.font,width:t.width,height:t.height,opacity:t.opacity,align:t.align,valign:t.valign,bgcolor:t.bgcolor,bordercolor:t.bordercolor,borderpad:t.borderpad,borderwidth:t.borderwidth,showarrow:t.showarrow,arrowcolor:t.arrowcolor,arrowhead:t.arrowhead,startarrowhead:t.startarrowhead,arrowside:t.arrowside,arrowsize:t.arrowsize,startarrowsize:t.startarrowsize,arrowwidth:t.arrowwidth,standoff:t.standoff,startstandoff:t.startstandoff,hovertext:t.hovertext,hoverlabel:t.hoverlabel,captureevents:t.captureevents}),"calc","from-root")},{"../../plot_api/edit_types":820,"../../plot_api/plot_template":827,"../annotations/attributes":633}],643:[function(h,N,H){var t=h("../../lib"),m=h("../../plots/cartesian/axes");function g(p,e){var f=e.fullSceneLayout.domain,u=e.fullLayout._size,i={pdata:null,type:"linear",autorange:!1,range:[-1/0,1/0]};p._xa={},t.extendFlat(p._xa,i),m.setConvert(p._xa),p._xa._offset=u.l+f.x[0]*u.w,p._xa.l2p=function(){return .5*(1+p._pdata[0]/p._pdata[3])*u.w*(f.x[1]-f.x[0])},p._ya={},t.extendFlat(p._ya,i),m.setConvert(p._ya),p._ya._offset=u.t+(1-f.y[1])*u.h,p._ya.l2p=function(){return .5*(1-p._pdata[1]/p._pdata[3])*u.h*(f.y[1]-f.y[0])}}N.exports=function(p){for(var e=p.fullSceneLayout.annotations,f=0;f<e.length;f++)g(e[f],p);p.fullLayout._infolayer.selectAll(".annotation-"+p.id).remove()}},{"../../lib":787,"../../plots/cartesian/axes":838}],644:[function(h,N,H){var t=h("../../lib"),m=h("../../plots/cartesian/axes"),g=h("../../plots/array_container_defaults"),p=h("../annotations/common_defaults"),e=h("./attributes");function f(u,i,s,o){function a(r,n){return t.coerce(u,i,e,r,n)}function c(r){var n=r+"axis",d={_fullLayout:{}};return d._fullLayout[n]=s[n],m.coercePosition(i,d,a,r,r,.5)}a("visible")&&(p(u,i,o.fullLayout,a),c("x"),c("y"),c("z"),t.noneOrAll(u,i,["x","y","z"]),i.xref="x",i.yref="y",i.zref="z",a("xanchor"),a("yanchor"),a("xshift"),a("yshift"),i.showarrow&&(i.axref="pixel",i.ayref="pixel",a("ax",-10),a("ay",-30),t.noneOrAll(u,i,["ax","ay"])))}N.exports=function(u,i,s){g(u,i,{name:"annotations",handleItemDefaults:f,fullLayout:s.fullLayout})}},{"../../lib":787,"../../plots/array_container_defaults":833,"../../plots/cartesian/axes":838,"../annotations/common_defaults":636,"./attributes":642}],645:[function(h,N,H){var t=h("../annotations/draw").drawRaw,m=h("../../plots/gl3d/project"),g=["x","y","z"];N.exports=function(p){for(var e=p.fullSceneLayout,f=p.dataScale,u=e.annotations,i=0;i<u.length;i++){for(var s=u[i],o=!1,a=0;a<3;a++){var c=g[a],r=s[c],n=e[c+"axis"].r2fraction(r);if(n<0||n>1){o=!0;break}}o?p.fullLayout._infolayer.select(".annotation-"+p.id+'[data-index="'+i+'"]').remove():(s._pdata=m(p.glplot.cameraParams,[e.xaxis.r2l(s.x)*f[0],e.yaxis.r2l(s.y)*f[1],e.zaxis.r2l(s.z)*f[2]]),t(p.graphDiv,s,i,p.id,s._xa,s._ya))}}},{"../../plots/gl3d/project":889,"../annotations/draw":639}],646:[function(h,N,H){var t=h("../../registry"),m=h("../../lib");N.exports={moduleType:"component",name:"annotations3d",schema:{subplots:{scene:{annotations:h("./attributes")}}},layoutAttributes:h("./attributes"),handleDefaults:h("./defaults"),includeBasePlot:function(g,p){var e=t.subplotsRegistry.gl3d;if(!!e)for(var f=e.attrRegex,u=Object.keys(g),i=0;i<u.length;i++){var s=u[i];f.test(s)&&(g[s].annotations||[]).length&&(m.pushUnique(p._basePlotModules,e),m.pushUnique(p._subplots.gl3d,s))}},convert:h("./convert"),draw:h("./draw")}},{"../../lib":787,"../../registry":915,"./attributes":642,"./convert":643,"./defaults":644,"./draw":645}],647:[function(h,N,H){N.exports=h("world-calendars/dist/main"),h("world-calendars/dist/plus"),h("world-calendars/dist/calendars/chinese"),h("world-calendars/dist/calendars/coptic"),h("world-calendars/dist/calendars/discworld"),h("world-calendars/dist/calendars/ethiopian"),h("world-calendars/dist/calendars/hebrew"),h("world-calendars/dist/calendars/islamic"),h("world-calendars/dist/calendars/julian"),h("world-calendars/dist/calendars/mayan"),h("world-calendars/dist/calendars/nanakshahi"),h("world-calendars/dist/calendars/nepali"),h("world-calendars/dist/calendars/persian"),h("world-calendars/dist/calendars/taiwan"),h("world-calendars/dist/calendars/thai"),h("world-calendars/dist/calendars/ummalqura")},{"world-calendars/dist/calendars/chinese":614,"world-calendars/dist/calendars/coptic":615,"world-calendars/dist/calendars/discworld":616,"world-calendars/dist/calendars/ethiopian":617,"world-calendars/dist/calendars/hebrew":618,"world-calendars/dist/calendars/islamic":619,"world-calendars/dist/calendars/julian":620,"world-calendars/dist/calendars/mayan":621,"world-calendars/dist/calendars/nanakshahi":622,"world-calendars/dist/calendars/nepali":623,"world-calendars/dist/calendars/persian":624,"world-calendars/dist/calendars/taiwan":625,"world-calendars/dist/calendars/thai":626,"world-calendars/dist/calendars/ummalqura":627,"world-calendars/dist/main":628,"world-calendars/dist/plus":629}],648:[function(h,N,H){var t=h("./calendars"),m=h("../../lib"),g=h("../../constants/numerical"),p=g.EPOCHJD,e=g.ONEDAY,f={valType:"enumerated",values:m.sortObjectKeys(t.calendars),editType:"calc",dflt:"gregorian"},u=function(y,v,_,x){var T={};return T[_]=f,m.coerce(y,v,T,_,x)},i={d:{0:"dd","-":"d"},e:{0:"d","-":"d"},a:{0:"D","-":"D"},A:{0:"DD","-":"DD"},j:{0:"oo","-":"o"},W:{0:"ww","-":"w"},m:{0:"mm","-":"m"},b:{0:"M","-":"M"},B:{0:"MM","-":"MM"},y:{0:"yy","-":"yy"},Y:{0:"yyyy","-":"yyyy"},U:"##",w:"##",c:{0:"D M d %X yyyy","-":"D M d %X yyyy"},x:{0:"mm/dd/yyyy","-":"mm/dd/yyyy"}},s={};function o(y){var v=s[y];return v||(v=s[y]=t.instance(y))}function a(y){return m.extendFlat({},f,{description:y})}function c(y){return"Sets the calendar system to use with `"+y+"` date data."}var r={xcalendar:a(c("x"))},n=m.extendFlat({},r,{ycalendar:a(c("y"))}),d=m.extendFlat({},n,{zcalendar:a(c("z"))}),l=a(["Sets the calendar system to use for `range` and `tick0`","if this is a date axis. This does not set the calendar for","interpreting data on this axis, that's specified in the trace","or via the global `layout.calendar`"].join(" "));N.exports={moduleType:"component",name:"calendars",schema:{traces:{scatter:n,bar:n,box:n,heatmap:n,contour:n,histogram:n,histogram2d:n,histogram2dcontour:n,scatter3d:d,surface:d,mesh3d:d,scattergl:n,ohlc:r,candlestick:r},layout:{calendar:a(["Sets the default calendar system to use for interpreting and","displaying dates throughout the plot."].join(" "))},subplots:{xaxis:{calendar:l},yaxis:{calendar:l},scene:{xaxis:{calendar:l},yaxis:{calendar:l},zaxis:{calendar:l}},polar:{radialaxis:{calendar:l}}},transforms:{filter:{valuecalendar:a(["WARNING: All transforms are deprecated and may be removed from the API in next major version.","Sets the calendar system to use for `value`, if it is a date."].join(" ")),targetcalendar:a(["WARNING: All transforms are deprecated and may be removed from the API in next major version.","Sets the calendar system to use for `target`, if it is an","array of dates. If `target` is a string (eg *x*) we use the","corresponding trace attribute (eg `xcalendar`) if it exists,","even if `targetcalendar` is provided."].join(" "))}}},layoutAttributes:f,handleDefaults:u,handleTraceDefaults:function(y,v,_,x){for(var T=0;T<_.length;T++)u(y,v,_[T]+"calendar",x.calendar)},CANONICAL_SUNDAY:{chinese:"2000-01-02",coptic:"2000-01-03",discworld:"2000-01-03",ethiopian:"2000-01-05",hebrew:"5000-01-01",islamic:"1000-01-02",julian:"2000-01-03",mayan:"5000-01-01",nanakshahi:"1000-01-05",nepali:"2000-01-05",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-04",thai:"2000-01-04",ummalqura:"1400-01-06"},CANONICAL_TICK:{chinese:"2000-01-01",coptic:"2000-01-01",discworld:"2000-01-01",ethiopian:"2000-01-01",hebrew:"5000-01-01",islamic:"1000-01-01",julian:"2000-01-01",mayan:"5000-01-01",nanakshahi:"1000-01-01",nepali:"2000-01-01",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-01",thai:"2000-01-01",ummalqura:"1400-01-01"},DFLTRANGE:{chinese:["2000-01-01","2001-01-01"],coptic:["1700-01-01","1701-01-01"],discworld:["1800-01-01","1801-01-01"],ethiopian:["2000-01-01","2001-01-01"],hebrew:["5700-01-01","5701-01-01"],islamic:["1400-01-01","1401-01-01"],julian:["2000-01-01","2001-01-01"],mayan:["5200-01-01","5201-01-01"],nanakshahi:["0500-01-01","0501-01-01"],nepali:["2000-01-01","2001-01-01"],persian:["1400-01-01","1401-01-01"],jalali:["1400-01-01","1401-01-01"],taiwan:["0100-01-01","0101-01-01"],thai:["2500-01-01","2501-01-01"],ummalqura:["1400-01-01","1401-01-01"]},getCal:o,worldCalFmt:function(y,v,_){for(var x,T,A,S,w,L=Math.floor((v+.05)/e)+p,k=o(_).fromJD(L),C=0;(C=y.indexOf("%",C))!==-1;)(x=y.charAt(C+1))==="0"||x==="-"||x==="_"?(A=3,T=y.charAt(C+2),x==="_"&&(x="-")):(T=x,x="0",A=2),(S=i[T])?(w=S==="##"?"##":k.formatDate(S[x]),y=y.substr(0,C)+w+y.substr(C+A),C+=w.length):C+=A;return y}}},{"../../constants/numerical":763,"../../lib":787,"./calendars":647}],649:[function(h,N,H){H.defaults=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],H.defaultLine="#444",H.lightLine="#eee",H.background="#fff",H.borderLine="#BEC8D9",H.lightFraction=1e3/11},{}],650:[function(h,N,H){var t=h("tinycolor2"),m=h("fast-isnumeric"),g=h("../../lib/array").isTypedArray,p=N.exports={},e=h("./attributes");p.defaults=e.defaults;var f=p.defaultLine=e.defaultLine;p.lightLine=e.lightLine;var u=p.background=e.background;function i(s){if(m(s)||typeof s!="string")return s;var o=s.trim();if(o.substr(0,3)!=="rgb")return s;var a=o.match(/^rgba?\s*\(([^()]*)\)$/);if(!a)return s;var c=a[1].trim().split(/\s*[\s,]\s*/),r=o.charAt(3)==="a"&&c.length===4;if(!r&&c.length!==3)return s;for(var n=0;n<c.length;n++){if(!c[n].length||(c[n]=Number(c[n]),!(c[n]>=0)))return s;if(n===3)c[n]>1&&(c[n]=1);else if(c[n]>=1)return s}var d=Math.round(255*c[0])+", "+Math.round(255*c[1])+", "+Math.round(255*c[2]);return r?"rgba("+d+", "+c[3]+")":"rgb("+d+")"}p.tinyRGB=function(s){var o=s.toRgb();return"rgb("+Math.round(o.r)+", "+Math.round(o.g)+", "+Math.round(o.b)+")"},p.rgb=function(s){return p.tinyRGB(t(s))},p.opacity=function(s){return s?t(s).getAlpha():0},p.addOpacity=function(s,o){var a=t(s).toRgb();return"rgba("+Math.round(a.r)+", "+Math.round(a.g)+", "+Math.round(a.b)+", "+o+")"},p.combine=function(s,o){var a=t(s).toRgb();if(a.a===1)return t(s).toRgbString();var c=t(o||u).toRgb(),r=c.a===1?c:{r:255*(1-c.a)+c.r*c.a,g:255*(1-c.a)+c.g*c.a,b:255*(1-c.a)+c.b*c.a},n={r:r.r*(1-a.a)+a.r*a.a,g:r.g*(1-a.a)+a.g*a.a,b:r.b*(1-a.a)+a.b*a.a};return t(n).toRgbString()},p.contrast=function(s,o,a){var c=t(s);return c.getAlpha()!==1&&(c=t(p.combine(s,u))),(c.isDark()?o?c.lighten(o):u:a?c.darken(a):f).toString()},p.stroke=function(s,o){var a=t(o);s.style({stroke:p.tinyRGB(a),"stroke-opacity":a.getAlpha()})},p.fill=function(s,o){var a=t(o);s.style({fill:p.tinyRGB(a),"fill-opacity":a.getAlpha()})},p.clean=function(s){if(s&&typeof s=="object"){var o,a,c,r,n=Object.keys(s);for(o=0;o<n.length;o++)if(r=s[c=n[o]],c.substr(c.length-5)==="color")if(Array.isArray(r))for(a=0;a<r.length;a++)r[a]=i(r[a]);else s[c]=i(r);else if(c.substr(c.length-10)==="colorscale"&&Array.isArray(r))for(a=0;a<r.length;a++)Array.isArray(r[a])&&(r[a][1]=i(r[a][1]));else if(Array.isArray(r)){var d=r[0];if(!Array.isArray(d)&&d&&typeof d=="object")for(a=0;a<r.length;a++)p.clean(r[a])}else r&&typeof r=="object"&&!g(r)&&p.clean(r)}}},{"../../lib/array":769,"./attributes":649,"fast-isnumeric":246,tinycolor2:583}],651:[function(h,N,H){var t=h("../../plots/cartesian/layout_attributes"),m=h("../../plots/font_attributes"),g=h("../../lib/extend").extendFlat,p=h("../../plot_api/edit_types").overrideAll;N.exports=p({thicknessmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"pixels"},thickness:{valType:"number",min:0,dflt:30},lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",dflt:1.02,min:-2,max:3},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},xpad:{valType:"number",min:0,dflt:10},y:{valType:"number",dflt:.5,min:-2,max:3},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle"},ypad:{valType:"number",min:0,dflt:10},outlinecolor:t.linecolor,outlinewidth:t.linewidth,bordercolor:t.linecolor,borderwidth:{valType:"number",min:0,dflt:0},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)"},tickmode:t.tickmode,nticks:t.nticks,tick0:t.tick0,dtick:t.dtick,tickvals:t.tickvals,ticktext:t.ticktext,ticks:g({},t.ticks,{dflt:""}),ticklabeloverflow:g({},t.ticklabeloverflow,{}),ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside bottom","inside bottom"],dflt:"outside"},ticklen:t.ticklen,tickwidth:t.tickwidth,tickcolor:t.tickcolor,showticklabels:t.showticklabels,tickfont:m({}),tickangle:t.tickangle,tickformat:t.tickformat,tickformatstops:t.tickformatstops,tickprefix:t.tickprefix,showtickprefix:t.showtickprefix,ticksuffix:t.ticksuffix,showticksuffix:t.showticksuffix,separatethousands:t.separatethousands,exponentformat:t.exponentformat,minexponent:t.minexponent,showexponent:t.showexponent,title:{text:{valType:"string"},font:m({}),side:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}},_deprecated:{title:{valType:"string"},titlefont:m({}),titleside:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}}},"colorbars","from-root")},{"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plots/cartesian/layout_attributes":853,"../../plots/font_attributes":867}],652:[function(h,N,H){N.exports={cn:{colorbar:"colorbar",cbbg:"cbbg",cbfill:"cbfill",cbfills:"cbfills",cbline:"cbline",cblines:"cblines",cbaxis:"cbaxis",cbtitleunshift:"cbtitleunshift",cbtitle:"cbtitle",cboutline:"cboutline",crisp:"crisp",jsPlaceholder:"js-placeholder"}}},{}],653:[function(h,N,H){var t=h("../../lib"),m=h("../../plot_api/plot_template"),g=h("../../plots/cartesian/tick_value_defaults"),p=h("../../plots/cartesian/tick_mark_defaults"),e=h("../../plots/cartesian/tick_label_defaults"),f=h("./attributes");N.exports=function(u,i,s){var o=m.newContainer(i,"colorbar"),a=u.colorbar||{};function c(x,T){return t.coerce(a,o,f,x,T)}var r=c("thicknessmode");c("thickness",r==="fraction"?30/(s.width-s.margin.l-s.margin.r):30);var n=c("lenmode");c("len",n==="fraction"?1:s.height-s.margin.t-s.margin.b),c("x"),c("xanchor"),c("xpad"),c("y"),c("yanchor"),c("ypad"),t.noneOrAll(a,o,["x","y"]),c("outlinecolor"),c("outlinewidth"),c("bordercolor"),c("borderwidth"),c("bgcolor");var d=c("ticklabelposition");c("ticklabeloverflow",d.indexOf("inside")!==-1?"hide past domain":"hide past div"),g(a,o,c,"linear");var l=s.font,y={outerTicks:!1,font:l};d.indexOf("inside")!==-1&&(y.bgColor="black"),e(a,o,c,"linear",y),p(a,o,c,"linear",y),c("title.text",s._dfltTitle.colorbar);var v=o.tickfont,_=t.extendFlat({},v,{color:l.color,size:t.bigFont(v.size)});t.coerceFont(c,"title.font",_),c("title.side")}},{"../../lib":787,"../../plot_api/plot_template":827,"../../plots/cartesian/tick_label_defaults":860,"../../plots/cartesian/tick_mark_defaults":861,"../../plots/cartesian/tick_value_defaults":862,"./attributes":651}],654:[function(h,N,H){var t=h("@plotly/d3"),m=h("tinycolor2"),g=h("../../plots/plots"),p=h("../../registry"),e=h("../../plots/cartesian/axes"),f=h("../dragelement"),u=h("../../lib"),i=u.strTranslate,s=h("../../lib/extend").extendFlat,o=h("../../lib/setcursor"),a=h("../drawing"),c=h("../color"),r=h("../titles"),n=h("../../lib/svg_text_utils"),d=h("../colorscale/helpers").flipScale,l=h("../../plots/cartesian/axis_defaults"),y=h("../../plots/cartesian/position_defaults"),v=h("../../plots/cartesian/layout_attributes"),_=h("../../constants/alignment"),x=_.LINE_SPACING,T=_.FROM_TL,A=_.FROM_BR,S=h("./constants").cn;N.exports={draw:function(w){var L=w._fullLayout._infolayer.selectAll("g."+S.colorbar).data(function(k){var C,M,P,O,F=k._fullLayout,j=k.calcdata,W=[];function Z($){return s($,{_fillcolor:null,_line:{color:null,width:null,dash:null},_levels:{start:null,end:null,size:null},_filllevels:null,_fillgradient:null,_zrange:null})}function Q(){typeof O.calc=="function"?O.calc(k,P,C):(C._fillgradient=M.reversescale?d(M.colorscale):M.colorscale,C._zrange=[M[O.min],M[O.max]])}for(var X=0;X<j.length;X++){var G=j[X],Y=(P=G[0].trace)._module.colorbar;if(P.visible===!0&&Y)for(var K=Array.isArray(Y),D=K?Y:[Y],B=0;B<D.length;B++){var q=(O=D[B]).container;(M=q?P[q]:P)&&M.showscale&&((C=Z(M.colorbar))._id="cb"+P.uid+(K&&q?"-"+q:""),C._traceIndex=P.index,C._propPrefix=(q?q+".":"")+"colorbar.",C._meta=P._meta,Q(),W.push(C))}}for(var ee in F._colorAxes)if((M=F[ee]).showscale){var J=F._colorAxes[ee];(C=Z(M.colorbar))._id="cb"+ee,C._propPrefix=ee+".colorbar.",C._meta=F._meta,O={min:"cmin",max:"cmax"},J[0]!=="heatmap"&&(P=J[1],O.calc=P._module.colorbar.calc),Q(),W.push(C)}return W}(w),function(k){return k._id});L.enter().append("g").attr("class",function(k){return k._id}).classed(S.colorbar,!0),L.each(function(k){var C=t.select(this);u.ensureSingle(C,"rect",S.cbbg),u.ensureSingle(C,"g",S.cbfills),u.ensureSingle(C,"g",S.cblines),u.ensureSingle(C,"g",S.cbaxis,function(P){P.classed(S.crisp,!0)}),u.ensureSingle(C,"g",S.cbtitleunshift,function(P){P.append("g").classed(S.cbtitle,!0)}),u.ensureSingle(C,"rect",S.cboutline);var M=function(P,O,F){var j=F._fullLayout,W=j._size,Z=O._fillcolor,Q=O._line,X=O.title,G=X.side,Y=O._zrange||t.extent((typeof Z=="function"?Z:Q.color).domain()),K=typeof Q.color=="function"?Q.color:function(){return Q.color},D=typeof Z=="function"?Z:function(){return Z},B=O._levels,q=function(Oe,je,We){var Ge,Qe,it=je._levels,lt=[],Lt=[],wt=it.end+it.size/100,rt=it.size,$e=1.001*We[0]-.001*We[1],xt=1.001*We[1]-.001*We[0];for(Qe=0;Qe<1e5&&(Ge=it.start+Qe*rt,!(rt>0?Ge>=wt:Ge<=wt));Qe++)Ge>$e&&Ge<xt&&lt.push(Ge);if(je._fillgradient)Lt=[0];else if(typeof je._fillcolor=="function"){var Qt=je._filllevels;if(Qt)for(wt=Qt.end+Qt.size/100,rt=Qt.size,Qe=0;Qe<1e5&&(Ge=Qt.start+Qe*rt,!(rt>0?Ge>=wt:Ge<=wt));Qe++)Ge>We[0]&&Ge<We[1]&&Lt.push(Ge);else(Lt=lt.map(function($t){return $t-it.size/2})).push(Lt[Lt.length-1]+it.size)}else je._fillcolor&&typeof je._fillcolor=="string"&&(Lt=[0]);return it.size<0&&(lt.reverse(),Lt.reverse()),{line:lt,fill:Lt}}(0,O,Y),ee=q.fill,J=q.line,$=Math.round(O.thickness*(O.thicknessmode==="fraction"?W.w:1)),te=$/W.w,ie=Math.round(O.len*(O.lenmode==="fraction"?W.h:1)),ae=ie/W.h,he=O.xpad/W.w,se=(O.borderwidth+O.outlinewidth)/2,de=O.ypad/W.h,ce=Math.round(O.x*W.w+O.xpad),ve=O.x-te*({middle:.5,right:1}[O.xanchor]||0),ke=O.y+ae*(({top:-.5,bottom:.5}[O.yanchor]||0)-.5),Ee=Math.round(W.h*(1-ke)),be=Ee-ie;O._lenFrac=ae,O._thickFrac=te,O._xLeftFrac=ve,O._yBottomFrac=ke;var xe=O._axis=function(Oe,je,We){var Ge=Oe._fullLayout,Qe={type:"linear",range:We,tickmode:je.tickmode,nticks:je.nticks,tick0:je.tick0,dtick:je.dtick,tickvals:je.tickvals,ticktext:je.ticktext,ticks:je.ticks,ticklen:je.ticklen,tickwidth:je.tickwidth,tickcolor:je.tickcolor,showticklabels:je.showticklabels,ticklabelposition:je.ticklabelposition,ticklabeloverflow:je.ticklabeloverflow,tickfont:je.tickfont,tickangle:je.tickangle,tickformat:je.tickformat,exponentformat:je.exponentformat,minexponent:je.minexponent,separatethousands:je.separatethousands,showexponent:je.showexponent,showtickprefix:je.showtickprefix,tickprefix:je.tickprefix,showticksuffix:je.showticksuffix,ticksuffix:je.ticksuffix,title:je.title,showline:!0,anchor:"free",side:"right",position:1},it={type:"linear",_id:"y"+je._id},lt={letter:"y",font:Ge.font,noHover:!0,noTickson:!0,noTicklabelmode:!0,calendar:Ge.calendar};function Lt(wt,rt){return u.coerce(Qe,it,v,wt,rt)}return l(Qe,it,Lt,lt,Ge),y(Qe,it,Lt,lt),it}(F,O,Y);if(xe.position=O.x+he+te,["top","bottom"].indexOf(G)!==-1&&(xe.title.side=G,xe.titlex=O.x+he,xe.titley=ke+(X.side==="top"?ae-de:de)),Q.color&&O.tickmode==="auto"){xe.tickmode="linear",xe.tick0=B.start;var ue=B.size,me=u.constrain((Ee-be)/50,4,15)+1,we=(Y[1]-Y[0])/((O.nticks||me)*ue);if(we>1){var Me=Math.pow(10,Math.floor(Math.log(we)/Math.LN10));ue*=Me*u.roundUp(we/Me,[2,5,10]),(Math.abs(B.start)/B.size+1e-6)%1<2e-6&&(xe.tick0=0)}xe.dtick=ue}xe.domain=[ke+de,ke+ae-de],xe.setScale(),P.attr("transform",i(Math.round(W.l),Math.round(W.t)));var Se,De=P.select("."+S.cbtitleunshift).attr("transform",i(-Math.round(W.l),-Math.round(W.t))),Fe=P.select("."+S.cbaxis),Ye=0;function et(Oe,je){var We={propContainer:xe,propName:O._propPrefix+"title",traceIndex:O._traceIndex,_meta:O._meta,placeholder:j._dfltTitle.colorbar,containerGroup:P.select("."+S.cbtitle)},Ge=Oe.charAt(0)==="h"?Oe.substr(1):"h"+Oe;P.selectAll("."+Ge+",."+Ge+"-math-group").remove(),r.draw(F,Oe,s(We,je||{}))}return u.syncOrAsync([g.previousPromises,function(){if(["top","bottom"].indexOf(G)!==-1){var Oe,je=W.l+(O.x+he)*W.w,We=xe.title.font.size;Oe=G==="top"?(1-(ke+ae-de))*W.h+W.t+3+.75*We:(1-(ke+de))*W.h+W.t-3-.25*We,et(xe._id+"title",{attributes:{x:je,y:Oe,"text-anchor":"start"}})}},function(){if(["top","bottom"].indexOf(G)!==-1){var Oe=P.select("."+S.cbtitle),je=Oe.select("text"),We=[-O.outlinewidth/2,O.outlinewidth/2],Ge=Oe.select(".h"+xe._id+"title-math-group").node(),Qe=15.6;if(je.node()&&(Qe=parseInt(je.node().style.fontSize,10)*x),Ge?(Ye=a.bBox(Ge).height)>Qe&&(We[1]-=(Ye-Qe)/2):je.node()&&!je.classed(S.jsPlaceholder)&&(Ye=a.bBox(je.node()).height),Ye){if(Ye+=5,G==="top")xe.domain[1]-=Ye/W.h,We[1]*=-1;else{xe.domain[0]+=Ye/W.h;var it=n.lineCount(je);We[1]+=(1-it)*Qe}Oe.attr("transform",i(We[0],We[1])),xe.setScale()}}P.selectAll("."+S.cbfills+",."+S.cblines).attr("transform",i(0,Math.round(W.h*(1-xe.domain[1])))),Fe.attr("transform",i(0,Math.round(-W.t)));var lt=P.select("."+S.cbfills).selectAll("rect."+S.cbfill).attr("style","").data(ee);lt.enter().append("rect").classed(S.cbfill,!0).style("stroke","none"),lt.exit().remove();var Lt=Y.map(xe.c2p).map(Math.round).sort(function(Qt,$t){return Qt-$t});lt.each(function(Qt,$t){var Ue=[$t===0?Y[0]:(ee[$t]+ee[$t-1])/2,$t===ee.length-1?Y[1]:(ee[$t]+ee[$t+1])/2].map(xe.c2p).map(Math.round);Ue[1]=u.constrain(Ue[1]+(Ue[1]>Ue[0])?1:-1,Lt[0],Lt[1]);var He=t.select(this).attr({x:ce,width:Math.max($,2),y:t.min(Ue),height:Math.max(t.max(Ue)-t.min(Ue),2)});if(O._fillgradient)a.gradient(He,F,O._id,"vertical",O._fillgradient,"fill");else{var Be=D(Qt).replace("e-","");He.attr("fill",m(Be).toHexString())}});var wt=P.select("."+S.cblines).selectAll("path."+S.cbline).data(Q.color&&Q.width?J:[]);wt.enter().append("path").classed(S.cbline,!0),wt.exit().remove(),wt.each(function(Qt){t.select(this).attr("d","M"+ce+","+(Math.round(xe.c2p(Qt))+Q.width/2%1)+"h"+$).call(a.lineGroupStyle,Q.width,K(Qt),Q.dash)}),Fe.selectAll("g."+xe._id+"tick,path").remove();var rt=ce+$+(O.outlinewidth||0)/2-(O.ticks==="outside"?1:0),$e=e.calcTicks(xe),xt=e.getTickSigns(xe)[2];return e.drawTicks(F,xe,{vals:xe.ticks==="inside"?e.clipEnds(xe,$e):$e,layer:Fe,path:e.makeTickPath(xe,rt,xt),transFn:e.makeTransTickFn(xe)}),e.drawLabels(F,xe,{vals:$e,layer:Fe,transFn:e.makeTransTickLabelFn(xe),labelFns:e.makeLabelFns(xe,rt)})},function(){if(["top","bottom"].indexOf(G)===-1){var Oe=xe.title.font.size,je=xe._offset+xe._length/2,We=W.l+(xe.position||0)*W.w+(xe.side==="right"?10+Oe*(xe.showticklabels?1:.5):-10-Oe*(xe.showticklabels?.5:0));et("h"+xe._id+"title",{avoid:{selection:t.select(F).selectAll("g."+xe._id+"tick"),side:G,offsetLeft:W.l,offsetTop:0,maxShift:j.width},attributes:{x:We,y:je,"text-anchor":"middle"},transform:{rotate:"-90",offset:0}})}},g.previousPromises,function(){var Oe=$+O.outlinewidth/2;if(xe.ticklabelposition.indexOf("inside")===-1&&(Oe+=a.bBox(Fe.node()).width),(Se=De.select("text")).node()&&!Se.classed(S.jsPlaceholder)){var je,We=De.select(".h"+xe._id+"title-math-group").node();je=We&&["top","bottom"].indexOf(G)!==-1?a.bBox(We).width:a.bBox(De.node()).right-ce-W.l,Oe=Math.max(Oe,je)}var Ge=2*O.xpad+Oe+O.borderwidth+O.outlinewidth/2,Qe=Ee-be;P.select("."+S.cbbg).attr({x:ce-O.xpad-(O.borderwidth+O.outlinewidth)/2,y:be-se,width:Math.max(Ge,2),height:Math.max(Qe+2*se,2)}).call(c.fill,O.bgcolor).call(c.stroke,O.bordercolor).style("stroke-width",O.borderwidth),P.selectAll("."+S.cboutline).attr({x:ce,y:be+O.ypad+(G==="top"?Ye:0),width:Math.max($,2),height:Math.max(Qe-2*O.ypad-Ye,2)}).call(c.stroke,O.outlinecolor).style({fill:"none","stroke-width":O.outlinewidth});var it=({center:.5,right:1}[O.xanchor]||0)*Ge;P.attr("transform",i(W.l-it,W.t));var lt={},Lt=T[O.yanchor],wt=A[O.yanchor];O.lenmode==="pixels"?(lt.y=O.y,lt.t=Qe*Lt,lt.b=Qe*wt):(lt.t=lt.b=0,lt.yt=O.y+O.len*Lt,lt.yb=O.y-O.len*wt);var rt=T[O.xanchor],$e=A[O.xanchor];if(O.thicknessmode==="pixels")lt.x=O.x,lt.l=Ge*rt,lt.r=Ge*$e;else{var xt=Ge-$;lt.l=xt*rt,lt.r=xt*$e,lt.xl=O.x-O.thickness*rt,lt.xr=O.x+O.thickness*$e}g.autoMargin(F,O._id,lt)}],F)}(C,k,w);M&&M.then&&(w._promises||[]).push(M),w._context.edits.colorbarPosition&&function(P,O,F){var j,W,Z,Q=F._fullLayout._size;f.init({element:P.node(),gd:F,prepFn:function(){j=P.attr("transform"),o(P)},moveFn:function(X,G){P.attr("transform",j+i(X,G)),W=f.align(O._xLeftFrac+X/Q.w,O._thickFrac,0,1,O.xanchor),Z=f.align(O._yBottomFrac-G/Q.h,O._lenFrac,0,1,O.yanchor);var Y=f.getCursor(W,Z,O.xanchor,O.yanchor);o(P,Y)},doneFn:function(){if(o(P),W!==void 0&&Z!==void 0){var X={};X[O._propPrefix+"x"]=W,X[O._propPrefix+"y"]=Z,O._traceIndex!==void 0?p.call("_guiRestyle",F,X,O._traceIndex):p.call("_guiRelayout",F,X)}}})}(C,k,w)}),L.exit().each(function(k){g.autoMargin(w,k._id)}).remove(),L.order()}}},{"../../constants/alignment":755,"../../lib":787,"../../lib/extend":777,"../../lib/setcursor":808,"../../lib/svg_text_utils":813,"../../plots/cartesian/axes":838,"../../plots/cartesian/axis_defaults":840,"../../plots/cartesian/layout_attributes":853,"../../plots/cartesian/position_defaults":856,"../../plots/plots":901,"../../registry":915,"../color":650,"../colorscale/helpers":661,"../dragelement":669,"../drawing":672,"../titles":748,"./constants":652,"@plotly/d3":58,tinycolor2:583}],655:[function(h,N,H){var t=h("../../lib");N.exports=function(m){return t.isPlainObject(m.colorbar)}},{"../../lib":787}],656:[function(h,N,H){N.exports={moduleType:"component",name:"colorbar",attributes:h("./attributes"),supplyDefaults:h("./defaults"),draw:h("./draw").draw,hasColorbar:h("./has_colorbar")}},{"./attributes":651,"./defaults":653,"./draw":654,"./has_colorbar":655}],657:[function(h,N,H){var t=h("../colorbar/attributes"),m=h("../../lib/regex").counter,g=h("../../lib/sort_object_keys"),p=h("./scales.js").scales;g(p);function e(f){return"`"+f+"`"}N.exports=function(f,u){f=f||"";var i,s=(u=u||{}).cLetter||"c",o=("onlyIfNumerical"in u?u.onlyIfNumerical:Boolean(f),"noScale"in u?u.noScale:f==="marker.line"),a="showScaleDflt"in u?u.showScaleDflt:s==="z",c=typeof u.colorscaleDflt=="string"?p[u.colorscaleDflt]:null,r=u.editTypeOverride||"",n=f?f+".":"";"colorAttr"in u?(i=u.colorAttr,u.colorAttr):e(n+(i={z:"z",c:"color"}[s]));var d=s+"auto",l=s+"min",y=s+"max",v=s+"mid",_={};_[l]=_[y]=void 0;var x={};x[d]=!1;var T={};return i==="color"&&(T.color={valType:"color",arrayOk:!0,editType:r||"style"},u.anim&&(T.color.anim=!0)),T[d]={valType:"boolean",dflt:!0,editType:"calc",impliedEdits:_},T[l]={valType:"number",dflt:null,editType:r||"plot",impliedEdits:x},T[y]={valType:"number",dflt:null,editType:r||"plot",impliedEdits:x},T[v]={valType:"number",dflt:null,editType:"calc",impliedEdits:_},T.colorscale={valType:"colorscale",editType:"calc",dflt:c,impliedEdits:{autocolorscale:!1}},T.autocolorscale={valType:"boolean",dflt:u.autoColorDflt!==!1,editType:"calc",impliedEdits:{colorscale:void 0}},T.reversescale={valType:"boolean",dflt:!1,editType:"plot"},o||(T.showscale={valType:"boolean",dflt:a,editType:"calc"},T.colorbar=t),u.noColorAxis||(T.coloraxis={valType:"subplotid",regex:m("coloraxis"),dflt:null,editType:"calc"}),T}},{"../../lib/regex":804,"../../lib/sort_object_keys":810,"../colorbar/attributes":651,"./scales.js":665}],658:[function(h,N,H){var t=h("fast-isnumeric"),m=h("../../lib"),g=h("./helpers").extractOpts;N.exports=function(p,e,f){var u,i=p._fullLayout,s=f.vals,o=f.containerStr,a=o?m.nestedProperty(e,o).get():e,c=g(a),r=c.auto!==!1,n=c.min,d=c.max,l=c.mid,y=function(){return m.aggNums(Math.min,null,s)},v=function(){return m.aggNums(Math.max,null,s)};n===void 0?n=y():r&&(n=a._colorAx&&t(n)?Math.min(n,y()):y()),d===void 0?d=v():r&&(d=a._colorAx&&t(d)?Math.max(d,v()):v()),r&&l!==void 0&&(d-l>l-n?n=l-(d-l):d-l<l-n&&(d=l+(l-n))),n===d&&(n-=.5,d+=.5),c._sync("min",n),c._sync("max",d),c.autocolorscale&&(u=n*d<0?i.colorscale.diverging:n>=0?i.colorscale.sequential:i.colorscale.sequentialminus,c._sync("colorscale",u))}},{"../../lib":787,"./helpers":661,"fast-isnumeric":246}],659:[function(h,N,H){var t=h("../../lib"),m=h("./helpers").hasColorscale,g=h("./helpers").extractOpts;N.exports=function(p,e){function f(r,n){var d=r["_"+n];d!==void 0&&(r[n]=d)}function u(r,n){var d=n.container?t.nestedProperty(r,n.container).get():r;if(d)if(d.coloraxis)d._colorAx=e[d.coloraxis];else{var l=g(d),y=l.auto;(y||l.min===void 0)&&f(d,n.min),(y||l.max===void 0)&&f(d,n.max),l.autocolorscale&&f(d,"colorscale")}}for(var i=0;i<p.length;i++){var s=p[i],o=s._module.colorbar;if(o)if(Array.isArray(o))for(var a=0;a<o.length;a++)u(s,o[a]);else u(s,o);m(s,"marker.line")&&u(s,{container:"marker.line",min:"cmin",max:"cmax"})}for(var c in e._colorAxes)u(e[c],{min:"cmin",max:"cmax"})}},{"../../lib":787,"./helpers":661}],660:[function(h,N,H){var t=h("fast-isnumeric"),m=h("../../lib"),g=h("../colorbar/has_colorbar"),p=h("../colorbar/defaults"),e=h("./scales").isValid,f=h("../../registry").traceIs;function u(i,s){var o=s.slice(0,s.length-1);return s?m.nestedProperty(i,o).get()||{}:i}N.exports=function i(s,o,a,c,r){var n=r.prefix,d=r.cLetter,l="_module"in o,y=u(s,n),v=u(o,n),_=u(o._template||{},n)||{},x=function(){return delete s.coloraxis,delete o.coloraxis,i(s,o,a,c,r)};if(l){var T=a._colorAxes||{},A=c(n+"coloraxis");if(A){var S=f(o,"contour")&&m.nestedProperty(o,"contours.coloring").get()||"heatmap",w=T[A];return void(w?(w[2].push(x),w[0]!==S&&(w[0]=!1,m.warn(["Ignoring coloraxis:",A,"setting","as it is linked to incompatible colorscales."].join(" ")))):T[A]=[S,o,[x]])}}var L=y[d+"min"],k=y[d+"max"],C=t(L)&&t(k)&&L<k;c(n+d+"auto",!C)?c(n+d+"mid"):(c(n+d+"min"),c(n+d+"max"));var M,P,O=y.colorscale,F=_.colorscale;O!==void 0&&(M=!e(O)),F!==void 0&&(M=!e(F)),c(n+"autocolorscale",M),c(n+"colorscale"),c(n+"reversescale"),n!=="marker.line."&&(n&&l&&(P=g(y)),c(n+"showscale",P)&&(n&&_&&(v._template=_),p(y,v,a)))}},{"../../lib":787,"../../registry":915,"../colorbar/defaults":653,"../colorbar/has_colorbar":655,"./scales":665,"fast-isnumeric":246}],661:[function(h,N,H){var t=h("@plotly/d3"),m=h("tinycolor2"),g=h("fast-isnumeric"),p=h("../../lib"),e=h("../color"),f=h("./scales").isValid,u=["showscale","autocolorscale","colorscale","reversescale","colorbar"],i=["min","max","mid","auto"];function s(n){var d,l,y,v=n._colorAx,_=v||n,x={};for(l=0;l<u.length;l++)x[y=u[l]]=_[y];if(v)for(d="c",l=0;l<i.length;l++)x[y=i[l]]=_["c"+y];else{var T;for(l=0;l<i.length;l++)((T="c"+(y=i[l]))in _||(T="z"+y)in _)&&(x[y]=_[T]);d=T.charAt(0)}return x._sync=function(A,S){var w=i.indexOf(A)!==-1?d+A:A;_[w]=_["_"+w]=S},x}function o(n){for(var d=s(n),l=d.min,y=d.max,v=d.reversescale?a(d.colorscale):d.colorscale,_=v.length,x=new Array(_),T=new Array(_),A=0;A<_;A++){var S=v[A];x[A]=l+S[0]*(y-l),T[A]=S[1]}return{domain:x,range:T}}function a(n){for(var d=n.length,l=new Array(d),y=d-1,v=0;y>=0;y--,v++){var _=n[y];l[v]=[1-_[0],_[1]]}return l}function c(n,d){d=d||{};for(var l=n.domain,y=n.range,v=y.length,_=new Array(v),x=0;x<v;x++){var T=m(y[x]).toRgb();_[x]=[T.r,T.g,T.b,T.a]}var A,S=t.scale.linear().domain(l).range(_).clamp(!0),w=d.noNumericCheck,L=d.returnArray;return(A=w&&L?S:w?function(k){return r(S(k))}:L?function(k){return g(k)?S(k):m(k).isValid()?k:e.defaultLine}:function(k){return g(k)?r(S(k)):m(k).isValid()?k:e.defaultLine}).domain=S.domain,A.range=function(){return y},A}function r(n){var d={r:n[0],g:n[1],b:n[2],a:n[3]};return m(d).toRgbString()}N.exports={hasColorscale:function(n,d,l){var y=d?p.nestedProperty(n,d).get()||{}:n,v=y[l||"color"],_=!1;if(p.isArrayOrTypedArray(v)){for(var x=0;x<v.length;x++)if(g(v[x])){_=!0;break}}return p.isPlainObject(y)&&(_||y.showscale===!0||g(y.cmin)&&g(y.cmax)||f(y.colorscale)||p.isPlainObject(y.colorbar))},extractOpts:s,extractScale:o,flipScale:a,makeColorScaleFunc:c,makeColorScaleFuncFromTrace:function(n,d){return c(o(n),d)}}},{"../../lib":787,"../color":650,"./scales":665,"@plotly/d3":58,"fast-isnumeric":246,tinycolor2:583}],662:[function(h,N,H){var t=h("./scales"),m=h("./helpers");N.exports={moduleType:"component",name:"colorscale",attributes:h("./attributes"),layoutAttributes:h("./layout_attributes"),supplyLayoutDefaults:h("./layout_defaults"),handleDefaults:h("./defaults"),crossTraceDefaults:h("./cross_trace_defaults"),calc:h("./calc"),scales:t.scales,defaultScale:t.defaultScale,getScale:t.get,isValidScale:t.isValid,hasColorscale:m.hasColorscale,extractOpts:m.extractOpts,extractScale:m.extractScale,flipScale:m.flipScale,makeColorScaleFunc:m.makeColorScaleFunc,makeColorScaleFuncFromTrace:m.makeColorScaleFuncFromTrace}},{"./attributes":657,"./calc":658,"./cross_trace_defaults":659,"./defaults":660,"./helpers":661,"./layout_attributes":663,"./layout_defaults":664,"./scales":665}],663:[function(h,N,H){var t=h("../../lib/extend").extendFlat,m=h("./attributes"),g=h("./scales").scales;N.exports={editType:"calc",colorscale:{editType:"calc",sequential:{valType:"colorscale",dflt:g.Reds,editType:"calc"},sequentialminus:{valType:"colorscale",dflt:g.Blues,editType:"calc"},diverging:{valType:"colorscale",dflt:g.RdBu,editType:"calc"}},coloraxis:t({_isSubplotObj:!0,editType:"calc"},m("",{colorAttr:"corresponding trace color array(s)",noColorAxis:!0,showScaleDflt:!0}))}},{"../../lib/extend":777,"./attributes":657,"./scales":665}],664:[function(h,N,H){var t=h("../../lib"),m=h("../../plot_api/plot_template"),g=h("./layout_attributes"),p=h("./defaults");N.exports=function(e,f){function u(d,l){return t.coerce(e,f,g,d,l)}u("colorscale.sequential"),u("colorscale.sequentialminus"),u("colorscale.diverging");var i,s,o=f._colorAxes;function a(d,l){return t.coerce(i,s,g.coloraxis,d,l)}for(var c in o){var r=o[c];if(r[0])i=e[c]||{},(s=m.newContainer(f,c,"coloraxis"))._name=c,p(i,s,f,a,{prefix:"",cLetter:"c"});else{for(var n=0;n<r[2].length;n++)r[2][n]();delete f._colorAxes[c]}}}},{"../../lib":787,"../../plot_api/plot_template":827,"./defaults":660,"./layout_attributes":663}],665:[function(h,N,H){var t=h("tinycolor2"),m={Greys:[[0,"rgb(0,0,0)"],[1,"rgb(255,255,255)"]],YlGnBu:[[0,"rgb(8,29,88)"],[.125,"rgb(37,52,148)"],[.25,"rgb(34,94,168)"],[.375,"rgb(29,145,192)"],[.5,"rgb(65,182,196)"],[.625,"rgb(127,205,187)"],[.75,"rgb(199,233,180)"],[.875,"rgb(237,248,217)"],[1,"rgb(255,255,217)"]],Greens:[[0,"rgb(0,68,27)"],[.125,"rgb(0,109,44)"],[.25,"rgb(35,139,69)"],[.375,"rgb(65,171,93)"],[.5,"rgb(116,196,118)"],[.625,"rgb(161,217,155)"],[.75,"rgb(199,233,192)"],[.875,"rgb(229,245,224)"],[1,"rgb(247,252,245)"]],YlOrRd:[[0,"rgb(128,0,38)"],[.125,"rgb(189,0,38)"],[.25,"rgb(227,26,28)"],[.375,"rgb(252,78,42)"],[.5,"rgb(253,141,60)"],[.625,"rgb(254,178,76)"],[.75,"rgb(254,217,118)"],[.875,"rgb(255,237,160)"],[1,"rgb(255,255,204)"]],Bluered:[[0,"rgb(0,0,255)"],[1,"rgb(255,0,0)"]],RdBu:[[0,"rgb(5,10,172)"],[.35,"rgb(106,137,247)"],[.5,"rgb(190,190,190)"],[.6,"rgb(220,170,132)"],[.7,"rgb(230,145,90)"],[1,"rgb(178,10,28)"]],Reds:[[0,"rgb(220,220,220)"],[.2,"rgb(245,195,157)"],[.4,"rgb(245,160,105)"],[1,"rgb(178,10,28)"]],Blues:[[0,"rgb(5,10,172)"],[.35,"rgb(40,60,190)"],[.5,"rgb(70,100,245)"],[.6,"rgb(90,120,245)"],[.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],Picnic:[[0,"rgb(0,0,255)"],[.1,"rgb(51,153,255)"],[.2,"rgb(102,204,255)"],[.3,"rgb(153,204,255)"],[.4,"rgb(204,204,255)"],[.5,"rgb(255,255,255)"],[.6,"rgb(255,204,255)"],[.7,"rgb(255,153,255)"],[.8,"rgb(255,102,204)"],[.9,"rgb(255,102,102)"],[1,"rgb(255,0,0)"]],Rainbow:[[0,"rgb(150,0,90)"],[.125,"rgb(0,0,200)"],[.25,"rgb(0,25,255)"],[.375,"rgb(0,152,255)"],[.5,"rgb(44,255,150)"],[.625,"rgb(151,255,0)"],[.75,"rgb(255,234,0)"],[.875,"rgb(255,111,0)"],[1,"rgb(255,0,0)"]],Portland:[[0,"rgb(12,51,131)"],[.25,"rgb(10,136,186)"],[.5,"rgb(242,211,56)"],[.75,"rgb(242,143,56)"],[1,"rgb(217,30,30)"]],Jet:[[0,"rgb(0,0,131)"],[.125,"rgb(0,60,170)"],[.375,"rgb(5,255,255)"],[.625,"rgb(255,255,0)"],[.875,"rgb(250,0,0)"],[1,"rgb(128,0,0)"]],Hot:[[0,"rgb(0,0,0)"],[.3,"rgb(230,0,0)"],[.6,"rgb(255,210,0)"],[1,"rgb(255,255,255)"]],Blackbody:[[0,"rgb(0,0,0)"],[.2,"rgb(230,0,0)"],[.4,"rgb(230,210,0)"],[.7,"rgb(255,255,255)"],[1,"rgb(160,200,255)"]],Earth:[[0,"rgb(0,0,130)"],[.1,"rgb(0,180,180)"],[.2,"rgb(40,210,40)"],[.4,"rgb(230,230,50)"],[.6,"rgb(120,70,20)"],[1,"rgb(255,255,255)"]],Electric:[[0,"rgb(0,0,0)"],[.15,"rgb(30,0,100)"],[.4,"rgb(120,0,100)"],[.6,"rgb(160,90,0)"],[.8,"rgb(230,200,0)"],[1,"rgb(255,250,220)"]],Viridis:[[0,"#440154"],[.06274509803921569,"#48186a"],[.12549019607843137,"#472d7b"],[.18823529411764706,"#424086"],[.25098039215686274,"#3b528b"],[.3137254901960784,"#33638d"],[.3764705882352941,"#2c728e"],[.4392156862745098,"#26828e"],[.5019607843137255,"#21918c"],[.5647058823529412,"#1fa088"],[.6274509803921569,"#28ae80"],[.6901960784313725,"#3fbc73"],[.7529411764705882,"#5ec962"],[.8156862745098039,"#84d44b"],[.8784313725490196,"#addc30"],[.9411764705882353,"#d8e219"],[1,"#fde725"]],Cividis:[[0,"rgb(0,32,76)"],[.058824,"rgb(0,42,102)"],[.117647,"rgb(0,52,110)"],[.176471,"rgb(39,63,108)"],[.235294,"rgb(60,74,107)"],[.294118,"rgb(76,85,107)"],[.352941,"rgb(91,95,109)"],[.411765,"rgb(104,106,112)"],[.470588,"rgb(117,117,117)"],[.529412,"rgb(131,129,120)"],[.588235,"rgb(146,140,120)"],[.647059,"rgb(161,152,118)"],[.705882,"rgb(176,165,114)"],[.764706,"rgb(192,177,109)"],[.823529,"rgb(209,191,102)"],[.882353,"rgb(225,204,92)"],[.941176,"rgb(243,219,79)"],[1,"rgb(255,233,69)"]]},g=m.RdBu;function p(e){var f=0;if(!Array.isArray(e)||e.length<2||!e[0]||!e[e.length-1]||+e[0][0]!=0||+e[e.length-1][0]!=1)return!1;for(var u=0;u<e.length;u++){var i=e[u];if(i.length!==2||+i[0]<f||!t(i[1]).isValid())return!1;f=+i[0]}return!0}N.exports={scales:m,defaultScale:g,get:function(e,f){if(f||(f=g),!e)return f;function u(){try{e=m[e]||JSON.parse(e)}catch(i){e=f}}return typeof e=="string"&&(u(),typeof e=="string"&&u()),p(e)?e:f},isValid:function(e){return m[e]!==void 0||p(e)}}},{tinycolor2:583}],666:[function(h,N,H){N.exports=function(t,m,g,p,e){var f=(t-g)/(p-g),u=f+m/(p-g),i=(f+u)/2;return e==="left"||e==="bottom"?f:e==="center"||e==="middle"?i:e==="right"||e==="top"?u:f<2/3-i?f:u>4/3-i?u:i}},{}],667:[function(h,N,H){var t=h("../../lib"),m=[["sw-resize","s-resize","se-resize"],["w-resize","move","e-resize"],["nw-resize","n-resize","ne-resize"]];N.exports=function(g,p,e,f){return g=e==="left"?0:e==="center"?1:e==="right"?2:t.constrain(Math.floor(3*g),0,2),p=f==="bottom"?0:f==="middle"?1:f==="top"?2:t.constrain(Math.floor(3*p),0,2),m[p][g]}},{"../../lib":787}],668:[function(h,N,H){H.selectMode=function(t){return t==="lasso"||t==="select"},H.drawMode=function(t){return t==="drawclosedpath"||t==="drawopenpath"||t==="drawline"||t==="drawrect"||t==="drawcircle"},H.openMode=function(t){return t==="drawline"||t==="drawopenpath"},H.rectMode=function(t){return t==="select"||t==="drawline"||t==="drawrect"||t==="drawcircle"},H.freeMode=function(t){return t==="lasso"||t==="drawclosedpath"||t==="drawopenpath"},H.selectingOrDrawing=function(t){return H.freeMode(t)||H.rectMode(t)}},{}],669:[function(h,N,H){var t=h("mouse-event-offset"),m=h("has-hover"),g=h("has-passive-events"),p=h("../../lib").removeElement,e=h("../../plots/cartesian/constants"),f=N.exports={};f.align=h("./align"),f.getCursor=h("./cursor");var u=h("./unhover");function i(){var o=document.createElement("div");o.className="dragcover";var a=o.style;return a.position="fixed",a.left=0,a.right=0,a.top=0,a.bottom=0,a.zIndex=999999999,a.background="none",document.body.appendChild(o),o}function s(o){return t(o.changedTouches?o.changedTouches[0]:o,document.body)}f.unhover=u.wrapped,f.unhoverRaw=u.raw,f.init=function(o){var a,c,r,n,d,l,y,v,_=o.gd,x=1,T=_._context.doubleClickDelay,A=o.element;_._mouseDownTime||(_._mouseDownTime=0),A.style.pointerEvents="all",A.onmousedown=w,g?(A._ontouchstart&&A.removeEventListener("touchstart",A._ontouchstart),A._ontouchstart=w,A.addEventListener("touchstart",w,{passive:!1})):A.ontouchstart=w;var S=o.clampFn||function(C,M,P){return Math.abs(C)<P&&(C=0),Math.abs(M)<P&&(M=0),[C,M]};function w(C){_._dragged=!1,_._dragging=!0;var M=s(C);a=M[0],c=M[1],y=C.target,l=C,v=C.buttons===2||C.ctrlKey,C.clientX===void 0&&C.clientY===void 0&&(C.clientX=a,C.clientY=c),(r=new Date().getTime())-_._mouseDownTime<T?x+=1:(x=1,_._mouseDownTime=r),o.prepFn&&o.prepFn(C,a,c),m&&!v?(d=i()).style.cursor=window.getComputedStyle(A).cursor:m||(d=document,n=window.getComputedStyle(document.documentElement).cursor,document.documentElement.style.cursor=window.getComputedStyle(A).cursor),document.addEventListener("mouseup",k),document.addEventListener("touchend",k),o.dragmode!==!1&&(C.preventDefault(),document.addEventListener("mousemove",L),document.addEventListener("touchmove",L,{passive:!1}))}function L(C){C.preventDefault();var M=s(C),P=o.minDrag||e.MINDRAG,O=S(M[0]-a,M[1]-c,P),F=O[0],j=O[1];(F||j)&&(_._dragged=!0,f.unhover(_,C)),_._dragged&&o.moveFn&&!v&&(_._dragdata={element:A,dx:F,dy:j},o.moveFn(F,j))}function k(C){if(delete _._dragdata,o.dragmode!==!1&&(C.preventDefault(),document.removeEventListener("mousemove",L),document.removeEventListener("touchmove",L)),document.removeEventListener("mouseup",k),document.removeEventListener("touchend",k),m?p(d):n&&(d.documentElement.style.cursor=n,n=null),_._dragging){if(_._dragging=!1,new Date().getTime()-_._mouseDownTime>T&&(x=Math.max(x-1,1)),_._dragged)o.doneFn&&o.doneFn();else if(o.clickFn&&o.clickFn(x,l),!v){var M;try{M=new MouseEvent("click",C)}catch(O){var P=s(C);(M=document.createEvent("MouseEvents")).initMouseEvent("click",C.bubbles,C.cancelable,C.view,C.detail,C.screenX,C.screenY,P[0],P[1],C.ctrlKey,C.altKey,C.shiftKey,C.metaKey,C.button,C.relatedTarget)}y.dispatchEvent(M)}_._dragging=!1,_._dragged=!1}else _._dragged=!1}},f.coverSlip=i},{"../../lib":787,"../../plots/cartesian/constants":845,"./align":666,"./cursor":667,"./unhover":670,"has-hover":435,"has-passive-events":436,"mouse-event-offset":460}],670:[function(h,N,H){var t=h("../../lib/events"),m=h("../../lib/throttle"),g=h("../../lib/dom").getGraphDiv,p=h("../fx/constants"),e=N.exports={};e.wrapped=function(f,u,i){(f=g(f))._fullLayout&&m.clear(f._fullLayout._uid+p.HOVERID),e.raw(f,u,i)},e.raw=function(f,u){var i=f._fullLayout,s=f._hoverdata;u||(u={}),u.target&&!f._dragged&&t.triggerHandler(f,"plotly_beforehover",u)===!1||(i._hoverlayer.selectAll("g").remove(),i._hoverlayer.selectAll("line").remove(),i._hoverlayer.selectAll("circle").remove(),f._hoverdata=void 0,u.target&&s&&f.emit("plotly_unhover",{event:u,points:s}))}},{"../../lib/dom":775,"../../lib/events":776,"../../lib/throttle":814,"../fx/constants":684}],671:[function(h,N,H){H.dash={valType:"string",values:["solid","dot","dash","longdash","dashdot","longdashdot"],dflt:"solid",editType:"style"},H.pattern={shape:{valType:"enumerated",values:["","/","\\","x","-","|","+","."],dflt:"",arrayOk:!0,editType:"style"},fillmode:{valType:"enumerated",values:["replace","overlay"],dflt:"replace",editType:"style"},bgcolor:{valType:"color",arrayOk:!0,editType:"style"},fgcolor:{valType:"color",arrayOk:!0,editType:"style"},fgopacity:{valType:"number",editType:"style",min:0,max:1},size:{valType:"number",min:0,dflt:8,arrayOk:!0,editType:"style"},solidity:{valType:"number",min:0,max:1,dflt:.3,arrayOk:!0,editType:"style"},editType:"style"}},{}],672:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../lib"),g=m.numberFormat,p=h("fast-isnumeric"),e=h("tinycolor2"),f=h("../../registry"),u=h("../color"),i=h("../colorscale"),s=m.strTranslate,o=h("../../lib/svg_text_utils"),a=h("../../constants/xmlns_namespaces"),c=h("../../constants/alignment").LINE_SPACING,r=h("../../constants/interactions").DESELECTDIM,n=h("../../traces/scatter/subtypes"),d=h("../../traces/scatter/make_bubble_size_func"),l=h("../../components/fx/helpers").appendArrayPointValue,y=N.exports={};y.font=function(X,G,Y,K){m.isPlainObject(G)&&(K=G.color,Y=G.size,G=G.family),G&&X.style("font-family",G),Y+1&&X.style("font-size",Y+"px"),K&&X.call(u.fill,K)},y.setPosition=function(X,G,Y){X.attr("x",G).attr("y",Y)},y.setSize=function(X,G,Y){X.attr("width",G).attr("height",Y)},y.setRect=function(X,G,Y,K,D){X.call(y.setPosition,G,Y).call(y.setSize,K,D)},y.translatePoint=function(X,G,Y,K){var D=Y.c2p(X.x),B=K.c2p(X.y);return!!(p(D)&&p(B)&&G.node())&&(G.node().nodeName==="text"?G.attr("x",D).attr("y",B):G.attr("transform",s(D,B)),!0)},y.translatePoints=function(X,G,Y){X.each(function(K){var D=t.select(this);y.translatePoint(K,D,G,Y)})},y.hideOutsideRangePoint=function(X,G,Y,K,D,B){G.attr("display",Y.isPtWithinRange(X,D)&&K.isPtWithinRange(X,B)?null:"none")},y.hideOutsideRangePoints=function(X,G){if(G._hasClipOnAxisFalse){var Y=G.xaxis,K=G.yaxis;X.each(function(D){var B=D[0].trace,q=B.xcalendar,ee=B.ycalendar,J=f.traceIs(B,"bar-like")?".bartext":".point,.textpoint";X.selectAll(J).each(function($){y.hideOutsideRangePoint($,t.select(this),Y,K,q,ee)})})}},y.crispRound=function(X,G,Y){return G&&p(G)?X._context.staticPlot?G:G<1?1:Math.round(G):Y||0},y.singleLineStyle=function(X,G,Y,K,D){G.style("fill","none");var B=(((X||[])[0]||{}).trace||{}).line||{},q=Y||B.width||0,ee=D||B.dash||"";u.stroke(G,K||B.color),y.dashLine(G,ee,q)},y.lineGroupStyle=function(X,G,Y,K){X.style("fill","none").each(function(D){var B=(((D||[])[0]||{}).trace||{}).line||{},q=G||B.width||0,ee=K||B.dash||"";t.select(this).call(u.stroke,Y||B.color).call(y.dashLine,ee,q)})},y.dashLine=function(X,G,Y){Y=+Y||0,G=y.dashStyle(G,Y),X.style({"stroke-dasharray":G,"stroke-width":Y+"px"})},y.dashStyle=function(X,G){G=+G||1;var Y=Math.max(G,3);return X==="solid"?X="":X==="dot"?X=Y+"px,"+Y+"px":X==="dash"?X=3*Y+"px,"+3*Y+"px":X==="longdash"?X=5*Y+"px,"+5*Y+"px":X==="dashdot"?X=3*Y+"px,"+Y+"px,"+Y+"px,"+Y+"px":X==="longdashdot"&&(X=5*Y+"px,"+2*Y+"px,"+Y+"px,"+2*Y+"px"),X},y.singleFillStyle=function(X){var G=(((t.select(X.node()).data()[0]||[])[0]||{}).trace||{}).fillcolor;G&&X.call(u.fill,G)},y.fillGroupStyle=function(X){X.style("stroke-width",0).each(function(G){var Y=t.select(this);G[0].trace&&Y.call(u.fill,G[0].trace.fillcolor)})};var v=h("./symbol_defs");y.symbolNames=[],y.symbolFuncs=[],y.symbolNeedLines={},y.symbolNoDot={},y.symbolNoFill={},y.symbolList=[],Object.keys(v).forEach(function(X){var G=v[X],Y=G.n;y.symbolList.push(Y,String(Y),X,Y+100,String(Y+100),X+"-open"),y.symbolNames[Y]=X,y.symbolFuncs[Y]=G.f,G.needLine&&(y.symbolNeedLines[Y]=!0),G.noDot?y.symbolNoDot[Y]=!0:y.symbolList.push(Y+200,String(Y+200),X+"-dot",Y+300,String(Y+300),X+"-open-dot"),G.noFill&&(y.symbolNoFill[Y]=!0)});var _=y.symbolNames.length;function x(X,G){var Y=X%100;return y.symbolFuncs[Y](G)+(X>=200?"M0,0.5L0.5,0L0,-0.5L-0.5,0Z":"")}y.symbolNumber=function(X){if(p(X))X=+X;else if(typeof X=="string"){var G=0;X.indexOf("-open")>0&&(G=100,X=X.replace("-open","")),X.indexOf("-dot")>0&&(G+=200,X=X.replace("-dot","")),(X=y.symbolNames.indexOf(X))>=0&&(X+=G)}return X%100>=_||X>=400?0:Math.floor(Math.max(X,0))};var T={x1:1,x2:0,y1:0,y2:0},A={x1:0,x2:0,y1:1,y2:0},S=g("~f"),w={radial:{node:"radialGradient"},radialreversed:{node:"radialGradient",reversed:!0},horizontal:{node:"linearGradient",attrs:T},horizontalreversed:{node:"linearGradient",attrs:T,reversed:!0},vertical:{node:"linearGradient",attrs:A},verticalreversed:{node:"linearGradient",attrs:A,reversed:!0}};y.gradient=function(X,G,Y,K,D,B){for(var q=D.length,ee=w[K],J=new Array(q),$=0;$<q;$++)ee.reversed?J[q-1-$]=[S(100*(1-D[$][0])),D[$][1]]:J[$]=[S(100*D[$][0]),D[$][1]];var te=G._fullLayout,ie="g"+te._uid+"-"+Y,ae=te._defs.select(".gradients").selectAll("#"+ie).data([K+J.join(";")],m.identity);ae.exit().remove(),ae.enter().append(ee.node).each(function(){var de=t.select(this);ee.attrs&&de.attr(ee.attrs),de.attr("id",ie);var ce=de.selectAll("stop").data(J);ce.exit().remove(),ce.enter().append("stop"),ce.each(function(ve){var ke=e(ve[1]);t.select(this).attr({offset:ve[0]+"%","stop-color":u.tinyRGB(ke),"stop-opacity":ke.getAlpha()})})}),X.style(B,W(ie,G)).style(B+"-opacity",null);var he=function(de){return"."+de.attr("class").replace(/\s/g,".")},se=he(t.select(X.node().parentNode))+">"+he(X);te._gradientUrlQueryParts[se]=1},y.pattern=function(X,G,Y,K,D,B,q,ee,J,$,te,ie){var ae=G==="legend";ee&&(J==="overlay"?($=ee,te=u.contrast($)):($=void 0,te=ee));var he,se,de,ce,ve,ke,Ee,be,xe,ue,me,we=Y._fullLayout,Me="p"+we._uid+"-"+K,Se={};switch(D){case"/":he=B*Math.sqrt(2),se=B*Math.sqrt(2),ke="path",Se={d:de="M-"+he/4+","+se/4+"l"+he/2+",-"+se/2+"M0,"+se+"L"+he+",0M"+he/4*3+","+se/4*5+"l"+he/2+",-"+se/2,opacity:ie,stroke:te,"stroke-width":(ce=q*B)+"px"};break;case"\\":he=B*Math.sqrt(2),se=B*Math.sqrt(2),ke="path",Se={d:de="M"+he/4*3+",-"+se/4+"l"+he/2+","+se/2+"M0,0L"+he+","+se+"M-"+he/4+","+se/4*3+"l"+he/2+","+se/2,opacity:ie,stroke:te,"stroke-width":(ce=q*B)+"px"};break;case"x":he=B*Math.sqrt(2),se=B*Math.sqrt(2),de="M-"+he/4+","+se/4+"l"+he/2+",-"+se/2+"M0,"+se+"L"+he+",0M"+he/4*3+","+se/4*5+"l"+he/2+",-"+se/2+"M"+he/4*3+",-"+se/4+"l"+he/2+","+se/2+"M0,0L"+he+","+se+"M-"+he/4+","+se/4*3+"l"+he/2+","+se/2,ce=B-B*Math.sqrt(1-q),ke="path",Se={d:de,opacity:ie,stroke:te,"stroke-width":ce+"px"};break;case"|":ke="path",ke="path",Se={d:de="M"+(he=B)/2+",0L"+he/2+","+(se=B),opacity:ie,stroke:te,"stroke-width":(ce=q*B)+"px"};break;case"-":ke="path",ke="path",Se={d:de="M0,"+(se=B)/2+"L"+(he=B)+","+se/2,opacity:ie,stroke:te,"stroke-width":(ce=q*B)+"px"};break;case"+":ke="path",de="M"+(he=B)/2+",0L"+he/2+","+(se=B)+"M0,"+se/2+"L"+he+","+se/2,ce=B-B*Math.sqrt(1-q),ke="path",Se={d:de,opacity:ie,stroke:te,"stroke-width":ce+"px"};break;case".":he=B,se=B,q<Math.PI/4?ve=Math.sqrt(q*B*B/Math.PI):(Ee=q,be=Math.PI/4,xe=1,ue=B/2,me=B/Math.sqrt(2),ve=ue+(me-ue)*(Ee-be)/(xe-be)),ke="circle",Se={cx:he/2,cy:se/2,r:ve,opacity:ie,fill:te}}var De=[D||"noSh",$||"noBg",te||"noFg",B,q].join(";"),Fe=we._defs.select(".patterns").selectAll("#"+Me).data([De],m.identity);Fe.exit().remove(),Fe.enter().append("pattern").each(function(){var et=t.select(this);if(et.attr({id:Me,width:he+"px",height:se+"px",patternUnits:"userSpaceOnUse",patternTransform:ae?"scale(0.8)":""}),$){var Oe=et.selectAll("rect").data([0]);Oe.exit().remove(),Oe.enter().append("rect").attr({width:he+"px",height:se+"px",fill:$})}var je=et.selectAll(ke).data([0]);je.exit().remove(),je.enter().append(ke).attr(Se)}),X.style("fill",W(Me,Y)).style("fill-opacity",null),X.classed("pattern_filled",!0);var Ye="."+t.select(X.node().parentNode).attr("class").replace(/\s/g,".")+">.pattern_filled";we._patternUrlQueryParts[Ye]=1},y.initGradients=function(X){var G=X._fullLayout;m.ensureSingle(G._defs,"g","gradients").selectAll("linearGradient,radialGradient").remove(),G._gradientUrlQueryParts={}},y.initPatterns=function(X){var G=X._fullLayout;m.ensureSingle(G._defs,"g","patterns").selectAll("pattern").remove(),G._patternUrlQueryParts={}},y.getPatternAttr=function(X,G,Y){return X&&m.isArrayOrTypedArray(X)?G<X.length?X[G]:Y:X},y.pointStyle=function(X,G,Y){if(X.size()){var K=y.makePointStyleFns(G);X.each(function(D){y.singlePointStyle(D,t.select(this),G,K,Y)})}},y.singlePointStyle=function(X,G,Y,K,D){var B=Y.marker,q=B.line;if(G.style("opacity",K.selectedOpacityFn?K.selectedOpacityFn(X):X.mo===void 0?B.opacity:X.mo),K.ms2mrc){var ee;ee=X.ms==="various"||B.size==="various"?3:K.ms2mrc(X.ms),X.mrc=ee,K.selectedSizeFn&&(ee=X.mrc=K.selectedSizeFn(X));var J=y.symbolNumber(X.mx||B.symbol)||0;X.om=J%200>=100,G.attr("d",x(J,ee))}var $,te,ie,ae=!1;if(X.so)ie=q.outlierwidth,te=q.outliercolor,$=B.outliercolor;else{var he=(q||{}).width;ie=(X.mlw+1||he+1||(X.trace?(X.trace.marker.line||{}).width:0)+1)-1||0,te="mlc"in X?X.mlcc=K.lineScale(X.mlc):m.isArrayOrTypedArray(q.color)?u.defaultLine:q.color,m.isArrayOrTypedArray(B.color)&&($=u.defaultLine,ae=!0),$="mc"in X?X.mcc=K.markerScale(X.mc):B.color||"rgba(0,0,0,0)",K.selectedColorFn&&($=K.selectedColorFn(X))}if(X.om)G.call(u.stroke,$).style({"stroke-width":(ie||1)+"px",fill:"none"});else{G.style("stroke-width",(X.isBlank?0:ie)+"px");var se=B.gradient,de=X.mgt;de?ae=!0:de=se&&se.type,m.isArrayOrTypedArray(de)&&(de=de[0],w[de]||(de=0));var ce=B.pattern,ve=ce&&y.getPatternAttr(ce.shape,X.i,"");if(de&&de!=="none"){var ke=X.mgc;ke?ae=!0:ke=se.color;var Ee=Y.uid;ae&&(Ee+="-"+X.i),y.gradient(G,D,Ee,de,[[0,ke],[1,$]],"fill")}else if(ve){var be=y.getPatternAttr(ce.bgcolor,X.i,null),xe=y.getPatternAttr(ce.fgcolor,X.i,null),ue=ce.fgopacity,me=y.getPatternAttr(ce.size,X.i,8),we=y.getPatternAttr(ce.solidity,X.i,.3),Me=X.mcc||m.isArrayOrTypedArray(ce.shape)||m.isArrayOrTypedArray(ce.bgcolor)||m.isArrayOrTypedArray(ce.size)||m.isArrayOrTypedArray(ce.solidity),Se=Y.uid;Me&&(Se+="-"+X.i),y.pattern(G,"point",D,Se,ve,me,we,X.mcc,ce.fillmode,be,xe,ue)}else u.fill(G,$);ie&&u.stroke(G,te)}},y.makePointStyleFns=function(X){var G={},Y=X.marker;return G.markerScale=y.tryColorscale(Y,""),G.lineScale=y.tryColorscale(Y,"line"),f.traceIs(X,"symbols")&&(G.ms2mrc=n.isBubble(X)?d(X):function(){return(Y.size||6)/2}),X.selectedpoints&&m.extendFlat(G,y.makeSelectedPointStyleFns(X)),G},y.makeSelectedPointStyleFns=function(X){var G={},Y=X.selected||{},K=X.unselected||{},D=X.marker||{},B=Y.marker||{},q=K.marker||{},ee=D.opacity,J=B.opacity,$=q.opacity,te=J!==void 0,ie=$!==void 0;(m.isArrayOrTypedArray(ee)||te||ie)&&(G.selectedOpacityFn=function(be){var xe=be.mo===void 0?D.opacity:be.mo;return be.selected?te?J:xe:ie?$:r*xe});var ae=D.color,he=B.color,se=q.color;(he||se)&&(G.selectedColorFn=function(be){var xe=be.mcc||ae;return be.selected?he||xe:se||xe});var de=D.size,ce=B.size,ve=q.size,ke=ce!==void 0,Ee=ve!==void 0;return f.traceIs(X,"symbols")&&(ke||Ee)&&(G.selectedSizeFn=function(be){var xe=be.mrc||de/2;return be.selected?ke?ce/2:xe:Ee?ve/2:xe}),G},y.makeSelectedTextStyleFns=function(X){var G={},Y=X.selected||{},K=X.unselected||{},D=X.textfont||{},B=Y.textfont||{},q=K.textfont||{},ee=D.color,J=B.color,$=q.color;return G.selectedTextColorFn=function(te){var ie=te.tc||ee;return te.selected?J||ie:$||(J?ie:u.addOpacity(ie,r))},G},y.selectedPointStyle=function(X,G){if(X.size()&&G.selectedpoints){var Y=y.makeSelectedPointStyleFns(G),K=G.marker||{},D=[];Y.selectedOpacityFn&&D.push(function(B,q){B.style("opacity",Y.selectedOpacityFn(q))}),Y.selectedColorFn&&D.push(function(B,q){u.fill(B,Y.selectedColorFn(q))}),Y.selectedSizeFn&&D.push(function(B,q){var ee=q.mx||K.symbol||0,J=Y.selectedSizeFn(q);B.attr("d",x(y.symbolNumber(ee),J)),q.mrc2=J}),D.length&&X.each(function(B){for(var q=t.select(this),ee=0;ee<D.length;ee++)D[ee](q,B)})}},y.tryColorscale=function(X,G){var Y=G?m.nestedProperty(X,G).get():X;if(Y){var K=Y.color;if((Y.colorscale||Y._colorAx)&&m.isArrayOrTypedArray(K))return i.makeColorScaleFuncFromTrace(Y)}return m.identity};var L={start:1,end:-1,middle:0,bottom:1,top:-1};function k(X,G,Y,K){var D=t.select(X.node().parentNode),B=G.indexOf("top")!==-1?"top":G.indexOf("bottom")!==-1?"bottom":"middle",q=G.indexOf("left")!==-1?"end":G.indexOf("right")!==-1?"start":"middle",ee=K?K/.8+1:0,J=(o.lineCount(X)-1)*c+1,$=L[q]*ee,te=.75*Y+L[B]*ee+(L[B]-1)*J*Y/2;X.attr("text-anchor",q),D.attr("transform",s($,te))}function C(X,G){var Y=X.ts||G.textfont.size;return p(Y)&&Y>0?Y:0}y.textPointStyle=function(X,G,Y){if(X.size()){var K;if(G.selectedpoints){var D=y.makeSelectedTextStyleFns(G);K=D.selectedTextColorFn}var B=G.texttemplate,q=Y._fullLayout;X.each(function(ee){var J=t.select(this),$=B?m.extractOption(ee,G,"txt","texttemplate"):m.extractOption(ee,G,"tx","text");if($||$===0){if(B){var te=G._module.formatLabels,ie=te?te(ee,G,q):{},ae={};l(ae,G,ee.i);var he=G._meta||{};$=m.texttemplateString($,ie,q._d3locale,ae,ee,he)}var se=ee.tp||G.textposition,de=C(ee,G),ce=K?K(ee):ee.tc||G.textfont.color;J.call(y.font,ee.tf||G.textfont.family,de,ce).text($).call(o.convertToTspans,Y).call(k,se,de,ee.mrc)}else J.remove()})}},y.selectedTextStyle=function(X,G){if(X.size()&&G.selectedpoints){var Y=y.makeSelectedTextStyleFns(G);X.each(function(K){var D=t.select(this),B=Y.selectedTextColorFn(K),q=K.tp||G.textposition,ee=C(K,G);u.fill(D,B),k(D,q,ee,K.mrc2||K.mrc)})}};function M(X,G,Y,K){var D=X[0]-G[0],B=X[1]-G[1],q=Y[0]-G[0],ee=Y[1]-G[1],J=Math.pow(D*D+B*B,.25),$=Math.pow(q*q+ee*ee,.25),te=($*$*D-J*J*q)*K,ie=($*$*B-J*J*ee)*K,ae=3*$*(J+$),he=3*J*(J+$);return[[t.round(G[0]+(ae&&te/ae),2),t.round(G[1]+(ae&&ie/ae),2)],[t.round(G[0]-(he&&te/he),2),t.round(G[1]-(he&&ie/he),2)]]}y.smoothopen=function(X,G){if(X.length<3)return"M"+X.join("L");var Y,K="M"+X[0],D=[];for(Y=1;Y<X.length-1;Y++)D.push(M(X[Y-1],X[Y],X[Y+1],G));for(K+="Q"+D[0][0]+" "+X[1],Y=2;Y<X.length-1;Y++)K+="C"+D[Y-2][1]+" "+D[Y-1][0]+" "+X[Y];return K+="Q"+D[X.length-3][1]+" "+X[X.length-1]},y.smoothclosed=function(X,G){if(X.length<3)return"M"+X.join("L")+"Z";var Y,K="M"+X[0],D=X.length-1,B=[M(X[D],X[0],X[1],G)];for(Y=1;Y<D;Y++)B.push(M(X[Y-1],X[Y],X[Y+1],G));for(B.push(M(X[D-1],X[D],X[0],G)),Y=1;Y<=D;Y++)K+="C"+B[Y-1][1]+" "+B[Y][0]+" "+X[Y];return K+="C"+B[D][1]+" "+B[0][0]+" "+X[0]+"Z"};var P={hv:function(X,G){return"H"+t.round(G[0],2)+"V"+t.round(G[1],2)},vh:function(X,G){return"V"+t.round(G[1],2)+"H"+t.round(G[0],2)},hvh:function(X,G){return"H"+t.round((X[0]+G[0])/2,2)+"V"+t.round(G[1],2)+"H"+t.round(G[0],2)},vhv:function(X,G){return"V"+t.round((X[1]+G[1])/2,2)+"H"+t.round(G[0],2)+"V"+t.round(G[1],2)}},O=function(X,G){return"L"+t.round(G[0],2)+","+t.round(G[1],2)};y.steps=function(X){var G=P[X]||O;return function(Y){for(var K="M"+t.round(Y[0][0],2)+","+t.round(Y[0][1],2),D=1;D<Y.length;D++)K+=G(Y[D-1],Y[D]);return K}},y.makeTester=function(){var X=m.ensureSingleById(t.select("body"),"svg","js-plotly-tester",function(Y){Y.attr(a.svgAttrs).style({position:"absolute",left:"-10000px",top:"-10000px",width:"9000px",height:"9000px","z-index":"1"})}),G=m.ensureSingle(X,"path","js-reference-point",function(Y){Y.attr("d","M0,0H1V1H0Z").style({"stroke-width":0,fill:"black"})});y.tester=X,y.testref=G},y.savedBBoxes={};var F=0;function j(X){var G=X.getAttribute("data-unformatted");if(G!==null)return G+X.getAttribute("data-math")+X.getAttribute("text-anchor")+X.getAttribute("style")}function W(X,G){if(!X)return null;var Y=G._context,K=Y._exportedPlot?"":Y._baseUrl||"";return K?"url('"+K+"#"+X+"')":"url(#"+X+")"}y.bBox=function(X,G,Y){var K,D,B;if(Y||(Y=j(X)),Y){if(K=y.savedBBoxes[Y])return m.extendFlat({},K)}else if(X.childNodes.length===1){var q=X.childNodes[0];if(Y=j(q)){var ee=+q.getAttribute("x")||0,J=+q.getAttribute("y")||0,$=q.getAttribute("transform");if(!$){var te=y.bBox(q,!1,Y);return ee&&(te.left+=ee,te.right+=ee),J&&(te.top+=J,te.bottom+=J),te}if(Y+="~"+ee+"~"+J+"~"+$,K=y.savedBBoxes[Y])return m.extendFlat({},K)}}G?D=X:(B=y.tester.node(),D=X.cloneNode(!0),B.appendChild(D)),t.select(D).attr("transform",null).call(o.positionText,0,0);var ie=D.getBoundingClientRect(),ae=y.testref.node().getBoundingClientRect();G||B.removeChild(D);var he={height:ie.height,width:ie.width,left:ie.left-ae.left,top:ie.top-ae.top,right:ie.right-ae.left,bottom:ie.bottom-ae.top};return F>=1e4&&(y.savedBBoxes={},F=0),Y&&(y.savedBBoxes[Y]=he),F++,m.extendFlat({},he)},y.setClipUrl=function(X,G,Y){X.attr("clip-path",W(G,Y))},y.getTranslate=function(X){var G=(X[X.attr?"attr":"getAttribute"]("transform")||"").replace(/.*\btranslate\((-?\d*\.?\d*)[^-\d]*(-?\d*\.?\d*)[^\d].*/,function(Y,K,D){return[K,D].join(" ")}).split(" ");return{x:+G[0]||0,y:+G[1]||0}},y.setTranslate=function(X,G,Y){var K=X.attr?"attr":"getAttribute",D=X.attr?"attr":"setAttribute",B=X[K]("transform")||"";return G=G||0,Y=Y||0,B=B.replace(/(\btranslate\(.*?\);?)/,"").trim(),B=(B+=s(G,Y)).trim(),X[D]("transform",B),B},y.getScale=function(X){var G=(X[X.attr?"attr":"getAttribute"]("transform")||"").replace(/.*\bscale\((\d*\.?\d*)[^\d]*(\d*\.?\d*)[^\d].*/,function(Y,K,D){return[K,D].join(" ")}).split(" ");return{x:+G[0]||1,y:+G[1]||1}},y.setScale=function(X,G,Y){var K=X.attr?"attr":"getAttribute",D=X.attr?"attr":"setAttribute",B=X[K]("transform")||"";return G=G||1,Y=Y||1,B=B.replace(/(\bscale\(.*?\);?)/,"").trim(),B=(B+="scale("+G+","+Y+")").trim(),X[D]("transform",B),B};var Z=/\s*sc.*/;y.setPointGroupScale=function(X,G,Y){if(G=G||1,Y=Y||1,X){var K=G===1&&Y===1?"":"scale("+G+","+Y+")";X.each(function(){var D=(this.getAttribute("transform")||"").replace(Z,"");D=(D+=K).trim(),this.setAttribute("transform",D)})}};var Q=/translate\([^)]*\)\s*$/;y.setTextPointsScale=function(X,G,Y){X&&X.each(function(){var K,D=t.select(this),B=D.select("text");if(B.node()){var q=parseFloat(B.attr("x")||0),ee=parseFloat(B.attr("y")||0),J=(D.attr("transform")||"").match(Q);K=G===1&&Y===1?[]:[s(q,ee),"scale("+G+","+Y+")",s(-q,-ee)],J&&K.push(J),D.attr("transform",K.join(""))}})}},{"../../components/fx/helpers":686,"../../constants/alignment":755,"../../constants/interactions":762,"../../constants/xmlns_namespaces":764,"../../lib":787,"../../lib/svg_text_utils":813,"../../registry":915,"../../traces/scatter/make_bubble_size_func":1219,"../../traces/scatter/subtypes":1227,"../color":650,"../colorscale":662,"./symbol_defs":673,"@plotly/d3":58,"fast-isnumeric":246,tinycolor2:583}],673:[function(h,N,H){var t=h("@plotly/d3");N.exports={circle:{n:0,f:function(m){var g=t.round(m,2);return"M"+g+",0A"+g+","+g+" 0 1,1 0,-"+g+"A"+g+","+g+" 0 0,1 "+g+",0Z"}},square:{n:1,f:function(m){var g=t.round(m,2);return"M"+g+","+g+"H-"+g+"V-"+g+"H"+g+"Z"}},diamond:{n:2,f:function(m){var g=t.round(1.3*m,2);return"M"+g+",0L0,"+g+"L-"+g+",0L0,-"+g+"Z"}},cross:{n:3,f:function(m){var g=t.round(.4*m,2),p=t.round(1.2*m,2);return"M"+p+","+g+"H"+g+"V"+p+"H-"+g+"V"+g+"H-"+p+"V-"+g+"H-"+g+"V-"+p+"H"+g+"V-"+g+"H"+p+"Z"}},x:{n:4,f:function(m){var g=t.round(.8*m/Math.sqrt(2),2),p="l"+g+","+g,e="l"+g+",-"+g,f="l-"+g+",-"+g,u="l-"+g+","+g;return"M0,"+g+p+e+f+e+f+u+f+u+p+u+p+"Z"}},"triangle-up":{n:5,f:function(m){var g=t.round(2*m/Math.sqrt(3),2);return"M-"+g+","+t.round(m/2,2)+"H"+g+"L0,-"+t.round(m,2)+"Z"}},"triangle-down":{n:6,f:function(m){var g=t.round(2*m/Math.sqrt(3),2);return"M-"+g+",-"+t.round(m/2,2)+"H"+g+"L0,"+t.round(m,2)+"Z"}},"triangle-left":{n:7,f:function(m){var g=t.round(2*m/Math.sqrt(3),2);return"M"+t.round(m/2,2)+",-"+g+"V"+g+"L-"+t.round(m,2)+",0Z"}},"triangle-right":{n:8,f:function(m){var g=t.round(2*m/Math.sqrt(3),2);return"M-"+t.round(m/2,2)+",-"+g+"V"+g+"L"+t.round(m,2)+",0Z"}},"triangle-ne":{n:9,f:function(m){var g=t.round(.6*m,2),p=t.round(1.2*m,2);return"M-"+p+",-"+g+"H"+g+"V"+p+"Z"}},"triangle-se":{n:10,f:function(m){var g=t.round(.6*m,2),p=t.round(1.2*m,2);return"M"+g+",-"+p+"V"+g+"H-"+p+"Z"}},"triangle-sw":{n:11,f:function(m){var g=t.round(.6*m,2),p=t.round(1.2*m,2);return"M"+p+","+g+"H-"+g+"V-"+p+"Z"}},"triangle-nw":{n:12,f:function(m){var g=t.round(.6*m,2),p=t.round(1.2*m,2);return"M-"+g+","+p+"V-"+g+"H"+p+"Z"}},pentagon:{n:13,f:function(m){var g=t.round(.951*m,2),p=t.round(.588*m,2),e=t.round(-m,2),f=t.round(-.309*m,2);return"M"+g+","+f+"L"+p+","+t.round(.809*m,2)+"H-"+p+"L-"+g+","+f+"L0,"+e+"Z"}},hexagon:{n:14,f:function(m){var g=t.round(m,2),p=t.round(m/2,2),e=t.round(m*Math.sqrt(3)/2,2);return"M"+e+",-"+p+"V"+p+"L0,"+g+"L-"+e+","+p+"V-"+p+"L0,-"+g+"Z"}},hexagon2:{n:15,f:function(m){var g=t.round(m,2),p=t.round(m/2,2),e=t.round(m*Math.sqrt(3)/2,2);return"M-"+p+","+e+"H"+p+"L"+g+",0L"+p+",-"+e+"H-"+p+"L-"+g+",0Z"}},octagon:{n:16,f:function(m){var g=t.round(.924*m,2),p=t.round(.383*m,2);return"M-"+p+",-"+g+"H"+p+"L"+g+",-"+p+"V"+p+"L"+p+","+g+"H-"+p+"L-"+g+","+p+"V-"+p+"Z"}},star:{n:17,f:function(m){var g=1.4*m,p=t.round(.225*g,2),e=t.round(.951*g,2),f=t.round(.363*g,2),u=t.round(.588*g,2),i=t.round(-g,2),s=t.round(-.309*g,2),o=t.round(.118*g,2),a=t.round(.809*g,2);return"M"+p+","+s+"H"+e+"L"+f+","+o+"L"+u+","+a+"L0,"+t.round(.382*g,2)+"L-"+u+","+a+"L-"+f+","+o+"L-"+e+","+s+"H-"+p+"L0,"+i+"Z"}},hexagram:{n:18,f:function(m){var g=t.round(.66*m,2),p=t.round(.38*m,2),e=t.round(.76*m,2);return"M-"+e+",0l-"+p+",-"+g+"h"+e+"l"+p+",-"+g+"l"+p+","+g+"h"+e+"l-"+p+","+g+"l"+p+","+g+"h-"+e+"l-"+p+","+g+"l-"+p+",-"+g+"h-"+e+"Z"}},"star-triangle-up":{n:19,f:function(m){var g=t.round(m*Math.sqrt(3)*.8,2),p=t.round(.8*m,2),e=t.round(1.6*m,2),f=t.round(4*m,2),u="A "+f+","+f+" 0 0 1 ";return"M-"+g+","+p+u+g+","+p+u+"0,-"+e+u+"-"+g+","+p+"Z"}},"star-triangle-down":{n:20,f:function(m){var g=t.round(m*Math.sqrt(3)*.8,2),p=t.round(.8*m,2),e=t.round(1.6*m,2),f=t.round(4*m,2),u="A "+f+","+f+" 0 0 1 ";return"M"+g+",-"+p+u+"-"+g+",-"+p+u+"0,"+e+u+g+",-"+p+"Z"}},"star-square":{n:21,f:function(m){var g=t.round(1.1*m,2),p=t.round(2*m,2),e="A "+p+","+p+" 0 0 1 ";return"M-"+g+",-"+g+e+"-"+g+","+g+e+g+","+g+e+g+",-"+g+e+"-"+g+",-"+g+"Z"}},"star-diamond":{n:22,f:function(m){var g=t.round(1.4*m,2),p=t.round(1.9*m,2),e="A "+p+","+p+" 0 0 1 ";return"M-"+g+",0"+e+"0,"+g+e+g+",0"+e+"0,-"+g+e+"-"+g+",0Z"}},"diamond-tall":{n:23,f:function(m){var g=t.round(.7*m,2),p=t.round(1.4*m,2);return"M0,"+p+"L"+g+",0L0,-"+p+"L-"+g+",0Z"}},"diamond-wide":{n:24,f:function(m){var g=t.round(1.4*m,2),p=t.round(.7*m,2);return"M0,"+p+"L"+g+",0L0,-"+p+"L-"+g+",0Z"}},hourglass:{n:25,f:function(m){var g=t.round(m,2);return"M"+g+","+g+"H-"+g+"L"+g+",-"+g+"H-"+g+"Z"},noDot:!0},bowtie:{n:26,f:function(m){var g=t.round(m,2);return"M"+g+","+g+"V-"+g+"L-"+g+","+g+"V-"+g+"Z"},noDot:!0},"circle-cross":{n:27,f:function(m){var g=t.round(m,2);return"M0,"+g+"V-"+g+"M"+g+",0H-"+g+"M"+g+",0A"+g+","+g+" 0 1,1 0,-"+g+"A"+g+","+g+" 0 0,1 "+g+",0Z"},needLine:!0,noDot:!0},"circle-x":{n:28,f:function(m){var g=t.round(m,2),p=t.round(m/Math.sqrt(2),2);return"M"+p+","+p+"L-"+p+",-"+p+"M"+p+",-"+p+"L-"+p+","+p+"M"+g+",0A"+g+","+g+" 0 1,1 0,-"+g+"A"+g+","+g+" 0 0,1 "+g+",0Z"},needLine:!0,noDot:!0},"square-cross":{n:29,f:function(m){var g=t.round(m,2);return"M0,"+g+"V-"+g+"M"+g+",0H-"+g+"M"+g+","+g+"H-"+g+"V-"+g+"H"+g+"Z"},needLine:!0,noDot:!0},"square-x":{n:30,f:function(m){var g=t.round(m,2);return"M"+g+","+g+"L-"+g+",-"+g+"M"+g+",-"+g+"L-"+g+","+g+"M"+g+","+g+"H-"+g+"V-"+g+"H"+g+"Z"},needLine:!0,noDot:!0},"diamond-cross":{n:31,f:function(m){var g=t.round(1.3*m,2);return"M"+g+",0L0,"+g+"L-"+g+",0L0,-"+g+"ZM0,-"+g+"V"+g+"M-"+g+",0H"+g},needLine:!0,noDot:!0},"diamond-x":{n:32,f:function(m){var g=t.round(1.3*m,2),p=t.round(.65*m,2);return"M"+g+",0L0,"+g+"L-"+g+",0L0,-"+g+"ZM-"+p+",-"+p+"L"+p+","+p+"M-"+p+","+p+"L"+p+",-"+p},needLine:!0,noDot:!0},"cross-thin":{n:33,f:function(m){var g=t.round(1.4*m,2);return"M0,"+g+"V-"+g+"M"+g+",0H-"+g},needLine:!0,noDot:!0,noFill:!0},"x-thin":{n:34,f:function(m){var g=t.round(m,2);return"M"+g+","+g+"L-"+g+",-"+g+"M"+g+",-"+g+"L-"+g+","+g},needLine:!0,noDot:!0,noFill:!0},asterisk:{n:35,f:function(m){var g=t.round(1.2*m,2),p=t.round(.85*m,2);return"M0,"+g+"V-"+g+"M"+g+",0H-"+g+"M"+p+","+p+"L-"+p+",-"+p+"M"+p+",-"+p+"L-"+p+","+p},needLine:!0,noDot:!0,noFill:!0},hash:{n:36,f:function(m){var g=t.round(m/2,2),p=t.round(m,2);return"M"+g+","+p+"V-"+p+"m-"+p+",0V"+p+"M"+p+","+g+"H-"+p+"m0,-"+p+"H"+p},needLine:!0,noFill:!0},"y-up":{n:37,f:function(m){var g=t.round(1.2*m,2),p=t.round(1.6*m,2),e=t.round(.8*m,2);return"M-"+g+","+e+"L0,0M"+g+","+e+"L0,0M0,-"+p+"L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-down":{n:38,f:function(m){var g=t.round(1.2*m,2),p=t.round(1.6*m,2),e=t.round(.8*m,2);return"M-"+g+",-"+e+"L0,0M"+g+",-"+e+"L0,0M0,"+p+"L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-left":{n:39,f:function(m){var g=t.round(1.2*m,2),p=t.round(1.6*m,2),e=t.round(.8*m,2);return"M"+e+","+g+"L0,0M"+e+",-"+g+"L0,0M-"+p+",0L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-right":{n:40,f:function(m){var g=t.round(1.2*m,2),p=t.round(1.6*m,2),e=t.round(.8*m,2);return"M-"+e+","+g+"L0,0M-"+e+",-"+g+"L0,0M"+p+",0L0,0"},needLine:!0,noDot:!0,noFill:!0},"line-ew":{n:41,f:function(m){var g=t.round(1.4*m,2);return"M"+g+",0H-"+g},needLine:!0,noDot:!0,noFill:!0},"line-ns":{n:42,f:function(m){var g=t.round(1.4*m,2);return"M0,"+g+"V-"+g},needLine:!0,noDot:!0,noFill:!0},"line-ne":{n:43,f:function(m){var g=t.round(m,2);return"M"+g+",-"+g+"L-"+g+","+g},needLine:!0,noDot:!0,noFill:!0},"line-nw":{n:44,f:function(m){var g=t.round(m,2);return"M"+g+","+g+"L-"+g+",-"+g},needLine:!0,noDot:!0,noFill:!0},"arrow-up":{n:45,f:function(m){var g=t.round(m,2);return"M0,0L-"+g+","+t.round(2*m,2)+"H"+g+"Z"},noDot:!0},"arrow-down":{n:46,f:function(m){var g=t.round(m,2);return"M0,0L-"+g+",-"+t.round(2*m,2)+"H"+g+"Z"},noDot:!0},"arrow-left":{n:47,f:function(m){var g=t.round(2*m,2),p=t.round(m,2);return"M0,0L"+g+",-"+p+"V"+p+"Z"},noDot:!0},"arrow-right":{n:48,f:function(m){var g=t.round(2*m,2),p=t.round(m,2);return"M0,0L-"+g+",-"+p+"V"+p+"Z"},noDot:!0},"arrow-bar-up":{n:49,f:function(m){var g=t.round(m,2);return"M-"+g+",0H"+g+"M0,0L-"+g+","+t.round(2*m,2)+"H"+g+"Z"},needLine:!0,noDot:!0},"arrow-bar-down":{n:50,f:function(m){var g=t.round(m,2);return"M-"+g+",0H"+g+"M0,0L-"+g+",-"+t.round(2*m,2)+"H"+g+"Z"},needLine:!0,noDot:!0},"arrow-bar-left":{n:51,f:function(m){var g=t.round(2*m,2),p=t.round(m,2);return"M0,-"+p+"V"+p+"M0,0L"+g+",-"+p+"V"+p+"Z"},needLine:!0,noDot:!0},"arrow-bar-right":{n:52,f:function(m){var g=t.round(2*m,2),p=t.round(m,2);return"M0,-"+p+"V"+p+"M0,0L-"+g+",-"+p+"V"+p+"Z"},needLine:!0,noDot:!0}}},{"@plotly/d3":58}],674:[function(h,N,H){N.exports={visible:{valType:"boolean",editType:"calc"},type:{valType:"enumerated",values:["percent","constant","sqrt","data"],editType:"calc"},symmetric:{valType:"boolean",editType:"calc"},array:{valType:"data_array",editType:"calc"},arrayminus:{valType:"data_array",editType:"calc"},value:{valType:"number",min:0,dflt:10,editType:"calc"},valueminus:{valType:"number",min:0,dflt:10,editType:"calc"},traceref:{valType:"integer",min:0,dflt:0,editType:"style"},tracerefminus:{valType:"integer",min:0,dflt:0,editType:"style"},copy_ystyle:{valType:"boolean",editType:"plot"},copy_zstyle:{valType:"boolean",editType:"style"},color:{valType:"color",editType:"style"},thickness:{valType:"number",min:0,dflt:2,editType:"style"},width:{valType:"number",min:0,editType:"plot"},editType:"calc",_deprecated:{opacity:{valType:"number",editType:"style"}}}},{}],675:[function(h,N,H){var t=h("fast-isnumeric"),m=h("../../registry"),g=h("../../plots/cartesian/axes"),p=h("../../lib"),e=h("./compute_error");function f(u,i,s,o){var a=i["error_"+o]||{},c=[];if(a.visible&&["linear","log"].indexOf(s.type)!==-1){for(var r=e(a),n=0;n<u.length;n++){var d=u[n],l=d.i;if(l===void 0)l=n;else if(l===null)continue;var y=d[o];if(t(s.c2l(y))){var v=r(y,l);if(t(v[0])&&t(v[1])){var _=d[o+"s"]=y-v[0],x=d[o+"h"]=y+v[1];c.push(_,x)}}}var T=s._id,A=i._extremes[T],S=g.findExtremes(s,c,p.extendFlat({tozero:A.opts.tozero},{padded:!0}));A.min=A.min.concat(S.min),A.max=A.max.concat(S.max)}}N.exports=function(u){for(var i=u.calcdata,s=0;s<i.length;s++){var o=i[s],a=o[0].trace;if(a.visible===!0&&m.traceIs(a,"errorBarsOK")){var c=g.getFromId(u,a.xaxis),r=g.getFromId(u,a.yaxis);f(o,a,c,"x"),f(o,a,r,"y")}}}},{"../../lib":787,"../../plots/cartesian/axes":838,"../../registry":915,"./compute_error":676,"fast-isnumeric":246}],676:[function(h,N,H){function t(m,g){return m==="percent"?function(p){return Math.abs(p*g/100)}:m==="constant"?function(){return Math.abs(g)}:m==="sqrt"?function(p){return Math.sqrt(Math.abs(p))}:void 0}N.exports=function(m){var g=m.type,p=m.symmetric;if(g==="data"){var e=m.array||[];if(p)return function(s,o){var a=+e[o];return[a,a]};var f=m.arrayminus||[];return function(s,o){var a=+e[o],c=+f[o];return isNaN(a)&&isNaN(c)?[NaN,NaN]:[c||0,a||0]}}var u=t(g,m.value),i=t(g,m.valueminus);return p||m.valueminus===void 0?function(s){var o=u(s);return[o,o]}:function(s){return[i(s),u(s)]}}},{}],677:[function(h,N,H){var t=h("fast-isnumeric"),m=h("../../registry"),g=h("../../lib"),p=h("../../plot_api/plot_template"),e=h("./attributes");N.exports=function(f,u,i,s){var o="error_"+s.axis,a=p.newContainer(u,o),c=f[o]||{};function r(y,v){return g.coerce(c,a,e,y,v)}if(r("visible",c.array!==void 0||c.value!==void 0||c.type==="sqrt")!==!1){var n=r("type","array"in c?"data":"percent"),d=!0;n!=="sqrt"&&(d=r("symmetric",!((n==="data"?"arrayminus":"valueminus")in c))),n==="data"?(r("array"),r("traceref"),d||(r("arrayminus"),r("tracerefminus"))):n!=="percent"&&n!=="constant"||(r("value"),d||r("valueminus"));var l="copy_"+s.inherit+"style";s.inherit&&(u["error_"+s.inherit]||{}).visible&&r(l,!(c.color||t(c.thickness)||t(c.width))),s.inherit&&a[l]||(r("color",i),r("thickness"),r("width",m.traceIs(u,"gl3d")?0:4))}}},{"../../lib":787,"../../plot_api/plot_template":827,"../../registry":915,"./attributes":674,"fast-isnumeric":246}],678:[function(h,N,H){var t=h("../../lib"),m=h("../../plot_api/edit_types").overrideAll,g=h("./attributes"),p={error_x:t.extendFlat({},g),error_y:t.extendFlat({},g)};delete p.error_x.copy_zstyle,delete p.error_y.copy_zstyle,delete p.error_y.copy_ystyle;var e={error_x:t.extendFlat({},g),error_y:t.extendFlat({},g),error_z:t.extendFlat({},g)};delete e.error_x.copy_ystyle,delete e.error_y.copy_ystyle,delete e.error_z.copy_ystyle,delete e.error_z.copy_zstyle,N.exports={moduleType:"component",name:"errorbars",schema:{traces:{scatter:p,bar:p,histogram:p,scatter3d:m(e,"calc","nested"),scattergl:m(p,"calc","nested")}},supplyDefaults:h("./defaults"),calc:h("./calc"),makeComputeError:h("./compute_error"),plot:h("./plot"),style:h("./style"),hoverInfo:function(f,u,i){(u.error_y||{}).visible&&(i.yerr=f.yh-f.y,u.error_y.symmetric||(i.yerrneg=f.y-f.ys)),(u.error_x||{}).visible&&(i.xerr=f.xh-f.x,u.error_x.symmetric||(i.xerrneg=f.x-f.xs))}}},{"../../lib":787,"../../plot_api/edit_types":820,"./attributes":674,"./calc":675,"./compute_error":676,"./defaults":677,"./plot":679,"./style":680}],679:[function(h,N,H){var t=h("@plotly/d3"),m=h("fast-isnumeric"),g=h("../drawing"),p=h("../../traces/scatter/subtypes");N.exports=function(e,f,u,i){var s=u.xaxis,o=u.yaxis,a=i&&i.duration>0;f.each(function(c){var r,n=c[0].trace,d=n.error_x||{},l=n.error_y||{};n.ids&&(r=function(x){return x.id});var y=p.hasMarkers(n)&&n.marker.maxdisplayed>0;l.visible||d.visible||(c=[]);var v=t.select(this).selectAll("g.errorbar").data(c,r);if(v.exit().remove(),c.length){d.visible||v.selectAll("path.xerror").remove(),l.visible||v.selectAll("path.yerror").remove(),v.style("opacity",1);var _=v.enter().append("g").classed("errorbar",!0);a&&_.style("opacity",0).transition().duration(i.duration).style("opacity",1),g.setClipUrl(v,u.layerClipId,e),v.each(function(x){var T=t.select(this),A=function(M,P,O){var F={x:P.c2p(M.x),y:O.c2p(M.y)};return M.yh!==void 0&&(F.yh=O.c2p(M.yh),F.ys=O.c2p(M.ys),m(F.ys)||(F.noYS=!0,F.ys=O.c2p(M.ys,!0))),M.xh!==void 0&&(F.xh=P.c2p(M.xh),F.xs=P.c2p(M.xs),m(F.xs)||(F.noXS=!0,F.xs=P.c2p(M.xs,!0))),F}(x,s,o);if(!y||x.vis){var S,w=T.select("path.yerror");if(l.visible&&m(A.x)&&m(A.yh)&&m(A.ys)){var L=l.width;S="M"+(A.x-L)+","+A.yh+"h"+2*L+"m-"+L+",0V"+A.ys,A.noYS||(S+="m-"+L+",0h"+2*L),w.size()?a&&(w=w.transition().duration(i.duration).ease(i.easing)):w=T.append("path").style("vector-effect","non-scaling-stroke").classed("yerror",!0),w.attr("d",S)}else w.remove();var k=T.select("path.xerror");if(d.visible&&m(A.y)&&m(A.xh)&&m(A.xs)){var C=(d.copy_ystyle?l:d).width;S="M"+A.xh+","+(A.y-C)+"v"+2*C+"m0,-"+C+"H"+A.xs,A.noXS||(S+="m0,-"+C+"v"+2*C),k.size()?a&&(k=k.transition().duration(i.duration).ease(i.easing)):k=T.append("path").style("vector-effect","non-scaling-stroke").classed("xerror",!0),k.attr("d",S)}else k.remove()}})}})}},{"../../traces/scatter/subtypes":1227,"../drawing":672,"@plotly/d3":58,"fast-isnumeric":246}],680:[function(h,N,H){var t=h("@plotly/d3"),m=h("../color");N.exports=function(g){g.each(function(p){var e=p[0].trace,f=e.error_y||{},u=e.error_x||{},i=t.select(this);i.selectAll("path.yerror").style("stroke-width",f.thickness+"px").call(m.stroke,f.color),u.copy_ystyle&&(u=f),i.selectAll("path.xerror").style("stroke-width",u.thickness+"px").call(m.stroke,u.color)})}},{"../color":650,"@plotly/d3":58}],681:[function(h,N,H){var t=h("../../plots/font_attributes"),m=h("./layout_attributes").hoverlabel,g=h("../../lib/extend").extendFlat;N.exports={hoverlabel:{bgcolor:g({},m.bgcolor,{arrayOk:!0}),bordercolor:g({},m.bordercolor,{arrayOk:!0}),font:t({arrayOk:!0,editType:"none"}),align:g({},m.align,{arrayOk:!0}),namelength:g({},m.namelength,{arrayOk:!0}),editType:"none"}}},{"../../lib/extend":777,"../../plots/font_attributes":867,"./layout_attributes":691}],682:[function(h,N,H){var t=h("../../lib"),m=h("../../registry");function g(p,e,f,u){u=u||t.identity,Array.isArray(p)&&(e[0][f]=u(p))}N.exports=function(p){var e=p.calcdata,f=p._fullLayout;function u(c){return function(r){return t.coerceHoverinfo({hoverinfo:r},{_module:c._module},f)}}for(var i=0;i<e.length;i++){var s=e[i],o=s[0].trace;if(!m.traceIs(o,"pie-like")){var a=m.traceIs(o,"2dMap")?g:t.fillArray;a(o.hoverinfo,s,"hi",u(o)),o.hovertemplate&&a(o.hovertemplate,s,"ht"),o.hoverlabel&&(a(o.hoverlabel.bgcolor,s,"hbg"),a(o.hoverlabel.bordercolor,s,"hbc"),a(o.hoverlabel.font.size,s,"hts"),a(o.hoverlabel.font.color,s,"htc"),a(o.hoverlabel.font.family,s,"htf"),a(o.hoverlabel.namelength,s,"hnl"),a(o.hoverlabel.align,s,"hta"))}}}},{"../../lib":787,"../../registry":915}],683:[function(h,N,H){var t=h("../../registry"),m=h("./hover").hover;N.exports=function(g,p,e){var f=t.getComponentMethod("annotations","onClick")(g,g._hoverdata);function u(){g.emit("plotly_click",{points:g._hoverdata,event:p})}e!==void 0&&m(g,p,e,!0),g._hoverdata&&p&&p.target&&(f&&f.then?f.then(u):u(),p.stopImmediatePropagation&&p.stopImmediatePropagation())}},{"../../registry":915,"./hover":687}],684:[function(h,N,H){N.exports={YANGLE:60,HOVERARROWSIZE:6,HOVERTEXTPAD:3,HOVERFONTSIZE:13,HOVERFONT:"Arial, sans-serif",HOVERMINTIME:50,HOVERID:"-hover"}},{}],685:[function(h,N,H){var t=h("../../lib"),m=h("./attributes"),g=h("./hoverlabel_defaults");N.exports=function(p,e,f,u){var i=t.extendFlat({},u.hoverlabel);e.hovertemplate&&(i.namelength=-1),g(p,e,function(s,o){return t.coerce(p,e,m,s,o)},i)}},{"../../lib":787,"./attributes":681,"./hoverlabel_defaults":688}],686:[function(h,N,H){var t=h("../../lib");H.getSubplot=function(u){return u.subplot||u.xaxis+u.yaxis||u.geo},H.isTraceInSubplots=function(u,i){if(u.type==="splom"){for(var s=u.xaxes||[],o=u.yaxes||[],a=0;a<s.length;a++)for(var c=0;c<o.length;c++)if(i.indexOf(s[a]+o[c])!==-1)return!0;return!1}return i.indexOf(H.getSubplot(u))!==-1},H.flat=function(u,i){for(var s=new Array(u.length),o=0;o<u.length;o++)s[o]=i;return s},H.p2c=function(u,i){for(var s=new Array(u.length),o=0;o<u.length;o++)s[o]=u[o].p2c(i);return s},H.getDistanceFunction=function(u,i,s,o){return u==="closest"?o||H.quadrature(i,s):u.charAt(0)==="x"?i:s},H.getClosest=function(u,i,s){if(s.index!==!1)s.index>=0&&s.index<u.length?s.distance=0:s.index=!1;else for(var o=0;o<u.length;o++){var a=i(u[o]);a<=s.distance&&(s.index=o,s.distance=a)}return s},H.inbox=function(u,i,s){return u*i<0||u===0?s:1/0},H.quadrature=function(u,i){return function(s){var o=u(s),a=i(s);return Math.sqrt(o*o+a*a)}},H.makeEventData=function(u,i,s){var o="index"in u?u.index:u.pointNumber,a={data:i._input,fullData:i,curveNumber:i.index,pointNumber:o};if(i._indexToPoints){var c=i._indexToPoints[o];c.length===1?a.pointIndex=c[0]:a.pointIndices=c}else a.pointIndex=o;return i._module.eventData?a=i._module.eventData(a,u,i,s,o):("xVal"in u?a.x=u.xVal:"x"in u&&(a.x=u.x),"yVal"in u?a.y=u.yVal:"y"in u&&(a.y=u.y),u.xa&&(a.xaxis=u.xa),u.ya&&(a.yaxis=u.ya),u.zLabelVal!==void 0&&(a.z=u.zLabelVal)),H.appendArrayPointValue(a,i,o),a},H.appendArrayPointValue=function(u,i,s){var o=i._arrayAttrs;if(o)for(var a=0;a<o.length;a++){var c=o[a],r=g(c);if(u[r]===void 0){var n=p(t.nestedProperty(i,c).get(),s);n!==void 0&&(u[r]=n)}}},H.appendArrayMultiPointValues=function(u,i,s){var o=i._arrayAttrs;if(o)for(var a=0;a<o.length;a++){var c=o[a],r=g(c);if(u[r]===void 0){for(var n=t.nestedProperty(i,c).get(),d=new Array(s.length),l=0;l<s.length;l++)d[l]=p(n,s[l]);u[r]=d}}};var m={ids:"id",locations:"location",labels:"label",values:"value","marker.colors":"color",parents:"parent"};function g(u){return m[u]||u}function p(u,i){return Array.isArray(i)?Array.isArray(u)&&Array.isArray(u[i[0]])?u[i[0]][i[1]]:void 0:u[i]}var e={x:!0,y:!0},f={"x unified":!0,"y unified":!0};H.isUnifiedHover=function(u){return typeof u=="string"&&!!f[u]},H.isXYhover=function(u){return typeof u=="string"&&!!e[u]}},{"../../lib":787}],687:[function(h,N,H){var t=h("@plotly/d3"),m=h("fast-isnumeric"),g=h("tinycolor2"),p=h("../../lib"),e=p.strTranslate,f=p.strRotate,u=h("../../lib/events"),i=h("../../lib/svg_text_utils"),s=h("../../lib/override_cursor"),o=h("../drawing"),a=h("../color"),c=h("../dragelement"),r=h("../../plots/cartesian/axes"),n=h("../../registry"),d=h("./helpers"),l=h("./constants"),y=h("../legend/defaults"),v=h("../legend/draw"),_=l.YANGLE,x=Math.PI*_/180,T=1/Math.sin(x),A=Math.cos(x),S=Math.sin(x),w=l.HOVERARROWSIZE,L=l.HOVERTEXTPAD,k={box:!0,ohlc:!0,violin:!0,candlestick:!0},C={scatter:!0,scattergl:!0,splom:!0};function M(B){return[B.trace.index,B.index,B.x0,B.y0,B.name,B.attr,B.xa?B.xa._id:"",B.ya?B.ya._id:""].join(",")}H.hover=function(B,q,ee,J){B=p.getGraphDiv(B),p.throttle(B._fullLayout._uid+l.HOVERID,l.HOVERMINTIME,function(){(function($,te,ie,ae){ie||(ie="xy");var he=Array.isArray(ie)?ie:[ie],se=$._fullLayout,de=se._plots||[],ce=de[ie],ve=se._has("cartesian");if(ce){var ke=ce.overlays.map(function($r){return $r.id});he=he.concat(ke)}for(var Ee=he.length,be=new Array(Ee),xe=new Array(Ee),ue=!1,me=0;me<Ee;me++){var we=he[me];if(de[we])ue=!0,be[me]=de[we].xaxis,xe[me]=de[we].yaxis;else{if(!se[we]||!se[we]._subplot)return void p.warn("Unrecognized subplot: "+we);var Me=se[we]._subplot;be[me]=Me.xaxis,xe[me]=Me.yaxis}}var Se=te.hovermode||se.hovermode;if(Se&&!ue&&(Se="closest"),["x","y","closest","x unified","y unified"].indexOf(Se)===-1||!$.calcdata||$.querySelector(".zoombox")||$._dragging)return c.unhoverRaw($,te);var De=se.hoverdistance;De===-1&&(De=1/0);var Fe=se.spikedistance;Fe===-1&&(Fe=1/0);var Ye,et,Oe,je,We,Ge,Qe,it,lt,Lt,wt,rt,$e,xt=[],Qt=[],$t={hLinePoint:null,vLinePoint:null},Ue=!1;if(Array.isArray(te))for(Se="array",Oe=0;Oe<te.length;Oe++)(We=$.calcdata[te[Oe].curveNumber||0])&&(Ge=We[0].trace,We[0].trace.hoverinfo!=="skip"&&(Qt.push(We),Ge.orientation==="h"&&(Ue=!0)));else{for(je=0;je<$.calcdata.length;je++)We=$.calcdata[je],(Ge=We[0].trace).hoverinfo!=="skip"&&d.isTraceInSubplots(Ge,he)&&(Qt.push(We),Ge.orientation==="h"&&(Ue=!0));var He,Be;if(!te.target)He="xpx"in te?te.xpx:be[0]._length/2,Be="ypx"in te?te.ypx:xe[0]._length/2;else{if(u.triggerHandler($,"plotly_beforehover",te)===!1)return;var Je=te.composedPath&&te.composedPath()[0];Je||(Je=te.target);var _e=Je.getBoundingClientRect();He=te.clientX-_e.left,Be=te.clientY-_e.top,se._calcInverseTransform($);var Le=p.apply3DTransform(se._invTransform)(He,Be);if(He=Le[0],Be=Le[1],He<0||He>be[0]._length||Be<0||Be>xe[0]._length)return c.unhoverRaw($,te)}if(te.pointerX=He+be[0]._offset,te.pointerY=Be+xe[0]._offset,Ye="xval"in te?d.flat(he,te.xval):d.p2c(be,He),et="yval"in te?d.flat(he,te.yval):d.p2c(xe,Be),!m(Ye[0])||!m(et[0]))return p.warn("Fx.hover failed",te,$),c.unhoverRaw($,te)}var Ce=1/0;function Pe($r,Kr){for(je=0;je<Qt.length;je++)if((We=Qt[je])&&We[0]&&We[0].trace&&(Ge=We[0].trace).visible===!0&&Ge._length!==0&&["carpet","contourcarpet"].indexOf(Ge._module.name)===-1){if(Ge.type==="splom"?Qe=he[it=0]:(Qe=d.getSubplot(Ge),it=he.indexOf(Qe)),lt=Se,d.isUnifiedHover(lt)&&(lt=lt.charAt(0)),rt={cd:We,trace:Ge,xa:be[it],ya:xe[it],maxHoverDistance:De,maxSpikeDistance:Fe,index:!1,distance:Math.min(Ce,De),spikeDistance:1/0,xSpike:void 0,ySpike:void 0,color:a.defaultLine,name:Ge.name,x0:void 0,x1:void 0,y0:void 0,y1:void 0,xLabelVal:void 0,yLabelVal:void 0,zLabelVal:void 0,text:void 0},se[Qe]&&(rt.subplot=se[Qe]._subplot),se._splomScenes&&se._splomScenes[Ge.uid]&&(rt.scene=se._splomScenes[Ge.uid]),$e=xt.length,lt==="array"){var en=te[je];"pointNumber"in en?(rt.index=en.pointNumber,lt="closest"):(lt="","xval"in en&&(Lt=en.xval,lt="x"),"yval"in en&&(wt=en.yval,lt=lt?"closest":"y"))}else $r!==void 0&&Kr!==void 0?(Lt=$r,wt=Kr):(Lt=Ye[it],wt=et[it]);if(De!==0)if(Ge._module&&Ge._module.hoverPoints){var Tn=Ge._module.hoverPoints(rt,Lt,wt,lt,{finiteRange:!0,hoverLayer:se._hoverlayer});if(Tn)for(var Mn,Rn=0;Rn<Tn.length;Rn++)Mn=Tn[Rn],m(Mn.x0)&&m(Mn.y0)&&xt.push(W(Mn,Se))}else p.log("Unrecognized trace type in hover:",Ge);if(Se==="closest"&&xt.length>$e&&(xt.splice(0,$e),Ce=xt[0].distance),ve&&Fe!==0&&xt.length===0){rt.distance=Fe,rt.index=!1;var Zt=Ge._module.hoverPoints(rt,Lt,wt,"closest",{hoverLayer:se._hoverlayer});if(Zt&&(Zt=Zt.filter(function(jr){return jr.spikeDistance<=Fe})),Zt&&Zt.length){var Ct,Ht=Zt.filter(function(jr){return jr.xa.showspikes&&jr.xa.spikesnap!=="hovered data"});if(Ht.length){var cr=Ht[0];m(cr.x0)&&m(cr.y0)&&(Ct=ut(cr),(!$t.vLinePoint||$t.vLinePoint.spikeDistance>Ct.spikeDistance)&&($t.vLinePoint=Ct))}var _r=Zt.filter(function(jr){return jr.ya.showspikes&&jr.ya.spikesnap!=="hovered data"});if(_r.length){var Vr=_r[0];m(Vr.x0)&&m(Vr.y0)&&(Ct=ut(Vr),(!$t.hLinePoint||$t.hLinePoint.spikeDistance>Ct.spikeDistance)&&($t.hLinePoint=Ct))}}}}}function Xe($r,Kr,en){for(var Tn,Mn=null,Rn=1/0,Zt=0;Zt<$r.length;Zt++)Tn=$r[Zt].spikeDistance,en&&Zt===0&&(Tn=-1/0),Tn<=Rn&&Tn<=Kr&&(Mn=$r[Zt],Rn=Tn);return Mn}function ut($r){return $r?{xa:$r.xa,ya:$r.ya,x:$r.xSpike!==void 0?$r.xSpike:($r.x0+$r.x1)/2,y:$r.ySpike!==void 0?$r.ySpike:($r.y0+$r.y1)/2,distance:$r.distance,spikeDistance:$r.spikeDistance,curveNumber:$r.trace.index,color:$r.color,pointNumber:$r.index}:null}Pe();var kt={fullLayout:se,container:se._hoverlayer,event:te},ft=$._spikepoints,Et={vLinePoint:$t.vLinePoint,hLinePoint:$t.hLinePoint};$._spikepoints=Et;var mt=function(){xt.sort(function($r,Kr){return $r.distance-Kr.distance}),xt=function($r,Kr){for(var en=Kr.charAt(0),Tn=[],Mn=[],Rn=[],Zt=0;Zt<$r.length;Zt++){var Ct=$r[Zt];n.traceIs(Ct.trace,"bar-like")||n.traceIs(Ct.trace,"box-violin")?Rn.push(Ct):Ct.trace[en+"period"]?Mn.push(Ct):Tn.push(Ct)}return Tn.concat(Mn).concat(Rn)}(xt,Se)};mt();var It=Se.charAt(0),vt=(It==="x"||It==="y")&&xt[0]&&C[xt[0].trace.type];if(ve&&Fe!==0&&xt.length!==0){var nt=Xe(xt.filter(function($r){return $r.ya.showspikes}),Fe,vt);$t.hLinePoint=ut(nt);var At=Xe(xt.filter(function($r){return $r.xa.showspikes}),Fe,vt);$t.vLinePoint=ut(At)}if(xt.length===0){var Ft=c.unhoverRaw($,te);return!ve||$t.hLinePoint===null&&$t.vLinePoint===null||Q(ft)&&Z($,$t,kt),Ft}if(ve&&Q(ft)&&Z($,$t,kt),d.isXYhover(lt)&&xt[0].length!==0&&xt[0].trace.type!=="splom"){var Nt=xt[0],Kt=(xt=k[Nt.trace.type]?xt.filter(function($r){return $r.trace.index===Nt.trace.index}):[Nt]).length,Ie=G("x",Nt,se),ot=G("y",Nt,se);Pe(Ie,ot);var bt,Pt=[],Vt={},nr=0,Yt=function($r){var Kr=k[$r.trace.type]?M($r):$r.trace.index;if(Vt[Kr]){var en=Vt[Kr]-1,Tn=Pt[en];en>0&&Math.abs($r.distance)<Math.abs(Tn.distance)&&(Pt[en]=$r)}else nr++,Vt[Kr]=nr,Pt.push($r)};for(bt=0;bt<Kt;bt++)Yt(xt[bt]);for(bt=xt.length-1;bt>Kt-1;bt--)Yt(xt[bt]);xt=Pt,mt()}var Xt=$._hoverdata,ar=[],hr=Y($),mr=K($);for(Oe=0;Oe<xt.length;Oe++){var sr=xt[Oe],fr=d.makeEventData(sr,sr.trace,sr.cd);if(sr.hovertemplate!==!1){var yr=!1;sr.cd[sr.index]&&sr.cd[sr.index].ht&&(yr=sr.cd[sr.index].ht),sr.hovertemplate=yr||sr.trace.hovertemplate||!1}if(sr.xa&&sr.ya){var zr=sr.x0+sr.xa._offset,xr=sr.x1+sr.xa._offset,Br=sr.y0+sr.ya._offset,Jr=sr.y1+sr.ya._offset,fn=Math.min(zr,xr),Cn=Math.max(zr,xr),Pn=Math.min(Br,Jr),An=Math.max(Br,Jr);fr.bbox={x0:fn+mr,x1:Cn+mr,y0:Pn+hr,y1:An+hr}}sr.eventData=[fr],ar.push(fr)}$._hoverdata=ar;var rn=Se==="y"&&(Qt.length>1||xt.length>1)||Se==="closest"&&Ue&&xt.length>1,Fr=a.combine(se.plot_bgcolor||a.background,se.paper_bgcolor),Lr=O(xt,{gd:$,hovermode:Se,rotateLabels:rn,bgColor:Fr,container:se._hoverlayer,outerContainer:se._paper.node(),commonLabelOpts:se.hoverlabel,hoverdistance:se.hoverdistance});if(d.isUnifiedHover(Se)||(function($r,Kr,en){var Tn,Mn,Rn,Zt,Ct,Ht,cr,_r=0,Vr=1,jr=$r.size(),vr=new Array(jr),br=0;function Ar(Ir){var Gr=Ir[0],mn=Ir[Ir.length-1];if(Mn=Gr.pmin-Gr.pos-Gr.dp+Gr.size,Rn=mn.pos+mn.dp+mn.size-Gr.pmax,Mn>.01){for(Ct=Ir.length-1;Ct>=0;Ct--)Ir[Ct].dp+=Mn;Tn=!1}if(!(Rn<.01)){if(Mn<-.01){for(Ct=Ir.length-1;Ct>=0;Ct--)Ir[Ct].dp-=Rn;Tn=!1}if(Tn){var hn=0;for(Zt=0;Zt<Ir.length;Zt++)(Ht=Ir[Zt]).pos+Ht.dp+Ht.size>Gr.pmax&&hn++;for(Zt=Ir.length-1;Zt>=0&&!(hn<=0);Zt--)(Ht=Ir[Zt]).pos>Gr.pmax-1&&(Ht.del=!0,hn--);for(Zt=0;Zt<Ir.length&&!(hn<=0);Zt++)if((Ht=Ir[Zt]).pos<Gr.pmin+1)for(Ht.del=!0,hn--,Rn=2*Ht.size,Ct=Ir.length-1;Ct>=0;Ct--)Ir[Ct].dp-=Rn;for(Zt=Ir.length-1;Zt>=0&&!(hn<=0);Zt--)(Ht=Ir[Zt]).pos+Ht.dp+Ht.size>Gr.pmax&&(Ht.del=!0,hn--)}}}for($r.each(function(Ir){var Gr=Ir[Kr],mn=Gr._id.charAt(0)==="x",hn=Gr.range;br===0&&hn&&hn[0]>hn[1]!==mn&&(Vr=-1),vr[br++]=[{datum:Ir,traceIndex:Ir.trace.index,dp:0,pos:Ir.pos,posref:Ir.posref,size:Ir.by*(mn?T:1)/2,pmin:0,pmax:mn?en.width:en.height}]}),vr.sort(function(Ir,Gr){return Ir[0].posref-Gr[0].posref||Vr*(Gr[0].traceIndex-Ir[0].traceIndex)});!Tn&&_r<=jr;){for(_r++,Tn=!0,Zt=0;Zt<vr.length-1;){var kr=vr[Zt],Cr=vr[Zt+1],Hr=kr[kr.length-1],ln=Cr[0];if((Mn=Hr.pos+Hr.dp+Hr.size-ln.pos-ln.dp+ln.size)>.01&&Hr.pmin===ln.pmin&&Hr.pmax===ln.pmax){for(Ct=Cr.length-1;Ct>=0;Ct--)Cr[Ct].dp+=Mn;for(kr.push.apply(kr,Cr),vr.splice(Zt+1,1),cr=0,Ct=kr.length-1;Ct>=0;Ct--)cr+=kr[Ct].dp;for(Rn=cr/kr.length,Ct=kr.length-1;Ct>=0;Ct--)kr[Ct].dp-=Rn;Tn=!1}else Zt++}vr.forEach(Ar)}for(Zt=vr.length-1;Zt>=0;Zt--){var xn=vr[Zt];for(Ct=xn.length-1;Ct>=0;Ct--){var Zr=xn[Ct],yn=Zr.datum;yn.offset=Zr.dp,yn.del=Zr.del}}}(Lr,rn?"xa":"ya",se),j(Lr,rn,se._invScaleX,se._invScaleY)),te.target&&te.target.tagName){var Qr=n.getComponentMethod("annotations","hasClickToShow")($,ar);s(t.select(te.target),Qr?"pointer":"")}!te.target||ae||!function($r,Kr,en){if(!en||en.length!==$r._hoverdata.length)return!0;for(var Tn=en.length-1;Tn>=0;Tn--){var Mn=en[Tn],Rn=$r._hoverdata[Tn];if(Mn.curveNumber!==Rn.curveNumber||String(Mn.pointNumber)!==String(Rn.pointNumber)||String(Mn.pointNumbers)!==String(Rn.pointNumbers))return!0}return!1}($,0,Xt)||(Xt&&$.emit("plotly_unhover",{event:te,points:Xt}),$.emit("plotly_hover",{event:te,points:$._hoverdata,xaxes:be,yaxes:xe,xvals:Ye,yvals:et}))})(B,q,ee,J)})},H.loneHover=function(B,q){var ee=!0;Array.isArray(B)||(ee=!1,B=[B]);var J=q.gd,$=Y(J),te=K(J),ie=O(B.map(function(se){var de=se._x0||se.x0||se.x||0,ce=se._x1||se.x1||se.x||0,ve=se._y0||se.y0||se.y||0,ke=se._y1||se.y1||se.y||0,Ee=se.eventData;if(Ee){var be=Math.min(de,ce),xe=Math.max(de,ce),ue=Math.min(ve,ke),me=Math.max(ve,ke),we=se.trace;if(n.traceIs(we,"gl3d")){var Me=J._fullLayout[we.scene]._scene.container,Se=Me.offsetLeft,De=Me.offsetTop;be+=Se,xe+=Se,ue+=De,me+=De}Ee.bbox={x0:be+te,x1:xe+te,y0:ue+$,y1:me+$},q.inOut_bbox&&q.inOut_bbox.push(Ee.bbox)}else Ee=!1;return{color:se.color||a.defaultLine,x0:se.x0||se.x||0,x1:se.x1||se.x||0,y0:se.y0||se.y||0,y1:se.y1||se.y||0,xLabel:se.xLabel,yLabel:se.yLabel,zLabel:se.zLabel,text:se.text,name:se.name,idealAlign:se.idealAlign,borderColor:se.borderColor,fontFamily:se.fontFamily,fontSize:se.fontSize,fontColor:se.fontColor,nameLength:se.nameLength,textAlign:se.textAlign,trace:se.trace||{index:0,hoverinfo:""},xa:{_offset:0},ya:{_offset:0},index:0,hovertemplate:se.hovertemplate||!1,hovertemplateLabels:se.hovertemplateLabels||!1,eventData:Ee}}),{gd:J,hovermode:"closest",rotateLabels:!1,bgColor:q.bgColor||a.background,container:t.select(q.container),outerContainer:q.outerContainer||q.container}),ae=0,he=0;return ie.sort(function(se,de){return se.y0-de.y0}).each(function(se,de){var ce=se.y0-se.by/2;se.offset=ce-5<ae?ae-ce+5:0,ae=ce+se.by+se.offset,de===q.anchorIndex&&(he=se.offset)}).each(function(se){se.offset-=he}),j(ie,!1,J._fullLayout._invScaleX,J._fullLayout._invScaleY),ee?ie:ie.node()};var P=/<extra>([\s\S]*)<\/extra>/;function O(B,q){var ee=q.gd,J=ee._fullLayout,$=q.hovermode,te=q.rotateLabels,ie=q.bgColor,ae=q.container,he=q.outerContainer,se=q.commonLabelOpts||{},de=q.fontFamily||l.HOVERFONT,ce=q.fontSize||l.HOVERFONTSIZE,ve=B[0],ke=ve.xa,Ee=ve.ya,be=$.charAt(0),xe=ve[be+"Label"],ue=D(ee,he),me=ue.top,we=ue.width,Me=ue.height,Se=xe!==void 0&&ve.distance<=q.hoverdistance&&($==="x"||$==="y");if(Se){var De,Fe,Ye=!0;for(De=0;De<B.length;De++)if(Ye&&B[De].zLabel===void 0&&(Ye=!1),Fe=B[De].hoverinfo||B[De].trace.hoverinfo){var et=Array.isArray(Fe)?Fe:Fe.split("+");if(et.indexOf("all")===-1&&et.indexOf($)===-1){Se=!1;break}}Ye&&(Se=!1)}var Oe=ae.selectAll("g.axistext").data(Se?[0]:[]);if(Oe.enter().append("g").classed("axistext",!0),Oe.exit().remove(),Oe.each(function(){var vt=t.select(this),nt=p.ensureSingle(vt,"path","",function(xr){xr.style({"stroke-width":"1px"})}),At=p.ensureSingle(vt,"text","",function(xr){xr.attr("data-notex",1)}),Ft=se.bgcolor||a.defaultLine,Nt=se.bordercolor||a.contrast(Ft),Kt=a.contrast(Ft),Ie={family:se.font.family||de,size:se.font.size||ce,color:se.font.color||Kt};nt.style({fill:Ft,stroke:Nt}),At.text(xe).call(o.font,Ie).call(i.positionText,0,0).call(i.convertToTspans,ee),vt.attr("transform","");var ot,bt,Pt=D(ee,At.node());if($==="x"){var Vt=ke.side==="top"?"-":"";At.attr("text-anchor","middle").call(i.positionText,0,ke.side==="top"?me-Pt.bottom-w-L:me-Pt.top+w+L),ot=ke._offset+(ve.x0+ve.x1)/2,bt=Ee._offset+(ke.side==="top"?0:Ee._length);var nr=Pt.width/2+L;ot<nr?(ot=nr,nt.attr("d","M-"+(nr-w)+",0L-"+(nr-2*w)+","+Vt+w+"H"+(L+Pt.width/2)+"v"+Vt+(2*L+Pt.height)+"H-"+nr+"V"+Vt+w+"Z")):ot>J.width-nr?(ot=J.width-nr,nt.attr("d","M"+(nr-w)+",0L"+nr+","+Vt+w+"v"+Vt+(2*L+Pt.height)+"H-"+nr+"V"+Vt+w+"H"+(nr-2*w)+"Z")):nt.attr("d","M0,0L"+w+","+Vt+w+"H"+(L+Pt.width/2)+"v"+Vt+(2*L+Pt.height)+"H-"+(L+Pt.width/2)+"V"+Vt+w+"H-"+w+"Z")}else{var Yt,Xt,ar;Ee.side==="right"?(Yt="start",Xt=1,ar="",ot=ke._offset+ke._length):(Yt="end",Xt=-1,ar="-",ot=ke._offset),bt=Ee._offset+(ve.y0+ve.y1)/2,At.attr("text-anchor",Yt),nt.attr("d","M0,0L"+ar+w+","+w+"V"+(L+Pt.height/2)+"h"+ar+(2*L+Pt.width)+"V-"+(L+Pt.height/2)+"H"+ar+w+"V-"+w+"Z");var hr,mr=Pt.height/2,sr=me-Pt.top-mr,fr="clip"+J._uid+"commonlabel"+Ee._id;if(ot<Pt.width+2*L+w){hr="M-"+(w+L)+"-"+mr+"h-"+(Pt.width-L)+"V"+mr+"h"+(Pt.width-L)+"Z";var yr=Pt.width-ot+L;i.positionText(At,yr,sr),Yt==="end"&&At.selectAll("tspan").each(function(){var xr=t.select(this),Br=o.tester.append("text").text(xr.text()).call(o.font,Ie),Jr=D(ee,Br.node());Math.round(Jr.width)<Math.round(Pt.width)&&xr.attr("x",yr-Jr.width),Br.remove()})}else i.positionText(At,Xt*(L+w),sr),hr=null;var zr=J._topclips.selectAll("#"+fr).data(hr?[0]:[]);zr.enter().append("clipPath").attr("id",fr).append("path"),zr.exit().remove(),zr.select("path").attr("d",hr),o.setClipUrl(At,hr?fr:null,ee)}vt.attr("transform",e(ot,bt))}),d.isUnifiedHover($)){if(ae.selectAll("g.hovertext").remove(),B.length===0)return;var je=J.hoverlabel,We=je.font,Ge={showlegend:!0,legend:{title:{text:xe,font:We},font:We,bgcolor:je.bgcolor,bordercolor:je.bordercolor,borderwidth:1,tracegroupgap:7,traceorder:J.legend?J.legend.traceorder:void 0,orientation:"v"}},Qe={};y(Ge,Qe,ee._fullData);var it=Qe.legend;it.entries=[];for(var lt=0;lt<B.length;lt++){var Lt=F(B[lt],!0,$,J,xe),wt=Lt[0],rt=Lt[1],$e=B[lt];$e.name=rt,$e.text=rt!==""?rt+" : "+wt:wt;var xt=$e.cd[$e.index];xt&&(xt.mc&&($e.mc=xt.mc),xt.mcc&&($e.mc=xt.mcc),xt.mlc&&($e.mlc=xt.mlc),xt.mlcc&&($e.mlc=xt.mlcc),xt.mlw&&($e.mlw=xt.mlw),xt.mrc&&($e.mrc=xt.mrc),xt.dir&&($e.dir=xt.dir)),$e._distinct=!0,it.entries.push([$e])}it.entries.sort(function(vt,nt){return vt[0].trace.index-nt[0].trace.index}),it.layer=ae,it._inHover=!0,it._groupTitleFont=We,v(ee,it);var Qt,$t,Ue,He,Be=ae.select("g.legend"),Je=D(ee,Be.node()),_e=Je.width+2*L,Le=Je.height+2*L,Ce=B[0],Pe=(Ce.x0+Ce.x1)/2,Xe=(Ce.y0+Ce.y1)/2,ut=!(n.traceIs(Ce.trace,"bar-like")||n.traceIs(Ce.trace,"box-violin"));be==="y"?ut?($t=Xe-L,Qt=Xe+L):($t=Math.min.apply(null,B.map(function(vt){return Math.min(vt.y0,vt.y1)})),Qt=Math.max.apply(null,B.map(function(vt){return Math.max(vt.y0,vt.y1)}))):$t=Qt=p.mean(B.map(function(vt){return(vt.y0+vt.y1)/2}))-Le/2,be==="x"?ut?(Ue=Pe+L,He=Pe-L):(Ue=Math.max.apply(null,B.map(function(vt){return Math.max(vt.x0,vt.x1)})),He=Math.min.apply(null,B.map(function(vt){return Math.min(vt.x0,vt.x1)}))):Ue=He=p.mean(B.map(function(vt){return(vt.x0+vt.x1)/2}))-_e/2;var kt,ft,Et=ke._offset,mt=Ee._offset;return He+=Et-_e,$t+=mt-Le,kt=(Ue+=Et)+_e<we&&Ue>=0?Ue:He+_e<we&&He>=0?He:Et+_e<we?Et:Ue-Pe<Pe-He+_e?we-_e:0,kt+=L,ft=(Qt+=mt)+Le<Me&&Qt>=0?Qt:$t+Le<Me&&$t>=0?$t:mt+Le<Me?mt:Qt-Xe<Xe-$t+Le?Me-Le:0,ft+=L,Be.attr("transform",e(kt-1,ft-1)),Be}var It=ae.selectAll("g.hovertext").data(B,function(vt){return M(vt)});return It.enter().append("g").classed("hovertext",!0).each(function(){var vt=t.select(this);vt.append("rect").call(a.fill,a.addOpacity(ie,.8)),vt.append("text").classed("name",!0),vt.append("path").style("stroke-width","1px"),vt.append("text").classed("nums",!0).call(o.font,de,ce)}),It.exit().remove(),It.each(function(vt){var nt=t.select(this).attr("transform",""),At=vt.color;Array.isArray(At)&&(At=At[vt.eventData[0].pointNumber]);var Ft=vt.bgcolor||At,Nt=a.combine(a.opacity(Ft)?Ft:a.defaultLine,ie),Kt=a.combine(a.opacity(At)?At:a.defaultLine,ie),Ie=vt.borderColor||a.contrast(Nt),ot=F(vt,Se,$,J,xe,nt),bt=ot[0],Pt=ot[1],Vt=nt.select("text.nums").call(o.font,vt.fontFamily||de,vt.fontSize||ce,vt.fontColor||Ie).text(bt).attr("data-notex",1).call(i.positionText,0,0).call(i.convertToTspans,ee),nr=nt.select("text.name"),Yt=0,Xt=0;if(Pt&&Pt!==bt){nr.call(o.font,vt.fontFamily||de,vt.fontSize||ce,Kt).text(Pt).attr("data-notex",1).call(i.positionText,0,0).call(i.convertToTspans,ee);var ar=D(ee,nr.node());Yt=ar.width+2*L,Xt=ar.height+2*L}else nr.remove(),nt.select("rect").remove();nt.select("path").style({fill:Nt,stroke:Ie});var hr=vt.xa._offset+(vt.x0+vt.x1)/2,mr=vt.ya._offset+(vt.y0+vt.y1)/2,sr=Math.abs(vt.x1-vt.x0),fr=Math.abs(vt.y1-vt.y0),yr=D(ee,Vt.node()),zr=yr.width/J._invScaleX,xr=yr.height/J._invScaleY;vt.ty0=(me-yr.top)/J._invScaleY,vt.bx=zr+2*L,vt.by=Math.max(xr+2*L,Xt),vt.anchor="start",vt.txwidth=zr,vt.tx2width=Yt,vt.offset=0;var Br,Jr,fn=(zr+w+L+Yt)*J._invScaleX;if(te)vt.pos=hr,Br=mr+fr/2+fn<=Me,Jr=mr-fr/2-fn>=0,vt.idealAlign!=="top"&&Br||!Jr?Br?(mr+=fr/2,vt.anchor="start"):vt.anchor="middle":(mr-=fr/2,vt.anchor="end");else if(vt.pos=mr,Br=hr+sr/2+fn<=we,Jr=hr-sr/2-fn>=0,vt.idealAlign!=="left"&&Br||!Jr)if(Br)hr+=sr/2,vt.anchor="start";else{vt.anchor="middle";var Cn=fn/2,Pn=hr+Cn-we,An=hr-Cn;Pn>0&&(hr-=Pn),An<0&&(hr+=-An)}else hr-=sr/2,vt.anchor="end";Vt.attr("text-anchor",vt.anchor),Yt&&nr.attr("text-anchor",vt.anchor),nt.attr("transform",e(hr,mr)+(te?f(_):""))}),It}function F(B,q,ee,J,$,te){var ie="",ae="";B.nameOverride!==void 0&&(B.name=B.nameOverride),B.name&&(B.trace._meta&&(B.name=p.templateString(B.name,B.trace._meta)),ie=X(B.name,B.nameLength));var he=ee.charAt(0),se=he==="x"?"y":"x";B.zLabel!==void 0?(B.xLabel!==void 0&&(ae+="x: "+B.xLabel+"<br>"),B.yLabel!==void 0&&(ae+="y: "+B.yLabel+"<br>"),B.trace.type!=="choropleth"&&B.trace.type!=="choroplethmapbox"&&(ae+=(ae?"z: ":"")+B.zLabel)):q&&B[he+"Label"]===$?ae=B[se+"Label"]||"":B.xLabel===void 0?B.yLabel!==void 0&&B.trace.type!=="scattercarpet"&&(ae=B.yLabel):ae=B.yLabel===void 0?B.xLabel:"("+B.xLabel+", "+B.yLabel+")",!B.text&&B.text!==0||Array.isArray(B.text)||(ae+=(ae?"<br>":"")+B.text),B.extraText!==void 0&&(ae+=(ae?"<br>":"")+B.extraText),te&&ae===""&&!B.hovertemplate&&(ie===""&&te.remove(),ae=ie);var de=B.hovertemplate||!1;if(de){var ce=B.hovertemplateLabels||B;B[he+"Label"]!==$&&(ce[he+"other"]=ce[he+"Val"],ce[he+"otherLabel"]=ce[he+"Label"]),ae=(ae=p.hovertemplateString(de,ce,J._d3locale,B.eventData[0]||{},B.trace._meta)).replace(P,function(ve,ke){return ie=X(ke,B.nameLength),""})}return[ae,ie]}function j(B,q,ee,J){var $=function(ie){return ie*ee},te=function(ie){return ie*J};B.each(function(ie){var ae=t.select(this);if(ie.del)return ae.remove();var he=ae.select("text.nums"),se=ie.anchor,de=se==="end"?-1:1,ce={start:1,end:-1,middle:0}[se],ve=ce*(w+L),ke=ve+ce*(ie.txwidth+L),Ee=0,be=ie.offset,xe=se==="middle";xe&&(ve-=ie.tx2width/2,ke+=ie.txwidth/2+L),q&&(be*=-S,Ee=ie.offset*A),ae.select("path").attr("d",xe?"M-"+$(ie.bx/2+ie.tx2width/2)+","+te(be-ie.by/2)+"h"+$(ie.bx)+"v"+te(ie.by)+"h-"+$(ie.bx)+"Z":"M0,0L"+$(de*w+Ee)+","+te(w+be)+"v"+te(ie.by/2-w)+"h"+$(de*ie.bx)+"v-"+te(ie.by)+"H"+$(de*w+Ee)+"V"+te(be-w)+"Z");var ue=Ee+ve,me=be+ie.ty0-ie.by/2+L,we=ie.textAlign||"auto";we!=="auto"&&(we==="left"&&se!=="start"?(he.attr("text-anchor","start"),ue=xe?-ie.bx/2-ie.tx2width/2+L:-ie.bx-L):we==="right"&&se!=="end"&&(he.attr("text-anchor","end"),ue=xe?ie.bx/2-ie.tx2width/2-L:ie.bx+L)),he.call(i.positionText,$(ue),te(me)),ie.tx2width&&(ae.select("text.name").call(i.positionText,$(ke+ce*L+Ee),te(be+ie.ty0-ie.by/2+L)),ae.select("rect").call(o.setRect,$(ke+(ce-1)*ie.tx2width/2+Ee),te(be-ie.by/2-1),$(ie.tx2width),te(ie.by+2)))})}function W(B,q){var ee=B.index,J=B.trace||{},$=B.cd[0],te=B.cd[ee]||{};function ie(ve){return ve||m(ve)&&ve===0}var ae=Array.isArray(ee)?function(ve,ke){var Ee=p.castOption($,ee,ve);return ie(Ee)?Ee:p.extractOption({},J,"",ke)}:function(ve,ke){return p.extractOption(te,J,ve,ke)};function he(ve,ke,Ee){var be=ae(ke,Ee);ie(be)&&(B[ve]=be)}if(he("hoverinfo","hi","hoverinfo"),he("bgcolor","hbg","hoverlabel.bgcolor"),he("borderColor","hbc","hoverlabel.bordercolor"),he("fontFamily","htf","hoverlabel.font.family"),he("fontSize","hts","hoverlabel.font.size"),he("fontColor","htc","hoverlabel.font.color"),he("nameLength","hnl","hoverlabel.namelength"),he("textAlign","hta","hoverlabel.align"),B.posref=q==="y"||q==="closest"&&J.orientation==="h"?B.xa._offset+(B.x0+B.x1)/2:B.ya._offset+(B.y0+B.y1)/2,B.x0=p.constrain(B.x0,0,B.xa._length),B.x1=p.constrain(B.x1,0,B.xa._length),B.y0=p.constrain(B.y0,0,B.ya._length),B.y1=p.constrain(B.y1,0,B.ya._length),B.xLabelVal!==void 0&&(B.xLabel="xLabel"in B?B.xLabel:r.hoverLabelText(B.xa,B.xLabelVal,J.xhoverformat),B.xVal=B.xa.c2d(B.xLabelVal)),B.yLabelVal!==void 0&&(B.yLabel="yLabel"in B?B.yLabel:r.hoverLabelText(B.ya,B.yLabelVal,J.yhoverformat),B.yVal=B.ya.c2d(B.yLabelVal)),B.zLabelVal!==void 0&&B.zLabel===void 0&&(B.zLabel=String(B.zLabelVal)),!(isNaN(B.xerr)||B.xa.type==="log"&&B.xerr<=0)){var se=r.tickText(B.xa,B.xa.c2l(B.xerr),"hover").text;B.xerrneg!==void 0?B.xLabel+=" +"+se+" / -"+r.tickText(B.xa,B.xa.c2l(B.xerrneg),"hover").text:B.xLabel+=" \xB1 "+se,q==="x"&&(B.distance+=1)}if(!(isNaN(B.yerr)||B.ya.type==="log"&&B.yerr<=0)){var de=r.tickText(B.ya,B.ya.c2l(B.yerr),"hover").text;B.yerrneg!==void 0?B.yLabel+=" +"+de+" / -"+r.tickText(B.ya,B.ya.c2l(B.yerrneg),"hover").text:B.yLabel+=" \xB1 "+de,q==="y"&&(B.distance+=1)}var ce=B.hoverinfo||B.trace.hoverinfo;return ce&&ce!=="all"&&((ce=Array.isArray(ce)?ce:ce.split("+")).indexOf("x")===-1&&(B.xLabel=void 0),ce.indexOf("y")===-1&&(B.yLabel=void 0),ce.indexOf("z")===-1&&(B.zLabel=void 0),ce.indexOf("text")===-1&&(B.text=void 0),ce.indexOf("name")===-1&&(B.name=void 0)),B}function Z(B,q,ee){var J,$,te=ee.container,ie=ee.fullLayout,ae=ie._size,he=ee.event,se=!!q.hLinePoint,de=!!q.vLinePoint;if(te.selectAll(".spikeline").remove(),de||se){var ce=a.combine(ie.plot_bgcolor,ie.paper_bgcolor);if(se){var ve,ke,Ee=q.hLinePoint;J=Ee&&Ee.xa,($=Ee&&Ee.ya).spikesnap==="cursor"?(ve=he.pointerX,ke=he.pointerY):(ve=J._offset+Ee.x,ke=$._offset+Ee.y);var be,xe,ue=g.readability(Ee.color,ce)<1.5?a.contrast(ce):Ee.color,me=$.spikemode,we=$.spikethickness,Me=$.spikecolor||ue,Se=r.getPxPosition(B,$);if(me.indexOf("toaxis")!==-1||me.indexOf("across")!==-1){if(me.indexOf("toaxis")!==-1&&(be=Se,xe=ve),me.indexOf("across")!==-1){var De=$._counterDomainMin,Fe=$._counterDomainMax;$.anchor==="free"&&(De=Math.min(De,$.position),Fe=Math.max(Fe,$.position)),be=ae.l+De*ae.w,xe=ae.l+Fe*ae.w}te.insert("line",":first-child").attr({x1:be,x2:xe,y1:ke,y2:ke,"stroke-width":we,stroke:Me,"stroke-dasharray":o.dashStyle($.spikedash,we)}).classed("spikeline",!0).classed("crisp",!0),te.insert("line",":first-child").attr({x1:be,x2:xe,y1:ke,y2:ke,"stroke-width":we+2,stroke:ce}).classed("spikeline",!0).classed("crisp",!0)}me.indexOf("marker")!==-1&&te.insert("circle",":first-child").attr({cx:Se+($.side!=="right"?we:-we),cy:ke,r:we,fill:Me}).classed("spikeline",!0)}if(de){var Ye,et,Oe=q.vLinePoint;J=Oe&&Oe.xa,$=Oe&&Oe.ya,J.spikesnap==="cursor"?(Ye=he.pointerX,et=he.pointerY):(Ye=J._offset+Oe.x,et=$._offset+Oe.y);var je,We,Ge=g.readability(Oe.color,ce)<1.5?a.contrast(ce):Oe.color,Qe=J.spikemode,it=J.spikethickness,lt=J.spikecolor||Ge,Lt=r.getPxPosition(B,J);if(Qe.indexOf("toaxis")!==-1||Qe.indexOf("across")!==-1){if(Qe.indexOf("toaxis")!==-1&&(je=Lt,We=et),Qe.indexOf("across")!==-1){var wt=J._counterDomainMin,rt=J._counterDomainMax;J.anchor==="free"&&(wt=Math.min(wt,J.position),rt=Math.max(rt,J.position)),je=ae.t+(1-rt)*ae.h,We=ae.t+(1-wt)*ae.h}te.insert("line",":first-child").attr({x1:Ye,x2:Ye,y1:je,y2:We,"stroke-width":it,stroke:lt,"stroke-dasharray":o.dashStyle(J.spikedash,it)}).classed("spikeline",!0).classed("crisp",!0),te.insert("line",":first-child").attr({x1:Ye,x2:Ye,y1:je,y2:We,"stroke-width":it+2,stroke:ce}).classed("spikeline",!0).classed("crisp",!0)}Qe.indexOf("marker")!==-1&&te.insert("circle",":first-child").attr({cx:Ye,cy:Lt-(J.side!=="top"?it:-it),r:it,fill:lt}).classed("spikeline",!0)}}}function Q(B,q){return!q||q.vLinePoint!==B._spikepoints.vLinePoint||q.hLinePoint!==B._spikepoints.hLinePoint}function X(B,q){return i.plainText(B||"",{len:q,allowedTags:["br","sub","sup","b","i","em"]})}function G(B,q,ee){var J=q[B+"a"],$=q[B+"Val"],te=q.cd[0];if(J.type==="category")$=J._categoriesMap[$];else if(J.type==="date"){var ie=q.trace[B+"periodalignment"];if(ie){var ae=q.cd[q.index],he=ae[B+"Start"];he===void 0&&(he=ae[B]);var se=ae[B+"End"];se===void 0&&(se=ae[B]);var de=se-he;ie==="end"?$+=de:ie==="middle"&&($+=de/2)}$=J.d2c($)}return te&&te.t&&te.t.posLetter===J._id&&(ee.boxmode!=="group"&&ee.violinmode!=="group"||($+=te.t.dPos)),$}function Y(B){return B.offsetTop+B.clientTop}function K(B){return B.offsetLeft+B.clientLeft}function D(B,q){var ee=B._fullLayout,J=q.getBoundingClientRect(),$=J.x,te=J.y,ie=$+J.width,ae=te+J.height,he=p.apply3DTransform(ee._invTransform)($,te),se=p.apply3DTransform(ee._invTransform)(ie,ae),de=he[0],ce=he[1],ve=se[0],ke=se[1];return{x:de,y:ce,width:ve-de,height:ke-ce,top:Math.min(ce,ke),left:Math.min(de,ve),right:Math.max(de,ve),bottom:Math.max(ce,ke)}}},{"../../lib":787,"../../lib/events":776,"../../lib/override_cursor":798,"../../lib/svg_text_utils":813,"../../plots/cartesian/axes":838,"../../registry":915,"../color":650,"../dragelement":669,"../drawing":672,"../legend/defaults":702,"../legend/draw":703,"./constants":684,"./helpers":686,"@plotly/d3":58,"fast-isnumeric":246,tinycolor2:583}],688:[function(h,N,H){var t=h("../../lib"),m=h("../color"),g=h("./helpers").isUnifiedHover;N.exports=function(p,e,f,u){function i(s){u.font[s]||(u.font[s]=e.legend?e.legend.font[s]:e.font[s])}u=u||{},e&&g(e.hovermode)&&(u.font||(u.font={}),i("size"),i("family"),i("color"),e.legend?(u.bgcolor||(u.bgcolor=m.combine(e.legend.bgcolor,e.paper_bgcolor)),u.bordercolor||(u.bordercolor=e.legend.bordercolor)):u.bgcolor||(u.bgcolor=e.paper_bgcolor)),f("hoverlabel.bgcolor",u.bgcolor),f("hoverlabel.bordercolor",u.bordercolor),f("hoverlabel.namelength",u.namelength),t.coerceFont(f,"hoverlabel.font",u.font),f("hoverlabel.align",u.align)}},{"../../lib":787,"../color":650,"./helpers":686}],689:[function(h,N,H){var t=h("../../lib"),m=h("./layout_attributes");N.exports=function(g,p){function e(f,u){return p[f]!==void 0?p[f]:t.coerce(g,p,m,f,u)}return e("clickmode"),e("hovermode")}},{"../../lib":787,"./layout_attributes":691}],690:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../lib"),g=h("../dragelement"),p=h("./helpers"),e=h("./layout_attributes"),f=h("./hover");N.exports={moduleType:"component",name:"fx",constants:h("./constants"),schema:{layout:e},attributes:h("./attributes"),layoutAttributes:e,supplyLayoutGlobalDefaults:h("./layout_global_defaults"),supplyDefaults:h("./defaults"),supplyLayoutDefaults:h("./layout_defaults"),calc:h("./calc"),getDistanceFunction:p.getDistanceFunction,getClosest:p.getClosest,inbox:p.inbox,quadrature:p.quadrature,appendArrayPointValue:p.appendArrayPointValue,castHoverOption:function(u,i,s){return m.castOption(u,i,"hoverlabel."+s)},castHoverinfo:function(u,i,s){return m.castOption(u,s,"hoverinfo",function(o){return m.coerceHoverinfo({hoverinfo:o},{_module:u._module},i)})},hover:f.hover,unhover:g.unhover,loneHover:f.loneHover,loneUnhover:function(u){var i=m.isD3Selection(u)?u:t.select(u);i.selectAll("g.hovertext").remove(),i.selectAll(".spikeline").remove()},click:h("./click")}},{"../../lib":787,"../dragelement":669,"./attributes":681,"./calc":682,"./click":683,"./constants":684,"./defaults":685,"./helpers":686,"./hover":687,"./layout_attributes":691,"./layout_defaults":692,"./layout_global_defaults":693,"@plotly/d3":58}],691:[function(h,N,H){var t=h("./constants"),m=h("../../plots/font_attributes")({editType:"none"});m.family.dflt=t.HOVERFONT,m.size.dflt=t.HOVERFONTSIZE,N.exports={clickmode:{valType:"flaglist",flags:["event","select"],dflt:"event",editType:"plot",extras:["none"]},dragmode:{valType:"enumerated",values:["zoom","pan","select","lasso","drawclosedpath","drawopenpath","drawline","drawrect","drawcircle","orbit","turntable",!1],dflt:"zoom",editType:"modebar"},hovermode:{valType:"enumerated",values:["x","y","closest",!1,"x unified","y unified"],dflt:"closest",editType:"modebar"},hoverdistance:{valType:"integer",min:-1,dflt:20,editType:"none"},spikedistance:{valType:"integer",min:-1,dflt:-1,editType:"none"},hoverlabel:{bgcolor:{valType:"color",editType:"none"},bordercolor:{valType:"color",editType:"none"},font:m,align:{valType:"enumerated",values:["left","right","auto"],dflt:"auto",editType:"none"},namelength:{valType:"integer",min:-1,dflt:15,editType:"none"},editType:"none"},selectdirection:{valType:"enumerated",values:["h","v","d","any"],dflt:"any",editType:"none"}}},{"../../plots/font_attributes":867,"./constants":684}],692:[function(h,N,H){var t=h("../../lib"),m=h("./layout_attributes"),g=h("./hovermode_defaults"),p=h("./hoverlabel_defaults");N.exports=function(e,f){function u(a,c){return t.coerce(e,f,m,a,c)}g(e,f)&&(u("hoverdistance"),u("spikedistance")),u("dragmode")==="select"&&u("selectdirection");var i=f._has("mapbox"),s=f._has("geo"),o=f._basePlotModules.length;f.dragmode==="zoom"&&((i||s)&&o===1||i&&s&&o===2)&&(f.dragmode="pan"),p(e,f,u)}},{"../../lib":787,"./hoverlabel_defaults":688,"./hovermode_defaults":689,"./layout_attributes":691}],693:[function(h,N,H){var t=h("../../lib"),m=h("./hoverlabel_defaults"),g=h("./layout_attributes");N.exports=function(p,e){m(p,e,function(f,u){return t.coerce(p,e,g,f,u)})}},{"../../lib":787,"./hoverlabel_defaults":688,"./layout_attributes":691}],694:[function(h,N,H){var t=h("../../lib"),m=h("../../lib/regex").counter,g=h("../../plots/domain").attributes,p=h("../../plots/cartesian/constants").idRegex,e=h("../../plot_api/plot_template"),f={rows:{valType:"integer",min:1,editType:"plot"},roworder:{valType:"enumerated",values:["top to bottom","bottom to top"],dflt:"top to bottom",editType:"plot"},columns:{valType:"integer",min:1,editType:"plot"},subplots:{valType:"info_array",freeLength:!0,dimensions:2,items:{valType:"enumerated",values:[m("xy").toString(),""],editType:"plot"},editType:"plot"},xaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[p.x.toString(),""],editType:"plot"},editType:"plot"},yaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[p.y.toString(),""],editType:"plot"},editType:"plot"},pattern:{valType:"enumerated",values:["independent","coupled"],dflt:"coupled",editType:"plot"},xgap:{valType:"number",min:0,max:1,editType:"plot"},ygap:{valType:"number",min:0,max:1,editType:"plot"},domain:g({name:"grid",editType:"plot",noGridCell:!0},{}),xside:{valType:"enumerated",values:["bottom","bottom plot","top plot","top"],dflt:"bottom plot",editType:"plot"},yside:{valType:"enumerated",values:["left","left plot","right plot","right"],dflt:"left plot",editType:"plot"},editType:"plot"};function u(o,a,c){var r=a[c+"axes"],n=Object.keys((o._splomAxes||{})[c]||{});return Array.isArray(r)?r:n.length?n:void 0}function i(o,a,c,r,n,d){var l=a(o+"gap",c),y=a("domain."+o);a(o+"side",r);for(var v=new Array(n),_=y[0],x=(y[1]-_)/(n-l),T=x*(1-l),A=0;A<n;A++){var S=_+x*A;v[d?n-1-A:A]=[S,S+T]}return v}function s(o,a,c,r,n){var d,l=new Array(c);function y(v,_){a.indexOf(_)!==-1&&r[_]===void 0?(l[v]=_,r[_]=v):l[v]=""}if(Array.isArray(o))for(d=0;d<c;d++)y(d,o[d]);else for(y(0,n),d=1;d<c;d++)y(d,n+(d+1));return l}N.exports={moduleType:"component",name:"grid",schema:{layout:{grid:f}},layoutAttributes:f,sizeDefaults:function(o,a){var c=o.grid||{},r=u(a,c,"x"),n=u(a,c,"y");if(o.grid||r||n){var d,l,y=Array.isArray(c.subplots)&&Array.isArray(c.subplots[0]),v=Array.isArray(r),_=Array.isArray(n),x=v&&r!==c.xaxes&&_&&n!==c.yaxes;y?(d=c.subplots.length,l=c.subplots[0].length):(_&&(d=n.length),v&&(l=r.length));var T=e.newContainer(a,"grid"),A=P("rows",d),S=P("columns",l);if(A*S>1){!y&&!v&&!_&&P("pattern")==="independent"&&(y=!0),T._hasSubplotGrid=y;var w,L,k=P("roworder")==="top to bottom",C=y?.2:.1,M=y?.3:.1;x&&a._splomGridDflt&&(w=a._splomGridDflt.xside,L=a._splomGridDflt.yside),T._domains={x:i("x",P,C,w,S),y:i("y",P,M,L,A,k)}}else delete a.grid}function P(O,F){return t.coerce(c,T,f,O,F)}},contentDefaults:function(o,a){var c=a.grid;if(c&&c._domains){var r,n,d,l,y,v,_,x=o.grid||{},T=a._subplots,A=c._hasSubplotGrid,S=c.rows,w=c.columns,L=c.pattern==="independent",k=c._axisMap={};if(A){var C=x.subplots||[];v=c.subplots=new Array(S);var M=1;for(r=0;r<S;r++){var P=v[r]=new Array(w),O=C[r]||[];for(n=0;n<w;n++)if(L?(y=M===1?"xy":"x"+M+"y"+M,M++):y=O[n],P[n]="",T.cartesian.indexOf(y)!==-1){if(_=y.indexOf("y"),d=y.slice(0,_),l=y.slice(_),k[d]!==void 0&&k[d]!==n||k[l]!==void 0&&k[l]!==r)continue;P[n]=y,k[d]=n,k[l]=r}}}else{var F=u(a,x,"x"),j=u(a,x,"y");c.xaxes=s(F,T.xaxis,w,k,"x"),c.yaxes=s(j,T.yaxis,S,k,"y")}var W=c._anchors={},Z=c.roworder==="top to bottom";for(var Q in k){var X,G,Y,K=Q.charAt(0),D=c[K+"side"];if(D.length<8)W[Q]="free";else if(K==="x"){if(D.charAt(0)==="t"===Z?(X=0,G=1,Y=S):(X=S-1,G=-1,Y=-1),A){var B=k[Q];for(r=X;r!==Y;r+=G)if((y=v[r][B])&&(_=y.indexOf("y"),y.slice(0,_)===Q)){W[Q]=y.slice(_);break}}else for(r=X;r!==Y;r+=G)if(l=c.yaxes[r],T.cartesian.indexOf(Q+l)!==-1){W[Q]=l;break}}else if(D.charAt(0)==="l"?(X=0,G=1,Y=w):(X=w-1,G=-1,Y=-1),A){var q=k[Q];for(r=X;r!==Y;r+=G)if((y=v[q][r])&&(_=y.indexOf("y"),y.slice(_)===Q)){W[Q]=y.slice(0,_);break}}else for(r=X;r!==Y;r+=G)if(d=c.xaxes[r],T.cartesian.indexOf(d+Q)!==-1){W[Q]=d;break}}}}}},{"../../lib":787,"../../lib/regex":804,"../../plot_api/plot_template":827,"../../plots/cartesian/constants":845,"../../plots/domain":866}],695:[function(h,N,H){var t=h("../../plots/cartesian/constants"),m=h("../../plot_api/plot_template").templatedArray;h("../../constants/axis_placeable_objects"),N.exports=m("image",{visible:{valType:"boolean",dflt:!0,editType:"arraydraw"},source:{valType:"string",editType:"arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},sizex:{valType:"number",dflt:0,editType:"arraydraw"},sizey:{valType:"number",dflt:0,editType:"arraydraw"},sizing:{valType:"enumerated",values:["fill","contain","stretch"],dflt:"contain",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},x:{valType:"any",dflt:0,editType:"arraydraw"},y:{valType:"any",dflt:0,editType:"arraydraw"},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left",editType:"arraydraw"},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"top",editType:"arraydraw"},xref:{valType:"enumerated",values:["paper",t.idRegex.x.toString()],dflt:"paper",editType:"arraydraw"},yref:{valType:"enumerated",values:["paper",t.idRegex.y.toString()],dflt:"paper",editType:"arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":756,"../../plot_api/plot_template":827,"../../plots/cartesian/constants":845}],696:[function(h,N,H){var t=h("fast-isnumeric"),m=h("../../lib/to_log_range");N.exports=function(g,p,e,f){p=p||{};var u=e==="log"&&p.type==="linear",i=e==="linear"&&p.type==="log";if(u||i){for(var s,o,a=g._fullLayout.images,c=p._id.charAt(0),r=0;r<a.length;r++)if(o="images["+r+"].",(s=a[r])[c+"ref"]===p._id){var n=s[c],d=s["size"+c],l=null,y=null;if(u){l=m(n,p.range);var v=d/Math.pow(10,l)/2;y=2*Math.log(v+Math.sqrt(1+v*v))/Math.LN10}else y=(l=Math.pow(10,n))*(Math.pow(10,d/2)-Math.pow(10,-d/2));t(l)?t(y)||(y=null):(l=null,y=null),f(o+c,l),f(o+"size"+c,y)}}}},{"../../lib/to_log_range":815,"fast-isnumeric":246}],697:[function(h,N,H){var t=h("../../lib"),m=h("../../plots/cartesian/axes"),g=h("../../plots/array_container_defaults"),p=h("./attributes");function e(f,u,i){function s(l,y){return t.coerce(f,u,p,l,y)}var o=s("source");if(!s("visible",!!o))return u;s("layer"),s("xanchor"),s("yanchor"),s("sizex"),s("sizey"),s("sizing"),s("opacity");for(var a={_fullLayout:i},c=["x","y"],r=0;r<2;r++){var n=c[r],d=m.coerceRef(f,u,a,n,"paper",void 0);d!=="paper"&&m.getFromId(a,d)._imgIndices.push(u._index),m.coercePosition(u,a,s,d,n,0)}return u}N.exports=function(f,u){g(f,u,{name:"images",handleItemDefaults:e})}},{"../../lib":787,"../../plots/array_container_defaults":833,"../../plots/cartesian/axes":838,"./attributes":695}],698:[function(h,N,H){var t=h("@plotly/d3"),m=h("../drawing"),g=h("../../plots/cartesian/axes"),p=h("../../plots/cartesian/axis_ids"),e=h("../../constants/xmlns_namespaces");N.exports=function(f){var u,i,s=f._fullLayout,o=[],a={},c=[];for(i=0;i<s.images.length;i++){var r=s.images[i];if(r.visible)if(r.layer==="below"&&r.xref!=="paper"&&r.yref!=="paper"){u=p.ref2id(r.xref)+p.ref2id(r.yref);var n=s._plots[u];if(!n){c.push(r);continue}n.mainplot&&(u=n.mainplot.id),a[u]||(a[u]=[]),a[u].push(r)}else r.layer==="above"?o.push(r):c.push(r)}var d={left:{sizing:"xMin",offset:0},center:{sizing:"xMid",offset:-.5},right:{sizing:"xMax",offset:-1}},l={top:{sizing:"YMin",offset:0},middle:{sizing:"YMid",offset:-.5},bottom:{sizing:"YMax",offset:-1}};function y(w){var L=t.select(this);if(this._imgSrc!==w.source)if(L.attr("xmlns",e.svg),w.source&&w.source.slice(0,5)==="data:")L.attr("xlink:href",w.source),this._imgSrc=w.source;else{var k=new Promise(function(C){var M=new Image;function P(){L.remove(),C()}this.img=M,M.setAttribute("crossOrigin","anonymous"),M.onerror=P,M.onload=function(){var O=document.createElement("canvas");O.width=this.width,O.height=this.height,O.getContext("2d").drawImage(this,0,0);var F=O.toDataURL("image/png");L.attr("xlink:href",F),C()},L.on("error",P),M.src=w.source,this._imgSrc=w.source}.bind(this));f._promises.push(k)}}function v(w){var L,k,C=t.select(this),M=g.getFromId(f,w.xref),P=g.getFromId(f,w.yref),O=g.getRefType(w.xref)==="domain",F=g.getRefType(w.yref)==="domain",j=s._size;L=M!==void 0?typeof w.xref=="string"&&O?M._length*w.sizex:Math.abs(M.l2p(w.sizex)-M.l2p(0)):w.sizex*j.w,k=P!==void 0?typeof w.yref=="string"&&F?P._length*w.sizey:Math.abs(P.l2p(w.sizey)-P.l2p(0)):w.sizey*j.h;var W,Z,Q=L*d[w.xanchor].offset,X=k*l[w.yanchor].offset,G=d[w.xanchor].sizing+l[w.yanchor].sizing;switch(W=M!==void 0?typeof w.xref=="string"&&O?M._length*w.x+M._offset:M.r2p(w.x)+M._offset:w.x*j.w+j.l,W+=Q,Z=P!==void 0?typeof w.yref=="string"&&F?P._length*(1-w.y)+P._offset:P.r2p(w.y)+P._offset:j.h-w.y*j.h+j.t,Z+=X,w.sizing){case"fill":G+=" slice";break;case"stretch":G="none"}C.attr({x:W,y:Z,width:L,height:k,preserveAspectRatio:G,opacity:w.opacity});var Y=(M&&g.getRefType(w.xref)!=="domain"?M._id:"")+(P&&g.getRefType(w.yref)!=="domain"?P._id:"");m.setClipUrl(C,Y?"clip"+s._uid+Y:null,f)}var _=s._imageLowerLayer.selectAll("image").data(c),x=s._imageUpperLayer.selectAll("image").data(o);_.enter().append("image"),x.enter().append("image"),_.exit().remove(),x.exit().remove(),_.each(function(w){y.bind(this)(w),v.bind(this)(w)}),x.each(function(w){y.bind(this)(w),v.bind(this)(w)});var T=Object.keys(s._plots);for(i=0;i<T.length;i++){u=T[i];var A=s._plots[u];if(A.imagelayer){var S=A.imagelayer.selectAll("image").data(a[u]||[]);S.enter().append("image"),S.exit().remove(),S.each(function(w){y.bind(this)(w),v.bind(this)(w)})}}}},{"../../constants/xmlns_namespaces":764,"../../plots/cartesian/axes":838,"../../plots/cartesian/axis_ids":842,"../drawing":672,"@plotly/d3":58}],699:[function(h,N,H){N.exports={moduleType:"component",name:"images",layoutAttributes:h("./attributes"),supplyLayoutDefaults:h("./defaults"),includeBasePlot:h("../../plots/cartesian/include_components")("images"),draw:h("./draw"),convertCoords:h("./convert_coords")}},{"../../plots/cartesian/include_components":851,"./attributes":695,"./convert_coords":696,"./defaults":697,"./draw":698}],700:[function(h,N,H){var t=h("../../plots/font_attributes"),m=h("../color/attributes");N.exports={bgcolor:{valType:"color",editType:"legend"},bordercolor:{valType:"color",dflt:m.defaultLine,editType:"legend"},borderwidth:{valType:"number",min:0,dflt:0,editType:"legend"},font:t({editType:"legend"}),orientation:{valType:"enumerated",values:["v","h"],dflt:"v",editType:"legend"},traceorder:{valType:"flaglist",flags:["reversed","grouped"],extras:["normal"],editType:"legend"},tracegroupgap:{valType:"number",min:0,dflt:10,editType:"legend"},itemsizing:{valType:"enumerated",values:["trace","constant"],dflt:"trace",editType:"legend"},itemwidth:{valType:"number",min:30,dflt:30,editType:"legend"},itemclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggle",editType:"legend"},itemdoubleclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggleothers",editType:"legend"},groupclick:{valType:"enumerated",values:["toggleitem","togglegroup"],dflt:"togglegroup",editType:"legend"},x:{valType:"number",min:-2,max:3,editType:"legend"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"legend"},y:{valType:"number",min:-2,max:3,editType:"legend"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],editType:"legend"},uirevision:{valType:"any",editType:"none"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"legend"},title:{text:{valType:"string",dflt:"",editType:"legend"},font:t({editType:"legend"}),side:{valType:"enumerated",values:["top","left","top left"],editType:"legend"},editType:"legend"},editType:"legend"}},{"../../plots/font_attributes":867,"../color/attributes":649}],701:[function(h,N,H){N.exports={scrollBarWidth:6,scrollBarMinHeight:20,scrollBarColor:"#808BA4",scrollBarMargin:4,scrollBarEnterAttrs:{rx:20,ry:3,width:0,height:0},titlePad:2,itemGap:5}},{}],702:[function(h,N,H){var t=h("../../registry"),m=h("../../lib"),g=h("../../plot_api/plot_template"),p=h("./attributes"),e=h("../../plots/layout_attributes"),f=h("./helpers");N.exports=function(u,i,s){for(var o=u.legend||{},a=0,c=!1,r="normal",n=0;n<s.length;n++){var d=s[n];d.visible&&((d.showlegend||d._dfltShowLegend&&!(d._module&&d._module.attributes&&d._module.attributes.showlegend&&d._module.attributes.showlegend.dflt===!1))&&(a++,d.showlegend&&(c=!0,(t.traceIs(d,"pie-like")||d._input.showlegend===!0)&&a++)),(t.traceIs(d,"bar")&&i.barmode==="stack"||["tonextx","tonexty"].indexOf(d.fill)!==-1)&&(r=f.isGrouped({traceorder:r})?"grouped+reversed":"reversed"),d.legendgroup!==void 0&&d.legendgroup!==""&&(r=f.isReversed({traceorder:r})?"reversed+grouped":"grouped"))}var l=m.coerce(u,i,e,"showlegend",c&&a>1);if(l!==!1||o.uirevision){var y=g.newContainer(i,"legend");if(w("uirevision",i.uirevision),l!==!1){w("bgcolor",i.paper_bgcolor),w("bordercolor"),w("borderwidth");var v,_,x,T=m.coerceFont(w,"font",i.font),A=w("orientation")==="h";if(A?(v=0,t.getComponentMethod("rangeslider","isVisible")(u.xaxis)?(_=1.1,x="bottom"):(_=-.1,x="top")):(v=1.02,_=1,x="auto"),w("traceorder",r),f.isGrouped(i.legend)&&w("tracegroupgap"),w("itemsizing"),w("itemwidth"),w("itemclick"),w("itemdoubleclick"),w("groupclick"),w("x",v),w("xanchor"),w("y",_),w("yanchor",x),w("valign"),m.noneOrAll(o,y,["x","y"]),w("title.text")){w("title.side",A?"left":"top");var S=m.extendFlat({},T,{size:m.bigFont(T.size)});m.coerceFont(w,"title.font",S)}}}function w(L,k){return m.coerce(o,y,p,L,k)}}},{"../../lib":787,"../../plot_api/plot_template":827,"../../plots/layout_attributes":892,"../../registry":915,"./attributes":700,"./helpers":706}],703:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../lib"),g=h("../../plots/plots"),p=h("../../registry"),e=h("../../lib/events"),f=h("../dragelement"),u=h("../drawing"),i=h("../color"),s=h("../../lib/svg_text_utils"),o=h("./handle_click"),a=h("./constants"),c=h("../../constants/alignment"),r=c.LINE_SPACING,n=c.FROM_TL,d=c.FROM_BR,l=h("./get_legend_data"),y=h("./style"),v=h("./helpers");function _(k,C,M,P,O){var F=M.data()[0][0].trace,j={event:O,node:M.node(),curveNumber:F.index,expandedIndex:F._expandedIndex,data:k.data,layout:k.layout,frames:k._transitionData._frames,config:k._context,fullData:k._fullData,fullLayout:k._fullLayout};F._group&&(j.group=F._group),p.traceIs(F,"pie-like")&&(j.label=M.datum()[0].label),e.triggerHandler(k,"plotly_legendclick",j)!==!1&&(P===1?C._clickTimeout=setTimeout(function(){k._fullLayout&&o(M,k,P)},k._context.doubleClickDelay):P===2&&(C._clickTimeout&&clearTimeout(C._clickTimeout),k._legendMouseDownTime=0,e.triggerHandler(k,"plotly_legenddoubleclick",j)!==!1&&o(M,k,P)))}function x(k,C,M){var P,O,F=k.data()[0][0],j=F.trace,W=p.traceIs(j,"pie-like"),Z=!M._inHover&&C._context.edits.legendText&&!W,Q=M._maxNameLength;F.groupTitle?(P=F.groupTitle.text,O=F.groupTitle.font):(O=M.font,M.entries?P=F.text:(P=W?F.label:j.name,j._meta&&(P=m.templateString(P,j._meta))));var X=m.ensureSingle(k,"text","legendtext");X.attr("text-anchor","start").call(u.font,O).text(Z?T(P,Q):P);var G=M.itemwidth+2*a.itemGap;s.positionText(X,G,0),Z?X.call(s.makeEditable,{gd:C,text:P}).call(S,k,C,M).on("edit",function(Y){this.text(T(Y,Q)).call(S,k,C,M);var K=F.trace._fullInput||{},D={};if(p.hasTransform(K,"groupby")){var B=p.getTransformIndices(K,"groupby"),q=B[B.length-1],ee=m.keyedContainer(K,"transforms["+q+"].styles","target","value.name");ee.set(F.trace._group,Y),D=ee.constructUpdate()}else D.name=Y;return p.call("_guiRestyle",C,D,j.index)}):S(X,k,C,M)}function T(k,C){var M=Math.max(4,C);if(k&&k.trim().length>=M/2)return k;for(var P=M-(k=k||"").length;P>0;P--)k+=" ";return k}function A(k,C){var M,P=C._context.doubleClickDelay,O=1,F=m.ensureSingle(k,"rect","legendtoggle",function(j){C._context.staticPlot||j.style("cursor","pointer").attr("pointer-events","all"),j.call(i.fill,"rgba(0,0,0,0)")});C._context.staticPlot||(F.on("mousedown",function(){(M=new Date().getTime())-C._legendMouseDownTime<P?O+=1:(O=1,C._legendMouseDownTime=M)}),F.on("mouseup",function(){if(!C._dragged&&!C._editing){var j=C._fullLayout.legend;new Date().getTime()-C._legendMouseDownTime>P&&(O=Math.max(O-1,1)),_(C,j,k,O,t.event)}}))}function S(k,C,M,P,O){P._inHover&&k.attr("data-notex",!0),s.convertToTspans(k,M,function(){(function(F,j,W,Z){var Q=F.data()[0][0];if(!W._inHover&&Q&&!Q.trace.showlegend)return void F.remove();var X=F.select("g[class*=math-group]"),G=X.node();W||(W=j._fullLayout.legend);var Y,K=W.borderwidth;Y=Z===1?W.title.font:Q.groupTitle?Q.groupTitle.font:W.font;var D,B,q=Y.size*r;if(G){var ee=u.bBox(G);D=ee.height,B=ee.width,Z===1?u.setTranslate(X,K,K+.75*D):u.setTranslate(X,0,.25*D)}else{var J=F.select(Z===1?".legendtitletext":".legendtext"),$=s.lineCount(J),te=J.node();if(D=q*$,B=te?u.bBox(te).width:0,Z===1)W.title.side==="left"&&(B+=2*a.itemGap),s.positionText(J,K+a.titlePad,K+q);else{var ie=2*a.itemGap+W.itemwidth;Q.groupTitle&&(ie=a.itemGap,B-=W.itemwidth),s.positionText(J,ie,-q*(($-1)/2-.3))}}Z===1?(W._titleWidth=B,W._titleHeight=D):(Q.lineHeight=q,Q.height=Math.max(D,16)+3,Q.width=B)})(C,M,P,O)})}function w(k){return m.isRightAnchor(k)?"right":m.isCenterAnchor(k)?"center":"left"}function L(k){return m.isBottomAnchor(k)?"bottom":m.isMiddleAnchor(k)?"middle":"top"}N.exports=function(k,C){return C||(C=k._fullLayout.legend||{}),function(M,P){var O,F,j=M._fullLayout,W="legend"+j._uid,Z=P._inHover;if(Z?(O=P.layer,W+="-hover"):O=j._infolayer,!!O){if(M._legendMouseDownTime||(M._legendMouseDownTime=0),Z){if(!P.entries)return;F=l(P.entries,P)}else{if(!M.calcdata)return;F=j.showlegend&&l(M.calcdata,P)}var Q=j.hiddenlabels||[];if(!(Z||j.showlegend&&F.length))return O.selectAll(".legend").remove(),j._topdefs.select("#"+W).remove(),g.autoMargin(M,"legend");var X=m.ensureSingle(O,"g","legend",function($){Z||$.attr("pointer-events","all")}),G=m.ensureSingleById(j._topdefs,"clipPath",W,function($){$.append("rect")}),Y=m.ensureSingle(X,"rect","bg",function($){$.attr("shape-rendering","crispEdges")});Y.call(i.stroke,P.bordercolor).call(i.fill,P.bgcolor).style("stroke-width",P.borderwidth+"px");var K=m.ensureSingle(X,"g","scrollbox"),D=P.title;if(P._titleWidth=0,P._titleHeight=0,D.text){var B=m.ensureSingle(K,"text","legendtitletext");B.attr("text-anchor","start").call(u.font,D.font).text(D.text),S(B,K,M,P,1)}else K.selectAll(".legendtitletext").remove();var q=m.ensureSingle(X,"rect","scrollbar",function($){$.attr(a.scrollBarEnterAttrs).call(i.fill,a.scrollBarColor)}),ee=K.selectAll("g.groups").data(F);ee.enter().append("g").attr("class","groups"),ee.exit().remove();var J=ee.selectAll("g.traces").data(m.identity);J.enter().append("g").attr("class","traces"),J.exit().remove(),J.style("opacity",function($){var te=$[0].trace;return p.traceIs(te,"pie-like")?Q.indexOf($[0].label)!==-1?.5:1:te.visible==="legendonly"?.5:1}).each(function(){t.select(this).call(x,M,P)}).call(y,M,P).each(function(){Z||t.select(this).call(A,M)}),m.syncOrAsync([g.previousPromises,function(){return function($,te,ie,ae){var he=$._fullLayout;ae||(ae=he.legend);var se=he._size,de=v.isVertical(ae),ce=v.isGrouped(ae),ve=ae.borderwidth,ke=2*ve,Ee=a.itemGap,be=ae.itemwidth+2*Ee,xe=2*(ve+Ee),ue=L(ae),me=ae.y<0||ae.y===0&&ue==="top",we=ae.y>1||ae.y===1&&ue==="bottom",Me=ae.tracegroupgap;ae._maxHeight=Math.max(me||we?he.height/2:se.h,30);var Se=0;ae._width=0,ae._height=0;var De=function(Be){var Je=0,_e=0,Le=Be.title.side;return Le&&(Le.indexOf("left")!==-1&&(Je=Be._titleWidth),Le.indexOf("top")!==-1&&(_e=Be._titleHeight)),[Je,_e]}(ae);if(de)ie.each(function(Be){var Je=Be[0].height;u.setTranslate(this,ve+De[0],ve+De[1]+ae._height+Je/2+Ee),ae._height+=Je,ae._width=Math.max(ae._width,Be[0].width)}),Se=be+ae._width,ae._width+=Ee+be+ke,ae._height+=xe,ce&&(te.each(function(Be,Je){u.setTranslate(this,0,Je*ae.tracegroupgap)}),ae._height+=(ae._lgroupsLength-1)*ae.tracegroupgap);else{var Fe=w(ae),Ye=ae.x<0||ae.x===0&&Fe==="right",et=ae.x>1||ae.x===1&&Fe==="left",Oe=we||me,je=he.width/2;ae._maxWidth=Math.max(Ye?Oe&&Fe==="left"?se.l+se.w:je:et?Oe&&Fe==="right"?se.r+se.w:je:se.w,2*be);var We=0,Ge=0;ie.each(function(Be){var Je=Be[0].width+be;We=Math.max(We,Je),Ge+=Je}),Se=null;var Qe=0;if(ce){var it=0,lt=0,Lt=0;te.each(function(){var Be=0,Je=0;t.select(this).selectAll("g.traces").each(function(Le){var Ce=Le[0].height;u.setTranslate(this,De[0],De[1]+ve+Ee+Ce/2+Je),Je+=Ce,Be=Math.max(Be,be+Le[0].width)}),it=Math.max(it,Je);var _e=Be+Ee;_e+ve+lt>ae._maxWidth&&(Qe=Math.max(Qe,lt),lt=0,Lt+=it+Me,it=Je),u.setTranslate(this,lt,Lt),lt+=_e}),ae._width=Math.max(Qe,lt)+ve,ae._height=Lt+it+xe}else{var wt=ie.size(),rt=Ge+ke+(wt-1)*Ee<ae._maxWidth,$e=0,xt=0,Qt=0,$t=0;ie.each(function(Be){var Je=Be[0].height,_e=be+Be[0].width,Le=(rt?_e:We)+Ee;Le+ve+xt-Ee>=ae._maxWidth&&(Qe=Math.max(Qe,$t),xt=0,Qt+=$e,ae._height+=$e,$e=0),u.setTranslate(this,De[0]+ve+xt,De[1]+ve+Qt+Je/2+Ee),$t=xt+_e+Ee,xt+=Le,$e=Math.max($e,Je)}),rt?(ae._width=xt+ke,ae._height=$e+xe):(ae._width=Math.max(Qe,$t)+ke,ae._height+=$e+xe)}}ae._width=Math.ceil(Math.max(ae._width+De[0],ae._titleWidth+2*(ve+a.titlePad))),ae._height=Math.ceil(Math.max(ae._height+De[1],ae._titleHeight+2*(ve+a.itemGap))),ae._effHeight=Math.min(ae._height,ae._maxHeight);var Ue=$._context.edits,He=Ue.legendText||Ue.legendPosition;ie.each(function(Be){var Je=t.select(this).select(".legendtoggle"),_e=Be[0].height,Le=He?be:Se||be+Be[0].width;de||(Le+=Ee/2),u.setRect(Je,0,-_e/2,Le,_e)})}(M,ee,J,P)},function(){if(Z||!function(Oe){var je=Oe._fullLayout.legend,We=w(je),Ge=L(je);return g.autoMargin(Oe,"legend",{x:je.x,y:je.y,l:je._width*n[We],r:je._width*d[We],b:je._effHeight*d[Ge],t:je._effHeight*n[Ge]})}(M)){var $,te,ie,ae,he=j._size,se=P.borderwidth,de=he.l+he.w*P.x-n[w(P)]*P._width,ce=he.t+he.h*(1-P.y)-n[L(P)]*P._effHeight;if(!Z&&j.margin.autoexpand){var ve=de,ke=ce;de=m.constrain(de,0,j.width-P._width),ce=m.constrain(ce,0,j.height-P._effHeight),de!==ve&&m.log("Constrain legend.x to make legend fit inside graph"),ce!==ke&&m.log("Constrain legend.y to make legend fit inside graph")}if(Z||u.setTranslate(X,de,ce),q.on(".drag",null),X.on("wheel",null),Z||P._height<=P._maxHeight||M._context.staticPlot){var Ee=P._effHeight;Z&&(Ee=P._height),Y.attr({width:P._width-se,height:Ee-se,x:se/2,y:se/2}),u.setTranslate(K,0,0),G.select("rect").attr({width:P._width-2*se,height:Ee-2*se,x:se,y:se}),u.setClipUrl(K,W,M),u.setRect(q,0,0,0,0),delete P._scrollY}else{var be,xe,ue,me=Math.max(a.scrollBarMinHeight,P._effHeight*P._effHeight/P._height),we=P._effHeight-me-2*a.scrollBarMargin,Me=P._height-P._effHeight,Se=we/Me,De=Math.min(P._scrollY||0,Me);Y.attr({width:P._width-2*se+a.scrollBarWidth+a.scrollBarMargin,height:P._effHeight-se,x:se/2,y:se/2}),G.select("rect").attr({width:P._width-2*se+a.scrollBarWidth+a.scrollBarMargin,height:P._effHeight-2*se,x:se,y:se+De}),u.setClipUrl(K,W,M),et(De,me,Se),X.on("wheel",function(){et(De=m.constrain(P._scrollY+t.event.deltaY/we*Me,0,Me),me,Se),De!==0&&De!==Me&&t.event.preventDefault()});var Fe=t.behavior.drag().on("dragstart",function(){var Oe=t.event.sourceEvent;be=Oe.type==="touchstart"?Oe.changedTouches[0].clientY:Oe.clientY,ue=De}).on("drag",function(){var Oe=t.event.sourceEvent;Oe.buttons===2||Oe.ctrlKey||(xe=Oe.type==="touchmove"?Oe.changedTouches[0].clientY:Oe.clientY,et(De=function(je,We,Ge){var Qe=(Ge-We)/Se+je;return m.constrain(Qe,0,Me)}(ue,be,xe),me,Se))});q.call(Fe);var Ye=t.behavior.drag().on("dragstart",function(){var Oe=t.event.sourceEvent;Oe.type==="touchstart"&&(be=Oe.changedTouches[0].clientY,ue=De)}).on("drag",function(){var Oe=t.event.sourceEvent;Oe.type==="touchmove"&&(xe=Oe.changedTouches[0].clientY,et(De=function(je,We,Ge){var Qe=(We-Ge)/Se+je;return m.constrain(Qe,0,Me)}(ue,be,xe),me,Se))});K.call(Ye)}M._context.edits.legendPosition&&(X.classed("cursor-move",!0),f.init({element:X.node(),gd:M,prepFn:function(){var Oe=u.getTranslate(X);ie=Oe.x,ae=Oe.y},moveFn:function(Oe,je){var We=ie+Oe,Ge=ae+je;u.setTranslate(X,We,Ge),$=f.align(We,0,he.l,he.l+he.w,P.xanchor),te=f.align(Ge,0,he.t+he.h,he.t,P.yanchor)},doneFn:function(){$!==void 0&&te!==void 0&&p.call("_guiRelayout",M,{"legend.x":$,"legend.y":te})},clickFn:function(Oe,je){var We=O.selectAll("g.traces").filter(function(){var Ge=this.getBoundingClientRect();return je.clientX>=Ge.left&&je.clientX<=Ge.right&&je.clientY>=Ge.top&&je.clientY<=Ge.bottom});We.size()>0&&_(M,X,We,Oe,je)}}))}function et(Oe,je,We){P._scrollY=M._fullLayout.legend._scrollY=Oe,u.setTranslate(K,0,-Oe),u.setRect(q,P._width,a.scrollBarMargin+Oe*We,a.scrollBarWidth,je),G.select("rect").attr("y",se+Oe)}}],M)}}(k,C)}},{"../../constants/alignment":755,"../../lib":787,"../../lib/events":776,"../../lib/svg_text_utils":813,"../../plots/plots":901,"../../registry":915,"../color":650,"../dragelement":669,"../drawing":672,"./constants":701,"./get_legend_data":704,"./handle_click":705,"./helpers":706,"./style":708,"@plotly/d3":58}],704:[function(h,N,H){var t=h("../../registry"),m=h("./helpers");N.exports=function(g,p){var e,f,u=p._inHover,i=m.isGrouped(p),s=m.isReversed(p),o={},a=[],c=!1,r={},n=0,d=0;function l(j,W){if(j!==""&&m.isGrouped(p))a.indexOf(j)===-1?(a.push(j),c=!0,o[j]=[W]):o[j].push(W);else{var Z="~~i"+n;a.push(Z),o[Z]=[W],n++}}for(e=0;e<g.length;e++){var y=g[e],v=y[0],_=v.trace,x=_.legendgroup;if(u||_.visible&&_.showlegend)if(t.traceIs(_,"pie-like"))for(r[x]||(r[x]={}),f=0;f<y.length;f++){var T=y[f].label;r[x][T]||(l(x,{label:T,color:y[f].color,i:y[f].i,trace:_,pts:y[f].pts}),r[x][T]=!0,d=Math.max(d,(T||"").length))}else l(x,v),d=Math.max(d,(_.name||"").length)}if(!a.length)return[];var A=!c||!i,S=[];for(e=0;e<a.length;e++){var w=o[a[e]];A?S.push(w[0]):S.push(w)}for(A&&(S=[S]),e=0;e<S.length;e++){var L=1/0;for(f=0;f<S[e].length;f++){var k=S[e][f].trace.legendrank;L>k&&(L=k)}S[e][0]._groupMinRank=L,S[e][0]._preGroupSort=e}var C=function(j,W){return j.trace.legendrank-W.trace.legendrank||j._preSort-W._preSort};for(S.forEach(function(j,W){j[0]._preGroupSort=W}),S.sort(function(j,W){return j[0]._groupMinRank-W[0]._groupMinRank||j[0]._preGroupSort-W[0]._preGroupSort}),e=0;e<S.length;e++){S[e].forEach(function(j,W){j._preSort=W}),S[e].sort(C);var M=S[e][0].trace,P=null;for(f=0;f<S[e].length;f++){var O=S[e][f].trace.legendgrouptitle;if(O&&O.text){P=O,u&&(O.font=p._groupTitleFont);break}}if(s&&S[e].reverse(),P){var F=!1;for(f=0;f<S[e].length;f++)if(t.traceIs(S[e][f].trace,"pie-like")){F=!0;break}S[e].unshift({i:-1,groupTitle:P,noClick:F,trace:{showlegend:M.showlegend,legendgroup:M.legendgroup,visible:p.groupclick==="toggleitem"||M.visible}})}for(f=0;f<S[e].length;f++)S[e][f]=[S[e][f]]}return p._lgroupsLength=S.length,p._maxNameLength=d,S}},{"../../registry":915,"./helpers":706}],705:[function(h,N,H){var t=h("../../lib"),m=h("../../registry"),g=!0;N.exports=function(p,e,f){var u=e._fullLayout;if(!e._dragged&&!e._editing){var i,s=u.legend.itemclick,o=u.legend.itemdoubleclick,a=u.legend.groupclick;if(f===1&&s==="toggle"&&o==="toggleothers"&&g&&e.data&&e._context.showTips&&t.notifier(t._(e,"Double-click on legend to isolate one trace"),"long"),g=!1,f===1?i=s:f===2&&(i=o),i){var c=a==="togglegroup",r=u.hiddenlabels?u.hiddenlabels.slice():[],n=p.data()[0][0];if(!n.groupTitle||!n.noClick){var d,l,y,v,_,x=e._fullData,T=n.trace,A=T.legendgroup,S={},w=[],L=[],k=[];if(m.traceIs(T,"pie-like")){var C=n.label,M=r.indexOf(C);i==="toggle"?M===-1?r.push(C):r.splice(M,1):i==="toggleothers"&&(r=[],e.calcdata[0].forEach(function(q){C!==q.label&&r.push(q.label)}),e._fullLayout.hiddenlabels&&e._fullLayout.hiddenlabels.length===r.length&&M===-1&&(r=[])),m.call("_guiRelayout",e,"hiddenlabels",r)}else{var P,O=A&&A.length,F=[];if(O)for(d=0;d<x.length;d++)(P=x[d]).visible&&P.legendgroup===A&&F.push(d);if(i==="toggle"){var j;switch(T.visible){case!0:j="legendonly";break;case!1:j=!1;break;case"legendonly":j=!0}if(O)if(c)for(d=0;d<x.length;d++)x[d].visible!==!1&&x[d].legendgroup===A&&B(x[d],j);else B(T,j);else B(T,j)}else if(i==="toggleothers"){var W,Z,Q,X,G=!0;for(d=0;d<x.length;d++)if(W=x[d]===T,Q=x[d].showlegend!==!0,!(W||Q||(Z=O&&x[d].legendgroup===A)||x[d].visible!==!0||m.traceIs(x[d],"notLegendIsolatable"))){G=!1;break}for(d=0;d<x.length;d++)if(x[d].visible!==!1&&!m.traceIs(x[d],"notLegendIsolatable"))switch(T.visible){case"legendonly":B(x[d],!0);break;case!0:X=!!G||"legendonly",W=x[d]===T,Q=x[d].showlegend!==!0&&!x[d].legendgroup,Z=W||O&&x[d].legendgroup===A,B(x[d],!(!Z&&!Q)||X)}}for(d=0;d<L.length;d++)if(y=L[d]){var Y=y.constructUpdate(),K=Object.keys(Y);for(l=0;l<K.length;l++)v=K[l],(S[v]=S[v]||[])[k[d]]=Y[v]}for(_=Object.keys(S),d=0;d<_.length;d++)for(v=_[d],l=0;l<w.length;l++)S[v].hasOwnProperty(l)||(S[v][l]=void 0);m.call("_guiRestyle",e,S,w)}}}}function D(q,ee,J){var $=w.indexOf(q),te=S[ee];return te||(te=S[ee]=[]),w.indexOf(q)===-1&&(w.push(q),$=w.length-1),te[$]=J,$}function B(q,ee){if(!n.groupTitle||c){var J=q._fullInput;if(m.hasTransform(J,"groupby")){var $=L[J.index];if(!$){var te=m.getTransformIndices(J,"groupby"),ie=te[te.length-1];$=t.keyedContainer(J,"transforms["+ie+"].styles","target","value.visible"),L[J.index]=$}var ae=$.get(q._group);ae===void 0&&(ae=!0),ae!==!1&&$.set(q._group,ee),k[J.index]=D(J.index,"visible",J.visible!==!1)}else{var he=J.visible!==!1&&ee;D(J.index,"visible",he)}}}}},{"../../lib":787,"../../registry":915}],706:[function(h,N,H){H.isGrouped=function(t){return(t.traceorder||"").indexOf("grouped")!==-1},H.isVertical=function(t){return t.orientation!=="h"},H.isReversed=function(t){return(t.traceorder||"").indexOf("reversed")!==-1}},{}],707:[function(h,N,H){N.exports={moduleType:"component",name:"legend",layoutAttributes:h("./attributes"),supplyLayoutDefaults:h("./defaults"),draw:h("./draw"),style:h("./style")}},{"./attributes":700,"./defaults":702,"./draw":703,"./style":708}],708:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../registry"),g=h("../../lib"),p=g.strTranslate,e=h("../drawing"),f=h("../color"),u=h("../colorscale/helpers").extractOpts,i=h("../../traces/scatter/subtypes"),s=h("../../traces/pie/style_one"),o=h("../../traces/pie/helpers").castOption,a=h("./constants");function c(d,l){return(l?"radial":"horizontal")+(d?"":"reversed")}function r(d){var l=d[0].trace,y=l.contours,v=i.hasLines(l),_=i.hasMarkers(l),x=l.visible&&l.fill&&l.fill!=="none",T=!1,A=!1;if(y){var S=y.coloring;S==="lines"?T=!0:v=S==="none"||S==="heatmap"||y.showlines,y.type==="constraint"?x=y._operation!=="=":S!=="fill"&&S!=="heatmap"||(A=!0)}return{showMarker:_,showLine:v,showFill:x,showGradientLine:T,showGradientFill:A,anyLine:v||T,anyFill:x||A}}function n(d,l,y){return d&&g.isArrayOrTypedArray(d)?l:d>y?y:d}N.exports=function(d,l,y){var v=l._fullLayout;y||(y=v.legend);var _=y.itemsizing==="constant",x=y.itemwidth,T=(x+2*a.itemGap)/2,A=p(T,0),S=function(k,C,M,P){var O;if(k+1)O=k;else{if(!(C&&C.width>0))return 0;O=C.width}return _?P:Math.min(O,M)};function w(k,C,M){var P=k[0].trace,O=P.marker||{},F=O.line||{},j=M?P.visible&&P.type===M:m.traceIs(P,"bar"),W=t.select(C).select("g.legendpoints").selectAll("path.legend"+M).data(j?[k]:[]);W.enter().append("path").classed("legend"+M,!0).attr("d","M6,6H-6V-6H6Z").attr("transform",A),W.exit().remove(),W.each(function(Z){var Q=t.select(this),X=Z[0],G=S(X.mlw,O.line,5,2);Q.style("stroke-width",G+"px");var Y=X.mcc;if(!y._inHover&&"mc"in X){var K=u(O),D=K.mid;D===void 0&&(D=(K.max+K.min)/2),Y=e.tryColorscale(O,"")(D)}var B=Y||X.mc||O.color,q=O.pattern,ee=q&&e.getPatternAttr(q.shape,0,"");if(ee){var J=e.getPatternAttr(q.bgcolor,0,null),$=e.getPatternAttr(q.fgcolor,0,null),te=q.fgopacity,ie=n(q.size,8,10),ae=n(q.solidity,.5,1),he="legend-"+P.uid;Q.call(e.pattern,"legend",l,he,ee,ie,ae,Y,q.fillmode,J,$,te)}else Q.call(f.fill,B);G&&f.stroke(Q,X.mlc||F.color)})}function L(k,C,M){var P=k[0],O=P.trace,F=M?O.visible&&O.type===M:m.traceIs(O,M),j=t.select(C).select("g.legendpoints").selectAll("path.legend"+M).data(F?[k]:[]);if(j.enter().append("path").classed("legend"+M,!0).attr("d","M6,6H-6V-6H6Z").attr("transform",A),j.exit().remove(),j.size()){var W=(O.marker||{}).line,Z=S(o(W.width,P.pts),W,5,2),Q=g.minExtend(O,{marker:{line:{width:Z}}});Q.marker.line.color=W.color;var X=g.minExtend(P,{trace:Q});s(j,X,Q)}}d.each(function(k){var C=t.select(this),M=g.ensureSingle(C,"g","layers");M.style("opacity",k[0].trace.opacity);var P=y.valign,O=k[0].lineHeight,F=k[0].height;if(P!=="middle"&&O&&F){var j={top:1,bottom:-1}[P]*(.5*(O-F+3));M.attr("transform",p(0,j))}else M.attr("transform",null);M.selectAll("g.legendfill").data([k]).enter().append("g").classed("legendfill",!0),M.selectAll("g.legendlines").data([k]).enter().append("g").classed("legendlines",!0);var W=M.selectAll("g.legendsymbols").data([k]);W.enter().append("g").classed("legendsymbols",!0),W.selectAll("g.legendpoints").data([k]).enter().append("g").classed("legendpoints",!0)}).each(function(k){var C,M=k[0].trace,P=[];if(M.visible)switch(M.type){case"histogram2d":case"heatmap":P=[["M-15,-2V4H15V-2Z"]],C=!0;break;case"choropleth":case"choroplethmapbox":P=[["M-6,-6V6H6V-6Z"]],C=!0;break;case"densitymapbox":P=[["M-6,0 a6,6 0 1,0 12,0 a 6,6 0 1,0 -12,0"]],C="radial";break;case"cone":P=[["M-6,2 A2,2 0 0,0 -6,6 V6L6,4Z"],["M-6,-6 A2,2 0 0,0 -6,-2 L6,-4Z"],["M-6,-2 A2,2 0 0,0 -6,2 L6,0Z"]],C=!1;break;case"streamtube":P=[["M-6,2 A2,2 0 0,0 -6,6 H6 A2,2 0 0,1 6,2 Z"],["M-6,-6 A2,2 0 0,0 -6,-2 H6 A2,2 0 0,1 6,-6 Z"],["M-6,-2 A2,2 0 0,0 -6,2 H6 A2,2 0 0,1 6,-2 Z"]],C=!1;break;case"surface":P=[["M-6,-6 A2,3 0 0,0 -6,0 H6 A2,3 0 0,1 6,-6 Z"],["M-6,1 A2,3 0 0,1 -6,6 H6 A2,3 0 0,0 6,0 Z"]],C=!0;break;case"mesh3d":P=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],C=!1;break;case"volume":P=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],C=!0;break;case"isosurface":P=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6 A12,24 0 0,0 6,-6 L0,6Z"]],C=!1}var O=t.select(this).select("g.legendpoints").selectAll("path.legend3dandfriends").data(P);O.enter().append("path").classed("legend3dandfriends",!0).attr("transform",A).style("stroke-miterlimit",1),O.exit().remove(),O.each(function(F,j){var W,Z=t.select(this),Q=u(M),X=Q.colorscale,G=Q.reversescale;if(X){if(!C){var Y=X.length;W=j===0?X[G?Y-1:0][1]:j===1?X[G?0:Y-1][1]:X[Math.floor((Y-1)/2)][1]}}else{var K=M.vertexcolor||M.facecolor||M.color;W=g.isArrayOrTypedArray(K)?K[j]||K[0]:K}Z.attr("d",F[0]),W?Z.call(f.fill,W):Z.call(function(D){if(D.size()){var B="legendfill-"+M.uid;e.gradient(D,l,B,c(G,C==="radial"),X,"fill")}})})}).each(function(k){var C=k[0].trace,M=C.type==="waterfall";if(k[0]._distinct&&M){var P=k[0].trace[k[0].dir].marker;return k[0].mc=P.color,k[0].mlw=P.line.width,k[0].mlc=P.line.color,w(k,this,"waterfall")}var O=[];C.visible&&M&&(O=k[0].hasTotals?[["increasing","M-6,-6V6H0Z"],["totals","M6,6H0L-6,-6H-0Z"],["decreasing","M6,6V-6H0Z"]]:[["increasing","M-6,-6V6H6Z"],["decreasing","M6,6V-6H-6Z"]]);var F=t.select(this).select("g.legendpoints").selectAll("path.legendwaterfall").data(O);F.enter().append("path").classed("legendwaterfall",!0).attr("transform",A).style("stroke-miterlimit",1),F.exit().remove(),F.each(function(j){var W=t.select(this),Z=C[j[0]].marker,Q=S(void 0,Z.line,5,2);W.attr("d",j[1]).style("stroke-width",Q+"px").call(f.fill,Z.color),Q&&W.call(f.stroke,Z.line.color)})}).each(function(k){w(k,this,"funnel")}).each(function(k){w(k,this)}).each(function(k){var C=k[0].trace,M=t.select(this).select("g.legendpoints").selectAll("path.legendbox").data(C.visible&&m.traceIs(C,"box-violin")?[k]:[]);M.enter().append("path").classed("legendbox",!0).attr("d","M6,6H-6V-6H6Z").attr("transform",A),M.exit().remove(),M.each(function(){var P=t.select(this);if(C.boxpoints!=="all"&&C.points!=="all"||f.opacity(C.fillcolor)!==0||f.opacity((C.line||{}).color)!==0){var O=S(void 0,C.line,5,2);P.style("stroke-width",O+"px").call(f.fill,C.fillcolor),O&&f.stroke(P,C.line.color)}else{var F=g.minExtend(C,{marker:{size:_?12:g.constrain(C.marker.size,2,16),sizeref:1,sizemin:1,sizemode:"diameter"}});M.call(e.pointStyle,F,l)}})}).each(function(k){L(k,this,"funnelarea")}).each(function(k){L(k,this,"pie")}).each(function(k){var C,M,P=r(k),O=P.showFill,F=P.showLine,j=P.showGradientLine,W=P.showGradientFill,Z=P.anyFill,Q=P.anyLine,X=k[0],G=X.trace,Y=u(G),K=Y.colorscale,D=Y.reversescale,B=i.hasMarkers(G)||!Z?"M5,0":Q?"M5,-2":"M5,-3",q=t.select(this),ee=q.select(".legendfill").selectAll("path").data(O||W?[k]:[]);if(ee.enter().append("path").classed("js-fill",!0),ee.exit().remove(),ee.attr("d",B+"h"+x+"v6h-"+x+"z").call(O?e.fillGroupStyle:function(te){if(te.size()){var ie="legendfill-"+G.uid;e.gradient(te,l,ie,c(D),K,"fill")}}),F||j){var J=S(void 0,G.line,10,5);M=g.minExtend(G,{line:{width:J}}),C=[g.minExtend(X,{trace:M})]}var $=q.select(".legendlines").selectAll("path").data(F||j?[C]:[]);$.enter().append("path").classed("js-line",!0),$.exit().remove(),$.attr("d",B+(j?"l"+x+",0.0001":"h"+x)).call(F?e.lineGroupStyle:function(te){if(te.size()){var ie="legendline-"+G.uid;e.lineGroupStyle(te),e.gradient(te,l,ie,c(D),K,"stroke")}})}).each(function(k){var C,M,P=r(k),O=P.anyFill,F=P.anyLine,j=P.showLine,W=P.showMarker,Z=k[0],Q=Z.trace,X=!W&&!F&&!O&&i.hasText(Q);function G($,te,ie,ae){var he=g.nestedProperty(Q,$).get(),se=g.isArrayOrTypedArray(he)&&te?te(he):he;if(_&&se&&ae!==void 0&&(se=ae),ie){if(se<ie[0])return ie[0];if(se>ie[1])return ie[1]}return se}function Y($){return Z._distinct&&Z.index&&$[Z.index]?$[Z.index]:$[0]}if(W||X||j){var K={},D={};if(W){K.mc=G("marker.color",Y),K.mx=G("marker.symbol",Y),K.mo=G("marker.opacity",g.mean,[.2,1]),K.mlc=G("marker.line.color",Y),K.mlw=G("marker.line.width",g.mean,[0,5],2),D.marker={sizeref:1,sizemin:1,sizemode:"diameter"};var B=G("marker.size",g.mean,[2,16],12);K.ms=B,D.marker.size=B}j&&(D.line={width:G("line.width",Y,[0,10],5)}),X&&(K.tx="Aa",K.tp=G("textposition",Y),K.ts=10,K.tc=G("textfont.color",Y),K.tf=G("textfont.family",Y)),C=[g.minExtend(Z,K)],(M=g.minExtend(Q,D)).selectedpoints=null,M.texttemplate=null}var q=t.select(this).select("g.legendpoints"),ee=q.selectAll("path.scatterpts").data(W?C:[]);ee.enter().insert("path",":first-child").classed("scatterpts",!0).attr("transform",A),ee.exit().remove(),ee.call(e.pointStyle,M,l),W&&(C[0].mrc=3);var J=q.selectAll("g.pointtext").data(X?C:[]);J.enter().append("g").classed("pointtext",!0).append("text").attr("transform",A),J.exit().remove(),J.selectAll("text").call(e.textPointStyle,M,l)}).each(function(k){var C=k[0].trace,M=t.select(this).select("g.legendpoints").selectAll("path.legendcandle").data(C.visible&&C.type==="candlestick"?[k,k]:[]);M.enter().append("path").classed("legendcandle",!0).attr("d",function(P,O){return O?"M-15,0H-8M-8,6V-6H8Z":"M15,0H8M8,-6V6H-8Z"}).attr("transform",A).style("stroke-miterlimit",1),M.exit().remove(),M.each(function(P,O){var F=t.select(this),j=C[O?"increasing":"decreasing"],W=S(void 0,j.line,5,2);F.style("stroke-width",W+"px").call(f.fill,j.fillcolor),W&&f.stroke(F,j.line.color)})}).each(function(k){var C=k[0].trace,M=t.select(this).select("g.legendpoints").selectAll("path.legendohlc").data(C.visible&&C.type==="ohlc"?[k,k]:[]);M.enter().append("path").classed("legendohlc",!0).attr("d",function(P,O){return O?"M-15,0H0M-8,-6V0":"M15,0H0M8,6V0"}).attr("transform",A).style("stroke-miterlimit",1),M.exit().remove(),M.each(function(P,O){var F=t.select(this),j=C[O?"increasing":"decreasing"],W=S(void 0,j.line,5,2);F.style("fill","none").call(e.dashLine,j.line.dash,W),W&&f.stroke(F,j.line.color)})})}},{"../../lib":787,"../../registry":915,"../../traces/pie/helpers":1181,"../../traces/pie/style_one":1187,"../../traces/scatter/subtypes":1227,"../color":650,"../colorscale/helpers":661,"../drawing":672,"./constants":701,"@plotly/d3":58}],709:[function(h,N,H){h("./constants"),N.exports={editType:"modebar",orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"modebar"},bgcolor:{valType:"color",editType:"modebar"},color:{valType:"color",editType:"modebar"},activecolor:{valType:"color",editType:"modebar"},uirevision:{valType:"any",editType:"none"},add:{valType:"string",arrayOk:!0,dflt:"",editType:"modebar"},remove:{valType:"string",arrayOk:!0,dflt:"",editType:"modebar"}}},{"./constants":711}],710:[function(h,N,H){var t=h("../../registry"),m=h("../../plots/plots"),g=h("../../plots/cartesian/axis_ids"),p=h("../../fonts/ploticon"),e=h("../shapes/draw").eraseActiveShape,f=h("../../lib"),u=f._,i=N.exports={};function s(v,_){var x,T,A=_.currentTarget,S=A.getAttribute("data-attr"),w=A.getAttribute("data-val")||!0,L=v._fullLayout,k={},C=g.list(v,null,!0),M=L._cartesianSpikesEnabled;if(S==="zoom"){var P,O=w==="in"?.5:2,F=(1+O)/2,j=(1-O)/2;for(T=0;T<C.length;T++)if(!(x=C[T]).fixedrange)if(P=x._name,w==="auto")k[P+".autorange"]=!0;else if(w==="reset"){if(x._rangeInitial===void 0)k[P+".autorange"]=!0;else{var W=x._rangeInitial.slice();k[P+".range[0]"]=W[0],k[P+".range[1]"]=W[1]}x._showSpikeInitial!==void 0&&(k[P+".showspikes"]=x._showSpikeInitial,M!=="on"||x._showSpikeInitial||(M="off"))}else{var Z=[x.r2l(x.range[0]),x.r2l(x.range[1])],Q=[F*Z[0]+j*Z[1],F*Z[1]+j*Z[0]];k[P+".range[0]"]=x.l2r(Q[0]),k[P+".range[1]"]=x.l2r(Q[1])}}else S!=="hovermode"||w!=="x"&&w!=="y"||(w=L._isHoriz?"y":"x",A.setAttribute("data-val",w)),k[S]=w;L._cartesianSpikesEnabled=M,t.call("_guiRelayout",v,k)}function o(v,_){for(var x=_.currentTarget,T=x.getAttribute("data-attr"),A=x.getAttribute("data-val")||!0,S=v._fullLayout._subplots.gl3d||[],w={},L=T.split("."),k=0;k<S.length;k++)w[S[k]+"."+L[1]]=A;var C=A==="pan"?A:"zoom";w.dragmode=C,t.call("_guiRelayout",v,w)}function a(v,_){for(var x=_.currentTarget.getAttribute("data-attr"),T=x==="resetLastSave",A=x==="resetDefault",S=v._fullLayout,w=S._subplots.gl3d||[],L={},k=0;k<w.length;k++){var C,M=w[k],P=M+".camera",O=M+".aspectratio",F=M+".aspectmode",j=S[M]._scene;T?(L[P+".up"]=j.viewInitial.up,L[P+".eye"]=j.viewInitial.eye,L[P+".center"]=j.viewInitial.center,C=!0):A&&(L[P+".up"]=null,L[P+".eye"]=null,L[P+".center"]=null,C=!0),C&&(L[O+".x"]=j.viewInitial.aspectratio.x,L[O+".y"]=j.viewInitial.aspectratio.y,L[O+".z"]=j.viewInitial.aspectratio.z,L[F]=j.viewInitial.aspectmode)}t.call("_guiRelayout",v,L)}function c(v,_){var x=_.currentTarget,T=x._previousVal,A=v._fullLayout,S=A._subplots.gl3d||[],w=["xaxis","yaxis","zaxis"],L={},k={};if(T)k=T,x._previousVal=null;else{for(var C=0;C<S.length;C++){var M=S[C],P=A[M],O=M+".hovermode";L[O]=P.hovermode,k[O]=!1;for(var F=0;F<3;F++){var j=w[F],W=M+"."+j+".showspikes";k[W]=!1,L[W]=P[j].showspikes}}x._previousVal=L}return k}function r(v,_){for(var x=_.currentTarget,T=x.getAttribute("data-attr"),A=x.getAttribute("data-val")||!0,S=v._fullLayout,w=S._subplots.geo||[],L=0;L<w.length;L++){var k=w[L],C=S[k];if(T==="zoom"){var M=C.projection.scale,P=A==="in"?2*M:.5*M;t.call("_guiRelayout",v,k+".projection.scale",P)}}T==="reset"&&y(v,"geo")}function n(v){var _=v._fullLayout;return!_.hovermode&&(_._has("cartesian")?_._isHoriz?"y":"x":"closest")}function d(v){var _=n(v);t.call("_guiRelayout",v,"hovermode",_)}function l(v,_){for(var x=_.currentTarget.getAttribute("data-val"),T=v._fullLayout,A=T._subplots.mapbox||[],S={},w=0;w<A.length;w++){var L=A[w],k=T[L].zoom,C=x==="in"?1.05*k:k/1.05;S[L+".zoom"]=C}t.call("_guiRelayout",v,S)}function y(v,_){for(var x=v._fullLayout,T=x._subplots[_]||[],A={},S=0;S<T.length;S++)for(var w=T[S],L=x[w]._subplot.viewInitial,k=Object.keys(L),C=0;C<k.length;C++){var M=k[C];A[w+"."+M]=L[M]}t.call("_guiRelayout",v,A)}i.toImage={name:"toImage",title:function(v){var _=(v._context.toImageButtonOptions||{}).format||"png";return u(v,_==="png"?"Download plot as a png":"Download plot")},icon:p.camera,click:function(v){var _=v._context.toImageButtonOptions,x={format:_.format||"png"};f.notifier(u(v,"Taking snapshot - this may take a few seconds"),"long"),x.format!=="svg"&&f.isIE()&&(f.notifier(u(v,"IE only supports svg.  Changing format to svg."),"long"),x.format="svg"),["filename","width","height","scale"].forEach(function(T){T in _&&(x[T]=_[T])}),t.call("downloadImage",v,x).then(function(T){f.notifier(u(v,"Snapshot succeeded")+" - "+T,"long")}).catch(function(){f.notifier(u(v,"Sorry, there was a problem downloading your snapshot!"),"long")})}},i.sendDataToCloud={name:"sendDataToCloud",title:function(v){return u(v,"Edit in Chart Studio")},icon:p.disk,click:function(v){m.sendDataToCloud(v)}},i.editInChartStudio={name:"editInChartStudio",title:function(v){return u(v,"Edit in Chart Studio")},icon:p.pencil,click:function(v){m.sendDataToCloud(v)}},i.zoom2d={name:"zoom2d",_cat:"zoom",title:function(v){return u(v,"Zoom")},attr:"dragmode",val:"zoom",icon:p.zoombox,click:s},i.pan2d={name:"pan2d",_cat:"pan",title:function(v){return u(v,"Pan")},attr:"dragmode",val:"pan",icon:p.pan,click:s},i.select2d={name:"select2d",_cat:"select",title:function(v){return u(v,"Box Select")},attr:"dragmode",val:"select",icon:p.selectbox,click:s},i.lasso2d={name:"lasso2d",_cat:"lasso",title:function(v){return u(v,"Lasso Select")},attr:"dragmode",val:"lasso",icon:p.lasso,click:s},i.drawclosedpath={name:"drawclosedpath",title:function(v){return u(v,"Draw closed freeform")},attr:"dragmode",val:"drawclosedpath",icon:p.drawclosedpath,click:s},i.drawopenpath={name:"drawopenpath",title:function(v){return u(v,"Draw open freeform")},attr:"dragmode",val:"drawopenpath",icon:p.drawopenpath,click:s},i.drawline={name:"drawline",title:function(v){return u(v,"Draw line")},attr:"dragmode",val:"drawline",icon:p.drawline,click:s},i.drawrect={name:"drawrect",title:function(v){return u(v,"Draw rectangle")},attr:"dragmode",val:"drawrect",icon:p.drawrect,click:s},i.drawcircle={name:"drawcircle",title:function(v){return u(v,"Draw circle")},attr:"dragmode",val:"drawcircle",icon:p.drawcircle,click:s},i.eraseshape={name:"eraseshape",title:function(v){return u(v,"Erase active shape")},icon:p.eraseshape,click:e},i.zoomIn2d={name:"zoomIn2d",_cat:"zoomin",title:function(v){return u(v,"Zoom in")},attr:"zoom",val:"in",icon:p.zoom_plus,click:s},i.zoomOut2d={name:"zoomOut2d",_cat:"zoomout",title:function(v){return u(v,"Zoom out")},attr:"zoom",val:"out",icon:p.zoom_minus,click:s},i.autoScale2d={name:"autoScale2d",_cat:"autoscale",title:function(v){return u(v,"Autoscale")},attr:"zoom",val:"auto",icon:p.autoscale,click:s},i.resetScale2d={name:"resetScale2d",_cat:"resetscale",title:function(v){return u(v,"Reset axes")},attr:"zoom",val:"reset",icon:p.home,click:s},i.hoverClosestCartesian={name:"hoverClosestCartesian",_cat:"hoverclosest",title:function(v){return u(v,"Show closest data on hover")},attr:"hovermode",val:"closest",icon:p.tooltip_basic,gravity:"ne",click:s},i.hoverCompareCartesian={name:"hoverCompareCartesian",_cat:"hoverCompare",title:function(v){return u(v,"Compare data on hover")},attr:"hovermode",val:function(v){return v._fullLayout._isHoriz?"y":"x"},icon:p.tooltip_compare,gravity:"ne",click:s},i.zoom3d={name:"zoom3d",_cat:"zoom",title:function(v){return u(v,"Zoom")},attr:"scene.dragmode",val:"zoom",icon:p.zoombox,click:o},i.pan3d={name:"pan3d",_cat:"pan",title:function(v){return u(v,"Pan")},attr:"scene.dragmode",val:"pan",icon:p.pan,click:o},i.orbitRotation={name:"orbitRotation",title:function(v){return u(v,"Orbital rotation")},attr:"scene.dragmode",val:"orbit",icon:p["3d_rotate"],click:o},i.tableRotation={name:"tableRotation",title:function(v){return u(v,"Turntable rotation")},attr:"scene.dragmode",val:"turntable",icon:p["z-axis"],click:o},i.resetCameraDefault3d={name:"resetCameraDefault3d",_cat:"resetCameraDefault",title:function(v){return u(v,"Reset camera to default")},attr:"resetDefault",icon:p.home,click:a},i.resetCameraLastSave3d={name:"resetCameraLastSave3d",_cat:"resetCameraLastSave",title:function(v){return u(v,"Reset camera to last save")},attr:"resetLastSave",icon:p.movie,click:a},i.hoverClosest3d={name:"hoverClosest3d",_cat:"hoverclosest",title:function(v){return u(v,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:p.tooltip_basic,gravity:"ne",click:function(v,_){var x=c(v,_);t.call("_guiRelayout",v,x)}},i.zoomInGeo={name:"zoomInGeo",_cat:"zoomin",title:function(v){return u(v,"Zoom in")},attr:"zoom",val:"in",icon:p.zoom_plus,click:r},i.zoomOutGeo={name:"zoomOutGeo",_cat:"zoomout",title:function(v){return u(v,"Zoom out")},attr:"zoom",val:"out",icon:p.zoom_minus,click:r},i.resetGeo={name:"resetGeo",_cat:"reset",title:function(v){return u(v,"Reset")},attr:"reset",val:null,icon:p.autoscale,click:r},i.hoverClosestGeo={name:"hoverClosestGeo",_cat:"hoverclosest",title:function(v){return u(v,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:p.tooltip_basic,gravity:"ne",click:d},i.hoverClosestGl2d={name:"hoverClosestGl2d",_cat:"hoverclosest",title:function(v){return u(v,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:p.tooltip_basic,gravity:"ne",click:d},i.hoverClosestPie={name:"hoverClosestPie",_cat:"hoverclosest",title:function(v){return u(v,"Toggle show closest data on hover")},attr:"hovermode",val:"closest",icon:p.tooltip_basic,gravity:"ne",click:d},i.resetViewSankey={name:"resetSankeyGroup",title:function(v){return u(v,"Reset view")},icon:p.home,click:function(v){for(var _={"node.groups":[],"node.x":[],"node.y":[]},x=0;x<v._fullData.length;x++){var T=v._fullData[x]._viewInitial;_["node.groups"].push(T.node.groups.slice()),_["node.x"].push(T.node.x.slice()),_["node.y"].push(T.node.y.slice())}t.call("restyle",v,_)}},i.toggleHover={name:"toggleHover",title:function(v){return u(v,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:p.tooltip_basic,gravity:"ne",click:function(v,_){var x=c(v,_);x.hovermode=n(v),t.call("_guiRelayout",v,x)}},i.resetViews={name:"resetViews",title:function(v){return u(v,"Reset views")},icon:p.home,click:function(v,_){var x=_.currentTarget;x.setAttribute("data-attr","zoom"),x.setAttribute("data-val","reset"),s(v,_),x.setAttribute("data-attr","resetLastSave"),a(v,_),y(v,"geo"),y(v,"mapbox")}},i.toggleSpikelines={name:"toggleSpikelines",title:function(v){return u(v,"Toggle Spike Lines")},icon:p.spikeline,attr:"_cartesianSpikesEnabled",val:"on",click:function(v){var _=v._fullLayout,x=_._cartesianSpikesEnabled;_._cartesianSpikesEnabled=x==="on"?"off":"on",t.call("_guiRelayout",v,function(T){for(var A=T._fullLayout._cartesianSpikesEnabled==="on",S=g.list(T,null,!0),w={},L=0;L<S.length;L++){var k=S[L];w[k._name+".showspikes"]=!!A||k._showSpikeInitial}return w}(v))}},i.resetViewMapbox={name:"resetViewMapbox",_cat:"resetView",title:function(v){return u(v,"Reset view")},attr:"reset",icon:p.home,click:function(v){y(v,"mapbox")}},i.zoomInMapbox={name:"zoomInMapbox",_cat:"zoomin",title:function(v){return u(v,"Zoom in")},attr:"zoom",val:"in",icon:p.zoom_plus,click:l},i.zoomOutMapbox={name:"zoomOutMapbox",_cat:"zoomout",title:function(v){return u(v,"Zoom out")},attr:"zoom",val:"out",icon:p.zoom_minus,click:l}},{"../../fonts/ploticon":766,"../../lib":787,"../../plots/cartesian/axis_ids":842,"../../plots/plots":901,"../../registry":915,"../shapes/draw":734}],711:[function(h,N,H){var t=h("./buttons"),m=Object.keys(t),g=["drawline","drawopenpath","drawclosedpath","drawcircle","drawrect","eraseshape"],p=["v1hovermode","hoverclosest","hovercompare","togglehover","togglespikelines"].concat(g),e=[];m.forEach(function(f){(function(u){if(p.indexOf(u._cat||u.name)===-1){var i=u.name,s=(u._cat||u.name).toLowerCase();e.indexOf(i)===-1&&e.push(i),e.indexOf(s)===-1&&e.push(s)}})(t[f])}),e.sort(),N.exports={DRAW_MODES:g,backButtons:p,foreButtons:e}},{"./buttons":710}],712:[function(h,N,H){var t=h("../../lib"),m=h("../color"),g=h("../../plot_api/plot_template"),p=h("./attributes");N.exports=function(e,f){var u=e.modebar||{},i=g.newContainer(f,"modebar");function s(a,c){return t.coerce(u,i,p,a,c)}s("orientation"),s("bgcolor",m.addOpacity(f.paper_bgcolor,.5));var o=m.contrast(m.rgb(f.modebar.bgcolor));s("color",m.addOpacity(o,.3)),s("activecolor",m.addOpacity(o,.7)),s("uirevision",f.uirevision),s("add"),s("remove")}},{"../../lib":787,"../../plot_api/plot_template":827,"../color":650,"./attributes":709}],713:[function(h,N,H){N.exports={moduleType:"component",name:"modebar",layoutAttributes:h("./attributes"),supplyLayoutDefaults:h("./defaults"),manage:h("./manage")}},{"./attributes":709,"./defaults":712,"./manage":714}],714:[function(h,N,H){var t=h("../../plots/cartesian/axis_ids"),m=h("../../traces/scatter/subtypes"),g=h("../../registry"),p=h("../fx/helpers").isUnifiedHover,e=h("./modebar"),f=h("./buttons"),u=h("./constants").DRAW_MODES;N.exports=function(i){var s=i._fullLayout,o=i._context,a=s._modeBar;if(o.displayModeBar||o.watermark){if(!Array.isArray(o.modeBarButtonsToRemove))throw new Error(["*modeBarButtonsToRemove* configuration options","must be an array."].join(" "));if(!Array.isArray(o.modeBarButtonsToAdd))throw new Error(["*modeBarButtonsToAdd* configuration options","must be an array."].join(" "));var c,r=o.modeBarButtons;c=Array.isArray(r)&&r.length?function(n){for(var d=0;d<n.length;d++)for(var l=n[d],y=0;y<l.length;y++){var v=l[y];if(typeof v=="string"){if(f[v]===void 0)throw new Error(["*modeBarButtons* configuration options","invalid button name"].join(" "));n[d][y]=f[v]}}return n}(r):!o.displayModeBar&&o.watermark?[]:function(n){var d=n._fullLayout,l=n._fullData,y=n._context;function v(ie,ae){if(typeof ae=="string"){if(ae.toLowerCase()===ie.toLowerCase())return!0}else{var he=ae.name,se=ae._cat||ae.name;if(he===ie||se===ie.toLowerCase())return!0}return!1}var _=d.modebar.add;typeof _=="string"&&(_=[_]);var x=d.modebar.remove;typeof x=="string"&&(x=[x]);var T=y.modeBarButtonsToAdd.concat(_.filter(function(ie){for(var ae=0;ae<y.modeBarButtonsToRemove.length;ae++)if(v(ie,y.modeBarButtonsToRemove[ae]))return!1;return!0})),A=y.modeBarButtonsToRemove.concat(x.filter(function(ie){for(var ae=0;ae<y.modeBarButtonsToAdd.length;ae++)if(v(ie,y.modeBarButtonsToAdd[ae]))return!1;return!0})),S=d._has("cartesian"),w=d._has("gl3d"),L=d._has("geo"),k=d._has("pie"),C=d._has("funnelarea"),M=d._has("gl2d"),P=d._has("ternary"),O=d._has("mapbox"),F=d._has("polar"),j=d._has("sankey"),W=function(ie){for(var ae=t.list({_fullLayout:ie},null,!0),he=0;he<ae.length;he++)if(!ae[he].fixedrange)return!1;return!0}(d),Z=p(d.hovermode),Q=[];function X(ie){if(ie.length){for(var ae=[],he=0;he<ie.length;he++){for(var se=ie[he],de=f[se],ce=de.name.toLowerCase(),ve=(de._cat||de.name).toLowerCase(),ke=!1,Ee=0;Ee<A.length;Ee++){var be=A[Ee].toLowerCase();if(be===ce||be===ve){ke=!0;break}}ke||ae.push(f[se])}Q.push(ae)}}var G=["toImage"];y.showEditInChartStudio?G.push("editInChartStudio"):y.showSendToCloud&&G.push("sendDataToCloud"),X(G);var Y=[],K=[],D=[],B=[];(S||M||k||C||P)+L+w+O+F>1?(K=["toggleHover"],D=["resetViews"]):L?(Y=["zoomInGeo","zoomOutGeo"],K=["hoverClosestGeo"],D=["resetGeo"]):w?(K=["hoverClosest3d"],D=["resetCameraDefault3d","resetCameraLastSave3d"]):O?(Y=["zoomInMapbox","zoomOutMapbox"],K=["toggleHover"],D=["resetViewMapbox"]):M?K=["hoverClosestGl2d"]:k?K=["hoverClosestPie"]:j?(K=["hoverClosestCartesian","hoverCompareCartesian"],D=["resetViewSankey"]):K=["toggleHover"],S&&(K=["toggleSpikelines","hoverClosestCartesian","hoverCompareCartesian"]),(function(ie){for(var ae=0;ae<ie.length;ae++)if(!g.traceIs(ie[ae],"noHover"))return!1;return!0}(l)||Z)&&(K=[]),!S&&!M||W||(Y=["zoomIn2d","zoomOut2d","autoScale2d"],D[0]!=="resetViews"&&(D=["resetScale2d"])),w?B=["zoom3d","pan3d","orbitRotation","tableRotation"]:(S||M)&&!W||P?B=["zoom2d","pan2d"]:O||L?B=["pan2d"]:F&&(B=["zoom2d"]),function(ie){for(var ae=!1,he=0;he<ie.length&&!ae;he++){var se=ie[he];se._module&&se._module.selectPoints&&(g.traceIs(se,"scatter-like")?(m.hasMarkers(se)||m.hasText(se))&&(ae=!0):g.traceIs(se,"box-violin")&&se.boxpoints!=="all"&&se.points!=="all"||(ae=!0))}return ae}(l)&&B.push("select2d","lasso2d");var q=[],ee=function(ie){q.indexOf(ie)===-1&&K.indexOf(ie)!==-1&&q.push(ie)};if(Array.isArray(T)){for(var J=[],$=0;$<T.length;$++){var te=T[$];typeof te=="string"?(te=te.toLowerCase(),u.indexOf(te)!==-1?(d._has("mapbox")||d._has("cartesian"))&&B.push(te):te==="togglespikelines"?ee("toggleSpikelines"):te==="togglehover"?ee("toggleHover"):te==="hovercompare"?ee("hoverCompareCartesian"):te==="hoverclosest"?(ee("hoverClosestCartesian"),ee("hoverClosestGeo"),ee("hoverClosest3d"),ee("hoverClosestGl2d"),ee("hoverClosestPie")):te==="v1hovermode"&&(ee("toggleHover"),ee("hoverClosestCartesian"),ee("hoverCompareCartesian"),ee("hoverClosestGeo"),ee("hoverClosest3d"),ee("hoverClosestGl2d"),ee("hoverClosestPie"))):J.push(te)}T=J}return X(B),X(Y.concat(D)),X(q),function(ie,ae){if(ae.length)if(Array.isArray(ae[0]))for(var he=0;he<ae.length;he++)ie.push(ae[he]);else ie.push(ae);return ie}(Q,T)}(i),a?a.update(i,c):s._modeBar=e(i,c)}else a&&(a.destroy(),delete s._modeBar)}},{"../../plots/cartesian/axis_ids":842,"../../registry":915,"../../traces/scatter/subtypes":1227,"../fx/helpers":686,"./buttons":710,"./constants":711,"./modebar":715}],715:[function(h,N,H){var t=h("@plotly/d3"),m=h("fast-isnumeric"),g=h("../../lib"),p=h("../../fonts/ploticon"),e=new DOMParser;function f(i){this.container=i.container,this.element=document.createElement("div"),this.update(i.graphInfo,i.buttons),this.container.appendChild(this.element)}var u=f.prototype;u.update=function(i,s){this.graphInfo=i;var o=this.graphInfo._context,a=this.graphInfo._fullLayout,c="modebar-"+a._uid;this.element.setAttribute("id",c),this._uid=c,this.element.className="modebar",o.displayModeBar==="hover"&&(this.element.className+=" modebar--hover ease-bg"),a.modebar.orientation==="v"&&(this.element.className+=" vertical",s=s.reverse());var r=a.modebar,n=o.displayModeBar==="hover"?".js-plotly-plot .plotly:hover ":"";g.deleteRelatedStyleRule(c),g.addRelatedStyleRule(c,n+"#"+c+" .modebar-group","background-color: "+r.bgcolor),g.addRelatedStyleRule(c,"#"+c+" .modebar-btn .icon path","fill: "+r.color),g.addRelatedStyleRule(c,"#"+c+" .modebar-btn:hover .icon path","fill: "+r.activecolor),g.addRelatedStyleRule(c,"#"+c+" .modebar-btn.active .icon path","fill: "+r.activecolor);var d=!this.hasButtons(s),l=this.hasLogo!==o.displaylogo,y=this.locale!==o.locale;if(this.locale=o.locale,(d||l||y)&&(this.removeAllButtons(),this.updateButtons(s),o.watermark||o.displaylogo)){var v=this.getLogo();o.watermark&&(v.className=v.className+" watermark"),a.modebar.orientation==="v"?this.element.insertBefore(v,this.element.childNodes[0]):this.element.appendChild(v),this.hasLogo=!0}this.updateActiveButton()},u.updateButtons=function(i){var s=this;this.buttons=i,this.buttonElements=[],this.buttonsNames=[],this.buttons.forEach(function(o){var a=s.createGroup();o.forEach(function(c){var r=c.name;if(!r)throw new Error("must provide button 'name' in button config");if(s.buttonsNames.indexOf(r)!==-1)throw new Error("button name '"+r+"' is taken");s.buttonsNames.push(r);var n=s.createButton(c);s.buttonElements.push(n),a.appendChild(n)}),s.element.appendChild(a)})},u.createGroup=function(){var i=document.createElement("div");return i.className="modebar-group",i},u.createButton=function(i){var s=this,o=document.createElement("a");o.setAttribute("rel","tooltip"),o.className="modebar-btn";var a=i.title;a===void 0?a=i.name:typeof a=="function"&&(a=a(this.graphInfo)),(a||a===0)&&o.setAttribute("data-title",a),i.attr!==void 0&&o.setAttribute("data-attr",i.attr);var c=i.val;if(c!==void 0&&(typeof c=="function"&&(c=c(this.graphInfo)),o.setAttribute("data-val",c)),typeof i.click!="function")throw new Error("must provide button 'click' function in button config");o.addEventListener("click",function(n){i.click(s.graphInfo,n),s.updateActiveButton(n.currentTarget)}),o.setAttribute("data-toggle",i.toggle||!1),i.toggle&&t.select(o).classed("active",!0);var r=i.icon;return typeof r=="function"?o.appendChild(r()):o.appendChild(this.createIcon(r||p.question)),o.setAttribute("data-gravity",i.gravity||"n"),o},u.createIcon=function(i){var s,o=m(i.height)?Number(i.height):i.ascent-i.descent,a="http://www.w3.org/2000/svg";if(i.path){(s=document.createElementNS(a,"svg")).setAttribute("viewBox",[0,0,i.width,o].join(" ")),s.setAttribute("class","icon");var c=document.createElementNS(a,"path");c.setAttribute("d",i.path),i.transform?c.setAttribute("transform",i.transform):i.ascent!==void 0&&c.setAttribute("transform","matrix(1 0 0 -1 0 "+i.ascent+")"),s.appendChild(c)}return i.svg&&(s=e.parseFromString(i.svg,"application/xml").childNodes[0]),s.setAttribute("height","1em"),s.setAttribute("width","1em"),s},u.updateActiveButton=function(i){var s=this.graphInfo._fullLayout,o=i!==void 0?i.getAttribute("data-attr"):null;this.buttonElements.forEach(function(a){var c=a.getAttribute("data-val")||!0,r=a.getAttribute("data-attr"),n=a.getAttribute("data-toggle")==="true",d=t.select(a);if(n)r===o&&d.classed("active",!d.classed("active"));else{var l=r===null?r:g.nestedProperty(s,r).get();d.classed("active",l===c)}})},u.hasButtons=function(i){var s=this.buttons;if(!s||i.length!==s.length)return!1;for(var o=0;o<i.length;++o){if(i[o].length!==s[o].length)return!1;for(var a=0;a<i[o].length;a++)if(i[o][a].name!==s[o][a].name)return!1}return!0},u.getLogo=function(){var i=this.createGroup(),s=document.createElement("a");return s.href="https://plotly.com/",s.target="_blank",s.setAttribute("data-title",g._(this.graphInfo,"Produced with Plotly")),s.className="modebar-btn plotlyjsicon modebar-btn--logo",s.appendChild(this.createIcon(p.newplotlylogo)),i.appendChild(s),i},u.removeAllButtons=function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.hasLogo=!1},u.destroy=function(){g.removeElement(this.container.querySelector(".modebar")),g.deleteRelatedStyleRule(this._uid)},N.exports=function(i,s){var o=i._fullLayout,a=new f({graphInfo:i,container:o._modebardiv.node(),buttons:s});return o._privateplot&&t.select(a.element).append("span").classed("badge-private float--left",!0).text("PRIVATE"),a}},{"../../fonts/ploticon":766,"../../lib":787,"@plotly/d3":58,"fast-isnumeric":246}],716:[function(h,N,H){var t=h("../../plots/font_attributes"),m=h("../color/attributes"),g=(0,h("../../plot_api/plot_template").templatedArray)("button",{visible:{valType:"boolean",dflt:!0,editType:"plot"},step:{valType:"enumerated",values:["month","year","day","hour","minute","second","all"],dflt:"month",editType:"plot"},stepmode:{valType:"enumerated",values:["backward","todate"],dflt:"backward",editType:"plot"},count:{valType:"number",min:0,dflt:1,editType:"plot"},label:{valType:"string",editType:"plot"},editType:"plot"});N.exports={visible:{valType:"boolean",editType:"plot"},buttons:g,x:{valType:"number",min:-2,max:3,editType:"plot"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"plot"},y:{valType:"number",min:-2,max:3,editType:"plot"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"bottom",editType:"plot"},font:t({editType:"plot"}),bgcolor:{valType:"color",dflt:m.lightLine,editType:"plot"},activecolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:m.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"}},{"../../plot_api/plot_template":827,"../../plots/font_attributes":867,"../color/attributes":649}],717:[function(h,N,H){N.exports={yPad:.02,minButtonWidth:30,rx:3,ry:3,lightAmount:25,darkAmount:10}},{}],718:[function(h,N,H){var t=h("../../lib"),m=h("../color"),g=h("../../plot_api/plot_template"),p=h("../../plots/array_container_defaults"),e=h("./attributes"),f=h("./constants");function u(i,s,o,a){var c=a.calendar;function r(d,l){return t.coerce(i,s,e.buttons,d,l)}if(r("visible")){var n=r("step");n!=="all"&&(!c||c==="gregorian"||n!=="month"&&n!=="year"?r("stepmode"):s.stepmode="backward",r("count")),r("label")}}N.exports=function(i,s,o,a,c){var r=i.rangeselector||{},n=g.newContainer(s,"rangeselector");function d(v,_){return t.coerce(r,n,e,v,_)}if(d("visible",p(r,n,{name:"buttons",handleItemDefaults:u,calendar:c}).length>0)){var l=function(v,_,x){for(var T=x.filter(function(L){return _[L].anchor===v._id}),A=0,S=0;S<T.length;S++){var w=_[T[S]].domain;w&&(A=Math.max(w[1],A))}return[v.domain[0],A+f.yPad]}(s,o,a);d("x",l[0]),d("y",l[1]),t.noneOrAll(i,s,["x","y"]),d("xanchor"),d("yanchor"),t.coerceFont(d,"font",o.font);var y=d("bgcolor");d("activecolor",m.contrast(y,f.lightAmount,f.darkAmount)),d("bordercolor"),d("borderwidth")}}},{"../../lib":787,"../../plot_api/plot_template":827,"../../plots/array_container_defaults":833,"../color":650,"./attributes":716,"./constants":717}],719:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../registry"),g=h("../../plots/plots"),p=h("../color"),e=h("../drawing"),f=h("../../lib"),u=f.strTranslate,i=h("../../lib/svg_text_utils"),s=h("../../plots/cartesian/axis_ids"),o=h("../../constants/alignment"),a=o.LINE_SPACING,c=o.FROM_TL,r=o.FROM_BR,n=h("./constants"),d=h("./get_update_object");function l(_){return _._id}function y(_,x,T){var A=f.ensureSingle(_,"rect","selector-rect",function(S){S.attr("shape-rendering","crispEdges")});A.attr({rx:n.rx,ry:n.ry}),A.call(p.stroke,x.bordercolor).call(p.fill,function(S,w){return w._isActive||w._isHovered?S.activecolor:S.bgcolor}(x,T)).style("stroke-width",x.borderwidth+"px")}function v(_,x,T,A){f.ensureSingle(_,"text","selector-text",function(S){S.attr("text-anchor","middle")}).call(e.font,x.font).text(function(S,w){return S.label?w?f.templateString(S.label,w):S.label:S.step==="all"?"all":S.count+S.step.charAt(0)}(T,A._fullLayout._meta)).call(function(S){i.convertToTspans(S,A)})}N.exports=function(_){var x=_._fullLayout._infolayer.selectAll(".rangeselector").data(function(T){for(var A=s.list(T,"x",!0),S=[],w=0;w<A.length;w++){var L=A[w];L.rangeselector&&L.rangeselector.visible&&S.push(L)}return S}(_),l);x.enter().append("g").classed("rangeselector",!0),x.exit().remove(),x.style({cursor:"pointer","pointer-events":"all"}),x.each(function(T){var A=t.select(this),S=T,w=S.rangeselector,L=A.selectAll("g.button").data(f.filterVisible(w.buttons));L.enter().append("g").classed("button",!0),L.exit().remove(),L.each(function(k){var C=t.select(this),M=d(S,k);k._isActive=function(P,O,F){if(O.step==="all")return P.autorange===!0;var j=Object.keys(F);return P.range[0]===F[j[0]]&&P.range[1]===F[j[1]]}(S,k,M),C.call(y,w,k),C.call(v,w,k,_),C.on("click",function(){_._dragged||m.call("_guiRelayout",_,M)}),C.on("mouseover",function(){k._isHovered=!0,C.call(y,w,k)}),C.on("mouseout",function(){k._isHovered=!1,C.call(y,w,k)})}),function(k,C,M,P,O){var F=0,j=0,W=M.borderwidth;C.each(function(){var K=t.select(this).select(".selector-text"),D=M.font.size*a,B=Math.max(D*i.lineCount(K),16)+3;j=Math.max(j,B)}),C.each(function(){var K=t.select(this),D=K.select(".selector-rect"),B=K.select(".selector-text"),q=B.node()&&e.bBox(B.node()).width,ee=M.font.size*a,J=i.lineCount(B),$=Math.max(q+10,n.minButtonWidth);K.attr("transform",u(W+F,W)),D.attr({x:0,y:0,width:$,height:j}),i.positionText(B,$/2,j/2-(J-1)*ee/2+3),F+=$+5});var Z=k._fullLayout._size,Q=Z.l+Z.w*M.x,X=Z.t+Z.h*(1-M.y),G="left";f.isRightAnchor(M)&&(Q-=F,G="right"),f.isCenterAnchor(M)&&(Q-=F/2,G="center");var Y="top";f.isBottomAnchor(M)&&(X-=j,Y="bottom"),f.isMiddleAnchor(M)&&(X-=j/2,Y="middle"),F=Math.ceil(F),j=Math.ceil(j),Q=Math.round(Q),X=Math.round(X),g.autoMargin(k,P+"-range-selector",{x:M.x,y:M.y,l:F*c[G],r:F*r[G],b:j*r[Y],t:j*c[Y]}),O.attr("transform",u(Q,X))}(_,L,w,S._name,A)})}},{"../../constants/alignment":755,"../../lib":787,"../../lib/svg_text_utils":813,"../../plots/cartesian/axis_ids":842,"../../plots/plots":901,"../../registry":915,"../color":650,"../drawing":672,"./constants":717,"./get_update_object":720,"@plotly/d3":58}],720:[function(h,N,H){var t=h("d3-time"),m=h("../../lib").titleCase;N.exports=function(g,p){var e=g._name,f={};if(p.step==="all")f[e+".autorange"]=!0;else{var u=function(i,s){var o,a=i.range,c=new Date(i.r2l(a[1])),r=s.step,n=t["utc"+m(r)],d=s.count;switch(s.stepmode){case"backward":o=i.l2r(+n.offset(c,-d));break;case"todate":var l=n.offset(c,-d);o=i.l2r(+n.ceil(l))}var y=a[1];return[o,y]}(g,p);f[e+".range[0]"]=u[0],f[e+".range[1]"]=u[1]}return f}},{"../../lib":787,"d3-time":174}],721:[function(h,N,H){N.exports={moduleType:"component",name:"rangeselector",schema:{subplots:{xaxis:{rangeselector:h("./attributes")}}},layoutAttributes:h("./attributes"),handleDefaults:h("./defaults"),draw:h("./draw")}},{"./attributes":716,"./defaults":718,"./draw":719}],722:[function(h,N,H){var t=h("../color/attributes");N.exports={bgcolor:{valType:"color",dflt:t.background,editType:"plot"},bordercolor:{valType:"color",dflt:t.defaultLine,editType:"plot"},borderwidth:{valType:"integer",dflt:0,min:0,editType:"plot"},autorange:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},range:{valType:"info_array",items:[{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}}],editType:"calc",impliedEdits:{autorange:!1}},thickness:{valType:"number",dflt:.15,min:0,max:1,editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"}},{"../color/attributes":649}],723:[function(h,N,H){var t=h("../../plots/cartesian/axis_ids").list,m=h("../../plots/cartesian/autorange").getAutoRange,g=h("./constants");N.exports=function(p){for(var e=t(p,"x",!0),f=0;f<e.length;f++){var u=e[f],i=u[g.name];i&&i.visible&&i.autorange&&(i._input.autorange=!0,i._input.range=i.range=m(p,u))}}},{"../../plots/cartesian/autorange":837,"../../plots/cartesian/axis_ids":842,"./constants":724}],724:[function(h,N,H){N.exports={name:"rangeslider",containerClassName:"rangeslider-container",bgClassName:"rangeslider-bg",rangePlotClassName:"rangeslider-rangeplot",maskMinClassName:"rangeslider-mask-min",maskMaxClassName:"rangeslider-mask-max",slideBoxClassName:"rangeslider-slidebox",grabberMinClassName:"rangeslider-grabber-min",grabAreaMinClassName:"rangeslider-grabarea-min",handleMinClassName:"rangeslider-handle-min",grabberMaxClassName:"rangeslider-grabber-max",grabAreaMaxClassName:"rangeslider-grabarea-max",handleMaxClassName:"rangeslider-handle-max",maskMinOppAxisClassName:"rangeslider-mask-min-opp-axis",maskMaxOppAxisClassName:"rangeslider-mask-max-opp-axis",maskColor:"rgba(0,0,0,0.4)",maskOppAxisColor:"rgba(0,0,0,0.2)",slideBoxFill:"transparent",slideBoxCursor:"ew-resize",grabAreaFill:"transparent",grabAreaCursor:"col-resize",grabAreaWidth:10,handleWidth:4,handleRadius:1,handleStrokeWidth:1,extraPad:15}},{}],725:[function(h,N,H){var t=h("../../lib"),m=h("../../plot_api/plot_template"),g=h("../../plots/cartesian/axis_ids"),p=h("./attributes"),e=h("./oppaxis_attributes");N.exports=function(f,u,i){var s=f[i],o=u[i];if(s.rangeslider||u._requestRangeslider[o._id]){t.isPlainObject(s.rangeslider)||(s.rangeslider={});var a,c,r=s.rangeslider,n=m.newContainer(o,"rangeslider");if(A("visible")){A("bgcolor",u.plot_bgcolor),A("bordercolor"),A("borderwidth"),A("thickness"),A("autorange",!o.isValidRange(r.range)),A("range");var d=u._subplots;if(d)for(var l=d.cartesian.filter(function(w){return w.substr(0,w.indexOf("y"))===g.name2id(i)}).map(function(w){return w.substr(w.indexOf("y"),w.length)}),y=t.simpleMap(l,g.id2name),v=0;v<y.length;v++){var _=y[v];a=r[_]||{},c=m.newContainer(n,_,"yaxis");var x,T=u[_];a.range&&T.isValidRange(a.range)&&(x="fixed"),S("rangemode",x)!=="match"&&S("range",T.range.slice())}n._input=r}}function A(w,L){return t.coerce(r,n,p,w,L)}function S(w,L){return t.coerce(a,c,e,w,L)}}},{"../../lib":787,"../../plot_api/plot_template":827,"../../plots/cartesian/axis_ids":842,"./attributes":722,"./oppaxis_attributes":729}],726:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../registry"),g=h("../../plots/plots"),p=h("../../lib"),e=p.strTranslate,f=h("../drawing"),u=h("../color"),i=h("../titles"),s=h("../../plots/cartesian"),o=h("../../plots/cartesian/axis_ids"),a=h("../dragelement"),c=h("../../lib/setcursor"),r=h("./constants");function n(x,T,A,S){var w=p.ensureSingle(x,"rect",r.bgClassName,function(M){M.attr({x:0,y:0,"shape-rendering":"crispEdges"})}),L=S.borderwidth%2==0?S.borderwidth:S.borderwidth-1,k=-S._offsetShift,C=f.crispRound(T,S.borderwidth);w.attr({width:S._width+L,height:S._height+L,transform:e(k,k),fill:S.bgcolor,stroke:S.bordercolor,"stroke-width":C})}function d(x,T,A,S){var w=T._fullLayout;p.ensureSingleById(w._topdefs,"clipPath",S._clipId,function(L){L.append("rect").attr({x:0,y:0})}).select("rect").attr({width:S._width,height:S._height})}function l(x,T,A,S){var w,L=T.calcdata,k=x.selectAll("g."+r.rangePlotClassName).data(A._subplotsWith,p.identity);k.enter().append("g").attr("class",function(C){return r.rangePlotClassName+" "+C}).call(f.setClipUrl,S._clipId,T),k.order(),k.exit().remove(),k.each(function(C,M){var P=t.select(this),O=M===0,F=o.getFromId(T,C,"y"),j=F._name,W=S[j],Z={data:[],layout:{xaxis:{type:A.type,domain:[0,1],range:S.range.slice(),calendar:A.calendar},width:S._width,height:S._height,margin:{t:0,b:0,l:0,r:0}},_context:T._context};A.rangebreaks&&(Z.layout.xaxis.rangebreaks=A.rangebreaks),Z.layout[j]={type:F.type,domain:[0,1],range:W.rangemode!=="match"?W.range.slice():F.range.slice(),calendar:F.calendar},F.rangebreaks&&(Z.layout[j].rangebreaks=F.rangebreaks),g.supplyDefaults(Z);var Q=Z._fullLayout.xaxis,X=Z._fullLayout[j];Q.clearCalc(),Q.setScale(),X.clearCalc(),X.setScale();var G={id:C,plotgroup:P,xaxis:Q,yaxis:X,isRangePlot:!0};O?w=G:(G.mainplot="xy",G.mainplotinfo=w),s.rangePlot(T,G,function(Y,K){for(var D=[],B=0;B<Y.length;B++){var q=Y[B],ee=q[0].trace;ee.xaxis+ee.yaxis===K&&D.push(q)}return D}(L,C))})}function y(x,T,A,S,w){p.ensureSingle(x,"rect",r.maskMinClassName,function(L){L.attr({x:0,y:0,"shape-rendering":"crispEdges"})}).attr("height",S._height).call(u.fill,r.maskColor),p.ensureSingle(x,"rect",r.maskMaxClassName,function(L){L.attr({y:0,"shape-rendering":"crispEdges"})}).attr("height",S._height).call(u.fill,r.maskColor),w.rangemode!=="match"&&(p.ensureSingle(x,"rect",r.maskMinOppAxisClassName,function(L){L.attr({y:0,"shape-rendering":"crispEdges"})}).attr("width",S._width).call(u.fill,r.maskOppAxisColor),p.ensureSingle(x,"rect",r.maskMaxOppAxisClassName,function(L){L.attr({y:0,"shape-rendering":"crispEdges"})}).attr("width",S._width).style("border-top",r.maskOppBorder).call(u.fill,r.maskOppAxisColor))}function v(x,T,A,S){T._context.staticPlot||p.ensureSingle(x,"rect",r.slideBoxClassName,function(w){w.attr({y:0,cursor:r.slideBoxCursor,"shape-rendering":"crispEdges"})}).attr({height:S._height,fill:r.slideBoxFill})}function _(x,T,A,S){var w=p.ensureSingle(x,"g",r.grabberMinClassName),L=p.ensureSingle(x,"g",r.grabberMaxClassName),k={x:0,width:r.handleWidth,rx:r.handleRadius,fill:u.background,stroke:u.defaultLine,"stroke-width":r.handleStrokeWidth,"shape-rendering":"crispEdges"},C={y:Math.round(S._height/4),height:Math.round(S._height/2)};p.ensureSingle(w,"rect",r.handleMinClassName,function(P){P.attr(k)}).attr(C),p.ensureSingle(L,"rect",r.handleMaxClassName,function(P){P.attr(k)}).attr(C);var M={width:r.grabAreaWidth,x:0,y:0,fill:r.grabAreaFill,cursor:T._context.staticPlot?void 0:r.grabAreaCursor};p.ensureSingle(w,"rect",r.grabAreaMinClassName,function(P){P.attr(M)}).attr("height",S._height),p.ensureSingle(L,"rect",r.grabAreaMaxClassName,function(P){P.attr(M)}).attr("height",S._height)}N.exports=function(x){for(var T=x._fullLayout,A=T._rangeSliderData,S=0;S<A.length;S++){var w=A[S][r.name];w._clipId=w._id+"-"+T._uid}var L=T._infolayer.selectAll("g."+r.containerClassName).data(A,function(k){return k._name});L.exit().each(function(k){var C=k[r.name];T._topdefs.select("#"+C._clipId).remove()}).remove(),A.length!==0&&(L.enter().append("g").classed(r.containerClassName,!0).attr("pointer-events","all"),L.each(function(k){var C=t.select(this),M=k[r.name],P=T[o.id2name(k.anchor)],O=M[o.id2name(k.anchor)];if(M.range){var F,j=p.simpleMap(M.range,k.r2l),W=p.simpleMap(k.range,k.r2l);F=W[0]<W[1]?[Math.min(j[0],W[0]),Math.max(j[1],W[1])]:[Math.max(j[0],W[0]),Math.min(j[1],W[1])],M.range=M._input.range=p.simpleMap(F,k.l2r)}k.cleanRange("rangeslider.range");var Z=T._size,Q=k.domain;M._width=Z.w*(Q[1]-Q[0]);var X=Math.round(Z.l+Z.w*Q[0]),G=Math.round(Z.t+Z.h*(1-k._counterDomainMin)+(k.side==="bottom"?k._depth:0)+M._offsetShift+r.extraPad);C.attr("transform",e(X,G)),M._rl=p.simpleMap(M.range,k.r2l);var Y=M._rl[0],K=M._rl[1],D=K-Y;if(M.p2d=function(he){return he/M._width*D+Y},M.d2p=function(he){return(he-Y)/D*M._width},k.rangebreaks){var B=k.locateBreaks(Y,K);if(B.length){var q,ee,J=0;for(q=0;q<B.length;q++)J+=(ee=B[q]).max-ee.min;var $=M._width/(K-Y-J),te=[-$*Y];for(q=0;q<B.length;q++)ee=B[q],te.push(te[te.length-1]-$*(ee.max-ee.min));for(M.d2p=function(he){for(var se=te[0],de=0;de<B.length;de++){var ce=B[de];if(he>=ce.max)se=te[de+1];else if(he<ce.min)break}return se+$*he},q=0;q<B.length;q++)(ee=B[q]).pmin=M.d2p(ee.min),ee.pmax=M.d2p(ee.max);M.p2d=function(he){for(var se=te[0],de=0;de<B.length;de++){var ce=B[de];if(he>=ce.pmax)se=te[de+1];else if(he<ce.pmin)break}return(he-se)/$}}}if(O.rangemode!=="match"){var ie=P.r2l(O.range[0]),ae=P.r2l(O.range[1])-ie;M.d2pOppAxis=function(he){return(he-ie)/ae*M._height}}C.call(n,x,k,M).call(d,x,k,M).call(l,x,k,M).call(y,x,k,M,O).call(v,x,k,M).call(_,x,k,M),function(he,se,de,ce){if(se._context.staticPlot)return;var ve=he.select("rect."+r.slideBoxClassName).node(),ke=he.select("rect."+r.grabAreaMinClassName).node(),Ee=he.select("rect."+r.grabAreaMaxClassName).node();function be(){var xe=t.event,ue=xe.target,me=xe.clientX||xe.touches[0].clientX,we=me-he.node().getBoundingClientRect().left,Me=ce.d2p(de._rl[0]),Se=ce.d2p(de._rl[1]),De=a.coverSlip();function Fe(et){var Oe,je,We,Ge=+(et.clientX||et.touches[0].clientX)-me;switch(ue){case ve:We="ew-resize",Oe=Me+Ge,je=Se+Ge;break;case ke:We="col-resize",Oe=Me+Ge,je=Se;break;case Ee:We="col-resize",Oe=Me,je=Se+Ge;break;default:We="ew-resize",Oe=we,je=we+Ge}if(je<Oe){var Qe=je;je=Oe,Oe=Qe}ce._pixelMin=Oe,ce._pixelMax=je,c(t.select(De),We),function(it,lt,Lt,wt){function rt(Qt){return Lt.l2r(p.constrain(Qt,wt._rl[0],wt._rl[1]))}var $e=rt(wt.p2d(wt._pixelMin)),xt=rt(wt.p2d(wt._pixelMax));window.requestAnimationFrame(function(){m.call("_guiRelayout",lt,Lt._name+".range",[$e,xt])})}(0,se,de,ce)}function Ye(){De.removeEventListener("mousemove",Fe),De.removeEventListener("mouseup",Ye),this.removeEventListener("touchmove",Fe),this.removeEventListener("touchend",Ye),p.removeElement(De)}this.addEventListener("touchmove",Fe),this.addEventListener("touchend",Ye),De.addEventListener("mousemove",Fe),De.addEventListener("mouseup",Ye)}he.on("mousedown",be),he.on("touchstart",be)}(C,x,k,M),function(he,se,de,ce,ve,ke){var Ee=r.handleWidth/2;function be(Ye){return p.constrain(Ye,0,ce._width)}function xe(Ye){return p.constrain(Ye,0,ce._height)}function ue(Ye){return p.constrain(Ye,-Ee,ce._width+Ee)}var me=be(ce.d2p(de._rl[0])),we=be(ce.d2p(de._rl[1]));if(he.select("rect."+r.slideBoxClassName).attr("x",me).attr("width",we-me),he.select("rect."+r.maskMinClassName).attr("width",me),he.select("rect."+r.maskMaxClassName).attr("x",we).attr("width",ce._width-we),ke.rangemode!=="match"){var Me=ce._height-xe(ce.d2pOppAxis(ve._rl[1])),Se=ce._height-xe(ce.d2pOppAxis(ve._rl[0]));he.select("rect."+r.maskMinOppAxisClassName).attr("x",me).attr("height",Me).attr("width",we-me),he.select("rect."+r.maskMaxOppAxisClassName).attr("x",me).attr("y",Se).attr("height",ce._height-Se).attr("width",we-me),he.select("rect."+r.slideBoxClassName).attr("y",Me).attr("height",Se-Me)}var De=Math.round(ue(me-Ee))-.5,Fe=Math.round(ue(we-Ee))+.5;he.select("g."+r.grabberMinClassName).attr("transform",e(De,.5)),he.select("g."+r.grabberMaxClassName).attr("transform",e(Fe,.5))}(C,0,k,M,P,O),k.side==="bottom"&&i.draw(x,k._id+"title",{propContainer:k,propName:k._name+".title",placeholder:T._dfltTitle.x,attributes:{x:k._offset+k._length/2,y:G+M._height+M._offsetShift+10+1.5*k.title.font.size,"text-anchor":"middle"}})}))}},{"../../lib":787,"../../lib/setcursor":808,"../../plots/cartesian":852,"../../plots/cartesian/axis_ids":842,"../../plots/plots":901,"../../registry":915,"../color":650,"../dragelement":669,"../drawing":672,"../titles":748,"./constants":724,"@plotly/d3":58}],727:[function(h,N,H){var t=h("../../plots/cartesian/axis_ids"),m=h("../../lib/svg_text_utils"),g=h("./constants"),p=h("../../constants/alignment").LINE_SPACING,e=g.name;function f(u){var i=u&&u[e];return i&&i.visible}H.isVisible=f,H.makeData=function(u){var i=t.list({_fullLayout:u},"x",!0),s=u.margin,o=[];if(!u._has("gl2d"))for(var a=0;a<i.length;a++){var c=i[a];if(f(c)){o.push(c);var r=c[e];r._id=e+c._id,r._height=(u.height-s.b-s.t)*r.thickness,r._offsetShift=Math.floor(r.borderwidth/2)}}u._rangeSliderData=o},H.autoMarginOpts=function(u,i){var s=u._fullLayout,o=i[e],a=i._id.charAt(0),c=0,r=0;return i.side==="bottom"&&(c=i._depth,i.title.text!==s._dfltTitle[a]&&(r=1.5*i.title.font.size+10+o._offsetShift,r+=(i.title.text.match(m.BR_TAG_ALL)||[]).length*i.title.font.size*p)),{x:0,y:i._counterDomainMin,l:0,r:0,t:0,b:o._height+c+Math.max(s.margin.b,r),pad:g.extraPad+2*o._offsetShift}}},{"../../constants/alignment":755,"../../lib/svg_text_utils":813,"../../plots/cartesian/axis_ids":842,"./constants":724}],728:[function(h,N,H){var t=h("../../lib"),m=h("./attributes"),g=h("./oppaxis_attributes"),p=h("./helpers");N.exports={moduleType:"component",name:"rangeslider",schema:{subplots:{xaxis:{rangeslider:t.extendFlat({},m,{yaxis:g})}}},layoutAttributes:h("./attributes"),handleDefaults:h("./defaults"),calcAutorange:h("./calc_autorange"),draw:h("./draw"),isVisible:p.isVisible,makeData:p.makeData,autoMarginOpts:p.autoMarginOpts}},{"../../lib":787,"./attributes":722,"./calc_autorange":723,"./defaults":725,"./draw":726,"./helpers":727,"./oppaxis_attributes":729}],729:[function(h,N,H){N.exports={_isSubplotObj:!0,rangemode:{valType:"enumerated",values:["auto","fixed","match"],dflt:"match",editType:"calc"},range:{valType:"info_array",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},editType:"calc"}},{}],730:[function(h,N,H){var t=h("../annotations/attributes"),m=h("../../traces/scatter/attributes").line,g=h("../drawing/attributes").dash,p=h("../../lib/extend").extendFlat,e=h("../../plot_api/plot_template").templatedArray;h("../../constants/axis_placeable_objects"),N.exports=e("shape",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},type:{valType:"enumerated",values:["circle","rect","path","line"],editType:"calc+arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},xref:p({},t.xref,{}),xsizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},xanchor:{valType:"any",editType:"calc+arraydraw"},x0:{valType:"any",editType:"calc+arraydraw"},x1:{valType:"any",editType:"calc+arraydraw"},yref:p({},t.yref,{}),ysizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},yanchor:{valType:"any",editType:"calc+arraydraw"},y0:{valType:"any",editType:"calc+arraydraw"},y1:{valType:"any",editType:"calc+arraydraw"},path:{valType:"string",editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},line:{color:p({},m.color,{editType:"arraydraw"}),width:p({},m.width,{editType:"calc+arraydraw"}),dash:p({},g,{editType:"arraydraw"}),editType:"calc+arraydraw"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"arraydraw"},editable:{valType:"boolean",dflt:!1,editType:"calc+arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":756,"../../lib/extend":777,"../../plot_api/plot_template":827,"../../traces/scatter/attributes":1202,"../annotations/attributes":633,"../drawing/attributes":671}],731:[function(h,N,H){var t=h("../../lib"),m=h("../../plots/cartesian/axes"),g=h("./constants"),p=h("./helpers");function e(s){return u(s.line.width,s.xsizemode,s.x0,s.x1,s.path,!1)}function f(s){return u(s.line.width,s.ysizemode,s.y0,s.y1,s.path,!0)}function u(s,o,a,c,r,n){var d=s/2,l=n;if(o==="pixel"){var y=r?p.extractPathCoords(r,n?g.paramIsY:g.paramIsX):[a,c],v=t.aggNums(Math.max,null,y),_=t.aggNums(Math.min,null,y),x=_<0?Math.abs(_)+d:d,T=v>0?v+d:d;return{ppad:d,ppadplus:l?x:T,ppadminus:l?T:x}}return{ppad:d}}function i(s,o,a,c,r){var n=s.type==="category"||s.type==="multicategory"?s.r2c:s.d2c;if(o!==void 0)return[n(o),n(a)];if(c){var d,l,y,v,_=1/0,x=-1/0,T=c.match(g.segmentRE);for(s.type==="date"&&(n=p.decodeDate(n)),d=0;d<T.length;d++)(l=r[T[d].charAt(0)].drawn)!==void 0&&(!(y=T[d].substr(1).match(g.paramRE))||y.length<l||((v=n(y[l]))<_&&(_=v),v>x&&(x=v)));return x>=_?[_,x]:void 0}}N.exports=function(s){var o=s._fullLayout,a=t.filterVisible(o.shapes);if(a.length&&s._fullData.length)for(var c=0;c<a.length;c++){var r,n,d=a[c];d._extremes={};var l=m.getRefType(d.xref),y=m.getRefType(d.yref);if(d.xref!=="paper"&&l!=="domain"){var v=d.xsizemode==="pixel"?d.xanchor:d.x0,_=d.xsizemode==="pixel"?d.xanchor:d.x1;(n=i(r=m.getFromId(s,d.xref),v,_,d.path,g.paramIsX))&&(d._extremes[r._id]=m.findExtremes(r,n,e(d)))}if(d.yref!=="paper"&&y!=="domain"){var x=d.ysizemode==="pixel"?d.yanchor:d.y0,T=d.ysizemode==="pixel"?d.yanchor:d.y1;(n=i(r=m.getFromId(s,d.yref),x,T,d.path,g.paramIsY))&&(d._extremes[r._id]=m.findExtremes(r,n,f(d)))}}}},{"../../lib":787,"../../plots/cartesian/axes":838,"./constants":732,"./helpers":741}],732:[function(h,N,H){N.exports={segmentRE:/[MLHVQCTSZ][^MLHVQCTSZ]*/g,paramRE:/[^\s,]+/g,paramIsX:{M:{0:!0,drawn:0},L:{0:!0,drawn:0},H:{0:!0,drawn:0},V:{},Q:{0:!0,2:!0,drawn:2},C:{0:!0,2:!0,4:!0,drawn:4},T:{0:!0,drawn:0},S:{0:!0,2:!0,drawn:2},Z:{}},paramIsY:{M:{1:!0,drawn:1},L:{1:!0,drawn:1},H:{},V:{0:!0,drawn:0},Q:{1:!0,3:!0,drawn:3},C:{1:!0,3:!0,5:!0,drawn:5},T:{1:!0,drawn:1},S:{1:!0,3:!0,drawn:5},Z:{}},numParams:{M:2,L:2,H:1,V:1,Q:4,C:6,T:2,S:4,Z:0}}},{}],733:[function(h,N,H){var t=h("../../lib"),m=h("../../plots/cartesian/axes"),g=h("../../plots/array_container_defaults"),p=h("./attributes"),e=h("./helpers");function f(u,i,s){function o(O,F){return t.coerce(u,i,p,O,F)}if(o("visible")){var a=o("path"),c=o("type",a?"path":"rect");i.type!=="path"&&delete i.path,o("editable"),o("layer"),o("opacity"),o("fillcolor"),o("fillrule"),o("line.width")&&(o("line.color"),o("line.dash"));for(var r=o("xsizemode"),n=o("ysizemode"),d=["x","y"],l=0;l<2;l++){var y,v,_,x=d[l],T=x+"anchor",A=x==="x"?r:n,S={_fullLayout:s},w=m.coerceRef(u,i,S,x,void 0,"paper");if(m.getRefType(w)==="range"?((y=m.getFromId(S,w))._shapeIndices.push(i._index),_=e.rangeToShapePosition(y),v=e.shapePositionToRange(y)):v=_=t.identity,c!=="path"){var L=x+"0",k=x+"1",C=u[L],M=u[k];u[L]=v(u[L],!0),u[k]=v(u[k],!0),A==="pixel"?(o(L,0),o(k,10)):(m.coercePosition(i,S,o,w,L,.25),m.coercePosition(i,S,o,w,k,.75)),i[L]=_(i[L]),i[k]=_(i[k]),u[L]=C,u[k]=M}if(A==="pixel"){var P=u[T];u[T]=v(u[T],!0),m.coercePosition(i,S,o,w,T,.25),i[T]=_(i[T]),u[T]=P}}c==="path"?o("path"):t.noneOrAll(u,i,["x0","x1","y0","y1"])}}N.exports=function(u,i){g(u,i,{name:"shapes",handleItemDefaults:f})}},{"../../lib":787,"../../plots/array_container_defaults":833,"../../plots/cartesian/axes":838,"./attributes":730,"./helpers":741}],734:[function(h,N,H){var t=h("../../registry"),m=h("../../lib"),g=h("../../plots/cartesian/axes"),p=h("./draw_newshape/helpers").readPaths,e=h("./draw_newshape/display_outlines"),f=h("../../plots/cartesian/handle_outline").clearOutlineControllers,u=h("../color"),i=h("../drawing"),s=h("../../plot_api/plot_template").arrayEditor,o=h("../dragelement"),a=h("../../lib/setcursor"),c=h("./constants"),r=h("./helpers");function n(A){var S=A._fullLayout;for(var w in S._shapeUpperLayer.selectAll("path").remove(),S._shapeLowerLayer.selectAll("path").remove(),S._plots){var L=S._plots[w].shapelayer;L&&L.selectAll("path").remove()}for(var k=0;k<S.shapes.length;k++)S.shapes[k].visible&&y(A,k)}function d(A){return!!A._fullLayout._drawing}function l(A){return!A._context.edits.shapePosition}function y(A,S){A._fullLayout._paperdiv.selectAll('.shapelayer [data-index="'+S+'"]').remove();var w=r.makeOptionsAndPlotinfo(A,S),L=w.options,k=w.plotinfo;L._input&&L.visible!==!1&&(L.layer!=="below"?C(A._fullLayout._shapeUpperLayer):L.xref==="paper"||L.yref==="paper"?C(A._fullLayout._shapeLowerLayer):k._hadPlotinfo?C((k.mainplotinfo||k).shapelayer):C(A._fullLayout._shapeLowerLayer));function C(M){var P=_(A,L),O={"data-index":S,"fill-rule":L.fillrule,d:P},F=L.opacity,j=L.fillcolor,W=L.line.width?L.line.color:"rgba(0,0,0,0)",Z=L.line.width,Q=L.line.dash;Z||L.editable!==!0||(Z=5,Q="solid");var X=P[P.length-1]!=="Z",G=l(A)&&L.editable&&A._fullLayout._activeShapeIndex===S;G&&(j=X?"rgba(0,0,0,0)":A._fullLayout.activeshape.fillcolor,F=A._fullLayout.activeshape.opacity);var Y,K=M.append("path").attr(O).style("opacity",F).call(u.stroke,W).call(u.fill,j).call(i.dashLine,Q,Z);if(v(K,A,L),(G||A._context.edits.shapePosition)&&(Y=s(A.layout,"shapes",L)),G){K.style({cursor:"move"});var D={element:K.node(),plotinfo:k,gd:A,editHelpers:Y,isActiveShape:!0},B=p(P,A);e(B,K,D)}else A._context.edits.shapePosition?function(q,ee,J,$,te,ie){var ae,he,se,de,ce,ve,ke,Ee,be,xe,ue,me,we,Me,Se,De,Fe=J.xsizemode==="pixel",Ye=J.ysizemode==="pixel",et=J.type==="line",Oe=J.type==="path",je=ie.modifyItem,We=g.getFromId(q,J.xref),Ge=g.getRefType(J.xref),Qe=g.getFromId(q,J.yref),it=g.getRefType(J.yref),lt=r.getDataToPixel(q,We,!1,Ge),Lt=r.getDataToPixel(q,Qe,!0,it),wt=r.getPixelToData(q,We,!1,Ge),rt=r.getPixelToData(q,Qe,!0,it),$e=et?function(){var Je=Math.max(J.line.width,10),_e=te.append("g").attr("data-index",$);_e.append("path").attr("d",ee.attr("d")).style({cursor:"move","stroke-width":Je,"stroke-opacity":"0"});var Le={"fill-opacity":"0"},Ce=Math.max(Je/2,10);return _e.append("circle").attr({"data-line-point":"start-point",cx:Fe?lt(J.xanchor)+J.x0:lt(J.x0),cy:Ye?Lt(J.yanchor)-J.y0:Lt(J.y0),r:Ce}).style(Le).classed("cursor-grab",!0),_e.append("circle").attr({"data-line-point":"end-point",cx:Fe?lt(J.xanchor)+J.x1:lt(J.x1),cy:Ye?Lt(J.yanchor)-J.y1:Lt(J.y1),r:Ce}).style(Le).classed("cursor-grab",!0),_e}():ee,xt={element:$e.node(),gd:q,prepFn:function(Je){d(q)||(Fe&&(ce=lt(J.xanchor)),Ye&&(ve=Lt(J.yanchor)),J.type==="path"?Se=J.path:(ae=Fe?J.x0:lt(J.x0),he=Ye?J.y0:Lt(J.y0),se=Fe?J.x1:lt(J.x1),de=Ye?J.y1:Lt(J.y1)),ae<se?(be=ae,we="x0",xe=se,Me="x1"):(be=se,we="x1",xe=ae,Me="x0"),!Ye&&he<de||Ye&&he>de?(ke=he,ue="y0",Ee=de,me="y1"):(ke=de,ue="y1",Ee=he,me="y0"),Qt(Je),He(te,J),function(_e,Le,Ce){var Pe=Le.xref,Xe=Le.yref,ut=g.getFromId(Ce,Pe),kt=g.getFromId(Ce,Xe),ft="";Pe==="paper"||ut.autorange||(ft+=Pe),Xe==="paper"||kt.autorange||(ft+=Xe),i.setClipUrl(_e,ft?"clip"+Ce._fullLayout._uid+ft:null,Ce)}(ee,J,q),xt.moveFn=De==="move"?$t:Ue,xt.altKey=Je.altKey)},doneFn:function(){d(q)||(a(ee),Be(te),v(ee,q,J),t.call("_guiRelayout",q,ie.getUpdateObj()))},clickFn:function(){d(q)||Be(te)}};function Qt(Je){if(d(q))De=null;else if(et)De=Je.target.tagName==="path"?"move":Je.target.attributes["data-line-point"].value==="start-point"?"resize-over-start-point":"resize-over-end-point";else{var _e=xt.element.getBoundingClientRect(),Le=_e.right-_e.left,Ce=_e.bottom-_e.top,Pe=Je.clientX-_e.left,Xe=Je.clientY-_e.top,ut=!Oe&&Le>10&&Ce>10&&!Je.shiftKey?o.getCursor(Pe/Le,1-Xe/Ce):"move";a(ee,ut),De=ut.split("-")[0]}}function $t(Je,_e){if(J.type==="path"){var Le=function(Xe){return Xe},Ce=Le,Pe=Le;Fe?je("xanchor",J.xanchor=wt(ce+Je)):(Ce=function(Xe){return wt(lt(Xe)+Je)},We&&We.type==="date"&&(Ce=r.encodeDate(Ce))),Ye?je("yanchor",J.yanchor=rt(ve+_e)):(Pe=function(Xe){return rt(Lt(Xe)+_e)},Qe&&Qe.type==="date"&&(Pe=r.encodeDate(Pe))),je("path",J.path=x(Se,Ce,Pe))}else Fe?je("xanchor",J.xanchor=wt(ce+Je)):(je("x0",J.x0=wt(ae+Je)),je("x1",J.x1=wt(se+Je))),Ye?je("yanchor",J.yanchor=rt(ve+_e)):(je("y0",J.y0=rt(he+_e)),je("y1",J.y1=rt(de+_e)));ee.attr("d",_(q,J)),He(te,J)}function Ue(Je,_e){if(Oe){var Le=function(Ie){return Ie},Ce=Le,Pe=Le;Fe?je("xanchor",J.xanchor=wt(ce+Je)):(Ce=function(Ie){return wt(lt(Ie)+Je)},We&&We.type==="date"&&(Ce=r.encodeDate(Ce))),Ye?je("yanchor",J.yanchor=rt(ve+_e)):(Pe=function(Ie){return rt(Lt(Ie)+_e)},Qe&&Qe.type==="date"&&(Pe=r.encodeDate(Pe))),je("path",J.path=x(Se,Ce,Pe))}else if(et){if(De==="resize-over-start-point"){var Xe=ae+Je,ut=Ye?he-_e:he+_e;je("x0",J.x0=Fe?Xe:wt(Xe)),je("y0",J.y0=Ye?ut:rt(ut))}else if(De==="resize-over-end-point"){var kt=se+Je,ft=Ye?de-_e:de+_e;je("x1",J.x1=Fe?kt:wt(kt)),je("y1",J.y1=Ye?ft:rt(ft))}}else{var Et=function(Ie){return De.indexOf(Ie)!==-1},mt=Et("n"),It=Et("s"),vt=Et("w"),nt=Et("e"),At=mt?ke+_e:ke,Ft=It?Ee+_e:Ee,Nt=vt?be+Je:be,Kt=nt?xe+Je:xe;Ye&&(mt&&(At=ke-_e),It&&(Ft=Ee-_e)),(!Ye&&Ft-At>10||Ye&&At-Ft>10)&&(je(ue,J[ue]=Ye?At:rt(At)),je(me,J[me]=Ye?Ft:rt(Ft))),Kt-Nt>10&&(je(we,J[we]=Fe?Nt:wt(Nt)),je(Me,J[Me]=Fe?Kt:wt(Kt)))}ee.attr("d",_(q,J)),He(te,J)}function He(Je,_e){(Fe||Ye)&&function(){var Le=_e.type!=="path",Ce=Je.selectAll(".visual-cue").data([0]);Ce.enter().append("path").attr({fill:"#fff","fill-rule":"evenodd",stroke:"#000","stroke-width":1}).classed("visual-cue",!0);var Pe=lt(Fe?_e.xanchor:m.midRange(Le?[_e.x0,_e.x1]:r.extractPathCoords(_e.path,c.paramIsX))),Xe=Lt(Ye?_e.yanchor:m.midRange(Le?[_e.y0,_e.y1]:r.extractPathCoords(_e.path,c.paramIsY)));if(Pe=r.roundPositionForSharpStrokeRendering(Pe,1),Xe=r.roundPositionForSharpStrokeRendering(Xe,1),Fe&&Ye){var ut="M"+(Pe-1-1)+","+(Xe-1-1)+"h-8v2h8 v8h2v-8 h8v-2h-8 v-8h-2 Z";Ce.attr("d",ut)}else if(Fe){var kt="M"+(Pe-1-1)+","+(Xe-9-1)+"v18 h2 v-18 Z";Ce.attr("d",kt)}else{var ft="M"+(Pe-9-1)+","+(Xe-1-1)+"h18 v2 h-18 Z";Ce.attr("d",ft)}}()}function Be(Je){Je.selectAll(".visual-cue").remove()}o.init(xt),$e.node().onmousemove=Qt}(A,K,L,S,M,Y):L.editable===!0&&K.style("pointer-events",X||u.opacity(j)*F<=.5?"stroke":"all");K.node().addEventListener("click",function(){return function(q,ee){if(!!l(q)){var J=+ee.node().getAttribute("data-index");if(J>=0){if(J===q._fullLayout._activeShapeIndex)return void T(q);q._fullLayout._activeShapeIndex=J,q._fullLayout._deactivateShape=T,n(q)}}}(A,K)})}}function v(A,S,w){var L=(w.xref+w.yref).replace(/paper/g,"").replace(/[xyz][1-9]* *domain/g,"");i.setClipUrl(A,L?"clip"+S._fullLayout._uid+L:null,S)}function _(A,S){var w,L,k,C,M,P,O,F,j=S.type,W=g.getRefType(S.xref),Z=g.getRefType(S.yref),Q=g.getFromId(A,S.xref),X=g.getFromId(A,S.yref),G=A._fullLayout._size;if(Q?W==="domain"?L=function(te){return Q._offset+Q._length*te}:(w=r.shapePositionToRange(Q),L=function(te){return Q._offset+Q.r2p(w(te,!0))}):L=function(te){return G.l+G.w*te},X?Z==="domain"?C=function(te){return X._offset+X._length*(1-te)}:(k=r.shapePositionToRange(X),C=function(te){return X._offset+X.r2p(k(te,!0))}):C=function(te){return G.t+G.h*(1-te)},j==="path")return Q&&Q.type==="date"&&(L=r.decodeDate(L)),X&&X.type==="date"&&(C=r.decodeDate(C)),function(te,ie,ae){var he=te.path,se=te.xsizemode,de=te.ysizemode,ce=te.xanchor,ve=te.yanchor;return he.replace(c.segmentRE,function(ke){var Ee=0,be=ke.charAt(0),xe=c.paramIsX[be],ue=c.paramIsY[be],me=c.numParams[be],we=ke.substr(1).replace(c.paramRE,function(Me){return xe[Ee]?Me=se==="pixel"?ie(ce)+Number(Me):ie(Me):ue[Ee]&&(Me=de==="pixel"?ae(ve)-Number(Me):ae(Me)),++Ee>me&&(Me="X"),Me});return Ee>me&&(we=we.replace(/[\s,]*X.*/,""),m.log("Ignoring extra params in segment "+ke)),be+we})}(S,L,C);if(S.xsizemode==="pixel"){var Y=L(S.xanchor);M=Y+S.x0,P=Y+S.x1}else M=L(S.x0),P=L(S.x1);if(S.ysizemode==="pixel"){var K=C(S.yanchor);O=K-S.y0,F=K-S.y1}else O=C(S.y0),F=C(S.y1);if(j==="line")return"M"+M+","+O+"L"+P+","+F;if(j==="rect")return"M"+M+","+O+"H"+P+"V"+F+"H"+M+"Z";var D=(M+P)/2,B=(O+F)/2,q=Math.abs(D-M),ee=Math.abs(B-O),J="A"+q+","+ee,$=D+q+","+B;return"M"+$+J+" 0 1,1 "+(D+","+(B-ee))+J+" 0 0,1 "+$+"Z"}function x(A,S,w){return A.replace(c.segmentRE,function(L){var k=0,C=L.charAt(0),M=c.paramIsX[C],P=c.paramIsY[C],O=c.numParams[C];return C+L.substr(1).replace(c.paramRE,function(F){return k>=O||(M[k]?F=S(F):P[k]&&(F=w(F)),k++),F})})}function T(A){l(A)&&A._fullLayout._activeShapeIndex>=0&&(f(A),delete A._fullLayout._activeShapeIndex,n(A))}N.exports={draw:n,drawOne:y,eraseActiveShape:function(A){if(!!l(A)){f(A);var S=A._fullLayout._activeShapeIndex,w=(A.layout||{}).shapes||[];if(S<w.length){for(var L=[],k=0;k<w.length;k++)k!==S&&L.push(w[k]);delete A._fullLayout._activeShapeIndex,t.call("_guiRelayout",A,{shapes:L})}}}}},{"../../lib":787,"../../lib/setcursor":808,"../../plot_api/plot_template":827,"../../plots/cartesian/axes":838,"../../plots/cartesian/handle_outline":849,"../../registry":915,"../color":650,"../dragelement":669,"../drawing":672,"./constants":732,"./draw_newshape/display_outlines":738,"./draw_newshape/helpers":739,"./helpers":741}],735:[function(h,N,H){var t=h("../../drawing/attributes").dash,m=h("../../../lib/extend").extendFlat;N.exports={newshape:{line:{color:{valType:"color",editType:"none"},width:{valType:"number",min:0,dflt:4,editType:"none"},dash:m({},t,{dflt:"solid",editType:"none"}),editType:"none"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"none"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"none"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"none"},drawdirection:{valType:"enumerated",values:["ortho","horizontal","vertical","diagonal"],dflt:"diagonal",editType:"none"},editType:"none"},activeshape:{fillcolor:{valType:"color",dflt:"rgb(255,0,255)",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:.5,editType:"none"},editType:"none"}}},{"../../../lib/extend":777,"../../drawing/attributes":671}],736:[function(h,N,H){N.exports={CIRCLE_SIDES:32,i000:0,i090:8,i180:16,i270:24,cos45:Math.cos(Math.PI/4),sin45:Math.sin(Math.PI/4),SQRT2:Math.sqrt(2)}},{}],737:[function(h,N,H){var t=h("../../color");N.exports=function(m,g,p){if(p("newshape.drawdirection"),p("newshape.layer"),p("newshape.fillcolor"),p("newshape.fillrule"),p("newshape.opacity"),p("newshape.line.width")){var e=(m||{}).plot_bgcolor||"#FFF";p("newshape.line.color",t.contrast(e)),p("newshape.line.dash")}p("activeshape.fillcolor"),p("activeshape.opacity")}},{"../../color":650}],738:[function(h,N,H){var t=h("../../dragelement"),m=h("../../dragelement/helpers").drawMode,g=h("../../../registry"),p=h("./constants"),e=p.i000,f=p.i090,u=p.i180,i=p.i270,s=h("../../../plots/cartesian/handle_outline").clearOutlineControllers,o=h("./helpers"),a=o.pointsShapeRectangle,c=o.pointsShapeEllipse,r=o.writePaths,n=h("./newshapes");N.exports=function d(l,y,v,_){_||(_=0);var x=v.gd;function T(){d(l,y,v,_++),c(l[0])&&A({redrawing:!0})}function A(Y){v.isActiveShape=!1;var K=n(y,v);Object.keys(K).length&&g.call((Y||{}).redrawing?"relayout":"_guiRelayout",x,K)}var S,w,L,k,C,M=v.isActiveShape,P=x._fullLayout._zoomlayer,O=v.dragmode;m(O)?x._fullLayout._drawing=!0:x._fullLayout._activeShapeIndex>=0&&s(x),y.attr("d",r(l)),M&&!_&&(C=function(Y,K){for(var D=0;D<K.length;D++){var B=K[D];Y[D]=[];for(var q=0;q<B.length;q++){Y[D][q]=[];for(var ee=0;ee<B[q].length;ee++)Y[D][q][ee]=B[q][ee]}}return Y}([],l),function(Y){S=[];for(var K=0;K<l.length;K++){var D=l[K],B=!a(D)&&c(D);S[K]=[];for(var q=0;q<D.length;q++)if(D[q][0]!=="Z"&&(!B||q===e||q===f||q===u||q===i)){var ee=D[q][1],J=D[q][2],$=Y.append("circle").classed("cursor-grab",!0).attr("data-i",K).attr("data-j",q).attr("cx",ee).attr("cy",J).attr("r",4).style({"mix-blend-mode":"luminosity",fill:"black",stroke:"white","stroke-width":1});S[K][q]={element:$.node(),gd:x,prepFn:F,doneFn:W,clickFn:Z},t.init(S[K][q])}}}(P.append("g").attr("class","outline-controllers")),function(){w=[],!!l.length&&(w[0]={element:y[0][0],gd:x,prepFn:X,doneFn:G},t.init(w[0]))}());function F(Y){L=+Y.srcElement.getAttribute("data-i"),k=+Y.srcElement.getAttribute("data-j"),S[L][k].moveFn=j}function j(Y,K){if(l.length){var D=C[L][k][1],B=C[L][k][2],q=l[L],ee=q.length;if(a(q)){for(var J=0;J<ee;J++)if(J!==k){var $=q[J];$[1]===q[k][1]&&($[1]=D+Y),$[2]===q[k][2]&&($[2]=B+K)}if(q[k][1]=D+Y,q[k][2]=B+K,!a(q))for(var te=0;te<ee;te++)for(var ie=0;ie<q[te].length;ie++)q[te][ie]=C[L][te][ie]}else q[k][1]=D+Y,q[k][2]=B+K;T()}}function W(){A()}function Z(Y,K){if(Y===2){L=+K.srcElement.getAttribute("data-i"),k=+K.srcElement.getAttribute("data-j");var D=l[L];a(D)||c(D)||function(){if(l.length&&l[L]&&l[L].length){for(var B=[],q=0;q<l[L].length;q++)q!==k&&B.push(l[L][q]);B.length>1&&(B.length!==2||B[1][0]!=="Z")&&(k===0&&(B[0][0]="M"),l[L]=B,T(),A())}}()}}function Q(Y,K){(function(D,B){if(l.length)for(var q=0;q<l.length;q++)for(var ee=0;ee<l[q].length;ee++)for(var J=0;J+2<l[q][ee].length;J+=2)l[q][ee][J+1]=C[q][ee][J+1]+D,l[q][ee][J+2]=C[q][ee][J+2]+B})(Y,K),T()}function X(Y){(L=+Y.srcElement.getAttribute("data-i"))||(L=0),w[L].moveFn=Q}function G(){A()}}},{"../../../plots/cartesian/handle_outline":849,"../../../registry":915,"../../dragelement":669,"../../dragelement/helpers":668,"./constants":736,"./helpers":739,"./newshapes":740}],739:[function(h,N,H){var t=h("parse-svg-path"),m=h("./constants"),g=m.CIRCLE_SIDES,p=m.SQRT2,e=h("../../../plots/cartesian/helpers"),f=e.p2r,u=e.r2p,i=[0,3,4,5,6,1,2],s=[0,3,4,1,2];function o(c,r){return Math.abs(c-r)<=1e-6}function a(c,r){var n=r[1]-c[1],d=r[2]-c[2];return Math.sqrt(n*n+d*d)}H.writePaths=function(c){var r=c.length;if(!r)return"M0,0Z";for(var n="",d=0;d<r;d++)for(var l=c[d].length,y=0;y<l;y++){var v=c[d][y][0];if(v==="Z")n+="Z";else for(var _=c[d][y].length,x=0;x<_;x++){var T=x;v==="Q"||v==="S"?T=s[x]:v==="C"&&(T=i[x]),n+=c[d][y][T],x>0&&x<_-1&&(n+=",")}}return n},H.readPaths=function(c,r,n,d){var l,y,v,_=t(c),x=[],T=-1,A=0,S=0,w=function(){y=A,v=S};w();for(var L=0;L<_.length;L++){var k,C,M,P,O=[],F=_[L][0],j=F;switch(F){case"M":T++,x[T]=[],A=+_[L][1],S=+_[L][2],O.push([j,A,S]),w();break;case"Q":case"S":k=+_[L][1],M=+_[L][2],A=+_[L][3],S=+_[L][4],O.push([j,A,S,k,M]);break;case"C":k=+_[L][1],M=+_[L][2],C=+_[L][3],P=+_[L][4],A=+_[L][5],S=+_[L][6],O.push([j,A,S,k,M,C,P]);break;case"T":case"L":A=+_[L][1],S=+_[L][2],O.push([j,A,S]);break;case"H":j="L",A=+_[L][1],O.push([j,A,S]);break;case"V":j="L",S=+_[L][1],O.push([j,A,S]);break;case"A":j="L";var W=+_[L][1],Z=+_[L][2];+_[L][4]||(W=-W,Z=-Z);var Q=A-W,X=S;for(l=1;l<=g/2;l++){var G=2*Math.PI*l/g;O.push([j,Q+W*Math.cos(G),X+Z*Math.sin(G)])}break;case"Z":A===y&&S===v||(A=y,S=v,O.push([j,A,S]))}for(var Y=(n||{}).domain,K=r._fullLayout._size,D=n&&n.xsizemode==="pixel",B=n&&n.ysizemode==="pixel",q=d===!1,ee=0;ee<O.length;ee++){for(l=0;l+2<7;l+=2){var J=O[ee][l+1],$=O[ee][l+2];J!==void 0&&$!==void 0&&(A=J,S=$,n&&(n.xaxis&&n.xaxis.p2r?(q&&(J-=n.xaxis._offset),J=D?u(n.xaxis,n.xanchor)+J:f(n.xaxis,J)):(q&&(J-=K.l),Y?J=Y.x[0]+J/K.w:J/=K.w),n.yaxis&&n.yaxis.p2r?(q&&($-=n.yaxis._offset),$=B?u(n.yaxis,n.yanchor)-$:f(n.yaxis,$)):(q&&($-=K.t),$=Y?Y.y[1]-$/K.h:1-$/K.h)),O[ee][l+1]=J,O[ee][l+2]=$)}x[T].push(O[ee].slice())}}return x},H.pointsShapeRectangle=function(c){if(c.length!==5)return!1;for(var r=1;r<3;r++)if(!o(c[0][r]-c[1][r],c[3][r]-c[2][r])||!o(c[0][r]-c[3][r],c[1][r]-c[2][r]))return!1;return!(!o(c[0][1],c[1][1])&&!o(c[0][1],c[3][1]))&&!!(a(c[0],c[1])*a(c[0],c[3]))},H.pointsShapeEllipse=function(c){var r=c.length;if(r!==g+1)return!1;r=g;for(var n=0;n<r;n++){var d=(2*r-n)%r,l=(r/2+d)%r,y=(r/2+n)%r;if(!o(a(c[n],c[y]),a(c[d],c[l])))return!1}return!0},H.handleEllipse=function(c,r,n){if(!c)return[r,n];var d=H.ellipseOver({x0:r[0],y0:r[1],x1:n[0],y1:n[1]}),l=(d.x1+d.x0)/2,y=(d.y1+d.y0)/2,v=(d.x1-d.x0)/2,_=(d.y1-d.y0)/2;v||(v=_/=p),_||(_=v/=p);for(var x=[],T=0;T<g;T++){var A=2*T*Math.PI/g;x.push([l+v*Math.cos(A),y+_*Math.sin(A)])}return x},H.ellipseOver=function(c){var r=c.x0,n=c.y0,d=c.x1,l=c.y1,y=d-r,v=l-n,_=((r-=y)+d)/2,x=((n-=v)+l)/2;return{x0:_-(y*=p),y0:x-(v*=p),x1:_+y,y1:x+v}}},{"../../../plots/cartesian/helpers":850,"./constants":736,"parse-svg-path":482}],740:[function(h,N,H){var t=h("../../dragelement/helpers"),m=t.drawMode,g=t.openMode,p=h("./constants"),e=p.i000,f=p.i090,u=p.i180,i=p.i270,s=p.cos45,o=p.sin45,a=h("../../../plots/cartesian/helpers"),c=a.p2r,r=a.r2p,n=h("../../../plots/cartesian/handle_outline").clearSelect,d=h("./helpers"),l=d.readPaths,y=d.writePaths,v=d.ellipseOver;N.exports=function(_,x){if(_.length){var T=_[0][0];if(T){var A=T.getAttribute("d"),S=x.gd,w=S._fullLayout.newshape,L=x.plotinfo,k=L.xaxis,C=L.yaxis,M=!!L.domain||!L.xaxis,P=!!L.domain||!L.yaxis,O=x.isActiveShape,F=x.dragmode,j=(S.layout||{}).shapes||[];if(!m(F)&&O!==void 0){var W=S._fullLayout._activeShapeIndex;if(W<j.length)switch(S._fullLayout.shapes[W].type){case"rect":F="drawrect";break;case"circle":F="drawcircle";break;case"line":F="drawline";break;case"path":var Z=j[W].path||"";F=Z[Z.length-1]==="Z"?"drawclosedpath":"drawopenpath"}}var Q,X=g(F),G=l(A,S,L,O),Y={editable:!0,xref:M?"paper":k._id,yref:P?"paper":C._id,layer:w.layer,opacity:w.opacity,line:{color:w.line.color,width:w.line.width,dash:w.line.dash}};if(X||(Y.fillcolor=w.fillcolor,Y.fillrule=w.fillrule),G.length===1&&(Q=G[0]),Q&&F==="drawrect")Y.type="rect",Y.x0=Q[0][1],Y.y0=Q[0][2],Y.x1=Q[2][1],Y.y1=Q[2][2];else if(Q&&F==="drawline")Y.type="line",Y.x0=Q[0][1],Y.y0=Q[0][2],Y.x1=Q[1][1],Y.y1=Q[1][2];else if(Q&&F==="drawcircle"){Y.type="circle";var K=Q[e][1],D=Q[f][1],B=Q[u][1],q=Q[i][1],ee=Q[e][2],J=Q[f][2],$=Q[u][2],te=Q[i][2],ie=L.xaxis&&(L.xaxis.type==="date"||L.xaxis.type==="log"),ae=L.yaxis&&(L.yaxis.type==="date"||L.yaxis.type==="log");ie&&(K=r(L.xaxis,K),D=r(L.xaxis,D),B=r(L.xaxis,B),q=r(L.xaxis,q)),ae&&(ee=r(L.yaxis,ee),J=r(L.yaxis,J),$=r(L.yaxis,$),te=r(L.yaxis,te));var he=(D+q)/2,se=(ee+$)/2,de=v({x0:he,y0:se,x1:he+(q-D+B-K)/2*s,y1:se+(te-J+$-ee)/2*o});ie&&(de.x0=c(L.xaxis,de.x0),de.x1=c(L.xaxis,de.x1)),ae&&(de.y0=c(L.yaxis,de.y0),de.y1=c(L.yaxis,de.y1)),Y.x0=de.x0,Y.y0=de.y0,Y.x1=de.x1,Y.y1=de.y1}else Y.type="path",k&&C&&function(ue,me,we){var Me=me.type==="date",Se=we.type==="date";if(!Me&&!Se)return ue;for(var De=0;De<ue.length;De++)for(var Fe=0;Fe<ue[De].length;Fe++)for(var Ye=0;Ye+2<ue[De][Fe].length;Ye+=2)Me&&(ue[De][Fe][Ye+1]=ue[De][Fe][Ye+1].replace(" ","_")),Se&&(ue[De][Fe][Ye+2]=ue[De][Fe][Ye+2].replace(" ","_"))}(G,k,C),Y.path=y(G),Q=null;n(S);for(var ce=x.editHelpers,ve=(ce||{}).modifyItem,ke=[],Ee=0;Ee<j.length;Ee++){var be=S._fullLayout.shapes[Ee];if(ke[Ee]=be._input,O!==void 0&&Ee===S._fullLayout._activeShapeIndex){var xe=Y;switch(be.type){case"line":case"rect":case"circle":ve("x0",xe.x0),ve("x1",xe.x1),ve("y0",xe.y0),ve("y1",xe.y1);break;case"path":ve("path",xe.path)}}}return O===void 0?(ke.push(Y),ke):ce?ce.getUpdateObj():{}}}}},{"../../../plots/cartesian/handle_outline":849,"../../../plots/cartesian/helpers":850,"../../dragelement/helpers":668,"./constants":736,"./helpers":739}],741:[function(h,N,H){var t=h("./constants"),m=h("../../lib");H.rangeToShapePosition=function(g){return g.type==="log"?g.r2d:function(p){return p}},H.shapePositionToRange=function(g){return g.type==="log"?g.d2r:function(p){return p}},H.decodeDate=function(g){return function(p){return p.replace&&(p=p.replace("_"," ")),g(p)}},H.encodeDate=function(g){return function(p){return g(p).replace(" ","_")}},H.extractPathCoords=function(g,p){var e=[];return g.match(t.segmentRE).forEach(function(f){var u=p[f.charAt(0)].drawn;if(u!==void 0){var i=f.substr(1).match(t.paramRE);!i||i.length<u||e.push(m.cleanNumber(i[u]))}}),e},H.getDataToPixel=function(g,p,e,f){var u,i=g._fullLayout._size;if(p)if(f==="domain")u=function(o){return p._length*(e?1-o:o)+p._offset};else{var s=H.shapePositionToRange(p);u=function(o){return p._offset+p.r2p(s(o,!0))},p.type==="date"&&(u=H.decodeDate(u))}else u=e?function(o){return i.t+i.h*(1-o)}:function(o){return i.l+i.w*o};return u},H.getPixelToData=function(g,p,e,f){var u,i=g._fullLayout._size;if(p)if(f==="domain")u=function(o){var a=(o-p._offset)/p._length;return e?1-a:a};else{var s=H.rangeToShapePosition(p);u=function(o){return s(p.p2r(o-p._offset))}}else u=e?function(o){return 1-(o-i.t)/i.h}:function(o){return(o-i.l)/i.w};return u},H.roundPositionForSharpStrokeRendering=function(g,p){var e=Math.round(p%2)===1,f=Math.round(g);return e?f+.5:f},H.makeOptionsAndPlotinfo=function(g,p){var e=g._fullLayout.shapes[p]||{},f=g._fullLayout._plots[e.xref+e.yref];return f?f._hadPlotinfo=!0:(f={},e.xref&&e.xref!=="paper"&&(f.xaxis=g._fullLayout[e.xref+"axis"]),e.yref&&e.yref!=="paper"&&(f.yaxis=g._fullLayout[e.yref+"axis"])),f.xsizemode=e.xsizemode,f.ysizemode=e.ysizemode,f.xanchor=e.xanchor,f.yanchor=e.yanchor,{options:e,plotinfo:f}}},{"../../lib":787,"./constants":732}],742:[function(h,N,H){var t=h("./draw");N.exports={moduleType:"component",name:"shapes",layoutAttributes:h("./attributes"),supplyLayoutDefaults:h("./defaults"),supplyDrawNewShapeDefaults:h("./draw_newshape/defaults"),includeBasePlot:h("../../plots/cartesian/include_components")("shapes"),calcAutorange:h("./calc_autorange"),draw:t.draw,drawOne:t.drawOne}},{"../../plots/cartesian/include_components":851,"./attributes":730,"./calc_autorange":731,"./defaults":733,"./draw":734,"./draw_newshape/defaults":737}],743:[function(h,N,H){var t=h("../../plots/font_attributes"),m=h("../../plots/pad_attributes"),g=h("../../lib/extend").extendDeepAll,p=h("../../plot_api/edit_types").overrideAll,e=h("../../plots/animation_attributes"),f=h("../../plot_api/plot_template").templatedArray,u=h("./constants"),i=f("step",{visible:{valType:"boolean",dflt:!0},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string"},value:{valType:"string"},execute:{valType:"boolean",dflt:!0}});N.exports=p(f("slider",{visible:{valType:"boolean",dflt:!0},active:{valType:"number",min:0,dflt:0},steps:i,lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3,dflt:0},pad:g(m({editType:"arraydraw"}),{},{t:{dflt:20}}),xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left"},y:{valType:"number",min:-2,max:3,dflt:0},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},transition:{duration:{valType:"number",min:0,dflt:150},easing:{valType:"enumerated",values:e.transition.easing.values,dflt:"cubic-in-out"}},currentvalue:{visible:{valType:"boolean",dflt:!0},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},offset:{valType:"number",dflt:10},prefix:{valType:"string"},suffix:{valType:"string"},font:t({})},font:t({}),activebgcolor:{valType:"color",dflt:u.gripBgActiveColor},bgcolor:{valType:"color",dflt:u.railBgColor},bordercolor:{valType:"color",dflt:u.railBorderColor},borderwidth:{valType:"number",min:0,dflt:u.railBorderWidth},ticklen:{valType:"number",min:0,dflt:u.tickLength},tickcolor:{valType:"color",dflt:u.tickColor},tickwidth:{valType:"number",min:0,dflt:1},minorticklen:{valType:"number",min:0,dflt:u.minorTickLength}}),"arraydraw","from-root")},{"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plot_api/plot_template":827,"../../plots/animation_attributes":832,"../../plots/font_attributes":867,"../../plots/pad_attributes":900,"./constants":744}],744:[function(h,N,H){N.exports={name:"sliders",containerClassName:"slider-container",groupClassName:"slider-group",inputAreaClass:"slider-input-area",railRectClass:"slider-rail-rect",railTouchRectClass:"slider-rail-touch-rect",gripRectClass:"slider-grip-rect",tickRectClass:"slider-tick-rect",inputProxyClass:"slider-input-proxy",labelsClass:"slider-labels",labelGroupClass:"slider-label-group",labelClass:"slider-label",currentValueClass:"slider-current-value",railHeight:5,menuIndexAttrName:"slider-active-index",autoMarginIdRoot:"slider-",minWidth:30,minHeight:30,textPadX:40,arrowOffsetX:4,railRadius:2,railWidth:5,railBorder:4,railBorderWidth:1,railBorderColor:"#bec8d9",railBgColor:"#f8fafc",railInset:8,stepInset:10,gripRadius:10,gripWidth:20,gripHeight:20,gripBorder:20,gripBorderWidth:1,gripBorderColor:"#bec8d9",gripBgColor:"#f6f8fa",gripBgActiveColor:"#dbdde0",labelPadding:8,labelOffset:0,tickWidth:1,tickColor:"#333",tickOffset:25,tickLength:7,minorTickOffset:25,minorTickColor:"#333",minorTickLength:4,currentValuePadding:8,currentValueInset:0}},{}],745:[function(h,N,H){var t=h("../../lib"),m=h("../../plots/array_container_defaults"),g=h("./attributes"),p=h("./constants").name,e=g.steps;function f(i,s,o){function a(l,y){return t.coerce(i,s,g,l,y)}for(var c=m(i,s,{name:"steps",handleItemDefaults:u}),r=0,n=0;n<c.length;n++)c[n].visible&&r++;if(r<2?s.visible=!1:a("visible")){s._stepCount=r;var d=s._visibleSteps=t.filterVisible(c);(c[a("active")]||{}).visible||(s.active=d[0]._index),a("x"),a("y"),t.noneOrAll(i,s,["x","y"]),a("xanchor"),a("yanchor"),a("len"),a("lenmode"),a("pad.t"),a("pad.r"),a("pad.b"),a("pad.l"),t.coerceFont(a,"font",o.font),a("currentvalue.visible")&&(a("currentvalue.xanchor"),a("currentvalue.prefix"),a("currentvalue.suffix"),a("currentvalue.offset"),t.coerceFont(a,"currentvalue.font",s.font)),a("transition.duration"),a("transition.easing"),a("bgcolor"),a("activebgcolor"),a("bordercolor"),a("borderwidth"),a("ticklen"),a("tickwidth"),a("tickcolor"),a("minorticklen")}}function u(i,s){function o(c,r){return t.coerce(i,s,e,c,r)}if(i.method==="skip"||Array.isArray(i.args)?o("visible"):s.visible=!1){o("method"),o("args");var a=o("label","step-"+s._index);o("value",a),o("execute")}}N.exports=function(i,s){m(i,s,{name:p,handleItemDefaults:f})}},{"../../lib":787,"../../plots/array_container_defaults":833,"./attributes":743,"./constants":744}],746:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../plots/plots"),g=h("../color"),p=h("../drawing"),e=h("../../lib"),f=e.strTranslate,u=h("../../lib/svg_text_utils"),i=h("../../plot_api/plot_template").arrayEditor,s=h("./constants"),o=h("../../constants/alignment"),a=o.LINE_SPACING,c=o.FROM_TL,r=o.FROM_BR;function n(O){return s.autoMarginIdRoot+O._index}function d(O){return O._index}function l(O,F){var j=p.tester.selectAll("g."+s.labelGroupClass).data(F._visibleSteps);j.enter().append("g").classed(s.labelGroupClass,!0);var W=0,Z=0;j.each(function(ee){var J=_(t.select(this),{step:ee},F).node();if(J){var $=p.bBox(J);Z=Math.max(Z,$.height),W=Math.max(W,$.width)}}),j.remove();var Q=F._dims={};Q.inputAreaWidth=Math.max(s.railWidth,s.gripHeight);var X=O._fullLayout._size;Q.lx=X.l+X.w*F.x,Q.ly=X.t+X.h*(1-F.y),F.lenmode==="fraction"?Q.outerLength=Math.round(X.w*F.len):Q.outerLength=F.len,Q.inputAreaStart=0,Q.inputAreaLength=Math.round(Q.outerLength-F.pad.l-F.pad.r);var G=(Q.inputAreaLength-2*s.stepInset)/(F._stepCount-1),Y=W+s.labelPadding;if(Q.labelStride=Math.max(1,Math.ceil(Y/G)),Q.labelHeight=Z,Q.currentValueMaxWidth=0,Q.currentValueHeight=0,Q.currentValueTotalHeight=0,Q.currentValueMaxLines=1,F.currentvalue.visible){var K=p.tester.append("g");j.each(function(ee){var J=y(K,F,ee.label),$=J.node()&&p.bBox(J.node())||{width:0,height:0},te=u.lineCount(J);Q.currentValueMaxWidth=Math.max(Q.currentValueMaxWidth,Math.ceil($.width)),Q.currentValueHeight=Math.max(Q.currentValueHeight,Math.ceil($.height)),Q.currentValueMaxLines=Math.max(Q.currentValueMaxLines,te)}),Q.currentValueTotalHeight=Q.currentValueHeight+F.currentvalue.offset,K.remove()}Q.height=Q.currentValueTotalHeight+s.tickOffset+F.ticklen+s.labelOffset+Q.labelHeight+F.pad.t+F.pad.b;var D="left";e.isRightAnchor(F)&&(Q.lx-=Q.outerLength,D="right"),e.isCenterAnchor(F)&&(Q.lx-=Q.outerLength/2,D="center");var B="top";e.isBottomAnchor(F)&&(Q.ly-=Q.height,B="bottom"),e.isMiddleAnchor(F)&&(Q.ly-=Q.height/2,B="middle"),Q.outerLength=Math.ceil(Q.outerLength),Q.height=Math.ceil(Q.height),Q.lx=Math.round(Q.lx),Q.ly=Math.round(Q.ly);var q={y:F.y,b:Q.height*r[B],t:Q.height*c[B]};F.lenmode==="fraction"?(q.l=0,q.xl=F.x-F.len*c[D],q.r=0,q.xr=F.x+F.len*r[D]):(q.x=F.x,q.l=Q.outerLength*c[D],q.r=Q.outerLength*r[D]),m.autoMargin(O,n(F),q)}function y(O,F,j){if(F.currentvalue.visible){var W,Z,Q=F._dims;switch(F.currentvalue.xanchor){case"right":W=Q.inputAreaLength-s.currentValueInset-Q.currentValueMaxWidth,Z="left";break;case"center":W=.5*Q.inputAreaLength,Z="middle";break;default:W=s.currentValueInset,Z="left"}var X=e.ensureSingle(O,"text",s.labelClass,function(q){q.attr({"text-anchor":Z,"data-notex":1})}),G=F.currentvalue.prefix?F.currentvalue.prefix:"";if(typeof j=="string")G+=j;else{var Y=F.steps[F.active].label,K=F._gd._fullLayout._meta;K&&(Y=e.templateString(Y,K)),G+=Y}F.currentvalue.suffix&&(G+=F.currentvalue.suffix),X.call(p.font,F.currentvalue.font).text(G).call(u.convertToTspans,F._gd);var D=u.lineCount(X),B=(Q.currentValueMaxLines+1-D)*F.currentvalue.font.size*a;return u.positionText(X,W,B),X}}function v(O,F,j){e.ensureSingle(O,"rect",s.gripRectClass,function(W){W.call(S,F,O,j).style("pointer-events","all")}).attr({width:s.gripWidth,height:s.gripHeight,rx:s.gripRadius,ry:s.gripRadius}).call(g.stroke,j.bordercolor).call(g.fill,j.bgcolor).style("stroke-width",j.borderwidth+"px")}function _(O,F,j){var W=e.ensureSingle(O,"text",s.labelClass,function(X){X.attr({"text-anchor":"middle","data-notex":1})}),Z=F.step.label,Q=j._gd._fullLayout._meta;return Q&&(Z=e.templateString(Z,Q)),W.call(p.font,j.font).text(Z).call(u.convertToTspans,j._gd),W}function x(O,F){var j=e.ensureSingle(O,"g",s.labelsClass),W=F._dims,Z=j.selectAll("g."+s.labelGroupClass).data(W.labelSteps);Z.enter().append("g").classed(s.labelGroupClass,!0),Z.exit().remove(),Z.each(function(Q){var X=t.select(this);X.call(_,Q,F),p.setTranslate(X,k(F,Q.fraction),s.tickOffset+F.ticklen+F.font.size*a+s.labelOffset+W.currentValueTotalHeight)})}function T(O,F,j,W,Z){var Q=Math.round(W*(j._stepCount-1)),X=j._visibleSteps[Q]._index;X!==j.active&&A(O,F,j,X,!0,Z)}function A(O,F,j,W,Z,Q){var X=j.active;j.active=W,i(O.layout,s.name,j).applyUpdate("active",W);var G=j.steps[j.active];F.call(L,j,Q),F.call(y,j),O.emit("plotly_sliderchange",{slider:j,step:j.steps[j.active],interaction:Z,previousActive:X}),G&&G.method&&Z&&(F._nextMethod?(F._nextMethod.step=G,F._nextMethod.doCallback=Z,F._nextMethod.doTransition=Q):(F._nextMethod={step:G,doCallback:Z,doTransition:Q},F._nextMethodRaf=window.requestAnimationFrame(function(){var Y=F._nextMethod.step;Y.method&&(Y.execute&&m.executeAPICommand(O,Y.method,Y.args),F._nextMethod=null,F._nextMethodRaf=null)})))}function S(O,F,j){var W=j.node(),Z=t.select(F);function Q(){return j.data()[0]}function X(){var G=Q();F.emit("plotly_sliderstart",{slider:G});var Y=j.select("."+s.gripRectClass);t.event.stopPropagation(),t.event.preventDefault(),Y.call(g.fill,G.activebgcolor);var K=C(G,t.mouse(W)[0]);function D(){var q=Q(),ee=C(q,t.mouse(W)[0]);T(F,j,q,ee,!1)}function B(){var q=Q();q._dragging=!1,Y.call(g.fill,q.bgcolor),Z.on("mouseup",null),Z.on("mousemove",null),Z.on("touchend",null),Z.on("touchmove",null),F.emit("plotly_sliderend",{slider:q,step:q.steps[q.active]})}T(F,j,G,K,!0),G._dragging=!0,Z.on("mousemove",D),Z.on("touchmove",D),Z.on("mouseup",B),Z.on("touchend",B)}O.on("mousedown",X),O.on("touchstart",X)}function w(O,F){var j=O.selectAll("rect."+s.tickRectClass).data(F._visibleSteps),W=F._dims;j.enter().append("rect").classed(s.tickRectClass,!0),j.exit().remove(),j.attr({width:F.tickwidth+"px","shape-rendering":"crispEdges"}),j.each(function(Z,Q){var X=Q%W.labelStride==0,G=t.select(this);G.attr({height:X?F.ticklen:F.minorticklen}).call(g.fill,F.tickcolor),p.setTranslate(G,k(F,Q/(F._stepCount-1))-.5*F.tickwidth,(X?s.tickOffset:s.minorTickOffset)+W.currentValueTotalHeight)})}function L(O,F,j){for(var W=O.select("rect."+s.gripRectClass),Z=0,Q=0;Q<F._stepCount;Q++)if(F._visibleSteps[Q]._index===F.active){Z=Q;break}var X=k(F,Z/(F._stepCount-1));if(!F._invokingCommand){var G=W;j&&F.transition.duration>0&&(G=G.transition().duration(F.transition.duration).ease(F.transition.easing)),G.attr("transform",f(X-.5*s.gripWidth,F._dims.currentValueTotalHeight))}}function k(O,F){var j=O._dims;return j.inputAreaStart+s.stepInset+(j.inputAreaLength-2*s.stepInset)*Math.min(1,Math.max(0,F))}function C(O,F){var j=O._dims;return Math.min(1,Math.max(0,(F-s.stepInset-j.inputAreaStart)/(j.inputAreaLength-2*s.stepInset-2*j.inputAreaStart)))}function M(O,F,j){var W=j._dims,Z=e.ensureSingle(O,"rect",s.railTouchRectClass,function(Q){Q.call(S,F,O,j).style("pointer-events","all")});Z.attr({width:W.inputAreaLength,height:Math.max(W.inputAreaWidth,s.tickOffset+j.ticklen+W.labelHeight)}).call(g.fill,j.bgcolor).attr("opacity",0),p.setTranslate(Z,0,W.currentValueTotalHeight)}function P(O,F){var j=F._dims,W=j.inputAreaLength-2*s.railInset,Z=e.ensureSingle(O,"rect",s.railRectClass);Z.attr({width:W,height:s.railWidth,rx:s.railRadius,ry:s.railRadius,"shape-rendering":"crispEdges"}).call(g.stroke,F.bordercolor).call(g.fill,F.bgcolor).style("stroke-width",F.borderwidth+"px"),p.setTranslate(Z,s.railInset,.5*(j.inputAreaWidth-s.railWidth)+j.currentValueTotalHeight)}N.exports=function(O){var F=O._fullLayout,j=function(Y,K){for(var D=Y[s.name],B=[],q=0;q<D.length;q++){var ee=D[q];ee.visible&&(ee._gd=K,B.push(ee))}return B}(F,O),W=F._infolayer.selectAll("g."+s.containerClassName).data(j.length>0?[0]:[]);function Z(Y){Y._commandObserver&&(Y._commandObserver.remove(),delete Y._commandObserver),m.autoMargin(O,n(Y))}if(W.enter().append("g").classed(s.containerClassName,!0).style("cursor","ew-resize"),W.exit().each(function(){t.select(this).selectAll("g."+s.groupClassName).each(Z)}).remove(),j.length!==0){var Q=W.selectAll("g."+s.groupClassName).data(j,d);Q.enter().append("g").classed(s.groupClassName,!0),Q.exit().each(Z).remove();for(var X=0;X<j.length;X++){var G=j[X];l(O,G)}Q.each(function(Y){var K=t.select(this);(function(D){var B=D._dims;B.labelSteps=[];for(var q=D._stepCount,ee=0;ee<q;ee+=B.labelStride)B.labelSteps.push({fraction:ee/(q-1),step:D._visibleSteps[ee]})})(Y),m.manageCommandObserver(O,Y,Y._visibleSteps,function(D){var B=K.data()[0];B.active!==D.index&&(B._dragging||A(O,K,B,D.index,!1,!0))}),function(D,B,q){(q.steps[q.active]||{}).visible||(q.active=q._visibleSteps[0]._index),B.call(y,q).call(P,q).call(x,q).call(w,q).call(M,D,q).call(v,D,q);var ee=q._dims;p.setTranslate(B,ee.lx+q.pad.l,ee.ly+q.pad.t),B.call(L,q,!1),B.call(y,q)}(O,t.select(this),Y)})}}},{"../../constants/alignment":755,"../../lib":787,"../../lib/svg_text_utils":813,"../../plot_api/plot_template":827,"../../plots/plots":901,"../color":650,"../drawing":672,"./constants":744,"@plotly/d3":58}],747:[function(h,N,H){var t=h("./constants");N.exports={moduleType:"component",name:t.name,layoutAttributes:h("./attributes"),supplyLayoutDefaults:h("./defaults"),draw:h("./draw")}},{"./attributes":743,"./constants":744,"./defaults":745,"./draw":746}],748:[function(h,N,H){var t=h("@plotly/d3"),m=h("fast-isnumeric"),g=h("../../plots/plots"),p=h("../../registry"),e=h("../../lib"),f=e.strTranslate,u=h("../drawing"),i=h("../color"),s=h("../../lib/svg_text_utils"),o=h("../../constants/interactions"),a=h("../../constants/alignment").OPPOSITE_SIDE,c=/ [XY][0-9]* /;N.exports={draw:function(r,n,d){var l,y=d.propContainer,v=d.propName,_=d.placeholder,x=d.traceIndex,T=d.avoid||{},A=d.attributes,S=d.transform,w=d.containerGroup,L=r._fullLayout,k=1,C=!1,M=y.title,P=(M&&M.text?M.text:"").trim(),O=M&&M.font?M.font:{},F=O.family,j=O.size,W=O.color;v==="title.text"?l="titleText":v.indexOf("axis")!==-1?l="axisTitleText":v.indexOf(!0)&&(l="colorbarTitleText");var Z=r._context.edits[l];P===""?k=0:P.replace(c," % ")===_.replace(c," % ")&&(k=.2,C=!0,Z||(P="")),d._meta?P=e.templateString(P,d._meta):L._meta&&(P=e.templateString(P,L._meta));var Q=P||Z;w||(w=e.ensureSingle(L._infolayer,"g","g-"+n));var X=w.selectAll("text").data(Q?[0]:[]);if(X.enter().append("text"),X.text(P).attr("class",n),X.exit().remove(),!Q)return w;function G(D){e.syncOrAsync([Y,K],D)}function Y(D){var B;return S?(B="",S.rotate&&(B+="rotate("+[S.rotate,A.x,A.y]+")"),S.offset&&(B+=f(0,S.offset))):B=null,D.attr("transform",B),D.style({"font-family":F,"font-size":t.round(j,2)+"px",fill:i.rgb(W),opacity:k*i.opacity(W),"font-weight":g.fontWeight}).attr(A).call(s.convertToTspans,r),g.previousPromises(r)}function K(D){var B=t.select(D.node().parentNode);if(T&&T.selection&&T.side&&P){B.attr("transform",null);var q=a[T.side],ee=T.side==="left"||T.side==="top"?-1:1,J=m(T.pad)?T.pad:2,$=u.bBox(B.node()),te={left:0,top:0,right:L.width,bottom:L.height},ie=T.maxShift||ee*(te[T.side]-$[T.side]),ae=0;if(ie<0)ae=ie;else{var he=T.offsetLeft||0,se=T.offsetTop||0;$.left-=he,$.right-=he,$.top-=se,$.bottom-=se,T.selection.each(function(){var ce=u.bBox(this);e.bBoxIntersect($,ce,J)&&(ae=Math.max(ae,ee*(ce[T.side]-$[q])+J))}),ae=Math.min(ie,ae)}if(ae>0||ie<0){var de={left:[-ae,0],right:[ae,0],top:[0,-ae],bottom:[0,ae]}[T.side];B.attr("transform",f(de[0],de[1]))}}}return X.call(G),Z&&(P?X.on(".opacity",null):(k=0,C=!0,X.text(_).on("mouseover.opacity",function(){t.select(this).transition().duration(o.SHOW_PLACEHOLDER).style("opacity",1)}).on("mouseout.opacity",function(){t.select(this).transition().duration(o.HIDE_PLACEHOLDER).style("opacity",0)})),X.call(s.makeEditable,{gd:r}).on("edit",function(D){x!==void 0?p.call("_guiRestyle",r,v,D,x):p.call("_guiRelayout",r,v,D)}).on("cancel",function(){this.text(this.attr("data-unformatted")).call(G)}).on("input",function(D){this.text(D||" ").call(s.positionText,A.x,A.y)})),X.classed("js-placeholder",C),w}}},{"../../constants/alignment":755,"../../constants/interactions":762,"../../lib":787,"../../lib/svg_text_utils":813,"../../plots/plots":901,"../../registry":915,"../color":650,"../drawing":672,"@plotly/d3":58,"fast-isnumeric":246}],749:[function(h,N,H){var t=h("../../plots/font_attributes"),m=h("../color/attributes"),g=h("../../lib/extend").extendFlat,p=h("../../plot_api/edit_types").overrideAll,e=h("../../plots/pad_attributes"),f=h("../../plot_api/plot_template").templatedArray,u=f("button",{visible:{valType:"boolean"},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},args2:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string",dflt:""},execute:{valType:"boolean",dflt:!0}});N.exports=p(f("updatemenu",{_arrayAttrRegexps:[/^updatemenus\[(0|[1-9][0-9]+)\]\.buttons/],visible:{valType:"boolean"},type:{valType:"enumerated",values:["dropdown","buttons"],dflt:"dropdown"},direction:{valType:"enumerated",values:["left","right","up","down"],dflt:"down"},active:{valType:"integer",min:-1,dflt:0},showactive:{valType:"boolean",dflt:!0},buttons:u,x:{valType:"number",min:-2,max:3,dflt:-.05},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"right"},y:{valType:"number",min:-2,max:3,dflt:1},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},pad:g(e({editType:"arraydraw"}),{}),font:t({}),bgcolor:{valType:"color"},bordercolor:{valType:"color",dflt:m.borderLine},borderwidth:{valType:"number",min:0,dflt:1,editType:"arraydraw"}}),"arraydraw","from-root")},{"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plot_api/plot_template":827,"../../plots/font_attributes":867,"../../plots/pad_attributes":900,"../color/attributes":649}],750:[function(h,N,H){N.exports={name:"updatemenus",containerClassName:"updatemenu-container",headerGroupClassName:"updatemenu-header-group",headerClassName:"updatemenu-header",headerArrowClassName:"updatemenu-header-arrow",dropdownButtonGroupClassName:"updatemenu-dropdown-button-group",dropdownButtonClassName:"updatemenu-dropdown-button",buttonClassName:"updatemenu-button",itemRectClassName:"updatemenu-item-rect",itemTextClassName:"updatemenu-item-text",menuIndexAttrName:"updatemenu-active-index",autoMarginIdRoot:"updatemenu-",blankHeaderOpts:{label:"  "},minWidth:30,minHeight:30,textPadX:24,arrowPadX:16,rx:2,ry:2,textOffsetX:12,textOffsetY:3,arrowOffsetX:4,gapButtonHeader:5,gapButton:2,activeColor:"#F4FAFF",hoverColor:"#F4FAFF",arrowSymbol:{left:"\u25C4",right:"\u25BA",up:"\u25B2",down:"\u25BC"}}},{}],751:[function(h,N,H){var t=h("../../lib"),m=h("../../plots/array_container_defaults"),g=h("./attributes"),p=h("./constants").name,e=g.buttons;function f(i,s,o){function a(c,r){return t.coerce(i,s,g,c,r)}a("visible",m(i,s,{name:"buttons",handleItemDefaults:u}).length>0)&&(a("active"),a("direction"),a("type"),a("showactive"),a("x"),a("y"),t.noneOrAll(i,s,["x","y"]),a("xanchor"),a("yanchor"),a("pad.t"),a("pad.r"),a("pad.b"),a("pad.l"),t.coerceFont(a,"font",o.font),a("bgcolor",o.paper_bgcolor),a("bordercolor"),a("borderwidth"))}function u(i,s){function o(a,c){return t.coerce(i,s,e,a,c)}o("visible",i.method==="skip"||Array.isArray(i.args))&&(o("method"),o("args"),o("args2"),o("label"),o("execute"))}N.exports=function(i,s){m(i,s,{name:p,handleItemDefaults:f})}},{"../../lib":787,"../../plots/array_container_defaults":833,"./attributes":749,"./constants":750}],752:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../plots/plots"),g=h("../color"),p=h("../drawing"),e=h("../../lib"),f=h("../../lib/svg_text_utils"),u=h("../../plot_api/plot_template").arrayEditor,i=h("../../constants/alignment").LINE_SPACING,s=h("./constants"),o=h("./scrollbox");function a(k){return k._index}function c(k,C){return+k.attr(s.menuIndexAttrName)===C._index}function r(k,C,M,P,O,F,j,W){C.active=j,u(k.layout,s.name,C).applyUpdate("active",j),C.type==="buttons"?d(k,P,null,null,C):C.type==="dropdown"&&(O.attr(s.menuIndexAttrName,"-1"),n(k,P,O,F,C),W||d(k,P,O,F,C))}function n(k,C,M,P,O){var F=e.ensureSingle(C,"g",s.headerClassName,function(G){G.style("pointer-events","all")}),j=O._dims,W=O.active,Z=O.buttons[W]||s.blankHeaderOpts,Q={y:O.pad.t,yPad:0,x:O.pad.l,xPad:0,index:0},X={width:j.headerWidth,height:j.headerHeight};F.call(l,O,Z,k).call(w,O,Q,X),e.ensureSingle(C,"text",s.headerArrowClassName,function(G){G.attr("text-anchor","end").call(p.font,O.font).text(s.arrowSymbol[O.direction])}).attr({x:j.headerWidth-s.arrowOffsetX+O.pad.l,y:j.headerHeight/2+s.textOffsetY+O.pad.t}),F.on("click",function(){M.call(L,String(c(M,O)?-1:O._index)),d(k,C,M,P,O)}),F.on("mouseover",function(){F.call(x)}),F.on("mouseout",function(){F.call(T,O)}),p.setTranslate(C,j.lx,j.ly)}function d(k,C,M,P,O){M||(M=C).attr("pointer-events","all");var F=function(q){return+q.attr(s.menuIndexAttrName)==-1}(M)&&O.type!=="buttons"?[]:O.buttons,j=O.type==="dropdown"?s.dropdownButtonClassName:s.buttonClassName,W=M.selectAll("g."+j).data(e.filterVisible(F)),Z=W.enter().append("g").classed(j,!0),Q=W.exit();O.type==="dropdown"?(Z.attr("opacity","0").transition().attr("opacity","1"),Q.transition().attr("opacity","0").remove()):Q.remove();var X=0,G=0,Y=O._dims,K=["up","down"].indexOf(O.direction)!==-1;O.type==="dropdown"&&(K?G=Y.headerHeight+s.gapButtonHeader:X=Y.headerWidth+s.gapButtonHeader),O.type==="dropdown"&&O.direction==="up"&&(G=-s.gapButtonHeader+s.gapButton-Y.openHeight),O.type==="dropdown"&&O.direction==="left"&&(X=-s.gapButtonHeader+s.gapButton-Y.openWidth);var D={x:Y.lx+X+O.pad.l,y:Y.ly+G+O.pad.t,yPad:s.gapButton,xPad:s.gapButton,index:0},B={l:D.x+O.borderwidth,t:D.y+O.borderwidth};W.each(function(q,ee){var J=t.select(this);J.call(l,O,q,k).call(w,O,D),J.on("click",function(){t.event.defaultPrevented||(q.execute&&(q.args2&&O.active===ee?(r(k,O,0,C,M,P,-1),m.executeAPICommand(k,q.method,q.args2)):(r(k,O,0,C,M,P,ee),m.executeAPICommand(k,q.method,q.args))),k.emit("plotly_buttonclicked",{menu:O,button:q,active:O.active}))}),J.on("mouseover",function(){J.call(x)}),J.on("mouseout",function(){J.call(T,O),W.call(_,O)})}),W.call(_,O),K?(B.w=Math.max(Y.openWidth,Y.headerWidth),B.h=D.y-B.t):(B.w=D.x-B.l,B.h=Math.max(Y.openHeight,Y.headerHeight)),B.direction=O.direction,P&&(W.size()?function(q,ee,J,$,te,ie){var ae,he,se,de=te.direction,ce=de==="up"||de==="down",ve=te._dims,ke=te.active;if(ce)for(he=0,se=0;se<ke;se++)he+=ve.heights[se]+s.gapButton;else for(ae=0,se=0;se<ke;se++)ae+=ve.widths[se]+s.gapButton;$.enable(ie,ae,he),$.hbar&&$.hbar.attr("opacity","0").transition().attr("opacity","1"),$.vbar&&$.vbar.attr("opacity","0").transition().attr("opacity","1")}(0,0,0,P,O,B):function(q){var ee=!!q.hbar,J=!!q.vbar;ee&&q.hbar.transition().attr("opacity","0").each("end",function(){ee=!1,J||q.disable()}),J&&q.vbar.transition().attr("opacity","0").each("end",function(){J=!1,ee||q.disable()})}(P))}function l(k,C,M,P){k.call(y,C).call(v,C,M,P)}function y(k,C){e.ensureSingle(k,"rect",s.itemRectClassName,function(M){M.attr({rx:s.rx,ry:s.ry,"shape-rendering":"crispEdges"})}).call(g.stroke,C.bordercolor).call(g.fill,C.bgcolor).style("stroke-width",C.borderwidth+"px")}function v(k,C,M,P){var O=e.ensureSingle(k,"text",s.itemTextClassName,function(W){W.attr({"text-anchor":"start","data-notex":1})}),F=M.label,j=P._fullLayout._meta;j&&(F=e.templateString(F,j)),O.call(p.font,C.font).text(F).call(f.convertToTspans,P)}function _(k,C){var M=C.active;k.each(function(P,O){var F=t.select(this);O===M&&C.showactive&&F.select("rect."+s.itemRectClassName).call(g.fill,s.activeColor)})}function x(k){k.select("rect."+s.itemRectClassName).call(g.fill,s.hoverColor)}function T(k,C){k.select("rect."+s.itemRectClassName).call(g.fill,C.bgcolor)}function A(k,C){var M=C._dims={width1:0,height1:0,heights:[],widths:[],totalWidth:0,totalHeight:0,openWidth:0,openHeight:0,lx:0,ly:0},P=p.tester.selectAll("g."+s.dropdownButtonClassName).data(e.filterVisible(C.buttons));P.enter().append("g").classed(s.dropdownButtonClassName,!0);var O=["up","down"].indexOf(C.direction)!==-1;P.each(function(X,G){var Y=t.select(this);Y.call(l,C,X,k);var K=Y.select("."+s.itemTextClassName),D=K.node()&&p.bBox(K.node()).width,B=Math.max(D+s.textPadX,s.minWidth),q=C.font.size*i,ee=f.lineCount(K),J=Math.max(q*ee,s.minHeight)+s.textOffsetY;J=Math.ceil(J),B=Math.ceil(B),M.widths[G]=B,M.heights[G]=J,M.height1=Math.max(M.height1,J),M.width1=Math.max(M.width1,B),O?(M.totalWidth=Math.max(M.totalWidth,B),M.openWidth=M.totalWidth,M.totalHeight+=J+s.gapButton,M.openHeight+=J+s.gapButton):(M.totalWidth+=B+s.gapButton,M.openWidth+=B+s.gapButton,M.totalHeight=Math.max(M.totalHeight,J),M.openHeight=M.totalHeight)}),O?M.totalHeight-=s.gapButton:M.totalWidth-=s.gapButton,M.headerWidth=M.width1+s.arrowPadX,M.headerHeight=M.height1,C.type==="dropdown"&&(O?(M.width1+=s.arrowPadX,M.totalHeight=M.height1):M.totalWidth=M.width1,M.totalWidth+=s.arrowPadX),P.remove();var F=M.totalWidth+C.pad.l+C.pad.r,j=M.totalHeight+C.pad.t+C.pad.b,W=k._fullLayout._size;M.lx=W.l+W.w*C.x,M.ly=W.t+W.h*(1-C.y);var Z="left";e.isRightAnchor(C)&&(M.lx-=F,Z="right"),e.isCenterAnchor(C)&&(M.lx-=F/2,Z="center");var Q="top";e.isBottomAnchor(C)&&(M.ly-=j,Q="bottom"),e.isMiddleAnchor(C)&&(M.ly-=j/2,Q="middle"),M.totalWidth=Math.ceil(M.totalWidth),M.totalHeight=Math.ceil(M.totalHeight),M.lx=Math.round(M.lx),M.ly=Math.round(M.ly),m.autoMargin(k,S(C),{x:C.x,y:C.y,l:F*({right:1,center:.5}[Z]||0),r:F*({left:1,center:.5}[Z]||0),b:j*({top:1,middle:.5}[Q]||0),t:j*({bottom:1,middle:.5}[Q]||0)})}function S(k){return s.autoMarginIdRoot+k._index}function w(k,C,M,P){P=P||{};var O=k.select("."+s.itemRectClassName),F=k.select("."+s.itemTextClassName),j=C.borderwidth,W=M.index,Z=C._dims;p.setTranslate(k,j+M.x,j+M.y);var Q=["up","down"].indexOf(C.direction)!==-1,X=P.height||(Q?Z.heights[W]:Z.height1);O.attr({x:0,y:0,width:P.width||(Q?Z.width1:Z.widths[W]),height:X});var G=C.font.size*i,Y=(f.lineCount(F)-1)*G/2;f.positionText(F,s.textOffsetX,X/2-Y+s.textOffsetY),Q?M.y+=Z.heights[W]+M.yPad:M.x+=Z.widths[W]+M.xPad,M.index++}function L(k,C){k.attr(s.menuIndexAttrName,C||"-1").selectAll("g."+s.dropdownButtonClassName).remove()}N.exports=function(k){var C=k._fullLayout,M=e.filterVisible(C[s.name]);function P(G){m.autoMargin(k,S(G))}var O=C._menulayer.selectAll("g."+s.containerClassName).data(M.length>0?[0]:[]);if(O.enter().append("g").classed(s.containerClassName,!0).style("cursor","pointer"),O.exit().each(function(){t.select(this).selectAll("g."+s.headerGroupClassName).each(P)}).remove(),M.length!==0){var F=O.selectAll("g."+s.headerGroupClassName).data(M,a);F.enter().append("g").classed(s.headerGroupClassName,!0);for(var j=e.ensureSingle(O,"g",s.dropdownButtonGroupClassName,function(G){G.style("pointer-events","all")}),W=0;W<M.length;W++){var Z=M[W];A(k,Z)}var Q="updatemenus"+C._uid,X=new o(k,j,Q);F.enter().size()&&(j.node().parentNode.appendChild(j.node()),j.call(L)),F.exit().each(function(G){j.call(L),P(G)}).remove(),F.each(function(G){var Y=t.select(this),K=G.type==="dropdown"?j:null;m.manageCommandObserver(k,G,G.buttons,function(D){r(k,G,G.buttons[D.index],Y,K,X,D.index,!0)}),G.type==="dropdown"?(n(k,Y,j,X,G),c(j,G)&&d(k,Y,j,X,G)):d(k,Y,null,null,G)})}}},{"../../constants/alignment":755,"../../lib":787,"../../lib/svg_text_utils":813,"../../plot_api/plot_template":827,"../../plots/plots":901,"../color":650,"../drawing":672,"./constants":750,"./scrollbox":754,"@plotly/d3":58}],753:[function(h,N,H){arguments[4][747][0].apply(H,arguments)},{"./attributes":749,"./constants":750,"./defaults":751,"./draw":752,dup:747}],754:[function(h,N,H){N.exports=e;var t=h("@plotly/d3"),m=h("../color"),g=h("../drawing"),p=h("../../lib");function e(f,u,i){this.gd=f,this.container=u,this.id=i,this.position=null,this.translateX=null,this.translateY=null,this.hbar=null,this.vbar=null,this.bg=this.container.selectAll("rect.scrollbox-bg").data([0]),this.bg.exit().on(".drag",null).on("wheel",null).remove(),this.bg.enter().append("rect").classed("scrollbox-bg",!0).style("pointer-events","all").attr({opacity:0,x:0,y:0,width:0,height:0})}e.barWidth=2,e.barLength=20,e.barRadius=2,e.barPad=1,e.barColor="#808BA4",e.prototype.enable=function(f,u,i){var s=this.gd._fullLayout,o=s.width,a=s.height;this.position=f;var c,r,n,d,l=this.position.l,y=this.position.w,v=this.position.t,_=this.position.h,x=this.position.direction,T=x==="down",A=x==="left",S=x==="up",w=y,L=_;T||A||x==="right"||S||(this.position.direction="down",T=!0),T||S?(r=(c=l)+w,T?(n=v,L=(d=Math.min(n+L,a))-n):L=(d=v+L)-(n=Math.max(d-L,0))):(d=(n=v)+L,A?w=(r=l+w)-(c=Math.max(r-w,0)):(c=l,w=(r=Math.min(c+w,o))-c)),this._box={l:c,t:n,w,h:L};var k=y>w,C=e.barLength+2*e.barPad,M=e.barWidth+2*e.barPad,P=l,O=v+_;O+M>a&&(O=a-M);var F=this.container.selectAll("rect.scrollbar-horizontal").data(k?[0]:[]);F.exit().on(".drag",null).remove(),F.enter().append("rect").classed("scrollbar-horizontal",!0).call(m.fill,e.barColor),k?(this.hbar=F.attr({rx:e.barRadius,ry:e.barRadius,x:P,y:O,width:C,height:M}),this._hbarXMin=P+C/2,this._hbarTranslateMax=w-C):(delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax);var j=_>L,W=e.barWidth+2*e.barPad,Z=e.barLength+2*e.barPad,Q=l+y,X=v;Q+W>o&&(Q=o-W);var G=this.container.selectAll("rect.scrollbar-vertical").data(j?[0]:[]);G.exit().on(".drag",null).remove(),G.enter().append("rect").classed("scrollbar-vertical",!0).call(m.fill,e.barColor),j?(this.vbar=G.attr({rx:e.barRadius,ry:e.barRadius,x:Q,y:X,width:W,height:Z}),this._vbarYMin=X+Z/2,this._vbarTranslateMax=L-Z):(delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax);var Y=this.id,K=c-.5,D=j?r+W+.5:r+.5,B=n-.5,q=k?d+M+.5:d+.5,ee=s._topdefs.selectAll("#"+Y).data(k||j?[0]:[]);if(ee.exit().remove(),ee.enter().append("clipPath").attr("id",Y).append("rect"),k||j?(this._clipRect=ee.select("rect").attr({x:Math.floor(K),y:Math.floor(B),width:Math.ceil(D)-Math.floor(K),height:Math.ceil(q)-Math.floor(B)}),this.container.call(g.setClipUrl,Y,this.gd),this.bg.attr({x:l,y:v,width:y,height:_})):(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(g.setClipUrl,null),delete this._clipRect),k||j){var J=t.behavior.drag().on("dragstart",function(){t.event.sourceEvent.preventDefault()}).on("drag",this._onBoxDrag.bind(this));this.container.on("wheel",null).on("wheel",this._onBoxWheel.bind(this)).on(".drag",null).call(J);var $=t.behavior.drag().on("dragstart",function(){t.event.sourceEvent.preventDefault(),t.event.sourceEvent.stopPropagation()}).on("drag",this._onBarDrag.bind(this));k&&this.hbar.on(".drag",null).call($),j&&this.vbar.on(".drag",null).call($)}this.setTranslate(u,i)},e.prototype.disable=function(){(this.hbar||this.vbar)&&(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(g.setClipUrl,null),delete this._clipRect),this.hbar&&(this.hbar.on(".drag",null),this.hbar.remove(),delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax),this.vbar&&(this.vbar.on(".drag",null),this.vbar.remove(),delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax)},e.prototype._onBoxDrag=function(){var f=this.translateX,u=this.translateY;this.hbar&&(f-=t.event.dx),this.vbar&&(u-=t.event.dy),this.setTranslate(f,u)},e.prototype._onBoxWheel=function(){var f=this.translateX,u=this.translateY;this.hbar&&(f+=t.event.deltaY),this.vbar&&(u+=t.event.deltaY),this.setTranslate(f,u)},e.prototype._onBarDrag=function(){var f=this.translateX,u=this.translateY;if(this.hbar){var i=f+this._hbarXMin,s=i+this._hbarTranslateMax;f=(p.constrain(t.event.x,i,s)-i)/(s-i)*(this.position.w-this._box.w)}if(this.vbar){var o=u+this._vbarYMin,a=o+this._vbarTranslateMax;u=(p.constrain(t.event.y,o,a)-o)/(a-o)*(this.position.h-this._box.h)}this.setTranslate(f,u)},e.prototype.setTranslate=function(f,u){var i=this.position.w-this._box.w,s=this.position.h-this._box.h;if(f=p.constrain(f||0,0,i),u=p.constrain(u||0,0,s),this.translateX=f,this.translateY=u,this.container.call(g.setTranslate,this._box.l-this.position.l-f,this._box.t-this.position.t-u),this._clipRect&&this._clipRect.attr({x:Math.floor(this.position.l+f-.5),y:Math.floor(this.position.t+u-.5)}),this.hbar){var o=f/i;this.hbar.call(g.setTranslate,f+o*this._hbarTranslateMax,u)}if(this.vbar){var a=u/s;this.vbar.call(g.setTranslate,f,u+a*this._vbarTranslateMax)}}},{"../../lib":787,"../color":650,"../drawing":672,"@plotly/d3":58}],755:[function(h,N,H){N.exports={FROM_BL:{left:0,center:.5,right:1,bottom:0,middle:.5,top:1},FROM_TL:{left:0,center:.5,right:1,bottom:1,middle:.5,top:0},FROM_BR:{left:1,center:.5,right:0,bottom:0,middle:.5,top:1},LINE_SPACING:1.3,CAP_SHIFT:.7,MID_SHIFT:.35,OPPOSITE_SIDE:{left:"right",right:"left",top:"bottom",bottom:"top"}}},{}],756:[function(h,N,H){N.exports={axisRefDescription:function(t,m,g){return["If set to a",t,"axis id (e.g. *"+t+"* or","*"+t+"2*), the `"+t+"` position refers to a",t,"coordinate. If set to *paper*, the `"+t+"`","position refers to the distance from the",m,"of the plotting","area in normalized coordinates where *0* (*1*) corresponds to the",m,"("+g+"). If set to a",t,"axis ID followed by","*domain* (separated by a space), the position behaves like for","*paper*, but refers to the distance in fractions of the domain","length from the",m,"of the domain of that axis: e.g.,","*"+t+"2 domain* refers to the domain of the second",t," axis and a",t,"position of 0.5 refers to the","point between the",m,"and the",g,"of the domain of the","second",t,"axis."].join(" ")}}},{}],757:[function(h,N,H){N.exports={INCREASING:{COLOR:"#3D9970",SYMBOL:"\u25B2"},DECREASING:{COLOR:"#FF4136",SYMBOL:"\u25BC"}}},{}],758:[function(h,N,H){N.exports={FORMAT_LINK:"https://github.com/d3/d3-format/tree/v1.4.5#d3-format",DATE_FORMAT_LINK:"https://github.com/d3/d3-time-format/tree/v2.2.3#locale_format"}},{}],759:[function(h,N,H){N.exports={COMPARISON_OPS:["=","!=","<",">=",">","<="],COMPARISON_OPS2:["=","<",">=",">","<="],INTERVAL_OPS:["[]","()","[)","(]","][",")(","](",")["],SET_OPS:["{}","}{"],CONSTRAINT_REDUCTION:{"=":"=","<":"<","<=":"<",">":">",">=":">","[]":"[]","()":"[]","[)":"[]","(]":"[]","][":"][",")(":"][","](":"][",")[":"]["}}},{}],760:[function(h,N,H){N.exports={solid:[[],0],dot:[[.5,1],200],dash:[[.5,1],50],longdash:[[.5,1],10],dashdot:[[.5,.625,.875,1],50],longdashdot:[[.5,.7,.8,1],10]}},{}],761:[function(h,N,H){N.exports={circle:"\u25CF","circle-open":"\u25CB",square:"\u25A0","square-open":"\u25A1",diamond:"\u25C6","diamond-open":"\u25C7",cross:"+",x:"\u274C"}},{}],762:[function(h,N,H){N.exports={SHOW_PLACEHOLDER:100,HIDE_PLACEHOLDER:1e3,DESELECTDIM:.2}},{}],763:[function(h,N,H){N.exports={BADNUM:void 0,FP_SAFE:1e-4*Number.MAX_VALUE,ONEMAXYEAR:316224e5,ONEAVGYEAR:315576e5,ONEMINYEAR:31536e6,ONEMAXQUARTER:79488e5,ONEAVGQUARTER:78894e5,ONEMINQUARTER:76896e5,ONEMAXMONTH:26784e5,ONEAVGMONTH:26298e5,ONEMINMONTH:24192e5,ONEWEEK:6048e5,ONEDAY:864e5,ONEHOUR:36e5,ONEMIN:6e4,ONESEC:1e3,EPOCHJD:24405875e-1,ALMOST_EQUAL:.999999,LOG_CLIP:10,MINUS_SIGN:"\u2212"}},{}],764:[function(h,N,H){H.xmlns="http://www.w3.org/2000/xmlns/",H.svg="http://www.w3.org/2000/svg",H.xlink="http://www.w3.org/1999/xlink",H.svgAttrs={xmlns:H.svg,"xmlns:xlink":H.xlink}},{}],765:[function(h,N,H){H.version=h("./version").version,h("native-promise-only"),h("../build/plotcss");for(var t=h("./registry"),m=H.register=t.register,g=h("./plot_api"),p=Object.keys(g),e=0;e<p.length;e++){var f=p[e];f.charAt(0)!=="_"&&(H[f]=g[f]),m({moduleType:"apiMethod",name:f,fn:g[f]})}m(h("./traces/scatter")),m([h("./components/legend"),h("./components/fx"),h("./components/annotations"),h("./components/annotations3d"),h("./components/shapes"),h("./components/images"),h("./components/updatemenus"),h("./components/sliders"),h("./components/rangeslider"),h("./components/rangeselector"),h("./components/grid"),h("./components/errorbars"),h("./components/colorscale"),h("./components/colorbar"),h("./components/modebar")]),m([h("./locale-en"),h("./locale-en-us")]),window.PlotlyLocales&&Array.isArray(window.PlotlyLocales)&&(m(window.PlotlyLocales),delete window.PlotlyLocales),H.Icons=h("./fonts/ploticon");var u=h("./components/fx"),i=h("./plots/plots");H.Plots={resize:i.resize,graphJson:i.graphJson,sendDataToCloud:i.sendDataToCloud},H.Fx={hover:u.hover,unhover:u.unhover,loneHover:u.loneHover,loneUnhover:u.loneUnhover},H.Snapshot=h("./snapshot"),H.PlotSchema=h("./plot_api/plot_schema")},{"../build/plotcss":1,"./components/annotations":641,"./components/annotations3d":646,"./components/colorbar":656,"./components/colorscale":662,"./components/errorbars":678,"./components/fx":690,"./components/grid":694,"./components/images":699,"./components/legend":707,"./components/modebar":713,"./components/rangeselector":721,"./components/rangeslider":728,"./components/shapes":742,"./components/sliders":747,"./components/updatemenus":753,"./fonts/ploticon":766,"./locale-en":818,"./locale-en-us":817,"./plot_api":822,"./plot_api/plot_schema":826,"./plots/plots":901,"./registry":915,"./snapshot":920,"./traces/scatter":1214,"./version":1388,"native-promise-only":463}],766:[function(h,N,H){N.exports={undo:{width:857.1,height:1e3,path:"m857 350q0-87-34-166t-91-137-137-92-166-34q-96 0-183 41t-147 114q-4 6-4 13t5 11l76 77q6 5 14 5 9-1 13-7 41-53 100-82t126-29q58 0 110 23t92 61 61 91 22 111-22 111-61 91-92 61-110 23q-55 0-105-20t-90-57l77-77q17-16 8-38-10-23-33-23h-250q-15 0-25 11t-11 25v250q0 24 22 33 22 10 39-8l72-72q60 57 137 88t159 31q87 0 166-34t137-92 91-137 34-166z",transform:"matrix(1 0 0 -1 0 850)"},home:{width:928.6,height:1e3,path:"m786 296v-267q0-15-11-26t-25-10h-214v214h-143v-214h-214q-15 0-25 10t-11 26v267q0 1 0 2t0 2l321 264 321-264q1-1 1-4z m124 39l-34-41q-5-5-12-6h-2q-7 0-12 3l-386 322-386-322q-7-4-13-4-7 2-12 7l-35 41q-4 5-3 13t6 12l401 334q18 15 42 15t43-15l136-114v109q0 8 5 13t13 5h107q8 0 13-5t5-13v-227l122-102q5-5 6-12t-4-13z",transform:"matrix(1 0 0 -1 0 850)"},"camera-retro":{width:1e3,height:1e3,path:"m518 386q0 8-5 13t-13 5q-37 0-63-27t-26-63q0-8 5-13t13-5 12 5 5 13q0 23 16 38t38 16q8 0 13 5t5 13z m125-73q0-59-42-101t-101-42-101 42-42 101 42 101 101 42 101-42 42-101z m-572-320h858v71h-858v-71z m643 320q0 89-62 152t-152 62-151-62-63-152 63-151 151-63 152 63 62 151z m-571 358h214v72h-214v-72z m-72-107h858v143h-462l-36-71h-360v-72z m929 143v-714q0-30-21-51t-50-21h-858q-29 0-50 21t-21 51v714q0 30 21 51t50 21h858q29 0 50-21t21-51z",transform:"matrix(1 0 0 -1 0 850)"},zoombox:{width:1e3,height:1e3,path:"m1000-25l-250 251c40 63 63 138 63 218 0 224-182 406-407 406-224 0-406-182-406-406s183-406 407-406c80 0 155 22 218 62l250-250 125 125z m-812 250l0 438 437 0 0-438-437 0z m62 375l313 0 0-312-313 0 0 312z",transform:"matrix(1 0 0 -1 0 850)"},pan:{width:1e3,height:1e3,path:"m1000 350l-187 188 0-125-250 0 0 250 125 0-188 187-187-187 125 0 0-250-250 0 0 125-188-188 186-187 0 125 252 0 0-250-125 0 187-188 188 188-125 0 0 250 250 0 0-126 187 188z",transform:"matrix(1 0 0 -1 0 850)"},zoom_plus:{width:875,height:1e3,path:"m1 787l0-875 875 0 0 875-875 0z m687-500l-187 0 0-187-125 0 0 187-188 0 0 125 188 0 0 187 125 0 0-187 187 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},zoom_minus:{width:875,height:1e3,path:"m0 788l0-876 875 0 0 876-875 0z m688-500l-500 0 0 125 500 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},autoscale:{width:1e3,height:1e3,path:"m250 850l-187 0-63 0 0-62 0-188 63 0 0 188 187 0 0 62z m688 0l-188 0 0-62 188 0 0-188 62 0 0 188 0 62-62 0z m-875-938l0 188-63 0 0-188 0-62 63 0 187 0 0 62-187 0z m875 188l0-188-188 0 0-62 188 0 62 0 0 62 0 188-62 0z m-125 188l-1 0-93-94-156 156 156 156 92-93 2 0 0 250-250 0 0-2 93-92-156-156-156 156 94 92 0 2-250 0 0-250 0 0 93 93 157-156-157-156-93 94 0 0 0-250 250 0 0 0-94 93 156 157 156-157-93-93 0 0 250 0 0 250z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_basic:{width:1500,height:1e3,path:"m375 725l0 0-375-375 375-374 0-1 1125 0 0 750-1125 0z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_compare:{width:1125,height:1e3,path:"m187 786l0 2-187-188 188-187 0 0 937 0 0 373-938 0z m0-499l0 1-187-188 188-188 0 0 937 0 0 376-938-1z",transform:"matrix(1 0 0 -1 0 850)"},plotlylogo:{width:1542,height:1e3,path:"m0-10h182v-140h-182v140z m228 146h183v-286h-183v286z m225 714h182v-1000h-182v1000z m225-285h182v-715h-182v715z m225 142h183v-857h-183v857z m231-428h182v-429h-182v429z m225-291h183v-138h-183v138z",transform:"matrix(1 0 0 -1 0 850)"},"z-axis":{width:1e3,height:1e3,path:"m833 5l-17 108v41l-130-65 130-66c0 0 0 38 0 39 0-1 36-14 39-25 4-15-6-22-16-30-15-12-39-16-56-20-90-22-187-23-279-23-261 0-341 34-353 59 3 60 228 110 228 110-140-8-351-35-351-116 0-120 293-142 474-142 155 0 477 22 477 142 0 50-74 79-163 96z m-374 94c-58-5-99-21-99-40 0-24 65-43 144-43 79 0 143 19 143 43 0 19-42 34-98 40v216h87l-132 135-133-135h88v-216z m167 515h-136v1c16 16 31 34 46 52l84 109v54h-230v-71h124v-1c-16-17-28-32-44-51l-89-114v-51h245v72z",transform:"matrix(1 0 0 -1 0 850)"},"3d_rotate":{width:1e3,height:1e3,path:"m922 660c-5 4-9 7-14 11-359 263-580-31-580-31l-102 28 58-400c0 1 1 1 2 2 118 108 351 249 351 249s-62 27-100 42c88 83 222 183 347 122 16-8 30-17 44-27-2 1-4 2-6 4z m36-329c0 0 64 229-88 296-62 27-124 14-175-11 157-78 225-208 249-266 8-19 11-31 11-31 2 5 6 15 11 32-5-13-8-20-8-20z m-775-239c70-31 117-50 198-32-121 80-199 346-199 346l-96-15-58-12c0 0 55-226 155-287z m603 133l-317-139c0 0 4-4 19-14 7-5 24-15 24-15s-177-147-389 4c235-287 536-112 536-112l31-22 100 299-4-1z m-298-153c6-4 14-9 24-15 0 0-17 10-24 15z",transform:"matrix(1 0 0 -1 0 850)"},camera:{width:1e3,height:1e3,path:"m500 450c-83 0-150-67-150-150 0-83 67-150 150-150 83 0 150 67 150 150 0 83-67 150-150 150z m400 150h-120c-16 0-34 13-39 29l-31 93c-6 15-23 28-40 28h-340c-16 0-34-13-39-28l-31-94c-6-15-23-28-40-28h-120c-55 0-100-45-100-100v-450c0-55 45-100 100-100h800c55 0 100 45 100 100v450c0 55-45 100-100 100z m-400-550c-138 0-250 112-250 250 0 138 112 250 250 250 138 0 250-112 250-250 0-138-112-250-250-250z m365 380c-19 0-35 16-35 35 0 19 16 35 35 35 19 0 35-16 35-35 0-19-16-35-35-35z",transform:"matrix(1 0 0 -1 0 850)"},movie:{width:1e3,height:1e3,path:"m938 413l-188-125c0 37-17 71-44 94 64 38 107 107 107 187 0 121-98 219-219 219-121 0-219-98-219-219 0-61 25-117 66-156h-115c30 33 49 76 49 125 0 103-84 187-187 187s-188-84-188-187c0-57 26-107 65-141-38-22-65-62-65-109v-250c0-70 56-126 125-126h500c69 0 125 56 125 126l188-126c34 0 62 28 62 63v375c0 35-28 63-62 63z m-750 0c-69 0-125 56-125 125s56 125 125 125 125-56 125-125-56-125-125-125z m406-1c-87 0-157 70-157 157 0 86 70 156 157 156s156-70 156-156-70-157-156-157z",transform:"matrix(1 0 0 -1 0 850)"},question:{width:857.1,height:1e3,path:"m500 82v107q0 8-5 13t-13 5h-107q-8 0-13-5t-5-13v-107q0-8 5-13t13-5h107q8 0 13 5t5 13z m143 375q0 49-31 91t-77 65-95 23q-136 0-207-119-9-14 4-24l74-55q4-4 10-4 9 0 14 7 30 38 48 51 19 14 48 14 27 0 48-15t21-33q0-21-11-34t-38-25q-35-16-65-48t-29-70v-20q0-8 5-13t13-5h107q8 0 13 5t5 13q0 10 12 27t30 28q18 10 28 16t25 19 25 27 16 34 7 45z m214-107q0-117-57-215t-156-156-215-58-216 58-155 156-58 215 58 215 155 156 216 58 215-58 156-156 57-215z",transform:"matrix(1 0 0 -1 0 850)"},disk:{width:857.1,height:1e3,path:"m214-7h429v214h-429v-214z m500 0h72v500q0 8-6 21t-11 20l-157 156q-5 6-19 12t-22 5v-232q0-22-15-38t-38-16h-322q-22 0-37 16t-16 38v232h-72v-714h72v232q0 22 16 38t37 16h465q22 0 38-16t15-38v-232z m-214 518v178q0 8-5 13t-13 5h-107q-7 0-13-5t-5-13v-178q0-8 5-13t13-5h107q7 0 13 5t5 13z m357-18v-518q0-22-15-38t-38-16h-750q-23 0-38 16t-16 38v750q0 22 16 38t38 16h517q23 0 50-12t42-26l156-157q16-15 27-42t11-49z",transform:"matrix(1 0 0 -1 0 850)"},drawopenpath:{width:70,height:70,path:"M33.21,85.65a7.31,7.31,0,0,1-2.59-.48c-8.16-3.11-9.27-19.8-9.88-41.3-.1-3.58-.19-6.68-.35-9-.15-2.1-.67-3.48-1.43-3.79-2.13-.88-7.91,2.32-12,5.86L3,32.38c1.87-1.64,11.55-9.66,18.27-6.9,2.13.87,4.75,3.14,5.17,9,.17,2.43.26,5.59.36,9.25a224.17,224.17,0,0,0,1.5,23.4c1.54,10.76,4,12.22,4.48,12.4.84.32,2.79-.46,5.76-3.59L43,80.07C41.53,81.57,37.68,85.64,33.21,85.65ZM74.81,69a11.34,11.34,0,0,0,6.09-6.72L87.26,44.5,74.72,32,56.9,38.35c-2.37.86-5.57,3.42-6.61,6L38.65,72.14l8.42,8.43ZM55,46.27a7.91,7.91,0,0,1,3.64-3.17l14.8-5.3,8,8L76.11,60.6l-.06.19a6.37,6.37,0,0,1-3,3.43L48.25,74.59,44.62,71Zm16.57,7.82A6.9,6.9,0,1,0,64.64,61,6.91,6.91,0,0,0,71.54,54.09Zm-4.05,0a2.85,2.85,0,1,1-2.85-2.85A2.86,2.86,0,0,1,67.49,54.09Zm-4.13,5.22L60.5,56.45,44.26,72.7l2.86,2.86ZM97.83,35.67,84.14,22l-8.57,8.57L89.26,44.24Zm-13.69-8,8,8-2.85,2.85-8-8Z",transform:"matrix(1 0 0 1 -15 -15)"},drawclosedpath:{width:90,height:90,path:"M88.41,21.12a26.56,26.56,0,0,0-36.18,0l-2.07,2-2.07-2a26.57,26.57,0,0,0-36.18,0,23.74,23.74,0,0,0,0,34.8L48,90.12a3.22,3.22,0,0,0,4.42,0l36-34.21a23.73,23.73,0,0,0,0-34.79ZM84,51.24,50.16,83.35,16.35,51.25a17.28,17.28,0,0,1,0-25.47,20,20,0,0,1,27.3,0l4.29,4.07a3.23,3.23,0,0,0,4.44,0l4.29-4.07a20,20,0,0,1,27.3,0,17.27,17.27,0,0,1,0,25.46ZM66.76,47.68h-33v6.91h33ZM53.35,35H46.44V68h6.91Z",transform:"matrix(1 0 0 1 -5 -5)"},lasso:{width:1031,height:1e3,path:"m1018 538c-36 207-290 336-568 286-277-48-473-256-436-463 10-57 36-108 76-151-13-66 11-137 68-183 34-28 75-41 114-42l-55-70 0 0c-2-1-3-2-4-3-10-14-8-34 5-45 14-11 34-8 45 4 1 1 2 3 2 5l0 0 113 140c16 11 31 24 45 40 4 3 6 7 8 11 48-3 100 0 151 9 278 48 473 255 436 462z m-624-379c-80 14-149 48-197 96 42 42 109 47 156 9 33-26 47-66 41-105z m-187-74c-19 16-33 37-39 60 50-32 109-55 174-68-42-25-95-24-135 8z m360 75c-34-7-69-9-102-8 8 62-16 128-68 170-73 59-175 54-244-5-9 20-16 40-20 61-28 159 121 317 333 354s407-60 434-217c28-159-121-318-333-355z",transform:"matrix(1 0 0 -1 0 850)"},selectbox:{width:1e3,height:1e3,path:"m0 850l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-285l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z",transform:"matrix(1 0 0 -1 0 850)"},drawline:{width:70,height:70,path:"M60.64,62.3a11.29,11.29,0,0,0,6.09-6.72l6.35-17.72L60.54,25.31l-17.82,6.4c-2.36.86-5.57,3.41-6.6,6L24.48,65.5l8.42,8.42ZM40.79,39.63a7.89,7.89,0,0,1,3.65-3.17l14.79-5.31,8,8L61.94,54l-.06.19a6.44,6.44,0,0,1-3,3.43L34.07,68l-3.62-3.63Zm16.57,7.81a6.9,6.9,0,1,0-6.89,6.9A6.9,6.9,0,0,0,57.36,47.44Zm-4,0a2.86,2.86,0,1,1-2.85-2.85A2.86,2.86,0,0,1,53.32,47.44Zm-4.13,5.22L46.33,49.8,30.08,66.05l2.86,2.86ZM83.65,29,70,15.34,61.4,23.9,75.09,37.59ZM70,21.06l8,8-2.84,2.85-8-8ZM87,80.49H10.67V87H87Z",transform:"matrix(1 0 0 1 -15 -15)"},drawrect:{width:80,height:80,path:"M78,22V79H21V22H78m9-9H12V88H87V13ZM68,46.22H31V54H68ZM53,32H45.22V69H53Z",transform:"matrix(1 0 0 1 -10 -10)"},drawcircle:{width:80,height:80,path:"M50,84.72C26.84,84.72,8,69.28,8,50.3S26.84,15.87,50,15.87,92,31.31,92,50.3,73.16,84.72,50,84.72Zm0-60.59c-18.6,0-33.74,11.74-33.74,26.17S31.4,76.46,50,76.46,83.74,64.72,83.74,50.3,68.6,24.13,50,24.13Zm17.15,22h-34v7.11h34Zm-13.8-13H46.24v34h7.11Z",transform:"matrix(1 0 0 1 -10 -10)"},eraseshape:{width:80,height:80,path:"M82.77,78H31.85L6,49.57,31.85,21.14H82.77a8.72,8.72,0,0,1,8.65,8.77V69.24A8.72,8.72,0,0,1,82.77,78ZM35.46,69.84H82.77a.57.57,0,0,0,.49-.6V29.91a.57.57,0,0,0-.49-.61H35.46L17,49.57Zm32.68-34.7-24,24,5,5,24-24Zm-19,.53-5,5,24,24,5-5Z",transform:"matrix(1 0 0 1 -10 -10)"},spikeline:{width:1e3,height:1e3,path:"M512 409c0-57-46-104-103-104-57 0-104 47-104 104 0 57 47 103 104 103 57 0 103-46 103-103z m-327-39l92 0 0 92-92 0z m-185 0l92 0 0 92-92 0z m370-186l92 0 0 93-92 0z m0-184l92 0 0 92-92 0z",transform:"matrix(1.5 0 0 -1.5 0 850)"},pencil:{width:1792,height:1792,path:"M491 1536l91-91-235-235-91 91v107h128v128h107zm523-928q0-22-22-22-10 0-17 7l-542 542q-7 7-7 17 0 22 22 22 10 0 17-7l542-542q7-7 7-17zm-54-192l416 416-832 832h-416v-416zm683 96q0 53-37 90l-166 166-416-416 166-165q36-38 90-38 53 0 91 38l235 234q37 39 37 91z",transform:"matrix(1 0 0 1 0 1)"},newplotlylogo:{name:"newplotlylogo",svg:"<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 132 132'><defs><style>.cls-1 {fill: #3f4f75;} .cls-2 {fill: #80cfbe;} .cls-3 {fill: #fff;}</style></defs><title>plotly-logomark</title><g id='symbol'><rect class='cls-1' width='132' height='132' rx='6' ry='6'/><circle class='cls-2' cx='78' cy='54' r='6'/><circle class='cls-2' cx='102' cy='30' r='6'/><circle class='cls-2' cx='78' cy='30' r='6'/><circle class='cls-2' cx='54' cy='30' r='6'/><circle class='cls-2' cx='30' cy='30' r='6'/><circle class='cls-2' cx='30' cy='54' r='6'/><path class='cls-3' d='M30,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,30,72Z'/><path class='cls-3' d='M78,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,78,72Z'/><path class='cls-3' d='M54,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,54,48Z'/><path class='cls-3' d='M102,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,102,48Z'/></g></svg>"}}},{}],767:[function(h,N,H){H.isLeftAnchor=function(t){return t.xanchor==="left"||t.xanchor==="auto"&&t.x<=1/3},H.isCenterAnchor=function(t){return t.xanchor==="center"||t.xanchor==="auto"&&t.x>1/3&&t.x<2/3},H.isRightAnchor=function(t){return t.xanchor==="right"||t.xanchor==="auto"&&t.x>=2/3},H.isTopAnchor=function(t){return t.yanchor==="top"||t.yanchor==="auto"&&t.y>=2/3},H.isMiddleAnchor=function(t){return t.yanchor==="middle"||t.yanchor==="auto"&&t.y>1/3&&t.y<2/3},H.isBottomAnchor=function(t){return t.yanchor==="bottom"||t.yanchor==="auto"&&t.y<=1/3}},{}],768:[function(h,N,H){var t=h("./mod"),m=t.mod,g=t.modHalf,p=Math.PI,e=2*p;function f(o){return Math.abs(o[1]-o[0])>e-1e-14}function u(o,a){return g(a-o,e)}function i(o,a){if(f(a))return!0;var c,r;a[0]<a[1]?(c=a[0],r=a[1]):(c=a[1],r=a[0]),(c=m(c,e))>(r=m(r,e))&&(r+=e);var n=m(o,e),d=n+e;return n>=c&&n<=r||d>=c&&d<=r}function s(o,a,c,r,n,d,l){n=n||0,d=d||0;var y,v,_,x,T,A=f([c,r]);function S(C,M){return[C*Math.cos(M)+n,d-C*Math.sin(M)]}A?(y=0,v=p,_=e):c<r?(y=c,_=r):(y=r,_=c),o<a?(x=o,T=a):(x=a,T=o);var w,L=Math.abs(_-y)<=p?0:1;function k(C,M,P){return"A"+[C,C]+" "+[0,L,P]+" "+S(C,M)}return A?w=x===null?"M"+S(T,y)+k(T,v,0)+k(T,_,0)+"Z":"M"+S(x,y)+k(x,v,0)+k(x,_,0)+"ZM"+S(T,y)+k(T,v,1)+k(T,_,1)+"Z":x===null?(w="M"+S(T,y)+k(T,_,0),l&&(w+="L0,0Z")):w="M"+S(x,y)+"L"+S(T,y)+k(T,_,0)+"L"+S(x,_)+k(x,y,1)+"Z",w}N.exports={deg2rad:function(o){return o/180*p},rad2deg:function(o){return o/p*180},angleDelta:u,angleDist:function(o,a){return Math.abs(u(o,a))},isFullCircle:f,isAngleInsideSector:i,isPtInsideSector:function(o,a,c,r){return!!i(a,r)&&(c[0]<c[1]?(n=c[0],d=c[1]):(n=c[1],d=c[0]),o>=n&&o<=d);var n,d},pathArc:function(o,a,c,r,n){return s(null,o,a,c,r,n,0)},pathSector:function(o,a,c,r,n){return s(null,o,a,c,r,n,1)},pathAnnulus:function(o,a,c,r,n,d){return s(o,a,c,r,n,d,1)}}},{"./mod":794}],769:[function(h,N,H){var t=Array.isArray,m=ArrayBuffer,g=DataView;function p(u){return m.isView(u)&&!(u instanceof g)}function e(u){return t(u)||p(u)}function f(u,i,s){if(e(u)){if(e(u[0])){for(var o=s,a=0;a<u.length;a++)o=i(o,u[a].length);return o}return u.length}return 0}H.isTypedArray=p,H.isArrayOrTypedArray=e,H.isArray1D=function(u){return!e(u[0])},H.ensureArray=function(u,i){return t(u)||(u=[]),u.length=i,u},H.concat=function(){var u,i,s,o,a,c,r,n,d=[],l=!0,y=0;for(s=0;s<arguments.length;s++)(c=(o=arguments[s]).length)&&(i?d.push(o):(i=o,a=c),t(o)?u=!1:(l=!1,y?u!==o.constructor&&(u=!1):u=o.constructor),y+=c);if(!y)return[];if(!d.length)return i;if(l)return i.concat.apply(i,d);if(u){for((r=new u(y)).set(i),s=0;s<d.length;s++)o=d[s],r.set(o,a),a+=o.length;return r}for(r=new Array(y),n=0;n<i.length;n++)r[n]=i[n];for(s=0;s<d.length;s++){for(o=d[s],n=0;n<o.length;n++)r[a+n]=o[n];a+=n}return r},H.maxRowLength=function(u){return f(u,Math.max,0)},H.minRowLength=function(u){return f(u,Math.min,1/0)}},{}],770:[function(h,N,H){var t=h("fast-isnumeric"),m=h("../constants/numerical").BADNUM,g=/^['"%,$#\s']+|[, ]|['"%,$#\s']+$/g;N.exports=function(p){return typeof p=="string"&&(p=p.replace(g,"")),t(p)?Number(p):m}},{"../constants/numerical":763,"fast-isnumeric":246}],771:[function(h,N,H){N.exports=function(t){var m=t._fullLayout;m._glcanvas&&m._glcanvas.size()&&m._glcanvas.each(function(g){g.regl&&g.regl.clear({color:!0,depth:!0})})}},{}],772:[function(h,N,H){N.exports=function(t){t._responsiveChartHandler&&(window.removeEventListener("resize",t._responsiveChartHandler),delete t._responsiveChartHandler)}},{}],773:[function(h,N,H){var t=h("fast-isnumeric"),m=h("tinycolor2"),g=h("../plots/attributes"),p=h("../components/colorscale/scales"),e=h("../components/color"),f=h("../constants/interactions").DESELECTDIM,u=h("./nested_property"),i=h("./regex").counter,s=h("./mod").modHalf,o=h("./array").isArrayOrTypedArray;function a(c,r){var n=H.valObjectMeta[r.valType];if(r.arrayOk&&o(c))return!0;if(n.validateFunction)return n.validateFunction(c,r);var d={},l=d,y={set:function(v){l=v}};return n.coerceFunction(c,y,d,r),l!==d}H.valObjectMeta={data_array:{coerceFunction:function(c,r,n){o(c)?r.set(c):n!==void 0&&r.set(n)}},enumerated:{coerceFunction:function(c,r,n,d){d.coerceNumber&&(c=+c),d.values.indexOf(c)===-1?r.set(n):r.set(c)},validateFunction:function(c,r){r.coerceNumber&&(c=+c);for(var n=r.values,d=0;d<n.length;d++){var l=String(n[d]);if(l.charAt(0)==="/"&&l.charAt(l.length-1)==="/"){if(new RegExp(l.substr(1,l.length-2)).test(c))return!0}else if(c===n[d])return!0}return!1}},boolean:{coerceFunction:function(c,r,n){c===!0||c===!1?r.set(c):r.set(n)}},number:{coerceFunction:function(c,r,n,d){!t(c)||d.min!==void 0&&c<d.min||d.max!==void 0&&c>d.max?r.set(n):r.set(+c)}},integer:{coerceFunction:function(c,r,n,d){c%1||!t(c)||d.min!==void 0&&c<d.min||d.max!==void 0&&c>d.max?r.set(n):r.set(+c)}},string:{coerceFunction:function(c,r,n,d){if(typeof c!="string"){var l=typeof c=="number";d.strict!==!0&&l?r.set(String(c)):r.set(n)}else d.noBlank&&!c?r.set(n):r.set(c)}},color:{coerceFunction:function(c,r,n){m(c).isValid()?r.set(c):r.set(n)}},colorlist:{coerceFunction:function(c,r,n){Array.isArray(c)&&c.length&&c.every(function(d){return m(d).isValid()})?r.set(c):r.set(n)}},colorscale:{coerceFunction:function(c,r,n){r.set(p.get(c,n))}},angle:{coerceFunction:function(c,r,n){c==="auto"?r.set("auto"):t(c)?r.set(s(+c,360)):r.set(n)}},subplotid:{coerceFunction:function(c,r,n,d){var l=d.regex||i(n);typeof c=="string"&&l.test(c)?r.set(c):r.set(n)},validateFunction:function(c,r){var n=r.dflt;return c===n||typeof c=="string"&&!!i(n).test(c)}},flaglist:{coerceFunction:function(c,r,n,d){if(typeof c=="string")if((d.extras||[]).indexOf(c)===-1){for(var l=c.split("+"),y=0;y<l.length;){var v=l[y];d.flags.indexOf(v)===-1||l.indexOf(v)<y?l.splice(y,1):y++}l.length?r.set(l.join("+")):r.set(n)}else r.set(c);else r.set(n)}},any:{coerceFunction:function(c,r,n){c===void 0?r.set(n):r.set(c)}},info_array:{coerceFunction:function(c,r,n,d){function l(O,F,j){var W,Z={set:function(Q){W=Q}};return j===void 0&&(j=F.dflt),H.valObjectMeta[F.valType].coerceFunction(O,Z,j,F),W}var y=d.dimensions===2||d.dimensions==="1-2"&&Array.isArray(c)&&Array.isArray(c[0]);if(Array.isArray(c)){var v,_,x,T,A,S,w=d.items,L=[],k=Array.isArray(w),C=k&&y&&Array.isArray(w[0]),M=y&&k&&!C,P=k&&!M?w.length:c.length;if(n=Array.isArray(n)?n:[],y)for(v=0;v<P;v++)for(L[v]=[],x=Array.isArray(c[v])?c[v]:[],A=M?w.length:k?w[v].length:x.length,_=0;_<A;_++)T=M?w[_]:k?w[v][_]:w,(S=l(x[_],T,(n[v]||[])[_]))!==void 0&&(L[v][_]=S);else for(v=0;v<P;v++)(S=l(c[v],k?w[v]:w,n[v]))!==void 0&&(L[v]=S);r.set(L)}else r.set(n)},validateFunction:function(c,r){if(!Array.isArray(c))return!1;var n=r.items,d=Array.isArray(n),l=r.dimensions===2;if(!r.freeLength&&c.length!==n.length)return!1;for(var y=0;y<c.length;y++)if(l){if(!Array.isArray(c[y])||!r.freeLength&&c[y].length!==n[y].length)return!1;for(var v=0;v<c[y].length;v++)if(!a(c[y][v],d?n[y][v]:n))return!1}else if(!a(c[y],d?n[y]:n))return!1;return!0}}},H.coerce=function(c,r,n,d,l){var y=u(n,d).get(),v=u(c,d),_=u(r,d),x=v.get(),T=r._template;if(x===void 0&&T&&(x=u(T,d).get(),T=0),l===void 0&&(l=y.dflt),y.arrayOk&&o(x))return _.set(x),x;var A=H.valObjectMeta[y.valType].coerceFunction;A(x,_,l,y);var S=_.get();return T&&S===l&&!a(x,y)&&(A(x=u(T,d).get(),_,l,y),S=_.get()),S},H.coerce2=function(c,r,n,d,l){var y=u(c,d),v=H.coerce(c,r,n,d,l),_=y.get();return _!=null&&v},H.coerceFont=function(c,r,n){var d={};return n=n||{},d.family=c(r+".family",n.family),d.size=c(r+".size",n.size),d.color=c(r+".color",n.color),d},H.coercePattern=function(c,r,n,d){if(c(r+".shape")){c(r+".solidity"),c(r+".size");var l=c(r+".fillmode")==="overlay";if(!d){var y=c(r+".bgcolor",l?n:void 0);c(r+".fgcolor",l?e.contrast(y):n)}c(r+".fgopacity",l?.5:1)}},H.coerceHoverinfo=function(c,r,n){var d,l=r._module.attributes,y=l.hoverinfo?l:g,v=y.hoverinfo;if(n._dataLength===1){var _=v.dflt==="all"?v.flags.slice():v.dflt.split("+");_.splice(_.indexOf("name"),1),d=_.join("+")}return H.coerce(c,r,y,"hoverinfo",d)},H.coerceSelectionMarkerOpacity=function(c,r){if(c.marker){var n,d,l=c.marker.opacity;l!==void 0&&(o(l)||c.selected||c.unselected||(n=l,d=f*l),r("selected.marker.opacity",n),r("unselected.marker.opacity",d))}},H.validate=a},{"../components/color":650,"../components/colorscale/scales":665,"../constants/interactions":762,"../plots/attributes":834,"./array":769,"./mod":794,"./nested_property":795,"./regex":804,"fast-isnumeric":246,tinycolor2:583}],774:[function(h,N,H){var t,m,g=h("d3-time-format").timeFormat,p=h("fast-isnumeric"),e=h("./loggers"),f=h("./mod").mod,u=h("../constants/numerical"),i=u.BADNUM,s=u.ONEDAY,o=u.ONEHOUR,a=u.ONEMIN,c=u.ONESEC,r=u.EPOCHJD,n=h("../registry"),d=h("d3-time-format").utcFormat,l=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\d)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,y=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\di?)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,v=new Date().getFullYear()-70;function _(F){return F&&n.componentsRegistry.calendars&&typeof F=="string"&&F!=="gregorian"}function x(F,j){return String(F+Math.pow(10,j)).substr(1)}H.dateTick0=function(F,j){var W=function(Q,X){return _(Q)?X?n.getComponentMethod("calendars","CANONICAL_SUNDAY")[Q]:n.getComponentMethod("calendars","CANONICAL_TICK")[Q]:X?"2000-01-02":"2000-01-01"}(F,!!j);if(j<2)return W;var Z=H.dateTime2ms(W,F);return Z+=s*(j-1),H.ms2DateTime(Z,0,F)},H.dfltRange=function(F){return _(F)?n.getComponentMethod("calendars","DFLTRANGE")[F]:["2000-01-01","2001-01-01"]},H.isJSDate=function(F){return typeof F=="object"&&F!==null&&typeof F.getTime=="function"},H.dateTime2ms=function(F,j){if(H.isJSDate(F)){var W=F.getTimezoneOffset()*a,Z=(F.getUTCMinutes()-F.getMinutes())*a+(F.getUTCSeconds()-F.getSeconds())*c+(F.getUTCMilliseconds()-F.getMilliseconds());if(Z){var Q=3*a;W=W-Q/2+f(Z-W+Q/2,Q)}return(F=Number(F)-W)>=t&&F<=m?F:i}if(typeof F!="string"&&typeof F!="number")return i;F=String(F);var X=_(j),G=F.charAt(0);!X||G!=="G"&&G!=="g"||(F=F.substr(1),j="");var Y=X&&j.substr(0,7)==="chinese",K=F.match(Y?y:l);if(!K)return i;var D=K[1],B=K[3]||"1",q=Number(K[5]||1),ee=Number(K[7]||0),J=Number(K[9]||0),$=Number(K[11]||0);if(X){if(D.length===2)return i;var te;D=Number(D);try{var ie=n.getComponentMethod("calendars","getCal")(j);if(Y){var ae=B.charAt(B.length-1)==="i";B=parseInt(B,10),te=ie.newDate(D,ie.toMonthIndex(D,B,ae),q)}else te=ie.newDate(D,Number(B),q)}catch(se){return i}return te?(te.toJD()-r)*s+ee*o+J*a+$*c:i}D=D.length===2?(Number(D)+2e3-v)%100+v:Number(D),B-=1;var he=new Date(Date.UTC(2e3,B,q,ee,J));return he.setUTCFullYear(D),he.getUTCMonth()!==B||he.getUTCDate()!==q?i:he.getTime()+$*c},t=H.MIN_MS=H.dateTime2ms("-9999"),m=H.MAX_MS=H.dateTime2ms("9999-12-31 23:59:59.9999"),H.isDateTime=function(F,j){return H.dateTime2ms(F,j)!==i};var T=90*s,A=3*o,S=5*a;function w(F,j,W,Z,Q){if((j||W||Z||Q)&&(F+=" "+x(j,2)+":"+x(W,2),(Z||Q)&&(F+=":"+x(Z,2),Q))){for(var X=4;Q%10==0;)X-=1,Q/=10;F+="."+x(Q,X)}return F}H.ms2DateTime=function(F,j,W){if(typeof F!="number"||!(F>=t&&F<=m))return i;j||(j=0);var Z,Q,X,G,Y,K,D=Math.floor(10*f(F+.05,1)),B=Math.round(F-D/10);if(_(W)){var q=Math.floor(B/s)+r,ee=Math.floor(f(F,s));try{Z=n.getComponentMethod("calendars","getCal")(W).fromJD(q).formatDate("yyyy-mm-dd")}catch(J){Z=d("G%Y-%m-%d")(new Date(B))}if(Z.charAt(0)==="-")for(;Z.length<11;)Z="-0"+Z.substr(1);else for(;Z.length<10;)Z="0"+Z;Q=j<T?Math.floor(ee/o):0,X=j<T?Math.floor(ee%o/a):0,G=j<A?Math.floor(ee%a/c):0,Y=j<S?ee%c*10+D:0}else K=new Date(B),Z=d("%Y-%m-%d")(K),Q=j<T?K.getUTCHours():0,X=j<T?K.getUTCMinutes():0,G=j<A?K.getUTCSeconds():0,Y=j<S?10*K.getUTCMilliseconds()+D:0;return w(Z,Q,X,G,Y)},H.ms2DateTimeLocal=function(F){if(!(F>=t+s&&F<=m-s))return i;var j=Math.floor(10*f(F+.05,1)),W=new Date(Math.round(F-j/10));return w(g("%Y-%m-%d")(W),W.getHours(),W.getMinutes(),W.getSeconds(),10*W.getUTCMilliseconds()+j)},H.cleanDate=function(F,j,W){if(F===i)return j;if(H.isJSDate(F)||typeof F=="number"&&isFinite(F)){if(_(W))return e.error("JS Dates and milliseconds are incompatible with world calendars",F),j;if(!(F=H.ms2DateTimeLocal(+F))&&j!==void 0)return j}else if(!H.isDateTime(F,W))return e.error("unrecognized date",F),j;return F};var L=/%\d?f/g,k=/%h/g,C={1:"1",2:"1",3:"2",4:"2"};function M(F,j,W,Z){F=F.replace(L,function(X){var G=Math.min(+X.charAt(1)||6,6);return(j/1e3%1+2).toFixed(G).substr(2).replace(/0+$/,"")||"0"});var Q=new Date(Math.floor(j+.05));if(F=F.replace(k,function(){return C[W("%q")(Q)]}),_(Z))try{F=n.getComponentMethod("calendars","worldCalFmt")(F,j,Z)}catch(X){return"Invalid"}return W(F)(Q)}var P=[59,59.9,59.99,59.999,59.9999];H.formatDate=function(F,j,W,Z,Q,X){if(Q=_(Q)&&Q,!j)if(W==="y")j=X.year;else if(W==="m")j=X.month;else{if(W!=="d")return function(G,Y){var K=f(G+.05,s),D=x(Math.floor(K/o),2)+":"+x(f(Math.floor(K/a),60),2);if(Y!=="M"){p(Y)||(Y=0);var B=(100+Math.min(f(G/c,60),P[Y])).toFixed(Y).substr(1);Y>0&&(B=B.replace(/0+$/,"").replace(/[\.]$/,"")),D+=":"+B}return D}(F,W)+`
`+M(X.dayMonthYear,F,Z,Q);j=X.dayMonth+`
`+X.year}return M(j,F,Z,Q)};var O=3*s;H.incrementMonth=function(F,j,W){W=_(W)&&W;var Z=f(F,s);if(F=Math.round(F-Z),W)try{var Q=Math.round(F/s)+r,X=n.getComponentMethod("calendars","getCal")(W),G=X.fromJD(Q);return j%12?X.add(G,j,"m"):X.add(G,j/12,"y"),(G.toJD()-r)*s+Z}catch(K){e.error("invalid ms "+F+" in calendar "+W)}var Y=new Date(F+O);return Y.setUTCMonth(Y.getUTCMonth()+j)+Z-O},H.findExactDates=function(F,j){for(var W,Z,Q=0,X=0,G=0,Y=0,K=_(j)&&n.getComponentMethod("calendars","getCal")(j),D=0;D<F.length;D++)if(Z=F[D],p(Z)){if(!(Z%s))if(K)try{(W=K.fromJD(Z/s+r)).day()===1?W.month()===1?Q++:X++:G++}catch(q){}else(W=new Date(Z)).getUTCDate()===1?W.getUTCMonth()===0?Q++:X++:G++}else Y++;G+=X+=Q;var B=F.length-Y;return{exactYears:Q/B,exactMonths:X/B,exactDays:G/B}}},{"../constants/numerical":763,"../registry":915,"./loggers":791,"./mod":794,"d3-time-format":172,"fast-isnumeric":246}],775:[function(h,N,H){var t=h("@plotly/d3"),m=h("./loggers"),g=h("./matrix"),p=h("gl-mat4");function e(o){var a=o&&o.parentNode;a&&a.removeChild(o)}function f(o,a,c){var r="plotly.js-style-"+o,n=document.getElementById(r);n||((n=document.createElement("style")).setAttribute("id",r),n.appendChild(document.createTextNode("")),document.head.appendChild(n));var d=n.sheet;d.insertRule?d.insertRule(a+"{"+c+"}",0):d.addRule?d.addRule(a,c,0):m.warn("addStyleRule failed")}function u(o){var a=window.getComputedStyle(o,null),c=a.getPropertyValue("-webkit-transform")||a.getPropertyValue("-moz-transform")||a.getPropertyValue("-ms-transform")||a.getPropertyValue("-o-transform")||a.getPropertyValue("transform");return c==="none"?null:c.replace("matrix","").replace("3d","").slice(1,-1).split(",").map(function(r){return+r})}function i(o){for(var a=[];s(o);)a.push(o),o=o.parentNode;return a}function s(o){return o&&(o instanceof Element||o instanceof HTMLElement)}N.exports={getGraphDiv:function(o){var a;if(typeof o=="string"){if((a=document.getElementById(o))===null)throw new Error("No DOM element with id '"+o+"' exists on the page.");return a}if(o==null)throw new Error("DOM element provided is null or undefined");return o},isPlotDiv:function(o){var a=t.select(o);return a.node()instanceof HTMLElement&&a.size()&&a.classed("js-plotly-plot")},removeElement:e,addStyleRule:function(o,a){f("global",o,a)},addRelatedStyleRule:f,deleteRelatedStyleRule:function(o){var a="plotly.js-style-"+o,c=document.getElementById(a);c&&e(c)},getFullTransformMatrix:function(o){var a=i(o),c=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return a.forEach(function(r){var n=u(r);if(n){var d=g.convertCssMatrix(n);c=p.multiply(c,c,d)}}),c},getElementTransformMatrix:u,getElementAndAncestors:i,equalDomRects:function(o,a){return o&&a&&o.x===a.x&&o.y===a.y&&o.top===a.top&&o.left===a.left&&o.right===a.right&&o.bottom===a.bottom}}},{"./loggers":791,"./matrix":793,"@plotly/d3":58,"gl-mat4":292}],776:[function(h,N,H){var t=h("events").EventEmitter,m={init:function(g){if(g._ev instanceof t)return g;var p=new t,e=new t;return g._ev=p,g._internalEv=e,g.on=p.on.bind(p),g.once=p.once.bind(p),g.removeListener=p.removeListener.bind(p),g.removeAllListeners=p.removeAllListeners.bind(p),g._internalOn=e.on.bind(e),g._internalOnce=e.once.bind(e),g._removeInternalListener=e.removeListener.bind(e),g._removeAllInternalListeners=e.removeAllListeners.bind(e),g.emit=function(f,u){typeof jQuery!="undefined"&&jQuery(g).trigger(f,u),p.emit(f,u),e.emit(f,u)},g},triggerHandler:function(g,p,e){var f,u;typeof jQuery!="undefined"&&(f=jQuery(g).triggerHandler(p,e));var i=g._ev;if(!i)return f;var s,o=i._events[p];if(!o)return f;function a(c){return c.listener?(i.removeListener(p,c.listener),c.fired?void 0:(c.fired=!0,c.listener.apply(i,[e]))):c.apply(i,[e])}for(o=Array.isArray(o)?o:[o],s=0;s<o.length-1;s++)a(o[s]);return u=a(o[s]),f!==void 0?f:u},purge:function(g){return delete g._ev,delete g.on,delete g.once,delete g.removeListener,delete g.removeAllListeners,delete g.emit,delete g._ev,delete g._internalEv,delete g._internalOn,delete g._internalOnce,delete g._removeInternalListener,delete g._removeAllInternalListeners,g}};N.exports=m},{events:116}],777:[function(h,N,H){var t=h("./is_plain_object.js"),m=Array.isArray;function g(p,e,f,u){var i,s,o,a,c,r,n=p[0],d=p.length;if(d===2&&m(n)&&m(p[1])&&n.length===0){if(function(y,v){var _,x;for(_=0;_<y.length;_++){if((x=y[_])!==null&&typeof x=="object")return!1;x!==void 0&&(v[_]=x)}return!0}(p[1],n))return n;n.splice(0,n.length)}for(var l=1;l<d;l++)for(s in i=p[l])o=n[s],a=i[s],u&&m(a)?n[s]=a:e&&a&&(t(a)||(c=m(a)))?(c?(c=!1,r=o&&m(o)?o:[]):r=o&&t(o)?o:{},n[s]=g([r,a],e,f,u)):(a!==void 0||f)&&(n[s]=a);return n}H.extendFlat=function(){return g(arguments,!1,!1,!1)},H.extendDeep=function(){return g(arguments,!0,!1,!1)},H.extendDeepAll=function(){return g(arguments,!0,!0,!1)},H.extendDeepNoArrays=function(){return g(arguments,!0,!1,!0)}},{"./is_plain_object.js":788}],778:[function(h,N,H){N.exports=function(t){for(var m={},g=[],p=0,e=0;e<t.length;e++){var f=t[e];m[f]!==1&&(m[f]=1,g[p++]=f)}return g}},{}],779:[function(h,N,H){function t(g){return g.visible===!0}function m(g){var p=g[0].trace;return p.visible===!0&&p._length!==0}N.exports=function(g){for(var p,e=(p=g,Array.isArray(p)&&Array.isArray(p[0])&&p[0][0]&&p[0][0].trace?m:t),f=[],u=0;u<g.length;u++){var i=g[u];e(i)&&f.push(i)}return f}},{}],780:[function(h,N,H){var t=h("@plotly/d3"),m=h("country-regex"),g=h("@turf/area"),p=h("@turf/centroid"),e=h("@turf/bbox"),f=h("./identity"),u=h("./loggers"),i=h("./is_plain_object"),s=h("./nested_property"),o=h("./polygon"),a=Object.keys(m),c={"ISO-3":f,"USA-states":f,"country names":function(n){for(var d=0;d<a.length;d++){var l=a[d];if(new RegExp(m[l]).test(n.trim().toLowerCase()))return l}return u.log("Unrecognized country name: "+n+"."),!1}};function r(n){var d=n.geojson,l=window.PlotlyGeoAssets||{},y=typeof d=="string"?l[d]:d;return i(y)?y:(u.error("Oops ... something went wrong when fetching "+d),!1)}N.exports={locationToFeature:function(n,d,l){if(!d||typeof d!="string")return!1;var y,v,_,x=c[n](d);if(x){if(n==="USA-states")for(y=[],_=0;_<l.length;_++)(v=l[_]).properties&&v.properties.gu&&v.properties.gu==="USA"&&y.push(v);else y=l;for(_=0;_<y.length;_++)if((v=y[_]).id===x)return v;u.log(["Location with id",x,"does not have a matching topojson feature at this resolution."].join(" "))}return!1},feature2polygons:function(n){var d,l,y,v,_=n.geometry,x=_.coordinates,T=n.id,A=[];function S(w){for(var L=0;L<w.length-1;L++)if(w[L][0]>0&&w[L+1][0]<0)return L;return null}switch(d=T==="RUS"||T==="FJI"?function(w){var L;if(S(w)===null)L=w;else for(L=new Array(w.length),v=0;v<w.length;v++)L[v]=[w[v][0]<0?w[v][0]+360:w[v][0],w[v][1]];A.push(o.tester(L))}:T==="ATA"?function(w){var L=S(w);if(L===null)return A.push(o.tester(w));var k=new Array(w.length+1),C=0;for(v=0;v<w.length;v++)v>L?k[C++]=[w[v][0]+360,w[v][1]]:v===L?(k[C++]=w[v],k[C++]=[w[v][0],-90]):k[C++]=w[v];var M=o.tester(k);M.pts.pop(),A.push(M)}:function(w){A.push(o.tester(w))},_.type){case"MultiPolygon":for(l=0;l<x.length;l++)for(y=0;y<x[l].length;y++)d(x[l][y]);break;case"Polygon":for(l=0;l<x.length;l++)d(x[l])}return A},getTraceGeojson:r,extractTraceFeature:function(n){var d=n[0].trace,l=r(d);if(!l)return!1;var y,v={},_=[];for(y=0;y<d._length;y++){var x=n[y];(x.loc||x.loc===0)&&(v[x.loc]=x)}function T(w){var L=s(w,d.featureidkey||"id").get(),k=v[L];if(k){var C=w.geometry;if(C.type==="Polygon"||C.type==="MultiPolygon"){var M={type:"Feature",id:L,geometry:C,properties:{}};M.properties.ct=function(P){var O,F=P.geometry;if(F.type==="MultiPolygon")for(var j=F.coordinates,W=0,Z=0;Z<j.length;Z++){var Q={type:"Polygon",coordinates:j[Z]},X=g.default(Q);X>W&&(W=X,O=Q)}else O=F;return p.default(O).geometry.coordinates}(M),k.fIn=w,k.fOut=M,_.push(M)}else u.log(["Location",k.loc,"does not have a valid GeoJSON geometry.","Traces with locationmode *geojson-id* only support","*Polygon* and *MultiPolygon* geometries."].join(" "))}delete v[L]}switch(l.type){case"FeatureCollection":var A=l.features;for(y=0;y<A.length;y++)T(A[y]);break;case"Feature":T(l);break;default:return u.warn(["Invalid GeoJSON type",(l.type||"none")+".","Traces with locationmode *geojson-id* only support","*FeatureCollection* and *Feature* types."].join(" ")),!1}for(var S in v)u.log(["Location *"+S+"*","does not have a matching feature with id-key","*"+d.featureidkey+"*."].join(" "));return _},fetchTraceGeoData:function(n){var d=window.PlotlyGeoAssets||{},l=[];function y(T){return new Promise(function(A,S){t.json(T,function(w,L){if(w){delete d[T];var k=w.status===404?'GeoJSON at URL "'+T+'" does not exist.':"Unexpected error while fetching from "+T;return S(new Error(k))}return d[T]=L,A(L)})})}function v(T){return new Promise(function(A,S){var w=0,L=setInterval(function(){return d[T]&&d[T]!=="pending"?(clearInterval(L),A(d[T])):w>100?(clearInterval(L),S("Unexpected error while fetching from "+T)):void w++},50)})}for(var _=0;_<n.length;_++){var x=n[_][0].trace.geojson;typeof x=="string"&&(d[x]?d[x]==="pending"&&l.push(v(x)):(d[x]="pending",l.push(y(x))))}return l},computeBbox:function(n){return e.default(n)}}},{"./identity":785,"./is_plain_object":788,"./loggers":791,"./nested_property":795,"./polygon":799,"@plotly/d3":58,"@turf/area":61,"@turf/bbox":64,"@turf/centroid":67,"country-regex":145}],781:[function(h,N,H){var t=h("../constants/numerical").BADNUM;H.calcTraceToLineCoords=function(m){for(var g=m[0].trace.connectgaps,p=[],e=[],f=0;f<m.length;f++){var u=m[f].lonlat;u[0]!==t?e.push(u):!g&&e.length>0&&(p.push(e),e=[])}return e.length>0&&p.push(e),p},H.makeLine=function(m){return m.length===1?{type:"LineString",coordinates:m[0]}:{type:"MultiLineString",coordinates:m}},H.makePolygon=function(m){if(m.length===1)return{type:"Polygon",coordinates:m};for(var g=new Array(m.length),p=0;p<m.length;p++)g[p]=[m[p]];return{type:"MultiPolygon",coordinates:g}},H.makeBlank=function(){return{type:"Point",coordinates:[]}}},{"../constants/numerical":763}],782:[function(h,N,H){var t,m,g,p=h("./mod").mod;function e(u,i,s,o,a,c,r,n){var d=s-u,l=a-u,y=r-a,v=o-i,_=c-i,x=n-c,T=d*x-y*v;if(T===0)return null;var A=(l*x-y*_)/T,S=(l*v-d*_)/T;return S<0||S>1||A<0||A>1?null:{x:u+d*A,y:i+v*A}}function f(u,i,s,o,a){var c=o*u+a*i;if(c<0)return o*o+a*a;if(c>s){var r=o-u,n=a-i;return r*r+n*n}var d=o*i-a*u;return d*d/s}H.segmentsIntersect=e,H.segmentDistance=function(u,i,s,o,a,c,r,n){if(e(u,i,s,o,a,c,r,n))return 0;var d=s-u,l=o-i,y=r-a,v=n-c,_=d*d+l*l,x=y*y+v*v,T=Math.min(f(d,l,_,a-u,c-i),f(d,l,_,r-u,n-i),f(y,v,x,u-a,i-c),f(y,v,x,s-a,o-c));return Math.sqrt(T)},H.getTextLocation=function(u,i,s,o){if(u===m&&o===g||(t={},m=u,g=o),t[s])return t[s];var a=u.getPointAtLength(p(s-o/2,i)),c=u.getPointAtLength(p(s+o/2,i)),r=Math.atan((c.y-a.y)/(c.x-a.x)),n=u.getPointAtLength(p(s,i)),d={x:(4*n.x+a.x+c.x)/6,y:(4*n.y+a.y+c.y)/6,theta:r};return t[s]=d,d},H.clearLocationCache=function(){m=null},H.getVisibleSegment=function(u,i,s){var o,a,c=i.left,r=i.right,n=i.top,d=i.bottom,l=0,y=u.getTotalLength(),v=y;function _(T){var A=u.getPointAtLength(T);T===0?o=A:T===y&&(a=A);var S=A.x<c?c-A.x:A.x>r?A.x-r:0,w=A.y<n?n-A.y:A.y>d?A.y-d:0;return Math.sqrt(S*S+w*w)}for(var x=_(l);x;){if((l+=x+s)>v)return;x=_(l)}for(x=_(v);x;){if(l>(v-=x+s))return;x=_(v)}return{min:l,max:v,len:v-l,total:y,isClosed:l===0&&v===y&&Math.abs(o.x-a.x)<.1&&Math.abs(o.y-a.y)<.1}},H.findPointOnPath=function(u,i,s,o){for(var a,c,r,n=(o=o||{}).pathLength||u.getTotalLength(),d=o.tolerance||.001,l=o.iterationLimit||30,y=u.getPointAtLength(0)[s]>u.getPointAtLength(n)[s]?-1:1,v=0,_=0,x=n;v<l;){if(a=(_+x)/2,r=(c=u.getPointAtLength(a))[s]-i,Math.abs(r)<d)return c;y*r>0?x=a:_=a,v++}return c}},{"./mod":794}],783:[function(h,N,H){var t=h("fast-isnumeric"),m=h("tinycolor2"),g=h("color-normalize"),p=h("../components/colorscale"),e=h("../components/color/attributes").defaultLine,f=h("./array").isArrayOrTypedArray,u=g(e);function i(a,c){var r=a;return r[3]*=c,r}function s(a){if(t(a))return u;var c=g(a);return c.length?c:u}function o(a){return t(a)?a:1}N.exports={formatColor:function(a,c,r){var n,d,l,y,v,_=a.color,x=f(_),T=f(c),A=p.extractOpts(a),S=[];if(n=A.colorscale!==void 0?p.makeColorScaleFuncFromTrace(a):s,d=x?function(L,k){return L[k]===void 0?u:g(n(L[k]))}:s,l=T?function(L,k){return L[k]===void 0?1:o(L[k])}:o,x||T)for(var w=0;w<r;w++)y=d(_,w),v=l(c,w),S[w]=i(y,v);else S=i(g(_),c);return S},parseColorScale:function(a){var c=p.extractOpts(a),r=c.colorscale;return c.reversescale&&(r=p.flipScale(c.colorscale)),r.map(function(n){var d=n[0],l=m(n[1]).toRgb();return{index:d,rgb:[l.r,l.g,l.b,l.a]}})}}},{"../components/color/attributes":649,"../components/colorscale":662,"./array":769,"color-normalize":131,"fast-isnumeric":246,tinycolor2:583}],784:[function(h,N,H){var t=h("./identity");function m(g){return[g]}N.exports={keyFun:function(g){return g.key},repeat:m,descend:t,wrap:m,unwrap:function(g){return g[0]}}},{"./identity":785}],785:[function(h,N,H){N.exports=function(t){return t}},{}],786:[function(h,N,H){N.exports=function(t,m){if(!m)return t;var g=1/Math.abs(m),p=g>1?(g*t+g*m)/g:t+m,e=String(p).length;if(e>16){var f=String(m).length;if(e>=String(t).length+f){var u=parseFloat(p).toPrecision(12);u.indexOf("e+")===-1&&(p=+u)}}return p}},{}],787:[function(h,N,H){var t=h("@plotly/d3"),m=h("d3-time-format").utcFormat,g=h("d3-format").format,p=h("fast-isnumeric"),e=h("../constants/numerical"),f=e.FP_SAFE,u=-f,i=e.BADNUM,s=N.exports={};s.adjustFormat=function(D){return!D||/^\d[.]\df/.test(D)||/[.]\d%/.test(D)?D:D==="0.f"?"~f":/^\d%/.test(D)?"~%":/^\ds/.test(D)?"~s":!/^[~,.0$]/.test(D)&&/[&fps]/.test(D)?"~"+D:D};var o={};s.warnBadFormat=function(D){var B=String(D);o[B]||(o[B]=1,s.warn('encountered bad format: "'+B+'"'))},s.noFormat=function(D){return String(D)},s.numberFormat=function(D){var B;try{B=g(s.adjustFormat(D))}catch(q){return s.warnBadFormat(D),s.noFormat}return B},s.nestedProperty=h("./nested_property"),s.keyedContainer=h("./keyed_container"),s.relativeAttr=h("./relative_attr"),s.isPlainObject=h("./is_plain_object"),s.toLogRange=h("./to_log_range"),s.relinkPrivateKeys=h("./relink_private");var a=h("./array");s.isTypedArray=a.isTypedArray,s.isArrayOrTypedArray=a.isArrayOrTypedArray,s.isArray1D=a.isArray1D,s.ensureArray=a.ensureArray,s.concat=a.concat,s.maxRowLength=a.maxRowLength,s.minRowLength=a.minRowLength;var c=h("./mod");s.mod=c.mod,s.modHalf=c.modHalf;var r=h("./coerce");s.valObjectMeta=r.valObjectMeta,s.coerce=r.coerce,s.coerce2=r.coerce2,s.coerceFont=r.coerceFont,s.coercePattern=r.coercePattern,s.coerceHoverinfo=r.coerceHoverinfo,s.coerceSelectionMarkerOpacity=r.coerceSelectionMarkerOpacity,s.validate=r.validate;var n=h("./dates");s.dateTime2ms=n.dateTime2ms,s.isDateTime=n.isDateTime,s.ms2DateTime=n.ms2DateTime,s.ms2DateTimeLocal=n.ms2DateTimeLocal,s.cleanDate=n.cleanDate,s.isJSDate=n.isJSDate,s.formatDate=n.formatDate,s.incrementMonth=n.incrementMonth,s.dateTick0=n.dateTick0,s.dfltRange=n.dfltRange,s.findExactDates=n.findExactDates,s.MIN_MS=n.MIN_MS,s.MAX_MS=n.MAX_MS;var d=h("./search");s.findBin=d.findBin,s.sorterAsc=d.sorterAsc,s.sorterDes=d.sorterDes,s.distinctVals=d.distinctVals,s.roundUp=d.roundUp,s.sort=d.sort,s.findIndexOfMin=d.findIndexOfMin,s.sortObjectKeys=h("./sort_object_keys");var l=h("./stats");s.aggNums=l.aggNums,s.len=l.len,s.mean=l.mean,s.median=l.median,s.midRange=l.midRange,s.variance=l.variance,s.stdev=l.stdev,s.interp=l.interp;var y=h("./matrix");s.init2dArray=y.init2dArray,s.transposeRagged=y.transposeRagged,s.dot=y.dot,s.translationMatrix=y.translationMatrix,s.rotationMatrix=y.rotationMatrix,s.rotationXYMatrix=y.rotationXYMatrix,s.apply3DTransform=y.apply3DTransform,s.apply2DTransform=y.apply2DTransform,s.apply2DTransform2=y.apply2DTransform2,s.convertCssMatrix=y.convertCssMatrix,s.inverseTransformMatrix=y.inverseTransformMatrix;var v=h("./angles");s.deg2rad=v.deg2rad,s.rad2deg=v.rad2deg,s.angleDelta=v.angleDelta,s.angleDist=v.angleDist,s.isFullCircle=v.isFullCircle,s.isAngleInsideSector=v.isAngleInsideSector,s.isPtInsideSector=v.isPtInsideSector,s.pathArc=v.pathArc,s.pathSector=v.pathSector,s.pathAnnulus=v.pathAnnulus;var _=h("./anchor_utils");s.isLeftAnchor=_.isLeftAnchor,s.isCenterAnchor=_.isCenterAnchor,s.isRightAnchor=_.isRightAnchor,s.isTopAnchor=_.isTopAnchor,s.isMiddleAnchor=_.isMiddleAnchor,s.isBottomAnchor=_.isBottomAnchor;var x=h("./geometry2d");s.segmentsIntersect=x.segmentsIntersect,s.segmentDistance=x.segmentDistance,s.getTextLocation=x.getTextLocation,s.clearLocationCache=x.clearLocationCache,s.getVisibleSegment=x.getVisibleSegment,s.findPointOnPath=x.findPointOnPath;var T=h("./extend");s.extendFlat=T.extendFlat,s.extendDeep=T.extendDeep,s.extendDeepAll=T.extendDeepAll,s.extendDeepNoArrays=T.extendDeepNoArrays;var A=h("./loggers");s.log=A.log,s.warn=A.warn,s.error=A.error;var S=h("./regex");s.counterRegex=S.counter;var w=h("./throttle");s.throttle=w.throttle,s.throttleDone=w.done,s.clearThrottle=w.clear;var L=h("./dom");function k(D){var B={};for(var q in D)for(var ee=D[q],J=0;J<ee.length;J++)B[ee[J]]=+q;return B}s.getGraphDiv=L.getGraphDiv,s.isPlotDiv=L.isPlotDiv,s.removeElement=L.removeElement,s.addStyleRule=L.addStyleRule,s.addRelatedStyleRule=L.addRelatedStyleRule,s.deleteRelatedStyleRule=L.deleteRelatedStyleRule,s.getFullTransformMatrix=L.getFullTransformMatrix,s.getElementTransformMatrix=L.getElementTransformMatrix,s.getElementAndAncestors=L.getElementAndAncestors,s.equalDomRects=L.equalDomRects,s.clearResponsive=h("./clear_responsive"),s.preserveDrawingBuffer=h("./preserve_drawing_buffer"),s.makeTraceGroups=h("./make_trace_groups"),s._=h("./localize"),s.notifier=h("./notifier"),s.filterUnique=h("./filter_unique"),s.filterVisible=h("./filter_visible"),s.pushUnique=h("./push_unique"),s.increment=h("./increment"),s.cleanNumber=h("./clean_number"),s.ensureNumber=function(D){return p(D)?(D=Number(D))>f||D<u?i:D:i},s.isIndex=function(D,B){return!(B!==void 0&&D>=B)&&p(D)&&D>=0&&D%1==0},s.noop=h("./noop"),s.identity=h("./identity"),s.repeat=function(D,B){for(var q=new Array(B),ee=0;ee<B;ee++)q[ee]=D;return q},s.swapAttrs=function(D,B,q,ee){q||(q="x"),ee||(ee="y");for(var J=0;J<B.length;J++){var $=B[J],te=s.nestedProperty(D,$.replace("?",q)),ie=s.nestedProperty(D,$.replace("?",ee)),ae=te.get();te.set(ie.get()),ie.set(ae)}},s.raiseToTop=function(D){D.parentNode.appendChild(D)},s.cancelTransition=function(D){return D.transition().duration(0)},s.constrain=function(D,B,q){return B>q?Math.max(q,Math.min(B,D)):Math.max(B,Math.min(q,D))},s.bBoxIntersect=function(D,B,q){return q=q||0,D.left<=B.right+q&&B.left<=D.right+q&&D.top<=B.bottom+q&&B.top<=D.bottom+q},s.simpleMap=function(D,B,q,ee,J){for(var $=D.length,te=new Array($),ie=0;ie<$;ie++)te[ie]=B(D[ie],q,ee,J);return te},s.randstr=function D(B,q,ee,J){if(ee||(ee=16),q===void 0&&(q=24),q<=0)return"0";var $,te,ie=Math.log(Math.pow(2,q))/Math.log(ee),ae="";for($=2;ie===1/0;$*=2)ie=Math.log(Math.pow(2,q/$))/Math.log(ee)*$;var he=ie-Math.floor(ie);for($=0;$<Math.floor(ie);$++)ae=Math.floor(Math.random()*ee).toString(ee)+ae;he&&(te=Math.pow(ee,he),ae=Math.floor(Math.random()*te).toString(ee)+ae);var se=parseInt(ae,ee);return B&&B[ae]||se!==1/0&&se>=Math.pow(2,q)?J>10?(s.warn("randstr failed uniqueness"),ae):D(B,q,ee,(J||0)+1):ae},s.OptionControl=function(D,B){D||(D={}),B||(B="opt");var q={optionList:[],_newoption:function(ee){ee[B]=D,q[ee.name]=ee,q.optionList.push(ee)}};return q["_"+B]=D,q},s.smooth=function(D,B){if((B=Math.round(B)||0)<2)return D;var q,ee,J,$,te=D.length,ie=2*te,ae=2*B-1,he=new Array(ae),se=new Array(te);for(q=0;q<ae;q++)he[q]=(1-Math.cos(Math.PI*(q+1)/B))/(2*B);for(q=0;q<te;q++){for($=0,ee=0;ee<ae;ee++)(J=q+ee+1-B)<-te?J-=ie*Math.round(J/ie):J>=ie&&(J-=ie*Math.floor(J/ie)),J<0?J=-1-J:J>=te&&(J=ie-1-J),$+=D[J]*he[ee];se[q]=$}return se},s.syncOrAsync=function(D,B,q){var ee;function J(){return s.syncOrAsync(D,B,q)}for(;D.length;)if((ee=(0,D.splice(0,1)[0])(B))&&ee.then)return ee.then(J);return q&&q(B)},s.stripTrailingSlash=function(D){return D.substr(-1)==="/"?D.substr(0,D.length-1):D},s.noneOrAll=function(D,B,q){if(D){var ee,J=!1,$=!0;for(ee=0;ee<q.length;ee++)D[q[ee]]!=null?J=!0:$=!1;if(J&&!$)for(ee=0;ee<q.length;ee++)D[q[ee]]=B[q[ee]]}},s.mergeArray=function(D,B,q,ee){var J=typeof ee=="function";if(s.isArrayOrTypedArray(D))for(var $=Math.min(D.length,B.length),te=0;te<$;te++){var ie=D[te];B[te][q]=J?ee(ie):ie}},s.mergeArrayCastPositive=function(D,B,q){return s.mergeArray(D,B,q,function(ee){var J=+ee;return isFinite(J)&&J>0?J:0})},s.fillArray=function(D,B,q,ee){if(ee=ee||s.identity,s.isArrayOrTypedArray(D))for(var J=0;J<B.length;J++)B[J][q]=ee(D[J])},s.castOption=function(D,B,q,ee){ee=ee||s.identity;var J=s.nestedProperty(D,q).get();return s.isArrayOrTypedArray(J)?Array.isArray(B)&&s.isArrayOrTypedArray(J[B[0]])?ee(J[B[0]][B[1]]):ee(J[B]):J},s.extractOption=function(D,B,q,ee){if(q in D)return D[q];var J=s.nestedProperty(B,ee).get();return Array.isArray(J)?void 0:J},s.tagSelected=function(D,B,q){var ee,J,$=B.selectedpoints,te=B._indexToPoints;te&&(ee=k(te));for(var ie=0;ie<$.length;ie++){var ae=$[ie];if(s.isIndex(ae)||s.isArrayOrTypedArray(ae)&&s.isIndex(ae[0])&&s.isIndex(ae[1])){var he=ee?ee[ae]:ae,se=q?q[he]:he;(J=se)!==void 0&&J<D.length&&(D[se].selected=1)}}},s.selIndices2selPoints=function(D){var B=D.selectedpoints,q=D._indexToPoints;if(q){for(var ee=k(q),J=[],$=0;$<B.length;$++){var te=B[$];if(s.isIndex(te)){var ie=ee[te];s.isIndex(ie)&&J.push(ie)}}return J}return B},s.getTargetArray=function(D,B){var q=B.target;if(typeof q=="string"&&q){var ee=s.nestedProperty(D,q).get();return!!Array.isArray(ee)&&ee}return!!Array.isArray(q)&&q},s.minExtend=function(D,B){var q={};typeof B!="object"&&(B={});var ee,J,$,te=Object.keys(D);for(ee=0;ee<te.length;ee++)$=D[J=te[ee]],J.charAt(0)!=="_"&&typeof $!="function"&&(J==="module"?q[J]=$:Array.isArray($)?q[J]=J==="colorscale"?$.slice():$.slice(0,3):s.isTypedArray($)?q[J]=$.subarray(0,3):q[J]=$&&typeof $=="object"?s.minExtend(D[J],B[J]):$);for(te=Object.keys(B),ee=0;ee<te.length;ee++)typeof($=B[J=te[ee]])=="object"&&J in q&&typeof q[J]=="object"||(q[J]=$);return q},s.titleCase=function(D){return D.charAt(0).toUpperCase()+D.substr(1)},s.containsAny=function(D,B){for(var q=0;q<B.length;q++)if(D.indexOf(B[q])!==-1)return!0;return!1},s.isIE=function(){return window.navigator.msSaveBlob!==void 0};var C=/Version\/[\d\.]+.*Safari/;s.isSafari=function(){return C.test(window.navigator.userAgent)};var M=/iPad|iPhone|iPod/;s.isIOS=function(){return M.test(window.navigator.userAgent)};var P=/Firefox\/(\d+)\.\d+/;s.getFirefoxVersion=function(){var D=P.exec(window.navigator.userAgent);if(D&&D.length===2){var B=parseInt(D[1]);if(!isNaN(B))return B}return null},s.isD3Selection=function(D){return D instanceof t.selection},s.ensureSingle=function(D,B,q,ee){var J=D.select(B+(q?"."+q:""));if(J.size())return J;var $=D.append(B);return q&&$.classed(q,!0),ee&&$.call(ee),$},s.ensureSingleById=function(D,B,q,ee){var J=D.select(B+"#"+q);if(J.size())return J;var $=D.append(B).attr("id",q);return ee&&$.call(ee),$},s.objectFromPath=function(D,B){for(var q,ee=D.split("."),J=q={},$=0;$<ee.length;$++){var te=ee[$],ie=null,ae=ee[$].match(/(.*)\[([0-9]+)\]/);ae?(te=ae[1],ie=ae[2],q=q[te]=[],$===ee.length-1?q[ie]=B:q[ie]={},q=q[ie]):($===ee.length-1?q[te]=B:q[te]={},q=q[te])}return J};var O=/^([^\[\.]+)\.(.+)?/,F=/^([^\.]+)\[([0-9]+)\](\.)?(.+)?/;s.expandObjectPaths=function(D){var B,q,ee,J,$,te,ie;if(typeof D=="object"&&!Array.isArray(D))for(q in D)D.hasOwnProperty(q)&&((B=q.match(O))?(J=D[q],ee=B[1],delete D[q],D[ee]=s.extendDeepNoArrays(D[ee]||{},s.objectFromPath(q,s.expandObjectPaths(J))[ee])):(B=q.match(F))?(J=D[q],ee=B[1],$=parseInt(B[2]),delete D[q],D[ee]=D[ee]||[],B[3]==="."?(ie=B[4],te=D[ee][$]=D[ee][$]||{},s.extendDeepNoArrays(te,s.objectFromPath(ie,s.expandObjectPaths(J)))):D[ee][$]=s.expandObjectPaths(J)):D[q]=s.expandObjectPaths(D[q]));return D},s.numSeparate=function(D,B,q){if(q||(q=!1),typeof B!="string"||B.length===0)throw new Error("Separator string required for formatting!");typeof D=="number"&&(D=String(D));var ee=/(\d+)(\d{3})/,J=B.charAt(0),$=B.charAt(1),te=D.split("."),ie=te[0],ae=te.length>1?J+te[1]:"";if($&&(te.length>1||ie.length>4||q))for(;ee.test(ie);)ie=ie.replace(ee,"$1"+$+"$2");return ie+ae},s.TEMPLATE_STRING_REGEX=/%{([^\s%{}:]*)([:|\|][^}]*)?}/g;var j=/^\w*$/;s.templateString=function(D,B){var q={};return D.replace(s.TEMPLATE_STRING_REGEX,function(ee,J){var $;return j.test(J)?$=B[J]:(q[J]=q[J]||s.nestedProperty(B,J).get,$=q[J]()),s.isValidTextValue($)?$:""})};var W={max:10,count:0,name:"hovertemplate"};s.hovertemplateString=function(){return X.apply(W,arguments)};var Z={max:10,count:0,name:"texttemplate"};s.texttemplateString=function(){return X.apply(Z,arguments)};var Q=/^[:|\|]/;function X(D,B,q){var ee=this,J=arguments;B||(B={});var $={};return D.replace(s.TEMPLATE_STRING_REGEX,function(te,ie,ae){var he,se,de,ce=ie==="_xother"||ie==="_yother",ve=ie==="_xother_"||ie==="_yother_",ke=ie==="xother_"||ie==="yother_",Ee=ie==="xother"||ie==="yother"||ce||ke||ve,be=ie;if((ce||ve)&&(be=be.substring(1)),(ke||ve)&&(be=be.substring(0,be.length-1)),Ee){if((he=B[be])===void 0)return""}else for(de=3;de<J.length;de++)if(se=J[de]){if(se.hasOwnProperty(be)){he=se[be];break}if(j.test(be)||(he=s.nestedProperty(se,be).get(),(he=$[be]||s.nestedProperty(se,be).get())&&($[be]=he)),he!==void 0)break}if(he===void 0&&ee)return ee.count<ee.max&&(s.warn("Variable '"+be+"' in "+ee.name+" could not be found!"),he=te),ee.count===ee.max&&s.warn("Too many "+ee.name+" warnings - additional warnings will be suppressed"),ee.count++,te;if(ae){var xe;if(ae[0]===":"&&(he=(xe=q?q.numberFormat:s.numberFormat)(ae.replace(Q,""))(he)),ae[0]==="|"){xe=q?q.timeFormat:m;var ue=s.dateTime2ms(he);he=s.formatDate(ue,ae.replace(Q,""),!1,xe)}}else{var me=be+"Label";B.hasOwnProperty(me)&&(he=B[me])}return Ee&&(he="("+he+")",(ce||ve)&&(he=" "+he),(ke||ve)&&(he+=" ")),he})}s.subplotSort=function(D,B){for(var q=Math.min(D.length,B.length)+1,ee=0,J=0,$=0;$<q;$++){var te=D.charCodeAt($)||0,ie=B.charCodeAt($)||0,ae=te>=48&&te<=57,he=ie>=48&&ie<=57;if(ae&&(ee=10*ee+te-48),he&&(J=10*J+ie-48),!ae||!he){if(ee!==J)return ee-J;if(te!==ie)return te-ie}}return J-ee};var G=2e9;s.seedPseudoRandom=function(){G=2e9},s.pseudoRandom=function(){var D=G;return G=(69069*G+1)%4294967296,Math.abs(G-D)<429496729?s.pseudoRandom():G/4294967296},s.fillText=function(D,B,q){var ee=Array.isArray(q)?function(te){q.push(te)}:function(te){q.text=te},J=s.extractOption(D,B,"htx","hovertext");if(s.isValidTextValue(J))return ee(J);var $=s.extractOption(D,B,"tx","text");return s.isValidTextValue($)?ee($):void 0},s.isValidTextValue=function(D){return D||D===0},s.formatPercent=function(D,B){B=B||0;for(var q=(Math.round(100*D*Math.pow(10,B))*Math.pow(.1,B)).toFixed(B)+"%",ee=0;ee<B;ee++)q.indexOf(".")!==-1&&(q=(q=q.replace("0%","%")).replace(".%","%"));return q},s.isHidden=function(D){var B=window.getComputedStyle(D).display;return!B||B==="none"},s.strTranslate=function(D,B){return D||B?"translate("+D+","+B+")":""},s.strRotate=function(D){return D?"rotate("+D+")":""},s.strScale=function(D){return D!==1?"scale("+D+")":""},s.getTextTransform=function(D){var B=D.noCenter,q=D.textX,ee=D.textY,J=D.targetX,$=D.targetY,te=D.anchorX||0,ie=D.anchorY||0,ae=D.rotate,he=D.scale;return he?he>1&&(he=1):he=0,s.strTranslate(J-he*(q+te),$-he*(ee+ie))+s.strScale(he)+(ae?"rotate("+ae+(B?"":" "+q+" "+ee)+")":"")},s.ensureUniformFontSize=function(D,B){var q=s.extendFlat({},B);return q.size=Math.max(B.size,D._fullLayout.uniformtext.minsize||0),q},s.join2=function(D,B,q){var ee=D.length;return ee>1?D.slice(0,-1).join(B)+q+D[ee-1]:D.join(B)},s.bigFont=function(D){return Math.round(1.2*D)};var Y=s.getFirefoxVersion(),K=Y!==null&&Y<86;s.getPositionFromD3Event=function(){return K?[t.event.layerX,t.event.layerY]:[t.event.offsetX,t.event.offsetY]}},{"../constants/numerical":763,"./anchor_utils":767,"./angles":768,"./array":769,"./clean_number":770,"./clear_responsive":772,"./coerce":773,"./dates":774,"./dom":775,"./extend":777,"./filter_unique":778,"./filter_visible":779,"./geometry2d":782,"./identity":785,"./increment":786,"./is_plain_object":788,"./keyed_container":789,"./localize":790,"./loggers":791,"./make_trace_groups":792,"./matrix":793,"./mod":794,"./nested_property":795,"./noop":796,"./notifier":797,"./preserve_drawing_buffer":801,"./push_unique":802,"./regex":804,"./relative_attr":805,"./relink_private":806,"./search":807,"./sort_object_keys":810,"./stats":811,"./throttle":814,"./to_log_range":815,"@plotly/d3":58,"d3-format":164,"d3-time-format":172,"fast-isnumeric":246}],788:[function(h,N,H){N.exports=function(t){return window&&window.process&&window.process.versions?Object.prototype.toString.call(t)==="[object Object]":Object.prototype.toString.call(t)==="[object Object]"&&Object.getPrototypeOf(t).hasOwnProperty("hasOwnProperty")}},{}],789:[function(h,N,H){var t=h("./nested_property"),m=/^\w*$/;N.exports=function(g,p,e,f){var u,i,s;e=e||"name",f=f||"value";var o={};p&&p.length?(s=t(g,p),i=s.get()):i=g,p=p||"";var a={};if(i)for(u=0;u<i.length;u++)a[i[u][e]]=u;var c=m.test(f),r={set:function(n,d){var l=d===null?4:0;if(!i){if(!s||l===4)return;i=[],s.set(i)}var y=a[n];if(y===void 0){if(l===4)return;l|=3,y=i.length,a[n]=y}else d!==(c?i[y][f]:t(i[y],f).get())&&(l|=2);var v=i[y]=i[y]||{};return v[e]=n,c?v[f]=d:t(v,f).set(d),d!==null&&(l&=-5),o[y]=o[y]|l,r},get:function(n){if(i){var d=a[n];return d===void 0?void 0:c?i[d][f]:t(i[d],f).get()}},rename:function(n,d){var l=a[n];return l===void 0||(o[l]=1|o[l],a[d]=l,delete a[n],i[l][e]=d),r},remove:function(n){var d=a[n];if(d===void 0)return r;var l=i[d];if(Object.keys(l).length>2)return o[d]=2|o[d],r.set(n,null);if(c){for(u=d;u<i.length;u++)o[u]=3|o[u];for(u=d;u<i.length;u++)a[i[u][e]]--;i.splice(d,1),delete a[n]}else t(l,f).set(null),o[d]=6|o[d];return r},constructUpdate:function(){for(var n,d,l={},y=Object.keys(o),v=0;v<y.length;v++)d=y[v],n=p+"["+d+"]",i[d]?(1&o[d]&&(l[n+"."+e]=i[d][e]),2&o[d]&&(l[n+"."+f]=c?4&o[d]?null:i[d][f]:4&o[d]?null:t(i[d],f).get())):l[n]=null;return l}};return r}},{"./nested_property":795}],790:[function(h,N,H){var t=h("../registry");N.exports=function(m,g){for(var p=m._context.locale,e=0;e<2;e++){for(var f=m._context.locales,u=0;u<2;u++){var i=(f[p]||{}).dictionary;if(i){var s=i[g];if(s)return s}f=t.localeRegistry}var o=p.split("-")[0];if(o===p)break;p=o}return g}},{"../registry":915}],791:[function(h,N,H){var t=h("../plot_api/plot_config").dfltConfig,m=h("./notifier"),g=N.exports={};g.log=function(){var p;if(t.logging>1){var e=["LOG:"];for(p=0;p<arguments.length;p++)e.push(arguments[p]);console.trace.apply(console,e)}if(t.notifyOnLogging>1){var f=[];for(p=0;p<arguments.length;p++)f.push(arguments[p]);m(f.join("<br>"),"long")}},g.warn=function(){var p;if(t.logging>0){var e=["WARN:"];for(p=0;p<arguments.length;p++)e.push(arguments[p]);console.trace.apply(console,e)}if(t.notifyOnLogging>0){var f=[];for(p=0;p<arguments.length;p++)f.push(arguments[p]);m(f.join("<br>"),"stick")}},g.error=function(){var p;if(t.logging>0){var e=["ERROR:"];for(p=0;p<arguments.length;p++)e.push(arguments[p]);console.error.apply(console,e)}if(t.notifyOnLogging>0){var f=[];for(p=0;p<arguments.length;p++)f.push(arguments[p]);m(f.join("<br>"),"stick")}}},{"../plot_api/plot_config":825,"./notifier":797}],792:[function(h,N,H){var t=h("@plotly/d3");N.exports=function(m,g,p){var e=m.selectAll("g."+p.replace(/\s/g,".")).data(g,function(u){return u[0].trace.uid});e.exit().remove(),e.enter().append("g").attr("class",p),e.order();var f=m.classed("rangeplot")?"nodeRangePlot3":"node3";return e.each(function(u){u[0][f]=t.select(this)}),e}},{"@plotly/d3":58}],793:[function(h,N,H){var t=h("gl-mat4");H.init2dArray=function(m,g){for(var p=new Array(m),e=0;e<m;e++)p[e]=new Array(g);return p},H.transposeRagged=function(m){var g,p,e=0,f=m.length;for(g=0;g<f;g++)e=Math.max(e,m[g].length);var u=new Array(e);for(g=0;g<e;g++)for(u[g]=new Array(f),p=0;p<f;p++)u[g][p]=m[p][g];return u},H.dot=function(m,g){if(!m.length||!g.length||m.length!==g.length)return null;var p,e,f=m.length;if(m[0].length)for(p=new Array(f),e=0;e<f;e++)p[e]=H.dot(m[e],g);else if(g[0].length){var u=H.transposeRagged(g);for(p=new Array(u.length),e=0;e<u.length;e++)p[e]=H.dot(m,u[e])}else for(p=0,e=0;e<f;e++)p+=m[e]*g[e];return p},H.translationMatrix=function(m,g){return[[1,0,m],[0,1,g],[0,0,1]]},H.rotationMatrix=function(m){var g=m*Math.PI/180;return[[Math.cos(g),-Math.sin(g),0],[Math.sin(g),Math.cos(g),0],[0,0,1]]},H.rotationXYMatrix=function(m,g,p){return H.dot(H.dot(H.translationMatrix(g,p),H.rotationMatrix(m)),H.translationMatrix(-g,-p))},H.apply3DTransform=function(m){return function(){var g=arguments,p=arguments.length===1?g[0]:[g[0],g[1],g[2]||0];return H.dot(m,[p[0],p[1],p[2],1]).slice(0,3)}},H.apply2DTransform=function(m){return function(){var g=arguments;g.length===3&&(g=g[0]);var p=arguments.length===1?g[0]:[g[0],g[1]];return H.dot(m,[p[0],p[1],1]).slice(0,2)}},H.apply2DTransform2=function(m){var g=H.apply2DTransform(m);return function(p){return g(p.slice(0,2)).concat(g(p.slice(2,4)))}},H.convertCssMatrix=function(m){if(m){var g=m.length;if(g===16)return m;if(g===6)return[m[0],m[1],0,0,m[2],m[3],0,0,0,0,1,0,m[4],m[5],0,1]}return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},H.inverseTransformMatrix=function(m){var g=[];return t.invert(g,m),[[g[0],g[1],g[2],g[3]],[g[4],g[5],g[6],g[7]],[g[8],g[9],g[10],g[11]],[g[12],g[13],g[14],g[15]]]}},{"gl-mat4":292}],794:[function(h,N,H){N.exports={mod:function(t,m){var g=t%m;return g<0?g+m:g},modHalf:function(t,m){return Math.abs(t)>m/2?t-Math.round(t/m)*m:t}}},{}],795:[function(h,N,H){var t=h("fast-isnumeric"),m=h("./array").isArrayOrTypedArray;function g(o,a){return function(){var c,r,n,d,l,y=o;for(d=0;d<a.length-1;d++){if((c=a[d])===-1){for(r=!0,n=[],l=0;l<y.length;l++)n[l]=g(y[l],a.slice(d+1))(),n[l]!==n[0]&&(r=!1);return r?n[0]:n}if(typeof c=="number"&&!m(y)||typeof(y=y[c])!="object"||y===null)return}if(typeof y=="object"&&y!==null&&(n=y[a[d]])!==null)return n}}N.exports=function(o,a){if(t(a))a=String(a);else if(typeof a!="string"||a.substr(a.length-4)==="[-1]")throw"bad property string";for(var c,r,n,d=0,l=a.split(".");d<l.length;){if(c=String(l[d]).match(/^([^\[\]]*)((\[\-?[0-9]*\])+)$/)){if(c[1])l[d]=c[1];else{if(d!==0)throw"bad property string";l.splice(0,1)}for(r=c[2].substr(1,c[2].length-2).split("]["),n=0;n<r.length;n++)d++,l.splice(d,0,Number(r[n]))}d++}return typeof o!="object"?function(y,v,_){return{set:function(){throw"bad container"},get:function(){},astr:v,parts:_,obj:y}}(o,a,l):{set:f(o,l,a),get:g(o,l),astr:a,parts:l,obj:o}};var p=/(^|\.)args\[/;function e(o,a){return o===void 0||o===null&&!a.match(p)}function f(o,a,c){return function(r){var n,d,l=o,y="",v=e(r,c);for(d=0;d<a.length-1;d++){if(typeof(n=a[d])=="number"&&!m(l))throw"array index but container is not an array";if(n===-1){if(v=!i(l,a.slice(d+1),r,c))break;return}if(!s(l,n,a[d+1],v))break;if(typeof(l=l[n])!="object"||l===null)throw"container is not an object";y=u(y,n)}if(v){if(d===a.length-1&&(delete l[a[d]],Array.isArray(l)&&+a[d]==l.length-1))for(;l.length&&l[l.length-1]===void 0;)l.pop()}else l[a[d]]=r}}function u(o,a){var c=a;return t(a)?c="["+a+"]":o&&(c="."+a),o+c}function i(o,a,c,r){var n,d=m(c),l=!0,y=c,v=r.replace("-1",0),_=!d&&e(c,v),x=a[0];for(n=0;n<o.length;n++)v=r.replace("-1",n),d&&(_=e(y=c[n%c.length],v)),_&&(l=!1),s(o,n,x,_)&&f(o[n],a,r.replace("-1",n))(y);return l}function s(o,a,c,r){if(o[a]===void 0){if(r)return!1;o[a]=typeof c=="number"?[]:{}}return!0}},{"./array":769,"fast-isnumeric":246}],796:[function(h,N,H){N.exports=function(){}},{}],797:[function(h,N,H){var t=h("@plotly/d3"),m=h("fast-isnumeric"),g=[];N.exports=function(p,e){if(g.indexOf(p)===-1){g.push(p);var f=1e3;m(e)?f=e:e==="long"&&(f=3e3);var u=t.select("body").selectAll(".plotly-notifier").data([0]);u.enter().append("div").classed("plotly-notifier",!0),u.selectAll(".notifier-note").data(g).enter().append("div").classed("notifier-note",!0).style("opacity",0).each(function(s){var o=t.select(this);o.append("button").classed("notifier-close",!0).html("&times;").on("click",function(){o.transition().call(i)});for(var a=o.append("p"),c=s.split(/<br\s*\/?>/g),r=0;r<c.length;r++)r&&a.append("br"),a.append("span").text(c[r]);e==="stick"?o.transition().duration(350).style("opacity",1):o.transition().duration(700).style("opacity",1).transition().delay(f).call(i)})}function i(s){s.duration(700).style("opacity",0).each("end",function(o){var a=g.indexOf(o);a!==-1&&g.splice(a,1),t.select(this).remove()})}}},{"@plotly/d3":58,"fast-isnumeric":246}],798:[function(h,N,H){var t=h("./setcursor"),m="data-savedcursor";N.exports=function(g,p){var e=g.attr(m);if(p){if(!e){for(var f=(g.attr("class")||"").split(" "),u=0;u<f.length;u++){var i=f[u];i.indexOf("cursor-")===0&&g.attr(m,i.substr(7)).classed(i,!1)}g.attr(m)||g.attr(m,"!!")}t(g,p)}else e&&(g.attr(m,null),e==="!!"?t(g):t(g,e))}},{"./setcursor":808}],799:[function(h,N,H){var t=h("./matrix").dot,m=h("../constants/numerical").BADNUM,g=N.exports={};g.tester=function(p){var e,f=p.slice(),u=f[0][0],i=u,s=f[0][1],o=s;for(f.push(f[0]),e=1;e<f.length;e++)u=Math.min(u,f[e][0]),i=Math.max(i,f[e][0]),s=Math.min(s,f[e][1]),o=Math.max(o,f[e][1]);var a,c=!1;f.length===5&&(f[0][0]===f[1][0]?f[2][0]===f[3][0]&&f[0][1]===f[3][1]&&f[1][1]===f[2][1]&&(c=!0,a=function(d){return d[0]===f[0][0]}):f[0][1]===f[1][1]&&f[2][1]===f[3][1]&&f[0][0]===f[3][0]&&f[1][0]===f[2][0]&&(c=!0,a=function(d){return d[1]===f[0][1]}));var r=!0,n=f[0];for(e=1;e<f.length;e++)if(n[0]!==f[e][0]||n[1]!==f[e][1]){r=!1;break}return{xmin:u,xmax:i,ymin:s,ymax:o,pts:f,contains:c?function(d,l){var y=d[0],v=d[1];return!(y===m||y<u||y>i||v===m||v<s||v>o)&&(!l||!a(d))}:function(d,l){var y=d[0],v=d[1];if(y===m||y<u||y>i||v===m||v<s||v>o)return!1;var _,x,T,A,S,w=f.length,L=f[0][0],k=f[0][1],C=0;for(_=1;_<w;_++)if(x=L,T=k,L=f[_][0],k=f[_][1],!(y<(A=Math.min(x,L))||y>Math.max(x,L)||v>Math.max(T,k)))if(v<Math.min(T,k))y!==A&&C++;else{if(v===(S=L===x?v:T+(y-x)*(k-T)/(L-x)))return _!==1||!l;v<=S&&y!==A&&C++}return C%2==1},isRect:c,degenerate:r}},g.isSegmentBent=function(p,e,f,u){var i,s,o,a=p[e],c=[p[f][0]-a[0],p[f][1]-a[1]],r=t(c,c),n=Math.sqrt(r),d=[-c[1]/n,c[0]/n];for(i=e+1;i<f;i++)if(s=[p[i][0]-a[0],p[i][1]-a[1]],(o=t(s,c))<0||o>r||Math.abs(t(s,d))>u)return!0;return!1},g.filter=function(p,e){var f=[p[0]],u=0,i=0;function s(o){p.push(o);var a=f.length,c=u;f.splice(i+1);for(var r=c+1;r<p.length;r++)(r===p.length-1||g.isSegmentBent(p,c,r+1,e))&&(f.push(p[r]),f.length<a-2&&(u=r,i=f.length-1),c=r)}return p.length>1&&s(p.pop()),{addPt:s,raw:p,filtered:f}}},{"../constants/numerical":763,"./matrix":793}],800:[function(h,N,H){(function(t){(function(){var m=h("./show_no_webgl_msg"),g=h("regl");N.exports=function(p,e){var f=p._fullLayout,u=!0;return f._glcanvas.each(function(i){if(!i.regl&&(!i.pick||f._has("parcoords"))){try{i.regl=g({canvas:this,attributes:{antialias:!i.pick,preserveDrawingBuffer:!0},pixelRatio:p._context.plotGlPixelRatio||t.devicePixelRatio,extensions:e||[]})}catch(s){u=!1}i.regl||(u=!1),u&&this.addEventListener("webglcontextlost",function(s){p&&p.emit&&p.emit("plotly_webglcontextlost",{event:s,layer:i.key})},!1)}}),u||m({container:f._glcontainer.node()}),u}}).call(this)}).call(this,typeof La!="undefined"?La:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"./show_no_webgl_msg":809,regl:526}],801:[function(h,N,H){var t=h("fast-isnumeric"),m=h("is-mobile");N.exports=function(g){var p;if(typeof(p=g&&g.hasOwnProperty("userAgent")?g.userAgent:function(){var a;return typeof navigator!="undefined"&&(a=navigator.userAgent),a&&a.headers&&typeof a.headers["user-agent"]=="string"&&(a=a.headers["user-agent"]),a}())!="string")return!0;var e=m({ua:{headers:{"user-agent":p}},tablet:!0,featureDetect:!1});if(!e){for(var f=p.split(" "),u=1;u<f.length;u++)if(f[u].indexOf("Safari")!==-1)for(var i=u-1;i>-1;i--){var s=f[i];if(s.substr(0,8)==="Version/"){var o=s.substr(8).split(".")[0];if(t(o)&&(o=+o),o>=13)return!0}}}return e}},{"fast-isnumeric":246,"is-mobile":445}],802:[function(h,N,H){N.exports=function(t,m){if(m instanceof RegExp){for(var g=m.toString(),p=0;p<t.length;p++)if(t[p]instanceof RegExp&&t[p].toString()===g)return t;t.push(m)}else!m&&m!==0||t.indexOf(m)!==-1||t.push(m);return t}},{}],803:[function(h,N,H){var t=h("../lib"),m=h("../plot_api/plot_config").dfltConfig,g={add:function(p,e,f,u,i){var s,o;p.undoQueue=p.undoQueue||{index:0,queue:[],sequence:!1},o=p.undoQueue.index,p.autoplay?p.undoQueue.inSequence||(p.autoplay=!1):(!p.undoQueue.sequence||p.undoQueue.beginSequence?(s={undo:{calls:[],args:[]},redo:{calls:[],args:[]}},p.undoQueue.queue.splice(o,p.undoQueue.queue.length-o,s),p.undoQueue.index+=1):s=p.undoQueue.queue[o-1],p.undoQueue.beginSequence=!1,s&&(s.undo.calls.unshift(e),s.undo.args.unshift(f),s.redo.calls.push(u),s.redo.args.push(i)),p.undoQueue.queue.length>m.queueLength&&(p.undoQueue.queue.shift(),p.undoQueue.index--))},startSequence:function(p){p.undoQueue=p.undoQueue||{index:0,queue:[],sequence:!1},p.undoQueue.sequence=!0,p.undoQueue.beginSequence=!0},stopSequence:function(p){p.undoQueue=p.undoQueue||{index:0,queue:[],sequence:!1},p.undoQueue.sequence=!1,p.undoQueue.beginSequence=!1},undo:function(p){var e,f;if(!(p.undoQueue===void 0||isNaN(p.undoQueue.index)||p.undoQueue.index<=0)){for(p.undoQueue.index--,e=p.undoQueue.queue[p.undoQueue.index],p.undoQueue.inSequence=!0,f=0;f<e.undo.calls.length;f++)g.plotDo(p,e.undo.calls[f],e.undo.args[f]);p.undoQueue.inSequence=!1,p.autoplay=!1}},redo:function(p){var e,f;if(!(p.undoQueue===void 0||isNaN(p.undoQueue.index)||p.undoQueue.index>=p.undoQueue.queue.length)){for(e=p.undoQueue.queue[p.undoQueue.index],p.undoQueue.inSequence=!0,f=0;f<e.redo.calls.length;f++)g.plotDo(p,e.redo.calls[f],e.redo.args[f]);p.undoQueue.inSequence=!1,p.autoplay=!1,p.undoQueue.index++}}};g.plotDo=function(p,e,f){p.autoplay=!0,f=function(u,i){for(var s,o=[],a=0;a<i.length;a++)s=i[a],o[a]=s===u?s:typeof s=="object"?Array.isArray(s)?t.extendDeep([],s):t.extendDeepAll({},s):s;return o}(p,f),e.apply(null,f)},N.exports=g},{"../lib":787,"../plot_api/plot_config":825}],804:[function(h,N,H){H.counter=function(t,m,g,p){var e=(m||"")+(g?"":"$"),f=p===!1?"":"^";return t==="xy"?new RegExp(f+"x([2-9]|[1-9][0-9]+)?y([2-9]|[1-9][0-9]+)?"+e):new RegExp(f+t+"([2-9]|[1-9][0-9]+)?"+e)}},{}],805:[function(h,N,H){var t=/^(.*)(\.[^\.\[\]]+|\[\d\])$/,m=/^[^\.\[\]]+$/;N.exports=function(g,p){for(;p;){var e=g.match(t);if(e)g=e[1];else{if(!g.match(m))throw new Error("bad relativeAttr call:"+[g,p]);g=""}if(p.charAt(0)!=="^")break;p=p.slice(1)}return g&&p.charAt(0)!=="["?g+"."+p:g+p}},{}],806:[function(h,N,H){var t=h("./array").isArrayOrTypedArray,m=h("./is_plain_object");N.exports=function g(p,e){for(var f in e){var u=e[f],i=p[f];if(i!==u)if(f.charAt(0)==="_"||typeof u=="function"){if(f in p)continue;p[f]=u}else if(t(u)&&t(i)&&m(u[0])){if(f==="customdata"||f==="ids")continue;for(var s=Math.min(u.length,i.length),o=0;o<s;o++)i[o]!==u[o]&&m(u[o])&&m(i[o])&&g(i[o],u[o])}else m(u)&&m(i)&&(g(i,u),Object.keys(i).length||delete p[f])}}},{"./array":769,"./is_plain_object":788}],807:[function(h,N,H){var t=h("fast-isnumeric"),m=h("./loggers"),g=h("./identity"),p=h("../constants/numerical").BADNUM;function e(s,o){return s<o}function f(s,o){return s<=o}function u(s,o){return s>o}function i(s,o){return s>=o}H.findBin=function(s,o,a){if(t(o.start))return a?Math.ceil((s-o.start)/o.size-1e-9)-1:Math.floor((s-o.start)/o.size+1e-9);var c,r,n=0,d=o.length,l=0,y=d>1?(o[d-1]-o[0])/(d-1):1;for(r=y>=0?a?e:f:a?i:u,s+=1e-9*y*(a?-1:1)*(y>=0?1:-1);n<d&&l++<100;)r(o[c=Math.floor((n+d)/2)],s)?n=c+1:d=c;return l>90&&m.log("Long binary search..."),n-1},H.sorterAsc=function(s,o){return s-o},H.sorterDes=function(s,o){return o-s},H.distinctVals=function(s){var o,a=s.slice();for(a.sort(H.sorterAsc),o=a.length-1;o>-1&&a[o]===p;o--);for(var c,r=a[o]-a[0]||1,n=r/(o||1)/1e4,d=[],l=0;l<=o;l++){var y=a[l],v=y-c;c===void 0?(d.push(y),c=y):v>n&&(r=Math.min(r,v),d.push(y),c=y)}return{vals:d,minDiff:r}},H.roundUp=function(s,o,a){for(var c,r=0,n=o.length-1,d=0,l=a?0:1,y=a?1:0,v=a?Math.ceil:Math.floor;r<n&&d++<100;)o[c=v((r+n)/2)]<=s?r=c+l:n=c-y;return o[r]},H.sort=function(s,o){for(var a=0,c=0,r=1;r<s.length;r++){var n=o(s[r],s[r-1]);if(n<0?a=1:n>0&&(c=1),a&&c)return s.sort(o)}return c?s:s.reverse()},H.findIndexOfMin=function(s,o){o=o||g;for(var a,c=1/0,r=0;r<s.length;r++){var n=o(s[r]);n<c&&(c=n,a=r)}return a}},{"../constants/numerical":763,"./identity":785,"./loggers":791,"fast-isnumeric":246}],808:[function(h,N,H){N.exports=function(t,m){(t.attr("class")||"").split(" ").forEach(function(g){g.indexOf("cursor-")===0&&t.classed(g,!1)}),m&&t.classed("cursor-"+m,!0)}},{}],809:[function(h,N,H){var t=h("../components/color"),m=function(){};N.exports=function(g){for(var p in g)typeof g[p]=="function"&&(g[p]=m);g.destroy=function(){g.container.parentNode.removeChild(g.container)};var e=document.createElement("div");e.className="no-webgl",e.style.cursor="pointer",e.style.fontSize="24px",e.style.color=t.defaults[0],e.style.position="absolute",e.style.left=e.style.top="0px",e.style.width=e.style.height="100%",e.style["background-color"]=t.lightLine,e.style["z-index"]=30;var f=document.createElement("p");return f.textContent="WebGL is not supported by your browser - visit https://get.webgl.org for more info",f.style.position="relative",f.style.top="50%",f.style.left="50%",f.style.height="30%",f.style.width="50%",f.style.margin="-15% 0 0 -25%",e.appendChild(f),g.container.appendChild(e),g.container.style.background="#FFFFFF",g.container.onclick=function(){window.open("https://get.webgl.org")},!1}},{"../components/color":650}],810:[function(h,N,H){N.exports=function(t){return Object.keys(t).sort()}},{}],811:[function(h,N,H){var t=h("fast-isnumeric"),m=h("./array").isArrayOrTypedArray;H.aggNums=function(g,p,e,f){var u,i;if((!f||f>e.length)&&(f=e.length),t(p)||(p=!1),m(e[0])){for(i=new Array(f),u=0;u<f;u++)i[u]=H.aggNums(g,p,e[u]);e=i}for(u=0;u<f;u++)t(p)?t(e[u])&&(p=g(+p,+e[u])):p=e[u];return p},H.len=function(g){return H.aggNums(function(p){return p+1},0,g)},H.mean=function(g,p){return p||(p=H.len(g)),H.aggNums(function(e,f){return e+f},0,g)/p},H.midRange=function(g){if(g!==void 0&&g.length!==0)return(H.aggNums(Math.max,null,g)+H.aggNums(Math.min,null,g))/2},H.variance=function(g,p,e){return p||(p=H.len(g)),t(e)||(e=H.mean(g,p)),H.aggNums(function(f,u){return f+Math.pow(u-e,2)},0,g)/p},H.stdev=function(g,p,e){return Math.sqrt(H.variance(g,p,e))},H.median=function(g){var p=g.slice().sort();return H.interp(p,.5)},H.interp=function(g,p){if(!t(p))throw"n should be a finite number";if((p=p*g.length-.5)<0)return g[0];if(p>g.length-1)return g[g.length-1];var e=p%1;return e*g[Math.ceil(p)]+(1-e)*g[Math.floor(p)]}},{"./array":769,"fast-isnumeric":246}],812:[function(h,N,H){var t=h("color-normalize");N.exports=function(m){return m?t(m):[0,0,0,1]}},{"color-normalize":131}],813:[function(h,N,H){var t=h("@plotly/d3"),m=h("../lib"),g=m.strTranslate,p=h("../constants/xmlns_namespaces"),e=h("../constants/alignment").LINE_SPACING;function f(P,O){return P.node().getBoundingClientRect()[O]}var u=/([^$]*)([$]+[^$]*[$]+)([^$]*)/;H.convertToTspans=function(P,O,F){var j=P.text(),W=!P.attr("data-notex")&&typeof MathJax!="undefined"&&j.match(u),Z=t.select(P.node().parentNode);if(!Z.empty()){var Q=P.attr("class")?P.attr("class").split(" ")[0]:"text";return Q+="-math",Z.selectAll("svg."+Q).remove(),Z.selectAll("g."+Q+"-group").remove(),P.style("display",null).attr({"data-unformatted":j,"data-math":"N"}),W?(O&&O._promises||[]).push(new Promise(function(G){P.style("display","none");var Y=parseInt(P.node().style.fontSize,10),K={fontSize:Y};(function(D,B,q){var ee,J,$,te;MathJax.Hub.Queue(function(){return J=m.extendDeepAll({},MathJax.Hub.config),$=MathJax.Hub.processSectionDelay,MathJax.Hub.processSectionDelay!==void 0&&(MathJax.Hub.processSectionDelay=0),MathJax.Hub.Config({messageStyle:"none",tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]]},displayAlign:"left"})},function(){if((ee=MathJax.Hub.config.menuSettings.renderer)!=="SVG")return MathJax.Hub.setRenderer("SVG")},function(){var ie="math-output-"+m.randstr({},64);return te=t.select("body").append("div").attr({id:ie}).style({visibility:"hidden",position:"absolute"}).style({"font-size":B.fontSize+"px"}).text(D.replace(i,"\\lt ").replace(s,"\\gt ")),MathJax.Hub.Typeset(te.node())},function(){var ie=t.select("body").select("#MathJax_SVG_glyphs");if(te.select(".MathJax_SVG").empty()||!te.select("svg").node())m.log("There was an error in the tex syntax.",D),q();else{var ae=te.select("svg").node().getBoundingClientRect();q(te.select(".MathJax_SVG"),ie,ae)}if(te.remove(),ee!=="SVG")return MathJax.Hub.setRenderer(ee)},function(){return $!==void 0&&(MathJax.Hub.processSectionDelay=$),MathJax.Hub.Config(J)})})(W[2],K,function(D,B,q){Z.selectAll("svg."+Q).remove(),Z.selectAll("g."+Q+"-group").remove();var ee=D&&D.select("svg");if(!ee||!ee.node())return X(),void G();var J=Z.append("g").classed(Q+"-group",!0).attr({"pointer-events":"none","data-unformatted":j,"data-math":"Y"});J.node().appendChild(ee.node()),B&&B.node()&&ee.node().insertBefore(B.node().cloneNode(!0),ee.node().firstChild),ee.attr({class:Q,height:q.height,preserveAspectRatio:"xMinYMin meet"}).style({overflow:"visible","pointer-events":"none"});var $=P.node().style.fill||"black",te=ee.select("g");te.attr({fill:$,stroke:$});var ie=f(te,"width"),ae=f(te,"height"),he=+P.attr("x")-ie*{start:0,middle:.5,end:1}[P.attr("text-anchor")||"start"],se=-(Y||f(P,"height"))/4;Q[0]==="y"?(J.attr({transform:"rotate("+[-90,+P.attr("x"),+P.attr("y")]+")"+g(-ie/2,se-ae/2)}),ee.attr({x:+P.attr("x"),y:+P.attr("y")})):Q[0]==="l"?ee.attr({x:P.attr("x"),y:se-ae/2}):Q[0]==="a"&&Q.indexOf("atitle")!==0?ee.attr({x:0,y:se}):ee.attr({x:he,y:+P.attr("y")+se-ae/2}),F&&F.call(P,J),G(J)})})):X(),P}function X(){Z.empty()||(Q=P.attr("class")+"-math",Z.select("svg."+Q).remove()),P.text("").style("white-space","pre"),function(G,Y){Y=Y.replace(n," ");var K,D=!1,B=[],q=-1;function ee(){q++;var ue=document.createElementNS(p.svg,"tspan");t.select(ue).attr({class:"line",dy:q*e+"em"}),G.appendChild(ue),K=ue;var me=B;if(B=[{node:ue}],me.length>1)for(var we=1;we<me.length;we++)J(me[we])}function J(ue){var me,we=ue.type,Me={};if(we==="a"){me="a";var Se=ue.target,De=ue.href,Fe=ue.popup;De&&(Me={"xlink:xlink:show":Se==="_blank"||Se.charAt(0)!=="_"?"new":"replace",target:Se,"xlink:xlink:href":De},Fe&&(Me.onclick='window.open(this.href.baseVal,this.target.baseVal,"'+Fe+'");return false;'))}else me="tspan";ue.style&&(Me.style=ue.style);var Ye=document.createElementNS(p.svg,me);if(we==="sup"||we==="sub"){$(K,"\u200B"),K.appendChild(Ye);var et=document.createElementNS(p.svg,"tspan");$(et,"\u200B"),t.select(et).attr("dy",c[we]),Me.dy=a[we],K.appendChild(Ye),K.appendChild(et)}else K.appendChild(Ye);t.select(Ye).attr(Me),K=ue.node=Ye,B.push(ue)}function $(ue,me){ue.appendChild(document.createTextNode(me))}function te(ue){if(B.length!==1){var me=B.pop();ue!==me.type&&m.log("Start tag <"+me.type+"> doesnt match end tag <"+ue+">. Pretending it did match.",Y),K=B[B.length-1].node}else m.log("Ignoring unexpected end tag </"+ue+">.",Y)}y.test(Y)?ee():(K=G,B=[{node:G}]);for(var ie=Y.split(d),ae=0;ae<ie.length;ae++){var he=ie[ae],se=he.match(l),de=se&&se[2].toLowerCase(),ce=o[de];if(de==="br")ee();else if(ce===void 0)$(K,k(he));else if(se[1])te(de);else{var ve=se[4],ke={type:de},Ee=A(ve,v);if(Ee?(Ee=Ee.replace(S,"$1 fill:"),ce&&(Ee+=";"+ce)):ce&&(Ee=ce),Ee&&(ke.style=Ee),de==="a"){D=!0;var be=A(ve,_);if(be){var xe=C(be);xe&&(ke.href=xe,ke.target=A(ve,x)||"_blank",ke.popup=A(ve,T))}}J(ke)}}return D}(P.node(),j)&&P.style("pointer-events","all"),H.positionText(P),F&&F.call(P)}};var i=/(<|&lt;|&#60;)/g,s=/(>|&gt;|&#62;)/g,o={sup:"font-size:70%",sub:"font-size:70%",b:"font-weight:bold",i:"font-style:italic",a:"cursor:pointer",span:"",em:"font-style:italic;font-weight:bold"},a={sub:"0.3em",sup:"-0.6em"},c={sub:"-0.21em",sup:"0.42em"},r=["http:","https:","mailto:","",void 0,":"],n=H.NEWLINES=/(\r\n?|\n)/g,d=/(<[^<>]*>)/,l=/<(\/?)([^ >]*)(\s+(.*))?>/i,y=/<br(\s+.*)?>/i;H.BR_TAG_ALL=/<br(\s+.*)?>/gi;var v=/(^|[\s"'])style\s*=\s*("([^"]*);?"|'([^']*);?')/i,_=/(^|[\s"'])href\s*=\s*("([^"]*)"|'([^']*)')/i,x=/(^|[\s"'])target\s*=\s*("([^"\s]*)"|'([^'\s]*)')/i,T=/(^|[\s"'])popup\s*=\s*("([\w=,]*)"|'([\w=,]*)')/i;function A(P,O){if(!P)return null;var F=P.match(O),j=F&&(F[3]||F[4]);return j&&k(j)}var S=/(^|;)\s*color:/;H.plainText=function(P,O){for(var F=(O=O||{}).len!==void 0&&O.len!==-1?O.len:1/0,j=O.allowedTags!==void 0?O.allowedTags:["br"],W="...".length,Z=P.split(d),Q=[],X="",G=0,Y=0;Y<Z.length;Y++){var K=Z[Y],D=K.match(l),B=D&&D[2].toLowerCase();if(B)j.indexOf(B)!==-1&&(Q.push(K),X=B);else{var q=K.length;if(G+q<F)Q.push(K),G+=q;else if(G<F){var ee=F-G;X&&(X!=="br"||ee<=W||q<=W)&&Q.pop(),F>W?Q.push(K.substr(0,ee-W)+"..."):Q.push(K.substr(0,ee));break}X=""}}return Q.join("")};var w={mu:"\u03BC",amp:"&",lt:"<",gt:">",nbsp:"\xA0",times:"\xD7",plusmn:"\xB1",deg:"\xB0"},L=/&(#\d+|#x[\da-fA-F]+|[a-z]+);/g;function k(P){return P.replace(L,function(O,F){return(F.charAt(0)==="#"?function(j){if(!(j>1114111)){var W=String.fromCodePoint;if(W)return W(j);var Z=String.fromCharCode;return j<=65535?Z(j):Z(55232+(j>>10),j%1024+56320)}}(F.charAt(1)==="x"?parseInt(F.substr(2),16):parseInt(F.substr(1),10)):w[F])||O})}function C(P){var O=encodeURI(decodeURI(P)),F=document.createElement("a"),j=document.createElement("a");F.href=P,j.href=O;var W=F.protocol,Z=j.protocol;return r.indexOf(W)!==-1&&r.indexOf(Z)!==-1?O:""}function M(P,O,F){var j,W,Z,Q=F.horizontalAlign,X=F.verticalAlign||"top",G=P.node().getBoundingClientRect(),Y=O.node().getBoundingClientRect();return W=X==="bottom"?function(){return G.bottom-j.height}:X==="middle"?function(){return G.top+(G.height-j.height)/2}:function(){return G.top},Z=Q==="right"?function(){return G.right-j.width}:Q==="center"?function(){return G.left+(G.width-j.width)/2}:function(){return G.left},function(){j=this.node().getBoundingClientRect();var K=Z()-Y.left,D=W()-Y.top,B=F.gd||{};if(F.gd){B._fullLayout._calcInverseTransform(B);var q=m.apply3DTransform(B._fullLayout._invTransform)(K,D);K=q[0],D=q[1]}return this.style({top:D+"px",left:K+"px","z-index":1e3}),this}}H.convertEntities=k,H.sanitizeHTML=function(P){P=P.replace(n," ");for(var O=document.createElement("p"),F=O,j=[],W=P.split(d),Z=0;Z<W.length;Z++){var Q=W[Z],X=Q.match(l),G=X&&X[2].toLowerCase();if(G in o)if(X[1])j.length&&(F=j.pop());else{var Y=X[4],K=A(Y,v),D=K?{style:K}:{};if(G==="a"){var B=A(Y,_);if(B){var q=C(B);if(q){D.href=q;var ee=A(Y,x);ee&&(D.target=ee)}}}var J=document.createElement(G);F.appendChild(J),t.select(J).attr(D),F=J,j.push(J)}else F.appendChild(document.createTextNode(k(Q)))}return O.innerHTML},H.lineCount=function(P){return P.selectAll("tspan.line").size()||1},H.positionText=function(P,O,F){return P.each(function(){var j=t.select(this);function W(X,G){return G===void 0?(G=j.attr(X))===null&&(j.attr(X,0),G=0):j.attr(X,G),G}var Z=W("x",O),Q=W("y",F);this.nodeName==="text"&&j.selectAll("tspan.line").attr({x:Z,y:Q})})},H.makeTextShadow=function(P){var O="1px ",F="1px ",j="1px ";return O+F+j+P+", -"+O+"-"+F+j+P+", "+O+"-"+F+j+P+", -"+O+F+j+P},H.makeEditable=function(P,O){var F=O.gd,j=O.delegate,W=t.dispatch("edit","input","cancel"),Z=j||P;if(P.style({"pointer-events":j?"none":"all"}),P.size()!==1)throw new Error("boo");function Q(){(function(){var K=t.select(F).select(".svg-container"),D=K.append("div"),B=P.node().style,q=parseFloat(B.fontSize||12),ee=O.text;ee===void 0&&(ee=P.attr("data-unformatted")),D.classed("plugin-editable editable",!0).style({position:"absolute","font-family":B.fontFamily||"Arial","font-size":q,color:O.fill||B.fill||"black",opacity:1,"background-color":O.background||"transparent",outline:"#ffffff33 1px solid",margin:[-q/8+1,0,0,-1].join("px ")+"px",padding:"0","box-sizing":"border-box"}).attr({contenteditable:!0}).text(ee).call(M(P,K,O)).on("blur",function(){F._editing=!1,P.text(this.textContent).style({opacity:1});var J,$=t.select(this).attr("class");(J=$?"."+$.split(" ")[0]+"-math-group":"[class*=-math-group]")&&t.select(P.node().parentNode).select(J).style({opacity:0});var te=this.textContent;t.select(this).transition().duration(0).remove(),t.select(document).on("mouseup",null),W.edit.call(P,te)}).on("focus",function(){var J=this;F._editing=!0,t.select(document).on("mouseup",function(){if(t.event.target===J)return!1;document.activeElement===D.node()&&D.node().blur()})}).on("keyup",function(){t.event.which===27?(F._editing=!1,P.style({opacity:1}),t.select(this).style({opacity:0}).on("blur",function(){return!1}).transition().remove(),W.cancel.call(P,this.textContent)):(W.input.call(P,this.textContent),t.select(this).call(M(P,K,O)))}).on("keydown",function(){t.event.which===13&&this.blur()}).call(X)})(),P.style({opacity:0});var G,Y=Z.attr("class");(G=Y?"."+Y.split(" ")[0]+"-math-group":"[class*=-math-group]")&&t.select(P.node().parentNode).select(G).style({opacity:0})}function X(G){var Y=G.node(),K=document.createRange();K.selectNodeContents(Y);var D=window.getSelection();D.removeAllRanges(),D.addRange(K),Y.focus()}return O.immediate?Q():Z.on("click",Q),t.rebind(P,W,"on")}},{"../constants/alignment":755,"../constants/xmlns_namespaces":764,"../lib":787,"@plotly/d3":58}],814:[function(h,N,H){var t={};function m(g){g&&g.timer!==null&&(clearTimeout(g.timer),g.timer=null)}H.throttle=function(g,p,e){var f=t[g],u=Date.now();if(!f){for(var i in t)t[i].ts<u-6e4&&delete t[i];f=t[g]={ts:0,timer:null}}function s(){e(),f.ts=Date.now(),f.onDone&&(f.onDone(),f.onDone=null)}m(f),u>f.ts+p?s():f.timer=setTimeout(function(){s(),f.timer=null},p)},H.done=function(g){var p=t[g];return p&&p.timer?new Promise(function(e){var f=p.onDone;p.onDone=function(){f&&f(),e(),p.onDone=null}}):Promise.resolve()},H.clear=function(g){if(g)m(t[g]),delete t[g];else for(var p in t)H.clear(p)}},{}],815:[function(h,N,H){var t=h("fast-isnumeric");N.exports=function(m,g){if(m>0)return Math.log(m)/Math.LN10;var p=Math.log(Math.min(g[0],g[1]))/Math.LN10;return t(p)||(p=Math.log(Math.max(g[0],g[1]))/Math.LN10-6),p}},{"fast-isnumeric":246}],816:[function(h,N,H){var t=N.exports={},m=h("../plots/geo/constants").locationmodeToLayer,g=h("topojson-client").feature;t.getTopojsonName=function(p){return[p.scope.replace(/ /g,"-"),"_",p.resolution.toString(),"m"].join("")},t.getTopojsonPath=function(p,e){return p+e+".json"},t.getTopojsonFeatures=function(p,e){var f=m[p.locationmode],u=e.objects[f];return g(e,u).features}},{"../plots/geo/constants":869,"topojson-client":586}],817:[function(h,N,H){N.exports={moduleType:"locale",name:"en-US",dictionary:{"Click to enter Colorscale title":"Click to enter Colorscale title"},format:{date:"%m/%d/%Y"}}},{}],818:[function(h,N,H){N.exports={moduleType:"locale",name:"en",dictionary:{"Click to enter Colorscale title":"Click to enter Colourscale title"},format:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],periods:["AM","PM"],dateTime:"%a %b %e %X %Y",date:"%d/%m/%Y",time:"%H:%M:%S",decimal:".",thousands:",",grouping:[3],currency:["$",""],year:"%Y",month:"%b %Y",dayMonth:"%b %-d",dayMonthYear:"%b %-d, %Y"}}},{}],819:[function(h,N,H){var t=h("../registry");N.exports=function(m){for(var g,p,e=t.layoutArrayContainers,f=t.layoutArrayRegexes,u=m.split("[")[0],i=0;i<f.length;i++)if((p=m.match(f[i]))&&p.index===0){g=p[0];break}if(g||(g=e[e.indexOf(u)]),!g)return!1;var s=m.substr(g.length);return s?!!(p=s.match(/^\[(0|[1-9][0-9]*)\](\.(.+))?$/))&&{array:g,index:Number(p[1]),property:p[3]||""}:{array:g,index:"",property:""}}},{"../registry":915}],820:[function(h,N,H){var t=h("../lib"),m=t.extendFlat,g=t.isPlainObject,p={valType:"flaglist",extras:["none"],flags:["calc","clearAxisTypes","plot","style","markerSize","colorbars"]},e={valType:"flaglist",extras:["none"],flags:["calc","plot","legend","ticks","axrange","layoutstyle","modebar","camera","arraydraw","colorbars"]},f=p.flags.slice().concat(["fullReplot"]),u=e.flags.slice().concat("layoutReplot");function i(a){for(var c={},r=0;r<a.length;r++)c[a[r]]=!1;return c}function s(a,c,r){var n=m({},a);for(var d in n){var l=n[d];g(l)&&(n[d]=o(l,c,r,d))}return r==="from-root"&&(n.editType=c),n}function o(a,c,r,n){if(a.valType){var d=m({},a);if(d.editType=c,Array.isArray(a.items)){d.items=new Array(a.items.length);for(var l=0;l<a.items.length;l++)d.items[l]=o(a.items[l],c)}return d}return s(a,c,n.charAt(0)==="_"?"nested":"from-root")}N.exports={traces:p,layout:e,traceFlags:function(){return i(f)},layoutFlags:function(){return i(u)},update:function(a,c){var r=c.editType;if(r&&r!=="none")for(var n=r.split("+"),d=0;d<n.length;d++)a[n[d]]=!0},overrideAll:s}},{"../lib":787}],821:[function(h,N,H){var t=h("fast-isnumeric"),m=h("gl-mat4/fromQuat"),g=h("../registry"),p=h("../lib"),e=h("../plots/plots"),f=h("../plots/cartesian/axis_ids"),u=h("../components/color"),i=f.cleanId,s=f.getFromTrace,o=g.traceIs;function a(x,T){var A=x[T],S=T.charAt(0);A&&A!=="paper"&&(x[T]=i(A,S,!0))}function c(x){function T(A,S){var w=x[A],L=x.title&&x.title[S];w&&!L&&(x.title||(x.title={}),x.title[S]=x[A],delete x[A])}x&&(typeof x.title!="string"&&typeof x.title!="number"||(x.title={text:x.title}),T("titlefont","font"),T("titleposition","position"),T("titleside","side"),T("titleoffset","offset"))}function r(x){if(!p.isPlainObject(x))return!1;var T=x.name;return delete x.name,delete x.showlegend,(typeof T=="string"||typeof T=="number")&&String(T)}function n(x,T,A,S){if(A&&!S)return x;if(S&&!A||!x.trim())return T;if(!T.trim())return x;var w,L=Math.min(x.length,T.length);for(w=0;w<L&&x.charAt(w)===T.charAt(w);w++);return x.substr(0,w).trim()}function d(x){var T="middle",A="center";return typeof x=="string"&&(x.indexOf("top")!==-1?T="top":x.indexOf("bottom")!==-1&&(T="bottom"),x.indexOf("left")!==-1?A="left":x.indexOf("right")!==-1&&(A="right")),T+" "+A}function l(x,T){return T in x&&typeof x[T]=="object"&&Object.keys(x[T]).length===0}H.clearPromiseQueue=function(x){Array.isArray(x._promises)&&x._promises.length>0&&p.log("Clearing previous rejected promises from queue."),x._promises=[]},H.cleanLayout=function(x){var T,A;x||(x={}),x.xaxis1&&(x.xaxis||(x.xaxis=x.xaxis1),delete x.xaxis1),x.yaxis1&&(x.yaxis||(x.yaxis=x.yaxis1),delete x.yaxis1),x.scene1&&(x.scene||(x.scene=x.scene1),delete x.scene1);var S=(e.subplotsRegistry.cartesian||{}).attrRegex,w=(e.subplotsRegistry.polar||{}).attrRegex,L=(e.subplotsRegistry.ternary||{}).attrRegex,k=(e.subplotsRegistry.gl3d||{}).attrRegex,C=Object.keys(x);for(T=0;T<C.length;T++){var M=C[T];if(S&&S.test(M)){var P=x[M];P.anchor&&P.anchor!=="free"&&(P.anchor=i(P.anchor)),P.overlaying&&(P.overlaying=i(P.overlaying)),P.type||(P.isdate?P.type="date":P.islog?P.type="log":P.isdate===!1&&P.islog===!1&&(P.type="linear")),P.autorange!=="withzero"&&P.autorange!=="tozero"||(P.autorange=!0,P.rangemode="tozero"),delete P.islog,delete P.isdate,delete P.categories,l(P,"domain")&&delete P.domain,P.autotick!==void 0&&(P.tickmode===void 0&&(P.tickmode=P.autotick?"auto":"linear"),delete P.autotick),c(P)}else if(w&&w.test(M))c(x[M].radialaxis);else if(L&&L.test(M)){var O=x[M];c(O.aaxis),c(O.baxis),c(O.caxis)}else if(k&&k.test(M)){var F=x[M],j=F.cameraposition;if(Array.isArray(j)&&j[0].length===4){var W=j[0],Z=j[1],Q=j[2],X=m([],W),G=[];for(A=0;A<3;++A)G[A]=Z[A]+Q*X[2+4*A];F.camera={eye:{x:G[0],y:G[1],z:G[2]},center:{x:Z[0],y:Z[1],z:Z[2]},up:{x:0,y:0,z:1}},delete F.cameraposition}c(F.xaxis),c(F.yaxis),c(F.zaxis)}}var Y=Array.isArray(x.annotations)?x.annotations.length:0;for(T=0;T<Y;T++){var K=x.annotations[T];p.isPlainObject(K)&&(K.ref&&(K.ref==="paper"?(K.xref="paper",K.yref="paper"):K.ref==="data"&&(K.xref="x",K.yref="y"),delete K.ref),a(K,"xref"),a(K,"yref"))}var D=Array.isArray(x.shapes)?x.shapes.length:0;for(T=0;T<D;T++){var B=x.shapes[T];p.isPlainObject(B)&&(a(B,"xref"),a(B,"yref"))}var q=Array.isArray(x.images)?x.images.length:0;for(T=0;T<q;T++){var ee=x.images[T];p.isPlainObject(ee)&&(a(ee,"xref"),a(ee,"yref"))}var J=x.legend;return J&&(J.x>3?(J.x=1.02,J.xanchor="left"):J.x<-2&&(J.x=-.02,J.xanchor="right"),J.y>3?(J.y=1.02,J.yanchor="bottom"):J.y<-2&&(J.y=-.02,J.yanchor="top")),c(x),x.dragmode==="rotate"&&(x.dragmode="orbit"),u.clean(x),x.template&&x.template.layout&&H.cleanLayout(x.template.layout),x},H.cleanData=function(x){for(var T=0;T<x.length;T++){var A,S=x[T];if(S.type==="histogramy"&&"xbins"in S&&!("ybins"in S)&&(S.ybins=S.xbins,delete S.xbins),S.error_y&&"opacity"in S.error_y){var w=u.defaults,L=S.error_y.color||(o(S,"bar")?u.defaultLine:w[T%w.length]);S.error_y.color=u.addOpacity(u.rgb(L),u.opacity(L)*S.error_y.opacity),delete S.error_y.opacity}if("bardir"in S&&(S.bardir!=="h"||!o(S,"bar")&&S.type.substr(0,9)!=="histogram"||(S.orientation="h",H.swapXYData(S)),delete S.bardir),S.type==="histogramy"&&H.swapXYData(S),S.type!=="histogramx"&&S.type!=="histogramy"||(S.type="histogram"),"scl"in S&&!("colorscale"in S)&&(S.colorscale=S.scl,delete S.scl),"reversescl"in S&&!("reversescale"in S)&&(S.reversescale=S.reversescl,delete S.reversescl),S.xaxis&&(S.xaxis=i(S.xaxis,"x")),S.yaxis&&(S.yaxis=i(S.yaxis,"y")),o(S,"gl3d")&&S.scene&&(S.scene=e.subplotsRegistry.gl3d.cleanId(S.scene)),!o(S,"pie-like")&&!o(S,"bar-like"))if(Array.isArray(S.textposition))for(A=0;A<S.textposition.length;A++)S.textposition[A]=d(S.textposition[A]);else S.textposition&&(S.textposition=d(S.textposition));var k=g.getModule(S);if(k&&k.colorbar){var C=k.colorbar.container,M=C?S[C]:S;M&&M.colorscale&&(M.colorscale==="YIGnBu"&&(M.colorscale="YlGnBu"),M.colorscale==="YIOrRd"&&(M.colorscale="YlOrRd"))}if(S.type==="surface"&&p.isPlainObject(S.contours)){var P=["x","y","z"];for(A=0;A<P.length;A++){var O=S.contours[P[A]];p.isPlainObject(O)&&(O.highlightColor&&(O.highlightcolor=O.highlightColor,delete O.highlightColor),O.highlightWidth&&(O.highlightwidth=O.highlightWidth,delete O.highlightWidth))}}if(S.type==="candlestick"||S.type==="ohlc"){var F=(S.increasing||{}).showlegend!==!1,j=(S.decreasing||{}).showlegend!==!1,W=r(S.increasing),Z=r(S.decreasing);if(W!==!1&&Z!==!1){var Q=n(W,Z,F,j);Q&&(S.name=Q)}else!W&&!Z||S.name||(S.name=W||Z)}if(Array.isArray(S.transforms)){var X=S.transforms;for(A=0;A<X.length;A++){var G=X[A];if(p.isPlainObject(G))switch(G.type){case"filter":G.filtersrc&&(G.target=G.filtersrc,delete G.filtersrc),G.calendar&&(G.valuecalendar||(G.valuecalendar=G.calendar),delete G.calendar);break;case"groupby":if(G.styles=G.styles||G.style,G.styles&&!Array.isArray(G.styles)){var Y=G.styles,K=Object.keys(Y);G.styles=[];for(var D=0;D<K.length;D++)G.styles.push({target:K[D],value:Y[K[D]]})}}}}l(S,"line")&&delete S.line,"marker"in S&&(l(S.marker,"line")&&delete S.marker.line,l(S,"marker")&&delete S.marker),u.clean(S),S.autobinx&&(delete S.autobinx,delete S.xbins),S.autobiny&&(delete S.autobiny,delete S.ybins),c(S),S.colorbar&&c(S.colorbar),S.marker&&S.marker.colorbar&&c(S.marker.colorbar),S.line&&S.line.colorbar&&c(S.line.colorbar),S.aaxis&&c(S.aaxis),S.baxis&&c(S.baxis)}},H.swapXYData=function(x){var T;if(p.swapAttrs(x,["?","?0","d?","?bins","nbins?","autobin?","?src","error_?"]),Array.isArray(x.z)&&Array.isArray(x.z[0])&&(x.transpose?delete x.transpose:x.transpose=!0),x.error_x&&x.error_y){var A=x.error_y,S="copy_ystyle"in A?A.copy_ystyle:!(A.color||A.thickness||A.width);p.swapAttrs(x,["error_?.copy_ystyle"]),S&&p.swapAttrs(x,["error_?.color","error_?.thickness","error_?.width"])}if(typeof x.hoverinfo=="string"){var w=x.hoverinfo.split("+");for(T=0;T<w.length;T++)w[T]==="x"?w[T]="y":w[T]==="y"&&(w[T]="x");x.hoverinfo=w.join("+")}},H.coerceTraceIndices=function(x,T){if(t(T))return[T];if(!Array.isArray(T)||!T.length)return x.data.map(function(w,L){return L});if(Array.isArray(T)){for(var A=[],S=0;S<T.length;S++)p.isIndex(T[S],x.data.length)?A.push(T[S]):p.warn("trace index (",T[S],") is not a number or is out of bounds");return A}return T},H.manageArrayContainers=function(x,T,A){var S=x.obj,w=x.parts,L=w.length,k=w[L-1],C=t(k);if(C&&T===null){var M=w.slice(0,L-1).join(".");p.nestedProperty(S,M).get().splice(k,1)}else C&&x.get()===void 0&&x.get()===void 0&&(A[x.astr]=null),x.set(T)};var y=/(\.[^\[\]\.]+|\[[^\[\]\.]+\])$/;function v(x){var T=x.search(y);if(T>0)return x.substr(0,T)}H.hasParent=function(x,T){for(var A=v(T);A;){if(A in x)return!0;A=v(A)}return!1};var _=["x","y","z"];H.clearAxisTypes=function(x,T,A){for(var S=0;S<T.length;S++)for(var w=x._fullData[S],L=0;L<3;L++){var k=s(x,w,_[L]);if(k&&k.type!=="log"){var C=k._name,M=k._id.substr(1);if(M.substr(0,5)==="scene"){if(A[M]!==void 0)continue;C=M+"."+C}var P=C+".type";A[C]===void 0&&A[P]===void 0&&p.nestedProperty(x.layout,P).set(null)}}}},{"../components/color":650,"../lib":787,"../plots/cartesian/axis_ids":842,"../plots/plots":901,"../registry":915,"fast-isnumeric":246,"gl-mat4/fromQuat":282}],822:[function(h,N,H){var t=h("./plot_api");H._doPlot=t._doPlot,H.newPlot=t.newPlot,H.restyle=t.restyle,H.relayout=t.relayout,H.redraw=t.redraw,H.update=t.update,H._guiRestyle=t._guiRestyle,H._guiRelayout=t._guiRelayout,H._guiUpdate=t._guiUpdate,H._storeDirectGUIEdit=t._storeDirectGUIEdit,H.react=t.react,H.extendTraces=t.extendTraces,H.prependTraces=t.prependTraces,H.addTraces=t.addTraces,H.deleteTraces=t.deleteTraces,H.moveTraces=t.moveTraces,H.purge=t.purge,H.addFrames=t.addFrames,H.deleteFrames=t.deleteFrames,H.animate=t.animate,H.setPlotConfig=t.setPlotConfig,H.toImage=h("./to_image"),H.validate=h("./validate"),H.downloadImage=h("../snapshot/download");var m=h("./template_api");H.makeTemplate=m.makeTemplate,H.validateTemplate=m.validateTemplate},{"../snapshot/download":917,"./plot_api":824,"./template_api":829,"./to_image":830,"./validate":831}],823:[function(h,N,H){var t=h("../lib/is_plain_object"),m=h("../lib/noop"),g=h("../lib/loggers"),p=h("../lib/search").sorterAsc,e=h("../registry");H.containerArrayMatch=h("./container_array_match");var f=H.isAddVal=function(i){return i==="add"||t(i)},u=H.isRemoveVal=function(i){return i===null||i==="remove"};H.applyContainerArrayChanges=function(i,s,o,a,c){var r=s.astr,n=e.getComponentMethod(r,"supplyLayoutDefaults"),d=e.getComponentMethod(r,"draw"),l=e.getComponentMethod(r,"drawOne"),y=a.replot||a.recalc||n===m||d===m,v=i.layout,_=i._fullLayout;if(o[""]){Object.keys(o).length>1&&g.warn("Full array edits are incompatible with other edits",r);var x=o[""][""];if(u(x))s.set(null);else{if(!Array.isArray(x))return g.warn("Unrecognized full array edit value",r,x),!0;s.set(x)}return!y&&(n(v,_),d(i),!0)}var T,A,S,w,L,k,C,M,P=Object.keys(o).map(Number).sort(p),O=s.get(),F=O||[],j=c(_,r).get(),W=[],Z=-1,Q=F.length;for(T=0;T<P.length;T++)if(w=o[S=P[T]],L=Object.keys(w),k=w[""],C=f(k),S<0||S>F.length-(C?0:1))g.warn("index out of range",r,S);else if(k!==void 0)L.length>1&&g.warn("Insertion & removal are incompatible with edits to the same index.",r,S),u(k)?W.push(S):C?(k==="add"&&(k={}),F.splice(S,0,k),j&&j.splice(S,0,{})):g.warn("Unrecognized full object edit value",r,S,k),Z===-1&&(Z=S);else for(A=0;A<L.length;A++)M=r+"["+S+"].",c(F[S],L[A],M).set(w[L[A]]);for(T=W.length-1;T>=0;T--)F.splice(W[T],1),j&&j.splice(W[T],1);if(F.length?O||s.set(F):s.set(null),y)return!1;if(n(v,_),l!==m){var X;if(Z===-1)X=P;else{for(Q=Math.max(F.length,Q),X=[],T=0;T<P.length&&!((S=P[T])>=Z);T++)X.push(S);for(T=Z;T<Q;T++)X.push(T)}for(T=0;T<X.length;T++)l(i,X[T])}else d(i);return!0}},{"../lib/is_plain_object":788,"../lib/loggers":791,"../lib/noop":796,"../lib/search":807,"../registry":915,"./container_array_match":819}],824:[function(h,N,H){var t=h("@plotly/d3"),m=h("fast-isnumeric"),g=h("has-hover"),p=h("../lib"),e=p.nestedProperty,f=h("../lib/events"),u=h("../lib/queue"),i=h("../registry"),s=h("./plot_schema"),o=h("../plots/plots"),a=h("../plots/cartesian/axes"),c=h("../components/drawing"),r=h("../components/color"),n=h("../plots/cartesian/graph_interact").initInteractions,d=h("../constants/xmlns_namespaces"),l=h("../plots/cartesian/select").clearSelect,y=h("./plot_config").dfltConfig,v=h("./manage_arrays"),_=h("./helpers"),x=h("./subroutines"),T=h("./edit_types"),A=h("../plots/cartesian/constants").AX_NAME_PATTERN,S=0;function w(ue){var me=ue._fullLayout;me._redrawFromAutoMarginCount?me._redrawFromAutoMarginCount--:ue.emit("plotly_afterplot")}function L(ue,me){try{ue._fullLayout._paper.style("background",me)}catch(we){p.error(we)}}function k(ue,me){L(ue,r.combine(me,"white"))}function C(ue,me){if(!ue._context){ue._context=p.extendDeep({},y);var we=t.select("base");ue._context._baseUrl=we.size()&&we.attr("href")?window.location.href.split("#")[0]:""}var Me,Se,De,Fe=ue._context;if(me){for(Se=Object.keys(me),Me=0;Me<Se.length;Me++)(De=Se[Me])!=="editable"&&De!=="edits"&&De in Fe&&(De==="setBackground"&&me[De]==="opaque"?Fe[De]=k:Fe[De]=me[De]);me.plot3dPixelRatio&&!Fe.plotGlPixelRatio&&(Fe.plotGlPixelRatio=Fe.plot3dPixelRatio);var Ye=me.editable;if(Ye!==void 0)for(Fe.editable=Ye,Se=Object.keys(Fe.edits),Me=0;Me<Se.length;Me++)Fe.edits[Se[Me]]=Ye;if(me.edits)for(Se=Object.keys(me.edits),Me=0;Me<Se.length;Me++)(De=Se[Me])in Fe.edits&&(Fe.edits[De]=me.edits[De]);Fe._exportedPlot=me._exportedPlot}Fe.staticPlot&&(Fe.editable=!1,Fe.edits={},Fe.autosizable=!1,Fe.scrollZoom=!1,Fe.doubleClick=!1,Fe.showTips=!1,Fe.showLink=!1,Fe.displayModeBar=!1),Fe.displayModeBar!=="hover"||g||(Fe.displayModeBar=!0),Fe.setBackground!=="transparent"&&typeof Fe.setBackground=="function"||(Fe.setBackground=L),Fe._hasZeroHeight=Fe._hasZeroHeight||ue.clientHeight===0,Fe._hasZeroWidth=Fe._hasZeroWidth||ue.clientWidth===0;var et=Fe.scrollZoom,Oe=Fe._scrollZoom={};if(et===!0)Oe.cartesian=1,Oe.gl3d=1,Oe.geo=1,Oe.mapbox=1;else if(typeof et=="string"){var je=et.split("+");for(Me=0;Me<je.length;Me++)Oe[je[Me]]=1}else et!==!1&&(Oe.gl3d=1,Oe.geo=1,Oe.mapbox=1)}function M(ue,me){var we,Me,Se=me+1,De=[];for(we=0;we<ue.length;we++)(Me=ue[we])<0?De.push(Se+Me):De.push(Me);return De}function P(ue,me,we){var Me,Se;for(Me=0;Me<me.length;Me++){if((Se=me[Me])!==parseInt(Se,10))throw new Error("all values in "+we+" must be integers");if(Se>=ue.data.length||Se<-ue.data.length)throw new Error(we+" must be valid indices for gd.data.");if(me.indexOf(Se,Me+1)>-1||Se>=0&&me.indexOf(-ue.data.length+Se)>-1||Se<0&&me.indexOf(ue.data.length+Se)>-1)throw new Error("each index in "+we+" must be unique.")}}function O(ue,me,we){if(!Array.isArray(ue.data))throw new Error("gd.data must be an array.");if(me===void 0)throw new Error("currentIndices is a required argument.");if(Array.isArray(me)||(me=[me]),P(ue,me,"currentIndices"),we===void 0||Array.isArray(we)||(we=[we]),we!==void 0&&P(ue,we,"newIndices"),we!==void 0&&me.length!==we.length)throw new Error("current and new indices must be of equal length.")}function F(ue,me,we,Me,Se){(function(Ge,Qe,it,lt){var Lt=p.isPlainObject(lt);if(!Array.isArray(Ge.data))throw new Error("gd.data must be an array");if(!p.isPlainObject(Qe))throw new Error("update must be a key:value object");if(it===void 0)throw new Error("indices must be an integer or array of integers");for(var wt in P(Ge,it,"indices"),Qe){if(!Array.isArray(Qe[wt])||Qe[wt].length!==it.length)throw new Error("attribute "+wt+" must be an array of length equal to indices array length");if(Lt&&(!(wt in lt)||!Array.isArray(lt[wt])||lt[wt].length!==Qe[wt].length))throw new Error("when maxPoints is set as a key:value object it must contain a 1:1 corrispondence with the keys and number of traces in the update object")}})(ue,me,we,Me);for(var De=function(Ge,Qe,it,lt){var Lt,wt,rt,$e,xt,Qt=p.isPlainObject(lt),$t=[];for(var Ue in Array.isArray(it)||(it=[it]),it=M(it,Ge.data.length-1),Qe)for(var He=0;He<it.length;He++){if(Lt=Ge.data[it[He]],wt=(rt=e(Lt,Ue)).get(),$e=Qe[Ue][He],!p.isArrayOrTypedArray($e))throw new Error("attribute: "+Ue+" index: "+He+" must be an array");if(!p.isArrayOrTypedArray(wt))throw new Error("cannot extend missing or non-array attribute: "+Ue);if(wt.constructor!==$e.constructor)throw new Error("cannot extend array with an array of a different type: "+Ue);xt=Qt?lt[Ue][He]:lt,m(xt)||(xt=-1),$t.push({prop:rt,target:wt,insert:$e,maxp:Math.floor(xt)})}return $t}(ue,me,we,Me),Fe={},Ye={},et=0;et<De.length;et++){var Oe=De[et].prop,je=De[et].maxp,We=Se(De[et].target,De[et].insert,je);Oe.set(We[0]),Array.isArray(Fe[Oe.astr])||(Fe[Oe.astr]=[]),Fe[Oe.astr].push(We[1]),Array.isArray(Ye[Oe.astr])||(Ye[Oe.astr]=[]),Ye[Oe.astr].push(De[et].target.length)}return{update:Fe,maxPoints:Ye}}function j(ue,me){var we=new ue.constructor(ue.length+me.length);return we.set(ue),we.set(me,ue.length),we}function W(ue,me,we,Me){ue=p.getGraphDiv(ue),_.clearPromiseQueue(ue);var Se={};if(typeof me=="string")Se[me]=we;else{if(!p.isPlainObject(me))return p.warn("Restyle fail.",me,we,Me),Promise.reject();Se=p.extendFlat({},me),Me===void 0&&(Me=we)}Object.keys(Se).length&&(ue.changed=!0);var De=_.coerceTraceIndices(ue,Me),Fe=G(ue,Se,De),Ye=Fe.flags;Ye.calc&&(ue.calcdata=void 0),Ye.clearAxisTypes&&_.clearAxisTypes(ue,De,{});var et=[];Ye.fullReplot?et.push(H._doPlot):(et.push(o.previousPromises),o.supplyDefaults(ue),Ye.markerSize&&(o.doCalcdata(ue),B(et)),Ye.style&&et.push(x.doTraceStyle),Ye.colorbars&&et.push(x.doColorBars),et.push(w)),et.push(o.rehover,o.redrag),u.add(ue,W,[ue,Fe.undoit,Fe.traces],W,[ue,Fe.redoit,Fe.traces]);var Oe=p.syncOrAsync(et,ue);return Oe&&Oe.then||(Oe=Promise.resolve()),Oe.then(function(){return ue.emit("plotly_restyle",Fe.eventData),ue})}function Z(ue){return ue===void 0?null:ue}function Q(ue,me){return me?function(we,Me,Se){var De=e(we,Me),Fe=De.set;return De.set=function(Ye){X((Se||"")+Me,De.get(),Ye,ue),Fe(Ye)},De}:e}function X(ue,me,we,Me){if(Array.isArray(me)||Array.isArray(we))for(var Se=Array.isArray(me)?me:[],De=Array.isArray(we)?we:[],Fe=Math.max(Se.length,De.length),Ye=0;Ye<Fe;Ye++)X(ue+"["+Ye+"]",Se[Ye],De[Ye],Me);else if(p.isPlainObject(me)||p.isPlainObject(we)){var et=p.isPlainObject(me)?me:{},Oe=p.isPlainObject(we)?we:{},je=p.extendFlat({},et,Oe);for(var We in je)X(ue+"."+We,et[We],Oe[We],Me)}else Me[ue]===void 0&&(Me[ue]=Z(me))}function G(ue,me,we){var Me,Se=ue._fullLayout,De=ue._fullData,Fe=ue.data,Ye=Se._guiEditing,et=Q(Se._preGUI,Ye),Oe=p.extendDeepAll({},me);Y(me);var je,We=T.traceFlags(),Ge={},Qe={};function it(){return we.map(function(){})}function lt(bt){var Pt=a.id2name(bt);je.indexOf(Pt)===-1&&je.push(Pt)}function Lt(bt){return"LAYOUT"+bt+".autorange"}function wt(bt){return"LAYOUT"+bt+".range"}function rt(bt){for(var Pt=bt;Pt<De.length;Pt++)if(De[Pt]._input===Fe[bt])return De[Pt]}function $e(bt,Pt,Vt){if(Array.isArray(bt))bt.forEach(function(Xt){$e(Xt,Pt,Vt)});else if(!(bt in me)&&!_.hasParent(me,bt)){var nr;if(bt.substr(0,6)==="LAYOUT")nr=et(ue.layout,bt.replace("LAYOUT",""));else{var Yt=we[Vt];nr=Q(Se._tracePreGUI[rt(Yt)._fullInput.uid],Ye)(Fe[Yt],bt)}bt in Qe||(Qe[bt]=it()),Qe[bt][Vt]===void 0&&(Qe[bt][Vt]=Z(nr.get())),Pt!==void 0&&nr.set(Pt)}}function xt(bt){return function(Pt){return De[Pt][bt]}}function Qt(bt){return function(Pt,Vt){return Pt===!1?De[we[Vt]][bt]:null}}for(var $t in me){if(_.hasParent(me,$t))throw new Error("cannot set "+$t+" and a parent attribute simultaneously");var Ue,He,Be,Je,_e,Le,Ce=me[$t];if($t!=="autobinx"&&$t!=="autobiny"||($t=$t.charAt($t.length-1)+"bins",Ce=Array.isArray(Ce)?Ce.map(Qt($t)):Ce===!1?we.map(xt($t)):null),Ge[$t]=Ce,$t.substr(0,6)!=="LAYOUT"){for(Qe[$t]=it(),Me=0;Me<we.length;Me++)if(Ue=Fe[we[Me]],He=rt(we[Me]),Je=(Be=Q(Se._tracePreGUI[He._fullInput.uid],Ye)(Ue,$t)).get(),(_e=Array.isArray(Ce)?Ce[Me%Ce.length]:Ce)!==void 0){var Pe=Be.parts[Be.parts.length-1],Xe=$t.substr(0,$t.length-Pe.length-1),ut=Xe?Xe+".":"",kt=Xe?e(He,Xe).get():He;if((Le=s.getTraceValObject(He,Be.parts))&&Le.impliedEdits&&_e!==null)for(var ft in Le.impliedEdits)$e(p.relativeAttr($t,ft),Le.impliedEdits[ft],Me);else if(Pe!=="thicknessmode"&&Pe!=="lenmode"||Je===_e||_e!=="fraction"&&_e!=="pixels"||!kt){if($t==="type"&&(_e==="pie"!=(Je==="pie")||_e==="funnelarea"!=(Je==="funnelarea"))){var Et="x",mt="y";_e!=="bar"&&Je!=="bar"||Ue.orientation!=="h"||(Et="y",mt="x"),p.swapAttrs(Ue,["?","?src"],"labels",Et),p.swapAttrs(Ue,["d?","?0"],"label",Et),p.swapAttrs(Ue,["?","?src"],"values",mt),Je==="pie"||Je==="funnelarea"?(e(Ue,"marker.color").set(e(Ue,"marker.colors").get()),Se._pielayer.selectAll("g.trace").remove()):i.traceIs(Ue,"cartesian")&&e(Ue,"marker.colors").set(e(Ue,"marker.color").get())}}else{var It=Se._size,vt=kt.orient,nt=vt==="top"||vt==="bottom";if(Pe==="thicknessmode"){var At=nt?It.h:It.w;$e(ut+"thickness",kt.thickness*(_e==="fraction"?1/At:At),Me)}else{var Ft=nt?It.w:It.h;$e(ut+"len",kt.len*(_e==="fraction"?1/Ft:Ft),Me)}}if(Qe[$t][Me]=Z(Je),["swapxy","swapxyaxes","orientation","orientationaxes"].indexOf($t)!==-1){if($t==="orientation"){Be.set(_e);var Nt=Ue.x&&!Ue.y?"h":"v";if((Be.get()||Nt)===He.orientation)continue}else $t==="orientationaxes"&&(Ue.orientation={v:"h",h:"v"}[He.orientation]);_.swapXYData(Ue),We.calc=We.clearAxisTypes=!0}else o.dataArrayContainers.indexOf(Be.parts[0])!==-1?(_.manageArrayContainers(Be,_e,Qe),We.calc=!0):(Le?Le.arrayOk&&!i.traceIs(He,"regl")&&(p.isArrayOrTypedArray(_e)||p.isArrayOrTypedArray(Je))?We.calc=!0:T.update(We,Le):We.calc=!0,Be.set(_e))}if(["swapxyaxes","orientationaxes"].indexOf($t)!==-1&&a.swap(ue,we),$t==="orientationaxes"){var Kt=e(ue.layout,"hovermode"),Ie=Kt.get();Ie==="x"?Kt.set("y"):Ie==="y"?Kt.set("x"):Ie==="x unified"?Kt.set("y unified"):Ie==="y unified"&&Kt.set("x unified")}if(["orientation","type"].indexOf($t)!==-1){for(je=[],Me=0;Me<we.length;Me++){var ot=Fe[we[Me]];i.traceIs(ot,"cartesian")&&(lt(ot.xaxis||"x"),lt(ot.yaxis||"y"))}$e(je.map(Lt),!0,0),$e(je.map(wt),[0,1],0)}}else Be=et(ue.layout,$t.replace("LAYOUT","")),Qe[$t]=[Z(Be.get())],Be.set(Array.isArray(Ce)?Ce[0]:Ce),We.calc=!0}return(We.calc||We.plot)&&(We.fullReplot=!0),{flags:We,undoit:Qe,redoit:Ge,traces:we,eventData:p.extendDeepNoArrays([],[Oe,we])}}function Y(ue){var me,we,Me,Se=p.counterRegex("axis",".title",!1,!1),De=/colorbar\.title$/,Fe=Object.keys(ue);for(me=0;me<Fe.length;me++)we=Fe[me],Me=ue[we],we!=="title"&&!Se.test(we)&&!De.test(we)||typeof Me!="string"&&typeof Me!="number"?we.indexOf("titlefont")>-1?Ye(we,we.replace("titlefont","title.font")):we.indexOf("titleposition")>-1?Ye(we,we.replace("titleposition","title.position")):we.indexOf("titleside")>-1?Ye(we,we.replace("titleside","title.side")):we.indexOf("titleoffset")>-1&&Ye(we,we.replace("titleoffset","title.offset")):Ye(we,we.replace("title","title.text"));function Ye(et,Oe){ue[Oe]=ue[et],delete ue[et]}}function K(ue,me,we){ue=p.getGraphDiv(ue),_.clearPromiseQueue(ue);var Me={};if(typeof me=="string")Me[me]=we;else{if(!p.isPlainObject(me))return p.warn("Relayout fail.",me,we),Promise.reject();Me=p.extendFlat({},me)}Object.keys(Me).length&&(ue.changed=!0);var Se=$(ue,Me),De=Se.flags;De.calc&&(ue.calcdata=void 0);var Fe=[o.previousPromises];De.layoutReplot?Fe.push(x.layoutReplot):Object.keys(Me).length&&(D(ue,De,Se)||o.supplyDefaults(ue),De.legend&&Fe.push(x.doLegend),De.layoutstyle&&Fe.push(x.layoutStyles),De.axrange&&B(Fe,Se.rangesAltered),De.ticks&&Fe.push(x.doTicksRelayout),De.modebar&&Fe.push(x.doModeBar),De.camera&&Fe.push(x.doCamera),De.colorbars&&Fe.push(x.doColorBars),Fe.push(w)),Fe.push(o.rehover,o.redrag),u.add(ue,K,[ue,Se.undoit],K,[ue,Se.redoit]);var Ye=p.syncOrAsync(Fe,ue);return Ye&&Ye.then||(Ye=Promise.resolve(ue)),Ye.then(function(){return ue.emit("plotly_relayout",Se.eventData),ue})}function D(ue,me,we){var Me=ue._fullLayout;if(!me.axrange)return!1;for(var Se in me)if(Se!=="axrange"&&me[Se])return!1;for(var De in we.rangesAltered){var Fe=a.id2name(De),Ye=ue.layout[Fe],et=Me[Fe];if(et.autorange=Ye.autorange,Ye.range&&(et.range=Ye.range.slice()),et.cleanRange(),et._matchGroup){for(var Oe in et._matchGroup)if(Oe!==De){var je=Me[a.id2name(Oe)];je.autorange=et.autorange,je.range=et.range.slice(),je._input.range=et.range.slice()}}}return!0}function B(ue,me){var we=me?function(Me){var Se=[],De=!0;for(var Fe in me){var Ye=a.getFromId(Me,Fe);if(Se.push(Fe),(Ye.ticklabelposition||"").indexOf("inside")!==-1&&Ye._anchorAxis&&Se.push(Ye._anchorAxis._id),Ye._matchGroup)for(var et in Ye._matchGroup)me[et]||Se.push(et);Ye.automargin&&(De=!1)}return a.draw(Me,Se,{skipTitle:De})}:function(Me){return a.draw(Me,"redraw")};ue.push(l,x.doAutoRangeAndConstraints,we,x.drawData,x.finalDraw)}var q=/^[xyz]axis[0-9]*\.range(\[[0|1]\])?$/,ee=/^[xyz]axis[0-9]*\.autorange$/,J=/^[xyz]axis[0-9]*\.domain(\[[0|1]\])?$/;function $(ue,me){var we,Me,Se,De=ue.layout,Fe=ue._fullLayout,Ye=Fe._guiEditing,et=Q(Fe._preGUI,Ye),Oe=Object.keys(me),je=a.list(ue),We=p.extendDeepAll({},me),Ge={};for(Y(me),Oe=Object.keys(me),Me=0;Me<Oe.length;Me++)if(Oe[Me].indexOf("allaxes")===0){for(Se=0;Se<je.length;Se++){var Qe=je[Se]._id.substr(1),it=Qe.indexOf("scene")!==-1?Qe+".":"",lt=Oe[Me].replace("allaxes",it+je[Se]._name);me[lt]||(me[lt]=me[Oe[Me]])}delete me[Oe[Me]]}var Lt=T.layoutFlags(),wt={},rt={};function $e(Yt,Xt){if(Array.isArray(Yt))Yt.forEach(function(hr){$e(hr,Xt)});else if(!(Yt in me)&&!_.hasParent(me,Yt)){var ar=et(De,Yt);Yt in rt||(rt[Yt]=Z(ar.get())),Xt!==void 0&&ar.set(Xt)}}var xt,Qt={};function $t(Yt){var Xt=a.name2id(Yt.split(".")[0]);return Qt[Xt]=1,Xt}for(var Ue in me){if(_.hasParent(me,Ue))throw new Error("cannot set "+Ue+" and a parent attribute simultaneously");for(var He=et(De,Ue),Be=me[Ue],Je=He.parts.length-1;Je>0&&typeof He.parts[Je]!="string";)Je--;var _e=He.parts[Je],Le=He.parts[Je-1]+"."+_e,Ce=He.parts.slice(0,Je).join("."),Pe=e(ue.layout,Ce).get(),Xe=e(Fe,Ce).get(),ut=He.get();if(Be!==void 0){wt[Ue]=Be,rt[Ue]=_e==="reverse"?Be:Z(ut);var kt=s.getLayoutValObject(Fe,He.parts);if(kt&&kt.impliedEdits&&Be!==null)for(var ft in kt.impliedEdits)$e(p.relativeAttr(Ue,ft),kt.impliedEdits[ft]);if(["width","height"].indexOf(Ue)!==-1)if(Be){$e("autosize",null);var Et=Ue==="height"?"width":"height";$e(Et,Fe[Et])}else Fe[Ue]=ue._initialAutoSize[Ue];else if(Ue==="autosize")$e("width",Be?null:Fe.width),$e("height",Be?null:Fe.height);else if(Le.match(q))$t(Le),e(Fe,Ce+"._inputRange").set(null);else if(Le.match(ee)){$t(Le),e(Fe,Ce+"._inputRange").set(null);var mt=e(Fe,Ce).get();mt._inputDomain&&(mt._input.domain=mt._inputDomain.slice())}else Le.match(J)&&e(Fe,Ce+"._inputDomain").set(null);if(_e==="type"){xt=Pe;var It=Xe.type==="linear"&&Be==="log",vt=Xe.type==="log"&&Be==="linear";if(It||vt){if(xt&&xt.range)if(Xe.autorange)It&&(xt.range=xt.range[1]>xt.range[0]?[1,2]:[2,1]);else{var nt=xt.range[0],At=xt.range[1];It?(nt<=0&&At<=0&&$e(Ce+".autorange",!0),nt<=0?nt=At/1e6:At<=0&&(At=nt/1e6),$e(Ce+".range[0]",Math.log(nt)/Math.LN10),$e(Ce+".range[1]",Math.log(At)/Math.LN10)):($e(Ce+".range[0]",Math.pow(10,nt)),$e(Ce+".range[1]",Math.pow(10,At)))}else $e(Ce+".autorange",!0);Array.isArray(Fe._subplots.polar)&&Fe._subplots.polar.length&&Fe[He.parts[0]]&&He.parts[1]==="radialaxis"&&delete Fe[He.parts[0]]._subplot.viewInitial["radialaxis.range"],i.getComponentMethod("annotations","convertCoords")(ue,Xe,Be,$e),i.getComponentMethod("images","convertCoords")(ue,Xe,Be,$e)}else $e(Ce+".autorange",!0),$e(Ce+".range",null);e(Fe,Ce+"._inputRange").set(null)}else if(_e.match(A)){var Ft=e(Fe,Ue).get(),Nt=(Be||{}).type;Nt&&Nt!=="-"||(Nt="linear"),i.getComponentMethod("annotations","convertCoords")(ue,Ft,Nt,$e),i.getComponentMethod("images","convertCoords")(ue,Ft,Nt,$e)}var Kt=v.containerArrayMatch(Ue);if(Kt){we=Kt.array,Me=Kt.index;var Ie=Kt.property,ot=kt||{editType:"calc"};Me!==""&&Ie===""&&(v.isAddVal(Be)?rt[Ue]=null:v.isRemoveVal(Be)?rt[Ue]=(e(De,we).get()||[])[Me]:p.warn("unrecognized full object value",me)),T.update(Lt,ot),Ge[we]||(Ge[we]={});var bt=Ge[we][Me];bt||(bt=Ge[we][Me]={}),bt[Ie]=Be,delete me[Ue]}else _e==="reverse"?(Pe.range?Pe.range.reverse():($e(Ce+".autorange",!0),Pe.range=[1,0]),Xe.autorange?Lt.calc=!0:Lt.plot=!0):(Fe._has("scatter-like")&&Fe._has("regl")&&Ue==="dragmode"&&(Be==="lasso"||Be==="select")&&ut!=="lasso"&&ut!=="select"||Fe._has("gl2d")?Lt.plot=!0:kt?T.update(Lt,kt):Lt.calc=!0,He.set(Be))}}for(we in Ge)v.applyContainerArrayChanges(ue,et(De,we),Ge[we],Lt,et)||(Lt.plot=!0);for(var Pt in Qt){var Vt=(xt=a.getFromId(ue,Pt))&&xt._constraintGroup;if(Vt)for(var nr in Lt.calc=!0,Vt)Qt[nr]||(a.getFromId(ue,nr)._constraintShrinkable=!0)}return(te(ue)||me.height||me.width)&&(Lt.plot=!0),(Lt.plot||Lt.calc)&&(Lt.layoutReplot=!0),{flags:Lt,rangesAltered:Qt,undoit:rt,redoit:wt,eventData:We}}function te(ue){var me=ue._fullLayout,we=me.width,Me=me.height;return ue.layout.autosize&&o.plotAutoSize(ue,ue.layout,me),me.width!==we||me.height!==Me}function ie(ue,me,we,Me){ue=p.getGraphDiv(ue),_.clearPromiseQueue(ue),p.isPlainObject(me)||(me={}),p.isPlainObject(we)||(we={}),Object.keys(me).length&&(ue.changed=!0),Object.keys(we).length&&(ue.changed=!0);var Se=_.coerceTraceIndices(ue,Me),De=G(ue,p.extendFlat({},me),Se),Fe=De.flags,Ye=$(ue,p.extendFlat({},we)),et=Ye.flags;(Fe.calc||et.calc)&&(ue.calcdata=void 0),Fe.clearAxisTypes&&_.clearAxisTypes(ue,Se,we);var Oe=[];et.layoutReplot?Oe.push(x.layoutReplot):Fe.fullReplot?Oe.push(H._doPlot):(Oe.push(o.previousPromises),D(ue,et,Ye)||o.supplyDefaults(ue),Fe.style&&Oe.push(x.doTraceStyle),(Fe.colorbars||et.colorbars)&&Oe.push(x.doColorBars),et.legend&&Oe.push(x.doLegend),et.layoutstyle&&Oe.push(x.layoutStyles),et.axrange&&B(Oe,Ye.rangesAltered),et.ticks&&Oe.push(x.doTicksRelayout),et.modebar&&Oe.push(x.doModeBar),et.camera&&Oe.push(x.doCamera),Oe.push(w)),Oe.push(o.rehover,o.redrag),u.add(ue,ie,[ue,De.undoit,Ye.undoit,De.traces],ie,[ue,De.redoit,Ye.redoit,De.traces]);var je=p.syncOrAsync(Oe,ue);return je&&je.then||(je=Promise.resolve(ue)),je.then(function(){return ue.emit("plotly_update",{data:De.eventData,layout:Ye.eventData}),ue})}function ae(ue){return function(me){me._fullLayout._guiEditing=!0;var we=ue.apply(null,arguments);return me._fullLayout._guiEditing=!1,we}}var he=[{pattern:/^hiddenlabels/,attr:"legend.uirevision"},{pattern:/^((x|y)axis\d*)\.((auto)?range|title\.text)/},{pattern:/axis\d*\.showspikes$/,attr:"modebar.uirevision"},{pattern:/(hover|drag)mode$/,attr:"modebar.uirevision"},{pattern:/^(scene\d*)\.camera/},{pattern:/^(geo\d*)\.(projection|center|fitbounds)/},{pattern:/^(ternary\d*\.[abc]axis)\.(min|title\.text)$/},{pattern:/^(polar\d*\.radialaxis)\.((auto)?range|angle|title\.text)/},{pattern:/^(polar\d*\.angularaxis)\.rotation/},{pattern:/^(mapbox\d*)\.(center|zoom|bearing|pitch)/},{pattern:/^legend\.(x|y)$/,attr:"editrevision"},{pattern:/^(shapes|annotations)/,attr:"editrevision"},{pattern:/^title\.text$/,attr:"editrevision"}],se=[{pattern:/^selectedpoints$/,attr:"selectionrevision"},{pattern:/(^|value\.)visible$/,attr:"legend.uirevision"},{pattern:/^dimensions\[\d+\]\.constraintrange/},{pattern:/^node\.(x|y|groups)/},{pattern:/^level$/},{pattern:/(^|value\.)name$/},{pattern:/colorbar\.title\.text$/},{pattern:/colorbar\.(x|y)$/,attr:"editrevision"}];function de(ue,me){for(var we=0;we<me.length;we++){var Me=me[we],Se=ue.match(Me.pattern);if(Se)return{head:Se[1],attr:Me.attr}}}function ce(ue,me){var we=e(me,ue).get();if(we!==void 0)return we;var Me=ue.split(".");for(Me.pop();Me.length>1;)if(Me.pop(),(we=e(me,Me.join(".")+".uirevision").get())!==void 0)return we;return me.uirevision}function ve(ue,me){for(var we=0;we<me.length;we++)if(me[we]._fullInput.uid===ue)return we;return-1}function ke(ue,me,we){for(var Me=0;Me<me.length;Me++)if(me[Me].uid===ue)return Me;return!me[we]||me[we].uid?-1:we}function Ee(ue,me){var we=p.isPlainObject(ue),Me=Array.isArray(ue);return we||Me?(we&&p.isPlainObject(me)||Me&&Array.isArray(me))&&JSON.stringify(ue)===JSON.stringify(me):ue===me}function be(ue,me,we,Me){var Se,De,Fe,Ye=Me.getValObject,et=Me.flags,Oe=Me.immutable,je=Me.inArray,We=Me.arrayIndex;function Ge(){var Pe=Se.editType;je&&Pe.indexOf("arraydraw")!==-1?p.pushUnique(et.arrays[je],We):(T.update(et,Se),Pe!=="none"&&et.nChanges++,Me.transition&&Se.anim&&et.nChangesAnim++,(q.test(Fe)||ee.test(Fe))&&(et.rangesAltered[we[0]]=1),J.test(Fe)&&e(me,"_inputDomain").set(null),De==="datarevision"&&(et.newDataRevision=1))}function Qe(Pe){return Pe.valType==="data_array"||Pe.arrayOk}for(De in ue){if(et.calc&&!Me.transition)return;var it=ue[De],lt=me[De],Lt=we.concat(De);if(Fe=Lt.join("."),De.charAt(0)!=="_"&&typeof it!="function"&&it!==lt){if((De==="tick0"||De==="dtick")&&we[0]!=="geo"){var wt=me.tickmode;if(wt==="auto"||wt==="array"||!wt)continue}if((De!=="range"||!me.autorange)&&(De!=="zmin"&&De!=="zmax"||me.type!=="contourcarpet")&&(Se=Ye(Lt))&&(!Se._compareAsJSON||JSON.stringify(it)!==JSON.stringify(lt))){var rt,$e=Se.valType,xt=Qe(Se),Qt=Array.isArray(it),$t=Array.isArray(lt);if(Qt&&$t){var Ue="_input_"+De,He=ue[Ue],Be=me[Ue];if(Array.isArray(He)&&He===Be)continue}if(lt===void 0)xt&&Qt?et.calc=!0:Ge();else if(Se._isLinkedToArray){var Je=[],_e=!1;je||(et.arrays[De]=Je);var Le=Math.min(it.length,lt.length),Ce=Math.max(it.length,lt.length);if(Le!==Ce){if(Se.editType!=="arraydraw"){Ge();continue}_e=!0}for(rt=0;rt<Le;rt++)be(it[rt],lt[rt],Lt.concat(rt),p.extendFlat({inArray:De,arrayIndex:rt},Me));if(_e)for(rt=Le;rt<Ce;rt++)Je.push(rt)}else!$e&&p.isPlainObject(it)?be(it,lt,Lt,Me):xt?Qt&&$t?(Oe&&(et.calc=!0),(Oe||Me.newDataRevision)&&Ge()):Qt!==$t?et.calc=!0:Ge():Qt&&$t&&it.length===lt.length&&String(it)===String(lt)||Ge()}}}for(De in me)if(!(De in ue)&&De.charAt(0)!=="_"&&typeof me[De]!="function"){if(Qe(Se=Ye(we.concat(De)))&&Array.isArray(me[De]))return void(et.calc=!0);Ge()}}function xe(ue){var me=ue._fullLayout,we=ue.getBoundingClientRect();if(!p.equalDomRects(we,me._lastBBox)){var Me=me._invTransform=p.inverseTransformMatrix(p.getFullTransformMatrix(ue));me._invScaleX=Math.sqrt(Me[0][0]*Me[0][0]+Me[0][1]*Me[0][1]+Me[0][2]*Me[0][2]),me._invScaleY=Math.sqrt(Me[1][0]*Me[1][0]+Me[1][1]*Me[1][1]+Me[1][2]*Me[1][2]),me._lastBBox=we}}H.animate=function(ue,me,we){if(ue=p.getGraphDiv(ue),!p.isPlotDiv(ue))throw new Error("This element is not a Plotly plot: "+ue+". It's likely that you've failed to create a plot before animating it. For more details, see https://plotly.com/javascript/animations/");var Me=ue._transitionData;Me._frameQueue||(Me._frameQueue=[]);var Se=(we=o.supplyAnimationDefaults(we)).transition,De=we.frame;function Fe(Oe){return Array.isArray(Se)?Oe>=Se.length?Se[0]:Se[Oe]:Se}function Ye(Oe){return Array.isArray(De)?Oe>=De.length?De[0]:De[Oe]:De}function et(Oe,je){var We=0;return function(){if(Oe&&++We===je)return Oe()}}return Me._frameWaitingCnt===void 0&&(Me._frameWaitingCnt=0),new Promise(function(Oe,je){function We(){Me._currentFrame&&Me._currentFrame.onComplete&&Me._currentFrame.onComplete();var He=Me._currentFrame=Me._frameQueue.shift();if(He){var Be=He.name?He.name.toString():null;ue._fullLayout._currentFrame=Be,Me._lastFrameAt=Date.now(),Me._timeToNext=He.frameOpts.duration,o.transition(ue,He.frame.data,He.frame.layout,_.coerceTraceIndices(ue,He.frame.traces),He.frameOpts,He.transitionOpts).then(function(){He.onComplete&&He.onComplete()}),ue.emit("plotly_animatingframe",{name:Be,frame:He.frame,animation:{frame:He.frameOpts,transition:He.transitionOpts}})}else ue.emit("plotly_animated"),window.cancelAnimationFrame(Me._animationRaf),Me._animationRaf=null}function Ge(){ue.emit("plotly_animating"),Me._lastFrameAt=-1/0,Me._timeToNext=0,Me._runningTransitions=0,Me._currentFrame=null;var He=function(){Me._animationRaf=window.requestAnimationFrame(He),Date.now()-Me._lastFrameAt>Me._timeToNext&&We()};He()}var Qe,it,lt=0;function Lt(He){return Array.isArray(Se)?lt>=Se.length?He.transitionOpts=Se[lt]:He.transitionOpts=Se[0]:He.transitionOpts=Se,lt++,He}var wt=[],rt=me==null,$e=Array.isArray(me);if(!rt&&!$e&&p.isPlainObject(me))wt.push({type:"object",data:Lt(p.extendFlat({},me))});else if(rt||["string","number"].indexOf(typeof me)!==-1)for(Qe=0;Qe<Me._frames.length;Qe++)(it=Me._frames[Qe])&&(rt||String(it.group)===String(me))&&wt.push({type:"byname",name:String(it.name),data:Lt({name:it.name})});else if($e)for(Qe=0;Qe<me.length;Qe++){var xt=me[Qe];["number","string"].indexOf(typeof xt)!==-1?(xt=String(xt),wt.push({type:"byname",name:xt,data:Lt({name:xt})})):p.isPlainObject(xt)&&wt.push({type:"object",data:Lt(p.extendFlat({},xt))})}for(Qe=0;Qe<wt.length;Qe++)if((it=wt[Qe]).type==="byname"&&!Me._frameHash[it.data.name])return p.warn('animate failure: frame not found: "'+it.data.name+'"'),void je();["next","immediate"].indexOf(we.mode)!==-1&&function(){if(Me._frameQueue.length!==0){for(;Me._frameQueue.length;){var He=Me._frameQueue.pop();He.onInterrupt&&He.onInterrupt()}ue.emit("plotly_animationinterrupted",[])}}(),we.direction==="reverse"&&wt.reverse();var Qt=ue._fullLayout._currentFrame;if(Qt&&we.fromcurrent){var $t=-1;for(Qe=0;Qe<wt.length;Qe++)if((it=wt[Qe]).type==="byname"&&it.name===Qt){$t=Qe;break}if($t>0&&$t<wt.length-1){var Ue=[];for(Qe=0;Qe<wt.length;Qe++)it=wt[Qe],(wt[Qe].type!=="byname"||Qe>$t)&&Ue.push(it);wt=Ue}}wt.length>0?function(He){if(He.length!==0){for(var Be=0;Be<He.length;Be++){var Je;Je=He[Be].type==="byname"?o.computeFrame(ue,He[Be].name):He[Be].data;var _e=Ye(Be),Le=Fe(Be);Le.duration=Math.min(Le.duration,_e.duration);var Ce={frame:Je,name:He[Be].name,frameOpts:_e,transitionOpts:Le};Be===He.length-1&&(Ce.onComplete=et(Oe,2),Ce.onInterrupt=je),Me._frameQueue.push(Ce)}we.mode==="immediate"&&(Me._lastFrameAt=-1/0),Me._animationRaf||Ge()}}(wt):(ue.emit("plotly_animated"),Oe())})},H.addFrames=function(ue,me,we){if(ue=p.getGraphDiv(ue),me==null)return Promise.resolve();if(!p.isPlotDiv(ue))throw new Error("This element is not a Plotly plot: "+ue+". It's likely that you've failed to create a plot before adding frames. For more details, see https://plotly.com/javascript/animations/");var Me,Se,De,Fe,Ye=ue._transitionData._frames,et=ue._transitionData._frameHash;if(!Array.isArray(me))throw new Error("addFrames failure: frameList must be an Array of frame definitions"+me);var Oe=Ye.length+2*me.length,je=[],We={};for(Me=me.length-1;Me>=0;Me--)if(p.isPlainObject(me[Me])){var Ge=me[Me].name,Qe=(et[Ge]||We[Ge]||{}).name,it=me[Me].name,lt=et[Qe]||We[Qe];Qe&&it&&typeof it=="number"&&lt&&S<5&&(S++,p.warn('addFrames: overwriting frame "'+(et[Qe]||We[Qe]).name+'" with a frame whose name of type "number" also equates to "'+Qe+'". This is valid but may potentially lead to unexpected behavior since all plotly.js frame names are stored internally as strings.'),S===5&&p.warn("addFrames: This API call has yielded too many of these warnings. For the rest of this call, further warnings about numeric frame names will be suppressed.")),We[Ge]={name:Ge},je.push({frame:o.supplyFrameDefaults(me[Me]),index:we&&we[Me]!==void 0&&we[Me]!==null?we[Me]:Oe+Me})}je.sort(function(Ue,He){return Ue.index>He.index?-1:Ue.index<He.index?1:0});var Lt=[],wt=[],rt=Ye.length;for(Me=je.length-1;Me>=0;Me--){if(typeof(Se=je[Me].frame).name=="number"&&p.warn("Warning: addFrames accepts frames with numeric names, but the numbers areimplicitly cast to strings"),!Se.name)for(;et[Se.name="frame "+ue._transitionData._counter++];);if(et[Se.name]){for(De=0;De<Ye.length&&(Ye[De]||{}).name!==Se.name;De++);Lt.push({type:"replace",index:De,value:Se}),wt.unshift({type:"replace",index:De,value:Ye[De]})}else Fe=Math.max(0,Math.min(je[Me].index,rt)),Lt.push({type:"insert",index:Fe,value:Se}),wt.unshift({type:"delete",index:Fe}),rt++}var $e=o.modifyFrames,xt=o.modifyFrames,Qt=[ue,wt],$t=[ue,Lt];return u&&u.add(ue,$e,Qt,xt,$t),o.modifyFrames(ue,Lt)},H.deleteFrames=function(ue,me){if(ue=p.getGraphDiv(ue),!p.isPlotDiv(ue))throw new Error("This element is not a Plotly plot: "+ue);var we,Me,Se=ue._transitionData._frames,De=[],Fe=[];if(!me)for(me=[],we=0;we<Se.length;we++)me.push(we);for((me=me.slice()).sort(),we=me.length-1;we>=0;we--)Me=me[we],De.push({type:"delete",index:Me}),Fe.unshift({type:"insert",index:Me,value:Se[Me]});var Ye=o.modifyFrames,et=o.modifyFrames,Oe=[ue,Fe],je=[ue,De];return u&&u.add(ue,Ye,Oe,et,je),o.modifyFrames(ue,De)},H.addTraces=function ue(me,we,Me){me=p.getGraphDiv(me);var Se,De,Fe=[],Ye=H.deleteTraces,et=ue,Oe=[me,Fe],je=[me,we];for(function(We,Ge,Qe){var it,lt;if(!Array.isArray(We.data))throw new Error("gd.data must be an array.");if(Ge===void 0)throw new Error("traces must be defined.");for(Array.isArray(Ge)||(Ge=[Ge]),it=0;it<Ge.length;it++)if(typeof(lt=Ge[it])!="object"||Array.isArray(lt)||lt===null)throw new Error("all values in traces array must be non-array objects");if(Qe===void 0||Array.isArray(Qe)||(Qe=[Qe]),Qe!==void 0&&Qe.length!==Ge.length)throw new Error("if indices is specified, traces.length must equal indices.length")}(me,we,Me),Array.isArray(we)||(we=[we]),we=we.map(function(We){return p.extendFlat({},We)}),_.cleanData(we),Se=0;Se<we.length;Se++)me.data.push(we[Se]);for(Se=0;Se<we.length;Se++)Fe.push(-we.length+Se);if(Me===void 0)return De=H.redraw(me),u.add(me,Ye,Oe,et,je),De;Array.isArray(Me)||(Me=[Me]);try{O(me,Fe,Me)}catch(We){throw me.data.splice(me.data.length-we.length,we.length),We}return u.startSequence(me),u.add(me,Ye,Oe,et,je),De=H.moveTraces(me,Fe,Me),u.stopSequence(me),De},H.deleteTraces=function ue(me,we){me=p.getGraphDiv(me);var Me,Se,De=[],Fe=H.addTraces,Ye=ue,et=[me,De,we],Oe=[me,we];if(we===void 0)throw new Error("indices must be an integer or array of integers.");for(Array.isArray(we)||(we=[we]),P(me,we,"indices"),(we=M(we,me.data.length-1)).sort(p.sorterDes),Me=0;Me<we.length;Me+=1)Se=me.data.splice(we[Me],1)[0],De.push(Se);var je=H.redraw(me);return u.add(me,Fe,et,Ye,Oe),je},H.extendTraces=function ue(me,we,Me,Se){function De(Oe,je,We){var Ge,Qe;if(p.isTypedArray(Oe))if(We<0){var it=new Oe.constructor(0),lt=j(Oe,je);We<0?(Ge=lt,Qe=it):(Ge=it,Qe=lt)}else if(Ge=new Oe.constructor(We),Qe=new Oe.constructor(Oe.length+je.length-We),We===je.length)Ge.set(je),Qe.set(Oe);else if(We<je.length){var Lt=je.length-We;Ge.set(je.subarray(Lt)),Qe.set(Oe),Qe.set(je.subarray(0,Lt),Oe.length)}else{var wt=We-je.length,rt=Oe.length-wt;Ge.set(Oe.subarray(rt)),Ge.set(je,wt),Qe.set(Oe.subarray(0,rt))}else Ge=Oe.concat(je),Qe=We>=0&&We<Ge.length?Ge.splice(0,Ge.length-We):[];return[Ge,Qe]}var Fe=F(me=p.getGraphDiv(me),we,Me,Se,De),Ye=H.redraw(me),et=[me,Fe.update,Me,Fe.maxPoints];return u.add(me,H.prependTraces,et,ue,arguments),Ye},H.moveTraces=function ue(me,we,Me){var Se,De=[],Fe=[],Ye=ue,et=ue,Oe=[me=p.getGraphDiv(me),Me,we],je=[me,we,Me];if(O(me,we,Me),we=Array.isArray(we)?we:[we],Me===void 0)for(Me=[],Se=0;Se<we.length;Se++)Me.push(-we.length+Se);for(Me=Array.isArray(Me)?Me:[Me],we=M(we,me.data.length-1),Me=M(Me,me.data.length-1),Se=0;Se<me.data.length;Se++)we.indexOf(Se)===-1&&De.push(me.data[Se]);for(Se=0;Se<we.length;Se++)Fe.push({newIndex:Me[Se],trace:me.data[we[Se]]});for(Fe.sort(function(Ge,Qe){return Ge.newIndex-Qe.newIndex}),Se=0;Se<Fe.length;Se+=1)De.splice(Fe[Se].newIndex,0,Fe[Se].trace);me.data=De;var We=H.redraw(me);return u.add(me,Ye,Oe,et,je),We},H.prependTraces=function ue(me,we,Me,Se){function De(Oe,je,We){var Ge,Qe;if(p.isTypedArray(Oe))if(We<=0){var it=new Oe.constructor(0),lt=j(je,Oe);We<0?(Ge=lt,Qe=it):(Ge=it,Qe=lt)}else if(Ge=new Oe.constructor(We),Qe=new Oe.constructor(Oe.length+je.length-We),We===je.length)Ge.set(je),Qe.set(Oe);else if(We<je.length){var Lt=je.length-We;Ge.set(je.subarray(0,Lt)),Qe.set(je.subarray(Lt)),Qe.set(Oe,Lt)}else{var wt=We-je.length;Ge.set(je),Ge.set(Oe.subarray(0,wt),je.length),Qe.set(Oe.subarray(wt))}else Ge=je.concat(Oe),Qe=We>=0&&We<Ge.length?Ge.splice(We,Ge.length):[];return[Ge,Qe]}var Fe=F(me=p.getGraphDiv(me),we,Me,Se,De),Ye=H.redraw(me),et=[me,Fe.update,Me,Fe.maxPoints];return u.add(me,H.extendTraces,et,ue,arguments),Ye},H.newPlot=function(ue,me,we,Me){return ue=p.getGraphDiv(ue),o.cleanPlot([],{},ue._fullData||[],ue._fullLayout||{}),o.purge(ue),H._doPlot(ue,me,we,Me)},H._doPlot=function(ue,me,we,Me){var Se;if(ue=p.getGraphDiv(ue),f.init(ue),p.isPlainObject(me)){var De=me;me=De.data,we=De.layout,Me=De.config,Se=De.frames}if(f.triggerHandler(ue,"plotly_beforeplot",[me,we,Me])===!1)return Promise.reject();me||we||p.isPlotDiv(ue)||p.warn("Calling _doPlot as if redrawing but this container doesn't yet have a plot.",ue),C(ue,Me),we||(we={}),t.select(ue).classed("js-plotly-plot",!0),c.makeTester(),Array.isArray(ue._promises)||(ue._promises=[]);var Fe=(ue.data||[]).length===0&&Array.isArray(me);Array.isArray(me)&&(_.cleanData(me),Fe?ue.data=me:ue.data.push.apply(ue.data,me),ue.empty=!1),ue.layout&&!Fe||(ue.layout=_.cleanLayout(we)),o.supplyDefaults(ue);var Ye=ue._fullLayout,et=Ye._has("cartesian");Ye._replotting=!0,(Fe||Ye._shouldCreateBgLayer)&&(function(wt){var rt=t.select(wt),$e=wt._fullLayout;if($e._calcInverseTransform=xe,$e._calcInverseTransform(wt),$e._container=rt.selectAll(".plot-container").data([0]),$e._container.enter().insert("div",":first-child").classed("plot-container",!0).classed("plotly",!0),$e._paperdiv=$e._container.selectAll(".svg-container").data([0]),$e._paperdiv.enter().append("div").classed("user-select-none",!0).classed("svg-container",!0).style("position","relative"),$e._glcontainer=$e._paperdiv.selectAll(".gl-container").data([{}]),$e._glcontainer.enter().append("div").classed("gl-container",!0),$e._paperdiv.selectAll(".main-svg").remove(),$e._paperdiv.select(".modebar-container").remove(),$e._paper=$e._paperdiv.insert("svg",":first-child").classed("main-svg",!0),$e._toppaper=$e._paperdiv.append("svg").classed("main-svg",!0),$e._modebardiv=$e._paperdiv.append("div"),delete $e._modeBar,$e._hoverpaper=$e._paperdiv.append("svg").classed("main-svg",!0),!$e._uid){var xt={};t.selectAll("defs").each(function(){this.id&&(xt[this.id.split("-")[1]]=1)}),$e._uid=p.randstr(xt)}$e._paperdiv.selectAll(".main-svg").attr(d.svgAttrs),$e._defs=$e._paper.append("defs").attr("id","defs-"+$e._uid),$e._clips=$e._defs.append("g").classed("clips",!0),$e._topdefs=$e._toppaper.append("defs").attr("id","topdefs-"+$e._uid),$e._topclips=$e._topdefs.append("g").classed("clips",!0),$e._bgLayer=$e._paper.append("g").classed("bglayer",!0),$e._draggers=$e._paper.append("g").classed("draglayer",!0);var Qt=$e._paper.append("g").classed("layer-below",!0);$e._imageLowerLayer=Qt.append("g").classed("imagelayer",!0),$e._shapeLowerLayer=Qt.append("g").classed("shapelayer",!0),$e._cartesianlayer=$e._paper.append("g").classed("cartesianlayer",!0),$e._polarlayer=$e._paper.append("g").classed("polarlayer",!0),$e._ternarylayer=$e._paper.append("g").classed("ternarylayer",!0),$e._geolayer=$e._paper.append("g").classed("geolayer",!0),$e._funnelarealayer=$e._paper.append("g").classed("funnelarealayer",!0),$e._pielayer=$e._paper.append("g").classed("pielayer",!0),$e._iciclelayer=$e._paper.append("g").classed("iciclelayer",!0),$e._treemaplayer=$e._paper.append("g").classed("treemaplayer",!0),$e._sunburstlayer=$e._paper.append("g").classed("sunburstlayer",!0),$e._indicatorlayer=$e._toppaper.append("g").classed("indicatorlayer",!0),$e._glimages=$e._paper.append("g").classed("glimages",!0);var $t=$e._toppaper.append("g").classed("layer-above",!0);$e._imageUpperLayer=$t.append("g").classed("imagelayer",!0),$e._shapeUpperLayer=$t.append("g").classed("shapelayer",!0),$e._infolayer=$e._toppaper.append("g").classed("infolayer",!0),$e._menulayer=$e._toppaper.append("g").classed("menulayer",!0),$e._zoomlayer=$e._toppaper.append("g").classed("zoomlayer",!0),$e._hoverlayer=$e._hoverpaper.append("g").classed("hoverlayer",!0),$e._modebardiv.classed("modebar-container",!0).style("position","absolute").style("top","0px").style("right","0px"),wt.emit("plotly_framework")}(ue),Ye._shouldCreateBgLayer&&delete Ye._shouldCreateBgLayer),c.initGradients(ue),c.initPatterns(ue),Fe&&a.saveShowSpikeInitial(ue);var Oe=!ue.calcdata||ue.calcdata.length!==(ue._fullData||[]).length;Oe&&o.doCalcdata(ue);for(var je=0;je<ue.calcdata.length;je++)ue.calcdata[je][0].trace=ue._fullData[je];ue._context.responsive?ue._responsiveChartHandler||(ue._responsiveChartHandler=function(){p.isHidden(ue)||o.resize(ue)},window.addEventListener("resize",ue._responsiveChartHandler)):p.clearResponsive(ue);var We=p.extendFlat({},Ye._size),Ge=0;function Qe(){if(o.clearAutoMarginIds(ue),x.drawMarginPushers(ue),a.allowAutoMargin(ue),Ye._has("pie"))for(var wt=ue._fullData,rt=0;rt<wt.length;rt++){var $e=wt[rt];$e.type==="pie"&&$e.automargin&&o.allowAutoMargin(ue,"pie."+$e.uid+".automargin")}return o.doAutoMargin(ue),o.previousPromises(ue)}function it(){ue._transitioning||(x.doAutoRangeAndConstraints(ue),Fe&&a.saveRangeInitial(ue),i.getComponentMethod("rangeslider","calcAutorange")(ue))}var lt=[o.previousPromises,function(){if(Se)return H.addFrames(ue,Se)},function wt(){for(var rt=Ye._basePlotModules,$e=0;$e<rt.length;$e++)rt[$e].drawFramework&&rt[$e].drawFramework(ue);!Ye._glcanvas&&Ye._has("gl")&&(Ye._glcanvas=Ye._glcontainer.selectAll(".gl-canvas").data([{key:"contextLayer",context:!0,pick:!1},{key:"focusLayer",context:!1,pick:!1},{key:"pickLayer",context:!1,pick:!0}],function(Ue){return Ue.key}),Ye._glcanvas.enter().append("canvas").attr("class",function(Ue){return"gl-canvas gl-canvas-"+Ue.key.replace("Layer","")}).style({position:"absolute",top:0,left:0,overflow:"visible","pointer-events":"none"}));var xt=ue._context.plotGlPixelRatio;if(Ye._glcanvas){Ye._glcanvas.attr("width",Ye.width*xt).attr("height",Ye.height*xt).style("width",Ye.width+"px").style("height",Ye.height+"px");var Qt=Ye._glcanvas.data()[0].regl;if(Qt&&(Math.floor(Ye.width*xt)!==Qt._gl.drawingBufferWidth||Math.floor(Ye.height*xt)!==Qt._gl.drawingBufferHeight)){var $t="WebGL context buffer and canvas dimensions do not match due to browser/WebGL bug.";if(!Ge)return p.log($t+" Clearing graph and plotting again."),o.cleanPlot([],{},ue._fullData,Ye),o.supplyDefaults(ue),Ye=ue._fullLayout,o.doCalcdata(ue),Ge++,wt();p.error($t)}}return Ye.modebar.orientation==="h"?Ye._modebardiv.style("height",null).style("width","100%"):Ye._modebardiv.style("width",null).style("height",Ye.height+"px"),o.previousPromises(ue)},Qe,function(){if(o.didMarginChange(We,Ye._size))return p.syncOrAsync([Qe,x.layoutStyles],ue)}];et&&lt.push(function(){if(Oe)return p.syncOrAsync([i.getComponentMethod("shapes","calcAutorange"),i.getComponentMethod("annotations","calcAutorange"),it],ue);it()}),lt.push(x.layoutStyles),et&&lt.push(function(){return a.draw(ue,Fe?"":"redraw")},function(wt){wt._fullLayout._insideTickLabelsAutorange&&K(wt,wt._fullLayout._insideTickLabelsAutorange).then(function(){wt._fullLayout._insideTickLabelsAutorange=void 0})}),lt.push(x.drawData,x.finalDraw,n,o.addLinks,o.rehover,o.redrag,o.doAutoMargin,function(wt){wt._fullLayout._insideTickLabelsAutorange&&Fe&&a.saveRangeInitial(wt,!0)},o.previousPromises);var Lt=p.syncOrAsync(lt,ue);return Lt&&Lt.then||(Lt=Promise.resolve()),Lt.then(function(){return w(ue),ue})},H.purge=function(ue){var me=(ue=p.getGraphDiv(ue))._fullLayout||{},we=ue._fullData||[];return o.cleanPlot([],{},we,me),o.purge(ue),f.purge(ue),me._container&&me._container.remove(),delete ue._context,ue},H.react=function(ue,me,we,Me){var Se,De;ue=p.getGraphDiv(ue),_.clearPromiseQueue(ue);var Fe=ue._fullData,Ye=ue._fullLayout;if(p.isPlotDiv(ue)&&Fe&&Ye){if(p.isPlainObject(me)){var et=me;me=et.data,we=et.layout,Me=et.config,Se=et.frames}var Oe=!1;if(Me){var je=p.extendDeep({},ue._context);ue._context=void 0,C(ue,Me),Oe=function Ce(Pe,Xe){var ut;for(ut in Pe)if(ut.charAt(0)!=="_"){var kt=Pe[ut],ft=Xe[ut];if(kt!==ft)if(p.isPlainObject(kt)&&p.isPlainObject(ft)){if(Ce(kt,ft))return!0}else{if(!Array.isArray(kt)||!Array.isArray(ft)||kt.length!==ft.length)return!0;for(var Et=0;Et<kt.length;Et++)if(kt[Et]!==ft[Et]&&(!p.isPlainObject(kt[Et])||!p.isPlainObject(ft[Et])||Ce(kt[Et],ft[Et])))return!0}}}(je,ue._context)}ue.data=me||[],_.cleanData(ue.data),ue.layout=we||{},_.cleanLayout(ue.layout),function(Ce,Pe,Xe,ut){var kt,ft,Et,mt,It,vt,nt,At,Ft=ut._preGUI,Nt=[],Kt={};for(kt in Ft){if(It=de(kt,he)){if(ft=It.attr||It.head+".uirevision",(mt=(Et=e(ut,ft).get())&&ce(ft,Pe))&&mt===Et&&((vt=Ft[kt])===null&&(vt=void 0),Ee(At=(nt=e(Pe,kt)).get(),vt))){At===void 0&&kt.substr(kt.length-9)==="autorange"&&Nt.push(kt.substr(0,kt.length-10)),nt.set(Z(e(ut,kt).get()));continue}}else p.warn("unrecognized GUI edit: "+kt);delete Ft[kt],kt.substr(kt.length-8,6)==="range["&&(Kt[kt.substr(0,kt.length-9)]=1)}for(var Ie=0;Ie<Nt.length;Ie++){var ot=Nt[Ie];if(Kt[ot]){var bt=e(Pe,ot).get();bt&&delete bt.autorange}}var Pt=ut._tracePreGUI;for(var Vt in Pt){var nr,Yt=Pt[Vt],Xt=null;for(kt in Yt){if(!Xt){var ar=ve(Vt,Xe);if(ar<0){delete Pt[Vt];break}var hr=ke(Vt,Ce,(nr=Xe[ar]._fullInput).index);if(hr<0){delete Pt[Vt];break}Xt=Ce[hr]}if(It=de(kt,se)){if(It.attr?mt=(Et=e(ut,It.attr).get())&&ce(It.attr,Pe):(Et=nr.uirevision,(mt=Xt.uirevision)===void 0&&(mt=Pe.uirevision)),mt&&mt===Et&&((vt=Yt[kt])===null&&(vt=void 0),Ee(At=(nt=e(Xt,kt)).get(),vt))){nt.set(Z(e(nr,kt).get()));continue}}else p.warn("unrecognized GUI edit: "+kt+" in trace uid "+Vt);delete Yt[kt]}}}(ue.data,ue.layout,Fe,Ye),o.supplyDefaults(ue,{skipUpdateCalc:!0});var We=ue._fullData,Ge=ue._fullLayout,Qe=Ge.datarevision===void 0,it=Ge.transition,lt=function(Ce,Pe,Xe,ut,kt){var ft=T.layoutFlags();function Et(mt){return s.getLayoutValObject(Xe,mt)}return ft.arrays={},ft.rangesAltered={},ft.nChanges=0,ft.nChangesAnim=0,be(Pe,Xe,[],{getValObject:Et,flags:ft,immutable:ut,transition:kt,gd:Ce}),(ft.plot||ft.calc)&&(ft.layoutReplot=!0),kt&&ft.nChanges&&ft.nChangesAnim&&(ft.anim=ft.nChanges===ft.nChangesAnim?"all":"some"),ft}(ue,Ye,Ge,Qe,it),Lt=lt.newDataRevision,wt=function(Ce,Pe,Xe,ut,kt,ft){var Et=Pe.length===Xe.length;if(!kt&&!Et)return{fullReplot:!0,calc:!0};var mt,It,vt=T.traceFlags();vt.arrays={},vt.nChanges=0,vt.nChangesAnim=0;var nt={getValObject:function(Ft){var Nt=s.getTraceValObject(It,Ft);return!It._module.animatable&&Nt.anim&&(Nt.anim=!1),Nt},flags:vt,immutable:ut,transition:kt,newDataRevision:ft,gd:Ce},At={};for(mt=0;mt<Pe.length;mt++)if(Xe[mt]){if(It=Xe[mt]._fullInput,o.hasMakesDataTransform(It)&&(It=Xe[mt]),At[It.uid])continue;At[It.uid]=1,be(Pe[mt]._fullInput,It,[],nt)}return(vt.calc||vt.plot)&&(vt.fullReplot=!0),kt&&vt.nChanges&&vt.nChangesAnim&&(vt.anim=vt.nChanges===vt.nChangesAnim&&Et?"all":"some"),vt}(ue,Fe,We,Qe,it,Lt);if(te(ue)&&(lt.layoutReplot=!0),wt.calc||lt.calc){ue.calcdata=void 0;for(var rt=Object.getOwnPropertyNames(Ge),$e=0;$e<rt.length;$e++){var xt=rt[$e],Qt=xt.substring(0,5);if(Qt==="xaxis"||Qt==="yaxis"){var $t=Ge[xt]._emptyCategories;$t&&$t()}}}else o.supplyDefaultsUpdateCalc(ue.calcdata,We);var Ue=[];if(Se&&(ue._transitionData={},o.createTransitionData(ue),Ue.push(function(){return H.addFrames(ue,Se)})),Ge.transition&&!Oe&&(wt.anim||lt.anim))lt.ticks&&Ue.push(x.doTicksRelayout),o.doCalcdata(ue),x.doAutoRangeAndConstraints(ue),Ue.push(function(){return o.transitionFromReact(ue,wt,lt,Ye)});else if(wt.fullReplot||lt.layoutReplot||Oe)ue._fullLayout._skipDefaults=!0,Ue.push(H._doPlot);else{for(var He in lt.arrays){var Be=lt.arrays[He];if(Be.length){var Je=i.getComponentMethod(He,"drawOne");if(Je!==p.noop)for(var _e=0;_e<Be.length;_e++)Je(ue,Be[_e]);else{var Le=i.getComponentMethod(He,"draw");if(Le===p.noop)throw new Error("cannot draw components: "+He);Le(ue)}}}Ue.push(o.previousPromises),wt.style&&Ue.push(x.doTraceStyle),(wt.colorbars||lt.colorbars)&&Ue.push(x.doColorBars),lt.legend&&Ue.push(x.doLegend),lt.layoutstyle&&Ue.push(x.layoutStyles),lt.axrange&&B(Ue),lt.ticks&&Ue.push(x.doTicksRelayout),lt.modebar&&Ue.push(x.doModeBar),lt.camera&&Ue.push(x.doCamera),Ue.push(w)}Ue.push(o.rehover,o.redrag),(De=p.syncOrAsync(Ue,ue))&&De.then||(De=Promise.resolve(ue))}else De=H.newPlot(ue,me,we,Me);return De.then(function(){return ue.emit("plotly_react",{data:me,layout:we}),ue})},H.redraw=function(ue){if(ue=p.getGraphDiv(ue),!p.isPlotDiv(ue))throw new Error("This element is not a Plotly plot: "+ue);return _.cleanData(ue.data),_.cleanLayout(ue.layout),ue.calcdata=void 0,H._doPlot(ue).then(function(){return ue.emit("plotly_redraw"),ue})},H.relayout=K,H.restyle=W,H.setPlotConfig=function(ue){return p.extendFlat(y,ue)},H.update=ie,H._guiRelayout=ae(K),H._guiRestyle=ae(W),H._guiUpdate=ae(ie),H._storeDirectGUIEdit=function(ue,me,we){for(var Me in we)X(Me,e(ue,Me).get(),we[Me],me)}},{"../components/color":650,"../components/drawing":672,"../constants/xmlns_namespaces":764,"../lib":787,"../lib/events":776,"../lib/queue":803,"../plots/cartesian/axes":838,"../plots/cartesian/constants":845,"../plots/cartesian/graph_interact":848,"../plots/cartesian/select":858,"../plots/plots":901,"../registry":915,"./edit_types":820,"./helpers":821,"./manage_arrays":823,"./plot_config":825,"./plot_schema":826,"./subroutines":828,"@plotly/d3":58,"fast-isnumeric":246,"has-hover":435}],825:[function(h,N,H){var t={staticPlot:{valType:"boolean",dflt:!1},plotlyServerURL:{valType:"string",dflt:""},editable:{valType:"boolean",dflt:!1},edits:{annotationPosition:{valType:"boolean",dflt:!1},annotationTail:{valType:"boolean",dflt:!1},annotationText:{valType:"boolean",dflt:!1},axisTitleText:{valType:"boolean",dflt:!1},colorbarPosition:{valType:"boolean",dflt:!1},colorbarTitleText:{valType:"boolean",dflt:!1},legendPosition:{valType:"boolean",dflt:!1},legendText:{valType:"boolean",dflt:!1},shapePosition:{valType:"boolean",dflt:!1},titleText:{valType:"boolean",dflt:!1}},autosizable:{valType:"boolean",dflt:!1},responsive:{valType:"boolean",dflt:!1},fillFrame:{valType:"boolean",dflt:!1},frameMargins:{valType:"number",dflt:0,min:0,max:.5},scrollZoom:{valType:"flaglist",flags:["cartesian","gl3d","geo","mapbox"],extras:[!0,!1],dflt:"gl3d+geo+mapbox"},doubleClick:{valType:"enumerated",values:[!1,"reset","autosize","reset+autosize"],dflt:"reset+autosize"},doubleClickDelay:{valType:"number",dflt:300,min:0},showAxisDragHandles:{valType:"boolean",dflt:!0},showAxisRangeEntryBoxes:{valType:"boolean",dflt:!0},showTips:{valType:"boolean",dflt:!0},showLink:{valType:"boolean",dflt:!1},linkText:{valType:"string",dflt:"Edit chart",noBlank:!0},sendData:{valType:"boolean",dflt:!0},showSources:{valType:"any",dflt:!1},displayModeBar:{valType:"enumerated",values:["hover",!0,!1],dflt:"hover"},showSendToCloud:{valType:"boolean",dflt:!1},showEditInChartStudio:{valType:"boolean",dflt:!1},modeBarButtonsToRemove:{valType:"any",dflt:[]},modeBarButtonsToAdd:{valType:"any",dflt:[]},modeBarButtons:{valType:"any",dflt:!1},toImageButtonOptions:{valType:"any",dflt:{}},displaylogo:{valType:"boolean",dflt:!0},watermark:{valType:"boolean",dflt:!1},plotGlPixelRatio:{valType:"number",dflt:2,min:1,max:4},setBackground:{valType:"any",dflt:"transparent"},topojsonURL:{valType:"string",noBlank:!0,dflt:"https://cdn.plot.ly/"},mapboxAccessToken:{valType:"string",dflt:null},logging:{valType:"integer",min:0,max:2,dflt:1},notifyOnLogging:{valType:"integer",min:0,max:2,dflt:0},queueLength:{valType:"integer",min:0,dflt:0},globalTransforms:{valType:"any",dflt:[]},locale:{valType:"string",dflt:"en-US"},locales:{valType:"any",dflt:{}}},m={};(function g(p,e){for(var f in p){var u=p[f];u.valType?e[f]=u.dflt:(e[f]||(e[f]={}),g(u,e[f]))}})(t,m),N.exports={configAttributes:t,dfltConfig:m}},{}],826:[function(h,N,H){var t=h("../registry"),m=h("../lib"),g=h("../plots/attributes"),p=h("../plots/layout_attributes"),e=h("../plots/frame_attributes"),f=h("../plots/animation_attributes"),u=h("./plot_config").configAttributes,i=h("./edit_types"),s=m.extendDeepAll,o=m.isPlainObject,a=m.isArrayOrTypedArray,c=m.nestedProperty,r=m.valObjectMeta,n=["_isSubplotObj","_isLinkedToArray","_arrayAttrRegexps","_deprecated"];function d(A,S,w){if(!A)return!1;if(A._isLinkedToArray){if(l(S[w]))w++;else if(w<S.length)return!1}for(;w<S.length;w++){var L=A[S[w]];if(!o(L)||(A=L,w===S.length-1))break;if(A._isLinkedToArray){if(!l(S[++w]))return!1}else if(A.valType==="info_array"){var k=S[++w];if(!l(k))return!1;var C=A.items;if(Array.isArray(C)){if(k>=C.length)return!1;if(A.dimensions===2){if(w++,S.length===w)return A;var M=S[w];if(!l(M))return!1;A=C[k][M]}else A=C[k]}else A=C}}return A}function l(A){return A===Math.round(A)&&A>=0}function y(){var A,S,w={};for(A in s(w,p),t.subplotsRegistry)if((S=t.subplotsRegistry[A]).layoutAttributes)if(Array.isArray(S.attr))for(var L=0;L<S.attr.length;L++)x(w,S,S.attr[L]);else x(w,S,S.attr==="subplot"?S.name:S.attr);for(A in t.componentsRegistry){var k=(S=t.componentsRegistry[A]).schema;if(k&&(k.subplots||k.layout)){var C=k.subplots;if(C&&C.xaxis&&!C.yaxis)for(var M in C.xaxis)delete w.yaxis[M]}else S.name==="colorscale"?s(w,S.layoutAttributes):S.layoutAttributes&&T(w,S.layoutAttributes,S.name)}return{layoutAttributes:_(w)}}function v(){var A={frames:s({},e)};return _(A),A.frames}function _(A){return function(S){H.crawl(S,function(w,L,k){H.isValObject(w)?w.arrayOk!==!0&&w.valType!=="data_array"||(k[L+"src"]={valType:"string",editType:"none"}):o(w)&&(w.role="object")})}(A),function(S){H.crawl(S,function(w,L,k){if(w){var C=w._isLinkedToArray;C&&(delete w._isLinkedToArray,k[L]={items:{}},k[L].items[C]=w,k[L].role="object")}})}(A),function(S){(function w(L){for(var k in L)if(o(L[k]))w(L[k]);else if(Array.isArray(L[k]))for(var C=0;C<L[k].length;C++)w(L[k][C]);else L[k]instanceof RegExp&&(L[k]=L[k].toString())})(S)}(A),A}function x(A,S,w){var L=c(A,w),k=s({},S.layoutAttributes);k._isSubplotObj=!0,L.set(k)}function T(A,S,w){var L=c(A,w);L.set(s(L.get()||{},S))}H.IS_SUBPLOT_OBJ="_isSubplotObj",H.IS_LINKED_TO_ARRAY="_isLinkedToArray",H.DEPRECATED="_deprecated",H.UNDERSCORE_ATTRS=n,H.get=function(){var A={};t.allTypes.forEach(function(w){A[w]=function(L){var k,C;k=t.modules[L]._module,C=k.basePlotModule;var M={type:null},P=s({},g),O=s({},k.attributes);H.crawl(O,function(W,Z,Q,X,G){c(P,G).set(void 0),W===void 0&&c(O,G).set(void 0)}),s(M,P),t.traceIs(L,"noOpacity")&&delete M.opacity,t.traceIs(L,"showLegend")||(delete M.showlegend,delete M.legendgroup),t.traceIs(L,"noHover")&&(delete M.hoverinfo,delete M.hoverlabel),k.selectPoints||delete M.selectedpoints,s(M,O),C.attributes&&s(M,C.attributes),M.type=L;var F={meta:k.meta||{},categories:k.categories||{},animatable:Boolean(k.animatable),type:L,attributes:_(M)};if(k.layoutAttributes){var j={};s(j,k.layoutAttributes),F.layoutAttributes=_(j)}return k.animatable||H.crawl(F,function(W){H.isValObject(W)&&"anim"in W&&delete W.anim}),F}(w)});var S={};return Object.keys(t.transformsRegistry).forEach(function(w){S[w]=function(L){var k=t.transformsRegistry[L],C=s({},k.attributes);return Object.keys(t.componentsRegistry).forEach(function(M){var P=t.componentsRegistry[M];P.schema&&P.schema.transforms&&P.schema.transforms[L]&&Object.keys(P.schema.transforms[L]).forEach(function(O){T(C,P.schema.transforms[L][O],O)})}),{attributes:_(C)}}(w)}),{defs:{valObjects:r,metaKeys:n.concat(["description","role","editType","impliedEdits"]),editType:{traces:i.traces,layout:i.layout},impliedEdits:{}},traces:A,layout:y(),transforms:S,frames:v(),animation:_(f),config:_(u)}},H.crawl=function(A,S,w,L){var k=w||0;L=L||"",Object.keys(A).forEach(function(C){var M=A[C];if(n.indexOf(C)===-1){var P=(L?L+".":"")+C;S(M,C,A,k,P),H.isValObject(M)||o(M)&&C!=="impliedEdits"&&H.crawl(M,S,k+1,P)}})},H.isValObject=function(A){return A&&A.valType!==void 0},H.findArrayAttributes=function(A){var S,w,L=[],k=[],C=[];function M(W,Z,Q,X){k=k.slice(0,X).concat([Z]),C=C.slice(0,X).concat([W&&W._isLinkedToArray]),W&&(W.valType==="data_array"||W.arrayOk===!0)&&!(k[X-1]==="colorbar"&&(Z==="ticktext"||Z==="tickvals"))&&function G(Y,K,D){var B=Y[k[K]],q=D+k[K];if(K===k.length-1)a(B)&&L.push(w+q);else if(C[K]){if(Array.isArray(B))for(var ee=0;ee<B.length;ee++)o(B[ee])&&G(B[ee],K+1,q+"["+ee+"].")}else o(B)&&G(B,K+1,q+".")}(S,0,"")}S=A,w="",H.crawl(g,M),A._module&&A._module.attributes&&H.crawl(A._module.attributes,M);var P=A.transforms;if(P)for(var O=0;O<P.length;O++){var F=P[O],j=F._module;j&&(w="transforms["+O+"].",S=F,H.crawl(j.attributes,M))}return L},H.getTraceValObject=function(A,S){var w,L,k=S[0],C=1;if(k==="transforms"){if(S.length===1)return g.transforms;var M=A.transforms;if(!Array.isArray(M)||!M.length)return!1;var P=S[1];if(!l(P)||P>=M.length)return!1;L=(w=(t.transformsRegistry[M[P].type]||{}).attributes)&&w[S[2]],C=3}else{var O=A._module;if(O||(O=(t.modules[A.type||g.type.dflt]||{})._module),!O)return!1;if(!(L=(w=O.attributes)&&w[k])){var F=O.basePlotModule;F&&F.attributes&&(L=F.attributes[k])}L||(L=g[k])}return d(L,S,C)},H.getLayoutValObject=function(A,S){return d(function(w,L){var k,C,M,P,O=w._basePlotModules;if(O){var F;for(k=0;k<O.length;k++){if((M=O[k]).attrRegex&&M.attrRegex.test(L)){if(M.layoutAttrOverrides)return M.layoutAttrOverrides;!F&&M.layoutAttributes&&(F=M.layoutAttributes)}var j=M.baseLayoutAttrOverrides;if(j&&L in j)return j[L]}if(F)return F}var W=w._modules;if(W){for(k=0;k<W.length;k++)if((P=W[k].layoutAttributes)&&L in P)return P[L]}for(C in t.componentsRegistry){if((M=t.componentsRegistry[C]).name==="colorscale"&&L.indexOf("coloraxis")===0)return M.layoutAttributes[L];if(!M.schema&&L===M.name)return M.layoutAttributes}return L in p&&p[L]}(A,S[0]),S,1)}},{"../lib":787,"../plots/animation_attributes":832,"../plots/attributes":834,"../plots/frame_attributes":868,"../plots/layout_attributes":892,"../registry":915,"./edit_types":820,"./plot_config":825}],827:[function(h,N,H){var t=h("../lib"),m=h("../plots/attributes"),g={name:{valType:"string",editType:"none"}};function p(f){return f&&typeof f=="string"}function e(f){var u=f.length-1;return f.charAt(u)!=="s"&&t.warn("bad argument to arrayDefaultKey: "+f),f.substr(0,f.length-1)+"defaults"}g.templateitemname={valType:"string",editType:"calc"},H.templatedArray=function(f,u){return u._isLinkedToArray=f,u.name=g.name,u.templateitemname=g.templateitemname,u},H.traceTemplater=function(f){var u,i,s={};for(u in f)i=f[u],Array.isArray(i)&&i.length&&(s[u]=0);return{newTrace:function(o){var a={type:u=t.coerce(o,{},m,"type"),_template:null};if(u in s){i=f[u];var c=s[u]%i.length;s[u]++,a._template=i[c]}return a}}},H.newContainer=function(f,u,i){var s=f._template,o=s&&(s[u]||i&&s[i]);return t.isPlainObject(o)||(o=null),f[u]={_template:o}},H.arrayTemplater=function(f,u,i){var s=f._template,o=s&&s[e(u)],a=s&&s[u];Array.isArray(a)&&a.length||(a=[]);var c={};return{newItem:function(r){var n={name:r.name,_input:r},d=n.templateitemname=r.templateitemname;if(!p(d))return n._template=o,n;for(var l=0;l<a.length;l++){var y=a[l];if(y.name===d)return c[d]=1,n._template=y,n}return n[i]=r[i]||!1,n._template=!1,n},defaultItems:function(){for(var r=[],n=0;n<a.length;n++){var d=a[n],l=d.name;if(p(l)&&!c[l]){var y={_template:d,name:l,_input:{_templateitemname:l}};y.templateitemname=d.templateitemname,r.push(y),c[l]=1}}return r}}},H.arrayDefaultKey=e,H.arrayEditor=function(f,u,i){var s=(t.nestedProperty(f,u).get()||[]).length,o=i._index,a=o>=s&&(i._input||{})._templateitemname;a&&(o=s);var c,r=u+"["+o+"]";function n(){c={},a&&(c[r]={},c[r].templateitemname=a)}function d(y,v){a?t.nestedProperty(c[r],y).set(v):c[r+"."+y]=v}function l(){var y=c;return n(),y}return n(),{modifyBase:function(y,v){c[y]=v},modifyItem:d,getUpdateObj:l,applyUpdate:function(y,v){y&&d(y,v);var _=l();for(var x in _)t.nestedProperty(f,x).set(_[x])}}}},{"../lib":787,"../plots/attributes":834}],828:[function(h,N,H){var t=h("@plotly/d3"),m=h("../registry"),g=h("../plots/plots"),p=h("../lib"),e=h("../lib/clear_gl_canvases"),f=h("../components/color"),u=h("../components/drawing"),i=h("../components/titles"),s=h("../components/modebar"),o=h("../plots/cartesian/axes"),a=h("../constants/alignment"),c=h("../plots/cartesian/constraints"),r=c.enforce,n=c.clean,d=h("../plots/cartesian/autorange").doAutoRange;function l(S,w,L){for(var k=0;k<L.length;k++){var C=L[k][0],M=L[k][1];if(!(C[0]>=S[1]||C[1]<=S[0])&&M[0]<w[1]&&M[1]>w[0])return!0}return!1}function y(S){var w,L,k,C,M,P,O=S._fullLayout,F=O._size,j=F.p,W=o.list(S,"",!0);if(O._paperdiv.style({width:S._context.responsive&&O.autosize&&!S._context._hasZeroWidth&&!S.layout.width?"100%":O.width+"px",height:S._context.responsive&&O.autosize&&!S._context._hasZeroHeight&&!S.layout.height?"100%":O.height+"px"}).selectAll(".main-svg").call(u.setSize,O.width,O.height),S._context.setBackground(S,O.paper_bgcolor),H.drawMainTitle(S),s.manage(S),!O._has("cartesian"))return g.previousPromises(S);function Z(Ge,Qe,it){var lt=Ge._lw/2;return Ge._id.charAt(0)==="x"?Qe?it==="top"?Qe._offset-j-lt:Qe._offset+Qe._length+j+lt:F.t+F.h*(1-(Ge.position||0))+lt%1:Qe?it==="right"?Qe._offset+Qe._length+j+lt:Qe._offset-j-lt:F.l+F.w*(Ge.position||0)+lt%1}for(w=0;w<W.length;w++){var Q=(C=W[w])._anchorAxis;C._linepositions={},C._lw=u.crispRound(S,C.linewidth,1),C._mainLinePosition=Z(C,Q,C.side),C._mainMirrorPosition=C.mirror&&Q?Z(C,Q,a.OPPOSITE_SIDE[C.side]):null}var X=[],G=[],Y=[],K=f.opacity(O.paper_bgcolor)===1&&f.opacity(O.plot_bgcolor)===1&&O.paper_bgcolor===O.plot_bgcolor;for(L in O._plots)if((k=O._plots[L]).mainplot)k.bg&&k.bg.remove(),k.bg=void 0;else{var D=k.xaxis.domain,B=k.yaxis.domain,q=k.plotgroup;if(l(D,B,Y)){var ee=q.node(),J=k.bg=p.ensureSingle(q,"rect","bg");ee.insertBefore(J.node(),ee.childNodes[0]),G.push(L)}else q.select("rect.bg").remove(),Y.push([D,B]),K||(X.push(L),G.push(L))}var $,te,ie,ae,he,se,de,ce,ve,ke,Ee,be,xe,ue=O._bgLayer.selectAll(".bg").data(X);for(ue.enter().append("rect").classed("bg",!0),ue.exit().remove(),ue.each(function(Ge){O._plots[Ge].bg=t.select(this)}),w=0;w<G.length;w++)k=O._plots[G[w]],M=k.xaxis,P=k.yaxis,k.bg&&M._offset!==void 0&&P._offset!==void 0&&k.bg.call(u.setRect,M._offset-j,P._offset-j,M._length+2*j,P._length+2*j).call(f.fill,O.plot_bgcolor).style("stroke-width",0);if(!O._hasOnlyLargeSploms)for(L in O._plots){k=O._plots[L],M=k.xaxis,P=k.yaxis;var me,we,Me=k.clipId="clip"+O._uid+L+"plot",Se=p.ensureSingleById(O._clips,"clipPath",Me,function(Ge){Ge.classed("plotclip",!0).append("rect")});k.clipRect=Se.select("rect").attr({width:M._length,height:P._length}),u.setTranslate(k.plot,M._offset,P._offset),k._hasClipOnAxisFalse?(me=null,we=Me):(me=Me,we=null),u.setClipUrl(k.plot,me,S),k.layerClipId=we}function De(Ge){return"M"+$+","+Ge+"H"+te}function Fe(Ge){return"M"+M._offset+","+Ge+"h"+M._length}function Ye(Ge){return"M"+Ge+","+ce+"V"+de}function et(Ge){return"M"+Ge+","+P._offset+"v"+P._length}function Oe(Ge,Qe,it){if(!Ge.showline||L!==Ge._mainSubplot)return"";if(!Ge._anchorAxis)return it(Ge._mainLinePosition);var lt=Qe(Ge._mainLinePosition);return Ge.mirror&&(lt+=Qe(Ge._mainMirrorPosition)),lt}for(L in O._plots){k=O._plots[L],M=k.xaxis,P=k.yaxis;var je="M0,0";v(M,L)&&(he=x(M,"left",P,W),$=M._offset-(he?j+he:0),se=x(M,"right",P,W),te=M._offset+M._length+(se?j+se:0),ie=Z(M,P,"bottom"),ae=Z(M,P,"top"),!(xe=!M._anchorAxis||L!==M._mainSubplot)||M.mirror!=="allticks"&&M.mirror!=="all"||(M._linepositions[L]=[ie,ae]),je=Oe(M,De,Fe),xe&&M.showline&&(M.mirror==="all"||M.mirror==="allticks")&&(je+=De(ie)+De(ae)),k.xlines.style("stroke-width",M._lw+"px").call(f.stroke,M.showline?M.linecolor:"rgba(0,0,0,0)")),k.xlines.attr("d",je);var We="M0,0";v(P,L)&&(Ee=x(P,"bottom",M,W),de=P._offset+P._length+(Ee?j:0),be=x(P,"top",M,W),ce=P._offset-(be?j:0),ve=Z(P,M,"left"),ke=Z(P,M,"right"),!(xe=!P._anchorAxis||L!==P._mainSubplot)||P.mirror!=="allticks"&&P.mirror!=="all"||(P._linepositions[L]=[ve,ke]),We=Oe(P,Ye,et),xe&&P.showline&&(P.mirror==="all"||P.mirror==="allticks")&&(We+=Ye(ve)+Ye(ke)),k.ylines.style("stroke-width",P._lw+"px").call(f.stroke,P.showline?P.linecolor:"rgba(0,0,0,0)")),k.ylines.attr("d",We)}return o.makeClipPaths(S),g.previousPromises(S)}function v(S,w){return(S.ticks||S.showline)&&(w===S._mainSubplot||S.mirror==="all"||S.mirror==="allticks")}function _(S,w,L){if(!L.showline||!L._lw)return!1;if(L.mirror==="all"||L.mirror==="allticks")return!0;var k=L._anchorAxis;if(!k)return!1;var C=a.FROM_BL[w];return L.side===w?k.domain[C]===S.domain[C]:L.mirror&&k.domain[1-C]===S.domain[1-C]}function x(S,w,L,k){if(_(S,w,L))return L._lw;for(var C=0;C<k.length;C++){var M=k[C];if(M._mainAxis===L._mainAxis&&_(S,w,M))return M._lw}return 0}function T(S,w){var L=S.title,k=S._size,C=0;switch(w==="start"?C=L.pad.l:w==="end"&&(C=-L.pad.r),L.xref){case"paper":return k.l+k.w*L.x+C;case"container":default:return S.width*L.x+C}}function A(S,w){var L=S.title,k=S._size,C=0;if(w!=="0em"&&w?w===a.CAP_SHIFT+"em"&&(C=L.pad.t):C=-L.pad.b,L.y==="auto")return k.t/2;switch(L.yref){case"paper":return k.t+k.h-k.h*L.y+C;case"container":default:return S.height-S.height*L.y+C}}H.layoutStyles=function(S){return p.syncOrAsync([g.doAutoMargin,y],S)},H.drawMainTitle=function(S){var w=S._fullLayout,L=function(C){var M=C.title,P="middle";return p.isRightAnchor(M)?P="end":p.isLeftAnchor(M)&&(P="start"),P}(w),k=function(C){var M=C.title,P="0em";return p.isTopAnchor(M)?P=a.CAP_SHIFT+"em":p.isMiddleAnchor(M)&&(P=a.MID_SHIFT+"em"),P}(w);i.draw(S,"gtitle",{propContainer:w,propName:"title.text",placeholder:w._dfltTitle.plot,attributes:{x:T(w,L),y:A(w,k),"text-anchor":L,dy:k}})},H.doTraceStyle=function(S){var w,L=S.calcdata,k=[];for(w=0;w<L.length;w++){var C=L[w],M=C[0]||{},P=M.trace||{},O=P._module||{},F=O.arraysToCalcdata;F&&F(C,P);var j=O.editStyle;j&&k.push({fn:j,cd0:M})}if(k.length){for(w=0;w<k.length;w++){var W=k[w];W.fn(S,W.cd0)}e(S),H.redrawReglTraces(S)}return g.style(S),m.getComponentMethod("legend","draw")(S),g.previousPromises(S)},H.doColorBars=function(S){return m.getComponentMethod("colorbar","draw")(S),g.previousPromises(S)},H.layoutReplot=function(S){var w=S.layout;return S.layout=void 0,m.call("_doPlot",S,"",w)},H.doLegend=function(S){return m.getComponentMethod("legend","draw")(S),g.previousPromises(S)},H.doTicksRelayout=function(S){return o.draw(S,"redraw"),S._fullLayout._hasOnlyLargeSploms&&(m.subplotsRegistry.splom.updateGrid(S),e(S),H.redrawReglTraces(S)),H.drawMainTitle(S),g.previousPromises(S)},H.doModeBar=function(S){var w=S._fullLayout;s.manage(S);for(var L=0;L<w._basePlotModules.length;L++){var k=w._basePlotModules[L].updateFx;k&&k(S)}return g.previousPromises(S)},H.doCamera=function(S){for(var w=S._fullLayout,L=w._subplots.gl3d,k=0;k<L.length;k++){var C=w[L[k]];C._scene.setViewport(C)}},H.drawData=function(S){var w=S._fullLayout;e(S);for(var L=w._basePlotModules,k=0;k<L.length;k++)L[k].plot(S);return H.redrawReglTraces(S),g.style(S),m.getComponentMethod("shapes","draw")(S),m.getComponentMethod("annotations","draw")(S),m.getComponentMethod("images","draw")(S),w._replotting=!1,g.previousPromises(S)},H.redrawReglTraces=function(S){var w=S._fullLayout;if(w._has("regl")){var L,k,C=S._fullData,M=[],P=[];for(w._hasOnlyLargeSploms&&w._splomGrid.draw(),L=0;L<C.length;L++){var O=C[L];O.visible===!0&&O._length!==0&&(O.type==="splom"?w._splomScenes[O.uid].draw():O.type==="scattergl"?p.pushUnique(M,O.xaxis+O.yaxis):O.type==="scatterpolargl"&&p.pushUnique(P,O.subplot))}for(L=0;L<M.length;L++)(k=w._plots[M[L]])._scene&&k._scene.draw();for(L=0;L<P.length;L++)(k=w[P[L]]._subplot)._scene&&k._scene.draw()}},H.doAutoRangeAndConstraints=function(S){for(var w,L=o.list(S,"",!0),k={},C=0;C<L.length;C++)if(!k[(w=L[C])._id]){k[w._id]=1,n(S,w),d(S,w);var M=w._matchGroup;if(M)for(var P in M){var O=o.getFromId(S,P);d(S,O,w.range),k[P]=1}}r(S)},H.finalDraw=function(S){m.getComponentMethod("rangeslider","draw")(S),m.getComponentMethod("rangeselector","draw")(S)},H.drawMarginPushers=function(S){m.getComponentMethod("legend","draw")(S),m.getComponentMethod("rangeselector","draw")(S),m.getComponentMethod("sliders","draw")(S),m.getComponentMethod("updatemenus","draw")(S),m.getComponentMethod("colorbar","draw")(S)}},{"../components/color":650,"../components/drawing":672,"../components/modebar":713,"../components/titles":748,"../constants/alignment":755,"../lib":787,"../lib/clear_gl_canvases":771,"../plots/cartesian/autorange":837,"../plots/cartesian/axes":838,"../plots/cartesian/constraints":846,"../plots/plots":901,"../registry":915,"@plotly/d3":58}],829:[function(h,N,H){var t=h("../lib"),m=t.isPlainObject,g=h("./plot_schema"),p=h("../plots/plots"),e=h("../plots/attributes"),f=h("./plot_template"),u=h("./plot_config").dfltConfig;function i(l,y){l=t.extendDeep({},l);var v,_,x=Object.keys(l).sort();function T(k,C,M){if(m(C)&&m(k))i(k,C);else if(Array.isArray(C)&&Array.isArray(k)){var P=f.arrayTemplater({_template:l},M);for(_=0;_<C.length;_++){var O=C[_],F=P.newItem(O)._template;F&&i(F,O)}var j=P.defaultItems();for(_=0;_<j.length;_++)C.push(j[_]._template);for(_=0;_<C.length;_++)delete C[_].templateitemname}}for(v=0;v<x.length;v++){var A=x[v],S=l[A];if(A in y?T(S,y[A],A):y[A]=S,s(A)===A)for(var w in y){var L=s(w);w===L||L!==A||w in l||T(S,y[w],A)}}}function s(l){return l.replace(/[0-9]+$/,"")}function o(l,y,v,_,x){var T=x&&v(x);for(var A in l){var S=l[A],w=r(l,A,_),L=r(l,A,x),k=v(L);if(!k){var C=s(A);C!==A&&(k=v(L=r(l,C,x)))}if((!T||T!==k)&&!(!k||k._noTemplating||k.valType==="data_array"||k.arrayOk&&Array.isArray(S)))if(!k.valType&&m(S))o(S,y,v,w,L);else if(k._isLinkedToArray&&Array.isArray(S))for(var M=!1,P=0,O={},F=0;F<S.length;F++){var j=S[F];if(m(j)){var W=j.name;if(W)O[W]||(o(j,y,v,r(S,P,w),r(S,P,L)),P++,O[W]=1);else if(!M){var Z=r(l,f.arrayDefaultKey(A),_),Q=r(S,P,w);o(j,y,v,Q,r(S,P,L));var X=t.nestedProperty(y,Q);t.nestedProperty(y,Z).set(X.get()),X.set(null),M=!0}}}else t.nestedProperty(y,w).set(S)}}function a(l,y){return g.getLayoutValObject(l,t.nestedProperty({},y).parts)}function c(l,y){return g.getTraceValObject(l,t.nestedProperty({},y).parts)}function r(l,y,v){return v?Array.isArray(l)?v+"["+y+"]":v+"."+y:y}function n(l){for(var y=0;y<l.length;y++)if(m(l[y]))return!0}function d(l){var y;switch(l.code){case"data":y="The template has no key data.";break;case"layout":y="The template has no key layout.";break;case"missing":y=l.path?"There are no templates for item "+l.path+" with name "+l.templateitemname:"There are no templates for trace "+l.index+", of type "+l.traceType+".";break;case"unused":y=l.path?"The template item at "+l.path+" was not used in constructing the plot.":l.dataCount?"Some of the templates of type "+l.traceType+" were not used. The template has "+l.templateCount+" traces, the data only has "+l.dataCount+" of this type.":"The template has "+l.templateCount+" traces of type "+l.traceType+" but there are none in the data.";break;case"reused":y="Some of the templates of type "+l.traceType+" were used more than once. The template has "+l.templateCount+" traces, the data has "+l.dataCount+" of this type."}return l.msg=y,l}H.makeTemplate=function(l){l=t.isPlainObject(l)?l:t.getGraphDiv(l),l=t.extendDeep({_context:u},{data:l.data,layout:l.layout}),p.supplyDefaults(l);var y=l.data||[],v=l.layout||{};v._basePlotModules=l._fullLayout._basePlotModules,v._modules=l._fullLayout._modules;var _={data:{},layout:{}};y.forEach(function(P){var O={};o(P,O,c.bind(null,P));var F=t.coerce(P,{},e,"type"),j=_.data[F];j||(j=_.data[F]=[]),j.push(O)}),o(v,_.layout,a.bind(null,v)),delete _.layout.template;var x=v.template;if(m(x)){var T,A,S,w,L,k,C=x.layout;m(C)&&i(C,_.layout);var M=x.data;if(m(M)){for(A in _.data)if(S=M[A],Array.isArray(S)){for(k=(L=_.data[A]).length,w=S.length,T=0;T<k;T++)i(S[T%w],L[T]);for(T=k;T<w;T++)L.push(t.extendDeep({},S[T]))}for(A in M)A in _.data||(_.data[A]=t.extendDeep([],M[A]))}}return _},H.validateTemplate=function(l,y){var v=t.extendDeep({},{_context:u,data:l.data,layout:l.layout}),_=v.layout||{};m(y)||(y=_.template||{});var x=y.layout,T=y.data,A=[];v.layout=_,v.layout.template=y,p.supplyDefaults(v);var S=v._fullLayout,w=v._fullData,L={};if(m(x)?(function j(W,Z){for(var Q in W)if(Q.charAt(0)!=="_"&&m(W[Q])){var X,G=s(Q),Y=[];for(X=0;X<Z.length;X++)Y.push(r(W,Q,Z[X])),G!==Q&&Y.push(r(W,G,Z[X]));for(X=0;X<Y.length;X++)L[Y[X]]=1;j(W[Q],Y)}}(S,["layout"]),function j(W,Z){for(var Q in W)if(Q.indexOf("defaults")===-1&&m(W[Q])){var X=r(W,Q,Z);L[X]?j(W[Q],X):A.push({code:"unused",path:X})}}(x,"layout")):A.push({code:"layout"}),m(T)){for(var k,C={},M=0;M<w.length;M++){var P=w[M];C[k=P.type]=(C[k]||0)+1,P._fullInput._template||A.push({code:"missing",index:P._fullInput.index,traceType:k})}for(k in T){var O=T[k].length,F=C[k]||0;O>F?A.push({code:"unused",traceType:k,templateCount:O,dataCount:F}):F>O&&A.push({code:"reused",traceType:k,templateCount:O,dataCount:F})}}else A.push({code:"data"});if(function j(W,Z){for(var Q in W)if(Q.charAt(0)!=="_"){var X=W[Q],G=r(W,Q,Z);m(X)?(Array.isArray(W)&&X._template===!1&&X.templateitemname&&A.push({code:"missing",path:G,templateitemname:X.templateitemname}),j(X,G)):Array.isArray(X)&&n(X)&&j(X,G)}}({data:w,layout:S},""),A.length)return A.map(d)}},{"../lib":787,"../plots/attributes":834,"../plots/plots":901,"./plot_config":825,"./plot_schema":826,"./plot_template":827}],830:[function(h,N,H){var t=h("fast-isnumeric"),m=h("./plot_api"),g=h("../plots/plots"),p=h("../lib"),e=h("../snapshot/helpers"),f=h("../snapshot/tosvg"),u=h("../snapshot/svgtoimg"),i=h("../version").version,s={format:{valType:"enumerated",values:["png","jpeg","webp","svg","full-json"],dflt:"png"},width:{valType:"number",min:1},height:{valType:"number",min:1},scale:{valType:"number",min:0,dflt:1},setBackground:{valType:"any",dflt:!1},imageDataOnly:{valType:"boolean",dflt:!1}};N.exports=function(o,a){var c,r,n,d;function l(F){return!(F in a)||p.validate(a[F],s[F])}if(a=a||{},p.isPlainObject(o)?(c=o.data||[],r=o.layout||{},n=o.config||{},d={}):(o=p.getGraphDiv(o),c=p.extendDeep([],o.data),r=p.extendDeep({},o.layout),n=o._context,d=o._fullLayout||{}),!l("width")&&a.width!==null||!l("height")&&a.height!==null)throw new Error("Height and width should be pixel values.");if(!l("format"))throw new Error("Export format is not "+p.join2(s.format.values,", "," or ")+".");var y={};function v(F,j){return p.coerce(a,y,s,F,j)}var _=v("format"),x=v("width"),T=v("height"),A=v("scale"),S=v("setBackground"),w=v("imageDataOnly"),L=document.createElement("div");L.style.position="absolute",L.style.left="-5000px",document.body.appendChild(L);var k=p.extendFlat({},r);x?k.width=x:a.width===null&&t(d.width)&&(k.width=d.width),T?k.height=T:a.height===null&&t(d.height)&&(k.height=d.height);var C=p.extendFlat({},n,{_exportedPlot:!0,staticPlot:!0,setBackground:S}),M=e.getRedrawFunc(L);function P(){return new Promise(function(F){setTimeout(F,e.getDelay(L._fullLayout))})}function O(){return new Promise(function(F,j){var W=f(L,_,A),Z=L._fullLayout.width,Q=L._fullLayout.height;function X(){m.purge(L),document.body.removeChild(L)}if(_==="full-json"){var G=g.graphJson(L,!1,"keepdata","object",!0,!0);return G.version=i,G=JSON.stringify(G),X(),F(w?G:e.encodeJSON(G))}if(X(),_==="svg")return F(w?W:e.encodeSVG(W));var Y=document.createElement("canvas");Y.id=p.randstr(),u({format:_,width:Z,height:Q,scale:A,canvas:Y,svg:W,promise:!0}).then(F).catch(j)})}return new Promise(function(F,j){m.newPlot(L,c,k,C).then(M).then(P).then(O).then(function(W){F(function(Z){return w?Z.replace(e.IMAGE_URL_PREFIX,""):Z}(W))}).catch(function(W){j(W)})})}},{"../lib":787,"../plots/plots":901,"../snapshot/helpers":919,"../snapshot/svgtoimg":921,"../snapshot/tosvg":923,"../version":1388,"./plot_api":824,"fast-isnumeric":246}],831:[function(h,N,H){var t=h("../lib"),m=h("../plots/plots"),g=h("./plot_schema"),p=h("./plot_config").dfltConfig,e=t.isPlainObject,f=Array.isArray,u=t.isArrayOrTypedArray;function i(y,v,_,x,T,A){A=A||[];for(var S=Object.keys(y),w=0;w<S.length;w++){var L=S[w];if(L!=="transforms"){var k=A.slice();k.push(L);var C=y[L],M=v[L],P=n(_,L),O=(P||{}).valType,F=O==="info_array",j=O==="colorscale",W=(P||{}).items;if(r(_,L))if(e(C)&&e(M)&&O!=="any")i(C,M,P,x,T,k);else if(F&&f(C)){C.length>M.length&&x.push(c("unused",T,k.concat(M.length)));var Z,Q,X,G,Y,K=M.length,D=Array.isArray(W);if(D&&(K=Math.min(K,W.length)),P.dimensions===2)for(Q=0;Q<K;Q++)if(f(C[Q])){C[Q].length>M[Q].length&&x.push(c("unused",T,k.concat(Q,M[Q].length)));var B=M[Q].length;for(Z=0;Z<(D?Math.min(B,W[Q].length):B);Z++)X=D?W[Q][Z]:W,G=C[Q][Z],Y=M[Q][Z],t.validate(G,X)?Y!==G&&Y!==+G&&x.push(c("dynamic",T,k.concat(Q,Z),G,Y)):x.push(c("value",T,k.concat(Q,Z),G))}else x.push(c("array",T,k.concat(Q),C[Q]));else for(Q=0;Q<K;Q++)X=D?W[Q]:W,G=C[Q],Y=M[Q],t.validate(G,X)?Y!==G&&Y!==+G&&x.push(c("dynamic",T,k.concat(Q),G,Y)):x.push(c("value",T,k.concat(Q),G))}else if(P.items&&!F&&f(C)){var q,ee,J=W[Object.keys(W)[0]],$=[];for(q=0;q<M.length;q++){var te=M[q]._index||q;if((ee=k.slice()).push(te),e(C[te])&&e(M[q])){$.push(te);var ie=C[te],ae=M[q];e(ie)&&ie.visible!==!1&&ae.visible===!1?x.push(c("invisible",T,ee)):i(ie,ae,J,x,T,ee)}}for(q=0;q<C.length;q++)(ee=k.slice()).push(q),e(C[q])?$.indexOf(q)===-1&&x.push(c("unused",T,ee)):x.push(c("object",T,ee,C[q]))}else!e(C)&&e(M)?x.push(c("object",T,k,C)):u(C)||!u(M)||F||j?L in v?t.validate(C,P)?P.valType==="enumerated"&&(P.coerceNumber&&C!==+M||C!==M)&&x.push(c("dynamic",T,k,C,M)):x.push(c("value",T,k,C)):x.push(c("unused",T,k,C)):x.push(c("array",T,k,C));else x.push(c("schema",T,k))}}return x}function s(y,v){for(var _=y.layout.layoutAttributes,x=0;x<v.length;x++){var T=v[x],A=y.traces[T.type],S=A.layoutAttributes;S&&(T.subplot?t.extendFlat(_[A.attributes.subplot.dflt],S):t.extendFlat(_,S))}return _}N.exports=function(y,v){y===void 0&&(y=[]),v===void 0&&(v={});var _,x,T=g.get(),A=[],S={_context:t.extendFlat({},p)};f(y)?(S.data=t.extendDeep([],y),_=y):(S.data=[],_=[],A.push(c("array","data"))),e(v)?(S.layout=t.extendDeep({},v),x=v):(S.layout={},x={},arguments.length>1&&A.push(c("object","layout"))),m.supplyDefaults(S);for(var w=S._fullData,L=_.length,k=0;k<L;k++){var C=_[k],M=["data",k];if(e(C)){var P=w[k],O=P.type,F=T.traces[O].attributes;F.type={valType:"enumerated",values:[O]},P.visible===!1&&C.visible!==!1&&A.push(c("invisible",M)),i(C,P,F,A,M);var j=C.transforms,W=P.transforms;if(j){f(j)||A.push(c("array",M,["transforms"])),M.push("transforms");for(var Z=0;Z<j.length;Z++){var Q=["transforms",Z],X=j[Z].type;if(e(j[Z])){var G=T.transforms[X]?T.transforms[X].attributes:{};G.type={valType:"enumerated",values:Object.keys(T.transforms)},i(j[Z],W[Z],G,A,M,Q)}else A.push(c("object",M,Q))}}}else A.push(c("object",M))}var Y=S._fullLayout,K=s(T,w);return i(x,Y,K,A,"layout"),A.length===0?void 0:A};var o={object:function(y,v){return(y==="layout"&&v===""?"The layout argument":y[0]==="data"&&v===""?"Trace "+y[1]+" in the data argument":a(y)+"key "+v)+" must be linked to an object container"},array:function(y,v){return(y==="data"?"The data argument":a(y)+"key "+v)+" must be linked to an array container"},schema:function(y,v){return a(y)+"key "+v+" is not part of the schema"},unused:function(y,v,_){var x=e(_)?"container":"key";return a(y)+x+" "+v+" did not get coerced"},dynamic:function(y,v,_,x){return[a(y)+"key",v,"(set to '"+_+"')","got reset to","'"+x+"'","during defaults."].join(" ")},invisible:function(y,v){return(v?a(y)+"item "+v:"Trace "+y[1])+" got defaulted to be not visible"},value:function(y,v,_){return[a(y)+"key "+v,"is set to an invalid value ("+_+")"].join(" ")}};function a(y){return f(y)?"In data trace "+y[1]+", ":"In "+y+", "}function c(y,v,_,x,T){var A,S;_=_||"",f(v)?(A=v[0],S=v[1]):(A=v,S=null);var w=function(k){if(!f(k))return String(k);for(var C="",M=0;M<k.length;M++){var P=k[M];typeof P=="number"?C=C.substr(0,C.length-1)+"["+P+"]":C+=P,M<k.length-1&&(C+=".")}return C}(_),L=o[y](v,w,x,T);return t.log(L),{code:y,container:A,trace:S,path:_,astr:w,msg:L}}function r(y,v){var _=l(v),x=_.keyMinusId,T=_.id;return!!(x in y&&y[x]._isSubplotObj&&T)||v in y}function n(y,v){return v in y?y[v]:y[l(v).keyMinusId]}var d=t.counterRegex("([a-z]+)");function l(y){var v=y.match(d);return{keyMinusId:v&&v[1],id:v&&v[2]}}},{"../lib":787,"../plots/plots":901,"./plot_config":825,"./plot_schema":826}],832:[function(h,N,H){N.exports={mode:{valType:"enumerated",dflt:"afterall",values:["immediate","next","afterall"]},direction:{valType:"enumerated",values:["forward","reverse"],dflt:"forward"},fromcurrent:{valType:"boolean",dflt:!1},frame:{duration:{valType:"number",min:0,dflt:500},redraw:{valType:"boolean",dflt:!0}},transition:{duration:{valType:"number",min:0,dflt:500,editType:"none"},easing:{valType:"enumerated",dflt:"cubic-in-out",values:["linear","quad","cubic","sin","exp","circle","elastic","back","bounce","linear-in","quad-in","cubic-in","sin-in","exp-in","circle-in","elastic-in","back-in","bounce-in","linear-out","quad-out","cubic-out","sin-out","exp-out","circle-out","elastic-out","back-out","bounce-out","linear-in-out","quad-in-out","cubic-in-out","sin-in-out","exp-in-out","circle-in-out","elastic-in-out","back-in-out","bounce-in-out"],editType:"none"},ordering:{valType:"enumerated",values:["layout first","traces first"],dflt:"layout first",editType:"none"}}}},{}],833:[function(h,N,H){var t=h("../lib"),m=h("../plot_api/plot_template");N.exports=function(g,p,e){var f,u,i=e.name,s=e.inclusionAttr||"visible",o=p[i],a=t.isArrayOrTypedArray(g[i])?g[i]:[],c=p[i]=[],r=m.arrayTemplater(p,i,s);for(f=0;f<a.length;f++){var n=a[f];t.isPlainObject(n)?u=r.newItem(n):(u=r.newItem({}))[s]=!1,u._index=f,u[s]!==!1&&e.handleItemDefaults(n,u,p,e),c.push(u)}var d=r.defaultItems();for(f=0;f<d.length;f++)(u=d[f])._index=c.length,e.handleItemDefaults({},u,p,e,{}),c.push(u);if(t.isArrayOrTypedArray(o)){var l=Math.min(o.length,c.length);for(f=0;f<l;f++)t.relinkPrivateKeys(c[f],o[f])}return c}},{"../lib":787,"../plot_api/plot_template":827}],834:[function(h,N,H){var t=h("./font_attributes"),m=h("../components/fx/attributes");N.exports={type:{valType:"enumerated",values:[],dflt:"scatter",editType:"calc+clearAxisTypes",_noTemplating:!0},visible:{valType:"enumerated",values:[!0,!1,"legendonly"],dflt:!0,editType:"calc"},showlegend:{valType:"boolean",dflt:!0,editType:"style"},legendgroup:{valType:"string",dflt:"",editType:"style"},legendgrouptitle:{text:{valType:"string",dflt:"",editType:"style"},font:t({editType:"style"}),editType:"style"},legendrank:{valType:"number",dflt:1e3,editType:"style"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"style"},name:{valType:"string",editType:"style"},uid:{valType:"string",editType:"plot",anim:!0},ids:{valType:"data_array",editType:"calc",anim:!0},customdata:{valType:"data_array",editType:"calc"},meta:{valType:"any",arrayOk:!0,editType:"plot"},selectedpoints:{valType:"any",editType:"calc"},hoverinfo:{valType:"flaglist",flags:["x","y","z","text","name"],extras:["all","none","skip"],arrayOk:!0,dflt:"all",editType:"none"},hoverlabel:m.hoverlabel,stream:{token:{valType:"string",noBlank:!0,strict:!0,editType:"calc"},maxpoints:{valType:"number",min:0,max:1e4,dflt:500,editType:"calc"},editType:"calc"},transforms:{_isLinkedToArray:"transform",editType:"calc"},uirevision:{valType:"any",editType:"none"}}},{"../components/fx/attributes":681,"./font_attributes":867}],835:[function(h,N,H){var t=h("fast-isnumeric"),m=h("../../lib"),g=m.dateTime2ms,p=m.incrementMonth,e=h("../../constants/numerical").ONEAVGMONTH;N.exports=function(f,u,i,s){if(u.type!=="date")return{vals:s};var o=f[i+"periodalignment"];if(!o)return{vals:s};var a,c=f[i+"period"];if(t(c)){if((c=+c)<=0)return{vals:s}}else if(typeof c=="string"&&c.charAt(0)==="M"){var r=+c.substring(1);if(!(r>0&&Math.round(r)===r))return{vals:s};a=r}for(var n=u.calendar,d=o==="start",l=o==="end",y=f[i+"period0"],v=g(y,n)||0,_=[],x=[],T=[],A=s.length,S=0;S<A;S++){var w,L,k,C=s[S];if(a){for(w=Math.round((C-v)/(a*e)),k=p(v,a*w,n);k>C;)k=p(k,-a,n);for(;k<=C;)k=p(k,a,n);L=p(k,-a,n)}else{for(k=v+(w=Math.round((C-v)/c))*c;k>C;)k-=c;for(;k<=C;)k+=c;L=k-c}_[S]=d?L:l?k:(L+k)/2,x[S]=L,T[S]=k}return{vals:_,starts:x,ends:T}}},{"../../constants/numerical":763,"../../lib":787,"fast-isnumeric":246}],836:[function(h,N,H){N.exports={xaxis:{valType:"subplotid",dflt:"x",editType:"calc+clearAxisTypes"},yaxis:{valType:"subplotid",dflt:"y",editType:"calc+clearAxisTypes"}}},{}],837:[function(h,N,H){var t=h("@plotly/d3"),m=h("fast-isnumeric"),g=h("../../lib"),p=h("../../constants/numerical").FP_SAFE,e=h("../../registry"),f=h("../../components/drawing"),u=h("./axis_ids"),i=u.getFromId,s=u.isLinked;function o(x,T){var A,S,w=[],L=x._fullLayout,k=c(L,T,0),C=c(L,T,1),M=r(x,T),P=M.min,O=M.max;if(P.length===0||O.length===0)return g.simpleMap(T.range,T.r2l);var F=P[0].val,j=O[0].val;for(A=1;A<P.length&&F===j;A++)F=Math.min(F,P[A].val);for(A=1;A<O.length&&F===j;A++)j=Math.max(j,O[A].val);var W=!1;if(T.range){var Z=g.simpleMap(T.range,T.r2l);W=Z[1]<Z[0]}T.autorange==="reversed"&&(W=!0,T.autorange=!0);var Q,X,G,Y,K,D,B=T.rangemode,q=B==="tozero",ee=B==="nonnegative",J=T._length,$=J/10,te=0;for(A=0;A<P.length;A++)for(Q=P[A],S=0;S<O.length;S++)(D=(X=O[S]).val-Q.val-a(T,Q.val,X.val))>0&&((K=J-k(Q)-C(X))>$?D/K>te&&(G=Q,Y=X,te=D/K):D/J>te&&(G={val:Q.val,nopad:1},Y={val:X.val,nopad:1},te=D/J));if(F===j){var ie=F-1,ae=F+1;if(q)if(F===0)w=[0,1];else{var he=(F>0?O:P).reduce(function(de,ce){return Math.max(de,C(ce))},0),se=F/(1-Math.min(.5,he/J));w=F>0?[0,se]:[se,0]}else w=ee?[Math.max(0,ie),Math.max(1,ae)]:[ie,ae]}else q?(G.val>=0&&(G={val:0,nopad:1}),Y.val<=0&&(Y={val:0,nopad:1})):ee&&(G.val-te*k(G)<0&&(G={val:0,nopad:1}),Y.val<=0&&(Y={val:1,nopad:1})),te=(Y.val-G.val-a(T,Q.val,X.val))/(J-k(G)-C(Y)),w=[G.val-te*k(G),Y.val+te*C(Y)];return W&&w.reverse(),g.simpleMap(w,T.l2r||Number)}function a(x,T,A){var S=0;if(x.rangebreaks)for(var w=x.locateBreaks(T,A),L=0;L<w.length;L++){var k=w[L];S+=k.max-k.min}return S}function c(x,T,A){var S=.05*T._length,w=T._anchorAxis||{};if((T.ticklabelposition||"").indexOf("inside")!==-1||(w.ticklabelposition||"").indexOf("inside")!==-1){var L=T.autorange==="reversed";if(!L){var k=g.simpleMap(T.range,T.r2l);L=k[1]<k[0]}L&&(A=!A)}var C=0;return s(x,T._id)||(C=function(M,P,O){var F=0,j=P._id.charAt(0)==="x";for(var W in M._plots){var Z=M._plots[W];if(P._id===Z.xaxis._id||P._id===Z.yaxis._id){var Q=(j?Z.yaxis:Z.xaxis)||{};if((Q.ticklabelposition||"").indexOf("inside")!==-1&&(!O&&(Q.side==="left"||Q.side==="bottom")||O&&(Q.side==="top"||Q.side==="right"))){if(Q._vals){var X=g.deg2rad(Q._tickAngles[Q._id+"tick"]||0),G=Math.abs(Math.cos(X)),Y=Math.abs(Math.sin(X));if(!Q._vals[0].bb){var K=Q._id+"tick";Q._selections[K].each(function(J){var $=t.select(this);$.select(".text-math-group").empty()&&(J.bb=f.bBox($.node()))})}for(var D=0;D<Q._vals.length;D++){var B=Q._vals[D].bb;if(B){var q=6+B.width,ee=6+B.height;F=Math.max(F,j?Math.max(q*G,ee*Y):Math.max(ee*G,q*Y))}}}Q.ticks==="inside"&&Q.ticklabelposition==="inside"&&(F+=Q.ticklen||0)}}}return F}(x,T,A)),S=Math.max(C,S),T.constrain==="domain"&&T._inputDomain&&(S*=(T._inputDomain[1]-T._inputDomain[0])/(T.domain[1]-T.domain[0])),function(M){return M.nopad?0:M.pad+(M.extrapad?S:C)}}N.exports={getAutoRange:o,makePadFn:c,doAutoRange:function(x,T,A){if(T.setScale(),T.autorange){T.range=A?A.slice():o(x,T),T._r=T.range.slice(),T._rl=g.simpleMap(T._r,T.r2l);var S=T._input,w={};w[T._attr+".range"]=T.range,w[T._attr+".autorange"]=T.autorange,e.call("_storeDirectGUIEdit",x.layout,x._fullLayout._preGUI,w),S.range=T.range.slice(),S.autorange=T.autorange}var L=T._anchorAxis;if(L&&L.rangeslider){var k=L.rangeslider[T._name];k&&k.rangemode==="auto"&&(k.range=o(x,T)),L._input.rangeslider[T._name]=g.extendFlat({},k)}},findExtremes:function(x,T,A){A||(A={}),x._m||x.setScale();var S,w,L,k,C,M,P,O,F,j=[],W=[],Z=T.length,Q=A.padded||!1,X=A.tozero&&(x.type==="linear"||x.type==="-"),G=x.type==="log",Y=!1,K=A.vpadLinearized||!1;function D(ae){if(Array.isArray(ae))return Y=!0,function(se){return Math.max(Number(ae[se]||0),0)};var he=Math.max(Number(ae||0),0);return function(){return he}}var B=D((x._m>0?A.ppadplus:A.ppadminus)||A.ppad||0),q=D((x._m>0?A.ppadminus:A.ppadplus)||A.ppad||0),ee=D(A.vpadplus||A.vpad),J=D(A.vpadminus||A.vpad);if(!Y){if(O=1/0,F=-1/0,G)for(S=0;S<Z;S++)(w=T[S])<O&&w>0&&(O=w),w>F&&w<p&&(F=w);else for(S=0;S<Z;S++)(w=T[S])<O&&w>-p&&(O=w),w>F&&w<p&&(F=w);T=[O,F],Z=2}var $={tozero:X,extrapad:Q};function te(ae){L=T[ae],m(L)&&(M=B(ae),P=q(ae),K?(k=x.c2l(L)-J(ae),C=x.c2l(L)+ee(ae)):(O=L-J(ae),F=L+ee(ae),G&&O<F/10&&(O=F/10),k=x.c2l(O),C=x.c2l(F)),X&&(k=Math.min(0,k),C=Math.max(0,C)),y(k)&&n(j,k,P,$),y(C)&&d(W,C,M,$))}var ie=Math.min(6,Z);for(S=0;S<ie;S++)te(S);for(S=Z-1;S>=ie;S--)te(S);return{min:j,max:W,opts:A}},concatExtremes:r};function r(x,T,A){var S,w,L,k=T._id,C=x._fullData,M=x._fullLayout,P=[],O=[];function F(X,G){for(S=0;S<G.length;S++){var Y=X[G[S]],K=(Y._extremes||{})[k];if(Y.visible===!0&&K){for(w=0;w<K.min.length;w++)L=K.min[w],n(P,L.val,L.pad,{extrapad:L.extrapad});for(w=0;w<K.max.length;w++)L=K.max[w],d(O,L.val,L.pad,{extrapad:L.extrapad})}}}if(F(C,T._traceIndices),F(M.annotations||[],T._annIndices||[]),F(M.shapes||[],T._shapeIndices||[]),T._matchGroup&&!A){for(var j in T._matchGroup)if(j!==T._id){var W=i(x,j),Z=r(x,W,!0),Q=T._length/W._length;for(w=0;w<Z.min.length;w++)L=Z.min[w],n(P,L.val,L.pad*Q,{extrapad:L.extrapad});for(w=0;w<Z.max.length;w++)L=Z.max[w],d(O,L.val,L.pad*Q,{extrapad:L.extrapad})}}return{min:P,max:O}}function n(x,T,A,S){l(x,T,A,S,v)}function d(x,T,A,S){l(x,T,A,S,_)}function l(x,T,A,S,w){for(var L=S.tozero,k=S.extrapad,C=!0,M=0;M<x.length&&C;M++){var P=x[M];if(w(P.val,T)&&P.pad>=A&&(P.extrapad||!k)){C=!1;break}w(T,P.val)&&P.pad<=A&&(k||!P.extrapad)&&(x.splice(M,1),M--)}if(C){var O=L&&T===0;x.push({val:T,pad:O?0:A,extrapad:!O&&k})}}function y(x){return m(x)&&Math.abs(x)<p}function v(x,T){return x<=T}function _(x,T){return x>=T}},{"../../components/drawing":672,"../../constants/numerical":763,"../../lib":787,"../../registry":915,"./axis_ids":842,"@plotly/d3":58,"fast-isnumeric":246}],838:[function(h,N,H){var t=h("@plotly/d3"),m=h("fast-isnumeric"),g=h("../../plots/plots"),p=h("../../registry"),e=h("../../lib"),f=e.strTranslate,u=h("../../lib/svg_text_utils"),i=h("../../components/titles"),s=h("../../components/color"),o=h("../../components/drawing"),a=h("./layout_attributes"),c=h("./clean_ticks"),r=h("../../constants/numerical"),n=r.ONEMAXYEAR,d=r.ONEAVGYEAR,l=r.ONEMINYEAR,y=r.ONEMAXQUARTER,v=r.ONEAVGQUARTER,_=r.ONEMINQUARTER,x=r.ONEMAXMONTH,T=r.ONEAVGMONTH,A=r.ONEMINMONTH,S=r.ONEWEEK,w=r.ONEDAY,L=w/2,k=r.ONEHOUR,C=r.ONEMIN,M=r.ONESEC,P=r.MINUS_SIGN,O=r.BADNUM,F={K:"zeroline"},j={K:"gridline",L:"path"},W={K:"tick",L:"path"},Z={K:"tick",L:"text"},Q=h("../../constants/alignment"),X=Q.MID_SHIFT,G=Q.CAP_SHIFT,Y=Q.LINE_SPACING,K=Q.OPPOSITE_SIDE,D=N.exports={};D.setConvert=h("./set_convert");var B=h("./axis_autotype"),q=h("./axis_ids"),ee=q.idSort,J=q.isLinked;D.id2name=q.id2name,D.name2id=q.name2id,D.cleanId=q.cleanId,D.list=q.list,D.listIds=q.listIds,D.getFromId=q.getFromId,D.getFromTrace=q.getFromTrace;var $=h("./autorange");D.getAutoRange=$.getAutoRange,D.findExtremes=$.findExtremes;function te(Ue){var He=1e-4*(Ue[1]-Ue[0]);return[Ue[0]-He,Ue[1]+He]}D.coerceRef=function(Ue,He,Be,Je,_e,Le){var Ce=Je.charAt(Je.length-1),Pe=Be._fullLayout._subplots[Ce+"axis"],Xe=Je+"ref",ut={};return _e||(_e=Pe[0]||(typeof Le=="string"?Le:Le[0])),Le||(Le=_e),Pe=Pe.concat(Pe.map(function(kt){return kt+" domain"})),ut[Xe]={valType:"enumerated",values:Pe.concat(Le?typeof Le=="string"?[Le]:Le:[]),dflt:_e},e.coerce(Ue,He,ut,Xe)},D.getRefType=function(Ue){return Ue===void 0?Ue:Ue==="paper"?"paper":Ue==="pixel"?"pixel":/( domain)$/.test(Ue)?"domain":"range"},D.coercePosition=function(Ue,He,Be,Je,_e,Le){var Ce,Pe;if(D.getRefType(Je)!=="range")Ce=e.ensureNumber,Pe=Be(_e,Le);else{var Xe=D.getFromId(He,Je);Pe=Be(_e,Le=Xe.fraction2r(Le)),Ce=Xe.cleanPos}Ue[_e]=Ce(Pe)},D.cleanPosition=function(Ue,He,Be){return(Be==="paper"||Be==="pixel"?e.ensureNumber:D.getFromId(He,Be).cleanPos)(Ue)},D.redrawComponents=function(Ue,He){He=He||D.listIds(Ue);var Be=Ue._fullLayout;function Je(_e,Le,Ce,Pe){for(var Xe=p.getComponentMethod(_e,Le),ut={},kt=0;kt<He.length;kt++)for(var ft=Be[D.id2name(He[kt])][Ce],Et=0;Et<ft.length;Et++){var mt=ft[Et];if(!ut[mt]&&(Xe(Ue,mt),ut[mt]=1,Pe))return}}Je("annotations","drawOne","_annIndices"),Je("shapes","drawOne","_shapeIndices"),Je("images","draw","_imgIndices",!0)};var ie=D.getDataConversions=function(Ue,He,Be,Je){var _e,Le=Be==="x"||Be==="y"||Be==="z"?Be:Je;if(Array.isArray(Le)){if(_e={type:B(Je,void 0,{autotypenumbers:Ue._fullLayout.autotypenumbers}),_categories:[]},D.setConvert(_e),_e.type==="category")for(var Ce=0;Ce<Je.length;Ce++)_e.d2c(Je[Ce])}else _e=D.getFromTrace(Ue,He,Le);return _e?{d2c:_e.d2c,c2d:_e.c2d}:Le==="ids"?{d2c:he,c2d:he}:{d2c:ae,c2d:ae}};function ae(Ue){return+Ue}function he(Ue){return String(Ue)}function se(Ue){return+Ue.substring(1)}D.getDataToCoordFunc=function(Ue,He,Be,Je){return ie(Ue,He,Be,Je).d2c},D.counterLetter=function(Ue){var He=Ue.charAt(0);return He==="x"?"y":He==="y"?"x":void 0},D.minDtick=function(Ue,He,Be,Je){["log","category","multicategory"].indexOf(Ue.type)===-1&&Je?Ue._minDtick===void 0?(Ue._minDtick=He,Ue._forceTick0=Be):Ue._minDtick&&((Ue._minDtick/He+1e-6)%1<2e-6&&((Be-Ue._forceTick0)/He%1+1.000001)%1<2e-6?(Ue._minDtick=He,Ue._forceTick0=Be):((He/Ue._minDtick+1e-6)%1>2e-6||((Be-Ue._forceTick0)/Ue._minDtick%1+1.000001)%1>2e-6)&&(Ue._minDtick=0)):Ue._minDtick=0},D.saveRangeInitial=function(Ue,He){for(var Be=D.list(Ue,"",!0),Je=!1,_e=0;_e<Be.length;_e++){var Le=Be[_e],Ce=Le._rangeInitial===void 0,Pe=Ce||!(Le.range[0]===Le._rangeInitial[0]&&Le.range[1]===Le._rangeInitial[1]);(Ce&&Le.autorange===!1||He&&Pe)&&(Le._rangeInitial=Le.range.slice(),Je=!0)}return Je},D.saveShowSpikeInitial=function(Ue,He){for(var Be=D.list(Ue,"",!0),Je=!1,_e="on",Le=0;Le<Be.length;Le++){var Ce=Be[Le],Pe=Ce._showSpikeInitial===void 0,Xe=Pe||Ce.showspikes!==Ce._showspikes;(Pe||He&&Xe)&&(Ce._showSpikeInitial=Ce.showspikes,Je=!0),_e!=="on"||Ce.showspikes||(_e="off")}return Ue._fullLayout._cartesianSpikesEnabled=_e,Je},D.autoBin=function(Ue,He,Be,Je,_e,Le){var Ce,Pe=e.aggNums(Math.min,null,Ue),Xe=e.aggNums(Math.max,null,Ue);if(He.type==="category"||He.type==="multicategory")return{start:Pe-.5,end:Xe+.5,size:Math.max(1,Math.round(Le)||1),_dataSpan:Xe-Pe};if(_e||(_e=He.calendar),Ce=He.type==="log"?{type:"linear",range:[Pe,Xe]}:{type:He.type,range:e.simpleMap([Pe,Xe],He.c2r,0,_e),calendar:_e},D.setConvert(Ce),Le=Le&&c.dtick(Le,Ce.type))Ce.dtick=Le,Ce.tick0=c.tick0(void 0,Ce.type,_e);else{var ut;if(Be)ut=(Xe-Pe)/Be;else{var kt=e.distinctVals(Ue),ft=Math.pow(10,Math.floor(Math.log(kt.minDiff)/Math.LN10)),Et=ft*e.roundUp(kt.minDiff/ft,[.9,1.9,4.9,9.9],!0);ut=Math.max(Et,2*e.stdev(Ue)/Math.pow(Ue.length,Je?.25:.4)),m(ut)||(ut=1)}D.autoTicks(Ce,ut)}var mt,It=Ce.dtick,vt=D.tickIncrement(D.tickFirst(Ce),It,"reverse",_e);if(typeof It=="number")mt=(vt=function(nt,At,Ft,Nt,Kt){var Ie=0,ot=0,bt=0,Pt=0;function Vt(ar){return(1+100*(ar-nt)/Ft.dtick)%100<2}for(var nr=0;nr<At.length;nr++)At[nr]%1==0?bt++:m(At[nr])||Pt++,Vt(At[nr])&&Ie++,Vt(At[nr]+Ft.dtick/2)&&ot++;var Yt=At.length-Pt;if(bt===Yt&&Ft.type!=="date")Ft.dtick<1?nt=Nt-.5*Ft.dtick:(nt-=.5)+Ft.dtick<Nt&&(nt+=Ft.dtick);else if(ot<.1*Yt&&(Ie>.3*Yt||Vt(Nt)||Vt(Kt))){var Xt=Ft.dtick/2;nt+=nt+Xt<Nt?Xt:-Xt}return nt}(vt,Ue,Ce,Pe,Xe))+(1+Math.floor((Xe-vt)/It))*It;else for(Ce.dtick.charAt(0)==="M"&&(vt=function(nt,At,Ft,Nt,Kt){var Ie=e.findExactDates(At,Kt);if(Ie.exactDays>.8){var ot=Number(Ft.substr(1));Ie.exactYears>.8&&ot%12==0?nt=D.tickIncrement(nt,"M6","reverse")+1.5*w:Ie.exactMonths>.8?nt=D.tickIncrement(nt,"M1","reverse")+15.5*w:nt-=L;var bt=D.tickIncrement(nt,Ft);if(bt<=Nt)return bt}return nt}(vt,Ue,It,Pe,_e)),mt=vt,0;mt<=Xe;)mt=D.tickIncrement(mt,It,!1,_e);return{start:He.c2r(vt,0,_e),end:He.c2r(mt,0,_e),size:It,_dataSpan:Xe-Pe}},D.prepTicks=function(Ue,He){var Be=e.simpleMap(Ue.range,Ue.r2l,void 0,void 0,He);if(Ue._dtickInit=Ue.dtick,Ue._tick0Init=Ue.tick0,Ue.tickmode==="auto"||!Ue.dtick){var Je,_e=Ue.nticks;_e||(Ue.type==="category"||Ue.type==="multicategory"?(Je=Ue.tickfont?e.bigFont(Ue.tickfont.size||12):15,_e=Ue._length/Je):(Je=Ue._id.charAt(0)==="y"?40:80,_e=e.constrain(Ue._length/Je,4,9)+1),Ue._name==="radialaxis"&&(_e*=2)),Ue.tickmode==="array"&&(_e*=100),Ue._roughDTick=Math.abs(Be[1]-Be[0])/_e,D.autoTicks(Ue,Ue._roughDTick),Ue._minDtick>0&&Ue.dtick<2*Ue._minDtick&&(Ue.dtick=Ue._minDtick,Ue.tick0=Ue.l2r(Ue._forceTick0))}Ue.ticklabelmode==="period"&&function(Le){var Ce;function Pe(){return!(m(Le.dtick)||Le.dtick.charAt(0)!=="M")}var Xe=Pe(),ut=D.getTickFormat(Le);if(ut){var kt=Le._dtickInit!==Le.dtick;/%[fLQsSMX]/.test(ut)||(/%[HI]/.test(ut)?(Ce=k,kt&&!Xe&&Le.dtick<k&&(Le.dtick=k)):/%p/.test(ut)?(Ce=L,kt&&!Xe&&Le.dtick<L&&(Le.dtick=L)):/%[Aadejuwx]/.test(ut)?(Ce=w,kt&&!Xe&&Le.dtick<w&&(Le.dtick=w)):/%[UVW]/.test(ut)?(Ce=S,kt&&!Xe&&Le.dtick<S&&(Le.dtick=S)):/%[Bbm]/.test(ut)?(Ce=T,kt&&(Xe?se(Le.dtick)<1:Le.dtick<A)&&(Le.dtick="M1")):/%[q]/.test(ut)?(Ce=v,kt&&(Xe?se(Le.dtick)<3:Le.dtick<_)&&(Le.dtick="M3")):/%[Yy]/.test(ut)&&(Ce=d,kt&&(Xe?se(Le.dtick)<12:Le.dtick<l)&&(Le.dtick="M12")))}(Xe=Pe())&&Le.tick0===Le._dowTick0&&(Le.tick0=Le._rawTick0),Le._definedDelta=Ce}(Ue),Ue.tick0||(Ue.tick0=Ue.type==="date"?"2000-01-01":0),Ue.type==="date"&&Ue.dtick<.1&&(Ue.dtick=.1),me(Ue)},D.calcTicks=function(Ue,He){D.prepTicks(Ue,He);var Be=e.simpleMap(Ue.range,Ue.r2l,void 0,void 0,He);if(Ue.tickmode==="array")return function(nr){var Yt=nr.tickvals,Xt=nr.ticktext,ar=new Array(Yt.length),hr=te(e.simpleMap(nr.range,nr.r2l)),mr=Math.min(hr[0],hr[1]),sr=Math.max(hr[0],hr[1]),fr=0;Array.isArray(Xt)||(Xt=[]);var yr=nr.type==="category"?nr.d2l_noadd:nr.d2l;nr.type==="log"&&String(nr.dtick).charAt(0)!=="L"&&(nr.dtick="L"+Math.pow(10,Math.floor(Math.min(nr.range[0],nr.range[1]))-1));for(var zr=0;zr<Yt.length;zr++){var xr=yr(Yt[zr]);xr>mr&&xr<sr&&(Xt[zr]===void 0?ar[fr]=D.tickText(nr,xr):ar[fr]=we(nr,xr,String(Xt[zr])),fr++)}return fr<Yt.length&&ar.splice(fr,Yt.length-fr),nr.rangebreaks&&(ar=ar.filter(function(Br){return nr.maskBreaks(Br.x)!==O})),ar}(Ue);var Je=te(Be),_e=Je[0],Le=Je[1],Ce=Be[1]<Be[0],Pe=Math.min(Be[0],Be[1]),Xe=Math.max(Be[0],Be[1]),ut=Ue.type==="log"&&!(m(Ue.dtick)||Ue.dtick.charAt(0)==="L"),kt=Ue.ticklabelmode==="period";if(Ue._tmin=D.tickFirst(Ue,He),Ue._tmin<_e!==Ce)return[];Ue.type!=="category"&&Ue.type!=="multicategory"||(Le=Ce?Math.max(-.5,Le):Math.min(Ue._categories.length-.5,Le));var ft=Ue._tmin;Ue.rangebreaks&&Ue._tick0Init!==Ue.tick0&&(ft=xt(ft,Ue),Ce||(ft=D.tickIncrement(ft,Ue.dtick,!Ce,Ue.calendar))),kt&&(ft=D.tickIncrement(ft,Ue.dtick,!Ce,Ue.calendar));for(var Et,mt=Math.max(1e3,Ue._length||0),It=[],vt=null;Ce?ft>=Le:ft<=Le;ft=D.tickIncrement(ft,Ue.dtick,Ce,Ue.calendar)){if(Ue.rangebreaks&&!Ce){if(ft<_e)continue;if(Ue.maskBreaks(ft)===O&&xt(ft,Ue)>=Xe)break}if(It.length>mt||ft===vt)break;vt=ft;var nt=!1;ut&&ft!==(0|ft)&&(nt=!0),It.push({minor:nt,value:ft})}if(kt&&function(nr,Yt,Xt){for(var ar=0;ar<nr.length;ar++){var hr=nr[ar].value,mr=ar,sr=ar+1;ar<nr.length-1?(mr=ar,sr=ar+1):ar>0?(mr=ar-1,sr=ar):(mr=ar,sr=ar);var fr,yr=nr[mr].value,zr=nr[sr].value,xr=Math.abs(zr-yr),Br=Xt||xr,Jr=0;Br>=l?Jr=xr>=l&&xr<=n?xr:d:Xt===v&&Br>=_?Jr=xr>=_&&xr<=y?xr:v:Br>=A?Jr=xr>=A&&xr<=x?xr:T:Xt===S&&Br>=S?Jr=S:Br>=w?Jr=w:Xt===L&&Br>=L?Jr=L:Xt===k&&Br>=k&&(Jr=k),Jr>=xr&&(Jr=xr,fr=!0);var fn=hr+Jr;if(Yt.rangebreaks&&Jr>0){for(var Cn=0,Pn=0;Pn<84;Pn++){var An=(Pn+.5)/84;Yt.maskBreaks(hr*(1-An)+An*fn)!==O&&Cn++}(Jr*=Cn/84)||(nr[ar].drop=!0),fr&&xr>S&&(Jr=xr)}(Jr>0||ar===0)&&(nr[ar].periodX=hr+Jr/2)}}(It,Ue,Ue._definedDelta),Ue.rangebreaks){var At=Ue._id.charAt(0)==="y",Ft=1;Ue.tickmode==="auto"&&(Ft=Ue.tickfont?Ue.tickfont.size:12);var Nt=NaN;for(Et=It.length-1;Et>-1;Et--)if(It[Et].drop)It.splice(Et,1);else{It[Et].value=xt(It[Et].value,Ue);var Kt=Ue.c2p(It[Et].value);(At?Nt>Kt-Ft:Nt<Kt+Ft)?It.splice(Ce?Et+1:Et,1):Nt=Kt}}$e(Ue)&&Math.abs(Be[1]-Be[0])===360&&It.pop(),Ue._tmax=(It[It.length-1]||{}).value,Ue._prevDateHead="",Ue._inCalcTicks=!0;var Ie,ot,bt=[];for(Et=0;Et<It.length;Et++){var Pt=It[Et].minor,Vt=It[Et].value;Ie=D.tickText(Ue,Vt,!1,Pt),(ot=It[Et].periodX)!==void 0&&(Ie.periodX=ot,(ot>Xe||ot<Pe)&&(ot>Xe&&(Ie.periodX=Xe),ot<Pe&&(Ie.periodX=Pe),Ie.text=" ",Ue._prevDateHead="")),bt.push(Ie)}return Ue._inCalcTicks=!1,bt};var de=[2,5,10],ce=[1,2,3,6,12],ve=[1,2,5,10,15,30],ke=[1,2,3,7,14],Ee=[-.046,0,.301,.477,.602,.699,.778,.845,.903,.954,1],be=[-.301,0,.301,.699,1],xe=[15,30,45,90,180];function ue(Ue,He,Be){return He*e.roundUp(Ue/He,Be)}function me(Ue){var He=Ue.dtick;if(Ue._tickexponent=0,m(He)||typeof He=="string"||(He=1),Ue.type!=="category"&&Ue.type!=="multicategory"||(Ue._tickround=null),Ue.type==="date"){var Be=Ue.r2l(Ue.tick0),Je=Ue.l2r(Be).replace(/(^-|i)/g,""),_e=Je.length;if(String(He).charAt(0)==="M")_e>10||Je.substr(5)!=="01-01"?Ue._tickround="d":Ue._tickround=+He.substr(1)%12==0?"y":"m";else if(He>=w&&_e<=10||He>=15*w)Ue._tickround="d";else if(He>=C&&_e<=16||He>=k)Ue._tickround="M";else if(He>=M&&_e<=19||He>=C)Ue._tickround="S";else{var Le=Ue.l2r(Be+He).replace(/^-/,"").length;Ue._tickround=Math.max(_e,Le)-20,Ue._tickround<0&&(Ue._tickround=4)}}else if(m(He)||He.charAt(0)==="L"){var Ce=Ue.range.map(Ue.r2d||Number);m(He)||(He=Number(He.substr(1))),Ue._tickround=2-Math.floor(Math.log(He)/Math.LN10+.01);var Pe=Math.max(Math.abs(Ce[0]),Math.abs(Ce[1])),Xe=Math.floor(Math.log(Pe)/Math.LN10+.01),ut=Ue.minexponent===void 0?3:Ue.minexponent;Math.abs(Xe)>ut&&(Se(Ue.exponentformat)&&!De(Xe)?Ue._tickexponent=3*Math.round((Xe-1)/3):Ue._tickexponent=Xe)}else Ue._tickround=null}function we(Ue,He,Be){var Je=Ue.tickfont||{};return{x:He,dx:0,dy:0,text:Be||"",fontSize:Je.size,font:Je.family,fontColor:Je.color}}D.autoTicks=function(Ue,He){var Be;function Je(kt){return Math.pow(kt,Math.floor(Math.log(He)/Math.LN10))}if(Ue.type==="date"){Ue.tick0=e.dateTick0(Ue.calendar,0);var _e=2*He;if(_e>d)He/=d,Be=Je(10),Ue.dtick="M"+12*ue(He,Be,de);else if(_e>T)He/=T,Ue.dtick="M"+ue(He,1,ce);else if(_e>w){Ue.dtick=ue(He,w,Ue._hasDayOfWeekBreaks?[1,2,7,14]:ke);var Le=D.getTickFormat(Ue),Ce=Ue.ticklabelmode==="period";Ce&&(Ue._rawTick0=Ue.tick0),/%[uVW]/.test(Le)?Ue.tick0=e.dateTick0(Ue.calendar,2):Ue.tick0=e.dateTick0(Ue.calendar,1),Ce&&(Ue._dowTick0=Ue.tick0)}else _e>k?Ue.dtick=ue(He,k,ce):_e>C?Ue.dtick=ue(He,C,ve):_e>M?Ue.dtick=ue(He,M,ve):(Be=Je(10),Ue.dtick=ue(He,Be,de))}else if(Ue.type==="log"){Ue.tick0=0;var Pe=e.simpleMap(Ue.range,Ue.r2l);if(He>.7)Ue.dtick=Math.ceil(He);else if(Math.abs(Pe[1]-Pe[0])<1){var Xe=1.5*Math.abs((Pe[1]-Pe[0])/He);He=Math.abs(Math.pow(10,Pe[1])-Math.pow(10,Pe[0]))/Xe,Be=Je(10),Ue.dtick="L"+ue(He,Be,de)}else Ue.dtick=He>.3?"D2":"D1"}else Ue.type==="category"||Ue.type==="multicategory"?(Ue.tick0=0,Ue.dtick=Math.ceil(Math.max(He,1))):$e(Ue)?(Ue.tick0=0,Be=1,Ue.dtick=ue(He,Be,xe)):(Ue.tick0=0,Be=Je(10),Ue.dtick=ue(He,Be,de));if(Ue.dtick===0&&(Ue.dtick=1),!m(Ue.dtick)&&typeof Ue.dtick!="string"){var ut=Ue.dtick;throw Ue.dtick=1,"ax.dtick error: "+String(ut)}},D.tickIncrement=function(Ue,He,Be,Je){var _e=Be?-1:1;if(m(He))return e.increment(Ue,_e*He);var Le=He.charAt(0),Ce=_e*Number(He.substr(1));if(Le==="M")return e.incrementMonth(Ue,Ce,Je);if(Le==="L")return Math.log(Math.pow(10,Ue)+Ce)/Math.LN10;if(Le==="D"){var Pe=He==="D2"?be:Ee,Xe=Ue+.01*_e,ut=e.roundUp(e.mod(Xe,1),Pe,Be);return Math.floor(Xe)+Math.log(t.round(Math.pow(10,ut),1))/Math.LN10}throw"unrecognized dtick "+String(He)},D.tickFirst=function(Ue,He){var Be=Ue.r2l||Number,Je=e.simpleMap(Ue.range,Be,void 0,void 0,He),_e=Je[1]<Je[0],Le=_e?Math.floor:Math.ceil,Ce=te(Je)[0],Pe=Ue.dtick,Xe=Be(Ue.tick0);if(m(Pe)){var ut=Le((Ce-Xe)/Pe)*Pe+Xe;return Ue.type!=="category"&&Ue.type!=="multicategory"||(ut=e.constrain(ut,0,Ue._categories.length-1)),ut}var kt=Pe.charAt(0),ft=Number(Pe.substr(1));if(kt==="M"){for(var Et,mt,It,vt=0,nt=Xe;vt<10;){if(((Et=D.tickIncrement(nt,Pe,_e,Ue.calendar))-Ce)*(nt-Ce)<=0)return _e?Math.min(nt,Et):Math.max(nt,Et);mt=(Ce-(nt+Et)/2)/(Et-nt),It=kt+(Math.abs(Math.round(mt))||1)*ft,nt=D.tickIncrement(nt,It,mt<0?!_e:_e,Ue.calendar),vt++}return e.error("tickFirst did not converge",Ue),nt}if(kt==="L")return Math.log(Le((Math.pow(10,Ce)-Xe)/ft)*ft+Xe)/Math.LN10;if(kt==="D"){var At=Pe==="D2"?be:Ee,Ft=e.roundUp(e.mod(Ce,1),At,_e);return Math.floor(Ce)+Math.log(t.round(Math.pow(10,Ft),1))/Math.LN10}throw"unrecognized dtick "+String(Pe)},D.tickText=function(Ue,He,Be,Je){var _e,Le=we(Ue,He),Ce=Ue.tickmode==="array",Pe=Be||Ce,Xe=Ue.type,ut=Xe==="category"?Ue.d2l_noadd:Ue.d2l;if(Ce&&Array.isArray(Ue.ticktext)){var kt=e.simpleMap(Ue.range,Ue.r2l),ft=(Math.abs(kt[1]-kt[0])-(Ue._lBreaks||0))/1e4;for(_e=0;_e<Ue.ticktext.length&&!(Math.abs(He-ut(Ue.tickvals[_e]))<ft);_e++);if(_e<Ue.ticktext.length)return Le.text=String(Ue.ticktext[_e]),Le}function Et(vt){if(vt===void 0)return!0;if(Be)return vt==="none";var nt={first:Ue._tmin,last:Ue._tmax}[vt];return vt!=="all"&&He!==nt}var mt=Be?"never":Ue.exponentformat!=="none"&&Et(Ue.showexponent)?"hide":"";if(Xe==="date"?function(vt,nt,At,Ft){var Nt=vt._tickround,Kt=At&&vt.hoverformat||D.getTickFormat(vt);Ft&&(Nt=m(Nt)?4:{y:"m",m:"d",d:"M",M:"S",S:4}[Nt]);var Ie,ot=e.formatDate(nt.x,Kt,Nt,vt._dateFormat,vt.calendar,vt._extraFormat),bt=ot.indexOf(`
`);if(bt!==-1&&(Ie=ot.substr(bt+1),ot=ot.substr(0,bt)),Ft&&(ot==="00:00:00"||ot==="00:00"?(ot=Ie,Ie=""):ot.length===8&&(ot=ot.replace(/:00$/,""))),Ie)if(At)Nt==="d"?ot+=", "+Ie:ot=Ie+(ot?", "+ot:"");else if(vt._inCalcTicks&&vt._prevDateHead===Ie){var Pt=Qt(vt),Vt=vt._realSide||vt.side;(!Pt&&Vt==="top"||Pt&&Vt==="bottom")&&(ot+="<br> ")}else vt._prevDateHead=Ie,ot+="<br>"+Ie;nt.text=ot}(Ue,Le,Be,Pe):Xe==="log"?function(vt,nt,At,Ft,Nt){var Kt=vt.dtick,Ie=nt.x,ot=vt.tickformat,bt=typeof Kt=="string"&&Kt.charAt(0);if(Nt==="never"&&(Nt=""),Ft&&bt!=="L"&&(Kt="L3",bt="L"),ot||bt==="L")nt.text=Fe(Math.pow(10,Ie),vt,Nt,Ft);else if(m(Kt)||bt==="D"&&e.mod(Ie+.01,1)<.1){var Pt=Math.round(Ie),Vt=Math.abs(Pt),nr=vt.exponentformat;nr==="power"||Se(nr)&&De(Pt)?(nt.text=Pt===0?1:Pt===1?"10":"10<sup>"+(Pt>1?"":P)+Vt+"</sup>",nt.fontSize*=1.25):(nr==="e"||nr==="E")&&Vt>2?nt.text="1"+nr+(Pt>0?"+":P)+Vt:(nt.text=Fe(Math.pow(10,Ie),vt,"","fakehover"),Kt==="D1"&&vt._id.charAt(0)==="y"&&(nt.dy-=nt.fontSize/6))}else{if(bt!=="D")throw"unrecognized dtick "+String(Kt);nt.text=String(Math.round(Math.pow(10,e.mod(Ie,1)))),nt.fontSize*=.75}if(vt.dtick==="D1"){var Yt=String(nt.text).charAt(0);Yt!=="0"&&Yt!=="1"||(vt._id.charAt(0)==="y"?nt.dx-=nt.fontSize/4:(nt.dy+=nt.fontSize/2,nt.dx+=(vt.range[1]>vt.range[0]?1:-1)*nt.fontSize*(Ie<0?.5:.25)))}}(Ue,Le,0,Pe,mt):Xe==="category"?function(vt,nt){var At=vt._categories[Math.round(nt.x)];At===void 0&&(At=""),nt.text=String(At)}(Ue,Le):Xe==="multicategory"?function(vt,nt,At){var Ft=Math.round(nt.x),Nt=vt._categories[Ft]||[],Kt=Nt[1]===void 0?"":String(Nt[1]),Ie=Nt[0]===void 0?"":String(Nt[0]);At?nt.text=Ie+" - "+Kt:(nt.text=Kt,nt.text2=Ie)}(Ue,Le,Be):$e(Ue)?function(vt,nt,At,Ft,Nt){if(vt.thetaunit!=="radians"||At)nt.text=Fe(nt.x,vt,Nt,Ft);else{var Kt=nt.x/180;if(Kt===0)nt.text="0";else{var Ie=function(bt){function Pt(Xt,ar){return Math.abs(Xt-ar)<=1e-6}var Vt=function(Xt){for(var ar=1;!Pt(Math.round(Xt*ar)/ar,Xt);)ar*=10;return ar}(bt),nr=bt*Vt,Yt=Math.abs(function Xt(ar,hr){return Pt(hr,0)?ar:Xt(hr,ar%hr)}(nr,Vt));return[Math.round(nr/Yt),Math.round(Vt/Yt)]}(Kt);if(Ie[1]>=100)nt.text=Fe(e.deg2rad(nt.x),vt,Nt,Ft);else{var ot=nt.x<0;Ie[1]===1?Ie[0]===1?nt.text="\u03C0":nt.text=Ie[0]+"\u03C0":nt.text=["<sup>",Ie[0],"</sup>","\u2044","<sub>",Ie[1],"</sub>","\u03C0"].join(""),ot&&(nt.text=P+nt.text)}}}}(Ue,Le,Be,Pe,mt):function(vt,nt,At,Ft,Nt){Nt==="never"?Nt="":vt.showexponent==="all"&&Math.abs(nt.x/vt.dtick)<1e-6&&(Nt="hide"),nt.text=Fe(nt.x,vt,Nt,Ft)}(Ue,Le,0,Pe,mt),Je||(Ue.tickprefix&&!Et(Ue.showtickprefix)&&(Le.text=Ue.tickprefix+Le.text),Ue.ticksuffix&&!Et(Ue.showticksuffix)&&(Le.text+=Ue.ticksuffix)),Ue.tickson==="boundaries"||Ue.showdividers){var It=function(vt){var nt=Ue.l2p(vt);return nt>=0&&nt<=Ue._length?vt:null};Le.xbnd=[It(Le.x-.5),It(Le.x+Ue.dtick-.5)]}return Le},D.hoverLabelText=function(Ue,He,Be){Be&&(Ue=e.extendFlat({},Ue,{hoverformat:Be}));var Je=Array.isArray(He)?He[0]:He,_e=Array.isArray(He)?He[1]:void 0;if(_e!==void 0&&_e!==Je)return D.hoverLabelText(Ue,Je,Be)+" - "+D.hoverLabelText(Ue,_e,Be);var Le=Ue.type==="log"&&Je<=0,Ce=D.tickText(Ue,Ue.c2l(Le?-Je:Je),"hover").text;return Le?Je===0?"0":P+Ce:Ce};var Me=["f","p","n","\u03BC","m","","k","M","G","T"];function Se(Ue){return Ue==="SI"||Ue==="B"}function De(Ue){return Ue>14||Ue<-15}function Fe(Ue,He,Be,Je){var _e=Ue<0,Le=He._tickround,Ce=Be||He.exponentformat||"B",Pe=He._tickexponent,Xe=D.getTickFormat(He),ut=He.separatethousands;if(Je){var kt={exponentformat:Ce,minexponent:He.minexponent,dtick:He.showexponent==="none"?He.dtick:m(Ue)&&Math.abs(Ue)||1,range:He.showexponent==="none"?He.range.map(He.r2d):[0,Ue||1]};me(kt),Le=(Number(kt._tickround)||0)+4,Pe=kt._tickexponent,He.hoverformat&&(Xe=He.hoverformat)}if(Xe)return He._numFormat(Xe)(Ue).replace(/-/g,P);var ft,Et=Math.pow(10,-Le)/2;if(Ce==="none"&&(Pe=0),(Ue=Math.abs(Ue))<Et)Ue="0",_e=!1;else{if(Ue+=Et,Pe&&(Ue*=Math.pow(10,-Pe),Le+=Pe),Le===0)Ue=String(Math.floor(Ue));else if(Le<0){Ue=(Ue=String(Math.round(Ue))).substr(0,Ue.length+Le);for(var mt=Le;mt<0;mt++)Ue+="0"}else{var It=(Ue=String(Ue)).indexOf(".")+1;It&&(Ue=Ue.substr(0,It+Le).replace(/\.?0+$/,""))}Ue=e.numSeparate(Ue,He._separators,ut)}return Pe&&Ce!=="hide"&&(Se(Ce)&&De(Pe)&&(Ce="power"),ft=Pe<0?P+-Pe:Ce!=="power"?"+"+Pe:String(Pe),Ce==="e"||Ce==="E"?Ue+=Ce+ft:Ce==="power"?Ue+="\xD710<sup>"+ft+"</sup>":Ce==="B"&&Pe===9?Ue+="B":Se(Ce)&&(Ue+=Me[Pe/3+5])),_e?P+Ue:Ue}function Ye(Ue,He){for(var Be=[],Je={},_e=0;_e<He.length;_e++){var Le=He[_e];Je[Le.text2]?Je[Le.text2].push(Le.x):Je[Le.text2]=[Le.x]}for(var Ce in Je)Be.push(we(Ue,e.interp(Je[Ce],.5),Ce));return Be}function et(Ue){return Ue.periodX!==void 0?Ue.periodX:Ue.x}function Oe(Ue){return[Ue.text,Ue.x,Ue.axInfo,Ue.font,Ue.fontSize,Ue.fontColor].join("_")}function je(Ue){var He=Ue.title.font.size,Be=(Ue.title.text.match(u.BR_TAG_ALL)||[]).length;return Ue.title.hasOwnProperty("standoff")?Be?He*(G+Be*Y):He*G:Be?He*(Be+1)*Y:He}function We(Ue,He){var Be=Ue.l2p(He);return Be>1&&Be<Ue._length-1}function Ge(Ue){var He=t.select(Ue),Be=He.select(".text-math-group");return Be.empty()?He.select("text"):Be}function Qe(Ue){return Ue._id+".automargin"}function it(Ue){return Qe(Ue)+".mirror"}function lt(Ue){return Ue._id+".rangeslider"}function Lt(Ue,He){for(var Be=0;Be<He.length;Be++)Ue.indexOf(He[Be])===-1&&Ue.push(He[Be])}function wt(Ue,He,Be){var Je,_e,Le=[],Ce=[],Pe=Ue.layout;for(Je=0;Je<He.length;Je++)Le.push(D.getFromId(Ue,He[Je]));for(Je=0;Je<Be.length;Je++)Ce.push(D.getFromId(Ue,Be[Je]));var Xe=Object.keys(a),ut=["anchor","domain","overlaying","position","side","tickangle","editType"],kt=["linear","log"];for(Je=0;Je<Xe.length;Je++){var ft=Xe[Je],Et=Le[0][ft],mt=Ce[0][ft],It=!0,vt=!1,nt=!1;if(ft.charAt(0)!=="_"&&typeof Et!="function"&&ut.indexOf(ft)===-1){for(_e=1;_e<Le.length&&It;_e++){var At=Le[_e][ft];ft==="type"&&kt.indexOf(Et)!==-1&&kt.indexOf(At)!==-1&&Et!==At?vt=!0:At!==Et&&(It=!1)}for(_e=1;_e<Ce.length&&It;_e++){var Ft=Ce[_e][ft];ft==="type"&&kt.indexOf(mt)!==-1&&kt.indexOf(Ft)!==-1&&mt!==Ft?nt=!0:Ce[_e][ft]!==mt&&(It=!1)}It&&(vt&&(Pe[Le[0]._name].type="linear"),nt&&(Pe[Ce[0]._name].type="linear"),rt(Pe,ft,Le,Ce,Ue._fullLayout._dfltTitle))}}for(Je=0;Je<Ue._fullLayout.annotations.length;Je++){var Nt=Ue._fullLayout.annotations[Je];He.indexOf(Nt.xref)!==-1&&Be.indexOf(Nt.yref)!==-1&&e.swapAttrs(Pe.annotations[Je],["?"])}}function rt(Ue,He,Be,Je,_e){var Le,Ce=e.nestedProperty,Pe=Ce(Ue[Be[0]._name],He).get(),Xe=Ce(Ue[Je[0]._name],He).get();for(He==="title"&&(Pe&&Pe.text===_e.x&&(Pe.text=_e.y),Xe&&Xe.text===_e.y&&(Xe.text=_e.x)),Le=0;Le<Be.length;Le++)Ce(Ue,Be[Le]._name+"."+He).set(Xe);for(Le=0;Le<Je.length;Le++)Ce(Ue,Je[Le]._name+"."+He).set(Pe)}function $e(Ue){return Ue._id==="angularaxis"}function xt(Ue,He){for(var Be=He._rangebreaks.length,Je=0;Je<Be;Je++){var _e=He._rangebreaks[Je];if(Ue>=_e.min&&Ue<_e.max)return _e.max}return Ue}function Qt(Ue){return(Ue.ticklabelposition||"").indexOf("inside")!==-1}function $t(Ue,He){Qt(Ue._anchorAxis||{})&&Ue._hideCounterAxisInsideTickLabels&&Ue._hideCounterAxisInsideTickLabels(He)}D.getTickFormat=function(Ue){var He,Be,Je,_e,Le,Ce,Pe,Xe;function ut(Et){return typeof Et!="string"?Et:Number(Et.replace("M",""))*T}function kt(Et,mt){var It=["L","D"];if(typeof Et==typeof mt){if(typeof Et=="number")return Et-mt;var vt=It.indexOf(Et.charAt(0)),nt=It.indexOf(mt.charAt(0));return vt===nt?Number(Et.replace(/(L|D)/g,""))-Number(mt.replace(/(L|D)/g,"")):vt-nt}return typeof Et=="number"?1:-1}function ft(Et,mt){var It=mt[0]===null,vt=mt[1]===null,nt=kt(Et,mt[0])>=0,At=kt(Et,mt[1])<=0;return(It||nt)&&(vt||At)}if(Ue.tickformatstops&&Ue.tickformatstops.length>0)switch(Ue.type){case"date":case"linear":for(He=0;He<Ue.tickformatstops.length;He++)if((Je=Ue.tickformatstops[He]).enabled&&(_e=Ue.dtick,Le=Je.dtickrange,Ce=void 0,Pe=void 0,Xe=void 0,Ce=ut||function(Et){return Et},Pe=Le[0],Xe=Le[1],(!Pe&&typeof Pe!="number"||Ce(Pe)<=Ce(_e))&&(!Xe&&typeof Xe!="number"||Ce(Xe)>=Ce(_e)))){Be=Je;break}break;case"log":for(He=0;He<Ue.tickformatstops.length;He++)if((Je=Ue.tickformatstops[He]).enabled&&ft(Ue.dtick,Je.dtickrange)){Be=Je;break}}return Be?Be.value:Ue.tickformat},D.getSubplots=function(Ue,He){var Be=Ue._fullLayout._subplots,Je=Be.cartesian.concat(Be.gl2d||[]),_e=He?D.findSubplotsWithAxis(Je,He):Je;return _e.sort(function(Le,Ce){var Pe=Le.substr(1).split("y"),Xe=Ce.substr(1).split("y");return Pe[0]===Xe[0]?+Pe[1]-+Xe[1]:+Pe[0]-+Xe[0]}),_e},D.findSubplotsWithAxis=function(Ue,He){for(var Be=new RegExp(He._id.charAt(0)==="x"?"^"+He._id+"y":He._id+"$"),Je=[],_e=0;_e<Ue.length;_e++){var Le=Ue[_e];Be.test(Le)&&Je.push(Le)}return Je},D.makeClipPaths=function(Ue){var He=Ue._fullLayout;if(!He._hasOnlyLargeSploms){var Be,Je,_e={_offset:0,_length:He.width,_id:""},Le={_offset:0,_length:He.height,_id:""},Ce=D.list(Ue,"x",!0),Pe=D.list(Ue,"y",!0),Xe=[];for(Be=0;Be<Ce.length;Be++)for(Xe.push({x:Ce[Be],y:Le}),Je=0;Je<Pe.length;Je++)Be===0&&Xe.push({x:_e,y:Pe[Je]}),Xe.push({x:Ce[Be],y:Pe[Je]});var ut=He._clips.selectAll(".axesclip").data(Xe,function(kt){return kt.x._id+kt.y._id});ut.enter().append("clipPath").classed("axesclip",!0).attr("id",function(kt){return"clip"+He._uid+kt.x._id+kt.y._id}).append("rect"),ut.exit().remove(),ut.each(function(kt){t.select(this).select("rect").attr({x:kt.x._offset||0,y:kt.y._offset||0,width:kt.x._length||1,height:kt.y._length||1})})}},D.draw=function(Ue,He,Be){var Je=Ue._fullLayout;He==="redraw"&&Je._paper.selectAll("g.subplot").each(function(Le){var Ce=Le[0],Pe=Je._plots[Ce];if(Pe){var Xe=Pe.xaxis,ut=Pe.yaxis;Pe.xaxislayer.selectAll("."+Xe._id+"tick").remove(),Pe.yaxislayer.selectAll("."+ut._id+"tick").remove(),Pe.xaxislayer.selectAll("."+Xe._id+"tick2").remove(),Pe.yaxislayer.selectAll("."+ut._id+"tick2").remove(),Pe.xaxislayer.selectAll("."+Xe._id+"divider").remove(),Pe.yaxislayer.selectAll("."+ut._id+"divider").remove(),Pe.gridlayer&&Pe.gridlayer.selectAll("path").remove(),Pe.zerolinelayer&&Pe.zerolinelayer.selectAll("path").remove(),Je._infolayer.select(".g-"+Xe._id+"title").remove(),Je._infolayer.select(".g-"+ut._id+"title").remove()}});var _e=He&&He!=="redraw"?He:D.listIds(Ue);return e.syncOrAsync(_e.map(function(Le){return function(){if(Le){var Ce=D.getFromId(Ue,Le),Pe=D.drawOne(Ue,Ce,Be);return Ce._r=Ce.range.slice(),Ce._rl=e.simpleMap(Ce._r,Ce.r2l),Pe}}}))},D.drawOne=function(Ue,He,Be){var Je,_e,Le;Be=Be||{},He.setScale();var Ce=Ue._fullLayout,Pe=He._id,Xe=Pe.charAt(0),ut=D.counterLetter(Pe),kt=Ce._plots[He._mainSubplot];if(kt){var ft=kt[Xe+"axislayer"],Et=He._mainLinePosition,mt=He._mainMirrorPosition,It=He._vals=D.calcTicks(He),vt=[He.mirror,Et,mt].join("_");for(Je=0;Je<It.length;Je++)It[Je].axInfo=vt;He._selections={},He._tickAngles&&(He._prevTickAngles=He._tickAngles),He._tickAngles={},He._depth=null;var nt={};if(He.visible){var At,Ft,Nt=D.makeTransTickFn(He),Kt=D.makeTransTickLabelFn(He),Ie=He.ticks==="inside",ot=He.ticks==="outside";if(He.tickson==="boundaries"){var bt=function(Fr,Lr){var Qr,$r=[],Kr=function(en,Tn){var Mn=en.xbnd[Tn];Mn!==null&&$r.push(e.extendFlat({},en,{x:Mn}))};if(Lr.length){for(Qr=0;Qr<Lr.length;Qr++)Kr(Lr[Qr],0);Kr(Lr[Qr-1],1)}return $r}(0,It);Ft=D.clipEnds(He,bt),At=Ie?Ft:bt}else Ft=D.clipEnds(He,It),At=Ie&&He.ticklabelmode!=="period"?Ft:It;var Pt=He._gridVals=Ft,Vt=function(Fr,Lr){var Qr,$r,Kr=[],en=Lr.length&&Lr[Lr.length-1].x<Lr[0].x,Tn=function(Rn,Zt){var Ct=Rn.xbnd[Zt];Ct!==null&&Kr.push(e.extendFlat({},Rn,{x:Ct}))};if(Fr.showdividers&&Lr.length){for(Qr=0;Qr<Lr.length;Qr++){var Mn=Lr[Qr];Mn.text2!==$r&&Tn(Mn,en?1:0),$r=Mn.text2}Tn(Lr[Qr-1],en?0:1)}return Kr}(He,It);if(!Ce._hasOnlyLargeSploms){var nr=He._subplotsWith,Yt={};for(Je=0;Je<nr.length;Je++){_e=nr[Je];var Xt=(Le=Ce._plots[_e])[ut+"axis"],ar=Xt._mainAxis._id;if(!Yt[ar]){Yt[ar]=1;var hr=Xe==="x"?"M0,"+Xt._offset+"v"+Xt._length:"M"+Xt._offset+",0h"+Xt._length;D.drawGrid(Ue,He,{vals:Pt,counterAxis:Xt,layer:Le.gridlayer.select("."+Pe),path:hr,transFn:Nt}),D.drawZeroLine(Ue,He,{counterAxis:Xt,layer:Le.zerolinelayer,path:hr,transFn:Nt})}}}var mr=D.getTickSigns(He),sr=[];if(He.ticks){var fr,yr,zr,xr=D.makeTickPath(He,Et,mr[2]);if(He._anchorAxis&&He.mirror&&He.mirror!==!0?(fr=D.makeTickPath(He,mt,mr[3]),yr=xr+fr):(fr="",yr=xr),He.showdividers&&ot&&He.tickson==="boundaries"){var Br={};for(Je=0;Je<Vt.length;Je++)Br[Vt[Je].x]=1;zr=function(Fr){return Br[Fr.x]?fr:yr}}else zr=yr;D.drawTicks(Ue,He,{vals:At,layer:ft,path:zr,transFn:Nt}),He.mirror==="allticks"&&(sr=Object.keys(He._linepositions||{}))}for(Je=0;Je<sr.length;Je++){_e=sr[Je],Le=Ce._plots[_e];var Jr=He._linepositions[_e]||[],fn=D.makeTickPath(He,Jr[0],mr[0])+D.makeTickPath(He,Jr[1],mr[1]);D.drawTicks(Ue,He,{vals:At,layer:Le[Xe+"axislayer"],path:fn,transFn:Nt})}var Cn=[];if(Cn.push(function(){return D.drawLabels(Ue,He,{vals:It,layer:ft,plotinfo:Le,transFn:Kt,labelFns:D.makeLabelFns(He,Et)})}),He.type==="multicategory"){var Pn={x:2,y:10}[Xe];Cn.push(function(){var Fr={x:"height",y:"width"}[Xe],Lr=rn()[Fr]+Pn+(He._tickAngles[Pe+"tick"]?He.tickfont.size*Y:0);return D.drawLabels(Ue,He,{vals:Ye(He,It),layer:ft,cls:Pe+"tick2",repositionOnUpdate:!0,secondary:!0,transFn:Nt,labelFns:D.makeLabelFns(He,Et+Lr*mr[4])})}),Cn.push(function(){return He._depth=mr[4]*(rn("tick2")[He.side]-Et),function(Fr,Lr,Qr){var $r=Lr._id+"divider",Kr=Qr.vals,en=Qr.layer.selectAll("path."+$r).data(Kr,Oe);en.exit().remove(),en.enter().insert("path",":first-child").classed($r,1).classed("crisp",1).call(s.stroke,Lr.dividercolor).style("stroke-width",o.crispRound(Fr,Lr.dividerwidth,1)+"px"),en.attr("transform",Qr.transFn).attr("d",Qr.path)}(Ue,He,{vals:Vt,layer:ft,path:D.makeTickPath(He,Et,mr[4],He._depth),transFn:Nt})})}else He.title.hasOwnProperty("standoff")&&Cn.push(function(){He._depth=mr[4]*(rn()[He.side]-Et)});var An=p.getComponentMethod("rangeslider","isVisible")(He);return Cn.push(function(){var Fr,Lr,Qr,$r,Kr=He.side.charAt(0),en=K[He.side].charAt(0),Tn=D.getPxPosition(Ue,He),Mn=ot?He.ticklen:0;if((He.automargin||An)&&(He.type==="multicategory"?Fr=rn("tick2"):(Fr=rn(),Xe==="x"&&Kr==="b"&&(He._depth=Math.max(Fr.width>0?Fr.bottom-Tn:0,Mn)))),He.automargin){Lr={x:0,y:0,r:0,l:0,t:0,b:0};var Rn=[0,1];if(Xe==="x"){if(Kr==="b"?Lr[Kr]=He._depth:(Lr[Kr]=He._depth=Math.max(Fr.width>0?Tn-Fr.top:0,Mn),Rn.reverse()),Fr.width>0){var Zt=Fr.right-(He._offset+He._length);Zt>0&&(Lr.xr=1,Lr.r=Zt);var Ct=He._offset-Fr.left;Ct>0&&(Lr.xl=0,Lr.l=Ct)}}else if(Kr==="l"?Lr[Kr]=He._depth=Math.max(Fr.height>0?Tn-Fr.left:0,Mn):(Lr[Kr]=He._depth=Math.max(Fr.height>0?Fr.right-Tn:0,Mn),Rn.reverse()),Fr.height>0){var Ht=Fr.bottom-(He._offset+He._length);Ht>0&&(Lr.yb=0,Lr.b=Ht);var cr=He._offset-Fr.top;cr>0&&(Lr.yt=1,Lr.t=cr)}Lr[ut]=He.anchor==="free"?He.position:He._anchorAxis.domain[Rn[0]],He.title.text!==Ce._dfltTitle[Xe]&&(Lr[Kr]+=je(He)+(He.title.standoff||0)),He.mirror&&He.anchor!=="free"&&((Qr={x:0,y:0,r:0,l:0,t:0,b:0})[en]=He.linewidth,He.mirror&&He.mirror!==!0&&(Qr[en]+=Mn),He.mirror===!0||He.mirror==="ticks"?Qr[ut]=He._anchorAxis.domain[Rn[1]]:He.mirror!=="all"&&He.mirror!=="allticks"||(Qr[ut]=[He._counterDomainMin,He._counterDomainMax][Rn[1]]))}An&&($r=p.getComponentMethod("rangeslider","autoMarginOpts")(Ue,He)),g.autoMargin(Ue,Qe(He),Lr),g.autoMargin(Ue,it(He),Qr),g.autoMargin(Ue,lt(He),$r)}),Be.skipTitle||An&&He.side==="bottom"||Cn.push(function(){return function(Fr,Lr){var Qr,$r=Fr._fullLayout,Kr=Lr._id,en=Kr.charAt(0),Tn=Lr.title.font.size;if(Lr.title.hasOwnProperty("standoff"))Qr=Lr._depth+Lr.title.standoff+je(Lr);else{var Mn=Qt(Lr);if(Lr.type==="multicategory")Qr=Lr._depth;else{var Rn=1.5*Tn;Mn&&(Rn=.5*Tn,Lr.ticks==="outside"&&(Rn+=Lr.ticklen)),Qr=10+Rn+(Lr.linewidth?Lr.linewidth-1:0)}Mn||(Qr+=en==="x"?Lr.side==="top"?Tn*(Lr.showticklabels?1:0):Tn*(Lr.showticklabels?1.5:.5):Lr.side==="right"?Tn*(Lr.showticklabels?1:.5):Tn*(Lr.showticklabels?.5:0))}var Zt,Ct,Ht,cr,_r=D.getPxPosition(Fr,Lr);if(en==="x"?(Ct=Lr._offset+Lr._length/2,Ht=Lr.side==="top"?_r-Qr:_r+Qr):(Ht=Lr._offset+Lr._length/2,Ct=Lr.side==="right"?_r+Qr:_r-Qr,Zt={rotate:"-90",offset:0}),Lr.type!=="multicategory"){var Vr=Lr._selections[Lr._id+"tick"];if(cr={selection:Vr,side:Lr.side},Vr&&Vr.node()&&Vr.node().parentNode){var jr=o.getTranslate(Vr.node().parentNode);cr.offsetLeft=jr.x,cr.offsetTop=jr.y}Lr.title.hasOwnProperty("standoff")&&(cr.pad=0)}return i.draw(Fr,Kr+"title",{propContainer:Lr,propName:Lr._name+".title.text",placeholder:$r._dfltTitle[en],avoid:cr,transform:Zt,attributes:{x:Ct,y:Ht,"text-anchor":"middle"}})}(Ue,He)}),e.syncOrAsync(Cn)}}function rn(Fr){var Lr=Pe+(Fr||"tick");return nt[Lr]||(nt[Lr]=function(Qr,$r){var Kr,en,Tn,Mn;return Qr._selections[$r].size()?(Kr=1/0,en=-1/0,Tn=1/0,Mn=-1/0,Qr._selections[$r].each(function(){var Rn=Ge(this),Zt=o.bBox(Rn.node().parentNode);Kr=Math.min(Kr,Zt.top),en=Math.max(en,Zt.bottom),Tn=Math.min(Tn,Zt.left),Mn=Math.max(Mn,Zt.right)})):(Kr=0,en=0,Tn=0,Mn=0),{top:Kr,bottom:en,left:Tn,right:Mn,height:en-Kr,width:Mn-Tn}}(He,Lr)),nt[Lr]}},D.getTickSigns=function(Ue){var He=Ue._id.charAt(0),Be={x:"top",y:"right"}[He],Je=Ue.side===Be?1:-1,_e=[-1,1,Je,-Je];return Ue.ticks!=="inside"==(He==="x")&&(_e=_e.map(function(Le){return-Le})),Ue.side&&_e.push({l:-1,t:-1,r:1,b:1}[Ue.side.charAt(0)]),_e},D.makeTransTickFn=function(Ue){return Ue._id.charAt(0)==="x"?function(He){return f(Ue._offset+Ue.l2p(He.x),0)}:function(He){return f(0,Ue._offset+Ue.l2p(He.x))}},D.makeTransTickLabelFn=function(Ue){var He=function(_e){var Le=_e.ticklabelposition||"",Ce=function(At){return Le.indexOf(At)!==-1},Pe=Ce("top"),Xe=Ce("left"),ut=Ce("right"),kt=Ce("bottom"),ft=Ce("inside"),Et=kt||Xe||Pe||ut;if(!Et&&!ft)return[0,0];var mt=_e.side,It=Et?(_e.tickwidth||0)/2:0,vt=3,nt=_e.tickfont?_e.tickfont.size:12;return(kt||Pe)&&(It+=nt*G,vt+=(_e.linewidth||0)/2),(Xe||ut)&&(It+=(_e.linewidth||0)/2,vt+=3),ft&&mt==="top"&&(vt-=nt*(1-G)),(Xe||Pe)&&(It=-It),mt!=="bottom"&&mt!=="right"||(vt=-vt),[Et?It:0,ft?vt:0]}(Ue),Be=He[0],Je=He[1];return Ue._id.charAt(0)==="x"?function(_e){return f(Be+Ue._offset+Ue.l2p(et(_e)),Je)}:function(_e){return f(Je,Be+Ue._offset+Ue.l2p(et(_e)))}},D.makeTickPath=function(Ue,He,Be,Je){Je=Je!==void 0?Je:Ue.ticklen;var _e=Ue._id.charAt(0),Le=(Ue.linewidth||1)/2;return _e==="x"?"M0,"+(He+Le*Be)+"v"+Je*Be:"M"+(He+Le*Be)+",0h"+Je*Be},D.makeLabelFns=function(Ue,He,Be){var Je=Ue.ticklabelposition||"",_e=function(Yt){return Je.indexOf(Yt)!==-1},Le=_e("top"),Ce=_e("left"),Pe=_e("right"),Xe=_e("bottom")||Ce||Le||Pe,ut=_e("inside"),kt=Je==="inside"&&Ue.ticks==="inside"||!ut&&Ue.ticks==="outside"&&Ue.tickson!=="boundaries",ft=0,Et=0,mt=kt?Ue.ticklen:0;if(ut?mt*=-1:Xe&&(mt=0),kt&&(ft+=mt,Be)){var It=e.deg2rad(Be);ft=mt*Math.cos(It)+1,Et=mt*Math.sin(It)}Ue.showticklabels&&(kt||Ue.showline)&&(ft+=.2*Ue.tickfont.size);var vt,nt,At,Ft,Nt,Kt={labelStandoff:ft+=(Ue.linewidth||1)/2*(ut?-1:1),labelShift:Et},Ie=0,ot=Ue.side,bt=Ue._id.charAt(0),Pt=Ue.tickangle;if(bt==="x")Ft=(Nt=!ut&&ot==="bottom"||ut&&ot==="top")?1:-1,ut&&(Ft*=-1),vt=Et*Ft,nt=He+ft*Ft,At=Nt?1:-.2,Math.abs(Pt)===90&&(ut?At+=X:At=Pt===-90&&ot==="bottom"?G:Pt===90&&ot==="top"?X:.5,Ie=X/2*(Pt/90)),Kt.xFn=function(Yt){return Yt.dx+vt+Ie*Yt.fontSize},Kt.yFn=function(Yt){return Yt.dy+nt+Yt.fontSize*At},Kt.anchorFn=function(Yt,Xt){if(Xe){if(Ce)return"end";if(Pe)return"start"}return m(Xt)&&Xt!==0&&Xt!==180?Xt*Ft<0!==ut?"end":"start":"middle"},Kt.heightFn=function(Yt,Xt,ar){return Xt<-60||Xt>60?-.5*ar:Ue.side==="top"!==ut?-ar:0};else if(bt==="y"){if(Ft=(Nt=!ut&&ot==="left"||ut&&ot==="right")?1:-1,ut&&(Ft*=-1),vt=ft,nt=Et*Ft,At=0,ut||Math.abs(Pt)!==90||(At=Pt===-90&&ot==="left"||Pt===90&&ot==="right"?G:.5),ut){var Vt=m(Pt)?+Pt:0;if(Vt!==0){var nr=e.deg2rad(Vt);Ie=Math.abs(Math.sin(nr))*G*Ft,At=0}}Kt.xFn=function(Yt){return Yt.dx+He-(vt+Yt.fontSize*At)*Ft+Ie*Yt.fontSize},Kt.yFn=function(Yt){return Yt.dy+nt+Yt.fontSize*X},Kt.anchorFn=function(Yt,Xt){return m(Xt)&&Math.abs(Xt)===90?"middle":Nt?"end":"start"},Kt.heightFn=function(Yt,Xt,ar){return Ue.side==="right"&&(Xt*=-1),Xt<-30?-ar:Xt<30?-.5*ar:0}}return Kt},D.drawTicks=function(Ue,He,Be){Be=Be||{};var Je=He._id+"tick",_e=Be.vals;He.ticklabelmode==="period"&&(_e=_e.slice()).shift();var Le=Be.layer.selectAll("path."+Je).data(He.ticks?_e:[],Oe);Le.exit().remove(),Le.enter().append("path").classed(Je,1).classed("ticks",1).classed("crisp",Be.crisp!==!1).call(s.stroke,He.tickcolor).style("stroke-width",o.crispRound(Ue,He.tickwidth,1)+"px").attr("d",Be.path).style("display",null),$t(He,[W]),Le.attr("transform",Be.transFn)},D.drawGrid=function(Ue,He,Be){Be=Be||{};var Je=He._id+"grid",_e=Be.vals,Le=Be.counterAxis;if(He.showgrid===!1)_e=[];else if(Le&&D.shouldShowZeroLine(Ue,He,Le))for(var Ce=He.tickmode==="array",Pe=0;Pe<_e.length;Pe++){var Xe=_e[Pe].x;if(Ce?!Xe:Math.abs(Xe)<He.dtick/100){if(_e=_e.slice(0,Pe).concat(_e.slice(Pe+1)),!Ce)break;Pe--}}var ut=Be.layer.selectAll("path."+Je).data(_e,Oe);ut.exit().remove(),ut.enter().append("path").classed(Je,1).classed("crisp",Be.crisp!==!1),He._gw=o.crispRound(Ue,He.gridwidth,1),ut.attr("transform",Be.transFn).attr("d",Be.path).call(s.stroke,He.gridcolor||"#ddd").style("stroke-width",He._gw+"px").style("display",null),$t(He,[j]),typeof Be.path=="function"&&ut.attr("d",Be.path)},D.drawZeroLine=function(Ue,He,Be){Be=Be||Be;var Je=He._id+"zl",_e=D.shouldShowZeroLine(Ue,He,Be.counterAxis),Le=Be.layer.selectAll("path."+Je).data(_e?[{x:0,id:He._id}]:[]);Le.exit().remove(),Le.enter().append("path").classed(Je,1).classed("zl",1).classed("crisp",Be.crisp!==!1).each(function(){Be.layer.selectAll("path").sort(function(Ce,Pe){return ee(Ce.id,Pe.id)})}),Le.attr("transform",Be.transFn).attr("d",Be.path).call(s.stroke,He.zerolinecolor||s.defaultLine).style("stroke-width",o.crispRound(Ue,He.zerolinewidth,He._gw||1)+"px").style("display",null),$t(He,[F])},D.drawLabels=function(Ue,He,Be){Be=Be||{};var Je=Ue._fullLayout,_e=He._id,Le=_e.charAt(0),Ce=Be.cls||_e+"tick",Pe=Be.vals,Xe=Be.labelFns,ut=Be.secondary?0:He.tickangle,kt=(He._prevTickAngles||{})[Ce],ft=Be.layer.selectAll("g."+Ce).data(He.showticklabels?Pe:[],Oe),Et=[];function mt(Ft,Nt){Ft.each(function(Kt){var Ie=t.select(this),ot=Ie.select(".text-math-group"),bt=Xe.anchorFn(Kt,Nt),Pt=Be.transFn.call(Ie.node(),Kt)+(m(Nt)&&+Nt!=0?" rotate("+Nt+","+Xe.xFn(Kt)+","+(Xe.yFn(Kt)-Kt.fontSize/2)+")":""),Vt=u.lineCount(Ie),nr=Y*Kt.fontSize,Yt=Xe.heightFn(Kt,m(Nt)?+Nt:0,(Vt-1)*nr);if(Yt&&(Pt+=f(0,Yt)),ot.empty()){var Xt=Ie.select("text");Xt.attr({transform:Pt,"text-anchor":bt}),Xt.style("opacity",1),He._adjustTickLabelsOverflow&&He._adjustTickLabelsOverflow()}else{var ar=o.bBox(ot.node()).width*{end:-.5,start:.5}[bt];ot.attr("transform",Pt+f(ar,0))}})}ft.enter().append("g").classed(Ce,1).append("text").attr("text-anchor","middle").each(function(Ft){var Nt=t.select(this),Kt=Ue._promises.length;Nt.call(u.positionText,Xe.xFn(Ft),Xe.yFn(Ft)).call(o.font,Ft.font,Ft.fontSize,Ft.fontColor).text(Ft.text).call(u.convertToTspans,Ue),Ue._promises[Kt]?Et.push(Ue._promises.pop().then(function(){mt(Nt,ut)})):mt(Nt,ut)}),$t(He,[Z]),ft.exit().remove(),Be.repositionOnUpdate&&ft.each(function(Ft){t.select(this).select("text").call(u.positionText,Xe.xFn(Ft),Xe.yFn(Ft))}),He._adjustTickLabelsOverflow=function(){var Ft=He.ticklabeloverflow;if(Ft&&Ft!=="allow"){var Nt=Ft.indexOf("hide")!==-1,Kt=He._id.charAt(0)==="x",Ie=0,ot=Kt?Ue._fullLayout.width:Ue._fullLayout.height;if(Ft.indexOf("domain")!==-1){var bt=e.simpleMap(He.range,He.r2l);Ie=He.l2p(bt[0])+He._offset,ot=He.l2p(bt[1])+He._offset}var Pt=Math.min(Ie,ot),Vt=Math.max(Ie,ot),nr=He.side,Yt=1/0,Xt=-1/0;for(var ar in ft.each(function(sr){var fr=t.select(this);if(fr.select(".text-math-group").empty()){var yr=o.bBox(fr.node()),zr=0;Kt?(yr.right>Vt||yr.left<Pt)&&(zr=1):(yr.bottom>Vt||yr.top+(He.tickangle?0:sr.fontSize/4)<Pt)&&(zr=1);var xr=fr.select("text");zr?Nt&&xr.style("opacity",0):(xr.style("opacity",1),Yt=nr==="bottom"||nr==="right"?Math.min(Yt,Kt?yr.top:yr.left):-1/0,Xt=nr==="top"||nr==="left"?Math.max(Xt,Kt?yr.bottom:yr.right):1/0)}}),Je._plots){var hr=Je._plots[ar];if(He._id===hr.xaxis._id||He._id===hr.yaxis._id){var mr=Kt?hr.yaxis:hr.xaxis;mr&&(mr["_visibleLabelMin_"+He._id]=Yt,mr["_visibleLabelMax_"+He._id]=Xt)}}}},He._hideCounterAxisInsideTickLabels=function(Ft){var Nt=He._id.charAt(0)==="x",Kt=[];for(var Ie in Je._plots){var ot=Je._plots[Ie];He._id!==ot.xaxis._id&&He._id!==ot.yaxis._id||Kt.push(Nt?ot.yaxis:ot.xaxis)}Kt.forEach(function(bt,Pt){bt&&Qt(bt)&&(Ft||[F,j,W,Z]).forEach(function(Vt){var nr=Vt.K==="tick"&&Vt.L==="text"&&He.ticklabelmode==="period",Yt=Je._plots[He._mainSubplot];(Vt.K===F.K?Yt.zerolinelayer.selectAll("."+He._id+"zl"):Vt.K===j.K?Yt.gridlayer.selectAll("."+He._id):Yt[He._id.charAt(0)+"axislayer"]).each(function(){var Xt=t.select(this);Vt.L&&(Xt=Xt.selectAll(Vt.L)),Xt.each(function(ar){var hr=He.l2p(nr?et(ar):ar.x)+He._offset,mr=t.select(this);hr<He["_visibleLabelMax_"+bt._id]&&hr>He["_visibleLabelMin_"+bt._id]?mr.style("display","none"):Vt.K!=="tick"||Pt||mr.style("display",null)})})})})},mt(ft,kt+1?kt:ut);var It=null;He._selections&&(He._selections[Ce]=ft);var vt=[function(){return Et.length&&Promise.all(Et)}];He.automargin&&Je._redrawFromAutoMarginCount&&kt===90?(It=90,vt.push(function(){mt(ft,kt)})):vt.push(function(){if(mt(ft,ut),Pe.length&&Le==="x"&&!m(ut)&&(He.type!=="log"||String(He.dtick).charAt(0)!=="D")){It=0;var Ft,Nt=0,Kt=[];if(ft.each(function(fr){Nt=Math.max(Nt,fr.fontSize);var yr=He.l2p(fr.x),zr=Ge(this),xr=o.bBox(zr.node());Kt.push({top:0,bottom:10,height:10,left:yr-xr.width/2,right:yr+xr.width/2+2,width:xr.width+2})}),He.tickson!=="boundaries"&&!He.showdividers||Be.secondary){var Ie=Pe.length,ot=Math.abs((Pe[Ie-1].x-Pe[0].x)*He._m)/(Ie-1),bt=He.ticklabelposition||"",Pt=function(fr){return bt.indexOf(fr)!==-1},Vt=Pt("top"),nr=Pt("left"),Yt=Pt("right"),Xt=Pt("bottom")||nr||Vt||Yt?(He.tickwidth||0)+6:0,ar=ot<2.5*Nt||He.type==="multicategory";for(Ft=0;Ft<Kt.length-1;Ft++)if(e.bBoxIntersect(Kt[Ft],Kt[Ft+1],Xt)){It=ar?90:30;break}}else{var hr=2;for(He.ticks&&(hr+=He.tickwidth/2),Ft=0;Ft<Kt.length;Ft++){var mr=Pe[Ft].xbnd,sr=Kt[Ft];if(mr[0]!==null&&sr.left-He.l2p(mr[0])<hr||mr[1]!==null&&He.l2p(mr[1])-sr.right<hr){It=90;break}}}It&&mt(ft,It)}}),He._tickAngles&&vt.push(function(){He._tickAngles[Ce]=It===null?m(ut)?ut:0:It});var nt=He._anchorAxis;nt&&nt.autorange&&Qt(He)&&!J(Je,He._id)&&(Je._insideTickLabelsAutorange||(Je._insideTickLabelsAutorange={}),Je._insideTickLabelsAutorange[nt._name+".autorange"]=nt.autorange,vt.push(function(){ft.each(function(Ft,Nt){var Kt=Ge(this);Kt.select(".text-math-group").empty()&&(He._vals[Nt].bb=o.bBox(Kt.node()))})}));var At=e.syncOrAsync(vt);return At&&At.then&&Ue._promises.push(At),At},D.getPxPosition=function(Ue,He){var Be,Je=Ue._fullLayout._size,_e=He._id.charAt(0),Le=He.side;return He.anchor!=="free"?Be=He._anchorAxis:_e==="x"?Be={_offset:Je.t+(1-(He.position||0))*Je.h,_length:0}:_e==="y"&&(Be={_offset:Je.l+(He.position||0)*Je.w,_length:0}),Le==="top"||Le==="left"?Be._offset:Le==="bottom"||Le==="right"?Be._offset+Be._length:void 0},D.shouldShowZeroLine=function(Ue,He,Be){var Je=e.simpleMap(He.range,He.r2l);return Je[0]*Je[1]<=0&&He.zeroline&&(He.type==="linear"||He.type==="-")&&!(He.rangebreaks&&He.maskBreaks(0)===O)&&(We(He,0)||!function(_e,Le,Ce,Pe){var Xe=Ce._mainAxis;if(!Xe)return;var ut=_e._fullLayout,kt=Le._id.charAt(0),ft=D.counterLetter(Le._id),Et=Le._offset+(Math.abs(Pe[0])<Math.abs(Pe[1])==(kt==="x")?0:Le._length);function mt(Ft){if(!Ft.showline||!Ft.linewidth)return!1;var Nt=Math.max((Ft.linewidth+Le.zerolinewidth)/2,1);function Kt(bt){return typeof bt=="number"&&Math.abs(bt-Et)<Nt}if(Kt(Ft._mainLinePosition)||Kt(Ft._mainMirrorPosition))return!0;var Ie=Ft._linepositions||{};for(var ot in Ie)if(Kt(Ie[ot][0])||Kt(Ie[ot][1]))return!0}var It=ut._plots[Ce._mainSubplot];if(!(It.mainplotinfo||It).overlays.length)return mt(Ce);for(var vt=D.list(_e,ft),nt=0;nt<vt.length;nt++){var At=vt[nt];if(At._mainAxis===Xe&&mt(At))return!0}}(Ue,He,Be,Je)||function(_e,Le){for(var Ce=_e._fullData,Pe=Le._mainSubplot,Xe=Le._id.charAt(0),ut=0;ut<Ce.length;ut++){var kt=Ce[ut];if(kt.visible===!0&&kt.xaxis+kt.yaxis===Pe&&(p.traceIs(kt,"bar-like")&&kt.orientation==={x:"h",y:"v"}[Xe]||kt.fill&&kt.fill.charAt(kt.fill.length-1)===Xe))return!0}return!1}(Ue,He))},D.clipEnds=function(Ue,He){return He.filter(function(Be){return We(Ue,Be.x)})},D.allowAutoMargin=function(Ue){for(var He=D.list(Ue,"",!0),Be=0;Be<He.length;Be++){var Je=He[Be];Je.automargin&&(g.allowAutoMargin(Ue,Qe(Je)),Je.mirror&&g.allowAutoMargin(Ue,it(Je))),p.getComponentMethod("rangeslider","isVisible")(Je)&&g.allowAutoMargin(Ue,lt(Je))}},D.swap=function(Ue,He){for(var Be=function(_e,Le){var Ce,Pe,Xe=[];for(Ce=0;Ce<Le.length;Ce++){var ut=[],kt=_e._fullData[Le[Ce]].xaxis,ft=_e._fullData[Le[Ce]].yaxis;if(kt&&ft){for(Pe=0;Pe<Xe.length;Pe++)Xe[Pe].x.indexOf(kt)===-1&&Xe[Pe].y.indexOf(ft)===-1||ut.push(Pe);if(ut.length){var Et,mt=Xe[ut[0]];if(ut.length>1)for(Pe=1;Pe<ut.length;Pe++)Et=Xe[ut[Pe]],Lt(mt.x,Et.x),Lt(mt.y,Et.y);Lt(mt.x,[kt]),Lt(mt.y,[ft])}else Xe.push({x:[kt],y:[ft]})}}return Xe}(Ue,He),Je=0;Je<Be.length;Je++)wt(Ue,Be[Je].x,Be[Je].y)}},{"../../components/color":650,"../../components/drawing":672,"../../components/titles":748,"../../constants/alignment":755,"../../constants/numerical":763,"../../lib":787,"../../lib/svg_text_utils":813,"../../plots/plots":901,"../../registry":915,"./autorange":837,"./axis_autotype":839,"./axis_ids":842,"./clean_ticks":844,"./layout_attributes":853,"./set_convert":859,"@plotly/d3":58,"fast-isnumeric":246}],839:[function(h,N,H){var t=h("fast-isnumeric"),m=h("../../lib"),g=h("../../constants/numerical").BADNUM,p=m.isArrayOrTypedArray,e=m.isDateTime,f=m.cleanNumber,u=Math.round;function i(o,a){return a?t(o):typeof o=="number"}function s(o){return Math.max(1,(o-1)/1e3)}N.exports=function(o,a,c){var r=o,n=c.noMultiCategory;if(p(r)&&!r.length)return"-";if(!n&&function(_){return p(_[0])&&p(_[1])}(r))return"multicategory";if(n&&Array.isArray(r[0])){for(var d=[],l=0;l<r.length;l++)if(p(r[l]))for(var y=0;y<r[l].length;y++)d.push(r[l][y]);r=d}if(function(_,x){for(var T=_.length,A=s(T),S=0,w=0,L={},k=0;k<T;k+=A){var C=u(k),M=_[C],P=String(M);L[P]||(L[P]=1,e(M,x)&&S++,t(M)&&w++)}return S>2*w}(r,a))return"date";var v=c.autotypenumbers!=="strict";return function(_,x){for(var T=_.length,A=s(T),S=0,w=0,L={},k=0;k<T;k+=A){var C=u(k),M=_[C],P=String(M);if(!L[P]){L[P]=1;var O=typeof M;O==="boolean"?w++:(x?f(M)!==g:O==="number")?S++:O==="string"&&w++}}return w>2*S}(r,v)?"category":function(_,x){for(var T=_.length,A=0;A<T;A++)if(i(_[A],x))return!0;return!1}(r,v)?"linear":"-"}},{"../../constants/numerical":763,"../../lib":787,"fast-isnumeric":246}],840:[function(h,N,H){var t=h("fast-isnumeric"),m=h("../../registry"),g=h("../../lib"),p=h("../array_container_defaults"),e=h("./layout_attributes"),f=h("./tick_value_defaults"),u=h("./tick_mark_defaults"),i=h("./tick_label_defaults"),s=h("./category_order_defaults"),o=h("./line_grid_defaults"),a=h("./set_convert"),c=h("./constants").WEEKDAY_PATTERN,r=h("./constants").HOUR_PATTERN;function n(y,v,_){function x(M,P){return g.coerce(y,v,e.rangebreaks,M,P)}if(x("enabled")){var T=x("bounds");if(T&&T.length>=2){var A,S,w="";if(T.length===2){for(A=0;A<2;A++)if(S=l(T[A])){w=c;break}}var L=x("pattern",w);if(L===c)for(A=0;A<2;A++)(S=l(T[A]))&&(v.bounds[A]=T[A]=S-1);if(L)for(A=0;A<2;A++)switch(S=T[A],L){case c:if(!t(S)||(S=+S)!==Math.floor(S)||S<0||S>=7)return void(v.enabled=!1);v.bounds[A]=T[A]=S;break;case r:if(!t(S)||(S=+S)<0||S>24)return void(v.enabled=!1);v.bounds[A]=T[A]=S}if(_.autorange===!1){var k=_.range;if(k[0]<k[1]){if(T[0]<k[0]&&T[1]>k[1])return void(v.enabled=!1)}else if(T[0]>k[0]&&T[1]<k[1])return void(v.enabled=!1)}}else{var C=x("values");if(!C||!C.length)return void(v.enabled=!1);x("dvalue")}}}N.exports=function(y,v,_,x,T){var A,S=x.letter,w=x.font||{},L=x.splomStash||{},k=_("visible",!x.visibleDflt),C=v._template||{},M=v.type||C.type||"-";M==="date"&&(m.getComponentMethod("calendars","handleDefaults")(y,v,"calendar",x.calendar),x.noTicklabelmode||(A=_("ticklabelmode")));var P="";x.noTicklabelposition&&M!=="multicategory"||(P=g.coerce(y,v,{ticklabelposition:{valType:"enumerated",dflt:"outside",values:A==="period"?["outside","inside"]:S==="x"?["outside","inside","outside left","inside left","outside right","inside right"]:["outside","inside","outside top","inside top","outside bottom","inside bottom"]}},"ticklabelposition")),x.noTicklabeloverflow||_("ticklabeloverflow",P.indexOf("inside")!==-1?"hide past domain":M==="category"||M==="multicategory"?"allow":"hide past div"),a(v,T);var O=!v.isValidRange(y.range);O&&x.reverseDflt&&(O="reversed"),!_("autorange",O)||M!=="linear"&&M!=="-"||_("rangemode"),_("range"),v.cleanRange(),s(y,v,_,x),M==="category"||x.noHover||_("hoverformat");var F=_("color"),j=F!==e.color.dflt?F:w.color,W=L.label||T._dfltTitle[S];if(i(y,v,_,M,x,{pass:1}),!k)return v;_("title.text",W),g.coerceFont(_,"title.font",{family:w.family,size:g.bigFont(w.size),color:j}),f(y,v,_,M),i(y,v,_,M,x,{pass:2}),u(y,v,_,x),o(y,v,_,{dfltColor:F,bgColor:x.bgColor,showGrid:x.showGrid,attributes:e}),(v.showline||v.ticks)&&_("mirror"),x.automargin&&_("automargin");var Z,Q=M==="multicategory";if(x.noTickson||M!=="category"&&!Q||!v.ticks&&!v.showgrid||(Q&&(Z="boundaries"),_("tickson",Z)==="boundaries"&&delete v.ticklabelposition),Q&&_("showdividers")&&(_("dividercolor"),_("dividerwidth")),M==="date")if(p(y,v,{name:"rangebreaks",inclusionAttr:"enabled",handleItemDefaults:n}),v.rangebreaks.length){for(var X=0;X<v.rangebreaks.length;X++)if(v.rangebreaks[X].pattern===c){v._hasDayOfWeekBreaks=!0;break}if(a(v,T),T._has("scattergl")||T._has("splom"))for(var G=0;G<x.data.length;G++){var Y=x.data[G];Y.type!=="scattergl"&&Y.type!=="splom"||(Y.visible=!1,g.warn(Y.type+" traces do not work on axes with rangebreaks. Setting trace "+Y.index+" to `visible: false`."))}}else delete v.rangebreaks;return v};var d={sun:1,mon:2,tue:3,wed:4,thu:5,fri:6,sat:7};function l(y){if(typeof y=="string")return d[y.substr(0,3).toLowerCase()]}},{"../../lib":787,"../../registry":915,"../array_container_defaults":833,"./category_order_defaults":843,"./constants":845,"./layout_attributes":853,"./line_grid_defaults":855,"./set_convert":859,"./tick_label_defaults":860,"./tick_mark_defaults":861,"./tick_value_defaults":862,"fast-isnumeric":246}],841:[function(h,N,H){var t=h("../../constants/docs"),m=t.FORMAT_LINK,g=t.DATE_FORMAT_LINK;function p(f,u){return["Sets the "+f+" formatting rule"+(u?"for `"+u+"` ":""),"using d3 formatting mini-languages","which are very similar to those in Python. For numbers, see: "+m+"."].join(" ")}function e(f,u){return p(f,u)+[" And for dates see: "+g+".","We add two items to d3's date formatter:","*%h* for half of the year as a decimal number as well as","*%{n}f* for fractional seconds","with n digits. For example, *2016-10-13 09:15:23.456* with tickformat","*%H~%M~%S.%2f* would display *09~15~23.46*"].join(" ")}N.exports={axisHoverFormat:function(f,u){return{valType:"string",dflt:"",editType:"none",description:(u?p:e)("hover text",f)+["By default the values are formatted using "+(u?"generic number format":"`"+f+"axis.hoverformat`")+"."].join(" ")}},descriptionOnlyNumbers:p,descriptionWithDates:e}},{"../../constants/docs":758}],842:[function(h,N,H){var t=h("../../registry"),m=h("./constants");function g(p,e){if(e&&e.length){for(var f=0;f<e.length;f++)if(e[f][p])return!0}return!1}H.id2name=function(p){if(typeof p=="string"&&p.match(m.AX_ID_PATTERN)){var e=p.split(" ")[0].substr(1);return e==="1"&&(e=""),p.charAt(0)+"axis"+e}},H.name2id=function(p){if(p.match(m.AX_NAME_PATTERN)){var e=p.substr(5);return e==="1"&&(e=""),p.charAt(0)+e}},H.cleanId=function(p,e,f){var u=/( domain)$/.test(p);if(typeof p=="string"&&p.match(m.AX_ID_PATTERN)&&(!e||p.charAt(0)===e)&&(!u||f)){var i=p.split(" ")[0].substr(1).replace(/^0+/,"");return i==="1"&&(i=""),p.charAt(0)+i+(u&&f?" domain":"")}},H.list=function(p,e,f){var u=p._fullLayout;if(!u)return[];var i,s=H.listIds(p,e),o=new Array(s.length);for(i=0;i<s.length;i++){var a=s[i];o[i]=u[a.charAt(0)+"axis"+a.substr(1)]}if(!f){var c=u._subplots.gl3d||[];for(i=0;i<c.length;i++){var r=u[c[i]];e?o.push(r[e+"axis"]):o.push(r.xaxis,r.yaxis,r.zaxis)}}return o},H.listIds=function(p,e){var f=p._fullLayout;if(!f)return[];var u=f._subplots;return e?u[e+"axis"]:u.xaxis.concat(u.yaxis)},H.getFromId=function(p,e,f){var u=p._fullLayout;return e=e===void 0||typeof e!="string"?e:e.replace(" domain",""),f==="x"?e=e.replace(/y[0-9]*/,""):f==="y"&&(e=e.replace(/x[0-9]*/,"")),u[H.id2name(e)]},H.getFromTrace=function(p,e,f){var u=p._fullLayout,i=null;if(t.traceIs(e,"gl3d")){var s=e.scene;s.substr(0,5)==="scene"&&(i=u[s][f+"axis"])}else i=H.getFromId(p,e[f+"axis"]||f);return i},H.idSort=function(p,e){var f=p.charAt(0),u=e.charAt(0);return f!==u?f>u?1:-1:+(p.substr(1)||1)-+(e.substr(1)||1)},H.ref2id=function(p){return!!/^[xyz]/.test(p)&&p.split(" ")[0]},H.isLinked=function(p,e){return g(e,p._axisMatchGroups)||g(e,p._axisConstraintGroups)}},{"../../registry":915,"./constants":845}],843:[function(h,N,H){N.exports=function(t,m,g,p){if(m.type==="category"){var e,f=t.categoryarray,u=Array.isArray(f)&&f.length>0;u&&(e="array");var i,s=g("categoryorder",e);s==="array"&&(i=g("categoryarray")),u||s!=="array"||(s=m.categoryorder="trace"),s==="trace"?m._initialCategories=[]:s==="array"?m._initialCategories=i.slice():(i=function(o,a){var c,r,n,d=a.dataAttr||o._id.charAt(0),l={};if(a.axData)c=a.axData;else for(c=[],r=0;r<a.data.length;r++){var y=a.data[r];y[d+"axis"]===o._id&&c.push(y)}for(r=0;r<c.length;r++){var v=c[r][d];for(n=0;n<v.length;n++){var _=v[n];_!=null&&(l[_]=1)}}return Object.keys(l)}(m,p).sort(),s==="category ascending"?m._initialCategories=i:s==="category descending"&&(m._initialCategories=i.reverse()))}}},{}],844:[function(h,N,H){var t=h("fast-isnumeric"),m=h("../../lib"),g=h("../../constants/numerical"),p=g.ONEDAY,e=g.ONEWEEK;H.dtick=function(f,u){var i=u==="log",s=u==="date",o=u==="category",a=s?p:1;if(!f)return a;if(t(f))return(f=Number(f))<=0?a:o?Math.max(1,Math.round(f)):s?Math.max(.1,f):f;if(typeof f!="string"||!s&&!i)return a;var c=f.charAt(0),r=f.substr(1);return(r=t(r)?Number(r):0)<=0||!(s&&c==="M"&&r===Math.round(r)||i&&c==="L"||i&&c==="D"&&(r===1||r===2))?a:f},H.tick0=function(f,u,i,s){return u==="date"?m.cleanDate(f,m.dateTick0(i,s%e==0?1:0)):s!=="D1"&&s!=="D2"?t(f)?Number(f):0:void 0}},{"../../constants/numerical":763,"../../lib":787,"fast-isnumeric":246}],845:[function(h,N,H){var t=h("../../lib/regex").counter;N.exports={idRegex:{x:t("x","( domain)?"),y:t("y","( domain)?")},attrRegex:t("[xy]axis"),xAxisMatch:t("xaxis"),yAxisMatch:t("yaxis"),AX_ID_PATTERN:/^[xyz][0-9]*( domain)?$/,AX_NAME_PATTERN:/^[xyz]axis[0-9]*$/,SUBPLOT_PATTERN:/^x([0-9]*)y([0-9]*)$/,HOUR_PATTERN:"hour",WEEKDAY_PATTERN:"day of week",MINDRAG:8,MINSELECT:12,MINZOOM:20,DRAGGERSIZE:20,BENDPX:1.5,REDRAWDELAY:50,SELECTDELAY:100,SELECTID:"-select",DFLTRANGEX:[-1,6],DFLTRANGEY:[-1,4],traceLayerClasses:["imagelayer","heatmaplayer","contourcarpetlayer","contourlayer","funnellayer","waterfalllayer","barlayer","carpetlayer","violinlayer","boxlayer","ohlclayer","scattercarpetlayer","scatterlayer"],clipOnAxisFalseQuery:[".scatterlayer",".barlayer",".funnellayer",".waterfalllayer"],layerValue2layerClass:{"above traces":"above","below traces":"below"}}},{"../../lib/regex":804}],846:[function(h,N,H){var t=h("../../lib"),m=h("./autorange"),g=h("./axis_ids").id2name,p=h("./layout_attributes"),e=h("./scale_zoom"),f=h("./set_convert"),u=h("../../constants/numerical").ALMOST_EQUAL,i=h("../../constants/alignment").FROM_BL;function s(l,y,v){var _=v.axIds,x=v.layoutOut,T=v.hasImage,A=x._axisConstraintGroups,S=x._axisMatchGroups,w=y._id,L=w.charAt(0),k=((x._splomAxes||{})[L]||{})[w]||{},C=y._id,M=C.charAt(0)==="x";function P(ee,J){return t.coerce(l,y,p,ee,J)}y._matchGroup=null,y._constraintGroup=null,P("constrain",T?"domain":"range"),t.coerce(l,y,{constraintoward:{valType:"enumerated",values:M?["left","center","right"]:["bottom","middle","top"],dflt:M?"center":"middle"}},"constraintoward");var O,F,j=y.type,W=[];for(O=0;O<_.length;O++)(F=_[O])!==C&&x[g(F)].type===j&&W.push(F);var Z=a(A,C);if(Z){var Q=[];for(O=0;O<W.length;O++)Z[F=W[O]]||Q.push(F);W=Q}var X,G,Y=W.length;Y&&(l.matches||k.matches)&&(X=t.coerce(l,y,{matches:{valType:"enumerated",values:W,dflt:W.indexOf(k.matches)!==-1?k.matches:void 0}},"matches"));var K=T&&!M?y.anchor:void 0;if(Y&&!X&&(l.scaleanchor||K)&&(G=t.coerce(l,y,{scaleanchor:{valType:"enumerated",values:W}},"scaleanchor",K)),X){y._matchGroup=c(S,C,X,1);var D=x[g(X)],B=o(x,y)/o(x,D);M!==(X.charAt(0)==="x")&&(B=(M?"x":"y")+B),c(A,C,X,B)}else l.matches&&_.indexOf(l.matches)!==-1&&t.warn("ignored "+y._name+'.matches: "'+l.matches+'" to avoid an infinite loop');if(G){var q=P("scaleratio");q||(q=y.scaleratio=1),c(A,C,G,q)}else l.scaleanchor&&_.indexOf(l.scaleanchor)!==-1&&t.warn("ignored "+y._name+'.scaleanchor: "'+l.scaleanchor+'" to avoid either an infinite loop and possibly inconsistent scaleratios, or because this axis declares a *matches* constraint.')}function o(l,y){var v=y.domain;return v||(v=l[g(y.overlaying)].domain),v[1]-v[0]}function a(l,y){for(var v=0;v<l.length;v++)if(l[v][y])return l[v];return null}function c(l,y,v,_){var x,T,A,S,w,L=a(l,y);L===null?((L={})[y]=1,w=l.length,l.push(L)):w=l.indexOf(L);var k=Object.keys(L);for(x=0;x<l.length;x++)if(A=l[x],x!==w&&A[v]){var C=A[v];for(T=0;T<k.length;T++)A[S=k[T]]=r(C,r(_,L[S]));return void l.splice(w,1)}if(_!==1)for(T=0;T<k.length;T++){var M=k[T];L[M]=r(_,L[M])}L[v]=1}function r(l,y){var v,_,x="",T="";typeof l=="string"&&(v=(x=l.match(/^[xy]*/)[0]).length,l=+l.substr(v)),typeof y=="string"&&(_=(T=y.match(/^[xy]*/)[0]).length,y=+y.substr(_));var A=l*y;return v||_?v&&_&&x.charAt(0)!==T.charAt(0)?v===_?A:(v>_?x.substr(_):T.substr(v))+A:x+T+l*y:A}function n(l,y){for(var v=y._size,_=v.h/v.w,x={},T=Object.keys(l),A=0;A<T.length;A++){var S=T[A],w=l[S];if(typeof w=="string"){var L=w.match(/^[xy]*/)[0],k=L.length;w=+w.substr(k);for(var C=L.charAt(0)==="y"?_:1/_,M=0;M<k;M++)w*=C}x[S]=w}return x}function d(l,y){var v=l._inputDomain,_=i[l.constraintoward],x=v[0]+(v[1]-v[0])*_;l.domain=l._input.domain=[x+(v[0]-x)/y,x+(v[1]-x)/y],l.setScale()}H.handleDefaults=function(l,y,v){var _,x,T,A,S,w,L,k,C=v.axIds,M=v.axHasImage,P=y._axisConstraintGroups=[],O=y._axisMatchGroups=[];for(_=0;_<C.length;_++)s(S=l[A=g(C[_])],w=y[A],{axIds:C,layoutOut:y,hasImage:M[A]});function F(D,B){for(_=0;_<D.length;_++)for(T in x=D[_])y[g(T)][B]=x}for(F(O,"_matchGroup"),_=0;_<P.length;_++)for(T in x=P[_])if((w=y[g(T)]).fixedrange){for(var j in x){var W=g(j);(l[W]||{}).fixedrange===!1&&t.warn("fixedrange was specified as false for axis "+W+" but was overridden because another axis in its constraint group has fixedrange true"),y[W].fixedrange=!0}break}for(_=0;_<P.length;){for(T in x=P[_]){(w=y[g(T)])._matchGroup&&Object.keys(w._matchGroup).length===Object.keys(x).length&&(P.splice(_,1),_--);break}_++}F(P,"_constraintGroup");var Z=["constrain","range","autorange","rangemode","rangebreaks","categoryorder","categoryarray"],Q=!1,X=!1;function G(){k=w[L],L==="rangebreaks"&&(X=w._hasDayOfWeekBreaks)}for(_=0;_<O.length;_++){x=O[_];for(var Y=0;Y<Z.length;Y++){var K;for(T in L=Z[Y],k=null,x)if(S=l[A=g(T)],w=y[A],L in w){if(!w.matches&&(K=w,L in S)){G();break}k===null&&L in S&&G()}if(L==="range"&&k&&(Q=!0),L==="autorange"&&k===null&&Q&&(k=!1),k===null&&L in K&&(k=K[L]),k!==null)for(T in x)(w=y[g(T)])[L]=L==="range"?k.slice():k,L==="rangebreaks"&&(w._hasDayOfWeekBreaks=X,f(w,y))}}},H.enforce=function(l){var y,v,_,x,T,A,S,w,L=l._fullLayout,k=L._axisConstraintGroups||[];for(y=0;y<k.length;y++){_=n(k[y],L);var C=Object.keys(_),M=1/0,P=0,O=1/0,F={},j={},W=!1;for(v=0;v<C.length;v++)j[x=C[v]]=T=L[g(x)],T._inputDomain?T.domain=T._inputDomain.slice():T._inputDomain=T.domain.slice(),T._inputRange||(T._inputRange=T.range.slice()),T.setScale(),F[x]=A=Math.abs(T._m)/_[x],M=Math.min(M,A),T.constrain!=="domain"&&T._constraintShrinkable||(O=Math.min(O,A)),delete T._constraintShrinkable,P=Math.max(P,A),T.constrain==="domain"&&(W=!0);if(!(M>u*P)||W){for(v=0;v<C.length;v++)if(A=F[x=C[v]],S=(T=j[x]).constrain,A!==O||S==="domain")if(w=A/O,S==="range")e(T,w);else{var Z=T._inputDomain,Q=(T.domain[1]-T.domain[0])/(Z[1]-Z[0]),X=(T.r2l(T.range[1])-T.r2l(T.range[0]))/(T.r2l(T._inputRange[1])-T.r2l(T._inputRange[0]));if((w/=Q)*X<1){T.domain=T._input.domain=Z.slice(),e(T,w);continue}if(X<1&&(T.range=T._input.range=T._inputRange.slice(),w*=X),T.autorange){var G=T.r2l(T.range[0]),Y=T.r2l(T.range[1]),K=(G+Y)/2,D=K,B=K,q=Math.abs(Y-K),ee=K-q*w*1.0001,J=K+q*w*1.0001,$=m.makePadFn(L,T,0),te=m.makePadFn(L,T,1);d(T,w);var ie,ae,he=Math.abs(T._m),se=m.concatExtremes(l,T),de=se.min,ce=se.max;for(ae=0;ae<de.length;ae++)(ie=de[ae].val-$(de[ae])/he)>ee&&ie<D&&(D=ie);for(ae=0;ae<ce.length;ae++)(ie=ce[ae].val+te(ce[ae])/he)<J&&ie>B&&(B=ie);w/=(B-D)/(2*q),D=T.l2r(D),B=T.l2r(B),T.range=T._input.range=G<Y?[D,B]:[B,D]}d(T,w)}}}},H.getAxisGroup=function(l,y){for(var v=l._axisMatchGroups,_=0;_<v.length;_++)if(v[_][y])return"g"+_;return y},H.clean=function(l,y){if(y._inputDomain){for(var v=!1,_=y._id,x=l._fullLayout._axisConstraintGroups,T=0;T<x.length;T++)if(x[T][_]){v=!0;break}v&&y.constrain==="domain"||(y._input.domain=y.domain=y._inputDomain,delete y._inputDomain)}}},{"../../constants/alignment":755,"../../constants/numerical":763,"../../lib":787,"./autorange":837,"./axis_ids":842,"./layout_attributes":853,"./scale_zoom":857,"./set_convert":859}],847:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../lib"),g=m.numberFormat,p=h("tinycolor2"),e=h("has-passive-events"),f=h("../../registry"),u=m.strTranslate,i=h("../../lib/svg_text_utils"),s=h("../../components/color"),o=h("../../components/drawing"),a=h("../../components/fx"),c=h("./axes"),r=h("../../lib/setcursor"),n=h("../../components/dragelement"),d=h("../../components/dragelement/helpers"),l=d.selectingOrDrawing,y=d.freeMode,v=h("../../constants/alignment").FROM_TL,_=h("../../lib/clear_gl_canvases"),x=h("../../plot_api/subroutines").redrawReglTraces,T=h("../plots"),A=h("./axis_ids").getFromId,S=h("./select").prepSelect,w=h("./select").clearSelect,L=h("./select").selectOnClick,k=h("./scale_zoom"),C=h("./constants"),M=C.MINDRAG,P=C.MINZOOM,O=!0;function F(ie,ae,he,se){var de=m.ensureSingle(ie.draglayer,ae,he,function(ce){ce.classed("drag",!0).style({fill:"transparent","stroke-width":0}).attr("data-subplot",ie.id)});return de.call(r,se),de.node()}function j(ie,ae,he,se,de,ce,ve){var ke=F(ie,"rect",ae,he);return t.select(ke).call(o.setRect,se,de,ce,ve),ke}function W(ie,ae){for(var he=0;he<ie.length;he++)if(!ie[he].fixedrange)return ae;return""}function Z(ie,ae,he,se,de){for(var ce=0;ce<ie.length;ce++){var ve=ie[ce];if(!ve.fixedrange)if(ve.rangebreaks){var ke=ve._id.charAt(0)==="y",Ee=ke?1-ae:ae,be=ke?1-he:he;se[ve._name+".range[0]"]=ve.l2r(ve.p2l(Ee*ve._length)),se[ve._name+".range[1]"]=ve.l2r(ve.p2l(be*ve._length))}else{var xe=ve._rl[0],ue=ve._rl[1]-xe;se[ve._name+".range[0]"]=ve.l2r(xe+ue*ae),se[ve._name+".range[1]"]=ve.l2r(xe+ue*he)}}if(de&&de.length){var me=(ae+(1-he))/2;Z(de,me,1-me,se,[])}}function Q(ie,ae){for(var he=0;he<ie.length;he++){var se=ie[he];if(!se.fixedrange)if(se.rangebreaks){var de=se._length,ce=(se.p2l(0+ae)-se.p2l(0)+(se.p2l(de+ae)-se.p2l(de)))/2;se.range=[se.l2r(se._rl[0]-ce),se.l2r(se._rl[1]-ce)]}else se.range=[se.l2r(se._rl[0]-ae/se._m),se.l2r(se._rl[1]-ae/se._m)]}}function X(ie){return 1-(ie>=0?Math.min(ie,.9):1/(1/Math.max(ie,-.3)+3.222))}function G(ie,ae,he,se,de){return ie.append("path").attr("class","zoombox").style({fill:ae>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("transform",u(he,se)).attr("d",de+"Z")}function Y(ie,ae,he){return ie.append("path").attr("class","zoombox-corners").style({fill:s.background,stroke:s.defaultLine,"stroke-width":1,opacity:0}).attr("transform",u(ae,he)).attr("d","M0,0Z")}function K(ie,ae,he,se,de,ce){ie.attr("d",se+"M"+he.l+","+he.t+"v"+he.h+"h"+he.w+"v-"+he.h+"h-"+he.w+"Z"),D(ie,ae,de,ce)}function D(ie,ae,he,se){he||(ie.transition().style("fill",se>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),ae.transition().style("opacity",1).duration(200))}function B(ie){t.select(ie).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}function q(ie){O&&ie.data&&ie._context.showTips&&(m.notifier(m._(ie,"Double-click to zoom back out"),"long"),O=!1)}function ee(ie){var ae=Math.floor(Math.min(ie.b-ie.t,ie.r-ie.l,P)/2);return"M"+(ie.l-3.5)+","+(ie.t-.5+ae)+"h3v"+-ae+"h"+ae+"v-3h-"+(ae+3)+"ZM"+(ie.r+3.5)+","+(ie.t-.5+ae)+"h-3v"+-ae+"h"+-ae+"v-3h"+(ae+3)+"ZM"+(ie.r+3.5)+","+(ie.b+.5-ae)+"h-3v"+ae+"h"+-ae+"v3h"+(ae+3)+"ZM"+(ie.l-3.5)+","+(ie.b+.5-ae)+"h3v"+ae+"h"+ae+"v3h-"+(ae+3)+"Z"}function J(ie,ae,he,se,de){for(var ce,ve,ke,Ee,be=!1,xe={},ue={},me=(de||{}).xaHash,we=(de||{}).yaHash,Me=0;Me<ae.length;Me++){var Se=ae[Me];for(ce in he)if(Se[ce]){for(ke in Se)de&&(me[ke]||we[ke])||(ke.charAt(0)==="x"?he:se)[ke]||(xe[ke]=ce);for(ve in se)de&&(me[ve]||we[ve])||!Se[ve]||(be=!0)}for(ve in se)if(Se[ve])for(Ee in Se)de&&(me[Ee]||we[Ee])||(Ee.charAt(0)==="x"?he:se)[Ee]||(ue[Ee]=ve)}be&&(m.extendFlat(xe,ue),ue={});var De={},Fe=[];for(ke in xe){var Ye=A(ie,ke);Fe.push(Ye),De[Ye._id]=Ye}var et={},Oe=[];for(Ee in ue){var je=A(ie,Ee);Oe.push(je),et[je._id]=je}return{xaHash:De,yaHash:et,xaxes:Fe,yaxes:Oe,xLinks:xe,yLinks:ue,isSubplotConstrained:be}}function $(ie,ae){if(e){var he=ie.onwheel!==void 0?"wheel":"mousewheel";ie._onwheel&&ie.removeEventListener(he,ie._onwheel),ie._onwheel=ae,ie.addEventListener(he,ae,{passive:!1})}else ie.onwheel!==void 0?ie.onwheel=ae:ie.onmousewheel!==void 0?ie.onmousewheel=ae:ie.isAddedWheelEvent||(ie.isAddedWheelEvent=!0,ie.addEventListener("wheel",ae,{passive:!1}))}function te(ie){var ae=[];for(var he in ie)ae.push(ie[he]);return ae}N.exports={makeDragBox:function(ie,ae,he,se,de,ce,ve,ke){var Ee,be,xe,ue,me,we,Me,Se,De,Fe,Ye,et,Oe,je,We,Ge,Qe,it,lt,Lt,wt,rt,$e,xt=ie._fullLayout._zoomlayer,Qt=ve+ke==="nsew",$t=(ve+ke).length===1;function Ue(){if(Ee=ae.xaxis,be=ae.yaxis,De=Ee._length,Fe=be._length,Me=Ee._offset,Se=be._offset,(xe={})[Ee._id]=Ee,(ue={})[be._id]=be,ve&&ke)for(var sr=ae.overlays,fr=0;fr<sr.length;fr++){var yr=sr[fr].xaxis;xe[yr._id]=yr;var zr=sr[fr].yaxis;ue[zr._id]=zr}me=te(xe),we=te(ue),Oe=W(me,ke),je=W(we,ve),We=!je&&!Oe,et=J(ie,ie._fullLayout._axisMatchGroups,xe,ue);var xr=(Ye=J(ie,ie._fullLayout._axisConstraintGroups,xe,ue,et)).isSubplotConstrained||et.isSubplotConstrained;Ge=ke||xr,Qe=ve||xr;var Br=ie._fullLayout;it=Br._has("scattergl"),lt=Br._has("splom"),Lt=Br._has("svg")}Ue();var He=function(sr,fr,yr){return sr?sr==="nsew"?yr?"":fr==="pan"?"move":"crosshair":sr.toLowerCase()+"-resize":"pointer"}(je+Oe,ie._fullLayout.dragmode,Qt),Be=j(ae,ve+ke+"drag",He,he,se,de,ce);if(We&&!Qt)return Be.onmousedown=null,Be.style.pointerEvents="none",Be;var Je,_e,Le,Ce,Pe,Xe,ut,kt,ft,Et,mt={element:Be,gd:ie,plotinfo:ae};function It(){mt.plotinfo.selection=!1,w(ie)}function vt(sr,fr){var yr=mt.gd;if(yr._fullLayout._activeShapeIndex>=0)yr._fullLayout._deactivateShape(yr);else{var zr=yr._fullLayout.clickmode;if(B(yr),sr!==2||$t||nr(),Qt)zr.indexOf("select")>-1&&L(fr,yr,me,we,ae.id,mt),zr.indexOf("event")>-1&&a.click(yr,fr,ae.id);else if(sr===1&&$t){var xr=ve?be:Ee,Br=ve==="s"||ke==="w"?0:1,Jr=xr._name+".range["+Br+"]",fn=function(An,rn){var Fr,Lr=An.range[rn],Qr=Math.abs(Lr-An.range[1-rn]);return An.type==="date"?Lr:An.type==="log"?(Fr=Math.ceil(Math.max(0,-Math.log(Qr)/Math.LN10))+3,g("."+Fr+"g")(Math.pow(10,Lr))):(Fr=Math.floor(Math.log(Math.abs(Lr))/Math.LN10)-Math.floor(Math.log(Qr)/Math.LN10)+4,g("."+String(Fr)+"g")(Lr))}(xr,Br),Cn="left",Pn="middle";if(xr.fixedrange)return;ve?(Pn=ve==="n"?"top":"bottom",xr.side==="right"&&(Cn="right")):ke==="e"&&(Cn="right"),yr._context.showAxisRangeEntryBoxes&&t.select(Be).call(i.makeEditable,{gd:yr,immediate:!0,background:yr._fullLayout.paper_bgcolor,text:String(fn),fill:xr.tickfont?xr.tickfont.color:"#444",horizontalAlign:Cn,verticalAlign:Pn}).on("edit",function(An){var rn=xr.d2r(An);rn!==void 0&&f.call("_guiRelayout",yr,Jr,rn)})}}}function nt(sr,fr){if(ie._transitioningWithDuration)return!1;var yr=Math.max(0,Math.min(De,rt*sr+Je)),zr=Math.max(0,Math.min(Fe,$e*fr+_e)),xr=Math.abs(yr-Je),Br=Math.abs(zr-_e);function Jr(){ut="",Le.r=Le.l,Le.t=Le.b,ft.attr("d","M0,0Z")}if(Le.l=Math.min(Je,yr),Le.r=Math.max(Je,yr),Le.t=Math.min(_e,zr),Le.b=Math.max(_e,zr),Ye.isSubplotConstrained)xr>P||Br>P?(ut="xy",xr/De>Br/Fe?(Br=xr*Fe/De,_e>zr?Le.t=_e-Br:Le.b=_e+Br):(xr=Br*De/Fe,Je>yr?Le.l=Je-xr:Le.r=Je+xr),ft.attr("d",ee(Le))):Jr();else if(et.isSubplotConstrained)if(xr>P||Br>P){ut="xy";var fn=Math.min(Le.l/De,(Fe-Le.b)/Fe),Cn=Math.max(Le.r/De,(Fe-Le.t)/Fe);Le.l=fn*De,Le.r=Cn*De,Le.b=(1-fn)*Fe,Le.t=(1-Cn)*Fe,ft.attr("d",ee(Le))}else Jr();else!je||Br<Math.min(Math.max(.6*xr,M),P)?xr<M||!Oe?Jr():(Le.t=0,Le.b=Fe,ut="x",ft.attr("d",function(Pn,An){return"M"+(Pn.l-.5)+","+(An-P-.5)+"h-3v"+(2*P+1)+"h3ZM"+(Pn.r+.5)+","+(An-P-.5)+"h3v"+(2*P+1)+"h-3Z"}(Le,_e))):!Oe||xr<Math.min(.6*Br,P)?(Le.l=0,Le.r=De,ut="y",ft.attr("d",function(Pn,An){return"M"+(An-P-.5)+","+(Pn.t-.5)+"v-3h"+(2*P+1)+"v3ZM"+(An-P-.5)+","+(Pn.b+.5)+"v3h"+(2*P+1)+"v-3Z"}(Le,Je))):(ut="xy",ft.attr("d",ee(Le)));Le.w=Le.r-Le.l,Le.h=Le.b-Le.t,ut&&(Et=!0),ie._dragged=Et,K(kt,ft,Le,Pe,Xe,Ce),At(),ie.emit("plotly_relayouting",wt),Xe=!0}function At(){wt={},ut!=="xy"&&ut!=="x"||(Z(me,Le.l/De,Le.r/De,wt,Ye.xaxes),Pt("x",wt)),ut!=="xy"&&ut!=="y"||(Z(we,(Fe-Le.b)/Fe,(Fe-Le.t)/Fe,wt,Ye.yaxes),Pt("y",wt))}function Ft(){At(),B(ie),Yt(),q(ie)}mt.prepFn=function(sr,fr,yr){var zr=mt.dragmode,xr=ie._fullLayout.dragmode;xr!==zr&&(mt.dragmode=xr),Ue(),rt=ie._fullLayout._invScaleX,$e=ie._fullLayout._invScaleY,We||(Qt?sr.shiftKey?xr==="pan"?xr="zoom":l(xr)||(xr="pan"):sr.ctrlKey&&(xr="pan"):xr="pan"),y(xr)?mt.minDrag=1:mt.minDrag=void 0,l(xr)?(mt.xaxes=me,mt.yaxes=we,S(sr,fr,yr,mt,xr)):(mt.clickFn=vt,l(zr)&&It(),We||(xr==="zoom"?(mt.moveFn=nt,mt.doneFn=Ft,mt.minDrag=1,function(Br,Jr,fn){var Cn=Be.getBoundingClientRect();Je=Jr-Cn.left,_e=fn-Cn.top,ie._fullLayout._calcInverseTransform(ie);var Pn=m.apply3DTransform(ie._fullLayout._invTransform)(Je,_e);Je=Pn[0],_e=Pn[1],Le={l:Je,r:Je,w:0,t:_e,b:_e,h:0},Ce=ie._hmpixcount?ie._hmlumcount/ie._hmpixcount:p(ie._fullLayout.plot_bgcolor).getLuminance(),Xe=!1,ut="xy",Et=!1,kt=G(xt,Ce,Me,Se,Pe="M0,0H"+De+"V"+Fe+"H0V0"),ft=Y(xt,Me,Se)}(0,fr,yr)):xr==="pan"&&(mt.moveFn=bt,mt.doneFn=Yt))),ie._fullLayout._redrag=function(){var Br=ie._dragdata;if(Br&&Br.element===Be){var Jr=ie._fullLayout.dragmode;l(Jr)||(Ue(),Xt([0,0,De,Fe]),mt.moveFn(Br.dx,Br.dy))}}},n.init(mt);var Nt=[0,0,De,Fe],Kt=null,Ie=C.REDRAWDELAY,ot=ae.mainplot?ie._fullLayout._plots[ae.mainplot]:ae;function bt(sr,fr){if(sr*=rt,fr*=$e,!ie._transitioningWithDuration){if(ie._fullLayout._replotting=!0,Oe==="ew"||je==="ns"){var yr=Oe?-sr:0,zr=je?-fr:0;if(et.isSubplotConstrained){if(Oe&&je){var xr=(sr/De-fr/Fe)/2;yr=-(sr=xr*De),zr=-(fr=-xr*Fe)}je?yr=-zr*De/Fe:zr=-yr*Fe/De}return Oe&&(Q(me,sr),Pt("x")),je&&(Q(we,fr),Pt("y")),Xt([yr,zr,De,Fe]),Vt(),void ie.emit("plotly_relayouting",wt)}var Br,Jr,fn=Oe==="w"==(je==="n")?1:-1;if(Oe&&je&&(Ye.isSubplotConstrained||et.isSubplotConstrained)){var Cn=(sr/De+fn*fr/Fe)/2;sr=Cn*De,fr=fn*Cn*Fe}if(Oe==="w"?sr=Fr(me,0,sr):Oe==="e"?sr=Fr(me,1,-sr):Oe||(sr=0),je==="n"?fr=Fr(we,1,fr):je==="s"?fr=Fr(we,0,-fr):je||(fr=0),Br=Oe==="w"?sr:0,Jr=je==="n"?fr:0,Ye.isSubplotConstrained&&!et.isSubplotConstrained||et.isSubplotConstrained&&Oe&&je&&fn>0){var Pn;if(et.isSubplotConstrained||!Oe&&je.length===1){for(Pn=0;Pn<me.length;Pn++)me[Pn].range=me[Pn]._r.slice(),k(me[Pn],1-fr/Fe);Br=(sr=fr*De/Fe)/2}if(et.isSubplotConstrained||!je&&Oe.length===1){for(Pn=0;Pn<we.length;Pn++)we[Pn].range=we[Pn]._r.slice(),k(we[Pn],1-sr/De);Jr=(fr=sr*Fe/De)/2}}et.isSubplotConstrained&&je||Pt("x"),et.isSubplotConstrained&&Oe||Pt("y");var An=De-sr,rn=Fe-fr;!et.isSubplotConstrained||Oe&&je||(Oe?(Jr=Br?0:sr*Fe/De,rn=An*Fe/De):(Br=Jr?0:fr*De/Fe,An=rn*De/Fe)),Xt([Br,Jr,An,rn]),Vt(),ie.emit("plotly_relayouting",wt)}function Fr(Lr,Qr,$r){for(var Kr,en,Tn=1-Qr,Mn=0;Mn<Lr.length;Mn++){var Rn=Lr[Mn];if(!Rn.fixedrange){Kr=Rn,en=Rn._rl[Tn]+(Rn._rl[Qr]-Rn._rl[Tn])/X($r/Rn._length);var Zt=Rn.l2r(en);Zt!==!1&&Zt!==void 0&&(Rn.range[Qr]=Zt)}}return Kr._length*(Kr._rl[Qr]-en)/(Kr._rl[Qr]-Kr._rl[Tn])}}function Pt(sr,fr){for(var yr=et.isSubplotConstrained?{x:we,y:me}[sr]:et[sr+"axes"],zr=et.isSubplotConstrained?{x:me,y:we}[sr]:[],xr=0;xr<yr.length;xr++){var Br=yr[xr],Jr=Br._id,fn=et.xLinks[Jr]||et.yLinks[Jr],Cn=zr[0]||xe[fn]||ue[fn];Cn&&(fr?(fr[Br._name+".range[0]"]=fr[Cn._name+".range[0]"],fr[Br._name+".range[1]"]=fr[Cn._name+".range[1]"]):Br.range=Cn.range.slice())}}function Vt(){var sr,fr=[];function yr(Br){for(sr=0;sr<Br.length;sr++)Br[sr].fixedrange||fr.push(Br[sr]._id)}for(Ge&&(yr(me),yr(Ye.xaxes),yr(et.xaxes)),Qe&&(yr(we),yr(Ye.yaxes),yr(et.yaxes)),wt={},sr=0;sr<fr.length;sr++){var zr=fr[sr],xr=A(ie,zr);c.drawOne(ie,xr,{skipTitle:!0}),wt[xr._name+".range[0]"]=xr.range[0],wt[xr._name+".range[1]"]=xr.range[1]}c.redrawComponents(ie,fr)}function nr(){if(!ie._transitioningWithDuration){var sr=ie._context.doubleClick,fr=[];Oe&&(fr=fr.concat(me)),je&&(fr=fr.concat(we)),et.xaxes&&(fr=fr.concat(et.xaxes)),et.yaxes&&(fr=fr.concat(et.yaxes));var yr,zr,xr,Br={};if(sr==="reset+autosize"){for(sr="autosize",zr=0;zr<fr.length;zr++)if((yr=fr[zr])._rangeInitial&&(yr.range[0]!==yr._rangeInitial[0]||yr.range[1]!==yr._rangeInitial[1])||!yr._rangeInitial&&!yr.autorange){sr="reset";break}}if(sr==="autosize")for(zr=0;zr<fr.length;zr++)(yr=fr[zr]).fixedrange||(Br[yr._name+".autorange"]=!0);else if(sr==="reset")for((Oe||Ye.isSubplotConstrained)&&(fr=fr.concat(Ye.xaxes)),je&&!Ye.isSubplotConstrained&&(fr=fr.concat(Ye.yaxes)),Ye.isSubplotConstrained&&(Oe?je||(fr=fr.concat(we)):fr=fr.concat(me)),zr=0;zr<fr.length;zr++)(yr=fr[zr]).fixedrange||(yr._rangeInitial?(xr=yr._rangeInitial,Br[yr._name+".range[0]"]=xr[0],Br[yr._name+".range[1]"]=xr[1]):Br[yr._name+".autorange"]=!0);ie.emit("plotly_doubleclick",null),f.call("_guiRelayout",ie,Br)}}function Yt(){Xt([0,0,De,Fe]),m.syncOrAsync([T.previousPromises,function(){ie._fullLayout._replotting=!1,f.call("_guiRelayout",ie,wt)}],ie)}function Xt(sr){var fr,yr,zr,xr,Br=ie._fullLayout,Jr=Br._plots,fn=Br._subplots.cartesian;if(lt&&f.subplotsRegistry.splom.drag(ie),it){for(fr=0;fr<fn.length;fr++)if(zr=(yr=Jr[fn[fr]]).xaxis,xr=yr.yaxis,yr._scene){var Cn=m.simpleMap(zr.range,zr.r2l),Pn=m.simpleMap(xr.range,xr.r2l);yr._scene.update({range:[Cn[0],Pn[0],Cn[1],Pn[1]]})}}if((lt||it)&&(_(ie),x(ie)),Lt){var An=sr[2]/Ee._length,rn=sr[3]/be._length;for(fr=0;fr<fn.length;fr++){zr=(yr=Jr[fn[fr]]).xaxis,xr=yr.yaxis;var Fr,Lr,Qr,$r,Kr=(Ge||et.isSubplotConstrained)&&!zr.fixedrange&&xe[zr._id],en=(Qe||et.isSubplotConstrained)&&!xr.fixedrange&&ue[xr._id];if(Kr?(Fr=An,Qr=ke||et.isSubplotConstrained?sr[0]:mr(zr,Fr)):et.xaHash[zr._id]?(Fr=An,Qr=sr[0]*zr._length/Ee._length):et.yaHash[zr._id]?(Fr=rn,Qr=je==="ns"?-sr[1]*zr._length/be._length:mr(zr,Fr,{n:"top",s:"bottom"}[je])):Qr=hr(zr,Fr=ar(zr,An,rn)),en?(Lr=rn,$r=ve||et.isSubplotConstrained?sr[1]:mr(xr,Lr)):et.yaHash[xr._id]?(Lr=rn,$r=sr[1]*xr._length/be._length):et.xaHash[xr._id]?(Lr=An,$r=Oe==="ew"?-sr[0]*xr._length/Ee._length:mr(xr,Lr,{e:"right",w:"left"}[Oe])):$r=hr(xr,Lr=ar(xr,An,rn)),Fr||Lr){Fr||(Fr=1),Lr||(Lr=1);var Tn=zr._offset-Qr/Fr,Mn=xr._offset-$r/Lr;yr.clipRect.call(o.setTranslate,Qr,$r).call(o.setScale,Fr,Lr),yr.plot.call(o.setTranslate,Tn,Mn).call(o.setScale,1/Fr,1/Lr),Fr===yr.xScaleFactor&&Lr===yr.yScaleFactor||(o.setPointGroupScale(yr.zoomScalePts,Fr,Lr),o.setTextPointsScale(yr.zoomScaleTxt,Fr,Lr)),o.hideOutsideRangePoints(yr.clipOnAxisFalseTraces,yr),yr.xScaleFactor=Fr,yr.yScaleFactor=Lr}}}}function ar(sr,fr,yr){return sr.fixedrange?0:Ge&&Ye.xaHash[sr._id]?fr:Qe&&(Ye.isSubplotConstrained?Ye.xaHash:Ye.yaHash)[sr._id]?yr:0}function hr(sr,fr){return fr?(sr.range=sr._r.slice(),k(sr,fr),mr(sr,fr)):0}function mr(sr,fr,yr){return sr._length*(1-fr)*v[yr||sr.constraintoward||"middle"]}return ve.length*ke.length!=1&&$(Be,function(sr){if(ie._context._scrollZoom.cartesian||ie._fullLayout._enablescrollzoom){if(It(),ie._transitioningWithDuration)return sr.preventDefault(),void sr.stopPropagation();Ue(),clearTimeout(Kt);var fr=-sr.deltaY;if(isFinite(fr)||(fr=sr.wheelDelta/10),isFinite(fr)){var yr,zr=Math.exp(-Math.min(Math.max(fr,-20),20)/200),xr=ot.draglayer.select(".nsewdrag").node().getBoundingClientRect(),Br=(sr.clientX-xr.left)/xr.width,Jr=(xr.bottom-sr.clientY)/xr.height;if(Ge){for(ke||(Br=.5),yr=0;yr<me.length;yr++)fn(me[yr],Br,zr);Pt("x"),Nt[2]*=zr,Nt[0]+=Nt[2]*Br*(1/zr-1)}if(Qe){for(ve||(Jr=.5),yr=0;yr<we.length;yr++)fn(we[yr],Jr,zr);Pt("y"),Nt[3]*=zr,Nt[1]+=Nt[3]*(1-Jr)*(1/zr-1)}Xt(Nt),Vt(),ie.emit("plotly_relayouting",wt),Kt=setTimeout(function(){ie._fullLayout&&(Nt=[0,0,De,Fe],Yt())},Ie),sr.preventDefault()}else m.log("Did not find wheel motion attributes: ",sr)}function fn(Cn,Pn,An){if(!Cn.fixedrange){var rn=m.simpleMap(Cn.range,Cn.r2l),Fr=rn[0]+(rn[1]-rn[0])*Pn;Cn.range=rn.map(function(Lr){return Cn.l2r(Fr+(Lr-Fr)*An)})}}}),Be},makeDragger:F,makeRectDragger:j,makeZoombox:G,makeCorners:Y,updateZoombox:K,xyCorners:ee,transitionZoombox:D,removeZoombox:B,showDoubleClickNotifier:q,attachWheelEventHandler:$}},{"../../components/color":650,"../../components/dragelement":669,"../../components/dragelement/helpers":668,"../../components/drawing":672,"../../components/fx":690,"../../constants/alignment":755,"../../lib":787,"../../lib/clear_gl_canvases":771,"../../lib/setcursor":808,"../../lib/svg_text_utils":813,"../../plot_api/subroutines":828,"../../registry":915,"../plots":901,"./axes":838,"./axis_ids":842,"./constants":845,"./scale_zoom":857,"./select":858,"@plotly/d3":58,"has-passive-events":436,tinycolor2:583}],848:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../components/fx"),g=h("../../components/dragelement"),p=h("../../lib/setcursor"),e=h("./dragbox").makeDragBox,f=h("./constants").DRAGGERSIZE;H.initInteractions=function(u){var i=u._fullLayout;if(u._context.staticPlot)t.select(u).selectAll(".drag").remove();else if(i._has("cartesian")||i._has("splom")){Object.keys(i._plots||{}).sort(function(o,a){if((i._plots[o].mainplot&&!0)===(i._plots[a].mainplot&&!0)){var c=o.split("y"),r=a.split("y");return c[0]===r[0]?Number(c[1]||1)-Number(r[1]||1):Number(c[0]||1)-Number(r[0]||1)}return i._plots[o].mainplot?1:-1}).forEach(function(o){var a=i._plots[o],c=a.xaxis,r=a.yaxis;if(!a.mainplot){var n=e(u,a,c._offset,r._offset,c._length,r._length,"ns","ew");n.onmousemove=function(y){u._fullLayout._rehover=function(){u._fullLayout._hoversubplot===o&&u._fullLayout._plots[o]&&m.hover(u,y,o)},m.hover(u,y,o),u._fullLayout._lasthover=n,u._fullLayout._hoversubplot=o},n.onmouseout=function(y){u._dragging||(u._fullLayout._hoversubplot=null,g.unhover(u,y))},u._context.showAxisDragHandles&&(e(u,a,c._offset-f,r._offset-f,f,f,"n","w"),e(u,a,c._offset+c._length,r._offset-f,f,f,"n","e"),e(u,a,c._offset-f,r._offset+r._length,f,f,"s","w"),e(u,a,c._offset+c._length,r._offset+r._length,f,f,"s","e"))}if(u._context.showAxisDragHandles){if(o===c._mainSubplot){var d=c._mainLinePosition;c.side==="top"&&(d-=f),e(u,a,c._offset+.1*c._length,d,.8*c._length,f,"","ew"),e(u,a,c._offset,d,.1*c._length,f,"","w"),e(u,a,c._offset+.9*c._length,d,.1*c._length,f,"","e")}if(o===r._mainSubplot){var l=r._mainLinePosition;r.side!=="right"&&(l-=f),e(u,a,l,r._offset+.1*r._length,f,.8*r._length,"ns",""),e(u,a,l,r._offset+.9*r._length,f,.1*r._length,"s",""),e(u,a,l,r._offset,f,.1*r._length,"n","")}}});var s=i._hoverlayer.node();s.onmousemove=function(o){o.target=u._fullLayout._lasthover,m.hover(u,o,i._hoversubplot)},s.onclick=function(o){o.target=u._fullLayout._lasthover,m.click(u,o)},s.onmousedown=function(o){u._fullLayout._lasthover.onmousedown(o)},H.updateFx(u)}},H.updateFx=function(u){var i=u._fullLayout,s=i.dragmode==="pan"?"move":"crosshair";p(i._draggers,s)}},{"../../components/dragelement":669,"../../components/fx":690,"../../lib/setcursor":808,"./constants":845,"./dragbox":847,"@plotly/d3":58}],849:[function(h,N,H){N.exports={clearOutlineControllers:function(t){var m=t._fullLayout._zoomlayer;m&&m.selectAll(".outline-controllers").remove()},clearSelect:function(t){var m=t._fullLayout._zoomlayer;m&&m.selectAll(".select-outline").remove(),t._fullLayout._drawing=!1}}},{}],850:[function(h,N,H){var t=h("../../lib").strTranslate;function m(g,p){switch(g.type){case"log":return g.p2d(p);case"date":return g.p2r(p,0,g.calendar);default:return g.p2r(p)}}N.exports={p2r:m,r2p:function(g,p){switch(g.type){case"log":return g.d2p(p);case"date":return g.r2p(p,0,g.calendar);default:return g.r2p(p)}},axValue:function(g){var p=g._id.charAt(0)==="y"?1:0;return function(e){return m(g,e[p])}},getTransform:function(g){return t(g.xaxis._offset,g.yaxis._offset)}}},{"../../lib":787}],851:[function(h,N,H){var t=h("../../registry"),m=h("../../lib"),g=h("./axis_ids");N.exports=function(p){return function(e,f){var u=e[p];if(Array.isArray(u))for(var i=t.subplotsRegistry.cartesian,s=i.idRegex,o=f._subplots,a=o.xaxis,c=o.yaxis,r=o.cartesian,n=f._has("cartesian")||f._has("gl2d"),d=0;d<u.length;d++){var l=u[d];if(m.isPlainObject(l)){var y=g.cleanId(l.xref,"x",!1),v=g.cleanId(l.yref,"y",!1),_=s.x.test(y),x=s.y.test(v);if(_||x){n||m.pushUnique(f._basePlotModules,i);var T=!1;_&&a.indexOf(y)===-1&&(a.push(y),T=!0),x&&c.indexOf(v)===-1&&(c.push(v),T=!0),T&&_&&x&&r.push(y+v)}}}}}},{"../../lib":787,"../../registry":915,"./axis_ids":842}],852:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../registry"),g=h("../../lib"),p=h("../plots"),e=h("../../components/drawing"),f=h("../get_data").getModuleCalcData,u=h("./axis_ids"),i=h("./constants"),s=h("../../constants/xmlns_namespaces"),o=g.ensureSingle;function a(l,y,v){return g.ensureSingle(l,y,v,function(_){_.datum(v)})}function c(l,y,v,_,x){for(var T,A,S,w=i.traceLayerClasses,L=l._fullLayout,k=L._modules,C=[],M=[],P=0;P<k.length;P++){var O=(T=k[P]).name,F=m.modules[O].categories;if(F.svg){var j=T.layerName||O+"layer",W=T.plot;S=(A=f(v,W))[0],v=A[1],S.length&&C.push({i:w.indexOf(j),className:j,plotMethod:W,cdModule:S}),F.zoomScale&&M.push("."+j)}}C.sort(function(X,G){return X.i-G.i});var Z=y.plot.selectAll("g.mlayer").data(C,function(X){return X.className});if(Z.enter().append("g").attr("class",function(X){return X.className}).classed("mlayer",!0).classed("rangeplot",y.isRangePlot),Z.exit().remove(),Z.order(),Z.each(function(X){var G=t.select(this),Y=X.className;X.plotMethod(l,y,X.cdModule,G,_,x),i.clipOnAxisFalseQuery.indexOf("."+Y)===-1&&e.setClipUrl(G,y.layerClipId,l)}),L._has("scattergl")&&(T=m.getModule("scattergl"),S=f(v,T)[0],T.plot(l,y,S)),!l._context.staticPlot&&(y._hasClipOnAxisFalse&&(y.clipOnAxisFalseTraces=y.plot.selectAll(i.clipOnAxisFalseQuery.join(",")).selectAll(".trace")),M.length)){var Q=y.plot.selectAll(M.join(",")).selectAll(".trace");y.zoomScalePts=Q.selectAll("path.point"),y.zoomScaleTxt=Q.selectAll(".textpoint")}}function r(l,y){var v=y.plotgroup,_=y.id,x=i.layerValue2layerClass[y.xaxis.layer],T=i.layerValue2layerClass[y.yaxis.layer],A=l._fullLayout._hasOnlyLargeSploms;if(y.mainplot){var S=y.mainplotinfo,w=S.plotgroup,L=_+"-x",k=_+"-y";y.gridlayer=S.gridlayer,y.zerolinelayer=S.zerolinelayer,o(S.overlinesBelow,"path",L),o(S.overlinesBelow,"path",k),o(S.overaxesBelow,"g",L),o(S.overaxesBelow,"g",k),y.plot=o(S.overplot,"g",_),o(S.overlinesAbove,"path",L),o(S.overlinesAbove,"path",k),o(S.overaxesAbove,"g",L),o(S.overaxesAbove,"g",k),y.xlines=w.select(".overlines-"+x).select("."+L),y.ylines=w.select(".overlines-"+T).select("."+k),y.xaxislayer=w.select(".overaxes-"+x).select("."+L),y.yaxislayer=w.select(".overaxes-"+T).select("."+k)}else if(A)y.xlines=o(v,"path","xlines-above"),y.ylines=o(v,"path","ylines-above"),y.xaxislayer=o(v,"g","xaxislayer-above"),y.yaxislayer=o(v,"g","yaxislayer-above");else{var C=o(v,"g","layer-subplot");y.shapelayer=o(C,"g","shapelayer"),y.imagelayer=o(C,"g","imagelayer"),y.gridlayer=o(v,"g","gridlayer"),y.zerolinelayer=o(v,"g","zerolinelayer"),o(v,"path","xlines-below"),o(v,"path","ylines-below"),y.overlinesBelow=o(v,"g","overlines-below"),o(v,"g","xaxislayer-below"),o(v,"g","yaxislayer-below"),y.overaxesBelow=o(v,"g","overaxes-below"),y.plot=o(v,"g","plot"),y.overplot=o(v,"g","overplot"),y.xlines=o(v,"path","xlines-above"),y.ylines=o(v,"path","ylines-above"),y.overlinesAbove=o(v,"g","overlines-above"),o(v,"g","xaxislayer-above"),o(v,"g","yaxislayer-above"),y.overaxesAbove=o(v,"g","overaxes-above"),y.xlines=v.select(".xlines-"+x),y.ylines=v.select(".ylines-"+T),y.xaxislayer=v.select(".xaxislayer-"+x),y.yaxislayer=v.select(".yaxislayer-"+T)}A||(a(y.gridlayer,"g",y.xaxis._id),a(y.gridlayer,"g",y.yaxis._id),y.gridlayer.selectAll("g").map(function(M){return M[0]}).sort(u.idSort)),y.xlines.style("fill","none").classed("crisp",!0),y.ylines.style("fill","none").classed("crisp",!0)}function n(l,y){if(l){var v={};for(var _ in l.each(function(S){var w=S[0];t.select(this).remove(),d(w,y),v[w]=!0}),y._plots)for(var x=y._plots[_].overlays||[],T=0;T<x.length;T++){var A=x[T];v[A.id]&&A.plot.selectAll(".trace").remove()}}}function d(l,y){y._draggers.selectAll("g."+l).remove(),y._defs.select("#clip"+y._uid+l+"plot").remove()}H.name="cartesian",H.attr=["xaxis","yaxis"],H.idRoot=["x","y"],H.idRegex=i.idRegex,H.attrRegex=i.attrRegex,H.attributes=h("./attributes"),H.layoutAttributes=h("./layout_attributes"),H.supplyLayoutDefaults=h("./layout_defaults"),H.transitionAxes=h("./transition_axes"),H.finalizeSubplots=function(l,y){var v,_,x,T=y._subplots,A=T.xaxis,S=T.yaxis,w=T.cartesian,L=w.concat(T.gl2d||[]),k={},C={};for(v=0;v<L.length;v++){var M=L[v].split("y");k[M[0]]=1,C["y"+M[1]]=1}for(v=0;v<A.length;v++)k[_=A[v]]||(x=(l[u.id2name(_)]||{}).anchor,i.idRegex.y.test(x)||(x="y"),w.push(_+x),L.push(_+x),C[x]||(C[x]=1,g.pushUnique(S,x)));for(v=0;v<S.length;v++)C[x=S[v]]||(_=(l[u.id2name(x)]||{}).anchor,i.idRegex.x.test(_)||(_="x"),w.push(_+x),L.push(_+x),k[_]||(k[_]=1,g.pushUnique(A,_)));if(!L.length){for(var P in _="",x="",l)i.attrRegex.test(P)&&(P.charAt(0)==="x"?(!_||+P.substr(5)<+_.substr(5))&&(_=P):(!x||+P.substr(5)<+x.substr(5))&&(x=P));_=_?u.name2id(_):"x",x=x?u.name2id(x):"y",A.push(_),S.push(x),w.push(_+x)}},H.plot=function(l,y,v,_){var x,T=l._fullLayout,A=T._subplots.cartesian,S=l.calcdata;if(!Array.isArray(y))for(y=[],x=0;x<S.length;x++)y.push(x);for(x=0;x<A.length;x++){for(var w,L=A[x],k=T._plots[L],C=[],M=0;M<S.length;M++){var P=S[M],O=P[0].trace;O.xaxis+O.yaxis===L&&((y.indexOf(O.index)!==-1||O.carpet)&&(w&&w[0].trace.xaxis+w[0].trace.yaxis===L&&["tonextx","tonexty","tonext"].indexOf(O.fill)!==-1&&C.indexOf(w)===-1&&C.push(w),C.push(P)),w=P)}c(l,k,C,v,_)}},H.clean=function(l,y,v,_){var x,T,A,S=_._plots||{},w=y._plots||{},L=_._subplots||{};if(_._hasOnlyLargeSploms&&!y._hasOnlyLargeSploms)for(A in S)(x=S[A]).plotgroup&&x.plotgroup.remove();var k=_._has&&_._has("gl"),C=y._has&&y._has("gl");if(k&&!C)for(A in S)(x=S[A])._scene&&x._scene.destroy();if(L.xaxis&&L.yaxis){var M=u.listIds({_fullLayout:_});for(T=0;T<M.length;T++){var P=M[T];y[u.id2name(P)]||_._infolayer.selectAll(".g-"+P+"title").remove()}}var O=_._has&&_._has("cartesian"),F=y._has&&y._has("cartesian");if(O&&!F)n(_._cartesianlayer.selectAll(".subplot"),_),_._defs.selectAll(".axesclip").remove(),delete _._axisConstraintGroups,delete _._axisMatchGroups;else if(L.cartesian)for(T=0;T<L.cartesian.length;T++){var j=L.cartesian[T];if(!w[j]){var W="."+j+",."+j+"-x,."+j+"-y";_._cartesianlayer.selectAll(W).remove(),d(j,_)}}},H.drawFramework=function(l){var y=l._fullLayout,v=function(x){var T,A,S,w,L,k,C=x._fullLayout,M=C._subplots.cartesian,P=M.length,O=[],F=[];for(T=0;T<P;T++){S=M[T],w=C._plots[S],L=w.xaxis,k=w.yaxis;var j=L._mainAxis,W=k._mainAxis,Z=j._id+W._id,Q=C._plots[Z];w.overlays=[],Z!==S&&Q?(w.mainplot=Z,w.mainplotinfo=Q,F.push(S)):(w.mainplot=void 0,w.mainplotinfo=void 0,O.push(S))}for(T=0;T<F.length;T++)S=F[T],(w=C._plots[S]).mainplotinfo.overlays.push(w);var X=O.concat(F),G=new Array(P);for(T=0;T<P;T++){S=X[T],w=C._plots[S],L=w.xaxis,k=w.yaxis;var Y=[S,L.layer,k.layer,L.overlaying||"",k.overlaying||""];for(A=0;A<w.overlays.length;A++)Y.push(w.overlays[A].id);G[T]=Y}return G}(l),_=y._cartesianlayer.selectAll(".subplot").data(v,String);_.enter().append("g").attr("class",function(x){return"subplot "+x[0]}),_.order(),_.exit().call(n,y),_.each(function(x){var T=x[0],A=y._plots[T];A.plotgroup=t.select(this),r(l,A),A.draglayer=o(y._draggers,"g",T)})},H.rangePlot=function(l,y,v){r(l,y),c(l,y,v),p.style(l)},H.toSVG=function(l){var y=l._fullLayout._glimages,v=t.select(l).selectAll(".svg-container");v.filter(function(_,x){return x===v.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus").each(function(){var _=this.toDataURL("image/png");y.append("svg:image").attr({xmlns:s.svg,"xlink:href":_,preserveAspectRatio:"none",x:0,y:0,width:this.style.width,height:this.style.height})})},H.updateFx=h("./graph_interact").updateFx},{"../../components/drawing":672,"../../constants/xmlns_namespaces":764,"../../lib":787,"../../registry":915,"../get_data":875,"../plots":901,"./attributes":836,"./axis_ids":842,"./constants":845,"./graph_interact":848,"./layout_attributes":853,"./layout_defaults":854,"./transition_axes":863,"@plotly/d3":58}],853:[function(h,N,H){var t=h("../font_attributes"),m=h("../../components/color/attributes"),g=h("../../components/drawing/attributes").dash,p=h("../../lib/extend").extendFlat,e=h("../../plot_api/plot_template").templatedArray,f=h("../../plots/cartesian/axis_format_attributes").descriptionWithDates,u=h("../../constants/numerical").ONEDAY,i=h("./constants"),s=i.HOUR_PATTERN,o=i.WEEKDAY_PATTERN;N.exports={visible:{valType:"boolean",editType:"plot"},color:{valType:"color",dflt:m.defaultLine,editType:"ticks"},title:{text:{valType:"string",editType:"ticks"},font:t({editType:"ticks"}),standoff:{valType:"number",min:0,editType:"ticks"},editType:"ticks"},type:{valType:"enumerated",values:["-","linear","log","date","category","multicategory"],dflt:"-",editType:"calc",_noTemplating:!0},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"axrange",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"plot"},range:{valType:"info_array",items:[{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0},{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0}],editType:"axrange",impliedEdits:{autorange:!1},anim:!0},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},scaleanchor:{valType:"enumerated",values:[i.idRegex.x.toString(),i.idRegex.y.toString()],editType:"plot"},scaleratio:{valType:"number",min:0,dflt:1,editType:"plot"},constrain:{valType:"enumerated",values:["range","domain"],editType:"plot"},constraintoward:{valType:"enumerated",values:["left","center","right","top","middle","bottom"],editType:"plot"},matches:{valType:"enumerated",values:[i.idRegex.x.toString(),i.idRegex.y.toString()],editType:"calc"},rangebreaks:e("rangebreak",{enabled:{valType:"boolean",dflt:!0,editType:"calc"},bounds:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},pattern:{valType:"enumerated",values:[o,s,""],editType:"calc"},values:{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"any",editType:"calc"}},dvalue:{valType:"number",editType:"calc",min:0,dflt:u},editType:"calc"}),tickmode:{valType:"enumerated",values:["auto","linear","array"],editType:"ticks",impliedEdits:{tick0:void 0,dtick:void 0}},nticks:{valType:"integer",min:0,dflt:0,editType:"ticks"},tick0:{valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},dtick:{valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},tickvals:{valType:"data_array",editType:"ticks"},ticktext:{valType:"data_array",editType:"ticks"},ticks:{valType:"enumerated",values:["outside","inside",""],editType:"ticks"},tickson:{valType:"enumerated",values:["labels","boundaries"],dflt:"labels",editType:"ticks"},ticklabelmode:{valType:"enumerated",values:["instant","period"],dflt:"instant",editType:"ticks"},ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside left","inside left","outside right","inside right","outside bottom","inside bottom"],dflt:"outside",editType:"calc"},ticklabeloverflow:{valType:"enumerated",values:["allow","hide past div","hide past domain"],editType:"calc"},mirror:{valType:"enumerated",values:[!0,"ticks",!1,"all","allticks"],dflt:!1,editType:"ticks+layoutstyle"},ticklen:{valType:"number",min:0,dflt:5,editType:"ticks"},tickwidth:{valType:"number",min:0,dflt:1,editType:"ticks"},tickcolor:{valType:"color",dflt:m.defaultLine,editType:"ticks"},showticklabels:{valType:"boolean",dflt:!0,editType:"ticks"},automargin:{valType:"boolean",dflt:!1,editType:"ticks"},showspikes:{valType:"boolean",dflt:!1,editType:"modebar"},spikecolor:{valType:"color",dflt:null,editType:"none"},spikethickness:{valType:"number",dflt:3,editType:"none"},spikedash:p({},g,{dflt:"dash",editType:"none"}),spikemode:{valType:"flaglist",flags:["toaxis","across","marker"],dflt:"toaxis",editType:"none"},spikesnap:{valType:"enumerated",values:["data","cursor","hovered data"],dflt:"hovered data",editType:"none"},tickfont:t({editType:"ticks"}),tickangle:{valType:"angle",dflt:"auto",editType:"ticks"},tickprefix:{valType:"string",dflt:"",editType:"ticks"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},ticksuffix:{valType:"string",dflt:"",editType:"ticks"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"ticks"},minexponent:{valType:"number",dflt:3,min:0,editType:"ticks"},separatethousands:{valType:"boolean",dflt:!1,editType:"ticks"},tickformat:{valType:"string",dflt:"",editType:"ticks",description:f("tick label")},tickformatstops:e("tickformatstop",{enabled:{valType:"boolean",dflt:!0,editType:"ticks"},dtickrange:{valType:"info_array",items:[{valType:"any",editType:"ticks"},{valType:"any",editType:"ticks"}],editType:"ticks"},value:{valType:"string",dflt:"",editType:"ticks"},editType:"ticks"}),hoverformat:{valType:"string",dflt:"",editType:"none",description:f("hover text")},showline:{valType:"boolean",dflt:!1,editType:"ticks+layoutstyle"},linecolor:{valType:"color",dflt:m.defaultLine,editType:"layoutstyle"},linewidth:{valType:"number",min:0,dflt:1,editType:"ticks+layoutstyle"},showgrid:{valType:"boolean",editType:"ticks"},gridcolor:{valType:"color",dflt:m.lightLine,editType:"ticks"},gridwidth:{valType:"number",min:0,dflt:1,editType:"ticks"},zeroline:{valType:"boolean",editType:"ticks"},zerolinecolor:{valType:"color",dflt:m.defaultLine,editType:"ticks"},zerolinewidth:{valType:"number",dflt:1,editType:"ticks"},showdividers:{valType:"boolean",dflt:!0,editType:"ticks"},dividercolor:{valType:"color",dflt:m.defaultLine,editType:"ticks"},dividerwidth:{valType:"number",dflt:1,editType:"ticks"},anchor:{valType:"enumerated",values:["free",i.idRegex.x.toString(),i.idRegex.y.toString()],editType:"plot"},side:{valType:"enumerated",values:["top","bottom","left","right"],editType:"plot"},overlaying:{valType:"enumerated",values:["free",i.idRegex.x.toString(),i.idRegex.y.toString()],editType:"plot"},layer:{valType:"enumerated",values:["above traces","below traces"],dflt:"above traces",editType:"plot"},domain:{valType:"info_array",items:[{valType:"number",min:0,max:1,editType:"plot"},{valType:"number",min:0,max:1,editType:"plot"}],dflt:[0,1],editType:"plot"},position:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array","total ascending","total descending","min ascending","min descending","max ascending","max descending","sum ascending","sum descending","mean ascending","mean descending","median ascending","median descending"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{autotick:{valType:"boolean",editType:"ticks"},title:{valType:"string",editType:"ticks"},titlefont:t({editType:"ticks"})}}},{"../../components/color/attributes":649,"../../components/drawing/attributes":671,"../../constants/numerical":763,"../../lib/extend":777,"../../plot_api/plot_template":827,"../../plots/cartesian/axis_format_attributes":841,"../font_attributes":867,"./constants":845}],854:[function(h,N,H){var t=h("../../lib"),m=h("../../components/color"),g=h("../../components/fx/helpers").isUnifiedHover,p=h("../../components/fx/hovermode_defaults"),e=h("../../plot_api/plot_template"),f=h("../layout_attributes"),u=h("./layout_attributes"),i=h("./type_defaults"),s=h("./axis_defaults"),o=h("./constraints"),a=h("./position_defaults"),c=h("./axis_ids"),r=c.id2name,n=c.name2id,d=h("./constants").AX_ID_PATTERN,l=h("../../registry"),y=l.traceIs,v=l.getComponentMethod;function _(x,T,A){Array.isArray(x[T])?x[T].push(A):x[T]=[A]}N.exports=function(x,T,A){var S,w,L=T.autotypenumbers,k={},C={},M={},P={},O={},F={},j={},W={},Z={},Q={};for(S=0;S<A.length;S++){var X=A[S];if(y(X,"cartesian")||y(X,"gl2d")){var G,Y;if(X.xaxis)G=r(X.xaxis),_(k,G,X);else if(X.xaxes)for(w=0;w<X.xaxes.length;w++)_(k,r(X.xaxes[w]),X);if(X.yaxis)Y=r(X.yaxis),_(k,Y,X);else if(X.yaxes)for(w=0;w<X.yaxes.length;w++)_(k,r(X.yaxes[w]),X);X.type==="funnel"?X.orientation==="h"?(G&&(C[G]=!0),Y&&(j[Y]=!0)):Y&&(M[Y]=!0):X.type==="image"?(Y&&(W[Y]=!0),G&&(W[G]=!0)):(Y&&(O[Y]=!0,F[Y]=!0),y(X,"carpet")&&(X.type!=="carpet"||X._cheater)||G&&(P[G]=!0)),X.type==="carpet"&&X._cheater&&G&&(C[G]=!0),y(X,"2dMap")&&(Z[G]=!0,Z[Y]=!0),y(X,"oriented")&&(Q[X.orientation==="h"?Y:G]=!0)}}var K=T._subplots,D=K.xaxis,B=K.yaxis,q=t.simpleMap(D,r),ee=t.simpleMap(B,r),J=q.concat(ee),$=m.background;D.length&&B.length&&($=t.coerce(x,T,f,"plot_bgcolor"));var te,ie,ae,he,se,de=m.combine($,T.paper_bgcolor);function ce(){var $e=k[te]||[];se._traceIndices=$e.map(function(xt){return xt._expandedIndex}),se._annIndices=[],se._shapeIndices=[],se._imgIndices=[],se._subplotsWith=[],se._counterAxes=[],se._name=se._attr=te,se._id=ie}function ve($e,xt){return t.coerce(he,se,u,$e,xt)}function ke($e,xt){return t.coerce2(he,se,u,$e,xt)}function Ee($e){return $e==="x"?B:D}function be($e,xt){for(var Qt=$e==="x"?q:ee,$t=[],Ue=0;Ue<Qt.length;Ue++){var He=Qt[Ue];He===xt||(x[He]||{}).overlaying||$t.push(n(He))}return $t}var xe={x:Ee("x"),y:Ee("y")},ue=xe.x.concat(xe.y),me={},we=[];function Me(){var $e=he.matches;d.test($e)&&ue.indexOf($e)===-1&&(me[$e]=he.type,we=Object.keys(me))}var Se=p(x,T),De=g(Se);for(S=0;S<J.length;S++){te=J[S],ie=n(te),ae=te.charAt(0),t.isPlainObject(x[te])||(x[te]={}),he=x[te],se=e.newContainer(T,te,ae+"axis"),ce();var Fe=ae==="x"&&!P[te]&&C[te]||ae==="y"&&!O[te]&&M[te],Ye=ae==="y"&&(!F[te]&&j[te]||W[te]),et={letter:ae,font:T.font,outerTicks:Z[te],showGrid:!Q[te],data:k[te]||[],bgColor:de,calendar:T.calendar,automargin:!0,visibleDflt:Fe,reverseDflt:Ye,autotypenumbersDflt:L,splomStash:((T._splomAxes||{})[ae]||{})[ie]};ve("uirevision",T.uirevision),i(he,se,ve,et),s(he,se,ve,et,T);var Oe=De&&ae===Se.charAt(0),je=ke("spikecolor",De?se.color:void 0),We=ke("spikethickness",De?1.5:void 0),Ge=ke("spikedash",De?"dot":void 0),Qe=ke("spikemode",De?"across":void 0),it=ke("spikesnap");ve("showspikes",!!(Oe||je||We||Ge||Qe||it))||(delete se.spikecolor,delete se.spikethickness,delete se.spikedash,delete se.spikemode,delete se.spikesnap),a(he,se,ve,{letter:ae,counterAxes:xe[ae],overlayableAxes:be(ae,te),grid:T.grid}),ve("title.standoff"),Me(),se._input=he}for(S=0;S<we.length;){ie=we[S++],ae=(te=r(ie)).charAt(0),t.isPlainObject(x[te])||(x[te]={}),he=x[te],se=e.newContainer(T,te,ae+"axis"),ce();var lt={letter:ae,font:T.font,outerTicks:Z[te],showGrid:!Q[te],data:[],bgColor:de,calendar:T.calendar,automargin:!0,visibleDflt:!1,reverseDflt:!1,autotypenumbersDflt:L,splomStash:((T._splomAxes||{})[ae]||{})[ie]};ve("uirevision",T.uirevision),se.type=me[ie]||"linear",s(he,se,ve,lt,T),a(he,se,ve,{letter:ae,counterAxes:xe[ae],overlayableAxes:be(ae,te),grid:T.grid}),ve("fixedrange"),Me(),se._input=he}var Lt=v("rangeslider","handleDefaults"),wt=v("rangeselector","handleDefaults");for(S=0;S<q.length;S++)te=q[S],he=x[te],se=T[te],Lt(x,T,te),se.type==="date"&&wt(he,se,T,ee,se.calendar),ve("fixedrange");for(S=0;S<ee.length;S++){te=ee[S],he=x[te],se=T[te];var rt=T[r(se.anchor)];ve("fixedrange",v("rangeslider","isVisible")(rt))}o.handleDefaults(x,T,{axIds:ue.concat(we).sort(c.idSort),axHasImage:W})}},{"../../components/color":650,"../../components/fx/helpers":686,"../../components/fx/hovermode_defaults":689,"../../lib":787,"../../plot_api/plot_template":827,"../../registry":915,"../layout_attributes":892,"./axis_defaults":840,"./axis_ids":842,"./constants":845,"./constraints":846,"./layout_attributes":853,"./position_defaults":856,"./type_defaults":864}],855:[function(h,N,H){var t=h("tinycolor2").mix,m=h("../../components/color/attributes").lightFraction,g=h("../../lib");N.exports=function(p,e,f,u){var i=(u=u||{}).dfltColor;function s(l,y){return g.coerce2(p,e,u.attributes,l,y)}var o=s("linecolor",i),a=s("linewidth");f("showline",u.showLine||!!o||!!a)||(delete e.linecolor,delete e.linewidth);var c=s("gridcolor",t(i,u.bgColor,u.blend||m).toRgbString()),r=s("gridwidth");if(f("showgrid",u.showGrid||!!c||!!r)||(delete e.gridcolor,delete e.gridwidth),!u.noZeroLine){var n=s("zerolinecolor",i),d=s("zerolinewidth");f("zeroline",u.showGrid||!!n||!!d)||(delete e.zerolinecolor,delete e.zerolinewidth)}}},{"../../components/color/attributes":649,"../../lib":787,tinycolor2:583}],856:[function(h,N,H){var t=h("fast-isnumeric"),m=h("../../lib");N.exports=function(g,p,e,f){var u,i,s,o,a=f.counterAxes||[],c=f.overlayableAxes||[],r=f.letter,n=f.grid;n&&(i=n._domains[r][n._axisMap[p._id]],u=n._anchors[p._id],i&&(s=n[r+"side"].split(" ")[0],o=n.domain[r][s==="right"||s==="top"?1:0])),i=i||[0,1],u=u||(t(g.position)?"free":a[0]||"free"),s=s||(r==="x"?"bottom":"left"),o=o||0,m.coerce(g,p,{anchor:{valType:"enumerated",values:["free"].concat(a),dflt:u}},"anchor")==="free"&&e("position",o),m.coerce(g,p,{side:{valType:"enumerated",values:r==="x"?["bottom","top"]:["left","right"],dflt:s}},"side");var d=!1;if(c.length&&(d=m.coerce(g,p,{overlaying:{valType:"enumerated",values:[!1].concat(c),dflt:!1}},"overlaying")),!d){var l=e("domain",i);l[0]>l[1]-1/4096&&(p.domain=i),m.noneOrAll(g.domain,p.domain,i)}return e("layer"),p}},{"../../lib":787,"fast-isnumeric":246}],857:[function(h,N,H){var t=h("../../constants/alignment").FROM_BL;N.exports=function(m,g,p){p===void 0&&(p=t[m.constraintoward||"center"]);var e=[m.r2l(m.range[0]),m.r2l(m.range[1])],f=e[0]+(e[1]-e[0])*p;m.range=m._input.range=[m.l2r(f+(e[0]-f)*g),m.l2r(f+(e[1]-f)*g)],m.setScale()}},{"../../constants/alignment":755}],858:[function(h,N,H){var t=h("polybooljs"),m=h("../../registry"),g=h("../../components/drawing").dashStyle,p=h("../../components/color"),e=h("../../components/fx"),f=h("../../components/fx/helpers").makeEventData,u=h("../../components/dragelement/helpers"),i=u.freeMode,s=u.rectMode,o=u.drawMode,a=u.openMode,c=u.selectMode,r=h("../../components/shapes/draw_newshape/display_outlines"),n=h("../../components/shapes/draw_newshape/helpers").handleEllipse,d=h("../../components/shapes/draw_newshape/newshapes"),l=h("../../lib"),y=h("../../lib/polygon"),v=h("../../lib/throttle"),_=h("./axis_ids").getFromId,x=h("../../lib/clear_gl_canvases"),T=h("../../plot_api/subroutines").redrawReglTraces,A=h("./constants"),S=A.MINSELECT,w=y.filter,L=y.tester,k=h("./handle_outline").clearSelect,C=h("./helpers"),M=C.p2r,P=C.axValue,O=C.getTransform;function F(q,ee,J,$,te,ie,ae){var he,se,de,ce,ve,ke,Ee,be,xe,ue=ee._hoverdata,me=ee._fullLayout.clickmode.indexOf("event")>-1,we=[];if(function(Ye){return Ye&&Array.isArray(Ye)&&Ye[0].hoverOnBox!==!0}(ue)){Q(q,ee,ie);var Me=function(Ye,et){var Oe,je,We=Ye[0],Ge=-1,Qe=[];for(je=0;je<et.length;je++)if(Oe=et[je],We.fullData._expandedIndex===Oe.cd[0].trace._expandedIndex){if(We.hoverOnBox===!0)break;We.pointNumber!==void 0?Ge=We.pointNumber:We.binNumber!==void 0&&(Ge=We.binNumber,Qe=We.pointNumbers);break}return{pointNumber:Ge,pointNumbers:Qe,searchInfo:Oe}}(ue,he=G(ee,J,$,te));if(Me.pointNumbers.length>0?function(Ye,et){var Oe,je,We,Ge=[];for(We=0;We<Ye.length;We++)(Oe=Ye[We]).cd[0].trace.selectedpoints&&Oe.cd[0].trace.selectedpoints.length>0&&Ge.push(Oe);if(Ge.length===1&&Ge[0]===et.searchInfo&&(je=et.searchInfo.cd[0].trace).selectedpoints.length===et.pointNumbers.length){for(We=0;We<et.pointNumbers.length;We++)if(je.selectedpoints.indexOf(et.pointNumbers[We])<0)return!1;return!0}return!1}(he,Me):function(Ye){var et,Oe,je,We=0;for(je=0;je<Ye.length;je++)if(et=Ye[je],(Oe=et.cd[0].trace).selectedpoints&&(Oe.selectedpoints.length>1||(We+=Oe.selectedpoints.length)>1))return!1;return We===1}(he)&&(ke=Y(Me))){for(ae&&ae.remove(),xe=0;xe<he.length;xe++)(se=he[xe])._module.selectPoints(se,!1);K(ee,he),X(ie),me&&ee.emit("plotly_deselect",null)}else{for(Ee=q.shiftKey&&(ke!==void 0?ke:Y(Me)),de=function(Ye,et,Oe){return{pointNumber:Ye,searchInfo:et,subtract:Oe}}(Me.pointNumber,Me.searchInfo,Ee),ce=Z(ie.selectionDefs.concat([de])),xe=0;xe<he.length;xe++)if(ve=D(he[xe]._module.selectPoints(he[xe],ce),he[xe]),we.length)for(var Se=0;Se<ve.length;Se++)we.push(ve[Se]);else we=ve;if(K(ee,he,be={points:we}),de&&ie&&ie.selectionDefs.push(de),ae){var De=ie.mergedPolygons,Fe=a(ie.dragmode);r(B(De,Fe),ae,ie)}me&&ee.emit("plotly_selected",be)}}}function j(q){return"pointNumber"in q&&"searchInfo"in q}function W(q){return{xmin:0,xmax:0,ymin:0,ymax:0,pts:[],contains:function(ee,J,$,te){var ie=q.searchInfo.cd[0].trace._expandedIndex;return te.cd[0].trace._expandedIndex===ie&&$===q.pointNumber},isRect:!1,degenerate:!1,subtract:q.subtract}}function Z(q){for(var ee=[],J=j(q[0])?0:q[0][0][0],$=J,te=j(q[0])?0:q[0][0][1],ie=te,ae=0;ae<q.length;ae++)if(j(q[ae]))ee.push(W(q[ae]));else{var he=y.tester(q[ae]);he.subtract=q[ae].subtract,ee.push(he),J=Math.min(J,he.xmin),$=Math.max($,he.xmax),te=Math.min(te,he.ymin),ie=Math.max(ie,he.ymax)}return{xmin:J,xmax:$,ymin:te,ymax:ie,pts:[],contains:function(se,de,ce,ve){for(var ke=!1,Ee=0;Ee<ee.length;Ee++)ee[Ee].contains(se,de,ce,ve)&&(ke=ee[Ee].subtract===!1);return ke},isRect:!1,degenerate:!1}}function Q(q,ee,J){ee._fullLayout._drawing=!1;var $=ee._fullLayout,te=J.plotinfo,ie=J.dragmode,ae=$._lastSelectedSubplot&&$._lastSelectedSubplot===te.id,he=(q.shiftKey||q.altKey)&&!(o(ie)&&a(ie));ae&&he&&te.selection&&te.selection.selectionDefs&&!J.selectionDefs?(J.selectionDefs=te.selection.selectionDefs,J.mergedPolygons=te.selection.mergedPolygons):he&&te.selection||X(J),ae||(k(ee),$._lastSelectedSubplot=te.id)}function X(q){var ee=q.dragmode,J=q.plotinfo,$=q.gd;if($._fullLayout._activeShapeIndex>=0&&$._fullLayout._deactivateShape($),o(ee)){var te=$._fullLayout._zoomlayer.selectAll(".select-outline-"+J.id);if(te&&$._fullLayout._drawing){var ie=d(te,q);ie&&m.call("_guiRelayout",$,{shapes:ie}),$._fullLayout._drawing=!1}}J.selection={},J.selection.selectionDefs=q.selectionDefs=[],J.selection.mergedPolygons=q.mergedPolygons=[]}function G(q,ee,J,$){var te,ie,ae,he=[],se=ee.map(function(Ee){return Ee._id}),de=J.map(function(Ee){return Ee._id});for(ae=0;ae<q.calcdata.length;ae++)if((ie=(te=q.calcdata[ae])[0].trace).visible===!0&&ie._module&&ie._module.selectPoints)if(!$||ie.subplot!==$&&ie.geo!==$)if(ie.type==="splom"&&ie._xaxes[se[0]]&&ie._yaxes[de[0]]){var ce=ke(ie._module,te,ee[0],J[0]);ce.scene=q._fullLayout._splomScenes[ie.uid],he.push(ce)}else if(ie.type==="sankey"){var ve=ke(ie._module,te,ee[0],J[0]);he.push(ve)}else{if(se.indexOf(ie.xaxis)===-1||de.indexOf(ie.yaxis)===-1)continue;he.push(ke(ie._module,te,_(q,ie.xaxis),_(q,ie.yaxis)))}else he.push(ke(ie._module,te,ee[0],J[0]));return he;function ke(Ee,be,xe,ue){return{_module:Ee,cd:be,xaxis:xe,yaxis:ue}}}function Y(q){var ee=q.searchInfo.cd[0].trace,J=q.pointNumber,$=q.pointNumbers,te=$.length>0?$[0]:J;return!!ee.selectedpoints&&ee.selectedpoints.indexOf(te)>-1}function K(q,ee,J){var $,te,ie,ae;for($=0;$<ee.length;$++){var he=ee[$].cd[0].trace._fullInput,se=q._fullLayout._tracePreGUI[he.uid]||{};se.selectedpoints===void 0&&(se.selectedpoints=he._input.selectedpoints||null)}if(J){var de=J.points||[];for($=0;$<ee.length;$++)(ae=ee[$].cd[0].trace)._input.selectedpoints=ae._fullInput.selectedpoints=[],ae._fullInput!==ae&&(ae.selectedpoints=[]);for($=0;$<de.length;$++){var ce=de[$],ve=ce.data,ke=ce.fullData;ce.pointIndices?([].push.apply(ve.selectedpoints,ce.pointIndices),ae._fullInput!==ae&&[].push.apply(ke.selectedpoints,ce.pointIndices)):(ve.selectedpoints.push(ce.pointIndex),ae._fullInput!==ae&&ke.selectedpoints.push(ce.pointIndex))}}else for($=0;$<ee.length;$++)delete(ae=ee[$].cd[0].trace).selectedpoints,delete ae._input.selectedpoints,ae._fullInput!==ae&&delete ae._fullInput.selectedpoints;var Ee=!1;for($=0;$<ee.length;$++){ae=(ie=(te=ee[$]).cd)[0].trace,m.traceIs(ae,"regl")&&(Ee=!0);var be=te._module,xe=be.styleOnSelect||be.style;xe&&(xe(q,ie,ie[0].node3),ie[0].nodeRangePlot3&&xe(q,ie,ie[0].nodeRangePlot3))}Ee&&(x(q),T(q))}function D(q,ee){if(Array.isArray(q))for(var J=ee.cd,$=ee.cd[0].trace,te=0;te<q.length;te++)q[te]=f(q[te],$,J);return q}function B(q,ee){for(var J=[],$=0;$<q.length;$++){J[$]=[];for(var te=0;te<q[$].length;te++){J[$][te]=[],J[$][te][0]=te?"L":"M";for(var ie=0;ie<q[$][te].length;ie++)J[$][te].push(q[$][te][ie])}ee||J[$].push(["Z",J[$][0][1],J[$][0][2]])}return J}N.exports={prepSelect:function(q,ee,J,$,te){var ie=i(te),ae=s(te),he=a(te),se=o(te),de=c(te),ce=te==="drawcircle",ve=te==="drawline"||ce,ke=$.gd,Ee=ke._fullLayout,be=Ee._zoomlayer,xe=$.element.getBoundingClientRect(),ue=$.plotinfo,me=O(ue),we=ee-xe.left,Me=J-xe.top;Ee._calcInverseTransform(ke);var Se=l.apply3DTransform(Ee._invTransform)(we,Me);we=Se[0],Me=Se[1];var De,Fe,Ye,et,Oe,je,We,Ge=Ee._invScaleX,Qe=Ee._invScaleY,it=we,lt=Me,Lt="M"+we+","+Me,wt=$.xaxes[0]._length,rt=$.yaxes[0]._length,$e=$.xaxes.concat($.yaxes),xt=q.altKey&&!(o(te)&&he);Q(q,ke,$),ie&&(De=w([[we,Me]],A.BENDPX));var Qt=be.selectAll("path.select-outline-"+ue.id).data(se?[0]:[1,2]),$t=Ee.newshape;Qt.enter().append("path").attr("class",function(Ce){return"select-outline select-outline-"+Ce+" select-outline-"+ue.id}).style(se?{opacity:$t.opacity/2,fill:he?void 0:$t.fillcolor,stroke:$t.line.color,"stroke-dasharray":g($t.line.dash,$t.line.width),"stroke-width":$t.line.width+"px"}:{}).attr("fill-rule",$t.fillrule).classed("cursor-move",!!se).attr("transform",me).attr("d",Lt+"Z");var Ue,He=be.append("path").attr("class","zoombox-corners").style({fill:p.background,stroke:p.defaultLine,"stroke-width":1}).attr("transform",me).attr("d","M0,0Z"),Be=Ee._uid+A.SELECTID,Je=[],_e=G(ke,$.xaxes,$.yaxes,$.subplot);function Le(Ce,Pe){return Ce-Pe}Ue=ue.fillRangeItems?ue.fillRangeItems:ae?function(Ce,Pe){var Xe=Ce.range={};for(Oe=0;Oe<$e.length;Oe++){var ut=$e[Oe],kt=ut._id.charAt(0);Xe[ut._id]=[M(ut,Pe[kt+"min"]),M(ut,Pe[kt+"max"])].sort(Le)}}:function(Ce,Pe,Xe){var ut=Ce.lassoPoints={};for(Oe=0;Oe<$e.length;Oe++){var kt=$e[Oe];ut[kt._id]=Xe.filtered.map(P(kt))}},$.moveFn=function(Ce,Pe){it=Math.max(0,Math.min(wt,Ge*Ce+we)),lt=Math.max(0,Math.min(rt,Qe*Pe+Me));var Xe=Math.abs(it-we),ut=Math.abs(lt-Me);if(ae){var kt,ft,Et;if(de){var mt=Ee.selectdirection;switch(kt=mt==="any"?ut<Math.min(.6*Xe,S)?"h":Xe<Math.min(.6*ut,S)?"v":"d":mt){case"h":ft=ce?rt/2:0,Et=rt;break;case"v":ft=ce?wt/2:0,Et=wt}}if(se)switch(Ee.newshape.drawdirection){case"vertical":kt="h",ft=ce?rt/2:0,Et=rt;break;case"horizontal":kt="v",ft=ce?wt/2:0,Et=wt;break;case"ortho":Xe<ut?(kt="h",ft=Me,Et=lt):(kt="v",ft=we,Et=it);break;default:kt="d"}kt==="h"?((et=ve?n(ce,[it,ft],[it,Et]):[[we,ft],[we,Et],[it,Et],[it,ft]]).xmin=ve?it:Math.min(we,it),et.xmax=ve?it:Math.max(we,it),et.ymin=Math.min(ft,Et),et.ymax=Math.max(ft,Et),He.attr("d","M"+et.xmin+","+(Me-S)+"h-4v"+2*S+"h4ZM"+(et.xmax-1)+","+(Me-S)+"h4v"+2*S+"h-4Z")):kt==="v"?((et=ve?n(ce,[ft,lt],[Et,lt]):[[ft,Me],[ft,lt],[Et,lt],[Et,Me]]).xmin=Math.min(ft,Et),et.xmax=Math.max(ft,Et),et.ymin=ve?lt:Math.min(Me,lt),et.ymax=ve?lt:Math.max(Me,lt),He.attr("d","M"+(we-S)+","+et.ymin+"v-4h"+2*S+"v4ZM"+(we-S)+","+(et.ymax-1)+"v4h"+2*S+"v-4Z")):kt==="d"&&((et=ve?n(ce,[we,Me],[it,lt]):[[we,Me],[we,lt],[it,lt],[it,Me]]).xmin=Math.min(we,it),et.xmax=Math.max(we,it),et.ymin=Math.min(Me,lt),et.ymax=Math.max(Me,lt),He.attr("d","M0,0Z"))}else ie&&(De.addPt([it,lt]),et=De.filtered);$.selectionDefs&&$.selectionDefs.length?(Ye=function(It,vt,nt){return nt?t.difference({regions:It,inverted:!1},{regions:[vt],inverted:!1}).regions:t.union({regions:It,inverted:!1},{regions:[vt],inverted:!1}).regions}($.mergedPolygons,et,xt),et.subtract=xt,Fe=Z($.selectionDefs.concat([et]))):(Ye=[et],Fe=L(et)),r(B(Ye,he),Qt,$),de&&v.throttle(Be,A.SELECTDELAY,function(){var It;Je=[];var vt;for(Oe=0;Oe<_e.length;Oe++)if(vt=(je=_e[Oe])._module.selectPoints(je,Fe),It=D(vt,je),Je.length)for(var nt=0;nt<It.length;nt++)Je.push(It[nt]);else Je=It;K(ke,_e,We={points:Je}),Ue(We,et,De),$.gd.emit("plotly_selecting",We)})},$.clickFn=function(Ce,Pe){if(He.remove(),ke._fullLayout._activeShapeIndex>=0)ke._fullLayout._deactivateShape(ke);else if(!se){var Xe=Ee.clickmode;v.done(Be).then(function(){if(v.clear(Be),Ce===2){for(Qt.remove(),Oe=0;Oe<_e.length;Oe++)(je=_e[Oe])._module.selectPoints(je,!1);K(ke,_e),X($),ke.emit("plotly_deselect",null)}else Xe.indexOf("select")>-1&&F(Pe,ke,$.xaxes,$.yaxes,$.subplot,$,Qt),Xe==="event"&&ke.emit("plotly_selected",void 0);e.click(ke,Pe)}).catch(l.error)}},$.doneFn=function(){He.remove(),v.done(Be).then(function(){v.clear(Be),$.gd.emit("plotly_selected",We),et&&$.selectionDefs&&(et.subtract=xt,$.selectionDefs.push(et),$.mergedPolygons.length=0,[].push.apply($.mergedPolygons,Ye)),$.doneFnCompleted&&$.doneFnCompleted(Je)}).catch(l.error),se&&X($)}},clearSelect:k,clearSelectionsCache:X,selectOnClick:F}},{"../../components/color":650,"../../components/dragelement/helpers":668,"../../components/drawing":672,"../../components/fx":690,"../../components/fx/helpers":686,"../../components/shapes/draw_newshape/display_outlines":738,"../../components/shapes/draw_newshape/helpers":739,"../../components/shapes/draw_newshape/newshapes":740,"../../lib":787,"../../lib/clear_gl_canvases":771,"../../lib/polygon":799,"../../lib/throttle":814,"../../plot_api/subroutines":828,"../../registry":915,"./axis_ids":842,"./constants":845,"./handle_outline":849,"./helpers":850,polybooljs:490}],859:[function(h,N,H){var t=h("@plotly/d3"),m=h("d3-time-format").utcFormat,g=h("../../lib"),p=g.numberFormat,e=h("fast-isnumeric"),f=g.cleanNumber,u=g.ms2DateTime,i=g.dateTime2ms,s=g.ensureNumber,o=g.isArrayOrTypedArray,a=h("../../constants/numerical"),c=a.FP_SAFE,r=a.BADNUM,n=a.LOG_CLIP,d=a.ONEWEEK,l=a.ONEDAY,y=a.ONEHOUR,v=a.ONEMIN,_=a.ONESEC,x=h("./axis_ids"),T=h("./constants"),A=T.HOUR_PATTERN,S=T.WEEKDAY_PATTERN;function w(k){return Math.pow(10,k)}function L(k){return k!=null}N.exports=function(k,C){C=C||{};var M=k._id||"x",P=M.charAt(0);function O(J,$){if(J>0)return Math.log(J)/Math.LN10;if(J<=0&&$&&k.range&&k.range.length===2){var te=k.range[0],ie=k.range[1];return .5*(te+ie-2*n*Math.abs(te-ie))}return r}function F(J,$,te,ie){if((ie||{}).msUTC&&e(J))return+J;var ae=i(J,te||k.calendar);if(ae===r){if(!e(J))return r;J=+J;var he=Math.floor(10*g.mod(J+.05,1)),se=Math.round(J-he/10);ae=i(new Date(se))+he/10}return ae}function j(J,$,te){return u(J,$,te||k.calendar)}function W(J){return k._categories[Math.round(J)]}function Z(J){if(L(J)){if(k._categoriesMap===void 0&&(k._categoriesMap={}),k._categoriesMap[J]!==void 0)return k._categoriesMap[J];k._categories.push(typeof J=="number"?String(J):J);var $=k._categories.length-1;return k._categoriesMap[J]=$,$}return r}function Q(J){if(k._categoriesMap)return k._categoriesMap[J]}function X(J){var $=Q(J);return $!==void 0?$:e(J)?+J:void 0}function G(J){return e(J)?+J:Q(J)}function Y(J,$,te){return t.round(te+$*J,2)}function K(J,$,te){return(J-te)/$}var D=function(J){return e(J)?Y(J,k._m,k._b):r},B=function(J){return K(J,k._m,k._b)};if(k.rangebreaks){var q=P==="y";D=function(J){if(!e(J))return r;var $=k._rangebreaks.length;if(!$)return Y(J,k._m,k._b);var te=q;k.range[0]>k.range[1]&&(te=!te);for(var ie=te?-1:1,ae=ie*J,he=0,se=0;se<$;se++){var de=ie*k._rangebreaks[se].min,ce=ie*k._rangebreaks[se].max;if(ae<de)break;if(!(ae>ce)){he=ae<(de+ce)/2?se:se+1;break}he=se+1}var ve=k._B[he]||0;return isFinite(ve)?Y(J,k._m2,ve):0},B=function(J){var $=k._rangebreaks.length;if(!$)return K(J,k._m,k._b);for(var te=0,ie=0;ie<$&&!(J<k._rangebreaks[ie].pmin);ie++)J>k._rangebreaks[ie].pmax&&(te=ie+1);return K(J,k._m2,k._B[te])}}k.c2l=k.type==="log"?O:s,k.l2c=k.type==="log"?w:s,k.l2p=D,k.p2l=B,k.c2p=k.type==="log"?function(J,$){return D(O(J,$))}:D,k.p2c=k.type==="log"?function(J){return w(B(J))}:B,["linear","-"].indexOf(k.type)!==-1?(k.d2r=k.r2d=k.d2c=k.r2c=k.d2l=k.r2l=f,k.c2d=k.c2r=k.l2d=k.l2r=s,k.d2p=k.r2p=function(J){return k.l2p(f(J))},k.p2d=k.p2r=B,k.cleanPos=s):k.type==="log"?(k.d2r=k.d2l=function(J,$){return O(f(J),$)},k.r2d=k.r2c=function(J){return w(f(J))},k.d2c=k.r2l=f,k.c2d=k.l2r=s,k.c2r=O,k.l2d=w,k.d2p=function(J,$){return k.l2p(k.d2r(J,$))},k.p2d=function(J){return w(B(J))},k.r2p=function(J){return k.l2p(f(J))},k.p2r=B,k.cleanPos=s):k.type==="date"?(k.d2r=k.r2d=g.identity,k.d2c=k.r2c=k.d2l=k.r2l=F,k.c2d=k.c2r=k.l2d=k.l2r=j,k.d2p=k.r2p=function(J,$,te){return k.l2p(F(J,0,te))},k.p2d=k.p2r=function(J,$,te){return j(B(J),$,te)},k.cleanPos=function(J){return g.cleanDate(J,r,k.calendar)}):k.type==="category"?(k.d2c=k.d2l=Z,k.r2d=k.c2d=k.l2d=W,k.d2r=k.d2l_noadd=X,k.r2c=function(J){var $=G(J);return $!==void 0?$:k.fraction2r(.5)},k.l2r=k.c2r=s,k.r2l=G,k.d2p=function(J){return k.l2p(k.r2c(J))},k.p2d=function(J){return W(B(J))},k.r2p=k.d2p,k.p2r=B,k.cleanPos=function(J){return typeof J=="string"&&J!==""?J:s(J)}):k.type==="multicategory"&&(k.r2d=k.c2d=k.l2d=W,k.d2r=k.d2l_noadd=X,k.r2c=function(J){var $=X(J);return $!==void 0?$:k.fraction2r(.5)},k.r2c_just_indices=Q,k.l2r=k.c2r=s,k.r2l=X,k.d2p=function(J){return k.l2p(k.r2c(J))},k.p2d=function(J){return W(B(J))},k.r2p=k.d2p,k.p2r=B,k.cleanPos=function(J){return Array.isArray(J)||typeof J=="string"&&J!==""?J:s(J)},k.setupMultiCategory=function(J){var $,te,ie=k._traceIndices,ae=k._matchGroup;if(ae&&k._categories.length===0){for(var he in ae)if(he!==M){var se=C[x.id2name(he)];ie=ie.concat(se._traceIndices)}}var de=[[0,{}],[0,{}]],ce=[];for($=0;$<ie.length;$++){var ve=J[ie[$]];if(P in ve){var ke=ve[P],Ee=ve._length||g.minRowLength(ke);if(o(ke[0])&&o(ke[1]))for(te=0;te<Ee;te++){var be=ke[0][te],xe=ke[1][te];L(be)&&L(xe)&&(ce.push([be,xe]),be in de[0][1]||(de[0][1][be]=de[0][0]++),xe in de[1][1]||(de[1][1][xe]=de[1][0]++))}}}for(ce.sort(function(ue,me){var we=de[0][1],Me=we[ue[0]]-we[me[0]];if(Me)return Me;var Se=de[1][1];return Se[ue[1]]-Se[me[1]]}),$=0;$<ce.length;$++)Z(ce[$])}),k.fraction2r=function(J){var $=k.r2l(k.range[0]),te=k.r2l(k.range[1]);return k.l2r($+J*(te-$))},k.r2fraction=function(J){var $=k.r2l(k.range[0]),te=k.r2l(k.range[1]);return(k.r2l(J)-$)/(te-$)},k.cleanRange=function(J,$){$||($={}),J||(J="range");var te,ie,ae=g.nestedProperty(k,J).get();if(ie=(ie=k.type==="date"?g.dfltRange(k.calendar):P==="y"?T.DFLTRANGEY:$.dfltRange||T.DFLTRANGEX).slice(),k.rangemode!=="tozero"&&k.rangemode!=="nonnegative"||(ie[0]=0),ae&&ae.length===2)for(k.type!=="date"||k.autorange||(ae[0]=g.cleanDate(ae[0],r,k.calendar),ae[1]=g.cleanDate(ae[1],r,k.calendar)),te=0;te<2;te++)if(k.type==="date"){if(!g.isDateTime(ae[te],k.calendar)){k[J]=ie;break}if(k.r2l(ae[0])===k.r2l(ae[1])){var he=g.constrain(k.r2l(ae[0]),g.MIN_MS+1e3,g.MAX_MS-1e3);ae[0]=k.l2r(he-1e3),ae[1]=k.l2r(he+1e3);break}}else{if(!e(ae[te])){if(!e(ae[1-te])){k[J]=ie;break}ae[te]=ae[1-te]*(te?10:.1)}if(ae[te]<-c?ae[te]=-c:ae[te]>c&&(ae[te]=c),ae[0]===ae[1]){var se=Math.max(1,Math.abs(1e-6*ae[0]));ae[0]-=se,ae[1]+=se}}else g.nestedProperty(k,J).set(ie)},k.setScale=function(J){var $=C._size;if(k.overlaying){var te=x.getFromId({_fullLayout:C},k.overlaying);k.domain=te.domain}var ie=J&&k._r?"_r":"range",ae=k.calendar;k.cleanRange(ie);var he,se,de=k.r2l(k[ie][0],ae),ce=k.r2l(k[ie][1],ae),ve=P==="y";if(ve?(k._offset=$.t+(1-k.domain[1])*$.h,k._length=$.h*(k.domain[1]-k.domain[0]),k._m=k._length/(de-ce),k._b=-k._m*ce):(k._offset=$.l+k.domain[0]*$.w,k._length=$.w*(k.domain[1]-k.domain[0]),k._m=k._length/(ce-de),k._b=-k._m*de),k._rangebreaks=[],k._lBreaks=0,k._m2=0,k._B=[],k.rangebreaks&&(k._rangebreaks=k.locateBreaks(Math.min(de,ce),Math.max(de,ce)),k._rangebreaks.length)){for(he=0;he<k._rangebreaks.length;he++)se=k._rangebreaks[he],k._lBreaks+=Math.abs(se.max-se.min);var ke=ve;de>ce&&(ke=!ke),ke&&k._rangebreaks.reverse();var Ee=ke?-1:1;for(k._m2=Ee*k._length/(Math.abs(ce-de)-k._lBreaks),k._B.push(-k._m2*(ve?ce:de)),he=0;he<k._rangebreaks.length;he++)se=k._rangebreaks[he],k._B.push(k._B[k._B.length-1]-Ee*k._m2*(se.max-se.min));for(he=0;he<k._rangebreaks.length;he++)(se=k._rangebreaks[he]).pmin=D(se.min),se.pmax=D(se.max)}if(!isFinite(k._m)||!isFinite(k._b)||k._length<0)throw C._replotting=!1,new Error("Something went wrong with axis scaling")},k.maskBreaks=function(J){var $,te,ie,ae,he,se=k.rangebreaks||[];se._cachedPatterns||(se._cachedPatterns=se.map(function(be){return be.enabled&&be.bounds?g.simpleMap(be.bounds,be.pattern?f:k.d2c):null})),se._cachedValues||(se._cachedValues=se.map(function(be){return be.enabled&&be.values?g.simpleMap(be.values,k.d2c).sort(g.sorterAsc):null}));for(var de=0;de<se.length;de++){var ce=se[de];if(ce.enabled){if(ce.bounds){var ve=ce.pattern;switch(te=($=se._cachedPatterns[de])[0],ie=$[1],ve){case S:ae=(he=new Date(J)).getUTCDay(),te>ie&&(ie+=7,ae<te&&(ae+=7));break;case A:ae=(he=new Date(J)).getUTCHours()+(he.getUTCMinutes()/60+he.getUTCSeconds()/3600+he.getUTCMilliseconds()/36e5),te>ie&&(ie+=24,ae<te&&(ae+=24));break;case"":ae=J}if(ae>=te&&ae<ie)return r}else for(var ke=se._cachedValues[de],Ee=0;Ee<ke.length;Ee++)if(ie=(te=ke[Ee])+ce.dvalue,J>=te&&J<ie)return r}}return J},k.locateBreaks=function(J,$){var te,ie,ae,he,se=[];if(!k.rangebreaks)return se;var de=k.rangebreaks.slice().sort(function(Se,De){return Se.pattern===S&&De.pattern===A?-1:De.pattern===S&&Se.pattern===A?1:0}),ce=function(Se,De){if((Se=g.constrain(Se,J,$))!==(De=g.constrain(De,J,$))){for(var Fe=!0,Ye=0;Ye<se.length;Ye++){var et=se[Ye];Se<et.max&&De>=et.min&&(Se<et.min&&(et.min=Se),De>et.max&&(et.max=De),Fe=!1)}Fe&&se.push({min:Se,max:De})}};for(te=0;te<de.length;te++){var ve=de[te];if(ve.enabled)if(ve.bounds){var ke=J,Ee=$;ve.pattern&&(ke=Math.floor(ke)),ae=(ie=g.simpleMap(ve.bounds,ve.pattern?f:k.r2l))[0],he=ie[1];var be,xe,ue=new Date(ke);switch(ve.pattern){case S:xe=d,be=(he-ae+(he<ae?7:0))*l,ke+=ae*l-(ue.getUTCDay()*l+ue.getUTCHours()*y+ue.getUTCMinutes()*v+ue.getUTCSeconds()*_+ue.getUTCMilliseconds());break;case A:xe=l,be=(he-ae+(he<ae?24:0))*y,ke+=ae*y-(ue.getUTCHours()*y+ue.getUTCMinutes()*v+ue.getUTCSeconds()*_+ue.getUTCMilliseconds());break;default:ke=Math.min(ie[0],ie[1]),be=xe=(Ee=Math.max(ie[0],ie[1]))-ke}for(var me=ke;me<Ee;me+=xe)ce(me,me+be)}else for(var we=g.simpleMap(ve.values,k.d2c),Me=0;Me<we.length;Me++)ce(ae=we[Me],he=ae+ve.dvalue)}return se.sort(function(Se,De){return Se.min-De.min}),se},k.makeCalcdata=function(J,$,te){var ie,ae,he,se,de=k.type,ce=de==="date"&&J[$+"calendar"];if($ in J){if(ie=J[$],se=J._length||g.minRowLength(ie),g.isTypedArray(ie)&&(de==="linear"||de==="log")){if(se===ie.length)return ie;if(ie.subarray)return ie.subarray(0,se)}if(de==="multicategory")return function(Ee,be){for(var xe=new Array(be),ue=0;ue<be;ue++){var me=(Ee[0]||[])[ue],we=(Ee[1]||[])[ue];xe[ue]=Q([me,we])}return xe}(ie,se);for(ae=new Array(se),he=0;he<se;he++)ae[he]=k.d2c(ie[he],0,ce,te)}else{var ve=$+"0"in J?k.d2c(J[$+"0"],0,ce):0,ke=J["d"+$]?Number(J["d"+$]):1;for(ie=J[{x:"y",y:"x"}[$]],se=J._length||ie.length,ae=new Array(se),he=0;he<se;he++)ae[he]=ve+he*ke}if(k.rangebreaks)for(he=0;he<se;he++)ae[he]=k.maskBreaks(ae[he]);return ae},k.isValidRange=function(J){return Array.isArray(J)&&J.length===2&&e(k.r2l(J[0]))&&e(k.r2l(J[1]))},k.isPtWithinRange=function(J,$){var te=k.c2l(J[P],null,$),ie=k.r2l(k.range[0]),ae=k.r2l(k.range[1]);return ie<ae?ie<=te&&te<=ae:ae<=te&&te<=ie},k._emptyCategories=function(){k._categories=[],k._categoriesMap={}},k.clearCalc=function(){var J=k._matchGroup;if(J){var $=null,te=null;for(var ie in J){var ae=C[x.id2name(ie)];if(ae._categories){$=ae._categories,te=ae._categoriesMap;break}}$&&te?(k._categories=$,k._categoriesMap=te):k._emptyCategories()}else k._emptyCategories();if(k._initialCategories)for(var he=0;he<k._initialCategories.length;he++)Z(k._initialCategories[he])},k.sortByInitialCategories=function(){var J=[];if(k._emptyCategories(),k._initialCategories)for(var $=0;$<k._initialCategories.length;$++)Z(k._initialCategories[$]);J=J.concat(k._traceIndices);var te=k._matchGroup;for(var ie in te)if(M!==ie){var ae=C[x.id2name(ie)];ae._categories=k._categories,ae._categoriesMap=k._categoriesMap,J=J.concat(ae._traceIndices)}return J};var ee=C._d3locale;k.type==="date"&&(k._dateFormat=ee?ee.timeFormat:m,k._extraFormat=C._extraFormat),k._separators=C.separators,k._numFormat=ee?ee.numberFormat:p,delete k._minDtick,delete k._forceTick0}},{"../../constants/numerical":763,"../../lib":787,"./axis_ids":842,"./constants":845,"@plotly/d3":58,"d3-time-format":172,"fast-isnumeric":246}],860:[function(h,N,H){var t=h("../../lib"),m=h("../../components/color").contrast,g=h("./layout_attributes"),p=h("../array_container_defaults");function e(u){var i=["showexponent","showtickprefix","showticksuffix"].filter(function(s){return u[s]!==void 0});if(i.every(function(s){return u[s]===u[i[0]]})||i.length===1)return u[i[0]]}function f(u,i){function s(o,a){return t.coerce(u,i,g.tickformatstops,o,a)}s("enabled")&&(s("dtickrange"),s("value"))}N.exports=function(u,i,s,o,a,c){c&&c.pass!==1||function(r,n,d,l,y){var v=e(r);d("tickprefix")&&d("showtickprefix",v),d("ticksuffix",y.tickSuffixDflt)&&d("showticksuffix",v)}(u,0,s,0,a),c&&c.pass!==2||function(r,n,d,l,y){var v=e(r);if(d("tickprefix")&&d("showtickprefix",v),d("ticksuffix",y.tickSuffixDflt)&&d("showticksuffix",v),d("showticklabels")){var _=y.font||{},x=n.color,T=(n.ticklabelposition||"").indexOf("inside")!==-1?m(y.bgColor):x&&x!==g.color.dflt?x:_.color;if(t.coerceFont(d,"tickfont",{family:_.family,size:_.size,color:T}),d("tickangle"),l!=="category"){var A=d("tickformat");p(r,n,{name:"tickformatstops",inclusionAttr:"enabled",handleItemDefaults:f}),n.tickformatstops.length||delete n.tickformatstops,A||l==="date"||(d("showexponent",v),d("exponentformat"),d("minexponent"),d("separatethousands"))}}}(u,i,s,o,a)}},{"../../components/color":650,"../../lib":787,"../array_container_defaults":833,"./layout_attributes":853}],861:[function(h,N,H){var t=h("../../lib"),m=h("./layout_attributes");N.exports=function(g,p,e,f){var u=t.coerce2(g,p,m,"ticklen"),i=t.coerce2(g,p,m,"tickwidth"),s=t.coerce2(g,p,m,"tickcolor",p.color);e("ticks",f.outerTicks||u||i||s?"outside":"")||(delete p.ticklen,delete p.tickwidth,delete p.tickcolor)}},{"../../lib":787,"./layout_attributes":853}],862:[function(h,N,H){var t=h("./clean_ticks"),m=h("../../lib").isArrayOrTypedArray;N.exports=function(g,p,e,f){function u(r){var n=g[r];return n!==void 0?n:(p._template||{})[r]}var i=u("tick0"),s=u("dtick"),o=u("tickvals"),a=e("tickmode",m(o)?"array":s?"linear":"auto");if(a==="auto")e("nticks");else if(a==="linear"){var c=p.dtick=t.dtick(s,f);p.tick0=t.tick0(i,f,p.calendar,c)}else f!=="multicategory"&&(e("tickvals")===void 0?p.tickmode="auto":e("ticktext"))}},{"../../lib":787,"./clean_ticks":844}],863:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../registry"),g=h("../../lib"),p=h("../../components/drawing"),e=h("./axes");N.exports=function(f,u,i,s){var o=f._fullLayout;if(u.length!==0){var a,c,r,n;s&&(a=s());var d=t.ease(i.easing);return f._transitionData._interruptCallbacks.push(function(){return window.cancelAnimationFrame(n),n=null,function(){for(var v={},_=0;_<u.length;_++){var x=u[_],T=x.plotinfo.xaxis,A=x.plotinfo.yaxis;x.xr0&&(v[T._name+".range"]=x.xr0.slice()),x.yr0&&(v[A._name+".range"]=x.yr0.slice())}return m.call("relayout",f,v).then(function(){for(var S=0;S<u.length;S++)l(u[S].plotinfo)})}()}),c=Date.now(),n=window.requestAnimationFrame(function v(){r=Date.now();for(var _=Math.min(1,(r-c)/i.duration),x=d(_),T=0;T<u.length;T++)y(u[T],x);r-c>i.duration?(function(){for(var A={},S=0;S<u.length;S++){var w=u[S],L=w.plotinfo.xaxis,k=w.plotinfo.yaxis;w.xr1&&(A[L._name+".range"]=w.xr1.slice()),w.yr1&&(A[k._name+".range"]=w.yr1.slice())}a&&a(),m.call("relayout",f,A).then(function(){for(var C=0;C<u.length;C++)l(u[C].plotinfo)})}(),n=window.cancelAnimationFrame(v)):n=window.requestAnimationFrame(v)}),Promise.resolve()}function l(v){var _=v.xaxis,x=v.yaxis;o._defs.select("#"+v.clipId+"> rect").call(p.setTranslate,0,0).call(p.setScale,1,1),v.plot.call(p.setTranslate,_._offset,x._offset).call(p.setScale,1,1);var T=v.plot.selectAll(".scatterlayer .trace");T.selectAll(".point").call(p.setPointGroupScale,1,1),T.selectAll(".textpoint").call(p.setTextPointsScale,1,1),T.call(p.hideOutsideRangePoints,v)}function y(v,_){var x=v.plotinfo,T=x.xaxis,A=x.yaxis,S=T._length,w=A._length,L=!!v.xr1,k=!!v.yr1,C=[];if(L){var M=g.simpleMap(v.xr0,T.r2l),P=g.simpleMap(v.xr1,T.r2l),O=M[1]-M[0],F=P[1]-P[0];C[0]=(M[0]*(1-_)+_*P[0]-M[0])/(M[1]-M[0])*S,C[2]=S*(1-_+_*F/O),T.range[0]=T.l2r(M[0]*(1-_)+_*P[0]),T.range[1]=T.l2r(M[1]*(1-_)+_*P[1])}else C[0]=0,C[2]=S;if(k){var j=g.simpleMap(v.yr0,A.r2l),W=g.simpleMap(v.yr1,A.r2l),Z=j[1]-j[0],Q=W[1]-W[0];C[1]=(j[1]*(1-_)+_*W[1]-j[1])/(j[0]-j[1])*w,C[3]=w*(1-_+_*Q/Z),A.range[0]=T.l2r(j[0]*(1-_)+_*W[0]),A.range[1]=A.l2r(j[1]*(1-_)+_*W[1])}else C[1]=0,C[3]=w;e.drawOne(f,T,{skipTitle:!0}),e.drawOne(f,A,{skipTitle:!0}),e.redrawComponents(f,[T._id,A._id]);var X=L?S/C[2]:1,G=k?w/C[3]:1,Y=L?C[0]:0,K=k?C[1]:0,D=L?C[0]/C[2]*S:0,B=k?C[1]/C[3]*w:0,q=T._offset-D,ee=A._offset-B;x.clipRect.call(p.setTranslate,Y,K).call(p.setScale,1/X,1/G),x.plot.call(p.setTranslate,q,ee).call(p.setScale,X,G),p.setPointGroupScale(x.zoomScalePts,1/X,1/G),p.setTextPointsScale(x.zoomScaleTxt,1/X,1/G)}e.redrawComponents(f)}},{"../../components/drawing":672,"../../lib":787,"../../registry":915,"./axes":838,"@plotly/d3":58}],864:[function(h,N,H){var t=h("../../registry").traceIs,m=h("./axis_autotype");function g(e){return{v:"x",h:"y"}[e.orientation||"v"]}function p(e,f){var u=g(e),i=t(e,"box-violin"),s=t(e._fullInput||{},"candlestick");return i&&!s&&f===u&&e[u]===void 0&&e[u+"0"]===void 0}N.exports=function(e,f,u,i){u("autotypenumbers",i.autotypenumbersDflt),u("type",(i.splomStash||{}).type)==="-"&&(function(s,o){if(s.type==="-"){var a,c=s._id,r=c.charAt(0);c.indexOf("scene")!==-1&&(c=r);var n=function(A,S,w){for(var L=0;L<A.length;L++){var k=A[L];if(k.type==="splom"&&k._length>0&&(k["_"+w+"axes"]||{})[S]||(k[w+"axis"]||w)===S&&(p(k,w)||(k[w]||[]).length||k[w+"0"]))return k}}(o,c,r);if(!!n){if(n.type==="histogram"&&r==={v:"y",h:"x"}[n.orientation||"v"])return void(s.type="linear");var d=r+"calendar",l=n[d],y={noMultiCategory:!t(n,"cartesian")||t(n,"noMultiCategory")};if(n.type==="box"&&n._hasPreCompStats&&r==={h:"x",v:"y"}[n.orientation||"v"]&&(y.noMultiCategory=!0),y.autotypenumbers=s.autotypenumbers,p(n,r)){var v=g(n),_=[];for(a=0;a<o.length;a++){var x=o[a];t(x,"box-violin")&&(x[r+"axis"]||r)===c&&(x[v]!==void 0?_.push(x[v][0]):x.name!==void 0?_.push(x.name):_.push("text"),x[d]!==l&&(l=void 0))}s.type=m(_,l,y)}else if(n.type==="splom"){var T=n.dimensions[n._axesDim[c]];T.visible&&(s.type=m(T.values,l,y))}else s.type=m(n[r]||[n[r+"0"]],l,y)}}}(f,i.data),f.type==="-"?f.type="linear":e.type=f.type)}},{"../../registry":915,"./axis_autotype":839}],865:[function(h,N,H){var t=h("../registry"),m=h("../lib");function g(u,i,s){var o,a,c,r=!1;if(i.type==="data")o=u._fullData[i.traces!==null?i.traces[0]:0];else{if(i.type!=="layout")return!1;o=u._fullLayout}return a=m.nestedProperty(o,i.prop).get(),(c=s[i.type]=s[i.type]||{}).hasOwnProperty(i.prop)&&c[i.prop]!==a&&(r=!0),c[i.prop]=a,{changed:r,value:a}}function p(u,i){var s=[],o=i[0],a={};if(typeof o=="string")a[o]=i[1];else{if(!m.isPlainObject(o))return s;a=o}return f(a,function(c,r,n){s.push({type:"layout",prop:c,value:n})},"",0),s}function e(u,i){var s,o,a,c,r=[];if(o=i[0],a=i[1],s=i[2],c={},typeof o=="string")c[o]=a;else{if(!m.isPlainObject(o))return r;c=o,s===void 0&&(s=a)}return s===void 0&&(s=null),f(c,function(n,d,l){var y,v;if(Array.isArray(l)){v=l.slice();var _=Math.min(v.length,u.data.length);s&&(_=Math.min(_,s.length)),y=[];for(var x=0;x<_;x++)y[x]=s?s[x]:x}else v=l,y=s?s.slice():null;if(y===null)Array.isArray(v)&&(v=v[0]);else if(Array.isArray(y)){if(!Array.isArray(v)){var T=v;v=[];for(var A=0;A<y.length;A++)v[A]=T}v.length=Math.min(y.length,v.length)}r.push({type:"data",prop:n,traces:y,value:v})},"",0),r}function f(u,i,s,o){Object.keys(u).forEach(function(a){var c=u[a];if(a[0]!=="_"){var r=s+(o>0?".":"")+a;m.isPlainObject(c)?f(c,i,r,o+1):i(r,a,c)}})}H.manageCommandObserver=function(u,i,s,o){var a={},c=!0;i&&i._commandObserver&&(a=i._commandObserver),a.cache||(a.cache={}),a.lookupTable={};var r=H.hasSimpleAPICommandBindings(u,s,a.lookupTable);if(i&&i._commandObserver){if(r)return a;if(i._commandObserver.remove)return i._commandObserver.remove(),i._commandObserver=null,a}if(r){g(u,r,a.cache),a.check=function(){if(c){var l=g(u,r,a.cache);return l.changed&&o&&a.lookupTable[l.value]!==void 0&&(a.disable(),Promise.resolve(o({value:l.value,type:r.type,prop:r.prop,traces:r.traces,index:a.lookupTable[l.value]})).then(a.enable,a.enable)),l.changed}};for(var n=["plotly_relayout","plotly_redraw","plotly_restyle","plotly_update","plotly_animatingframe","plotly_afterplot"],d=0;d<n.length;d++)u._internalOn(n[d],a.check);a.remove=function(){for(var l=0;l<n.length;l++)u._removeInternalListener(n[l],a.check)}}else m.log("Unable to automatically bind plot updates to API command"),a.lookupTable={},a.remove=function(){};return a.disable=function(){c=!1},a.enable=function(){c=!0},i&&(i._commandObserver=a),a},H.hasSimpleAPICommandBindings=function(u,i,s){var o,a,c=i.length;for(o=0;o<c;o++){var r,n=i[o],d=n.method,l=n.args;if(Array.isArray(l)||(l=[]),!d)return!1;var y=H.computeAPICommandBindings(u,d,l);if(y.length!==1)return!1;if(a){if((r=y[0]).type!==a.type||r.prop!==a.prop)return!1;if(Array.isArray(a.traces)){if(!Array.isArray(r.traces))return!1;r.traces.sort();for(var v=0;v<a.traces.length;v++)if(a.traces[v]!==r.traces[v])return!1}else if(r.prop!==a.prop)return!1}else a=y[0],Array.isArray(a.traces)&&a.traces.sort();var _=(r=y[0]).value;if(Array.isArray(_)){if(_.length!==1)return!1;_=_[0]}s&&(s[_]=o)}return a},H.executeAPICommand=function(u,i,s){if(i==="skip")return Promise.resolve();var o=t.apiMethodRegistry[i],a=[u];Array.isArray(s)||(s=[]);for(var c=0;c<s.length;c++)a.push(s[c]);return o.apply(null,a).catch(function(r){return m.warn("API call to Plotly."+i+" rejected.",r),Promise.reject(r)})},H.computeAPICommandBindings=function(u,i,s){var o;switch(Array.isArray(s)||(s=[]),i){case"restyle":o=e(u,s);break;case"relayout":o=p(u,s);break;case"update":o=e(u,[s[0],s[2]]).concat(p(u,[s[1]]));break;case"animate":o=function(a,c){return Array.isArray(c[0])&&c[0].length===1&&["string","number"].indexOf(typeof c[0][0])!==-1?[{type:"layout",prop:"_currentFrame",value:c[0][0].toString()}]:[]}(0,s);break;default:o=[]}return o}},{"../lib":787,"../registry":915}],866:[function(h,N,H){var t=h("../lib/extend").extendFlat;H.attributes=function(m,g){g=g||{};var p={valType:"info_array",editType:(m=m||{}).editType,items:[{valType:"number",min:0,max:1,editType:m.editType},{valType:"number",min:0,max:1,editType:m.editType}],dflt:[0,1]},e=(m.name&&m.name,m.trace,g.description&&g.description,{x:t({},p,{}),y:t({},p,{}),editType:m.editType});return m.noGridCell||(e.row={valType:"integer",min:0,dflt:0,editType:m.editType},e.column={valType:"integer",min:0,dflt:0,editType:m.editType}),e},H.defaults=function(m,g,p,e){var f=e&&e.x||[0,1],u=e&&e.y||[0,1],i=g.grid;if(i){var s=p("domain.column");s!==void 0&&(s<i.columns?f=i._domains.x[s]:delete m.domain.column);var o=p("domain.row");o!==void 0&&(o<i.rows?u=i._domains.y[o]:delete m.domain.row)}var a=p("domain.x",f),c=p("domain.y",u);a[0]<a[1]||(m.domain.x=f.slice()),c[0]<c[1]||(m.domain.y=u.slice())}},{"../lib/extend":777}],867:[function(h,N,H){N.exports=function(t){var m=t.editType,g=t.colorEditType;g===void 0&&(g=m);var p={family:{valType:"string",noBlank:!0,strict:!0,editType:m},size:{valType:"number",min:1,editType:m},color:{valType:"color",editType:g},editType:m};return t.arrayOk&&(p.family.arrayOk=!0,p.size.arrayOk=!0,p.color.arrayOk=!0),p}},{}],868:[function(h,N,H){N.exports={_isLinkedToArray:"frames_entry",group:{valType:"string"},name:{valType:"string"},traces:{valType:"any"},baseframe:{valType:"string"},data:{valType:"any"},layout:{valType:"any"}}},{}],869:[function(h,N,H){H.projNames={airy:"airy",aitoff:"aitoff","albers usa":"albersUsa",albers:"albers",august:"august","azimuthal equal area":"azimuthalEqualArea","azimuthal equidistant":"azimuthalEquidistant",baker:"baker",bertin1953:"bertin1953",boggs:"boggs",bonne:"bonne",bottomley:"bottomley",bromley:"bromley",collignon:"collignon","conic conformal":"conicConformal","conic equal area":"conicEqualArea","conic equidistant":"conicEquidistant",craig:"craig",craster:"craster","cylindrical equal area":"cylindricalEqualArea","cylindrical stereographic":"cylindricalStereographic",eckert1:"eckert1",eckert2:"eckert2",eckert3:"eckert3",eckert4:"eckert4",eckert5:"eckert5",eckert6:"eckert6",eisenlohr:"eisenlohr",equirectangular:"equirectangular",fahey:"fahey","foucaut sinusoidal":"foucautSinusoidal",foucaut:"foucaut",ginzburg4:"ginzburg4",ginzburg5:"ginzburg5",ginzburg6:"ginzburg6",ginzburg8:"ginzburg8",ginzburg9:"ginzburg9",gnomonic:"gnomonic","gringorten quincuncial":"gringortenQuincuncial",gringorten:"gringorten",guyou:"guyou",hammer:"hammer",hill:"hill",homolosine:"homolosine",hufnagel:"hufnagel",hyperelliptical:"hyperelliptical",kavrayskiy7:"kavrayskiy7",lagrange:"lagrange",larrivee:"larrivee",laskowski:"laskowski",loximuthal:"loximuthal",mercator:"mercator",miller:"miller",mollweide:"mollweide","mt flat polar parabolic":"mtFlatPolarParabolic","mt flat polar quartic":"mtFlatPolarQuartic","mt flat polar sinusoidal":"mtFlatPolarSinusoidal","natural earth":"naturalEarth","natural earth1":"naturalEarth1","natural earth2":"naturalEarth2","nell hammer":"nellHammer",nicolosi:"nicolosi",orthographic:"orthographic",patterson:"patterson","peirce quincuncial":"peirceQuincuncial",polyconic:"polyconic","rectangular polyconic":"rectangularPolyconic",robinson:"robinson",satellite:"satellite","sinu mollweide":"sinuMollweide",sinusoidal:"sinusoidal",stereographic:"stereographic",times:"times","transverse mercator":"transverseMercator","van der grinten":"vanDerGrinten","van der grinten2":"vanDerGrinten2","van der grinten3":"vanDerGrinten3","van der grinten4":"vanDerGrinten4",wagner4:"wagner4",wagner6:"wagner6",wiechel:"wiechel","winkel tripel":"winkel3",winkel3:"winkel3"},H.axesNames=["lonaxis","lataxis"],H.lonaxisSpan={orthographic:180,"azimuthal equal area":360,"azimuthal equidistant":360,"conic conformal":180,gnomonic:160,stereographic:180,"transverse mercator":180,"*":360},H.lataxisSpan={"conic conformal":150,stereographic:179.5,"*":180},H.scopeDefaults={world:{lonaxisRange:[-180,180],lataxisRange:[-90,90],projType:"equirectangular",projRotate:[0,0,0]},usa:{lonaxisRange:[-180,-50],lataxisRange:[15,80],projType:"albers usa"},europe:{lonaxisRange:[-30,60],lataxisRange:[30,85],projType:"conic conformal",projRotate:[15,0,0],projParallels:[0,60]},asia:{lonaxisRange:[22,160],lataxisRange:[-15,55],projType:"mercator",projRotate:[0,0,0]},africa:{lonaxisRange:[-30,60],lataxisRange:[-40,40],projType:"mercator",projRotate:[0,0,0]},"north america":{lonaxisRange:[-180,-45],lataxisRange:[5,85],projType:"conic conformal",projRotate:[-100,0,0],projParallels:[29.5,45.5]},"south america":{lonaxisRange:[-100,-30],lataxisRange:[-60,15],projType:"mercator",projRotate:[0,0,0]}},H.clipPad=.001,H.precision=.1,H.landColor="#F0DC82",H.waterColor="#3399FF",H.locationmodeToLayer={"ISO-3":"countries","USA-states":"subunits","country names":"countries"},H.sphereSVG={type:"Sphere"},H.fillLayers={ocean:1,land:1,lakes:1},H.lineLayers={subunits:1,countries:1,coastlines:1,rivers:1,frame:1},H.layers=["bg","ocean","land","lakes","subunits","countries","coastlines","rivers","lataxis","lonaxis","frame","backplot","frontplot"],H.layersForChoropleth=["bg","ocean","land","subunits","countries","coastlines","lataxis","lonaxis","frame","backplot","rivers","lakes","frontplot"],H.layerNameToAdjective={ocean:"ocean",land:"land",lakes:"lake",subunits:"subunit",countries:"country",coastlines:"coastline",rivers:"river",frame:"frame"}},{}],870:[function(h,N,H){var t=h("@plotly/d3"),m=h("d3-geo"),g=m.geoPath,p=m.geoDistance,e=h("d3-geo-projection"),f=h("../../registry"),u=h("../../lib"),i=u.strTranslate,s=h("../../components/color"),o=h("../../components/drawing"),a=h("../../components/fx"),c=h("../plots"),r=h("../cartesian/axes"),n=h("../cartesian/autorange").getAutoRange,d=h("../../components/dragelement"),l=h("../cartesian/select").prepSelect,y=h("../cartesian/select").clearSelect,v=h("../cartesian/select").selectOnClick,_=h("./zoom"),x=h("./constants"),T=h("../../lib/geo_location_utils"),A=h("../../lib/topojson_utils"),S=h("topojson-client").feature;function w(C){this.id=C.id,this.graphDiv=C.graphDiv,this.container=C.container,this.topojsonURL=C.topojsonURL,this.isStatic=C.staticPlot,this.topojsonName=null,this.topojson=null,this.projection=null,this.scope=null,this.viewInitial=null,this.fitScale=null,this.bounds=null,this.midPt=null,this.hasChoropleth=!1,this.traceHash={},this.layers={},this.basePaths={},this.dataPaths={},this.dataPoints={},this.clipDef=null,this.clipRect=null,this.bgRect=null,this.makeFramework()}var L=w.prototype;function k(C,M){var P=x.clipPad,O=C[0]+P,F=C[1]-P,j=M[0]+P,W=M[1]-P;O>0&&F<0&&(F+=360);var Z=(F-O)/4;return{type:"Polygon",coordinates:[[[O,j],[O,W],[O+Z,W],[O+2*Z,W],[O+3*Z,W],[F,W],[F,j],[F-Z,j],[F-2*Z,j],[F-3*Z,j],[O,j]]]}}N.exports=function(C){return new w(C)},L.plot=function(C,M,P){var O=this,F=M[this.id],j=[],W=!1;for(var Z in x.layerNameToAdjective)if(Z!=="frame"&&F["show"+Z]){W=!0;break}for(var Q=0;Q<C.length;Q++)if(C[0][0].trace.locationmode){W=!0;break}if(W){var X=A.getTopojsonName(F);O.topojson!==null&&X===O.topojsonName||(O.topojsonName=X,PlotlyGeoAssets.topojson[O.topojsonName]===void 0&&j.push(O.fetchTopojson()))}j=j.concat(T.fetchTraceGeoData(C)),P.push(new Promise(function(G,Y){Promise.all(j).then(function(){O.topojson=PlotlyGeoAssets.topojson[O.topojsonName],O.update(C,M),G()}).catch(Y)}))},L.fetchTopojson=function(){var C=this,M=A.getTopojsonPath(C.topojsonURL,C.topojsonName);return new Promise(function(P,O){t.json(M,function(F,j){if(F)return F.status===404?O(new Error(["plotly.js could not find topojson file at",M,".","Make sure the *topojsonURL* plot config option","is set properly."].join(" "))):O(new Error(["unexpected error while fetching topojson file at",M].join(" ")));PlotlyGeoAssets.topojson[C.topojsonName]=j,P()})})},L.update=function(C,M){var P=M[this.id];this.hasChoropleth=!1;for(var O=0;O<C.length;O++){var F=C[O],j=F[0].trace;j.type==="choropleth"&&(this.hasChoropleth=!0),j.visible===!0&&j._length>0&&j._module.calcGeoJSON(F,M)}if(!this.updateProjection(C,M)){this.viewInitial&&this.scope===P.scope||this.saveViewInitial(P),this.scope=P.scope,this.updateBaseLayers(M,P),this.updateDims(M,P),this.updateFx(M,P),c.generalUpdatePerTraceModule(this.graphDiv,this,C,P);var W=this.layers.frontplot.select(".scatterlayer");this.dataPoints.point=W.selectAll(".point"),this.dataPoints.text=W.selectAll("text"),this.dataPaths.line=W.selectAll(".js-line");var Z=this.layers.backplot.select(".choroplethlayer");this.dataPaths.choropleth=Z.selectAll("path"),this.render()}},L.updateProjection=function(C,M){var P=this.graphDiv,O=M[this.id],F=M._size,j=O.domain,W=O.projection,Z=O.lonaxis,Q=O.lataxis,X=Z._ax,G=Q._ax,Y=this.projection=function(ue){var me=ue.projection,we=me.type,Me=x.projNames[we];Me="geo"+u.titleCase(Me);for(var Se=(m[Me]||e[Me])(),De=ue._isSatellite?180*Math.acos(1/me.distance)/Math.PI:ue._isClipped?x.lonaxisSpan[we]/2:null,Fe=["center","rotate","parallels","clipExtent"],Ye=function(je){return je?Se:[]},et=0;et<Fe.length;et++){var Oe=Fe[et];typeof Se[Oe]!="function"&&(Se[Oe]=Ye)}return Se.isLonLatOverEdges=function(je){if(Se(je)===null)return!0;if(De){var We=Se.rotate();return p(je,[-We[0],-We[1]])>De*Math.PI/180}return!1},Se.getPath=function(){return g().projection(Se)},Se.getBounds=function(je){return Se.getPath().bounds(je)},Se.precision(x.precision),ue._isSatellite&&Se.tilt(me.tilt).distance(me.distance),De&&Se.clipAngle(De-x.clipPad),Se}(O),K=[[F.l+F.w*j.x[0],F.t+F.h*(1-j.y[1])],[F.l+F.w*j.x[1],F.t+F.h*(1-j.y[0])]],D=O.center||{},B=W.rotation||{},q=Z.range||[],ee=Q.range||[];if(O.fitbounds){X._length=K[1][0]-K[0][0],G._length=K[1][1]-K[0][1],X.range=n(P,X),G.range=n(P,G);var J=(X.range[0]+X.range[1])/2,$=(G.range[0]+G.range[1])/2;if(O._isScoped)D={lon:J,lat:$};else if(O._isClipped){D={lon:J,lat:$},B={lon:J,lat:$,roll:B.roll};var te=W.type,ie=x.lonaxisSpan[te]/2||180,ae=x.lataxisSpan[te]/2||90;q=[J-ie,J+ie],ee=[$-ae,$+ae]}else D={lon:J,lat:$},B={lon:J,lat:B.lat,roll:B.roll}}Y.center([D.lon-B.lon,D.lat-B.lat]).rotate([-B.lon,-B.lat,B.roll]).parallels(W.parallels);var he=k(q,ee);Y.fitExtent(K,he);var se=this.bounds=Y.getBounds(he),de=this.fitScale=Y.scale(),ce=Y.translate();if(O.fitbounds){var ve=Y.getBounds(k(X.range,G.range)),ke=Math.min((se[1][0]-se[0][0])/(ve[1][0]-ve[0][0]),(se[1][1]-se[0][1])/(ve[1][1]-ve[0][1]));isFinite(ke)?Y.scale(ke*de):u.warn("Something went wrong during"+this.id+"fitbounds computations.")}else Y.scale(W.scale*de);var Ee=this.midPt=[(se[0][0]+se[1][0])/2,(se[0][1]+se[1][1])/2];if(Y.translate([ce[0]+(Ee[0]-ce[0]),ce[1]+(Ee[1]-ce[1])]).clipExtent(se),O._isAlbersUsa){var be=Y([D.lon,D.lat]),xe=Y.translate();Y.translate([xe[0]-(be[0]-xe[0]),xe[1]-(be[1]-xe[1])])}},L.updateBaseLayers=function(C,M){var P=this,O=P.topojson,F=P.layers,j=P.basePaths;function W(Y){return Y==="lonaxis"||Y==="lataxis"}function Z(Y){return Boolean(x.lineLayers[Y])}function Q(Y){return Boolean(x.fillLayers[Y])}var X=(this.hasChoropleth?x.layersForChoropleth:x.layers).filter(function(Y){return Z(Y)||Q(Y)?M["show"+Y]:!W(Y)||M[Y].showgrid}),G=P.framework.selectAll(".layer").data(X,String);G.exit().each(function(Y){delete F[Y],delete j[Y],t.select(this).remove()}),G.enter().append("g").attr("class",function(Y){return"layer "+Y}).each(function(Y){var K=F[Y]=t.select(this);Y==="bg"?P.bgRect=K.append("rect").style("pointer-events","all"):W(Y)?j[Y]=K.append("path").style("fill","none"):Y==="backplot"?K.append("g").classed("choroplethlayer",!0):Y==="frontplot"?K.append("g").classed("scatterlayer",!0):Z(Y)?j[Y]=K.append("path").style("fill","none").style("stroke-miterlimit",2):Q(Y)&&(j[Y]=K.append("path").style("stroke","none"))}),G.order(),G.each(function(Y){var K=j[Y],D=x.layerNameToAdjective[Y];Y==="frame"?K.datum(x.sphereSVG):Z(Y)||Q(Y)?K.datum(S(O,O.objects[Y])):W(Y)&&K.datum(function(B,q,ee){var J,$,te,ie=q[B],ae=x.scopeDefaults[q.scope];B==="lonaxis"?(J=ae.lonaxisRange,$=ae.lataxisRange,te=function(xe,ue){return[xe,ue]}):B==="lataxis"&&(J=ae.lataxisRange,$=ae.lonaxisRange,te=function(xe,ue){return[ue,xe]});var he={type:"linear",range:[J[0],J[1]-1e-6],tick0:ie.tick0,dtick:ie.dtick};r.setConvert(he,ee);var se=r.calcTicks(he);q.isScoped||B!=="lonaxis"||se.pop();for(var de=se.length,ce=new Array(de),ve=0;ve<de;ve++)for(var ke=se[ve].x,Ee=ce[ve]=[],be=$[0];be<$[1]+2.5;be+=2.5)Ee.push(te(ke,be));return{type:"MultiLineString",coordinates:ce}}(Y,M,C)).call(s.stroke,M[Y].gridcolor).call(o.dashLine,"",M[Y].gridwidth),Z(Y)?K.call(s.stroke,M[D+"color"]).call(o.dashLine,"",M[D+"width"]):Q(Y)&&K.call(s.fill,M[D+"color"])})},L.updateDims=function(C,M){var P=this.bounds,O=(M.framewidth||0)/2,F=P[0][0]-O,j=P[0][1]-O,W=P[1][0]-F+O,Z=P[1][1]-j+O;o.setRect(this.clipRect,F,j,W,Z),this.bgRect.call(o.setRect,F,j,W,Z).call(s.fill,M.bgcolor),this.xaxis._offset=F,this.xaxis._length=W,this.yaxis._offset=j,this.yaxis._length=Z},L.updateFx=function(C,M){var P=this,O=P.graphDiv,F=P.bgRect,j=C.dragmode,W=C.clickmode;if(!P.isStatic){var Z;j==="select"?Z=function(G,Y){(G.range={})[P.id]=[X([Y.xmin,Y.ymin]),X([Y.xmax,Y.ymax])]}:j==="lasso"&&(Z=function(G,Y,K){(G.lassoPoints={})[P.id]=K.filtered.map(X)});var Q={element:P.bgRect.node(),gd:O,plotinfo:{id:P.id,xaxis:P.xaxis,yaxis:P.yaxis,fillRangeItems:Z},xaxes:[P.xaxis],yaxes:[P.yaxis],subplot:P.id,clickFn:function(G){G===2&&y(O)}};j==="pan"?(F.node().onmousedown=null,F.call(_(P,M)),F.on("dblclick.zoom",function(){var G=P.viewInitial,Y={};for(var K in G)Y[P.id+"."+K]=G[K];f.call("_guiRelayout",O,Y),O.emit("plotly_doubleclick",null)}),O._context._scrollZoom.geo||F.on("wheel.zoom",null)):j!=="select"&&j!=="lasso"||(F.on(".zoom",null),Q.prepFn=function(G,Y,K){l(G,Y,K,Q,j)},d.init(Q)),F.on("mousemove",function(){var G=P.projection.invert(u.getPositionFromD3Event());if(!G)return d.unhover(O,t.event);P.xaxis.p2c=function(){return G[0]},P.yaxis.p2c=function(){return G[1]},a.hover(O,t.event,P.id)}),F.on("mouseout",function(){O._dragging||d.unhover(O,t.event)}),F.on("click",function(){j!=="select"&&j!=="lasso"&&(W.indexOf("select")>-1&&v(t.event,O,[P.xaxis],[P.yaxis],P.id,Q),W.indexOf("event")>-1&&a.click(O,t.event))})}function X(G){return P.projection.invert([G[0]+P.xaxis._offset,G[1]+P.yaxis._offset])}},L.makeFramework=function(){var C=this,M=C.graphDiv,P=M._fullLayout,O="clip"+P._uid+C.id;C.clipDef=P._clips.append("clipPath").attr("id",O),C.clipRect=C.clipDef.append("rect"),C.framework=t.select(C.container).append("g").attr("class","geo "+C.id).call(o.setClipUrl,O,M),C.project=function(F){var j=C.projection(F);return j?[j[0]-C.xaxis._offset,j[1]-C.yaxis._offset]:[null,null]},C.xaxis={_id:"x",c2p:function(F){return C.project(F)[0]}},C.yaxis={_id:"y",c2p:function(F){return C.project(F)[1]}},C.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},r.setConvert(C.mockAxis,P)},L.saveViewInitial=function(C){var M,P=C.center||{},O=C.projection,F=O.rotation||{};this.viewInitial={fitbounds:C.fitbounds,"projection.scale":O.scale},M=C._isScoped?{"center.lon":P.lon,"center.lat":P.lat}:C._isClipped?{"projection.rotation.lon":F.lon,"projection.rotation.lat":F.lat}:{"center.lon":P.lon,"center.lat":P.lat,"projection.rotation.lon":F.lon},u.extendFlat(this.viewInitial,M)},L.render=function(){var C,M=this.projection,P=M.getPath();function O(j){var W=M(j.lonlat);return W?i(W[0],W[1]):null}function F(j){return M.isLonLatOverEdges(j.lonlat)?"none":null}for(C in this.basePaths)this.basePaths[C].attr("d",P);for(C in this.dataPaths)this.dataPaths[C].attr("d",function(j){return P(j.geojson)});for(C in this.dataPoints)this.dataPoints[C].attr("display",F).attr("transform",O)}},{"../../components/color":650,"../../components/dragelement":669,"../../components/drawing":672,"../../components/fx":690,"../../lib":787,"../../lib/geo_location_utils":780,"../../lib/topojson_utils":816,"../../registry":915,"../cartesian/autorange":837,"../cartesian/axes":838,"../cartesian/select":858,"../plots":901,"./constants":869,"./zoom":874,"@plotly/d3":58,"d3-geo":166,"d3-geo-projection":165,"topojson-client":586}],871:[function(h,N,H){var t=h("../../plots/get_data").getSubplotCalcData,m=h("../../lib").counterRegex,g=h("./geo"),p="geo",e=m(p),f={};f.geo={valType:"subplotid",dflt:p,editType:"calc"},N.exports={attr:p,name:p,idRoot:p,idRegex:e,attrRegex:e,attributes:f,layoutAttributes:h("./layout_attributes"),supplyLayoutDefaults:h("./layout_defaults"),plot:function(u){for(var i=u._fullLayout,s=u.calcdata,o=i._subplots.geo,a=0;a<o.length;a++){var c=o[a],r=t(s,p,c),n=i[c]._subplot;n||(n=g({id:c,graphDiv:u,container:i._geolayer.node(),topojsonURL:u._context.topojsonURL,staticPlot:u._context.staticPlot}),i[c]._subplot=n),n.plot(r,i,u._promises)}},updateFx:function(u){for(var i=u._fullLayout,s=i._subplots.geo,o=0;o<s.length;o++){var a=i[s[o]];a._subplot.updateFx(i,a)}},clean:function(u,i,s,o){for(var a=o._subplots.geo||[],c=0;c<a.length;c++){var r=a[c],n=o[r]._subplot;!i[r]&&n&&(n.framework.remove(),n.clipDef.remove())}}}},{"../../lib":787,"../../plots/get_data":875,"./geo":870,"./layout_attributes":872,"./layout_defaults":873}],872:[function(h,N,H){var t=h("../../components/color/attributes"),m=h("../domain").attributes,g=h("./constants"),p=h("../../plot_api/edit_types").overrideAll,e=h("../../lib/sort_object_keys"),f={range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},showgrid:{valType:"boolean",dflt:!1},tick0:{valType:"number",dflt:0},dtick:{valType:"number"},gridcolor:{valType:"color",dflt:t.lightLine},gridwidth:{valType:"number",min:0,dflt:1}};(N.exports=p({domain:m({name:"geo"},{}),fitbounds:{valType:"enumerated",values:[!1,"locations","geojson"],dflt:!1,editType:"plot"},resolution:{valType:"enumerated",values:[110,50],dflt:110,coerceNumber:!0},scope:{valType:"enumerated",values:e(g.scopeDefaults),dflt:"world"},projection:{type:{valType:"enumerated",values:e(g.projNames)},rotation:{lon:{valType:"number"},lat:{valType:"number"},roll:{valType:"number"}},tilt:{valType:"number",dflt:0},distance:{valType:"number",min:1.001,dflt:2},parallels:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},scale:{valType:"number",min:0,dflt:1}},center:{lon:{valType:"number"},lat:{valType:"number"}},visible:{valType:"boolean",dflt:!0},showcoastlines:{valType:"boolean"},coastlinecolor:{valType:"color",dflt:t.defaultLine},coastlinewidth:{valType:"number",min:0,dflt:1},showland:{valType:"boolean",dflt:!1},landcolor:{valType:"color",dflt:g.landColor},showocean:{valType:"boolean",dflt:!1},oceancolor:{valType:"color",dflt:g.waterColor},showlakes:{valType:"boolean",dflt:!1},lakecolor:{valType:"color",dflt:g.waterColor},showrivers:{valType:"boolean",dflt:!1},rivercolor:{valType:"color",dflt:g.waterColor},riverwidth:{valType:"number",min:0,dflt:1},showcountries:{valType:"boolean"},countrycolor:{valType:"color",dflt:t.defaultLine},countrywidth:{valType:"number",min:0,dflt:1},showsubunits:{valType:"boolean"},subunitcolor:{valType:"color",dflt:t.defaultLine},subunitwidth:{valType:"number",min:0,dflt:1},showframe:{valType:"boolean"},framecolor:{valType:"color",dflt:t.defaultLine},framewidth:{valType:"number",min:0,dflt:1},bgcolor:{valType:"color",dflt:t.background},lonaxis:f,lataxis:f},"plot","from-root")).uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":649,"../../lib/sort_object_keys":810,"../../plot_api/edit_types":820,"../domain":866,"./constants":869}],873:[function(h,N,H){var t=h("../../lib"),m=h("../subplot_defaults"),g=h("../get_data").getSubplotData,p=h("./constants"),e=h("./layout_attributes"),f=p.axesNames;function u(i,s,o,a){var c=g(a.fullData,"geo",a.id).map(function(B){return B._expandedIndex}),r=o("resolution"),n=o("scope"),d=p.scopeDefaults[n],l=o("projection.type",d.projType),y=s._isAlbersUsa=l==="albers usa";y&&(n=s.scope="usa");var v=s._isScoped=n!=="world",_=s._isSatellite=l==="satellite",x=s._isConic=l.indexOf("conic")!==-1||l==="albers",T=s._isClipped=!!p.lonaxisSpan[l];if(i.visible===!1){var A=t.extendDeep({},s._template);A.showcoastlines=!1,A.showcountries=!1,A.showframe=!1,A.showlakes=!1,A.showland=!1,A.showocean=!1,A.showrivers=!1,A.showsubunits=!1,A.lonaxis&&(A.lonaxis.showgrid=!1),A.lataxis&&(A.lataxis.showgrid=!1),s._template=A}for(var S=o("visible"),w=0;w<f.length;w++){var L,k=f[w],C=[30,10][w];if(v)L=d[k+"Range"];else{var M=p[k+"Span"],P=(M[l]||M["*"])/2,O=o("projection.rotation."+k.substr(0,3),d.projRotate[w]);L=[O-P,O+P]}var F=o(k+".range",L);o(k+".tick0"),o(k+".dtick",C),o(k+".showgrid",!!S&&void 0)&&(o(k+".gridcolor"),o(k+".gridwidth")),s[k]._ax={type:"linear",_id:k.slice(0,3),_traceIndices:c,setScale:t.identity,c2l:t.identity,r2l:t.identity,autorange:!0,range:F.slice(),_m:1,_input:{}}}var j=s.lonaxis.range,W=s.lataxis.range,Z=j[0],Q=j[1];Z>0&&Q<0&&(Q+=360);var X,G,Y,K=(Z+Q)/2;if(!y){var D=v?d.projRotate:[K,0,0];X=o("projection.rotation.lon",D[0]),o("projection.rotation.lat",D[1]),o("projection.rotation.roll",D[2]),o("showcoastlines",!v&&S)&&(o("coastlinecolor"),o("coastlinewidth")),o("showocean",!!S&&void 0)&&o("oceancolor")}y?(G=-96.6,Y=38.7):(G=v?K:X,Y=(W[0]+W[1])/2),o("center.lon",G),o("center.lat",Y),_&&(o("projection.tilt"),o("projection.distance")),x&&o("projection.parallels",d.projParallels||[0,60]),o("projection.scale"),o("showland",!!S&&void 0)&&o("landcolor"),o("showlakes",!!S&&void 0)&&o("lakecolor"),o("showrivers",!!S&&void 0)&&(o("rivercolor"),o("riverwidth")),o("showcountries",v&&n!=="usa"&&S)&&(o("countrycolor"),o("countrywidth")),(n==="usa"||n==="north america"&&r===50)&&(o("showsubunits",S),o("subunitcolor"),o("subunitwidth")),v||o("showframe",S)&&(o("framecolor"),o("framewidth")),o("bgcolor"),o("fitbounds")&&(delete s.projection.scale,v?(delete s.center.lon,delete s.center.lat):T?(delete s.center.lon,delete s.center.lat,delete s.projection.rotation.lon,delete s.projection.rotation.lat,delete s.lonaxis.range,delete s.lataxis.range):(delete s.center.lon,delete s.center.lat,delete s.projection.rotation.lon))}N.exports=function(i,s,o){m(i,s,o,{type:"geo",attributes:e,handleDefaults:u,fullData:o,partition:"y"})}},{"../../lib":787,"../get_data":875,"../subplot_defaults":909,"./constants":869,"./layout_attributes":872}],874:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../lib"),g=h("../../registry"),p=Math.PI/180,e=180/Math.PI,f={cursor:"pointer"},u={cursor:"auto"};function i(S,w){return t.behavior.zoom().translate(w.translate()).scale(w.scale())}function s(S,w,L){var k=S.id,C=S.graphDiv,M=C.layout,P=M[k],O=C._fullLayout,F=O[k],j={},W={};function Z(Q,X){j[k+"."+Q]=m.nestedProperty(P,Q).get(),g.call("_storeDirectGUIEdit",M,O._preGUI,j);var G=m.nestedProperty(F,Q);G.get()!==X&&(G.set(X),m.nestedProperty(P,Q).set(X),W[k+"."+Q]=X)}L(Z),Z("projection.scale",w.scale()/S.fitScale),Z("fitbounds",!1),C.emit("plotly_relayout",W)}function o(S,w){var L=i(0,w);function k(C){var M=w.invert(S.midPt);C("center.lon",M[0]),C("center.lat",M[1])}return L.on("zoomstart",function(){t.select(this).style(f)}).on("zoom",function(){w.scale(t.event.scale).translate(t.event.translate),S.render();var C=w.invert(S.midPt);S.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":w.scale()/S.fitScale,"geo.center.lon":C[0],"geo.center.lat":C[1]})}).on("zoomend",function(){t.select(this).style(u),s(S,w,k)}),L}function a(S,w){var L,k,C,M,P,O,F,j,W,Z=i(0,w);function Q(G){return w.invert(G)}function X(G){var Y=w.rotate(),K=w.invert(S.midPt);G("projection.rotation.lon",-Y[0]),G("center.lon",K[0]),G("center.lat",K[1])}return Z.on("zoomstart",function(){t.select(this).style(f),L=t.mouse(this),k=w.rotate(),C=w.translate(),M=k,P=Q(L)}).on("zoom",function(){if(O=t.mouse(this),function(K){var D=Q(K);if(!D)return!0;var B=w(D);return Math.abs(B[0]-K[0])>2||Math.abs(B[1]-K[1])>2}(L))return Z.scale(w.scale()),void Z.translate(w.translate());w.scale(t.event.scale),w.translate([C[0],t.event.translate[1]]),P?Q(O)&&(j=Q(O),F=[M[0]+(j[0]-P[0]),k[1],k[2]],w.rotate(F),M=F):P=Q(L=O),W=!0,S.render();var G=w.rotate(),Y=w.invert(S.midPt);S.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":w.scale()/S.fitScale,"geo.center.lon":Y[0],"geo.center.lat":Y[1],"geo.projection.rotation.lon":-G[0]})}).on("zoomend",function(){t.select(this).style(u),W&&s(S,w,X)}),Z}function c(S,w){var L,k={r:w.rotate(),k:w.scale()},C=i(0,w),M=function(Q){for(var X=0,G=arguments.length,Y=[];++X<G;)Y.push(arguments[X]);var K=t.dispatch.apply(null,Y);return K.of=function(D,B){return function(q){var ee;try{ee=q.sourceEvent=t.event,q.target=Q,t.event=q,K[q.type].apply(D,B)}finally{t.event=ee}}},K}(C,"zoomstart","zoom","zoomend"),P=0,O=C.on;function F(Q){P++||Q({type:"zoomstart"})}function j(Q){Q({type:"zoom"})}function W(Q){--P||Q({type:"zoomend"})}function Z(Q){var X=w.rotate();Q("projection.rotation.lon",-X[0]),Q("projection.rotation.lat",-X[1])}return C.on("zoomstart",function(){t.select(this).style(f);var Q=t.mouse(this),X=w.rotate(),G=X,Y=w.translate(),K=n(X);L=r(w,Q),O.call(C,"zoom",function(){var D=t.mouse(this);if(w.scale(k.k=t.event.scale),L){if(r(w,D)){w.rotate(X).translate(Y);var B=r(w,D),q=l(L,B),ee=T(d(K,q)),J=k.r=y(ee,L,G);isFinite(J[0])&&isFinite(J[1])&&isFinite(J[2])||(J=G),w.rotate(J),G=J}}else L=r(w,Q=D);j(M.of(this,arguments))}),F(M.of(this,arguments))}).on("zoomend",function(){t.select(this).style(u),O.call(C,"zoom",null),W(M.of(this,arguments)),s(S,w,Z)}).on("zoom.redraw",function(){S.render();var Q=w.rotate();S.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":w.scale()/S.fitScale,"geo.projection.rotation.lon":-Q[0],"geo.projection.rotation.lat":-Q[1]})}),t.rebind(C,M,"on")}function r(S,w){var L=S.invert(w);return L&&isFinite(L[0])&&isFinite(L[1])&&function(k){var C=k[0]*p,M=k[1]*p,P=Math.cos(M);return[P*Math.cos(C),P*Math.sin(C),Math.sin(M)]}(L)}function n(S){var w=.5*S[0]*p,L=.5*S[1]*p,k=.5*S[2]*p,C=Math.sin(w),M=Math.cos(w),P=Math.sin(L),O=Math.cos(L),F=Math.sin(k),j=Math.cos(k);return[M*O*j+C*P*F,C*O*j-M*P*F,M*P*j+C*O*F,M*O*F-C*P*j]}function d(S,w){var L=S[0],k=S[1],C=S[2],M=S[3],P=w[0],O=w[1],F=w[2],j=w[3];return[L*P-k*O-C*F-M*j,L*O+k*P+C*j-M*F,L*F-k*j+C*P+M*O,L*j+k*F-C*O+M*P]}function l(S,w){if(S&&w){var L=function(P,O){return[P[1]*O[2]-P[2]*O[1],P[2]*O[0]-P[0]*O[2],P[0]*O[1]-P[1]*O[0]]}(S,w),k=Math.sqrt(A(L,L)),C=.5*Math.acos(Math.max(-1,Math.min(1,A(S,w)))),M=Math.sin(C)/k;return k&&[Math.cos(C),L[2]*M,-L[1]*M,L[0]*M]}}function y(S,w,L){var k=x(w,2,S[0]);k=x(k,1,S[1]),k=x(k,0,S[2]-L[2]);var C,M,P=w[0],O=w[1],F=w[2],j=k[0],W=k[1],Z=k[2],Q=Math.atan2(O,P)*e,X=Math.sqrt(P*P+O*O);Math.abs(W)>X?(M=(W>0?90:-90)-Q,C=0):(M=Math.asin(W/X)*e-Q,C=Math.sqrt(X*X-W*W));var G=180-M-2*Q,Y=(Math.atan2(Z,j)-Math.atan2(F,C))*e,K=(Math.atan2(Z,j)-Math.atan2(F,-C))*e;return v(L[0],L[1],M,Y)<=v(L[0],L[1],G,K)?[M,Y,L[2]]:[G,K,L[2]]}function v(S,w,L,k){var C=_(L-S),M=_(k-w);return Math.sqrt(C*C+M*M)}function _(S){return(S%360+540)%360-180}function x(S,w,L){var k=L*p,C=S.slice(),M=w===0?1:0,P=w===2?1:2,O=Math.cos(k),F=Math.sin(k);return C[M]=S[M]*O-S[P]*F,C[P]=S[P]*O+S[M]*F,C}function T(S){return[Math.atan2(2*(S[0]*S[1]+S[2]*S[3]),1-2*(S[1]*S[1]+S[2]*S[2]))*e,Math.asin(Math.max(-1,Math.min(1,2*(S[0]*S[2]-S[3]*S[1]))))*e,Math.atan2(2*(S[0]*S[3]+S[1]*S[2]),1-2*(S[2]*S[2]+S[3]*S[3]))*e]}function A(S,w){for(var L=0,k=0,C=S.length;k<C;++k)L+=S[k]*w[k];return L}N.exports=function(S,w){var L=S.projection;return(w._isScoped?o:w._isClipped?c:a)(S,L)}},{"../../lib":787,"../../registry":915,"@plotly/d3":58}],875:[function(h,N,H){var t=h("../registry"),m=h("./cartesian/constants").SUBPLOT_PATTERN;H.getSubplotCalcData=function(g,p,e){var f=t.subplotsRegistry[p];if(!f)return[];for(var u=f.attr,i=[],s=0;s<g.length;s++){var o=g[s];o[0].trace[u]===e&&i.push(o)}return i},H.getModuleCalcData=function(g,p){var e,f=[],u=[];if(!(e=typeof p=="string"?t.getModule(p).plot:typeof p=="function"?p:p.plot))return[f,g];for(var i=0;i<g.length;i++){var s=g[i],o=s[0].trace;o.visible===!0&&o._length!==0&&(o._module.plot===e?f.push(s):u.push(s))}return[f,u]},H.getSubplotData=function(g,p,e){if(!t.subplotsRegistry[p])return[];var f,u,i,s=t.subplotsRegistry[p].attr,o=[];if(p==="gl2d"){var a=e.match(m);u="x"+a[1],i="y"+a[2]}for(var c=0;c<g.length;c++)f=g[c],p==="gl2d"&&t.traceIs(f,"gl2d")?f[s[0]]===u&&f[s[1]]===i&&o.push(f):f[s]===e&&o.push(f);return o}},{"../registry":915,"./cartesian/constants":845}],876:[function(h,N,H){var t=h("mouse-change"),m=h("mouse-wheel"),g=h("mouse-event-offset"),p=h("../cartesian/constants"),e=h("has-passive-events");function f(u,i){this.element=u,this.plot=i,this.mouseListener=null,this.wheelListener=null,this.lastInputTime=Date.now(),this.lastPos=[0,0],this.boxEnabled=!1,this.boxInited=!1,this.boxStart=[0,0],this.boxEnd=[0,0],this.dragStart=[0,0]}N.exports=function(u){var i=u.mouseContainer,s=u.glplot,o=new f(i,s);function a(){u.xaxis.autorange=!1,u.yaxis.autorange=!1}function c(r,n,d){var l,y,v=u.calcDataBox(),_=s.viewBox,x=o.lastPos[0],T=o.lastPos[1],A=p.MINDRAG*s.pixelRatio,S=p.MINZOOM*s.pixelRatio;function w(O,F,j){var W=Math.min(F,j),Z=Math.max(F,j);W!==Z?(v[O]=W,v[O+2]=Z,o.dataBox=v,u.setRanges(v)):(u.selectBox.selectBox=[0,0,1,1],u.glplot.setDirty())}switch(n*=s.pixelRatio,d*=s.pixelRatio,d=_[3]-_[1]-d,u.fullLayout.dragmode){case"zoom":if(r){var L=n/(_[2]-_[0])*(v[2]-v[0])+v[0],k=d/(_[3]-_[1])*(v[3]-v[1])+v[1];o.boxInited||(o.boxStart[0]=L,o.boxStart[1]=k,o.dragStart[0]=n,o.dragStart[1]=d),o.boxEnd[0]=L,o.boxEnd[1]=k,o.boxInited=!0,o.boxEnabled||o.boxStart[0]===o.boxEnd[0]&&o.boxStart[1]===o.boxEnd[1]||(o.boxEnabled=!0);var C=Math.abs(o.dragStart[0]-n)<S,M=Math.abs(o.dragStart[1]-d)<S;if(!function(){for(var O=u.graphDiv._fullLayout._axisConstraintGroups,F=u.xaxis._id,j=u.yaxis._id,W=0;W<O.length;W++)if(O[W][F]!==-1){if(O[W][j]!==-1)return!0;break}return!1}()||C&&M)C&&(o.boxEnd[0]=o.boxStart[0]),M&&(o.boxEnd[1]=o.boxStart[1]);else{l=o.boxEnd[0]-o.boxStart[0],y=o.boxEnd[1]-o.boxStart[1];var P=(v[3]-v[1])/(v[2]-v[0]);Math.abs(l*P)>Math.abs(y)?(o.boxEnd[1]=o.boxStart[1]+Math.abs(l)*P*(y>=0?1:-1),o.boxEnd[1]<v[1]?(o.boxEnd[1]=v[1],o.boxEnd[0]=o.boxStart[0]+(v[1]-o.boxStart[1])/Math.abs(P)):o.boxEnd[1]>v[3]&&(o.boxEnd[1]=v[3],o.boxEnd[0]=o.boxStart[0]+(v[3]-o.boxStart[1])/Math.abs(P))):(o.boxEnd[0]=o.boxStart[0]+Math.abs(y)/P*(l>=0?1:-1),o.boxEnd[0]<v[0]?(o.boxEnd[0]=v[0],o.boxEnd[1]=o.boxStart[1]+(v[0]-o.boxStart[0])*Math.abs(P)):o.boxEnd[0]>v[2]&&(o.boxEnd[0]=v[2],o.boxEnd[1]=o.boxStart[1]+(v[2]-o.boxStart[0])*Math.abs(P)))}}else o.boxEnabled?(l=o.boxStart[0]!==o.boxEnd[0],y=o.boxStart[1]!==o.boxEnd[1],l||y?(l&&(w(0,o.boxStart[0],o.boxEnd[0]),u.xaxis.autorange=!1),y&&(w(1,o.boxStart[1],o.boxEnd[1]),u.yaxis.autorange=!1),u.relayoutCallback()):u.glplot.setDirty(),o.boxEnabled=!1,o.boxInited=!1):o.boxInited&&(o.boxInited=!1);break;case"pan":o.boxEnabled=!1,o.boxInited=!1,r?(o.panning||(o.dragStart[0]=n,o.dragStart[1]=d),Math.abs(o.dragStart[0]-n)<A&&(n=o.dragStart[0]),Math.abs(o.dragStart[1]-d)<A&&(d=o.dragStart[1]),l=(x-n)*(v[2]-v[0])/(s.viewBox[2]-s.viewBox[0]),y=(T-d)*(v[3]-v[1])/(s.viewBox[3]-s.viewBox[1]),v[0]+=l,v[2]+=l,v[1]+=y,v[3]+=y,u.setRanges(v),o.panning=!0,o.lastInputTime=Date.now(),a(),u.cameraChanged(),u.handleAnnotations()):o.panning&&(o.panning=!1,u.relayoutCallback())}o.lastPos[0]=n,o.lastPos[1]=d}return o.mouseListener=t(i,c),i.addEventListener("touchstart",function(r){var n=g(r.changedTouches[0],i);c(0,n[0],n[1]),c(1,n[0],n[1]),r.preventDefault()},!!e&&{passive:!1}),i.addEventListener("touchmove",function(r){r.preventDefault();var n=g(r.changedTouches[0],i);c(1,n[0],n[1]),r.preventDefault()},!!e&&{passive:!1}),i.addEventListener("touchend",function(r){c(0,o.lastPos[0],o.lastPos[1]),r.preventDefault()},!!e&&{passive:!1}),o.wheelListener=m(i,function(r,n){if(!u.scrollZoom)return!1;var d=u.calcDataBox(),l=s.viewBox,y=o.lastPos[0],v=o.lastPos[1],_=Math.exp(5*n/(l[3]-l[1])),x=y/(l[2]-l[0])*(d[2]-d[0])+d[0],T=v/(l[3]-l[1])*(d[3]-d[1])+d[1];return d[0]=(d[0]-x)*_+x,d[2]=(d[2]-x)*_+x,d[1]=(d[1]-T)*_+T,d[3]=(d[3]-T)*_+T,u.setRanges(d),o.lastInputTime=Date.now(),a(),u.cameraChanged(),u.handleAnnotations(),u.relayoutCallback(),!0},!0),o}},{"../cartesian/constants":845,"has-passive-events":436,"mouse-change":459,"mouse-event-offset":460,"mouse-wheel":462}],877:[function(h,N,H){var t=h("../cartesian/axes"),m=h("../../lib/str2rgbarray");function g(f){this.scene=f,this.gl=f.gl,this.pixelRatio=f.pixelRatio,this.screenBox=[0,0,1,1],this.viewBox=[0,0,1,1],this.dataBox=[-1,-1,1,1],this.borderLineEnable=[!1,!1,!1,!1],this.borderLineWidth=[1,1,1,1],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.ticks=[[],[]],this.tickEnable=[!0,!0,!1,!1],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labels=["x","y"],this.labelEnable=[!0,!0,!1,!1],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelPad=[15,15,15,15],this.labelSize=[12,12],this.labelFont=["sans-serif","sans-serif"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.title="",this.titleEnable=!0,this.titleCenter=[0,0,0,0],this.titleAngle=0,this.titleColor=[0,0,0,1],this.titleFont="sans-serif",this.titleSize=18,this.gridLineEnable=[!0,!0],this.gridLineColor=[[0,0,0,.5],[0,0,0,.5]],this.gridLineWidth=[1,1],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[1,1],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.static=this.scene.staticPlot}var p=g.prototype,e=["xaxis","yaxis"];p.merge=function(f){var u,i,s,o,a,c,r,n,d,l,y;for(this.titleEnable=!1,this.backgroundColor=m(f.plot_bgcolor),l=0;l<2;++l){var v=(u=e[l]).charAt(0);for(s=(i=f[this.scene[u]._name]).title.text===this.scene.fullLayout._dfltTitle[v]?"":i.title.text,y=0;y<=2;y+=2)this.labelEnable[l+y]=!1,this.labels[l+y]=s,this.labelColor[l+y]=m(i.title.font.color),this.labelFont[l+y]=i.title.font.family,this.labelSize[l+y]=i.title.font.size,this.labelPad[l+y]=this.getLabelPad(u,i),this.tickEnable[l+y]=!1,this.tickColor[l+y]=m((i.tickfont||{}).color),this.tickAngle[l+y]=i.tickangle==="auto"?0:Math.PI*-i.tickangle/180,this.tickPad[l+y]=this.getTickPad(i),this.tickMarkLength[l+y]=0,this.tickMarkWidth[l+y]=i.tickwidth||0,this.tickMarkColor[l+y]=m(i.tickcolor),this.borderLineEnable[l+y]=!1,this.borderLineColor[l+y]=m(i.linecolor),this.borderLineWidth[l+y]=i.linewidth||0;r=this.hasSharedAxis(i),a=this.hasAxisInDfltPos(u,i)&&!r,c=this.hasAxisInAltrPos(u,i)&&!r,o=i.mirror||!1,n=r?String(o).indexOf("all")!==-1:!!o,d=r?o==="allticks":String(o).indexOf("ticks")!==-1,a?this.labelEnable[l]=!0:c&&(this.labelEnable[l+2]=!0),a?this.tickEnable[l]=i.showticklabels:c&&(this.tickEnable[l+2]=i.showticklabels),(a||n)&&(this.borderLineEnable[l]=i.showline),(c||n)&&(this.borderLineEnable[l+2]=i.showline),(a||d)&&(this.tickMarkLength[l]=this.getTickMarkLength(i)),(c||d)&&(this.tickMarkLength[l+2]=this.getTickMarkLength(i)),this.gridLineEnable[l]=i.showgrid,this.gridLineColor[l]=m(i.gridcolor),this.gridLineWidth[l]=i.gridwidth,this.zeroLineEnable[l]=i.zeroline,this.zeroLineColor[l]=m(i.zerolinecolor),this.zeroLineWidth[l]=i.zerolinewidth}},p.hasSharedAxis=function(f){var u=this.scene,i=u.fullLayout._subplots.gl2d;return t.findSubplotsWithAxis(i,f).indexOf(u.id)!==0},p.hasAxisInDfltPos=function(f,u){var i=u.side;return f==="xaxis"?i==="bottom":f==="yaxis"?i==="left":void 0},p.hasAxisInAltrPos=function(f,u){var i=u.side;return f==="xaxis"?i==="top":f==="yaxis"?i==="right":void 0},p.getLabelPad=function(f,u){var i=u.title.font.size,s=u.showticklabels;return f==="xaxis"?u.side==="top"?i*(1.5+(s?1:0))-10:i*(1.5+(s?.5:0))-10:f==="yaxis"?u.side==="right"?10+i*(1.5+(s?1:.5)):10+i*(1.5+(s?.5:0)):void 0},p.getTickPad=function(f){return f.ticks==="outside"?10+f.ticklen:15},p.getTickMarkLength=function(f){if(!f.ticks)return 0;var u=f.ticklen;return f.ticks==="inside"?-u:u},N.exports=function(f){return new g(f)}},{"../../lib/str2rgbarray":812,"../cartesian/axes":838}],878:[function(h,N,H){var t=h("../../plot_api/edit_types").overrideAll,m=h("./scene2d"),g=h("../layout_attributes"),p=h("../../constants/xmlns_namespaces"),e=h("../cartesian/constants"),f=h("../cartesian"),u=h("../../components/fx/layout_attributes"),i=h("../get_data").getSubplotData;H.name="gl2d",H.attr=["xaxis","yaxis"],H.idRoot=["x","y"],H.idRegex=e.idRegex,H.attrRegex=e.attrRegex,H.attributes=h("../cartesian/attributes"),H.supplyLayoutDefaults=function(s,o,a){o._has("cartesian")||f.supplyLayoutDefaults(s,o,a)},H.layoutAttrOverrides=t(f.layoutAttributes,"plot","from-root"),H.baseLayoutAttrOverrides=t({plot_bgcolor:g.plot_bgcolor,hoverlabel:u.hoverlabel},"plot","nested"),H.plot=function(s){for(var o=s._fullLayout,a=s._fullData,c=o._subplots.gl2d,r=0;r<c.length;r++){var n=c[r],d=o._plots[n],l=i(a,"gl2d",n),y=d._scene2d;y===void 0&&(y=new m({id:n,graphDiv:s,container:s.querySelector(".gl-container"),staticPlot:s._context.staticPlot,plotGlPixelRatio:s._context.plotGlPixelRatio},o),d._scene2d=y),y.plot(l,s.calcdata,o,s.layout)}},H.clean=function(s,o,a,c){for(var r=c._subplots.gl2d||[],n=0;n<r.length;n++){var d=r[n],l=c._plots[d];if(l._scene2d){var y=i(s,"gl2d",d);y.length===0&&(l._scene2d.destroy(),delete c._plots[d])}}f.clean.apply(this,arguments)},H.drawFramework=function(s){s._context.staticPlot||f.drawFramework(s)},H.toSVG=function(s){for(var o=s._fullLayout,a=o._subplots.gl2d,c=0;c<a.length;c++){var r=o._plots[a[c]]._scene2d,n=r.toImage("png");o._glimages.append("svg:image").attr({xmlns:p.svg,"xlink:href":n,x:0,y:0,width:"100%",height:"100%",preserveAspectRatio:"none"}),r.destroy()}},H.updateFx=function(s){for(var o=s._fullLayout,a=o._subplots.gl2d,c=0;c<a.length;c++)o._plots[a[c]]._scene2d.updateFx(o.dragmode)}},{"../../components/fx/layout_attributes":691,"../../constants/xmlns_namespaces":764,"../../plot_api/edit_types":820,"../cartesian":852,"../cartesian/attributes":836,"../cartesian/constants":845,"../get_data":875,"../layout_attributes":892,"./scene2d":879}],879:[function(h,N,H){var t,m,g=h("../../registry"),p=h("../../plots/cartesian/axes"),e=h("../../components/fx"),f=h("gl-plot2d"),u=h("gl-spikes2d"),i=h("gl-select-box"),s=h("webgl-context"),o=h("./convert"),a=h("./camera"),c=h("../../lib/show_no_webgl_msg"),r=h("../cartesian/constraints"),n=r.enforce,d=r.clean,l=h("../cartesian/autorange").doAutoRange,y=h("../../components/dragelement/helpers"),v=y.drawMode,_=y.selectMode,x=["xaxis","yaxis"],T=h("../cartesian/constants").SUBPLOT_PATTERN;function A(w,L){this.container=w.container,this.graphDiv=w.graphDiv,this.pixelRatio=w.plotGlPixelRatio||window.devicePixelRatio,this.id=w.id,this.staticPlot=!!w.staticPlot,this.scrollZoom=this.graphDiv._context._scrollZoom.cartesian,this.fullData=null,this.updateRefs(L),this.makeFramework(),this.stopped||(this.glplotOptions=o(this),this.glplotOptions.merge(L),this.glplot=f(this.glplotOptions),this.camera=a(this),this.traces={},this.spikes=u(this.glplot),this.selectBox=i(this.glplot,{innerFill:!1,outerFill:!0}),this.lastButtonState=0,this.pickResult=null,this.isMouseOver=!0,this.stopped=!1,this.redraw=this.draw.bind(this),this.redraw())}N.exports=A;var S=A.prototype;S.makeFramework=function(){if(this.staticPlot){if(!(m||(t=document.createElement("canvas"),m=s({canvas:t,preserveDrawingBuffer:!1,premultipliedAlpha:!0,antialias:!0}))))throw new Error("Error creating static canvas/context for image server");this.canvas=t,this.gl=m}else{var w=this.container.querySelector(".gl-canvas-focus"),L=s({canvas:w,preserveDrawingBuffer:!0,premultipliedAlpha:!0});if(!L)return c(this),void(this.stopped=!0);this.canvas=w,this.gl=L}var k=this.canvas;k.style.width="100%",k.style.height="100%",k.style.position="absolute",k.style.top="0px",k.style.left="0px",k.style["pointer-events"]="none",this.updateSize(k);var C=this.svgContainer=document.createElementNS("http://www.w3.org/2000/svg","svg");C.style.position="absolute",C.style.top=C.style.left="0px",C.style.width=C.style.height="100%",C.style["z-index"]=20,C.style["pointer-events"]="none";var M=this.mouseContainer=document.createElement("div");M.style.position="absolute",M.style["pointer-events"]="auto",this.pickCanvas=this.container.querySelector(".gl-canvas-pick");var P=this.container;P.appendChild(C),P.appendChild(M);var O=this;M.addEventListener("mouseout",function(){O.isMouseOver=!1,O.unhover()}),M.addEventListener("mouseover",function(){O.isMouseOver=!0})},S.toImage=function(w){w||(w="png"),this.stopped=!0,this.staticPlot&&this.container.appendChild(t),this.updateSize(this.canvas);var L=this.glplot.gl,k=L.drawingBufferWidth,C=L.drawingBufferHeight;L.clearColor(1,1,1,0),L.clear(L.COLOR_BUFFER_BIT|L.DEPTH_BUFFER_BIT),this.glplot.setDirty(),this.glplot.draw(),L.bindFramebuffer(L.FRAMEBUFFER,null);var M=new Uint8Array(k*C*4);L.readPixels(0,0,k,C,L.RGBA,L.UNSIGNED_BYTE,M);for(var P=0,O=C-1;P<O;++P,--O)for(var F=0;F<k;++F)for(var j=0;j<4;++j){var W=M[4*(k*P+F)+j];M[4*(k*P+F)+j]=M[4*(k*O+F)+j],M[4*(k*O+F)+j]=W}var Z=document.createElement("canvas");Z.width=k,Z.height=C;var Q,X=Z.getContext("2d"),G=X.createImageData(k,C);switch(G.data.set(M),X.putImageData(G,0,0),w){case"jpeg":Q=Z.toDataURL("image/jpeg");break;case"webp":Q=Z.toDataURL("image/webp");break;default:Q=Z.toDataURL("image/png")}return this.staticPlot&&this.container.removeChild(t),Q},S.updateSize=function(w){w||(w=this.canvas);var L=this.pixelRatio,k=this.fullLayout,C=k.width,M=k.height,P=0|Math.ceil(L*C),O=0|Math.ceil(L*M);return w.width===P&&w.height===O||(w.width=P,w.height=O),w},S.computeTickMarks=function(){this.xaxis.setScale(),this.yaxis.setScale();for(var w=[p.calcTicks(this.xaxis),p.calcTicks(this.yaxis)],L=0;L<2;++L)for(var k=0;k<w[L].length;++k)w[L][k].text=w[L][k].text+"";return w},S.updateRefs=function(w){this.fullLayout=w;var L=this.id.match(T),k="xaxis"+L[1],C="yaxis"+L[2];this.xaxis=this.fullLayout[k],this.yaxis=this.fullLayout[C]},S.relayoutCallback=function(){var w=this.graphDiv,L=this.xaxis,k=this.yaxis,C=w.layout,M={},P=M[L._name+".range"]=L.range.slice(),O=M[k._name+".range"]=k.range.slice();M[L._name+".autorange"]=L.autorange,M[k._name+".autorange"]=k.autorange,g.call("_storeDirectGUIEdit",w.layout,w._fullLayout._preGUI,M);var F=C[L._name];F.range=P,F.autorange=L.autorange;var j=C[k._name];j.range=O,j.autorange=k.autorange,M.lastInputTime=this.camera.lastInputTime,w.emit("plotly_relayout",M)},S.cameraChanged=function(){var w=this.camera;this.glplot.setDataBox(this.calcDataBox());var L=this.computeTickMarks();(function(k,C){for(var M=0;M<2;++M){var P=k[M],O=C[M];if(P.length!==O.length)return!0;for(var F=0;F<P.length;++F)if(P[F].x!==O[F].x)return!0}return!1})(L,this.glplotOptions.ticks)&&(this.glplotOptions.ticks=L,this.glplotOptions.dataBox=w.dataBox,this.glplot.update(this.glplotOptions),this.handleAnnotations())},S.handleAnnotations=function(){for(var w=this.graphDiv,L=this.fullLayout.annotations,k=0;k<L.length;k++){var C=L[k];C.xref===this.xaxis._id&&C.yref===this.yaxis._id&&g.getComponentMethod("annotations","drawOne")(w,k)}},S.destroy=function(){if(this.glplot){var w=this.traces;w&&Object.keys(w).map(function(L){w[L].dispose(),delete w[L]}),this.glplot.dispose(),this.container.removeChild(this.svgContainer),this.container.removeChild(this.mouseContainer),this.fullData=null,this.glplot=null,this.stopped=!0,this.camera.mouseListener.enabled=!1,this.mouseContainer.removeEventListener("wheel",this.camera.wheelListener),this.camera=null}},S.plot=function(w,L,k){var C=this.glplot;this.updateRefs(k),this.xaxis.clearCalc(),this.yaxis.clearCalc(),this.updateTraces(w,L),this.updateFx(k.dragmode);var M=k.width,P=k.height;this.updateSize(this.canvas);var O=this.glplotOptions;O.merge(k),O.screenBox=[0,0,M,P];var F={_fullLayout:{_axisConstraintGroups:k._axisConstraintGroups,xaxis:this.xaxis,yaxis:this.yaxis,_size:k._size}};d(F,this.xaxis),d(F,this.yaxis);var j,W,Z=k._size,Q=this.xaxis.domain,X=this.yaxis.domain;for(O.viewBox=[Z.l+Q[0]*Z.w,Z.b+X[0]*Z.h,M-Z.r-(1-Q[1])*Z.w,P-Z.t-(1-X[1])*Z.h],this.mouseContainer.style.width=Z.w*(Q[1]-Q[0])+"px",this.mouseContainer.style.height=Z.h*(X[1]-X[0])+"px",this.mouseContainer.height=Z.h*(X[1]-X[0]),this.mouseContainer.style.left=Z.l+Q[0]*Z.w+"px",this.mouseContainer.style.top=Z.t+(1-X[1])*Z.h+"px",W=0;W<2;++W)(j=this[x[W]])._length=O.viewBox[W+2]-O.viewBox[W],l(this.graphDiv,j),j.setScale();n(F),O.ticks=this.computeTickMarks(),O.dataBox=this.calcDataBox(),O.merge(k),C.update(O),this.glplot.draw()},S.calcDataBox=function(){var w=this.xaxis,L=this.yaxis,k=w.range,C=L.range,M=w.r2l,P=L.r2l;return[M(k[0]),P(C[0]),M(k[1]),P(C[1])]},S.setRanges=function(w){var L=this.xaxis,k=this.yaxis,C=L.l2r,M=k.l2r;L.range=[C(w[0]),C(w[2])],k.range=[M(w[1]),M(w[3])]},S.updateTraces=function(w,L){var k,C,M,P=Object.keys(this.traces);this.fullData=w;e:for(k=0;k<P.length;k++){var O=P[k],F=this.traces[O];for(C=0;C<w.length;C++)if((M=w[C]).uid===O&&M.type===F.type)continue e;F.dispose(),delete this.traces[O]}for(k=0;k<w.length;k++){M=w[k];var j=L[k],W=this.traces[M.uid];W?W.update(M,j):(W=M._module.plot(this,M,j),this.traces[M.uid]=W)}this.glplot.objects.sort(function(Z,Q){return Z._trace.index-Q._trace.index})},S.updateFx=function(w){_(w)||v(w)?(this.pickCanvas.style["pointer-events"]="none",this.mouseContainer.style["pointer-events"]="none"):(this.pickCanvas.style["pointer-events"]="auto",this.mouseContainer.style["pointer-events"]="auto"),this.mouseContainer.style.cursor=w==="pan"?"move":w==="zoom"?"crosshair":null},S.emitPointAction=function(w,L){for(var k,C=w.trace.uid,M=w.pointIndex,P=0;P<this.fullData.length;P++)this.fullData[P].uid===C&&(k=this.fullData[P]);var O={x:w.traceCoord[0],y:w.traceCoord[1],curveNumber:k.index,pointNumber:M,data:k._input,fullData:this.fullData,xaxis:this.xaxis,yaxis:this.yaxis};e.appendArrayPointValue(O,k,M),this.graphDiv.emit(L,{points:[O]})},S.draw=function(){if(!this.stopped){requestAnimationFrame(this.redraw);var w=this.glplot,L=this.camera,k=L.mouseListener,C=this.lastButtonState===1&&k.buttons===0,M=this.fullLayout;this.lastButtonState=k.buttons,this.cameraChanged();var P,O=k.x*w.pixelRatio,F=this.canvas.height-w.pixelRatio*k.y;if(L.boxEnabled&&M.dragmode==="zoom"){this.selectBox.enabled=!0;for(var j=this.selectBox.selectBox=[Math.min(L.boxStart[0],L.boxEnd[0]),Math.min(L.boxStart[1],L.boxEnd[1]),Math.max(L.boxStart[0],L.boxEnd[0]),Math.max(L.boxStart[1],L.boxEnd[1])],W=0;W<2;W++)L.boxStart[W]===L.boxEnd[W]&&(j[W]=w.dataBox[W],j[W+2]=w.dataBox[W+2]);w.setDirty()}else if(!L.panning&&this.isMouseOver){this.selectBox.enabled=!1;var Z=M._size,Q=this.xaxis.domain,X=this.yaxis.domain,G=(P=w.pick(O/w.pixelRatio+Z.l+Q[0]*Z.w,F/w.pixelRatio-(Z.t+(1-X[1])*Z.h)))&&P.object._trace.handlePick(P);if(G&&C&&this.emitPointAction(G,"plotly_click"),P&&P.object._trace.hoverinfo!=="skip"&&M.hovermode&&G&&(!this.lastPickResult||this.lastPickResult.traceUid!==G.trace.uid||this.lastPickResult.dataCoord[0]!==G.dataCoord[0]||this.lastPickResult.dataCoord[1]!==G.dataCoord[1])){var Y=G;this.lastPickResult={traceUid:G.trace?G.trace.uid:null,dataCoord:G.dataCoord.slice()},this.spikes.update({center:P.dataCoord}),Y.screenCoord=[((w.viewBox[2]-w.viewBox[0])*(P.dataCoord[0]-w.dataBox[0])/(w.dataBox[2]-w.dataBox[0])+w.viewBox[0])/w.pixelRatio,(this.canvas.height-(w.viewBox[3]-w.viewBox[1])*(P.dataCoord[1]-w.dataBox[1])/(w.dataBox[3]-w.dataBox[1])-w.viewBox[1])/w.pixelRatio],this.emitPointAction(G,"plotly_hover");var K=this.fullData[Y.trace.index]||{},D=Y.pointIndex,B=e.castHoverinfo(K,M,D);if(B&&B!=="all"){var q=B.split("+");q.indexOf("x")===-1&&(Y.traceCoord[0]=void 0),q.indexOf("y")===-1&&(Y.traceCoord[1]=void 0),q.indexOf("z")===-1&&(Y.traceCoord[2]=void 0),q.indexOf("text")===-1&&(Y.textLabel=void 0),q.indexOf("name")===-1&&(Y.name=void 0)}e.loneHover({x:Y.screenCoord[0],y:Y.screenCoord[1],xLabel:this.hoverFormatter("xaxis",Y.traceCoord[0]),yLabel:this.hoverFormatter("yaxis",Y.traceCoord[1]),zLabel:Y.traceCoord[2],text:Y.textLabel,name:Y.name,color:e.castHoverOption(K,D,"bgcolor")||Y.color,borderColor:e.castHoverOption(K,D,"bordercolor"),fontFamily:e.castHoverOption(K,D,"font.family"),fontSize:e.castHoverOption(K,D,"font.size"),fontColor:e.castHoverOption(K,D,"font.color"),nameLength:e.castHoverOption(K,D,"namelength"),textAlign:e.castHoverOption(K,D,"align")},{container:this.svgContainer,gd:this.graphDiv})}}P||this.unhover(),w.draw()}},S.unhover=function(){this.lastPickResult&&(this.spikes.update({}),this.lastPickResult=null,this.graphDiv.emit("plotly_unhover"),e.loneUnhover(this.svgContainer))},S.hoverFormatter=function(w,L){if(L!==void 0){var k=this[w];return p.tickText(k,k.c2l(L),"hover").text}}},{"../../components/dragelement/helpers":668,"../../components/fx":690,"../../lib/show_no_webgl_msg":809,"../../plots/cartesian/axes":838,"../../registry":915,"../cartesian/autorange":837,"../cartesian/constants":845,"../cartesian/constraints":846,"./camera":876,"./convert":877,"gl-plot2d":316,"gl-select-box":330,"gl-spikes2d":339,"webgl-context":613}],880:[function(h,N,H){var t=h("../../plot_api/edit_types").overrideAll,m=h("../../components/fx/layout_attributes"),g=h("./scene"),p=h("../get_data").getSubplotData,e=h("../../lib"),f=h("../../constants/xmlns_namespaces");H.name="gl3d",H.attr="scene",H.idRoot="scene",H.idRegex=H.attrRegex=e.counterRegex("scene"),H.attributes=h("./layout/attributes"),H.layoutAttributes=h("./layout/layout_attributes"),H.baseLayoutAttrOverrides=t({hoverlabel:m.hoverlabel},"plot","nested"),H.supplyLayoutDefaults=h("./layout/defaults"),H.plot=function(u){for(var i=u._fullLayout,s=u._fullData,o=i._subplots.gl3d,a=0;a<o.length;a++){var c=o[a],r=p(s,"gl3d",c),n=i[c],d=n.camera,l=n._scene;l||(l=new g({id:c,graphDiv:u,container:u.querySelector(".gl-container"),staticPlot:u._context.staticPlot,plotGlPixelRatio:u._context.plotGlPixelRatio,camera:d},i),n._scene=l),l.viewInitial||(l.viewInitial={up:{x:d.up.x,y:d.up.y,z:d.up.z},eye:{x:d.eye.x,y:d.eye.y,z:d.eye.z},center:{x:d.center.x,y:d.center.y,z:d.center.z}}),l.plot(r,i,u.layout)}},H.clean=function(u,i,s,o){for(var a=o._subplots.gl3d||[],c=0;c<a.length;c++){var r=a[c];!i[r]&&o[r]._scene&&(o[r]._scene.destroy(),o._infolayer&&o._infolayer.selectAll(".annotation-"+r).remove())}},H.toSVG=function(u){for(var i=u._fullLayout,s=i._subplots.gl3d,o=i._size,a=0;a<s.length;a++){var c=i[s[a]],r=c.domain,n=c._scene,d=n.toImage("png");i._glimages.append("svg:image").attr({xmlns:f.svg,"xlink:href":d,x:o.l+o.w*r.x[0],y:o.t+o.h*(1-r.y[1]),width:o.w*(r.x[1]-r.x[0]),height:o.h*(r.y[1]-r.y[0]),preserveAspectRatio:"none"}),n.destroy()}},H.cleanId=function(u){if(u.match(/^scene[0-9]*$/)){var i=u.substr(5);return i==="1"&&(i=""),"scene"+i}},H.updateFx=function(u){for(var i=u._fullLayout,s=i._subplots.gl3d,o=0;o<s.length;o++)i[s[o]]._scene.updateFx(i.dragmode,i.hovermode)}},{"../../components/fx/layout_attributes":691,"../../constants/xmlns_namespaces":764,"../../lib":787,"../../plot_api/edit_types":820,"../get_data":875,"./layout/attributes":881,"./layout/defaults":885,"./layout/layout_attributes":886,"./scene":890}],881:[function(h,N,H){N.exports={scene:{valType:"subplotid",dflt:"scene",editType:"calc+clearAxisTypes"}}},{}],882:[function(h,N,H){var t=h("../../../components/color"),m=h("../../cartesian/layout_attributes"),g=h("../../../lib/extend").extendFlat,p=h("../../../plot_api/edit_types").overrideAll;N.exports=p({visible:m.visible,showspikes:{valType:"boolean",dflt:!0},spikesides:{valType:"boolean",dflt:!0},spikethickness:{valType:"number",min:0,dflt:2},spikecolor:{valType:"color",dflt:t.defaultLine},showbackground:{valType:"boolean",dflt:!1},backgroundcolor:{valType:"color",dflt:"rgba(204, 204, 204, 0.5)"},showaxeslabels:{valType:"boolean",dflt:!0},color:m.color,categoryorder:m.categoryorder,categoryarray:m.categoryarray,title:{text:m.title.text,font:m.title.font},type:g({},m.type,{values:["-","linear","log","date","category"]}),autotypenumbers:m.autotypenumbers,autorange:m.autorange,rangemode:m.rangemode,range:g({},m.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],anim:!1}),tickmode:m.tickmode,nticks:m.nticks,tick0:m.tick0,dtick:m.dtick,tickvals:m.tickvals,ticktext:m.ticktext,ticks:m.ticks,mirror:m.mirror,ticklen:m.ticklen,tickwidth:m.tickwidth,tickcolor:m.tickcolor,showticklabels:m.showticklabels,tickfont:m.tickfont,tickangle:m.tickangle,tickprefix:m.tickprefix,showtickprefix:m.showtickprefix,ticksuffix:m.ticksuffix,showticksuffix:m.showticksuffix,showexponent:m.showexponent,exponentformat:m.exponentformat,minexponent:m.minexponent,separatethousands:m.separatethousands,tickformat:m.tickformat,tickformatstops:m.tickformatstops,hoverformat:m.hoverformat,showline:m.showline,linecolor:m.linecolor,linewidth:m.linewidth,showgrid:m.showgrid,gridcolor:g({},m.gridcolor,{dflt:"rgb(204, 204, 204)"}),gridwidth:m.gridwidth,zeroline:m.zeroline,zerolinecolor:m.zerolinecolor,zerolinewidth:m.zerolinewidth,_deprecated:{title:m._deprecated.title,titlefont:m._deprecated.titlefont}},"plot","from-root")},{"../../../components/color":650,"../../../lib/extend":777,"../../../plot_api/edit_types":820,"../../cartesian/layout_attributes":853}],883:[function(h,N,H){var t=h("tinycolor2").mix,m=h("../../../lib"),g=h("../../../plot_api/plot_template"),p=h("./axis_attributes"),e=h("../../cartesian/type_defaults"),f=h("../../cartesian/axis_defaults"),u=["xaxis","yaxis","zaxis"];N.exports=function(i,s,o){var a,c;function r(l,y){return m.coerce(a,c,p,l,y)}for(var n=0;n<u.length;n++){var d=u[n];a=i[d]||{},(c=g.newContainer(s,d))._id=d[0]+o.scene,c._name=d,e(a,c,r,o),f(a,c,r,{font:o.font,letter:d[0],data:o.data,showGrid:!0,noTickson:!0,noTicklabelmode:!0,noTicklabelposition:!0,noTicklabeloverflow:!0,bgColor:o.bgColor,calendar:o.calendar},o.fullLayout),r("gridcolor",t(c.color,o.bgColor,13600/187).toRgbString()),r("title.text",d[0]),c.setScale=m.noop,r("showspikes")&&(r("spikesides"),r("spikethickness"),r("spikecolor",c.color)),r("showaxeslabels"),r("showbackground")&&r("backgroundcolor")}}},{"../../../lib":787,"../../../plot_api/plot_template":827,"../../cartesian/axis_defaults":840,"../../cartesian/type_defaults":864,"./axis_attributes":882,tinycolor2:583}],884:[function(h,N,H){var t=h("../../../lib/str2rgbarray"),m=h("../../../lib"),g=["xaxis","yaxis","zaxis"];function p(){this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[18,18,18],this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont=["Open Sans","Open Sans","Open Sans"],this.labelSize=[20,20,20],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[30,30,30],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[10,10,10],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!0,!0,!0],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._defaultTickPad=this.tickPad.slice(),this._defaultLabelPad=this.labelPad.slice(),this._defaultLineTickLength=this.lineTickLength.slice()}p.prototype.merge=function(e,f){for(var u=0;u<3;++u){var i=f[g[u]];i.visible?(this.labels[u]=e._meta?m.templateString(i.title.text,e._meta):i.title.text,"font"in i.title&&(i.title.font.color&&(this.labelColor[u]=t(i.title.font.color)),i.title.font.family&&(this.labelFont[u]=i.title.font.family),i.title.font.size&&(this.labelSize[u]=i.title.font.size)),"showline"in i&&(this.lineEnable[u]=i.showline),"linecolor"in i&&(this.lineColor[u]=t(i.linecolor)),"linewidth"in i&&(this.lineWidth[u]=i.linewidth),"showgrid"in i&&(this.gridEnable[u]=i.showgrid),"gridcolor"in i&&(this.gridColor[u]=t(i.gridcolor)),"gridwidth"in i&&(this.gridWidth[u]=i.gridwidth),i.type==="log"?this.zeroEnable[u]=!1:"zeroline"in i&&(this.zeroEnable[u]=i.zeroline),"zerolinecolor"in i&&(this.zeroLineColor[u]=t(i.zerolinecolor)),"zerolinewidth"in i&&(this.zeroLineWidth[u]=i.zerolinewidth),"ticks"in i&&i.ticks?this.lineTickEnable[u]=!0:this.lineTickEnable[u]=!1,"ticklen"in i&&(this.lineTickLength[u]=this._defaultLineTickLength[u]=i.ticklen),"tickcolor"in i&&(this.lineTickColor[u]=t(i.tickcolor)),"tickwidth"in i&&(this.lineTickWidth[u]=i.tickwidth),"tickangle"in i&&(this.tickAngle[u]=i.tickangle==="auto"?-3600:Math.PI*-i.tickangle/180),"showticklabels"in i&&(this.tickEnable[u]=i.showticklabels),"tickfont"in i&&(i.tickfont.color&&(this.tickColor[u]=t(i.tickfont.color)),i.tickfont.family&&(this.tickFont[u]=i.tickfont.family),i.tickfont.size&&(this.tickSize[u]=i.tickfont.size)),"mirror"in i?["ticks","all","allticks"].indexOf(i.mirror)!==-1?(this.lineTickMirror[u]=!0,this.lineMirror[u]=!0):i.mirror===!0?(this.lineTickMirror[u]=!1,this.lineMirror[u]=!0):(this.lineTickMirror[u]=!1,this.lineMirror[u]=!1):this.lineMirror[u]=!1,"showbackground"in i&&i.showbackground!==!1?(this.backgroundEnable[u]=!0,this.backgroundColor[u]=t(i.backgroundcolor)):this.backgroundEnable[u]=!1):(this.tickEnable[u]=!1,this.labelEnable[u]=!1,this.lineEnable[u]=!1,this.lineTickEnable[u]=!1,this.gridEnable[u]=!1,this.zeroEnable[u]=!1,this.backgroundEnable[u]=!1)}},N.exports=function(e,f){var u=new p;return u.merge(e,f),u}},{"../../../lib":787,"../../../lib/str2rgbarray":812}],885:[function(h,N,H){var t=h("../../../lib"),m=h("../../../components/color"),g=h("../../../registry"),p=h("../../subplot_defaults"),e=h("./axis_defaults"),f=h("./layout_attributes"),u=h("../../get_data").getSubplotData;function i(s,o,a,c){for(var r=a("bgcolor"),n=m.combine(r,c.paper_bgcolor),d=["up","center","eye"],l=0;l<d.length;l++)a("camera."+d[l]+".x"),a("camera."+d[l]+".y"),a("camera."+d[l]+".z");a("camera.projection.type");var y=!!a("aspectratio.x")&&!!a("aspectratio.y")&&!!a("aspectratio.z"),v=a("aspectmode",y?"manual":"auto");y||(s.aspectratio=o.aspectratio={x:1,y:1,z:1},v==="manual"&&(o.aspectmode="auto"),s.aspectmode=o.aspectmode);var _=u(c.fullData,"gl3d",c.id);e(s,o,{font:c.font,scene:c.id,data:_,bgColor:n,calendar:c.calendar,autotypenumbersDflt:c.autotypenumbersDflt,fullLayout:c.fullLayout}),g.getComponentMethod("annotations3d","handleDefaults")(s,o,c);var x=c.getDfltFromLayout("dragmode");if(x!==!1&&!x)if(x="orbit",s.camera&&s.camera.up){var T=s.camera.up.x,A=s.camera.up.y,S=s.camera.up.z;S!==0&&(T&&A&&S?S/Math.sqrt(T*T+A*A+S*S)>.999&&(x="turntable"):x="turntable")}else x="turntable";a("dragmode",x),a("hovermode",c.getDfltFromLayout("hovermode"))}N.exports=function(s,o,a){var c=o._basePlotModules.length>1;p(s,o,a,{type:"gl3d",attributes:f,handleDefaults:i,fullLayout:o,font:o.font,fullData:a,getDfltFromLayout:function(r){if(!c)return t.validate(s[r],f[r])?s[r]:void 0},autotypenumbersDflt:o.autotypenumbers,paper_bgcolor:o.paper_bgcolor,calendar:o.calendar})}},{"../../../components/color":650,"../../../lib":787,"../../../registry":915,"../../get_data":875,"../../subplot_defaults":909,"./axis_defaults":883,"./layout_attributes":886}],886:[function(h,N,H){var t=h("./axis_attributes"),m=h("../../domain").attributes,g=h("../../../lib/extend").extendFlat,p=h("../../../lib").counterRegex;function e(f,u,i){return{x:{valType:"number",dflt:f,editType:"camera"},y:{valType:"number",dflt:u,editType:"camera"},z:{valType:"number",dflt:i,editType:"camera"},editType:"camera"}}N.exports={_arrayAttrRegexps:[p("scene",".annotations",!0)],bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"plot"},camera:{up:g(e(0,0,1),{}),center:g(e(0,0,0),{}),eye:g(e(1.25,1.25,1.25),{}),projection:{type:{valType:"enumerated",values:["perspective","orthographic"],dflt:"perspective",editType:"calc"},editType:"calc"},editType:"camera"},domain:m({name:"scene",editType:"plot"}),aspectmode:{valType:"enumerated",values:["auto","cube","data","manual"],dflt:"auto",editType:"plot",impliedEdits:{"aspectratio.x":void 0,"aspectratio.y":void 0,"aspectratio.z":void 0}},aspectratio:{x:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},y:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},z:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},editType:"plot",impliedEdits:{aspectmode:"manual"}},xaxis:t,yaxis:t,zaxis:t,dragmode:{valType:"enumerated",values:["orbit","turntable","zoom","pan",!1],editType:"plot"},hovermode:{valType:"enumerated",values:["closest",!1],dflt:"closest",editType:"modebar"},uirevision:{valType:"any",editType:"none"},editType:"plot",_deprecated:{cameraposition:{valType:"info_array",editType:"camera"}}}},{"../../../lib":787,"../../../lib/extend":777,"../../domain":866,"./axis_attributes":882}],887:[function(h,N,H){var t=h("../../../lib/str2rgbarray"),m=["xaxis","yaxis","zaxis"];function g(){this.enabled=[!0,!0,!0],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.drawSides=[!0,!0,!0],this.lineWidth=[1,1,1]}g.prototype.merge=function(p){for(var e=0;e<3;++e){var f=p[m[e]];f.visible?(this.enabled[e]=f.showspikes,this.colors[e]=t(f.spikecolor),this.drawSides[e]=f.spikesides,this.lineWidth[e]=f.spikethickness):(this.enabled[e]=!1,this.drawSides[e]=!1)}},N.exports=function(p){var e=new g;return e.merge(p),e}},{"../../../lib/str2rgbarray":812}],888:[function(h,N,H){N.exports=function(e){for(var f=e.axesOptions,u=e.glplot.axesPixels,i=e.fullSceneLayout,s=[[],[],[]],o=0;o<3;++o){var a=i[g[o]];if(a._length=(u[o].hi-u[o].lo)*u[o].pixelsPerDataUnit/e.dataScale[o],Math.abs(a._length)===1/0||isNaN(a._length))s[o]=[];else{a._input_range=a.range.slice(),a.range[0]=u[o].lo/e.dataScale[o],a.range[1]=u[o].hi/e.dataScale[o],a._m=1/(e.dataScale[o]*u[o].pixelsPerDataUnit),a.range[0]===a.range[1]&&(a.range[0]-=1,a.range[1]+=1);var c=a.tickmode;if(a.tickmode==="auto"){a.tickmode="linear";var r=a.nticks||m.constrain(a._length/40,4,9);t.autoTicks(a,Math.abs(a.range[1]-a.range[0])/r)}for(var n=t.calcTicks(a,{msUTC:!0}),d=0;d<n.length;++d)n[d].x=n[d].x*e.dataScale[o],a.type==="date"&&(n[d].text=n[d].text.replace(/\<br\>/g," "));s[o]=n,a.tickmode=c}}for(f.ticks=s,o=0;o<3;++o)for(p[o]=.5*(e.glplot.bounds[0][o]+e.glplot.bounds[1][o]),d=0;d<2;++d)f.bounds[d][o]=e.glplot.bounds[d][o];e.contourLevels=function(l){for(var y=new Array(3),v=0;v<3;++v){for(var _=l[v],x=new Array(_.length),T=0;T<_.length;++T)x[T]=_[T].x;y[v]=x}return y}(s)};var t=h("../../cartesian/axes"),m=h("../../../lib"),g=["xaxis","yaxis","zaxis"],p=[0,0,0]},{"../../../lib":787,"../../cartesian/axes":838}],889:[function(h,N,H){function t(m,g){var p,e,f=[0,0,0,0];for(p=0;p<4;++p)for(e=0;e<4;++e)f[e]+=m[4*p+e]*g[p];return f}N.exports=function(m,g){return t(m.projection,t(m.view,t(m.model,[g[0],g[1],g[2],1])))}},{}],890:[function(h,N,H){var t,m,g=h("gl-plot3d"),p=g.createCamera,e=g.createScene,f=h("webgl-context"),u=h("has-passive-events"),i=h("../../registry"),s=h("../../lib"),o=s.preserveDrawingBuffer(),a=h("../../plots/cartesian/axes"),c=h("../../components/fx"),r=h("../../lib/str2rgbarray"),n=h("../../lib/show_no_webgl_msg"),d=h("./project"),l=h("./layout/convert"),y=h("./layout/spikes"),v=h("./layout/tick_marks");function _(w,L){var k=document.createElement("div"),C=w.container;this.graphDiv=w.graphDiv;var M=document.createElementNS("http://www.w3.org/2000/svg","svg");M.style.position="absolute",M.style.top=M.style.left="0px",M.style.width=M.style.height="100%",M.style["z-index"]=20,M.style["pointer-events"]="none",k.appendChild(M),this.svgContainer=M,k.id=w.id,k.style.position="absolute",k.style.top=k.style.left="0px",k.style.width=k.style.height="100%",C.appendChild(k),this.fullLayout=L,this.id=w.id||"scene",this.fullSceneLayout=L[this.id],this.plotArgs=[[],{},{}],this.axesOptions=l(L,L[this.id]),this.spikeOptions=y(L[this.id]),this.container=k,this.staticMode=!!w.staticPlot,this.pixelRatio=this.pixelRatio||w.plotGlPixelRatio||2,this.dataScale=[1,1,1],this.contourLevels=[[],[],[]],this.convertAnnotations=i.getComponentMethod("annotations3d","convert"),this.drawAnnotations=i.getComponentMethod("annotations3d","draw"),this.initializeGLPlot()}var x=_.prototype;x.prepareOptions=function(){var w={canvas:this.canvas,gl:this.gl,glOptions:{preserveDrawingBuffer:o,premultipliedAlpha:!0,antialias:!0},container:this.container,axes:this.axesOptions,spikes:this.spikeOptions,pickRadius:10,snapToData:!0,autoScale:!0,autoBounds:!1,cameraObject:this.camera,pixelRatio:this.pixelRatio};if(this.staticMode){if(!(m||(t=document.createElement("canvas"),m=f({canvas:t,preserveDrawingBuffer:!0,premultipliedAlpha:!0,antialias:!0}))))throw new Error("error creating static canvas/context for image server");w.gl=m,w.canvas=t}return w};var T=!0;x.tryCreatePlot=function(){var w=this.prepareOptions(),L=!0;try{this.glplot=e(w)}catch(k){if(this.staticMode||!T||o)L=!1;else{s.warn(["webgl setup failed possibly due to","false preserveDrawingBuffer config.","The mobile/tablet device may not be detected by is-mobile module.","Enabling preserveDrawingBuffer in second attempt to create webgl scene..."].join(" "));try{o=w.glOptions.preserveDrawingBuffer=!0,this.glplot=e(w)}catch(C){o=w.glOptions.preserveDrawingBuffer=!1,L=!1}}}return T=!1,L},x.initializeGLCamera=function(){var w=this.fullSceneLayout.camera,L=w.projection.type==="orthographic";this.camera=p(this.container,{center:[w.center.x,w.center.y,w.center.z],eye:[w.eye.x,w.eye.y,w.eye.z],up:[w.up.x,w.up.y,w.up.z],_ortho:L,zoomMin:.01,zoomMax:100,mode:"orbit"})},x.initializeGLPlot=function(){var w=this;if(w.initializeGLCamera(),!w.tryCreatePlot())return n(w);w.traces={},w.make4thDimension();var L=w.graphDiv,k=L.layout,C=function(){var P={};return w.isCameraChanged(k)&&(P[w.id+".camera"]=w.getCamera()),w.isAspectChanged(k)&&(P[w.id+".aspectratio"]=w.glplot.getAspectratio(),k[w.id].aspectmode!=="manual"&&(w.fullSceneLayout.aspectmode=k[w.id].aspectmode=P[w.id+".aspectmode"]="manual")),P},M=function(P){if(P.fullSceneLayout.dragmode!==!1){var O=C();P.saveLayout(k),P.graphDiv.emit("plotly_relayout",O)}};return w.glplot.canvas&&(w.glplot.canvas.addEventListener("mouseup",function(){M(w)}),w.glplot.canvas.addEventListener("wheel",function(P){if(L._context._scrollZoom.gl3d){if(w.camera._ortho){var O=P.deltaX>P.deltaY?1.1:1/1.1,F=w.glplot.getAspectratio();w.glplot.setAspectratio({x:O*F.x,y:O*F.y,z:O*F.z})}M(w)}},!!u&&{passive:!1}),w.glplot.canvas.addEventListener("mousemove",function(){if(w.fullSceneLayout.dragmode!==!1&&w.camera.mouseListener.buttons!==0){var P=C();w.graphDiv.emit("plotly_relayouting",P)}}),w.staticMode||w.glplot.canvas.addEventListener("webglcontextlost",function(P){L&&L.emit&&L.emit("plotly_webglcontextlost",{event:P,layer:w.id})},!1)),w.glplot.oncontextloss=function(){w.recoverContext()},w.glplot.onrender=function(){w.render()},!0},x.render=function(){var w,L=this,k=L.graphDiv,C=L.svgContainer,M=L.container.getBoundingClientRect();k._fullLayout._calcInverseTransform(k);var P=k._fullLayout._invScaleX,O=k._fullLayout._invScaleY,F=M.width*P,j=M.height*O;C.setAttributeNS(null,"viewBox","0 0 "+F+" "+j),C.setAttributeNS(null,"width",F),C.setAttributeNS(null,"height",j),v(L),L.glplot.axes.update(L.axesOptions);for(var W,Z=Object.keys(L.traces),Q=null,X=L.glplot.selection,G=0;G<Z.length;++G)(w=L.traces[Z[G]]).data.hoverinfo!=="skip"&&w.handlePick(X)&&(Q=w),w.setContourLevels&&w.setContourLevels();function Y(de,ce,ve){var ke=L.fullSceneLayout[de+"axis"];return ke.type!=="log"&&(ce=ke.d2l(ce)),a.hoverLabelText(ke,ce,ve)}if(Q!==null){var K=d(L.glplot.cameraParams,X.dataCoordinate);w=Q.data;var D,B=k._fullData[w.index],q=X.index,ee={xLabel:Y("x",X.traceCoordinate[0],w.xhoverformat),yLabel:Y("y",X.traceCoordinate[1],w.yhoverformat),zLabel:Y("z",X.traceCoordinate[2],w.zhoverformat)},J=c.castHoverinfo(B,L.fullLayout,q),$=(J||"").split("+"),te=J&&J==="all";B.hovertemplate||te||($.indexOf("x")===-1&&(ee.xLabel=void 0),$.indexOf("y")===-1&&(ee.yLabel=void 0),$.indexOf("z")===-1&&(ee.zLabel=void 0),$.indexOf("text")===-1&&(X.textLabel=void 0),$.indexOf("name")===-1&&(Q.name=void 0));var ie=[];w.type==="cone"||w.type==="streamtube"?(ee.uLabel=Y("x",X.traceCoordinate[3],w.uhoverformat),(te||$.indexOf("u")!==-1)&&ie.push("u: "+ee.uLabel),ee.vLabel=Y("y",X.traceCoordinate[4],w.vhoverformat),(te||$.indexOf("v")!==-1)&&ie.push("v: "+ee.vLabel),ee.wLabel=Y("z",X.traceCoordinate[5],w.whoverformat),(te||$.indexOf("w")!==-1)&&ie.push("w: "+ee.wLabel),ee.normLabel=X.traceCoordinate[6].toPrecision(3),(te||$.indexOf("norm")!==-1)&&ie.push("norm: "+ee.normLabel),w.type==="streamtube"&&(ee.divergenceLabel=X.traceCoordinate[7].toPrecision(3),(te||$.indexOf("divergence")!==-1)&&ie.push("divergence: "+ee.divergenceLabel)),X.textLabel&&ie.push(X.textLabel),D=ie.join("<br>")):w.type==="isosurface"||w.type==="volume"?(ee.valueLabel=a.hoverLabelText(L._mockAxis,L._mockAxis.d2l(X.traceCoordinate[3]),w.valuehoverformat),ie.push("value: "+ee.valueLabel),X.textLabel&&ie.push(X.textLabel),D=ie.join("<br>")):D=X.textLabel;var ae={x:X.traceCoordinate[0],y:X.traceCoordinate[1],z:X.traceCoordinate[2],data:B._input,fullData:B,curveNumber:B.index,pointNumber:q};c.appendArrayPointValue(ae,B,q),w._module.eventData&&(ae=B._module.eventData(ae,X,B,{},q));var he={points:[ae]};if(L.fullSceneLayout.hovermode){var se=[];c.loneHover({trace:B,x:(.5+.5*K[0]/K[3])*F,y:(.5-.5*K[1]/K[3])*j,xLabel:ee.xLabel,yLabel:ee.yLabel,zLabel:ee.zLabel,text:D,name:Q.name,color:c.castHoverOption(B,q,"bgcolor")||Q.color,borderColor:c.castHoverOption(B,q,"bordercolor"),fontFamily:c.castHoverOption(B,q,"font.family"),fontSize:c.castHoverOption(B,q,"font.size"),fontColor:c.castHoverOption(B,q,"font.color"),nameLength:c.castHoverOption(B,q,"namelength"),textAlign:c.castHoverOption(B,q,"align"),hovertemplate:s.castOption(B,q,"hovertemplate"),hovertemplateLabels:s.extendFlat({},ae,ee),eventData:[ae]},{container:C,gd:k,inOut_bbox:se}),ae.bbox=se[0]}X.buttons&&X.distance<5?k.emit("plotly_click",he):k.emit("plotly_hover",he),W=he}else c.loneUnhover(C),k.emit("plotly_unhover",W);L.drawAnnotations(L)},x.recoverContext=function(){var w=this;w.glplot.dispose();var L=function(){w.glplot.gl.isContextLost()?requestAnimationFrame(L):w.initializeGLPlot()?w.plot.apply(w,w.plotArgs):s.error("Catastrophic and unrecoverable WebGL error. Context lost.")};requestAnimationFrame(L)};var A=["xaxis","yaxis","zaxis"];function S(w,L,k){for(var C=w.fullSceneLayout,M=0;M<3;M++){var P=A[M],O=P.charAt(0),F=C[P],j=L[O],W=L[O+"calendar"],Z=L["_"+O+"length"];if(s.isArrayOrTypedArray(j))for(var Q,X=0;X<(Z||j.length);X++)if(s.isArrayOrTypedArray(j[X]))for(var G=0;G<j[X].length;++G)Q=F.d2l(j[X][G],0,W),!isNaN(Q)&&isFinite(Q)&&(k[0][M]=Math.min(k[0][M],Q),k[1][M]=Math.max(k[1][M],Q));else Q=F.d2l(j[X],0,W),!isNaN(Q)&&isFinite(Q)&&(k[0][M]=Math.min(k[0][M],Q),k[1][M]=Math.max(k[1][M],Q));else k[0][M]=Math.min(k[0][M],0),k[1][M]=Math.max(k[1][M],Z-1)}}x.plot=function(w,L,k){if(this.plotArgs=[w,L,k],!this.glplot.contextLost){var C,M,P,O,F,j,W=L[this.id],Z=k[this.id];this.fullLayout=L,this.fullSceneLayout=W,this.axesOptions.merge(L,W),this.spikeOptions.merge(W),this.setViewport(W),this.updateFx(W.dragmode,W.hovermode),this.camera.enableWheel=this.graphDiv._context._scrollZoom.gl3d,this.glplot.setClearColor(r(W.bgcolor)),this.setConvert(F),w?Array.isArray(w)||(w=[w]):w=[];var Q=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];for(P=0;P<w.length;++P)(C=w[P]).visible===!0&&C._length!==0&&S(this,C,Q);(function(we,Me){for(var Se=we.fullSceneLayout,De=Se.annotations||[],Fe=0;Fe<3;Fe++)for(var Ye=A[Fe],et=Ye.charAt(0),Oe=Se[Ye],je=0;je<De.length;je++){var We=De[je];if(We.visible){var Ge=Oe.r2l(We[et]);!isNaN(Ge)&&isFinite(Ge)&&(Me[0][Fe]=Math.min(Me[0][Fe],Ge),Me[1][Fe]=Math.max(Me[1][Fe],Ge))}}})(this,Q);var X=[1,1,1];for(O=0;O<3;++O)Q[1][O]===Q[0][O]?X[O]=1:X[O]=1/(Q[1][O]-Q[0][O]);for(this.dataScale=X,this.convertAnnotations(this),P=0;P<w.length;++P)(C=w[P]).visible===!0&&C._length!==0&&((M=this.traces[C.uid])?M.data.type===C.type?M.update(C):(M.dispose(),M=C._module.plot(this,C),this.traces[C.uid]=M):(M=C._module.plot(this,C),this.traces[C.uid]=M),M.name=C.name);var G=Object.keys(this.traces);e:for(P=0;P<G.length;++P){for(O=0;O<w.length;++O)if(w[O].uid===G[P]&&w[O].visible===!0&&w[O]._length!==0)continue e;(M=this.traces[G[P]]).dispose(),delete this.traces[G[P]]}this.glplot.objects.sort(function(we,Me){return we._trace.data.index-Me._trace.data.index});var Y,K=[[0,0,0],[0,0,0]],D=[],B={};for(P=0;P<3;++P){if((j=(F=W[A[P]]).type)in B?(B[j].acc*=X[P],B[j].count+=1):B[j]={acc:X[P],count:1},F.autorange){K[0][P]=1/0,K[1][P]=-1/0;var q=this.glplot.objects,ee=this.fullSceneLayout.annotations||[],J=F._name.charAt(0);for(O=0;O<q.length;O++){var $=q[O],te=$.bounds,ie=$._trace.data._pad||0;$.constructor.name==="ErrorBars"&&F._lowerLogErrorBound?K[0][P]=Math.min(K[0][P],F._lowerLogErrorBound):K[0][P]=Math.min(K[0][P],te[0][P]/X[P]-ie),K[1][P]=Math.max(K[1][P],te[1][P]/X[P]+ie)}for(O=0;O<ee.length;O++){var ae=ee[O];if(ae.visible){var he=F.r2l(ae[J]);K[0][P]=Math.min(K[0][P],he),K[1][P]=Math.max(K[1][P],he)}}if("rangemode"in F&&F.rangemode==="tozero"&&(K[0][P]=Math.min(K[0][P],0),K[1][P]=Math.max(K[1][P],0)),K[0][P]>K[1][P])K[0][P]=-1,K[1][P]=1;else{var se=K[1][P]-K[0][P];K[0][P]-=se/32,K[1][P]+=se/32}if(F.autorange==="reversed"){var de=K[0][P];K[0][P]=K[1][P],K[1][P]=de}}else{var ce=F.range;K[0][P]=F.r2l(ce[0]),K[1][P]=F.r2l(ce[1])}K[0][P]===K[1][P]&&(K[0][P]-=1,K[1][P]+=1),D[P]=K[1][P]-K[0][P],this.glplot.setBounds(P,{min:K[0][P]*X[P],max:K[1][P]*X[P]})}var ve=W.aspectmode;if(ve==="cube")Y=[1,1,1];else if(ve==="manual"){var ke=W.aspectratio;Y=[ke.x,ke.y,ke.z]}else{if(ve!=="auto"&&ve!=="data")throw new Error("scene.js aspectRatio was not one of the enumerated types");var Ee=[1,1,1];for(P=0;P<3;++P){var be=B[j=(F=W[A[P]]).type];Ee[P]=Math.pow(be.acc,1/be.count)/X[P]}Y=ve==="data"||Math.max.apply(null,Ee)/Math.min.apply(null,Ee)<=4?Ee:[1,1,1]}W.aspectratio.x=Z.aspectratio.x=Y[0],W.aspectratio.y=Z.aspectratio.y=Y[1],W.aspectratio.z=Z.aspectratio.z=Y[2],this.glplot.setAspectratio(W.aspectratio),this.viewInitial.aspectratio||(this.viewInitial.aspectratio={x:W.aspectratio.x,y:W.aspectratio.y,z:W.aspectratio.z}),this.viewInitial.aspectmode||(this.viewInitial.aspectmode=W.aspectmode);var xe=W.domain||null,ue=L._size||null;if(xe&&ue){var me=this.container.style;me.position="absolute",me.left=ue.l+xe.x[0]*ue.w+"px",me.top=ue.t+(1-xe.y[1])*ue.h+"px",me.width=ue.w*(xe.x[1]-xe.x[0])+"px",me.height=ue.h*(xe.y[1]-xe.y[0])+"px"}this.glplot.redraw()}},x.destroy=function(){this.glplot&&(this.camera.mouseListener.enabled=!1,this.container.removeEventListener("wheel",this.camera.wheelListener),this.camera=null,this.glplot.dispose(),this.container.parentNode.removeChild(this.container),this.glplot=null)},x.getCamera=function(){var w;return this.camera.view.recalcMatrix(this.camera.view.lastT()),{up:{x:(w=this.camera).up[0],y:w.up[1],z:w.up[2]},center:{x:w.center[0],y:w.center[1],z:w.center[2]},eye:{x:w.eye[0],y:w.eye[1],z:w.eye[2]},projection:{type:w._ortho===!0?"orthographic":"perspective"}}},x.setViewport=function(w){var L,k=w.camera;this.camera.lookAt.apply(this,[[(L=k).eye.x,L.eye.y,L.eye.z],[L.center.x,L.center.y,L.center.z],[L.up.x,L.up.y,L.up.z]]),this.glplot.setAspectratio(w.aspectratio),k.projection.type==="orthographic"!==this.camera._ortho&&(this.glplot.redraw(),this.glplot.clearRGBA(),this.glplot.dispose(),this.initializeGLPlot())},x.isCameraChanged=function(w){var L=this.getCamera(),k=s.nestedProperty(w,this.id+".camera").get();function C(F,j,W,Z){var Q=["up","center","eye"],X=["x","y","z"];return j[Q[W]]&&F[Q[W]][X[Z]]===j[Q[W]][X[Z]]}var M=!1;if(k===void 0)M=!0;else{for(var P=0;P<3;P++)for(var O=0;O<3;O++)if(!C(L,k,P,O)){M=!0;break}(!k.projection||L.projection&&L.projection.type!==k.projection.type)&&(M=!0)}return M},x.isAspectChanged=function(w){var L=this.glplot.getAspectratio(),k=s.nestedProperty(w,this.id+".aspectratio").get();return k===void 0||k.x!==L.x||k.y!==L.y||k.z!==L.z},x.saveLayout=function(w){var L,k,C,M,P,O,F=this.fullLayout,j=this.isCameraChanged(w),W=this.isAspectChanged(w),Z=j||W;if(Z){var Q={};j&&(L=this.getCamera(),C=(k=s.nestedProperty(w,this.id+".camera")).get(),Q[this.id+".camera"]=C),W&&(M=this.glplot.getAspectratio(),O=(P=s.nestedProperty(w,this.id+".aspectratio")).get(),Q[this.id+".aspectratio"]=O),i.call("_storeDirectGUIEdit",w,F._preGUI,Q),j&&(k.set(L),s.nestedProperty(F,this.id+".camera").set(L)),W&&(P.set(M),s.nestedProperty(F,this.id+".aspectratio").set(M),this.glplot.redraw())}return Z},x.updateFx=function(w,L){var k=this.camera;if(k)if(w==="orbit")k.mode="orbit",k.keyBindingMode="rotate";else if(w==="turntable"){k.up=[0,0,1],k.mode="turntable",k.keyBindingMode="rotate";var C=this.graphDiv,M=C._fullLayout,P=this.fullSceneLayout.camera,O=P.up.x,F=P.up.y,j=P.up.z;if(j/Math.sqrt(O*O+F*F+j*j)<.999){var W=this.id+".camera.up",Z={x:0,y:0,z:1},Q={};Q[W]=Z;var X=C.layout;i.call("_storeDirectGUIEdit",X,M._preGUI,Q),P.up=Z,s.nestedProperty(X,W).set(Z)}}else k.keyBindingMode=w;this.fullSceneLayout.hovermode=L},x.toImage=function(w){w||(w="png"),this.staticMode&&this.container.appendChild(t),this.glplot.redraw();var L=this.glplot.gl,k=L.drawingBufferWidth,C=L.drawingBufferHeight;L.bindFramebuffer(L.FRAMEBUFFER,null);var M=new Uint8Array(k*C*4);L.readPixels(0,0,k,C,L.RGBA,L.UNSIGNED_BYTE,M),function(W,Z,Q){for(var X=0,G=Q-1;X<G;++X,--G)for(var Y=0;Y<Z;++Y)for(var K=0;K<4;++K){var D=4*(Z*X+Y)+K,B=4*(Z*G+Y)+K,q=W[D];W[D]=W[B],W[B]=q}}(M,k,C),function(W,Z,Q){for(var X=0;X<Q;++X)for(var G=0;G<Z;++G){var Y=4*(Z*X+G),K=W[Y+3];if(K>0)for(var D=255/K,B=0;B<3;++B)W[Y+B]=Math.min(D*W[Y+B],255)}}(M,k,C);var P=document.createElement("canvas");P.width=k,P.height=C;var O,F=P.getContext("2d"),j=F.createImageData(k,C);switch(j.data.set(M),F.putImageData(j,0,0),w){case"jpeg":O=P.toDataURL("image/jpeg");break;case"webp":O=P.toDataURL("image/webp");break;default:O=P.toDataURL("image/png")}return this.staticMode&&this.container.removeChild(t),O},x.setConvert=function(){for(var w=0;w<3;w++){var L=this.fullSceneLayout[A[w]];a.setConvert(L,this.fullLayout),L.setScale=s.noop}},x.make4thDimension=function(){var w=this.graphDiv._fullLayout;this._mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},a.setConvert(this._mockAxis,w)},N.exports=_},{"../../components/fx":690,"../../lib":787,"../../lib/show_no_webgl_msg":809,"../../lib/str2rgbarray":812,"../../plots/cartesian/axes":838,"../../registry":915,"./layout/convert":884,"./layout/spikes":887,"./layout/tick_marks":888,"./project":889,"gl-plot3d":319,"has-passive-events":436,"webgl-context":613}],891:[function(h,N,H){N.exports=function(t,m,g,p){p=p||t.length;for(var e=new Array(p),f=0;f<p;f++)e[f]=[t[f],m[f],g[f]];return e}},{}],892:[function(h,N,H){var t=h("./font_attributes"),m=h("./animation_attributes"),g=h("../components/color/attributes"),p=h("../components/shapes/draw_newshape/attributes"),e=h("./pad_attributes"),f=h("../lib/extend").extendFlat,u=t({editType:"calc"});u.family.dflt='"Open Sans", verdana, arial, sans-serif',u.size.dflt=12,u.color.dflt=g.defaultLine,N.exports={font:u,title:{text:{valType:"string",editType:"layoutstyle"},font:t({editType:"layoutstyle"}),xref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},yref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},x:{valType:"number",min:0,max:1,dflt:.5,editType:"layoutstyle"},y:{valType:"number",min:0,max:1,dflt:"auto",editType:"layoutstyle"},xanchor:{valType:"enumerated",dflt:"auto",values:["auto","left","center","right"],editType:"layoutstyle"},yanchor:{valType:"enumerated",dflt:"auto",values:["auto","top","middle","bottom"],editType:"layoutstyle"},pad:f(e({editType:"layoutstyle"}),{}),editType:"layoutstyle"},uniformtext:{mode:{valType:"enumerated",values:[!1,"hide","show"],dflt:!1,editType:"plot"},minsize:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"},autosize:{valType:"boolean",dflt:!1,editType:"none"},width:{valType:"number",min:10,dflt:700,editType:"plot"},height:{valType:"number",min:10,dflt:450,editType:"plot"},margin:{l:{valType:"number",min:0,dflt:80,editType:"plot"},r:{valType:"number",min:0,dflt:80,editType:"plot"},t:{valType:"number",min:0,dflt:100,editType:"plot"},b:{valType:"number",min:0,dflt:80,editType:"plot"},pad:{valType:"number",min:0,dflt:0,editType:"plot"},autoexpand:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},computed:{valType:"any",editType:"none"},paper_bgcolor:{valType:"color",dflt:g.background,editType:"plot"},plot_bgcolor:{valType:"color",dflt:g.background,editType:"layoutstyle"},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},separators:{valType:"string",editType:"plot"},hidesources:{valType:"boolean",dflt:!1,editType:"plot"},showlegend:{valType:"boolean",editType:"legend"},colorway:{valType:"colorlist",dflt:g.defaults,editType:"calc"},datarevision:{valType:"any",editType:"calc"},uirevision:{valType:"any",editType:"none"},editrevision:{valType:"any",editType:"none"},selectionrevision:{valType:"any",editType:"none"},template:{valType:"any",editType:"calc"},newshape:p.newshape,activeshape:p.activeshape,meta:{valType:"any",arrayOk:!0,editType:"plot"},transition:f({},m.transition,{editType:"none"}),_deprecated:{title:{valType:"string",editType:"layoutstyle"},titlefont:t({editType:"layoutstyle"})}}},{"../components/color/attributes":649,"../components/shapes/draw_newshape/attributes":735,"../lib/extend":777,"./animation_attributes":832,"./font_attributes":867,"./pad_attributes":900}],893:[function(h,N,H){var t=h("../../lib/sort_object_keys"),m='\xA9 <a target="_blank" href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',g=['\xA9 <a target="_blank" href="https://carto.com/">Carto</a>',m].join(" "),p=['Map tiles by <a target="_blank" href="https://stamen.com">Stamen Design</a>','under <a target="_blank" href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>',"|",'Data by <a target="_blank" href="https://openstreetmap.org">OpenStreetMap</a> contributors','under <a target="_blank" href="https://www.openstreetmap.org/copyright">ODbL</a>'].join(" "),e={"open-street-map":{id:"osm",version:8,sources:{"plotly-osm-tiles":{type:"raster",attribution:m,tiles:["https://a.tile.openstreetmap.org/{z}/{x}/{y}.png","https://b.tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-osm-tiles",type:"raster",source:"plotly-osm-tiles",minzoom:0,maxzoom:22}]},"white-bg":{id:"white-bg",version:8,sources:{},layers:[{id:"white-bg",type:"background",paint:{"background-color":"#FFFFFF"},minzoom:0,maxzoom:22}]},"carto-positron":{id:"carto-positron",version:8,sources:{"plotly-carto-positron":{type:"raster",attribution:g,tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-positron",type:"raster",source:"plotly-carto-positron",minzoom:0,maxzoom:22}]},"carto-darkmatter":{id:"carto-darkmatter",version:8,sources:{"plotly-carto-darkmatter":{type:"raster",attribution:g,tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-darkmatter",type:"raster",source:"plotly-carto-darkmatter",minzoom:0,maxzoom:22}]},"stamen-terrain":{id:"stamen-terrain",version:8,sources:{"plotly-stamen-terrain":{type:"raster",attribution:p,tiles:["https://stamen-tiles.a.ssl.fastly.net/terrain/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-terrain",type:"raster",source:"plotly-stamen-terrain",minzoom:0,maxzoom:22}]},"stamen-toner":{id:"stamen-toner",version:8,sources:{"plotly-stamen-toner":{type:"raster",attribution:p,tiles:["https://stamen-tiles.a.ssl.fastly.net/toner/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-toner",type:"raster",source:"plotly-stamen-toner",minzoom:0,maxzoom:22}]},"stamen-watercolor":{id:"stamen-watercolor",version:8,sources:{"plotly-stamen-watercolor":{type:"raster",attribution:['Map tiles by <a target="_blank" href="https://stamen.com">Stamen Design</a>','under <a target="_blank" href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>',"|",'Data by <a target="_blank" href="https://openstreetmap.org">OpenStreetMap</a> contributors','under <a target="_blank" href="https://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>'].join(" "),tiles:["https://stamen-tiles.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-watercolor",type:"raster",source:"plotly-stamen-watercolor",minzoom:0,maxzoom:22}]}},f=t(e);N.exports={requiredVersion:"1.10.1",styleUrlPrefix:"mapbox://styles/mapbox/",styleUrlSuffix:"v9",styleValuesMapbox:["basic","streets","outdoors","light","dark","satellite","satellite-streets"],styleValueDflt:"basic",stylesNonMapbox:e,styleValuesNonMapbox:f,traceLayerPrefix:"plotly-trace-layer-",layoutLayerPrefix:"plotly-layout-layer-",wrongVersionErrorMsg:["Your custom plotly.js bundle is not using the correct mapbox-gl version","Please install mapbox-gl@1.10.1."].join(`
`),noAccessTokenErrorMsg:["Missing Mapbox access token.","Mapbox trace type require a Mapbox access token to be registered.","For example:","  Plotly.newPlot(gd, data, layout, { mapboxAccessToken: 'my-access-token' });","More info here: https://www.mapbox.com/help/define-access-token/"].join(`
`),missingStyleErrorMsg:["No valid mapbox style found, please set `mapbox.style` to one of:",f.join(", "),"or register a Mapbox access token to use a Mapbox-served style."].join(`
`),multipleTokensErrorMsg:["Set multiple mapbox access token across different mapbox subplot,","using first token found as mapbox-gl does not allow multipleaccess tokens on the same page."].join(`
`),mapOnErrorMsg:"Mapbox error.",mapboxLogo:{path0:"m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z",path1:"M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z",path2:"M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z",polygon:"11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34"},styleRules:{map:"overflow:hidden;position:relative;","missing-css":"display:none;",canary:"background-color:salmon;","ctrl-bottom-left":"position: absolute; pointer-events: none; z-index: 2; bottom: 0; left: 0;","ctrl-bottom-right":"position: absolute; pointer-events: none; z-index: 2; right: 0; bottom: 0;",ctrl:"clear: both; pointer-events: auto; transform: translate(0, 0);","ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner":"display: none;","ctrl-attrib.mapboxgl-compact:hover .mapboxgl-ctrl-attrib-inner":"display: block; margin-top:2px","ctrl-attrib.mapboxgl-compact:hover":"padding: 2px 24px 2px 4px; visibility: visible; margin-top: 6px;","ctrl-attrib.mapboxgl-compact::after":`content: ""; cursor: pointer; position: absolute; background-image: url('data:image/svg+xml;charset=utf-8,%3Csvg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"%3E %3Cpath fill="%23333333" fill-rule="evenodd" d="M4,10a6,6 0 1,0 12,0a6,6 0 1,0 -12,0 M9,7a1,1 0 1,0 2,0a1,1 0 1,0 -2,0 M9,10a1,1 0 1,1 2,0l0,3a1,1 0 1,1 -2,0"/%3E %3C/svg%3E'); background-color: rgba(255, 255, 255, 0.5); width: 24px; height: 24px; box-sizing: border-box; border-radius: 12px;`,"ctrl-attrib.mapboxgl-compact":"min-height: 20px; padding: 0; margin: 10px; position: relative; background-color: #fff; border-radius: 3px 12px 12px 3px;","ctrl-bottom-right > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; right: 0","ctrl-bottom-left > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; left: 0","ctrl-bottom-left .mapboxgl-ctrl":"margin: 0 0 10px 10px; float: left;","ctrl-bottom-right .mapboxgl-ctrl":"margin: 0 10px 10px 0; float: right;","ctrl-attrib":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a:hover":"color: inherit; text-decoration: underline;","ctrl-attrib .mapbox-improve-map":"font-weight: bold; margin-left: 2px;","attrib-empty":"display: none;","ctrl-logo":`display:block; width: 21px; height: 21px; background-image: url('data:image/svg+xml;charset=utf-8,%3C?xml version="1.0" encoding="utf-8"?%3E %3Csvg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 21 21" style="enable-background:new 0 0 21 21;" xml:space="preserve"%3E%3Cg transform="translate(0,0.01)"%3E%3Cpath d="m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z" style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3Cpath d="M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpath d="M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpolygon points="11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34 " style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3C/g%3E%3C/svg%3E')`}}},{"../../lib/sort_object_keys":810}],894:[function(h,N,H){var t=h("../../lib");N.exports=function(m,g){var p=m.split(" "),e=p[0],f=p[1],u=t.isArrayOrTypedArray(g)?t.mean(g):g,i=.5+u/100,s=1.5+u/100,o=["",""],a=[0,0];switch(e){case"top":o[0]="top",a[1]=-s;break;case"bottom":o[0]="bottom",a[1]=s}switch(f){case"left":o[1]="right",a[0]=-i;break;case"right":o[1]="left",a[0]=i}return{anchor:o[0]&&o[1]?o.join("-"):o[0]?o[0]:o[1]?o[1]:"center",offset:a}}},{"../../lib":787}],895:[function(h,N,H){var t=h("mapbox-gl/dist/mapbox-gl-unminified"),m=h("../../lib"),g=m.strTranslate,p=m.strScale,e=h("../../plots/get_data").getSubplotCalcData,f=h("../../constants/xmlns_namespaces"),u=h("@plotly/d3"),i=h("../../components/drawing"),s=h("../../lib/svg_text_utils"),o=h("./mapbox"),a=H.constants=h("./constants");function c(r){return typeof r=="string"&&(a.styleValuesMapbox.indexOf(r)!==-1||r.indexOf("mapbox://")===0)}H.name="mapbox",H.attr="subplot",H.idRoot="mapbox",H.idRegex=H.attrRegex=m.counterRegex("mapbox"),H.attributes={subplot:{valType:"subplotid",dflt:"mapbox",editType:"calc"}},H.layoutAttributes=h("./layout_attributes"),H.supplyLayoutDefaults=h("./layout_defaults"),H.plot=function(r){var n=r._fullLayout,d=r.calcdata,l=n._subplots.mapbox;if(t.version!==a.requiredVersion)throw new Error(a.wrongVersionErrorMsg);var y=function(S,w){var L=S._fullLayout;if(S._context.mapboxAccessToken==="")return"";for(var k=[],C=[],M=!1,P=!1,O=0;O<w.length;O++){var F=L[w[O]],j=F.accesstoken;c(F.style)&&(j?m.pushUnique(k,j):(c(F._input.style)&&(m.error("Uses Mapbox map style, but did not set an access token."),M=!0),P=!0)),j&&m.pushUnique(C,j)}if(P){var W=M?a.noAccessTokenErrorMsg:a.missingStyleErrorMsg;throw m.error(W),new Error(W)}return k.length?(k.length>1&&m.warn(a.multipleTokensErrorMsg),k[0]):(C.length&&m.log(["Listed mapbox access token(s)",C.join(","),"but did not use a Mapbox map style, ignoring token(s)."].join(" ")),"")}(r,l);t.accessToken=y;for(var v=0;v<l.length;v++){var _=l[v],x=e(d,"mapbox",_),T=n[_],A=T._subplot;A||(A=new o(r,_),n[_]._subplot=A),A.viewInitial||(A.viewInitial={center:m.extendFlat({},T.center),zoom:T.zoom,bearing:T.bearing,pitch:T.pitch}),A.plot(x,n,r._promises)}},H.clean=function(r,n,d,l){for(var y=l._subplots.mapbox||[],v=0;v<y.length;v++){var _=y[v];!n[_]&&l[_]._subplot&&l[_]._subplot.destroy()}},H.toSVG=function(r){for(var n=r._fullLayout,d=n._subplots.mapbox,l=n._size,y=0;y<d.length;y++){var v=n[d[y]],_=v.domain,x=v._subplot.toImage("png");n._glimages.append("svg:image").attr({xmlns:f.svg,"xlink:href":x,x:l.l+l.w*_.x[0],y:l.t+l.h*(1-_.y[1]),width:l.w*(_.x[1]-_.x[0]),height:l.h*(_.y[1]-_.y[0]),preserveAspectRatio:"none"});var T=u.select(v._subplot.div);if(T.select(".mapboxgl-ctrl-logo").node().offsetParent!==null){var A=n._glimages.append("g");A.attr("transform",g(l.l+l.w*_.x[0]+10,l.t+l.h*(1-_.y[0])-31)),A.append("path").attr("d",a.mapboxLogo.path0).style({opacity:.9,fill:"#ffffff","enable-background":"new"}),A.append("path").attr("d",a.mapboxLogo.path1).style("opacity",.35).style("enable-background","new"),A.append("path").attr("d",a.mapboxLogo.path2).style("opacity",.35).style("enable-background","new"),A.append("polygon").attr("points",a.mapboxLogo.polygon).style({opacity:.9,fill:"#ffffff","enable-background":"new"})}var S=T.select(".mapboxgl-ctrl-attrib").text().replace("Improve this map",""),w=n._glimages.append("g"),L=w.append("text");L.text(S).classed("static-attribution",!0).attr({"font-size":12,"font-family":"Arial",color:"rgba(0, 0, 0, 0.75)","text-anchor":"end","data-unformatted":S});var k=i.bBox(L.node()),C=l.w*(_.x[1]-_.x[0]);if(k.width>C/2){var M=S.split("|").join("<br>");L.text(M).attr("data-unformatted",M).call(s.convertToTspans,r),k=i.bBox(L.node())}L.attr("transform",g(-3,8-k.height)),w.insert("rect",".static-attribution").attr({x:-k.width-6,y:-k.height-3,width:k.width+6,height:k.height+3,fill:"rgba(255, 255, 255, 0.75)"});var P=1;k.width+6>C&&(P=C/(k.width+6));var O=[l.l+l.w*_.x[1],l.t+l.h*(1-_.y[0])];w.attr("transform",g(O[0],O[1])+p(P))}},H.updateFx=function(r){for(var n=r._fullLayout,d=n._subplots.mapbox,l=0;l<d.length;l++)n[d[l]]._subplot.updateFx(n)}},{"../../components/drawing":672,"../../constants/xmlns_namespaces":764,"../../lib":787,"../../lib/svg_text_utils":813,"../../plots/get_data":875,"./constants":893,"./layout_attributes":897,"./layout_defaults":898,"./mapbox":899,"@plotly/d3":58,"mapbox-gl/dist/mapbox-gl-unminified":451}],896:[function(h,N,H){var t=h("../../lib"),m=h("../../lib/svg_text_utils").sanitizeHTML,g=h("./convert_text_opts"),p=h("./constants");function e(s,o){this.subplot=s,this.uid=s.uid+"-"+o,this.index=o,this.idSource="source-"+this.uid,this.idLayer=p.layoutLayerPrefix+this.uid,this.sourceType=null,this.source=null,this.layerType=null,this.below=null,this.visible=!1}var f=e.prototype;function u(s){if(!s.visible)return!1;var o=s.source;if(Array.isArray(o)&&o.length>0){for(var a=0;a<o.length;a++)if(typeof o[a]!="string"||o[a].length===0)return!1;return!0}return t.isPlainObject(o)||typeof o=="string"&&o.length>0}function i(s){var o={},a={};switch(s.type){case"circle":t.extendFlat(a,{"circle-radius":s.circle.radius,"circle-color":s.color,"circle-opacity":s.opacity});break;case"line":t.extendFlat(a,{"line-width":s.line.width,"line-color":s.color,"line-opacity":s.opacity,"line-dasharray":s.line.dash});break;case"fill":t.extendFlat(a,{"fill-color":s.color,"fill-outline-color":s.fill.outlinecolor,"fill-opacity":s.opacity});break;case"symbol":var c=s.symbol,r=g(c.textposition,c.iconsize);t.extendFlat(o,{"icon-image":c.icon+"-15","icon-size":c.iconsize/10,"text-field":c.text,"text-size":c.textfont.size,"text-anchor":r.anchor,"text-offset":r.offset,"symbol-placement":c.placement}),t.extendFlat(a,{"icon-color":s.color,"text-color":c.textfont.color,"text-opacity":s.opacity});break;case"raster":t.extendFlat(a,{"raster-fade-duration":0,"raster-opacity":s.opacity})}return{layout:o,paint:a}}f.update=function(s){this.visible?this.needsNewImage(s)?this.updateImage(s):this.needsNewSource(s)?(this.removeLayer(),this.updateSource(s),this.updateLayer(s)):this.needsNewLayer(s)?this.updateLayer(s):this.updateStyle(s):(this.updateSource(s),this.updateLayer(s)),this.visible=u(s)},f.needsNewImage=function(s){return this.subplot.map.getSource(this.idSource)&&this.sourceType==="image"&&s.sourcetype==="image"&&(this.source!==s.source||JSON.stringify(this.coordinates)!==JSON.stringify(s.coordinates))},f.needsNewSource=function(s){return this.sourceType!==s.sourcetype||JSON.stringify(this.source)!==JSON.stringify(s.source)||this.layerType!==s.type},f.needsNewLayer=function(s){return this.layerType!==s.type||this.below!==this.subplot.belowLookup["layout-"+this.index]},f.lookupBelow=function(){return this.subplot.belowLookup["layout-"+this.index]},f.updateImage=function(s){this.subplot.map.getSource(this.idSource).updateImage({url:s.source,coordinates:s.coordinates});var o=this.findFollowingMapboxLayerId(this.lookupBelow());o!==null&&this.subplot.map.moveLayer(this.idLayer,o)},f.updateSource=function(s){var o=this.subplot.map;if(o.getSource(this.idSource)&&o.removeSource(this.idSource),this.sourceType=s.sourcetype,this.source=s.source,u(s)){var a=function(c){var r,n=c.sourcetype,d=c.source,l={type:n};return n==="geojson"?r="data":n==="vector"?r=typeof d=="string"?"url":"tiles":n==="raster"?(r="tiles",l.tileSize=256):n==="image"&&(r="url",l.coordinates=c.coordinates),l[r]=d,c.sourceattribution&&(l.attribution=m(c.sourceattribution)),l}(s);o.addSource(this.idSource,a)}},f.findFollowingMapboxLayerId=function(s){if(s==="traces")for(var o=this.subplot.getMapLayers(),a=0;a<o.length;a++){var c=o[a].id;if(typeof c=="string"&&c.indexOf(p.traceLayerPrefix)===0){s=c;break}}return s},f.updateLayer=function(s){var o=this.subplot,a=i(s),c=this.lookupBelow(),r=this.findFollowingMapboxLayerId(c);this.removeLayer(),u(s)&&o.addLayer({id:this.idLayer,source:this.idSource,"source-layer":s.sourcelayer||"",type:s.type,minzoom:s.minzoom,maxzoom:s.maxzoom,layout:a.layout,paint:a.paint},r),this.layerType=s.type,this.below=c},f.updateStyle=function(s){if(u(s)){var o=i(s);this.subplot.setOptions(this.idLayer,"setLayoutProperty",o.layout),this.subplot.setOptions(this.idLayer,"setPaintProperty",o.paint)}},f.removeLayer=function(){var s=this.subplot.map;s.getLayer(this.idLayer)&&s.removeLayer(this.idLayer)},f.dispose=function(){var s=this.subplot.map;s.getLayer(this.idLayer)&&s.removeLayer(this.idLayer),s.getSource(this.idSource)&&s.removeSource(this.idSource)},N.exports=function(s,o,a){var c=new e(s,o);return c.update(a),c}},{"../../lib":787,"../../lib/svg_text_utils":813,"./constants":893,"./convert_text_opts":894}],897:[function(h,N,H){var t=h("../../lib"),m=h("../../components/color").defaultLine,g=h("../domain").attributes,p=h("../font_attributes"),e=h("../../traces/scatter/attributes").textposition,f=h("../../plot_api/edit_types").overrideAll,u=h("../../plot_api/plot_template").templatedArray,i=h("./constants"),s=p({});s.family.dflt="Open Sans Regular, Arial Unicode MS Regular",(N.exports=f({_arrayAttrRegexps:[t.counterRegex("mapbox",".layers",!0)],domain:g({name:"mapbox"}),accesstoken:{valType:"string",noBlank:!0,strict:!0},style:{valType:"any",values:i.styleValuesMapbox.concat(i.styleValuesNonMapbox),dflt:i.styleValueDflt},center:{lon:{valType:"number",dflt:0},lat:{valType:"number",dflt:0}},zoom:{valType:"number",dflt:1},bearing:{valType:"number",dflt:0},pitch:{valType:"number",dflt:0},layers:u("layer",{visible:{valType:"boolean",dflt:!0},sourcetype:{valType:"enumerated",values:["geojson","vector","raster","image"],dflt:"geojson"},source:{valType:"any"},sourcelayer:{valType:"string",dflt:""},sourceattribution:{valType:"string"},type:{valType:"enumerated",values:["circle","line","fill","symbol","raster"],dflt:"circle"},coordinates:{valType:"any"},below:{valType:"string"},color:{valType:"color",dflt:m},opacity:{valType:"number",min:0,max:1,dflt:1},minzoom:{valType:"number",min:0,max:24,dflt:0},maxzoom:{valType:"number",min:0,max:24,dflt:24},circle:{radius:{valType:"number",dflt:15}},line:{width:{valType:"number",dflt:2},dash:{valType:"data_array"}},fill:{outlinecolor:{valType:"color",dflt:m}},symbol:{icon:{valType:"string",dflt:"marker"},iconsize:{valType:"number",dflt:10},text:{valType:"string",dflt:""},placement:{valType:"enumerated",values:["point","line","line-center"],dflt:"point"},textfont:s,textposition:t.extendFlat({},e,{arrayOk:!1})}})},"plot","from-root")).uirevision={valType:"any",editType:"none"}},{"../../components/color":650,"../../lib":787,"../../plot_api/edit_types":820,"../../plot_api/plot_template":827,"../../traces/scatter/attributes":1202,"../domain":866,"../font_attributes":867,"./constants":893}],898:[function(h,N,H){var t=h("../../lib"),m=h("../subplot_defaults"),g=h("../array_container_defaults"),p=h("./layout_attributes");function e(u,i,s,o){s("accesstoken",o.accessToken),s("style"),s("center.lon"),s("center.lat"),s("zoom"),s("bearing"),s("pitch"),g(u,i,{name:"layers",handleItemDefaults:f}),i._input=u}function f(u,i){function s(n,d){return t.coerce(u,i,p.layers,n,d)}if(s("visible")){var o,a=s("sourcetype"),c=a==="raster"||a==="image";s("source"),s("sourceattribution"),a==="vector"&&s("sourcelayer"),a==="image"&&s("coordinates"),c&&(o="raster");var r=s("type",o);c&&r!=="raster"&&(r=i.type="raster",t.log("Source types *raster* and *image* must drawn *raster* layer type.")),s("below"),s("color"),s("opacity"),s("minzoom"),s("maxzoom"),r==="circle"&&s("circle.radius"),r==="line"&&(s("line.width"),s("line.dash")),r==="fill"&&s("fill.outlinecolor"),r==="symbol"&&(s("symbol.icon"),s("symbol.iconsize"),s("symbol.text"),t.coerceFont(s,"symbol.textfont"),s("symbol.textposition"),s("symbol.placement"))}}N.exports=function(u,i,s){m(u,i,s,{type:"mapbox",attributes:p,handleDefaults:e,partition:"y",accessToken:i._mapboxAccessToken})}},{"../../lib":787,"../array_container_defaults":833,"../subplot_defaults":909,"./layout_attributes":897}],899:[function(h,N,H){var t=h("mapbox-gl/dist/mapbox-gl-unminified"),m=h("../../lib"),g=h("../../lib/geo_location_utils"),p=h("../../registry"),e=h("../cartesian/axes"),f=h("../../components/dragelement"),u=h("../../components/fx"),i=h("../../components/dragelement/helpers"),s=i.rectMode,o=i.drawMode,a=i.selectMode,c=h("../cartesian/select").prepSelect,r=h("../cartesian/select").clearSelect,n=h("../cartesian/select").clearSelectionsCache,d=h("../cartesian/select").selectOnClick,l=h("./constants"),y=h("./layers");function v(w,L){this.id=L,this.gd=w;var k=w._fullLayout,C=w._context;this.container=k._glcontainer.node(),this.isStatic=C.staticPlot,this.uid=k._uid+"-"+this.id,this.div=null,this.xaxis=null,this.yaxis=null,this.createFramework(k),this.map=null,this.accessToken=null,this.styleObj=null,this.traceHash={},this.layerList=[],this.belowLookup={},this.dragging=!1,this.wheeling=!1}var _=v.prototype;_.plot=function(w,L,k){var C,M=this,P=L[M.id];M.map&&P.accesstoken!==M.accessToken&&(M.map.remove(),M.map=null,M.styleObj=null,M.traceHash={},M.layerList=[]),C=M.map?new Promise(function(O,F){M.updateMap(w,L,O,F)}):new Promise(function(O,F){M.createMap(w,L,O,F)}),k.push(C)},_.createMap=function(w,L,k,C){var M=this,P=L[M.id],O=M.styleObj=T(P.style);M.accessToken=P.accesstoken;var F=M.map=new t.Map({container:M.div,style:O.style,center:S(P.center),zoom:P.zoom,bearing:P.bearing,pitch:P.pitch,interactive:!M.isStatic,preserveDrawingBuffer:M.isStatic,doubleClickZoom:!1,boxZoom:!1,attributionControl:!1}).addControl(new t.AttributionControl({compact:!0}));F._canvas.style.left="0px",F._canvas.style.top="0px",M.rejectOnError(C),M.isStatic||M.initFx(w,L);var j=[];j.push(new Promise(function(W){F.once("load",W)})),j=j.concat(g.fetchTraceGeoData(w)),Promise.all(j).then(function(){M.fillBelowLookup(w,L),M.updateData(w),M.updateLayout(L),M.resolveOnRender(k)}).catch(C)},_.updateMap=function(w,L,k,C){var M=this,P=M.map,O=L[this.id];M.rejectOnError(C);var F=[],j=T(O.style);JSON.stringify(M.styleObj)!==JSON.stringify(j)&&(M.styleObj=j,P.setStyle(j.style),M.traceHash={},F.push(new Promise(function(W){P.once("styledata",W)}))),F=F.concat(g.fetchTraceGeoData(w)),Promise.all(F).then(function(){M.fillBelowLookup(w,L),M.updateData(w),M.updateLayout(L),M.resolveOnRender(k)}).catch(C)},_.fillBelowLookup=function(w,L){var k,C,M=L[this.id].layers,P=this.belowLookup={},O=!1;for(k=0;k<w.length;k++){var F=w[k][0].trace,j=F._module;typeof F.below=="string"?C=F.below:j.getBelow&&(C=j.getBelow(F,this)),C===""&&(O=!0),P["trace-"+F.uid]=C||""}for(k=0;k<M.length;k++){var W=M[k];C=typeof W.below=="string"?W.below:O?"traces":"",P["layout-"+k]=C}var Z,Q,X={};for(Z in P)X[C=P[Z]]?X[C].push(Z):X[C]=[Z];for(C in X){var G=X[C];if(G.length>1)for(k=0;k<G.length;k++)(Z=G[k]).indexOf("trace-")===0?(Q=Z.split("trace-")[1],this.traceHash[Q]&&(this.traceHash[Q].below=null)):Z.indexOf("layout-")===0&&(Q=Z.split("layout-")[1],this.layerList[Q]&&(this.layerList[Q].below=null))}};var x={choroplethmapbox:0,densitymapbox:1,scattermapbox:2};function T(w){var L={};return m.isPlainObject(w)?(L.id=w.id,L.style=w):typeof w=="string"?(L.id=w,l.styleValuesMapbox.indexOf(w)!==-1?L.style=A(w):l.stylesNonMapbox[w]?L.style=l.stylesNonMapbox[w]:L.style=w):(L.id=l.styleValueDflt,L.style=A(l.styleValueDflt)),L.transition={duration:0,delay:0},L}function A(w){return l.styleUrlPrefix+w+"-"+l.styleUrlSuffix}function S(w){return[w.lon,w.lat]}_.updateData=function(w){var L,k,C,M,P=this.traceHash,O=w.slice().sort(function(Q,X){return x[Q[0].trace.type]-x[X[0].trace.type]});for(C=0;C<O.length;C++){var F=O[C],j=!1;(L=P[(k=F[0].trace).uid])&&(L.type===k.type?(L.update(F),j=!0):L.dispose()),!j&&k._module&&(P[k.uid]=k._module.plot(this,F))}var W=Object.keys(P);e:for(C=0;C<W.length;C++){var Z=W[C];for(M=0;M<w.length;M++)if(Z===(k=w[M][0].trace).uid)continue e;(L=P[Z]).dispose(),delete P[Z]}},_.updateLayout=function(w){var L=this.map,k=w[this.id];this.dragging||this.wheeling||(L.setCenter(S(k.center)),L.setZoom(k.zoom),L.setBearing(k.bearing),L.setPitch(k.pitch)),this.updateLayers(w),this.updateFramework(w),this.updateFx(w),this.map.resize(),this.gd._context._scrollZoom.mapbox?L.scrollZoom.enable():L.scrollZoom.disable()},_.resolveOnRender=function(w){var L=this.map;L.on("render",function k(){L.loaded()&&(L.off("render",k),setTimeout(w,10))})},_.rejectOnError=function(w){var L=this.map;function k(){w(new Error(l.mapOnErrorMsg))}L.once("error",k),L.once("style.error",k),L.once("source.error",k),L.once("tile.error",k),L.once("layer.error",k)},_.createFramework=function(w){var L=this,k=L.div=document.createElement("div");k.id=L.uid,k.style.position="absolute",L.container.appendChild(k),L.xaxis={_id:"x",c2p:function(C){return L.project(C).x}},L.yaxis={_id:"y",c2p:function(C){return L.project(C).y}},L.updateFramework(w),L.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},e.setConvert(L.mockAxis,w)},_.initFx=function(w,L){var k=this,C=k.gd,M=k.map;function P(){u.loneUnhover(L._hoverlayer)}function O(){var F=k.getView();C.emit("plotly_relayouting",k.getViewEditsWithDerived(F))}M.on("moveend",function(F){if(k.map){var j=C._fullLayout;if(F.originalEvent||k.wheeling){var W=j[k.id];p.call("_storeDirectGUIEdit",C.layout,j._preGUI,k.getViewEdits(W));var Z=k.getView();W._input.center=W.center=Z.center,W._input.zoom=W.zoom=Z.zoom,W._input.bearing=W.bearing=Z.bearing,W._input.pitch=W.pitch=Z.pitch,C.emit("plotly_relayout",k.getViewEditsWithDerived(Z))}F.originalEvent&&F.originalEvent.type==="mouseup"?k.dragging=!1:k.wheeling&&(k.wheeling=!1),j._rehover&&j._rehover()}}),M.on("wheel",function(){k.wheeling=!0}),M.on("mousemove",function(F){var j=k.div.getBoundingClientRect(),W=[F.originalEvent.offsetX,F.originalEvent.offsetY];F.target.getBoundingClientRect=function(){return j},k.xaxis.p2c=function(){return M.unproject(W).lng},k.yaxis.p2c=function(){return M.unproject(W).lat},C._fullLayout._rehover=function(){C._fullLayout._hoversubplot===k.id&&C._fullLayout[k.id]&&u.hover(C,F,k.id)},u.hover(C,F,k.id),C._fullLayout._hoversubplot=k.id}),M.on("dragstart",function(){k.dragging=!0,P()}),M.on("zoomstart",P),M.on("mouseout",function(){C._fullLayout._hoversubplot=null}),M.on("drag",O),M.on("zoom",O),M.on("dblclick",function(){var F=C._fullLayout[k.id];p.call("_storeDirectGUIEdit",C.layout,C._fullLayout._preGUI,k.getViewEdits(F));var j=k.viewInitial;M.setCenter(S(j.center)),M.setZoom(j.zoom),M.setBearing(j.bearing),M.setPitch(j.pitch);var W=k.getView();F._input.center=F.center=W.center,F._input.zoom=F.zoom=W.zoom,F._input.bearing=F.bearing=W.bearing,F._input.pitch=F.pitch=W.pitch,C.emit("plotly_doubleclick",null),C.emit("plotly_relayout",k.getViewEditsWithDerived(W))}),k.clearSelect=function(){n(k.dragOptions),r(k.dragOptions.gd)},k.onClickInPanFn=function(F){return function(j){var W=C._fullLayout.clickmode;W.indexOf("select")>-1&&d(j.originalEvent,C,[k.xaxis],[k.yaxis],k.id,F),W.indexOf("event")>-1&&u.click(C,j.originalEvent)}}},_.updateFx=function(w){var L=this,k=L.map,C=L.gd;if(!L.isStatic){var M,P=w.dragmode;M=s(P)?function(j,W){(j.range={})[L.id]=[F([W.xmin,W.ymin]),F([W.xmax,W.ymax])]}:function(j,W,Z){(j.lassoPoints={})[L.id]=Z.filtered.map(F)};var O=L.dragOptions;L.dragOptions=m.extendDeep(O||{},{dragmode:w.dragmode,element:L.div,gd:C,plotinfo:{id:L.id,domain:w[L.id].domain,xaxis:L.xaxis,yaxis:L.yaxis,fillRangeItems:M},xaxes:[L.xaxis],yaxes:[L.yaxis],subplot:L.id}),k.off("click",L.onClickInPanHandler),a(P)||o(P)?(k.dragPan.disable(),k.on("zoomstart",L.clearSelect),L.dragOptions.prepFn=function(j,W,Z){c(j,W,Z,L.dragOptions,P)},f.init(L.dragOptions)):(k.dragPan.enable(),k.off("zoomstart",L.clearSelect),L.div.onmousedown=null,L.onClickInPanHandler=L.onClickInPanFn(L.dragOptions),k.on("click",L.onClickInPanHandler))}function F(j){var W=L.map.unproject(j);return[W.lng,W.lat]}},_.updateFramework=function(w){var L=w[this.id].domain,k=w._size,C=this.div.style;C.width=k.w*(L.x[1]-L.x[0])+"px",C.height=k.h*(L.y[1]-L.y[0])+"px",C.left=k.l+L.x[0]*k.w+"px",C.top=k.t+(1-L.y[1])*k.h+"px",this.xaxis._offset=k.l+L.x[0]*k.w,this.xaxis._length=k.w*(L.x[1]-L.x[0]),this.yaxis._offset=k.t+(1-L.y[1])*k.h,this.yaxis._length=k.h*(L.y[1]-L.y[0])},_.updateLayers=function(w){var L,k=w[this.id].layers,C=this.layerList;if(k.length!==C.length){for(L=0;L<C.length;L++)C[L].dispose();for(C=this.layerList=[],L=0;L<k.length;L++)C.push(y(this,L,k[L]))}else for(L=0;L<k.length;L++)C[L].update(k[L])},_.destroy=function(){this.map&&(this.map.remove(),this.map=null,this.container.removeChild(this.div))},_.toImage=function(){return this.map.stop(),this.map.getCanvas().toDataURL()},_.setOptions=function(w,L,k){for(var C in k)this.map[L](w,C,k[C])},_.getMapLayers=function(){return this.map.getStyle().layers},_.addLayer=function(w,L){var k=this.map;if(typeof L=="string"){if(L==="")return void k.addLayer(w,L);for(var C=this.getMapLayers(),M=0;M<C.length;M++)if(L===C[M].id)return void k.addLayer(w,L);m.warn(["Trying to add layer with *below* value",L,"referencing a layer that does not exist","or that does not yet exist."].join(" "))}k.addLayer(w)},_.project=function(w){return this.map.project(new t.LngLat(w[0],w[1]))},_.getView=function(){var w=this.map,L=w.getCenter(),k={lon:L.lng,lat:L.lat},C=w.getCanvas(),M=C.width,P=C.height;return{center:k,zoom:w.getZoom(),bearing:w.getBearing(),pitch:w.getPitch(),_derived:{coordinates:[w.unproject([0,0]).toArray(),w.unproject([M,0]).toArray(),w.unproject([M,P]).toArray(),w.unproject([0,P]).toArray()]}}},_.getViewEdits=function(w){for(var L=this.id,k=["center","zoom","bearing","pitch"],C={},M=0;M<k.length;M++){var P=k[M];C[L+"."+P]=w[P]}return C},_.getViewEditsWithDerived=function(w){var L=this.id,k=this.getViewEdits(w);return k[L+"._derived"]=w._derived,k},N.exports=v},{"../../components/dragelement":669,"../../components/dragelement/helpers":668,"../../components/fx":690,"../../lib":787,"../../lib/geo_location_utils":780,"../../registry":915,"../cartesian/axes":838,"../cartesian/select":858,"./constants":893,"./layers":896,"mapbox-gl/dist/mapbox-gl-unminified":451}],900:[function(h,N,H){N.exports=function(t){var m=t.editType;return{t:{valType:"number",dflt:0,editType:m},r:{valType:"number",dflt:0,editType:m},b:{valType:"number",dflt:0,editType:m},l:{valType:"number",dflt:0,editType:m},editType:m}}},{}],901:[function(h,N,H){var t=h("@plotly/d3"),m=h("d3-time-format").timeFormatLocale,g=h("d3-format").formatLocale,p=h("fast-isnumeric"),e=h("../registry"),f=h("../plot_api/plot_schema"),u=h("../plot_api/plot_template"),i=h("../lib"),s=h("../components/color"),o=h("../constants/numerical").BADNUM,a=h("./cartesian/axis_ids"),c=h("./cartesian/handle_outline").clearSelect,r=h("./animation_attributes"),n=h("./frame_attributes"),d=h("../plots/get_data").getModuleCalcData,l=i.relinkPrivateKeys,y=i._,v=N.exports={};i.extendFlat(v,e),v.attributes=h("./attributes"),v.attributes.type.values=v.allTypes,v.fontAttrs=h("./font_attributes"),v.layoutAttributes=h("./layout_attributes"),v.fontWeight="normal";var _=v.transformsRegistry,x=h("./command");v.executeAPICommand=x.executeAPICommand,v.computeAPICommandBindings=x.computeAPICommandBindings,v.manageCommandObserver=x.manageCommandObserver,v.hasSimpleAPICommandBindings=x.hasSimpleAPICommandBindings,v.redrawText=function(Z){return Z=i.getGraphDiv(Z),new Promise(function(Q){setTimeout(function(){Z._fullLayout&&(e.getComponentMethod("annotations","draw")(Z),e.getComponentMethod("legend","draw")(Z),e.getComponentMethod("colorbar","draw")(Z),Q(v.previousPromises(Z)))},300)})},v.resize=function(Z){var Q;Z=i.getGraphDiv(Z);var X=new Promise(function(G,Y){Z&&!i.isHidden(Z)||Y(new Error("Resize must be passed a displayed plot div element.")),Z._redrawTimer&&clearTimeout(Z._redrawTimer),Z._resolveResize&&(Q=Z._resolveResize),Z._resolveResize=G,Z._redrawTimer=setTimeout(function(){if(!Z.layout||Z.layout.width&&Z.layout.height||i.isHidden(Z))G(Z);else{delete Z.layout.width,delete Z.layout.height;var K=Z.changed;Z.autoplay=!0,e.call("relayout",Z,{autosize:!0}).then(function(){Z.changed=K,Z._resolveResize===G&&(delete Z._resolveResize,G(Z))})}},100)});return Q&&Q(X),X},v.previousPromises=function(Z){if((Z._promises||[]).length)return Promise.all(Z._promises).then(function(){Z._promises=[]})},v.addLinks=function(Z){if(Z._context.showLink||Z._context.showSources){var Q=Z._fullLayout,X=i.ensureSingle(Q._paper,"text","js-plot-link-container",function(q){q.style({"font-family":'"Open Sans", Arial, sans-serif',"font-size":"12px",fill:s.defaultLine,"pointer-events":"all"}).each(function(){var ee=t.select(this);ee.append("tspan").classed("js-link-to-tool",!0),ee.append("tspan").classed("js-link-spacer",!0),ee.append("tspan").classed("js-sourcelinks",!0)})}),G=X.node(),Y={y:Q._paper.attr("height")-9};document.body.contains(G)&&G.getComputedTextLength()>=Q.width-20?(Y["text-anchor"]="start",Y.x=5):(Y["text-anchor"]="end",Y.x=Q._paper.attr("width")-7),X.attr(Y);var K=X.select(".js-link-to-tool"),D=X.select(".js-link-spacer"),B=X.select(".js-sourcelinks");Z._context.showSources&&Z._context.showSources(Z),Z._context.showLink&&function(q,ee){ee.text("");var J=ee.append("a").attr({"xlink:xlink:href":"#",class:"link--impt link--embedview","font-weight":"bold"}).text(q._context.linkText+" "+String.fromCharCode(187));if(q._context.sendData)J.on("click",function(){v.sendDataToCloud(q)});else{var $=window.location.pathname.split("/"),te=window.location.search;J.attr({"xlink:xlink:show":"new","xlink:xlink:href":"/"+$[2].split(".")[0]+"/"+$[1]+te})}}(Z,K),D.text(K.text()&&B.text()?" - ":"")}},v.sendDataToCloud=function(Z){var Q=(window.PLOTLYENV||{}).BASE_URL||Z._context.plotlyServerURL;if(Q){Z.emit("plotly_beforeexport");var X=t.select(Z).append("div").attr("id","hiddenform").style("display","none"),G=X.append("form").attr({action:Q+"/external",method:"post",target:"_blank"});return G.append("input").attr({type:"text",name:"data"}).node().value=v.graphJson(Z,!1,"keepdata"),G.node().submit(),X.remove(),Z.emit("plotly_afterexport"),!1}};var T=["days","shortDays","months","shortMonths","periods","dateTime","date","time","decimal","thousands","grouping","currency"],A=["year","month","dayMonth","dayMonthYear"];function S(Z,Q){var X=Z._context.locale;X||(X="en-US");var G=!1,Y={};function K($){for(var te=!0,ie=0;ie<Q.length;ie++){var ae=Q[ie];Y[ae]||($[ae]?Y[ae]=$[ae]:te=!1)}te&&(G=!0)}for(var D=0;D<2;D++){for(var B=Z._context.locales,q=0;q<2;q++){var ee=(B[X]||{}).format;if(ee&&(K(ee),G))break;B=e.localeRegistry}var J=X.split("-")[0];if(G||J===X)break;X=J}return G||K(e.localeRegistry.en.format),Y}function w(Z,Q){var X={_fullLayout:Q},G=Z._id.charAt(0)==="x",Y=Z._mainAxis._anchorAxis,K="",D="",B="";if(Y&&(B=Y._mainAxis._id,K=G?Z._id+B:B+Z._id),!K||!Q._plots[K]){K="";for(var q=Z._counterAxes,ee=0;ee<q.length;ee++){var J=q[ee],$=G?Z._id+J:J+Z._id;D||(D=$);var te=a.getFromId(X,J);if(B&&te.overlaying===B){K=$;break}}}return K||D}function L(Z){var Q=Z.transforms;if(Array.isArray(Q)&&Q.length)for(var X=0;X<Q.length;X++){var G=Q[X],Y=G._module||_[G.type];if(Y&&Y.makesData)return!0}return!1}function k(Z,Q,X,G){for(var Y=Z.transforms,K=[Z],D=0;D<Y.length;D++){var B=Y[D],q=_[B.type];q&&q.transform&&(K=q.transform(K,{transform:B,fullTrace:Z,fullData:Q,layout:X,fullLayout:G,transformIndex:D}))}return K}function C(Z){return typeof Z=="string"&&Z.substr(Z.length-2)==="px"&&parseFloat(Z)}function M(Z){var Q=Z.margin;if(!Z._size){var X=Z._size={l:Math.round(Q.l),r:Math.round(Q.r),t:Math.round(Q.t),b:Math.round(Q.b),p:Math.round(Q.pad)};X.w=Math.round(Z.width)-X.l-X.r,X.h=Math.round(Z.height)-X.t-X.b}Z._pushmargin||(Z._pushmargin={}),Z._pushmarginIds||(Z._pushmarginIds={})}v.supplyDefaults=function(Z,Q){var X=Q&&Q.skipUpdateCalc,G=Z._fullLayout||{};if(G._skipDefaults)delete G._skipDefaults;else{var Y,K=Z._fullLayout={},D=Z.layout||{},B=Z._fullData||[],q=Z._fullData=[],ee=Z.data||[],J=Z.calcdata||[],$=Z._context||{};Z._transitionData||v.createTransitionData(Z),K._dfltTitle={plot:y(Z,"Click to enter Plot title"),x:y(Z,"Click to enter X axis title"),y:y(Z,"Click to enter Y axis title"),colorbar:y(Z,"Click to enter Colorscale title"),annotation:y(Z,"new text")},K._traceWord=y(Z,"trace");var te=S(Z,T);if(K._mapboxAccessToken=$.mapboxAccessToken,G._initialAutoSizeIsDone){var ie=G.width,ae=G.height;v.supplyLayoutGlobalDefaults(D,K,te),D.width||(K.width=ie),D.height||(K.height=ae),v.sanitizeMargins(K)}else{v.supplyLayoutGlobalDefaults(D,K,te);var he=!D.width||!D.height,se=K.autosize,de=$.autosizable;he&&(se||de)?v.plotAutoSize(Z,D,K):he&&v.sanitizeMargins(K),!se&&he&&(D.width=K.width,D.height=K.height)}K._d3locale=function(je,We){return je.decimal=We.charAt(0),je.thousands=We.charAt(1),{numberFormat:function(Ge){try{Ge=g(je).format(i.adjustFormat(Ge))}catch(Qe){return i.warnBadFormat(Ge),i.noFormat}return Ge},timeFormat:m(je).utcFormat}}(te,K.separators),K._extraFormat=S(Z,A),K._initialAutoSizeIsDone=!0,K._dataLength=ee.length,K._modules=[],K._visibleModules=[],K._basePlotModules=[];var ce=K._subplots=function(){var je,We,Ge=e.collectableSubplotTypes,Qe={};if(!Ge){Ge=[];var it=e.subplotsRegistry;for(var lt in it){var Lt=it[lt].attr;if(Lt&&(Ge.push(lt),Array.isArray(Lt)))for(We=0;We<Lt.length;We++)i.pushUnique(Ge,Lt[We])}}for(je=0;je<Ge.length;je++)Qe[Ge[je]]=[];return Qe}(),ve=K._splomAxes={x:{},y:{}},ke=K._splomSubplots={};K._splomGridDflt={},K._scatterStackOpts={},K._firstScatter={},K._alignmentOpts={},K._colorAxes={},K._requestRangeslider={},K._traceUids=function(je,We){var Ge,Qe,it=We.length,lt=[];for(Ge=0;Ge<je.length;Ge++){var Lt=je[Ge]._fullInput;Lt!==Qe&&lt.push(Lt),Qe=Lt}var wt=lt.length,rt=new Array(it),$e={};function xt(Ue,He){rt[He]=Ue,$e[Ue]=1}function Qt(Ue,He){if(Ue&&typeof Ue=="string"&&!$e[Ue])return xt(Ue,He),!0}for(Ge=0;Ge<it;Ge++){var $t=We[Ge].uid;typeof $t=="number"&&($t=String($t)),Qt($t,Ge)||Ge<wt&&Qt(lt[Ge].uid,Ge)||xt(i.randstr($e),Ge)}return rt}(B,ee),K._globalTransforms=(Z._context||{}).globalTransforms,v.supplyDataDefaults(ee,q,D,K);var Ee=Object.keys(ve.x),be=Object.keys(ve.y);if(Ee.length>1&&be.length>1){for(e.getComponentMethod("grid","sizeDefaults")(D,K),Y=0;Y<Ee.length;Y++)i.pushUnique(ce.xaxis,Ee[Y]);for(Y=0;Y<be.length;Y++)i.pushUnique(ce.yaxis,be[Y]);for(var xe in ke)i.pushUnique(ce.cartesian,xe)}if(K._has=v._hasPlotType.bind(K),B.length===q.length)for(Y=0;Y<q.length;Y++)l(q[Y],B[Y]);v.supplyLayoutModuleDefaults(D,K,q,Z._transitionData);var ue=K._visibleModules,me=[];for(Y=0;Y<ue.length;Y++){var we=ue[Y].crossTraceDefaults;we&&i.pushUnique(me,we)}for(Y=0;Y<me.length;Y++)me[Y](q,K);K._hasOnlyLargeSploms=K._basePlotModules.length===1&&K._basePlotModules[0].name==="splom"&&Ee.length>15&&be.length>15&&K.shapes.length===0&&K.images.length===0,v.linkSubplots(q,K,B,G),v.cleanPlot(q,K,B,G);var Me=!(!G._has||!G._has("gl2d")),Se=!(!K._has||!K._has("gl2d")),De=!(!G._has||!G._has("cartesian"))||Me,Fe=!(!K._has||!K._has("cartesian"))||Se;De&&!Fe?G._bgLayer.remove():Fe&&!De&&(K._shouldCreateBgLayer=!0),G._zoomlayer&&!Z._dragging&&c({_fullLayout:G}),function(je,We){var Ge,Qe=[];We.meta&&(Ge=We._meta={meta:We.meta,layout:{meta:We.meta}});for(var it=0;it<je.length;it++){var lt=je[it];lt.meta?Qe[lt.index]=lt._meta={meta:lt.meta}:We.meta&&(lt._meta={meta:We.meta}),We.meta&&(lt._meta.layout={meta:We.meta})}Qe.length&&(Ge||(Ge=We._meta={}),Ge.data=Qe)}(q,K),l(K,G),e.getComponentMethod("colorscale","crossTraceDefaults")(q,K),K._preGUI||(K._preGUI={}),K._tracePreGUI||(K._tracePreGUI={});var Ye,et=K._tracePreGUI,Oe={};for(Ye in et)Oe[Ye]="old";for(Y=0;Y<q.length;Y++)Oe[Ye=q[Y]._fullInput.uid]||(et[Ye]={}),Oe[Ye]="new";for(Ye in Oe)Oe[Ye]==="old"&&delete et[Ye];M(K),e.getComponentMethod("rangeslider","makeData")(K),X||J.length!==q.length||v.supplyDefaultsUpdateCalc(J,q)}},v.supplyDefaultsUpdateCalc=function(Z,Q){for(var X=0;X<Q.length;X++){var G=Q[X],Y=(Z[X]||[])[0];if(Y&&Y.trace){var K=Y.trace;if(K._hasCalcTransform){var D,B,q,ee=K._arrayAttrs;for(D=0;D<ee.length;D++)B=ee[D],q=i.nestedProperty(K,B).get().slice(),i.nestedProperty(G,B).set(q)}Y.trace=G}}},v.createTransitionData=function(Z){Z._transitionData||(Z._transitionData={}),Z._transitionData._frames||(Z._transitionData._frames=[]),Z._transitionData._frameHash||(Z._transitionData._frameHash={}),Z._transitionData._counter||(Z._transitionData._counter=0),Z._transitionData._interruptCallbacks||(Z._transitionData._interruptCallbacks=[])},v._hasPlotType=function(Z){var Q,X=this._basePlotModules||[];for(Q=0;Q<X.length;Q++)if(X[Q].name===Z)return!0;var G=this._modules||[];for(Q=0;Q<G.length;Q++){var Y=G[Q].name;if(Y===Z)return!0;var K=e.modules[Y];if(K&&K.categories[Z])return!0}return!1},v.cleanPlot=function(Z,Q,X,G){var Y,K,D=G._basePlotModules||[];for(Y=0;Y<D.length;Y++){var B=D[Y];B.clean&&B.clean(Z,Q,X,G)}var q=G._has&&G._has("gl"),ee=Q._has&&Q._has("gl");q&&!ee&&G._glcontainer!==void 0&&(G._glcontainer.selectAll(".gl-canvas").remove(),G._glcontainer.selectAll(".no-webgl").remove(),G._glcanvas=null);var J=!!G._infolayer;e:for(Y=0;Y<X.length;Y++){var $=X[Y].uid;for(K=0;K<Z.length;K++)if($===Z[K].uid)continue e;J&&G._infolayer.select(".cb"+$).remove()}},v.linkSubplots=function(Z,Q,X,G){var Y,K,D=G._plots||{},B=Q._plots={},q=Q._subplots,ee={_fullData:Z,_fullLayout:Q},J=q.cartesian.concat(q.gl2d||[]);for(Y=0;Y<J.length;Y++){var $,te=J[Y],ie=D[te],ae=a.getFromId(ee,te,"x"),he=a.getFromId(ee,te,"y");for(ie?$=B[te]=ie:($=B[te]={}).id=te,ae._counterAxes.push(he._id),he._counterAxes.push(ae._id),ae._subplotsWith.push(te),he._subplotsWith.push(te),$.xaxis=ae,$.yaxis=he,$._hasClipOnAxisFalse=!1,K=0;K<Z.length;K++){var se=Z[K];if(se.xaxis===$.xaxis._id&&se.yaxis===$.yaxis._id&&se.cliponaxis===!1){$._hasClipOnAxisFalse=!0;break}}}var de,ce=a.list(ee,null,!0);for(Y=0;Y<ce.length;Y++){var ve=null;(de=ce[Y]).overlaying&&(ve=a.getFromId(ee,de.overlaying))&&ve.overlaying&&(de.overlaying=!1,ve=null),de._mainAxis=ve||de,ve&&(de.domain=ve.domain.slice()),de._anchorAxis=de.anchor==="free"?null:a.getFromId(ee,de.anchor)}for(Y=0;Y<ce.length;Y++)if((de=ce[Y])._counterAxes.sort(a.idSort),de._subplotsWith.sort(i.subplotSort),de._mainSubplot=w(de,Q),de._counterAxes.length&&(de.spikemode&&de.spikemode.indexOf("across")!==-1||de.automargin&&de.mirror&&de.anchor!=="free"||e.getComponentMethod("rangeslider","isVisible")(de))){var ke=1,Ee=0;for(K=0;K<de._counterAxes.length;K++){var be=a.getFromId(ee,de._counterAxes[K]);ke=Math.min(ke,be.domain[0]),Ee=Math.max(Ee,be.domain[1])}ke<Ee&&(de._counterDomainMin=ke,de._counterDomainMax=Ee)}},v.clearExpandedTraceDefaultColors=function(Z){var Q,X,G;for(X=[],(Q=Z._module._colorAttrs)||(Z._module._colorAttrs=Q=[],f.crawl(Z._module.attributes,function(Y,K,D,B){X[B]=K,X.length=B+1,Y.valType==="color"&&Y.dflt===void 0&&Q.push(X.join("."))})),G=0;G<Q.length;G++)i.nestedProperty(Z,"_input."+Q[G]).get()||i.nestedProperty(Z,Q[G]).set(null)},v.supplyDataDefaults=function(Z,Q,X,G){var Y,K,D,B=G._modules,q=G._visibleModules,ee=G._basePlotModules,J=0,$=0;function te(xe){Q.push(xe);var ue=xe._module;ue&&(i.pushUnique(B,ue),xe.visible===!0&&i.pushUnique(q,ue),i.pushUnique(ee,xe._module.basePlotModule),J++,xe._input.visible!==!1&&$++)}G._transformModules=[];var ie={},ae=[],he=(X.template||{}).data||{},se=u.traceTemplater(he);for(Y=0;Y<Z.length;Y++){if(D=Z[Y],(K=se.newTrace(D)).uid=G._traceUids[Y],v.supplyTraceDefaults(D,K,$,G,Y),K.index=Y,K._input=D,K._expandedIndex=J,K.transforms&&K.transforms.length)for(var de=D.visible!==!1&&K.visible===!1,ce=k(K,Q,X,G),ve=0;ve<ce.length;ve++){var ke=ce[ve],Ee={_template:K._template,type:K.type,uid:K.uid+ve};de&&ke.visible===!1&&delete ke.visible,v.supplyTraceDefaults(ke,Ee,J,G,Y),l(Ee,ke),Ee.index=Y,Ee._input=D,Ee._fullInput=K,Ee._expandedIndex=J,Ee._expandedInput=ke,te(Ee)}else K._fullInput=K,K._expandedInput=K,te(K);e.traceIs(K,"carpetAxis")&&(ie[K.carpet]=K),e.traceIs(K,"carpetDependent")&&ae.push(Y)}for(Y=0;Y<ae.length;Y++)if((K=Q[ae[Y]]).visible){var be=ie[K.carpet];K._carpet=be,be&&be.visible?(K.xaxis=be.xaxis,K.yaxis=be.yaxis):K.visible=!1}},v.supplyAnimationDefaults=function(Z){var Q;Z=Z||{};var X={};function G(Y,K){return i.coerce(Z||{},X,r,Y,K)}if(G("mode"),G("direction"),G("fromcurrent"),Array.isArray(Z.frame))for(X.frame=[],Q=0;Q<Z.frame.length;Q++)X.frame[Q]=v.supplyAnimationFrameDefaults(Z.frame[Q]||{});else X.frame=v.supplyAnimationFrameDefaults(Z.frame||{});if(Array.isArray(Z.transition))for(X.transition=[],Q=0;Q<Z.transition.length;Q++)X.transition[Q]=v.supplyAnimationTransitionDefaults(Z.transition[Q]||{});else X.transition=v.supplyAnimationTransitionDefaults(Z.transition||{});return X},v.supplyAnimationFrameDefaults=function(Z){var Q={};function X(G,Y){return i.coerce(Z||{},Q,r.frame,G,Y)}return X("duration"),X("redraw"),Q},v.supplyAnimationTransitionDefaults=function(Z){var Q={};function X(G,Y){return i.coerce(Z||{},Q,r.transition,G,Y)}return X("duration"),X("easing"),Q},v.supplyFrameDefaults=function(Z){var Q={};function X(G,Y){return i.coerce(Z,Q,n,G,Y)}return X("group"),X("name"),X("traces"),X("baseframe"),X("data"),X("layout"),Q},v.supplyTraceDefaults=function(Z,Q,X,G,Y){var K,D=G.colorway||s.defaults,B=D[X%D.length];function q(ce,ve){return i.coerce(Z,Q,v.attributes,ce,ve)}var ee=q("visible");q("type"),q("name",G._traceWord+" "+Y),q("uirevision",G.uirevision);var J=v.getModule(Q);if(Q._module=J,J){var $=J.basePlotModule,te=$.attr,ie=$.attributes;if(te&&ie){var ae=G._subplots,he="";if(ee||$.name!=="gl2d"){if(Array.isArray(te))for(K=0;K<te.length;K++){var se=te[K],de=i.coerce(Z,Q,ie,se);ae[se]&&i.pushUnique(ae[se],de),he+=de}else he=i.coerce(Z,Q,ie,te);ae[$.name]&&i.pushUnique(ae[$.name],he)}}}return ee&&(q("customdata"),q("ids"),q("meta"),e.traceIs(Q,"showLegend")?(i.coerce(Z,Q,J.attributes.showlegend?J.attributes:v.attributes,"showlegend"),q("legendgroup"),q("legendgrouptitle.text")&&i.coerceFont(q,"legendgrouptitle.font",i.extendFlat({},G.font,{size:Math.round(1.1*G.font.size)})),q("legendrank"),Q._dfltShowLegend=!0):Q._dfltShowLegend=!1,J&&J.supplyDefaults(Z,Q,B,G),e.traceIs(Q,"noOpacity")||q("opacity"),e.traceIs(Q,"notLegendIsolatable")&&(Q.visible=!!Q.visible),e.traceIs(Q,"noHover")||(Q.hovertemplate||i.coerceHoverinfo(Z,Q,G),Q.type!=="parcats"&&e.getComponentMethod("fx","supplyDefaults")(Z,Q,B,G)),J&&J.selectPoints&&q("selectedpoints"),v.supplyTransformDefaults(Z,Q,G)),Q},v.hasMakesDataTransform=L,v.supplyTransformDefaults=function(Z,Q,X){if(Q._length||L(Z)){var G=X._globalTransforms||[],Y=X._transformModules||[];if(Array.isArray(Z.transforms)||G.length!==0)for(var K=Z.transforms||[],D=G.concat(K),B=Q.transforms=[],q=0;q<D.length;q++){var ee,J=D[q],$=J.type,te=_[$],ie=!(J._module&&J._module===te),ae=te&&typeof te.transform=="function";te||i.warn("Unrecognized transform type "+$+"."),te&&te.supplyDefaults&&(ie||ae)?((ee=te.supplyDefaults(J,Q,X,Z)).type=$,ee._module=te,i.pushUnique(Y,te)):ee=i.extendFlat({},J),B.push(ee)}}},v.supplyLayoutGlobalDefaults=function(Z,Q,X){function G(B,q){return i.coerce(Z,Q,v.layoutAttributes,B,q)}var Y=Z.template;i.isPlainObject(Y)&&(Q.template=Y,Q._template=Y.layout,Q._dataTemplate=Y.data),G("autotypenumbers");var K=i.coerceFont(G,"font");G("title.text",Q._dfltTitle.plot),i.coerceFont(G,"title.font",{family:K.family,size:Math.round(1.4*K.size),color:K.color}),G("title.xref"),G("title.yref"),G("title.x"),G("title.y"),G("title.xanchor"),G("title.yanchor"),G("title.pad.t"),G("title.pad.r"),G("title.pad.b"),G("title.pad.l"),G("uniformtext.mode")&&G("uniformtext.minsize"),G("autosize",!(Z.width&&Z.height)),G("width"),G("height"),G("margin.l"),G("margin.r"),G("margin.t"),G("margin.b"),G("margin.pad"),G("margin.autoexpand"),Z.width&&Z.height&&v.sanitizeMargins(Q),e.getComponentMethod("grid","sizeDefaults")(Z,Q),G("paper_bgcolor"),G("separators",X.decimal+X.thousands),G("hidesources"),G("colorway"),G("datarevision");var D=G("uirevision");G("editrevision",D),G("selectionrevision",D),e.getComponentMethod("modebar","supplyLayoutDefaults")(Z,Q),e.getComponentMethod("shapes","supplyDrawNewShapeDefaults")(Z,Q,G),G("meta"),i.isPlainObject(Z.transition)&&(G("transition.duration"),G("transition.easing"),G("transition.ordering")),e.getComponentMethod("calendars","handleDefaults")(Z,Q,"calendar"),e.getComponentMethod("fx","supplyLayoutGlobalDefaults")(Z,Q,G)},v.plotAutoSize=function(Z,Q,X){var G,Y,K=Z._context||{},D=K.frameMargins,B=i.isPlotDiv(Z);if(B&&Z.emit("plotly_autosize"),K.fillFrame)G=window.innerWidth,Y=window.innerHeight,document.body.style.overflow="hidden";else{var q=B?window.getComputedStyle(Z):{};if(G=C(q.width)||C(q.maxWidth)||X.width,Y=C(q.height)||C(q.maxHeight)||X.height,p(D)&&D>0){var ee=1-2*D;G=Math.round(ee*G),Y=Math.round(ee*Y)}}var J=v.layoutAttributes.width.min,$=v.layoutAttributes.height.min;G<J&&(G=J),Y<$&&(Y=$);var te=!Q.width&&Math.abs(X.width-G)>1,ie=!Q.height&&Math.abs(X.height-Y)>1;(ie||te)&&(te&&(X.width=G),ie&&(X.height=Y)),Z._initialAutoSize||(Z._initialAutoSize={width:G,height:Y}),v.sanitizeMargins(X)},v.supplyLayoutModuleDefaults=function(Z,Q,X,G){var Y,K,D,B=e.componentsRegistry,q=Q._basePlotModules,ee=e.subplotsRegistry.cartesian;for(Y in B)(D=B[Y]).includeBasePlot&&D.includeBasePlot(Z,Q);for(var J in q.length||q.push(ee),Q._has("cartesian")&&(e.getComponentMethod("grid","contentDefaults")(Z,Q),ee.finalizeSubplots(Z,Q)),Q._subplots)Q._subplots[J].sort(i.subplotSort);for(K=0;K<q.length;K++)(D=q[K]).supplyLayoutDefaults&&D.supplyLayoutDefaults(Z,Q,X);var $=Q._modules;for(K=0;K<$.length;K++)(D=$[K]).supplyLayoutDefaults&&D.supplyLayoutDefaults(Z,Q,X);var te=Q._transformModules;for(K=0;K<te.length;K++)(D=te[K]).supplyLayoutDefaults&&D.supplyLayoutDefaults(Z,Q,X,G);for(Y in B)(D=B[Y]).supplyLayoutDefaults&&D.supplyLayoutDefaults(Z,Q,X)},v.purge=function(Z){var Q=Z._fullLayout||{};Q._glcontainer!==void 0&&(Q._glcontainer.selectAll(".gl-canvas").remove(),Q._glcontainer.remove(),Q._glcanvas=null),Q._modeBar&&Q._modeBar.destroy(),Z._transitionData&&(Z._transitionData._interruptCallbacks&&(Z._transitionData._interruptCallbacks.length=0),Z._transitionData._animationRaf&&window.cancelAnimationFrame(Z._transitionData._animationRaf)),i.clearThrottle(),i.clearResponsive(Z),delete Z.data,delete Z.layout,delete Z._fullData,delete Z._fullLayout,delete Z.calcdata,delete Z.empty,delete Z.fid,delete Z.undoqueue,delete Z.undonum,delete Z.autoplay,delete Z.changed,delete Z._promises,delete Z._redrawTimer,delete Z._hmlumcount,delete Z._hmpixcount,delete Z._transitionData,delete Z._transitioning,delete Z._initialAutoSize,delete Z._transitioningWithDuration,delete Z._dragging,delete Z._dragged,delete Z._dragdata,delete Z._hoverdata,delete Z._snapshotInProgress,delete Z._editing,delete Z._mouseDownTime,delete Z._legendMouseDownTime,Z.removeAllListeners&&Z.removeAllListeners()},v.style=function(Z){var Q,X=Z._fullLayout._visibleModules,G=[];for(Q=0;Q<X.length;Q++){var Y=X[Q];Y.style&&i.pushUnique(G,Y.style)}for(Q=0;Q<G.length;Q++)G[Q](Z)},v.sanitizeMargins=function(Z){if(Z&&Z.margin){var Q,X=Z.width,G=Z.height,Y=Z.margin,K=X-(Y.l+Y.r),D=G-(Y.t+Y.b);K<0&&(Q=(X-1)/(Y.l+Y.r),Y.l=Math.floor(Q*Y.l),Y.r=Math.floor(Q*Y.r)),D<0&&(Q=(G-1)/(Y.t+Y.b),Y.t=Math.floor(Q*Y.t),Y.b=Math.floor(Q*Y.b))}},v.clearAutoMarginIds=function(Z){Z._fullLayout._pushmarginIds={}},v.allowAutoMargin=function(Z,Q){Z._fullLayout._pushmarginIds[Q]=1},v.autoMargin=function(Z,Q,X){var G=Z._fullLayout,Y=G.width,K=G.height,D=G.margin,B=i.constrain(Y-D.l-D.r,2,64),q=i.constrain(K-D.t-D.b,2,64),ee=Math.max(0,Y-B),J=Math.max(0,K-q),$=G._pushmargin,te=G._pushmarginIds;if(D.autoexpand!==!1){if(X){var ie=X.pad;if(ie===void 0&&(ie=Math.min(12,D.l,D.r,D.t,D.b)),ee){var ae=(X.l+X.r)/ee;ae>1&&(X.l/=ae,X.r/=ae)}if(J){var he=(X.t+X.b)/J;he>1&&(X.t/=he,X.b/=he)}var se=X.xl!==void 0?X.xl:X.x,de=X.xr!==void 0?X.xr:X.x,ce=X.yt!==void 0?X.yt:X.y,ve=X.yb!==void 0?X.yb:X.y;$[Q]={l:{val:se,size:X.l+ie},r:{val:de,size:X.r+ie},b:{val:ve,size:X.b+ie},t:{val:ce,size:X.t+ie}},te[Q]=1}else delete $[Q],delete te[Q];if(!G._replotting)return v.doAutoMargin(Z)}},v.doAutoMargin=function(Z){var Q=Z._fullLayout,X=Q.width,G=Q.height;Q._size||(Q._size={}),M(Q);var Y=Q._size,K=Q.margin,D=i.extendFlat({},Y),B=K.l,q=K.r,ee=K.t,J=K.b,$=Q._pushmargin,te=Q._pushmarginIds;if(Q.margin.autoexpand!==!1){for(var ie in $)te[ie]||delete $[ie];for(var ae in $.base={l:{val:0,size:B},r:{val:1,size:q},t:{val:1,size:ee},b:{val:0,size:J}},$){var he=$[ae].l||{},se=$[ae].b||{},de=he.val,ce=he.size,ve=se.val,ke=se.size;for(var Ee in $){if(p(ce)&&$[Ee].r){var be=$[Ee].r.val,xe=$[Ee].r.size;if(be>de){var ue=(ce*be+(xe-X)*de)/(be-de),me=(xe*(1-de)+(ce-X)*(1-be))/(be-de);ue+me>B+q&&(B=ue,q=me)}}if(p(ke)&&$[Ee].t){var we=$[Ee].t.val,Me=$[Ee].t.size;if(we>ve){var Se=(ke*we+(Me-G)*ve)/(we-ve),De=(Me*(1-ve)+(ke-G)*(1-we))/(we-ve);Se+De>J+ee&&(J=Se,ee=De)}}}}}var Fe=i.constrain(X-K.l-K.r,2,64),Ye=i.constrain(G-K.t-K.b,2,64),et=Math.max(0,X-Fe),Oe=Math.max(0,G-Ye);if(et){var je=(B+q)/et;je>1&&(B/=je,q/=je)}if(Oe){var We=(J+ee)/Oe;We>1&&(J/=We,ee/=We)}if(Y.l=Math.round(B),Y.r=Math.round(q),Y.t=Math.round(ee),Y.b=Math.round(J),Y.p=Math.round(K.pad),Y.w=Math.round(X)-Y.l-Y.r,Y.h=Math.round(G)-Y.t-Y.b,!Q._replotting&&v.didMarginChange(D,Y)){"_redrawFromAutoMarginCount"in Q?Q._redrawFromAutoMarginCount++:Q._redrawFromAutoMarginCount=1;var Ge=3*(1+Object.keys(te).length);if(Q._redrawFromAutoMarginCount<Ge)return e.call("_doPlot",Z);Q._size=D,i.warn("Too many auto-margin redraws.")}(function(Qe){var it=a.list(Qe,"",!0);["_adjustTickLabelsOverflow","_hideCounterAxisInsideTickLabels"].forEach(function(lt){for(var Lt=0;Lt<it.length;Lt++){var wt=it[Lt][lt];wt&&wt()}})})(Z)};var P=["l","r","t","b","p","w","h"];function O(Z,Q,X){var G=!1,Y=[v.previousPromises,function(){if(Z._transitionData)return Z._transitioning=!1,function(D){var B=Promise.resolve();if(!D)return B;for(;D.length;)B=B.then(D.shift());return B}(Z._transitionData._interruptCallbacks)},X.prepareFn,v.rehover,function(){return Z.emit("plotly_transitioning",[]),new Promise(function(D){Z._transitioning=!0,Q.duration>0&&(Z._transitioningWithDuration=!0),Z._transitionData._interruptCallbacks.push(function(){G=!0}),X.redraw&&Z._transitionData._interruptCallbacks.push(function(){return e.call("redraw",Z)}),Z._transitionData._interruptCallbacks.push(function(){Z.emit("plotly_transitioninterrupted",[])});var B=0,q=0;function ee(){return B++,function(){q++,G||q!==B||function(J){!Z._transitionData||(function($){if($)for(;$.length;)$.shift()}(Z._transitionData._interruptCallbacks),Promise.resolve().then(function(){if(X.redraw)return e.call("redraw",Z)}).then(function(){Z._transitioning=!1,Z._transitioningWithDuration=!1,Z.emit("plotly_transitioned",[])}).then(J))}(D)}}X.runFn(ee),setTimeout(ee())})}],K=i.syncOrAsync(Y,Z);return K&&K.then||(K=Promise.resolve()),K.then(function(){return Z})}v.didMarginChange=function(Z,Q){for(var X=0;X<P.length;X++){var G=P[X],Y=Z[G],K=Q[G];if(!p(Y)||Math.abs(K-Y)>1)return!0}return!1},v.graphJson=function(Z,Q,X,G,Y,K){(Y&&Q&&!Z._fullData||Y&&!Q&&!Z._fullLayout)&&v.supplyDefaults(Z);var D=Y?Z._fullData:Z.data,B=Y?Z._fullLayout:Z.layout,q=(Z._transitionData||{})._frames;function ee(te,ie){if(typeof te=="function")return ie?"_function_":null;if(i.isPlainObject(te)){var ae,he={};return Object.keys(te).sort().forEach(function(se){if(["_","["].indexOf(se.charAt(0))===-1)if(typeof te[se]!="function"){if(X==="keepdata"){if(se.substr(se.length-3)==="src")return}else if(X==="keepstream"){if(typeof(ae=te[se+"src"])=="string"&&ae.indexOf(":")>0&&!i.isPlainObject(te.stream))return}else if(X!=="keepall"&&typeof(ae=te[se+"src"])=="string"&&ae.indexOf(":")>0)return;he[se]=ee(te[se],ie)}else ie&&(he[se]="_function")}),he}return Array.isArray(te)?te.map(function(se){return ee(se,ie)}):i.isTypedArray(te)?i.simpleMap(te,i.identity):i.isJSDate(te)?i.ms2DateTimeLocal(+te):te}var J={data:(D||[]).map(function(te){var ie=ee(te);return Q&&delete ie.fit,ie})};if(!Q&&(J.layout=ee(B),Y)){var $=B._size;J.layout.computed={margin:{b:$.b,l:$.l,r:$.r,t:$.t}}}return q&&(J.frames=ee(q)),K&&(J.config=ee(Z._context,!0)),G==="object"?J:JSON.stringify(J)},v.modifyFrames=function(Z,Q){var X,G,Y,K=Z._transitionData._frames,D=Z._transitionData._frameHash;for(X=0;X<Q.length;X++)switch((G=Q[X]).type){case"replace":Y=G.value;var B=(K[G.index]||{}).name,q=Y.name;K[G.index]=D[q]=Y,q!==B&&(delete D[B],D[q]=Y);break;case"insert":D[(Y=G.value).name]=Y,K.splice(G.index,0,Y);break;case"delete":delete D[(Y=K[G.index]).name],K.splice(G.index,1)}return Promise.resolve()},v.computeFrame=function(Z,Q){var X,G,Y,K,D=Z._transitionData._frameHash;if(!Q)throw new Error("computeFrame must be given a string frame name");var B=D[Q.toString()];if(!B)return!1;for(var q=[B],ee=[B.name];B.baseframe&&(B=D[B.baseframe.toString()])&&ee.indexOf(B.name)===-1;)q.push(B),ee.push(B.name);for(var J={};B=q.pop();)if(B.layout&&(J.layout=v.extendLayout(J.layout,B.layout)),B.data){if(J.data||(J.data=[]),!(G=B.traces))for(G=[],X=0;X<B.data.length;X++)G[X]=X;for(J.traces||(J.traces=[]),X=0;X<B.data.length;X++)(Y=G[X])!=null&&((K=J.traces.indexOf(Y))===-1&&(K=J.data.length,J.traces[K]=Y),J.data[K]=v.extendTrace(J.data[K],B.data[X]))}return J},v.recomputeFrameHash=function(Z){for(var Q=Z._transitionData._frameHash={},X=Z._transitionData._frames,G=0;G<X.length;G++){var Y=X[G];Y&&Y.name&&(Q[Y.name]=Y)}},v.extendObjectWithContainers=function(Z,Q,X){var G,Y,K,D,B,q,ee,J=i.extendDeepNoArrays({},Q||{}),$=i.expandObjectPaths(J),te={};if(X&&X.length)for(K=0;K<X.length;K++)(Y=(G=i.nestedProperty($,X[K])).get())===void 0?i.nestedProperty(te,X[K]).set(null):(G.set(null),i.nestedProperty(te,X[K]).set(Y));if(Z=i.extendDeepNoArrays(Z||{},$),X&&X.length){for(K=0;K<X.length;K++)if(q=i.nestedProperty(te,X[K]).get()){for(ee=(B=i.nestedProperty(Z,X[K])).get(),Array.isArray(ee)||(ee=[],B.set(ee)),D=0;D<q.length;D++){var ie=q[D];ee[D]=ie===null?null:v.extendObjectWithContainers(ee[D],ie)}B.set(ee)}}return Z},v.dataArrayContainers=["transforms","dimensions"],v.layoutArrayContainers=e.layoutArrayContainers,v.extendTrace=function(Z,Q){return v.extendObjectWithContainers(Z,Q,v.dataArrayContainers)},v.extendLayout=function(Z,Q){return v.extendObjectWithContainers(Z,Q,v.layoutArrayContainers)},v.transition=function(Z,Q,X,G,Y,K){var D={redraw:Y.redraw},B={},q=[];return D.prepareFn=function(){for(var ee=Array.isArray(Q)?Q.length:0,J=G.slice(0,ee),$=0;$<J.length;$++){var te=J[$],ie=Z._fullData[te]._module;if(ie){if(ie.animatable){var ae=ie.basePlotModule.name;B[ae]||(B[ae]=[]),B[ae].push(te)}Z.data[J[$]]=v.extendTrace(Z.data[J[$]],Q[$])}}var he=i.expandObjectPaths(i.extendDeepNoArrays({},X)),se=/^[xy]axis[0-9]*$/;for(var de in he)se.test(de)&&delete he[de].range;v.extendLayout(Z.layout,he),delete Z.calcdata,v.supplyDefaults(Z),v.doCalcdata(Z);var ce=i.expandObjectPaths(X);if(ce){var ve=Z._fullLayout._plots;for(var ke in ve){var Ee=ve[ke],be=Ee.xaxis,xe=Ee.yaxis,ue=be.range.slice(),me=xe.range.slice(),we=null,Me=null,Se=null,De=null;Array.isArray(ce[be._name+".range"])?we=ce[be._name+".range"].slice():Array.isArray((ce[be._name]||{}).range)&&(we=ce[be._name].range.slice()),Array.isArray(ce[xe._name+".range"])?Me=ce[xe._name+".range"].slice():Array.isArray((ce[xe._name]||{}).range)&&(Me=ce[xe._name].range.slice()),ue&&we&&(be.r2l(ue[0])!==be.r2l(we[0])||be.r2l(ue[1])!==be.r2l(we[1]))&&(Se={xr0:ue,xr1:we}),me&&Me&&(xe.r2l(me[0])!==xe.r2l(Me[0])||xe.r2l(me[1])!==xe.r2l(Me[1]))&&(De={yr0:me,yr1:Me}),(Se||De)&&q.push(i.extendFlat({plotinfo:Ee},Se,De))}}return Promise.resolve()},D.runFn=function(ee){var J,$,te=Z._fullLayout._basePlotModules,ie=q.length;if(X)for($=0;$<te.length;$++)te[$].transitionAxes&&te[$].transitionAxes(Z,q,K,ee);for(var ae in ie?((J=i.extendFlat({},K)).duration=0,delete B.cartesian):J=K,B){var he=B[ae];Z._fullData[he[0]]._module.basePlotModule.plot(Z,he,J,ee)}},O(Z,K,D)},v.transitionFromReact=function(Z,Q,X,G){var Y=Z._fullLayout,K=Y.transition,D={},B=[];return D.prepareFn=function(){var q=Y._plots;for(var ee in D.redraw=!1,Q.anim==="some"&&(D.redraw=!0),X.anim==="some"&&(D.redraw=!0),q){var J=q[ee],$=J.xaxis,te=J.yaxis,ie=G[$._name].range.slice(),ae=G[te._name].range.slice(),he=$.range.slice(),se=te.range.slice();$.setScale(),te.setScale();var de=null,ce=null;$.r2l(ie[0])===$.r2l(he[0])&&$.r2l(ie[1])===$.r2l(he[1])||(de={xr0:ie,xr1:he}),te.r2l(ae[0])===te.r2l(se[0])&&te.r2l(ae[1])===te.r2l(se[1])||(ce={yr0:ae,yr1:se}),(de||ce)&&B.push(i.extendFlat({plotinfo:J},de,ce))}return Promise.resolve()},D.runFn=function(q){for(var ee,J,$,te=Z._fullData,ie=Z._fullLayout._basePlotModules,ae=[],he=0;he<te.length;he++)ae.push(he);function se(){if(Z._fullLayout)for(var ce=0;ce<ie.length;ce++)ie[ce].transitionAxes&&ie[ce].transitionAxes(Z,B,ee,q)}function de(){if(Z._fullLayout)for(var ce=0;ce<ie.length;ce++)ie[ce].plot(Z,$,J,q)}B.length&&Q.anim?K.ordering==="traces first"?(ee=i.extendFlat({},K,{duration:0}),$=ae,J=K,setTimeout(se,K.duration),de()):(ee=K,$=null,J=i.extendFlat({},K,{duration:0}),setTimeout(de,ee.duration),se()):B.length?(ee=K,se()):Q.anim&&($=ae,J=K,de())},O(Z,K,D)},v.doCalcdata=function(Z,Q){var X,G,Y,K,D=a.list(Z),B=Z._fullData,q=Z._fullLayout,ee=new Array(B.length),J=(Z.calcdata||[]).slice();for(Z.calcdata=ee,q._numBoxes=0,q._numViolins=0,q._violinScaleGroupStats={},Z._hmpixcount=0,Z._hmlumcount=0,q._piecolormap={},q._sunburstcolormap={},q._treemapcolormap={},q._iciclecolormap={},q._funnelareacolormap={},Y=0;Y<B.length;Y++)Array.isArray(Q)&&Q.indexOf(Y)===-1&&(ee[Y]=J[Y]);for(Y=0;Y<B.length;Y++)(X=B[Y])._arrayAttrs=f.findArrayAttributes(X),X._extremes={};var $=q._subplots.polar||[];for(Y=0;Y<$.length;Y++)D.push(q[$[Y]].radialaxis,q[$[Y]].angularaxis);for(var te in q._colorAxes){var ie=q[te];ie.cauto!==!1&&(delete ie.cmin,delete ie.cmax)}var ae=!1;function he(ce){if(X=B[ce],G=X._module,X.visible===!0&&X.transforms){if(G&&G.calc){var ve=G.calc(Z,X);ve[0]&&ve[0].t&&ve[0].t._scene&&delete ve[0].t._scene.dirty}for(K=0;K<X.transforms.length;K++){var ke=X.transforms[K];(G=_[ke.type])&&G.calcTransform&&(X._hasCalcTransform=!0,ae=!0,G.calcTransform(Z,X,ke))}}}function se(ce,ve){if(X=B[ce],!!(G=X._module).isContainer===ve){var ke=[];if(X.visible===!0&&X._length!==0){delete X._indexToPoints;var Ee=X.transforms||[];for(K=Ee.length-1;K>=0;K--)if(Ee[K].enabled){X._indexToPoints=Ee[K]._indexToPoints;break}G&&G.calc&&(ke=G.calc(Z,X))}Array.isArray(ke)&&ke[0]||(ke=[{x:o,y:o}]),ke[0].t||(ke[0].t={}),ke[0].trace=X,ee[ce]=ke}}for(j(D,B,q),Y=0;Y<B.length;Y++)se(Y,!0);for(Y=0;Y<B.length;Y++)he(Y);for(ae&&j(D,B,q),Y=0;Y<B.length;Y++)se(Y,!0);for(Y=0;Y<B.length;Y++)se(Y,!1);W(Z);var de=function(ce,ve){var ke,Ee,be,xe,ue,me=[];function we(Je,_e,Le){var Ce=_e._id.charAt(0);if(Je==="histogram2dcontour"){var Pe=_e._counterAxes[0],Xe=a.getFromId(ve,Pe),ut=Ce==="x"||Pe==="x"&&Xe.type==="category",kt=Ce==="y"||Pe==="y"&&Xe.type==="category";return function(ft,Et){return ft===0||Et===0||ut&&ft===Le[Et].length-1||kt&&Et===Le.length-1?-1:(Ce==="y"?Et:ft)-1}}return function(ft,Et){return Ce==="y"?Et:ft}}var Me={min:function(Je){return i.aggNums(Math.min,null,Je)},max:function(Je){return i.aggNums(Math.max,null,Je)},sum:function(Je){return i.aggNums(function(_e,Le){return _e+Le},null,Je)},total:function(Je){return i.aggNums(function(_e,Le){return _e+Le},null,Je)},mean:function(Je){return i.mean(Je)},median:function(Je){return i.median(Je)}};for(ke=0;ke<ce.length;ke++){var Se=ce[ke];if(Se.type==="category"){var De=Se.categoryorder.match(F);if(De){var Fe=De[1],Ye=De[2],et=Se._id.charAt(0),Oe=et==="x",je=[];for(Ee=0;Ee<Se._categories.length;Ee++)je.push([Se._categories[Ee],[]]);for(Ee=0;Ee<Se._traceIndices.length;Ee++){var We=Se._traceIndices[Ee],Ge=ve._fullData[We];if(Ge.visible===!0){var Qe=Ge.type;e.traceIs(Ge,"histogram")&&(delete Ge._xautoBinFinished,delete Ge._yautoBinFinished);var it=Qe==="splom",lt=Qe==="scattergl",Lt=ve.calcdata[We];for(be=0;be<Lt.length;be++){var wt,rt,$e=Lt[be];if(it){var xt=Ge._axesDim[Se._id];if(!Oe){var Qt=Ge._diag[xt][0];Qt&&(Se=ve._fullLayout[a.id2name(Qt)])}var $t=$e.trace.dimensions[xt].values;for(xe=0;xe<$t.length;xe++)for(wt=Se._categoriesMap[$t[xe]],ue=0;ue<$e.trace.dimensions.length;ue++)if(ue!==xt){var Ue=$e.trace.dimensions[ue];je[wt][1].push(Ue.values[xe])}}else if(lt){for(xe=0;xe<$e.t.x.length;xe++)Oe?(wt=$e.t.x[xe],rt=$e.t.y[xe]):(wt=$e.t.y[xe],rt=$e.t.x[xe]),je[wt][1].push(rt);$e.t&&$e.t._scene&&delete $e.t._scene.dirty}else if($e.hasOwnProperty("z")){rt=$e.z;var He=we(Ge.type,Se,rt);for(xe=0;xe<rt.length;xe++)for(ue=0;ue<rt[xe].length;ue++)(wt=He(ue,xe))+1&&je[wt][1].push(rt[xe][ue])}else for((wt=$e.p)===void 0&&(wt=$e[et]),(rt=$e.s)===void 0&&(rt=$e.v),rt===void 0&&(rt=Oe?$e.y:$e.x),Array.isArray(rt)||(rt=rt===void 0?[]:[rt]),xe=0;xe<rt.length;xe++)je[wt][1].push(rt[xe])}}}Se._categoriesValue=je;var Be=[];for(Ee=0;Ee<je.length;Ee++)Be.push([je[Ee][0],Me[Fe](je[Ee][1])]);Be.sort(function(Je,_e){return Je[1]-_e[1]}),Se._categoriesAggregatedValue=Be,Se._initialCategories=Be.map(function(Je){return Je[0]}),Ye==="descending"&&Se._initialCategories.reverse(),me=me.concat(Se.sortByInitialCategories())}}}return me}(D,Z);if(de.length){for(q._numBoxes=0,q._numViolins=0,Y=0;Y<de.length;Y++)se(de[Y],!0);for(Y=0;Y<de.length;Y++)se(de[Y],!1);W(Z)}e.getComponentMethod("fx","calc")(Z),e.getComponentMethod("errorbars","calc")(Z)};var F=/(total|sum|min|max|mean|median) (ascending|descending)/;function j(Z,Q,X){var G={};function Y(q){q.clearCalc(),q.type==="multicategory"&&q.setupMultiCategory(Q),G[q._id]=1}i.simpleMap(Z,Y);for(var K=X._axisMatchGroups||[],D=0;D<K.length;D++)for(var B in K[D])G[B]||Y(X[a.id2name(B)])}function W(Z){var Q,X,G,Y=Z._fullLayout,K=Y._visibleModules,D={};for(X=0;X<K.length;X++){var B=K[X],q=B.crossTraceCalc;if(q){var ee=B.basePlotModule.name;D[ee]?i.pushUnique(D[ee],q):D[ee]=[q]}}for(G in D){var J=D[G],$=Y._subplots[G];if(Array.isArray($))for(Q=0;Q<$.length;Q++){var te=$[Q],ie=G==="cartesian"?Y._plots[te]:Y[te];for(X=0;X<J.length;X++)J[X](Z,ie,te)}else for(X=0;X<J.length;X++)J[X](Z)}}v.rehover=function(Z){Z._fullLayout._rehover&&Z._fullLayout._rehover()},v.redrag=function(Z){Z._fullLayout._redrag&&Z._fullLayout._redrag()},v.generalUpdatePerTraceModule=function(Z,Q,X,G){var Y,K=Q.traceHash,D={};for(Y=0;Y<X.length;Y++){var B=X[Y],q=B[0].trace;q.visible&&(D[q.type]=D[q.type]||[],D[q.type].push(B))}for(var ee in K)if(!D[ee]){var J=K[ee][0];J[0].trace.visible=!1,D[ee]=[J]}for(var $ in D){var te=D[$];te[0][0].trace._module.plot(Z,Q,i.filterVisible(te),G)}Q.traceHash=D},v.plotBasePlot=function(Z,Q,X,G,Y){var K=e.getModule(Z),D=d(Q.calcdata,K)[0];K.plot(Q,D,G,Y)},v.cleanBasePlot=function(Z,Q,X,G,Y){var K=Y._has&&Y._has(Z),D=X._has&&X._has(Z);K&&!D&&Y["_"+Z+"layer"].selectAll("g.trace").remove()}},{"../components/color":650,"../constants/numerical":763,"../lib":787,"../plot_api/plot_schema":826,"../plot_api/plot_template":827,"../plots/get_data":875,"../registry":915,"./animation_attributes":832,"./attributes":834,"./cartesian/axis_ids":842,"./cartesian/handle_outline":849,"./command":865,"./font_attributes":867,"./frame_attributes":868,"./layout_attributes":892,"@plotly/d3":58,"d3-format":164,"d3-time-format":172,"fast-isnumeric":246}],902:[function(h,N,H){N.exports={attr:"subplot",name:"polar",axisNames:["angularaxis","radialaxis"],axisName2dataArray:{angularaxis:"theta",radialaxis:"r"},layerNames:["draglayer","plotbg","backplot","angular-grid","radial-grid","frontplot","angular-line","radial-line","angular-axis","radial-axis"],radialDragBoxSize:50,angularDragBoxSize:30,cornerLen:25,cornerHalfWidth:2,MINDRAG:8,MINZOOM:20,OFFEDGE:20}},{}],903:[function(h,N,H){var t=h("../../lib"),m=h("../../lib/polygon").tester,g=t.findIndexOfMin,p=t.isAngleInsideSector,e=t.angleDelta,f=t.angleDist;function u(a,c,r,n){var d,l,y=n[0],v=n[1],_=s(Math.sin(c)-Math.sin(a)),x=s(Math.cos(c)-Math.cos(a)),T=Math.tan(r),A=s(1/T),S=_/x,w=v-S*y;return A?_&&x?l=T*(d=w/(T-S)):x?(d=v*A,l=v):(d=y,l=y*T):_&&x?(d=0,l=w):x?(d=0,l=v):d=l=NaN,[d,l]}function i(a,c,r,n){return t.isFullCircle([c,r])?function(d,l){var y,v=l.length,_=new Array(v+1);for(y=0;y<v;y++){var x=l[y];_[y]=[d*Math.cos(x),d*Math.sin(x)]}return _[y]=_[0].slice(),_}(a,n):function(d,l,y,v){var _,x,T=v.length,A=[];function S(j){return[d*Math.cos(j),d*Math.sin(j)]}function w(j,W,Z){return u(j,W,Z,S(j))}function L(j){return t.mod(j,T)}function k(j){return p(j,[l,y])}var C=g(v,function(j){return k(j)?f(j,l):1/0}),M=w(v[C],v[L(C-1)],l);for(A.push(M),_=C,x=0;x<T;_++,x++){var P=v[L(_)];if(!k(P))break;A.push(S(P))}var O=g(v,function(j){return k(j)?f(j,y):1/0}),F=w(v[O],v[L(O+1)],y);return A.push(F),A.push([0,0]),A.push(A[0].slice()),A}(a,c,r,n)}function s(a){return Math.abs(a)>1e-10?a:0}function o(a,c,r){c=c||0,r=r||0;for(var n=a.length,d=new Array(n),l=0;l<n;l++){var y=a[l];d[l]=[c+y[0],r-y[1]]}return d}N.exports={isPtInsidePolygon:function(a,c,r,n,d){if(!p(c,n))return!1;var l,y;r[0]<r[1]?(l=r[0],y=r[1]):(l=r[1],y=r[0]);var v=m(i(l,n[0],n[1],d)),_=m(i(y,n[0],n[1],d)),x=[a*Math.cos(c),a*Math.sin(c)];return _.contains(x)&&!v.contains(x)},findPolygonOffset:function(a,c,r,n){for(var d=1/0,l=1/0,y=i(a,c,r,n),v=0;v<y.length;v++){var _=y[v];d=Math.min(d,_[0]),l=Math.min(l,-_[1])}return[d,l]},findEnclosingVertexAngles:function(a,c){var r=g(c,function(d){var l=e(d,a);return l>0?l:1/0}),n=t.mod(r+1,c.length);return[c[r],c[n]]},findIntersectionXY:u,findXYatLength:function(a,c,r,n){var d=-c*r,l=c*c+1,y=2*(c*d-r),v=d*d+r*r-a*a,_=Math.sqrt(y*y-4*l*v),x=(-y+_)/(2*l),T=(-y-_)/(2*l);return[[x,c*x+d+n],[T,c*T+d+n]]},clampTiny:s,pathPolygon:function(a,c,r,n,d,l){return"M"+o(i(a,c,r,n),d,l).join("L")},pathPolygonAnnulus:function(a,c,r,n,d,l,y){var v,_;a<c?(v=a,_=c):(v=c,_=a);var x=o(i(v,r,n,d),l,y);return"M"+o(i(_,r,n,d),l,y).reverse().join("L")+"M"+x.join("L")}}},{"../../lib":787,"../../lib/polygon":799}],904:[function(h,N,H){var t=h("../get_data").getSubplotCalcData,m=h("../../lib").counterRegex,g=h("./polar"),p=h("./constants"),e=p.attr,f=p.name,u=m(f),i={};i[e]={valType:"subplotid",dflt:f,editType:"calc"},N.exports={attr:e,name:f,idRoot:f,idRegex:u,attrRegex:u,attributes:i,layoutAttributes:h("./layout_attributes"),supplyLayoutDefaults:h("./layout_defaults"),plot:function(s){for(var o=s._fullLayout,a=s.calcdata,c=o._subplots[f],r=0;r<c.length;r++){var n=c[r],d=t(a,f,n),l=o[n]._subplot;l||(l=g(s,n),o[n]._subplot=l),l.plot(d,o,s._promises)}},clean:function(s,o,a,c){for(var r=c._subplots[f]||[],n=c._has&&c._has("gl"),d=o._has&&o._has("gl"),l=n&&!d,y=0;y<r.length;y++){var v=r[y],_=c[v]._subplot;if(!o[v]&&_)for(var x in _.framework.remove(),_.layers["radial-axis-title"].remove(),_.clipPaths)_.clipPaths[x].remove();l&&_._scene&&(_._scene.destroy(),_._scene=null)}},toSVG:h("../cartesian").toSVG}},{"../../lib":787,"../cartesian":852,"../get_data":875,"./constants":902,"./layout_attributes":905,"./layout_defaults":906,"./polar":907}],905:[function(h,N,H){var t=h("../../components/color/attributes"),m=h("../cartesian/layout_attributes"),g=h("../domain").attributes,p=h("../../lib").extendFlat,e=h("../../plot_api/edit_types").overrideAll,f=e({color:m.color,showline:p({},m.showline,{dflt:!0}),linecolor:m.linecolor,linewidth:m.linewidth,showgrid:p({},m.showgrid,{dflt:!0}),gridcolor:m.gridcolor,gridwidth:m.gridwidth},"plot","from-root"),u=e({tickmode:m.tickmode,nticks:m.nticks,tick0:m.tick0,dtick:m.dtick,tickvals:m.tickvals,ticktext:m.ticktext,ticks:m.ticks,ticklen:m.ticklen,tickwidth:m.tickwidth,tickcolor:m.tickcolor,showticklabels:m.showticklabels,showtickprefix:m.showtickprefix,tickprefix:m.tickprefix,showticksuffix:m.showticksuffix,ticksuffix:m.ticksuffix,showexponent:m.showexponent,exponentformat:m.exponentformat,minexponent:m.minexponent,separatethousands:m.separatethousands,tickfont:m.tickfont,tickangle:m.tickangle,tickformat:m.tickformat,tickformatstops:m.tickformatstops,layer:m.layer},"plot","from-root"),i={visible:p({},m.visible,{dflt:!0}),type:p({},m.type,{values:["-","linear","log","date","category"]}),autotypenumbers:m.autotypenumbers,autorange:p({},m.autorange,{editType:"plot"}),rangemode:{valType:"enumerated",values:["tozero","nonnegative","normal"],dflt:"tozero",editType:"calc"},range:p({},m.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],editType:"plot"}),categoryorder:m.categoryorder,categoryarray:m.categoryarray,angle:{valType:"angle",editType:"plot"},side:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"clockwise",editType:"plot"},title:{text:p({},m.title.text,{editType:"plot",dflt:""}),font:p({},m.title.font,{editType:"plot"}),editType:"plot"},hoverformat:m.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{title:m._deprecated.title,titlefont:m._deprecated.titlefont}};p(i,f,u);var s={visible:p({},m.visible,{dflt:!0}),type:{valType:"enumerated",values:["-","linear","category"],dflt:"-",editType:"calc",_noTemplating:!0},autotypenumbers:m.autotypenumbers,categoryorder:m.categoryorder,categoryarray:m.categoryarray,thetaunit:{valType:"enumerated",values:["radians","degrees"],dflt:"degrees",editType:"calc"},period:{valType:"number",editType:"calc",min:0},direction:{valType:"enumerated",values:["counterclockwise","clockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"angle",editType:"calc"},hoverformat:m.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc"};p(s,f,u),N.exports={domain:g({name:"polar",editType:"plot"}),sector:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],dflt:[0,360],editType:"plot"},hole:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},bgcolor:{valType:"color",editType:"plot",dflt:t.background},radialaxis:i,angularaxis:s,gridshape:{valType:"enumerated",values:["circular","linear"],dflt:"circular",editType:"plot"},uirevision:{valType:"any",editType:"none"},editType:"calc"}},{"../../components/color/attributes":649,"../../lib":787,"../../plot_api/edit_types":820,"../cartesian/layout_attributes":853,"../domain":866}],906:[function(h,N,H){var t=h("../../lib"),m=h("../../components/color"),g=h("../../plot_api/plot_template"),p=h("../subplot_defaults"),e=h("../get_data").getSubplotData,f=h("../cartesian/tick_value_defaults"),u=h("../cartesian/tick_mark_defaults"),i=h("../cartesian/tick_label_defaults"),s=h("../cartesian/category_order_defaults"),o=h("../cartesian/line_grid_defaults"),a=h("../cartesian/axis_autotype"),c=h("./layout_attributes"),r=h("./set_convert"),n=h("./constants"),d=n.axisNames;function l(v,_,x,T){var A=x("bgcolor");T.bgColor=m.combine(A,T.paper_bgcolor);var S=x("sector");x("hole");var w,L=e(T.fullData,n.name,T.id),k=T.layoutOut;function C(K,D){return x(w+"."+K,D)}for(var M=0;M<d.length;M++){w=d[M],t.isPlainObject(v[w])||(v[w]={});var P=v[w],O=g.newContainer(_,w);O._id=O._name=w,O._attr=T.id+"."+w,O._traceIndices=L.map(function(K){return K._expandedIndex});var F=n.axisName2dataArray[w],j=y(P,O,C,L,F,T);s(P,O,C,{axData:L,dataAttr:F});var W,Z,Q=C("visible");switch(r(O,_,k),C("uirevision",_.uirevision),Q&&(Z=(W=C("color"))===P.color?W:T.font.color),O._m=1,w){case"radialaxis":var X=C("autorange",!O.isValidRange(P.range));P.autorange=X,!X||j!=="linear"&&j!=="-"||C("rangemode"),X==="reversed"&&(O._m=-1),C("range"),O.cleanRange("range",{dfltRange:[0,1]}),Q&&(C("side"),C("angle",S[0]),C("title.text"),t.coerceFont(C,"title.font",{family:T.font.family,size:t.bigFont(T.font.size),color:Z}));break;case"angularaxis":if(j==="date"){t.log("Polar plots do not support date angular axes yet.");for(var G=0;G<L.length;G++)L[G].visible=!1;j=P.type=O.type="linear"}C(j==="linear"?"thetaunit":"period");var Y=C("direction");C("rotation",{counterclockwise:0,clockwise:90}[Y])}Q&&(f(P,O,C,O.type),i(P,O,C,O.type,{tickSuffixDflt:O.thetaunit==="degrees"?"\xB0":void 0}),u(P,O,C,{outerTicks:!0}),C("showticklabels")&&(t.coerceFont(C,"tickfont",{family:T.font.family,size:T.font.size,color:Z}),C("tickangle"),C("tickformat")),o(P,O,C,{dfltColor:W,bgColor:T.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:c[w]}),C("layer")),j!=="category"&&C("hoverformat"),O._input=P}_.angularaxis.type==="category"&&x("gridshape")}function y(v,_,x,T,A,S){var w=x("autotypenumbers",S.autotypenumbersDflt);if(x("type")==="-"){for(var L,k=0;k<T.length;k++)if(T[k].visible){L=T[k];break}L&&L[A]&&(_.type=a(L[A],"gregorian",{noMultiCategory:!0,autotypenumbers:w})),_.type==="-"?_.type="linear":v.type=_.type}return _.type}N.exports=function(v,_,x){p(v,_,x,{type:n.name,attributes:c,handleDefaults:l,font:_.font,autotypenumbersDflt:_.autotypenumbers,paper_bgcolor:_.paper_bgcolor,fullData:x,layoutOut:_})}},{"../../components/color":650,"../../lib":787,"../../plot_api/plot_template":827,"../cartesian/axis_autotype":839,"../cartesian/category_order_defaults":843,"../cartesian/line_grid_defaults":855,"../cartesian/tick_label_defaults":860,"../cartesian/tick_mark_defaults":861,"../cartesian/tick_value_defaults":862,"../get_data":875,"../subplot_defaults":909,"./constants":902,"./layout_attributes":905,"./set_convert":908}],907:[function(h,N,H){var t=h("@plotly/d3"),m=h("tinycolor2"),g=h("../../registry"),p=h("../../lib"),e=p.strRotate,f=p.strTranslate,u=h("../../components/color"),i=h("../../components/drawing"),s=h("../plots"),o=h("../../plots/cartesian/axes"),a=h("../cartesian/set_convert"),c=h("./set_convert"),r=h("../cartesian/autorange").doAutoRange,n=h("../cartesian/dragbox"),d=h("../../components/dragelement"),l=h("../../components/fx"),y=h("../../components/titles"),v=h("../cartesian/select").prepSelect,_=h("../cartesian/select").selectOnClick,x=h("../cartesian/select").clearSelect,T=h("../../lib/setcursor"),A=h("../../lib/clear_gl_canvases"),S=h("../../plot_api/subroutines").redrawReglTraces,w=h("../../constants/alignment").MID_SHIFT,L=h("./constants"),k=h("./helpers"),C=p._,M=p.mod,P=p.deg2rad,O=p.rad2deg;function F(X,G){this.id=G,this.gd=X,this._hasClipOnAxisFalse=null,this.vangles=null,this.radialAxisAngle=null,this.traceHash={},this.layers={},this.clipPaths={},this.clipIds={},this.viewInitial={};var Y=X._fullLayout,K="clip"+Y._uid+G;this.clipIds.forTraces=K+"-for-traces",this.clipPaths.forTraces=Y._clips.append("clipPath").attr("id",this.clipIds.forTraces),this.clipPaths.forTraces.append("path"),this.framework=Y._polarlayer.append("g").attr("class",G),this.radialTickLayout=null,this.angularTickLayout=null}var j=F.prototype;function W(X){var G=X.ticks+String(X.ticklen)+String(X.showticklabels);return"side"in X&&(G+=X.side),G}function Z(X,G){return G[p.findIndexOfMin(G,function(Y){return p.angleDist(X,Y)})]}function Q(X,G,Y){return G?(X.attr("display",null),X.attr(Y)):X&&X.attr("display","none"),X}N.exports=function(X,G){return new F(X,G)},j.plot=function(X,G){var Y=G[this.id];this._hasClipOnAxisFalse=!1;for(var K=0;K<X.length;K++)if(X[K][0].trace.cliponaxis===!1){this._hasClipOnAxisFalse=!0;break}this.updateLayers(G,Y),this.updateLayout(G,Y),s.generalUpdatePerTraceModule(this.gd,this,X,Y),this.updateFx(G,Y)},j.updateLayers=function(X,G){var Y=this.layers,K=G.radialaxis,D=G.angularaxis,B=L.layerNames,q=B.indexOf("frontplot"),ee=B.slice(0,q),J=D.layer==="below traces",$=K.layer==="below traces";J&&ee.push("angular-line"),$&&ee.push("radial-line"),J&&ee.push("angular-axis"),$&&ee.push("radial-axis"),ee.push("frontplot"),J||ee.push("angular-line"),$||ee.push("radial-line"),J||ee.push("angular-axis"),$||ee.push("radial-axis");var te=this.framework.selectAll(".polarsublayer").data(ee,String);te.enter().append("g").attr("class",function(ie){return"polarsublayer "+ie}).each(function(ie){var ae=Y[ie]=t.select(this);switch(ie){case"frontplot":ae.append("g").classed("barlayer",!0),ae.append("g").classed("scatterlayer",!0);break;case"backplot":ae.append("g").classed("maplayer",!0);break;case"plotbg":Y.bg=ae.append("path");break;case"radial-grid":case"angular-grid":ae.style("fill","none");break;case"radial-line":ae.append("line").style("fill","none");break;case"angular-line":ae.append("path").style("fill","none")}}),te.order()},j.updateLayout=function(X,G){var Y=this.layers,K=X._size,D=G.radialaxis,B=G.angularaxis,q=G.domain.x,ee=G.domain.y;this.xOffset=K.l+K.w*q[0],this.yOffset=K.t+K.h*(1-ee[1]);var J=this.xLength=K.w*(q[1]-q[0]),$=this.yLength=K.h*(ee[1]-ee[0]),te=G.sector;this.sectorInRad=te.map(P);var ie,ae,he,se,de,ce=this.sectorBBox=function(et){var Oe,je,We,Ge,Qe=et[0],it=et[1]-Qe,lt=M(Qe,360),Lt=lt+it,wt=Math.cos(P(lt)),rt=Math.sin(P(lt)),$e=Math.cos(P(Lt)),xt=Math.sin(P(Lt));return Ge=lt<=90&&Lt>=90||lt>90&&Lt>=450?1:rt<=0&&xt<=0?0:Math.max(rt,xt),Oe=lt<=180&&Lt>=180||lt>180&&Lt>=540?-1:wt>=0&&$e>=0?0:Math.min(wt,$e),je=lt<=270&&Lt>=270||lt>270&&Lt>=630?-1:rt>=0&&xt>=0?0:Math.min(rt,xt),We=Lt>=360?1:wt<=0&&$e<=0?0:Math.max(wt,$e),[Oe,je,We,Ge]}(te),ve=ce[2]-ce[0],ke=ce[3]-ce[1],Ee=$/J,be=Math.abs(ke/ve);Ee>be?(ie=J,de=($-(ae=J*be))/K.h/2,he=[q[0],q[1]],se=[ee[0]+de,ee[1]-de]):(ae=$,de=(J-(ie=$/be))/K.w/2,he=[q[0]+de,q[1]-de],se=[ee[0],ee[1]]),this.xLength2=ie,this.yLength2=ae,this.xDomain2=he,this.yDomain2=se;var xe=this.xOffset2=K.l+K.w*he[0],ue=this.yOffset2=K.t+K.h*(1-se[1]),me=this.radius=ie/ve,we=this.innerRadius=G.hole*me,Me=this.cx=xe-me*ce[0],Se=this.cy=ue+me*ce[3],De=this.cxx=Me-xe,Fe=this.cyy=Se-ue;this.radialAxis=this.mockAxis(X,G,D,{_id:"x",side:{counterclockwise:"top",clockwise:"bottom"}[D.side],_realSide:D.side,domain:[we/K.w,me/K.w]}),this.angularAxis=this.mockAxis(X,G,B,{side:"right",domain:[0,Math.PI],autorange:!1}),this.doAutoRange(X,G),this.updateAngularAxis(X,G),this.updateRadialAxis(X,G),this.updateRadialAxisTitle(X,G),this.xaxis=this.mockCartesianAxis(X,G,{_id:"x",domain:he}),this.yaxis=this.mockCartesianAxis(X,G,{_id:"y",domain:se});var Ye=this.pathSubplot();this.clipPaths.forTraces.select("path").attr("d",Ye).attr("transform",f(De,Fe)),Y.frontplot.attr("transform",f(xe,ue)).call(i.setClipUrl,this._hasClipOnAxisFalse?null:this.clipIds.forTraces,this.gd),Y.bg.attr("d",Ye).attr("transform",f(Me,Se)).call(u.fill,G.bgcolor)},j.mockAxis=function(X,G,Y,K){var D=p.extendFlat({},Y,K);return c(D,G,X),D},j.mockCartesianAxis=function(X,G,Y){var K=this,D=Y._id,B=p.extendFlat({type:"linear"},Y);a(B,X);var q={x:[0,2],y:[1,3]};return B.setRange=function(){var ee=K.sectorBBox,J=q[D],$=K.radialAxis._rl,te=($[1]-$[0])/(1-G.hole);B.range=[ee[J[0]]*te,ee[J[1]]*te]},B.isPtWithinRange=D==="x"?function(ee){return K.isPtInside(ee)}:function(){return!0},B.setRange(),B.setScale(),B},j.doAutoRange=function(X,G){var Y=this.gd,K=this.radialAxis,D=G.radialaxis;K.setScale(),r(Y,K);var B=K.range;D.range=B.slice(),D._input.range=B.slice(),K._rl=[K.r2l(B[0],null,"gregorian"),K.r2l(B[1],null,"gregorian")]},j.updateRadialAxis=function(X,G){var Y=this,K=Y.gd,D=Y.layers,B=Y.radius,q=Y.innerRadius,ee=Y.cx,J=Y.cy,$=G.radialaxis,te=M(G.sector[0],360),ie=Y.radialAxis,ae=q<B;Y.fillViewInitialKey("radialaxis.angle",$.angle),Y.fillViewInitialKey("radialaxis.range",ie.range.slice()),ie.setGeometry(),ie.tickangle==="auto"&&te>90&&te<=270&&(ie.tickangle=180);var he=function(xe){return f(ie.l2p(xe.x)+q,0)},se=W($);if(Y.radialTickLayout!==se&&(D["radial-axis"].selectAll(".xtick").remove(),Y.radialTickLayout=se),ae){ie.setScale();var de=o.calcTicks(ie),ce=o.clipEnds(ie,de),ve=o.getTickSigns(ie)[2];o.drawTicks(K,ie,{vals:de,layer:D["radial-axis"],path:o.makeTickPath(ie,0,ve),transFn:he,crisp:!1}),o.drawGrid(K,ie,{vals:ce,layer:D["radial-grid"],path:function(xe){return Y.pathArc(ie.r2p(xe.x)+q)},transFn:p.noop,crisp:!1}),o.drawLabels(K,ie,{vals:de,layer:D["radial-axis"],transFn:he,labelFns:o.makeLabelFns(ie,0)})}var ke=Y.radialAxisAngle=Y.vangles?O(Z(P($.angle),Y.vangles)):$.angle,Ee=f(ee,J),be=Ee+e(-ke);Q(D["radial-axis"],ae&&($.showticklabels||$.ticks),{transform:be}),Q(D["radial-grid"],ae&&$.showgrid,{transform:Ee}),Q(D["radial-line"].select("line"),ae&&$.showline,{x1:q,y1:0,x2:B,y2:0,transform:be}).attr("stroke-width",$.linewidth).call(u.stroke,$.linecolor)},j.updateRadialAxisTitle=function(X,G,Y){var K=this.gd,D=this.radius,B=this.cx,q=this.cy,ee=G.radialaxis,J=this.id+"title",$=Y!==void 0?Y:this.radialAxisAngle,te=P($),ie=Math.cos(te),ae=Math.sin(te),he=0;if(ee.title){var se=i.bBox(this.layers["radial-axis"].node()).height,de=ee.title.font.size;he=ee.side==="counterclockwise"?-se-.4*de:se+.8*de}this.layers["radial-axis-title"]=y.draw(K,J,{propContainer:ee,propName:this.id+".radialaxis.title",placeholder:C(K,"Click to enter radial axis title"),attributes:{x:B+D/2*ie+he*ae,y:q-D/2*ae+he*ie,"text-anchor":"middle"},transform:{rotate:-$}})},j.updateAngularAxis=function(X,G){var Y=this,K=Y.gd,D=Y.layers,B=Y.radius,q=Y.innerRadius,ee=Y.cx,J=Y.cy,$=G.angularaxis,te=Y.angularAxis;Y.fillViewInitialKey("angularaxis.rotation",$.rotation),te.setGeometry(),te.setScale();var ie=function(be){return te.t2g(be.x)};te.type==="linear"&&te.thetaunit==="radians"&&(te.tick0=O(te.tick0),te.dtick=O(te.dtick));var ae=function(be){return f(ee+B*Math.cos(be),J-B*Math.sin(be))},he=o.makeLabelFns(te,0).labelStandoff,se={xFn:function(be){var xe=ie(be);return Math.cos(xe)*he},yFn:function(be){var xe=ie(be),ue=Math.sin(xe)>0?.2:1;return-Math.sin(xe)*(he+be.fontSize*ue)+Math.abs(Math.cos(xe))*(be.fontSize*w)},anchorFn:function(be){var xe=ie(be),ue=Math.cos(xe);return Math.abs(ue)<.1?"middle":ue>0?"start":"end"},heightFn:function(be,xe,ue){var me=ie(be);return-.5*(1+Math.sin(me))*ue}},de=W($);Y.angularTickLayout!==de&&(D["angular-axis"].selectAll("."+te._id+"tick").remove(),Y.angularTickLayout=de);var ce,ve=o.calcTicks(te);if(G.gridshape==="linear"?(ce=ve.map(ie),p.angleDelta(ce[0],ce[1])<0&&(ce=ce.slice().reverse())):ce=null,Y.vangles=ce,te.type==="category"&&(ve=ve.filter(function(be){return p.isAngleInsideSector(ie(be),Y.sectorInRad)})),te.visible){var ke=te.ticks==="inside"?-1:1,Ee=(te.linewidth||1)/2;o.drawTicks(K,te,{vals:ve,layer:D["angular-axis"],path:"M"+ke*Ee+",0h"+ke*te.ticklen,transFn:function(be){var xe=ie(be);return ae(xe)+e(-O(xe))},crisp:!1}),o.drawGrid(K,te,{vals:ve,layer:D["angular-grid"],path:function(be){var xe=ie(be),ue=Math.cos(xe),me=Math.sin(xe);return"M"+[ee+q*ue,J-q*me]+"L"+[ee+B*ue,J-B*me]},transFn:p.noop,crisp:!1}),o.drawLabels(K,te,{vals:ve,layer:D["angular-axis"],repositionOnUpdate:!0,transFn:function(be){return ae(ie(be))},labelFns:se})}Q(D["angular-line"].select("path"),$.showline,{d:Y.pathSubplot(),transform:f(ee,J)}).attr("stroke-width",$.linewidth).call(u.stroke,$.linecolor)},j.updateFx=function(X,G){this.gd._context.staticPlot||(this.updateAngularDrag(X),this.updateRadialDrag(X,G,0),this.updateRadialDrag(X,G,1),this.updateMainDrag(X))},j.updateMainDrag=function(X){var G,Y,K=this,D=K.gd,B=K.layers,q=X._zoomlayer,ee=L.MINZOOM,J=L.OFFEDGE,$=K.radius,te=K.innerRadius,ie=K.cx,ae=K.cy,he=K.cxx,se=K.cyy,de=K.sectorInRad,ce=K.vangles,ve=K.radialAxis,ke=k.clampTiny,Ee=k.findXYatLength,be=k.findEnclosingVertexAngles,xe=L.cornerHalfWidth,ue=L.cornerLen/2,me=n.makeDragger(B,"path","maindrag","crosshair");t.select(me).attr("d",K.pathSubplot()).attr("transform",f(ie,ae));var we,Me,Se,De,Fe,Ye,et,Oe,je,We={element:me,gd:D,subplot:K.id,plotinfo:{id:K.id,xaxis:K.xaxis,yaxis:K.yaxis},xaxes:[K.xaxis],yaxes:[K.yaxis]};function Ge(Je,_e){return Math.sqrt(Je*Je+_e*_e)}function Qe(Je,_e){return Ge(Je-he,_e-se)}function it(Je,_e){return Math.atan2(se-_e,Je-he)}function lt(Je,_e){return[Je*Math.cos(_e),Je*Math.sin(-_e)]}function Lt(Je,_e){if(Je===0)return K.pathSector(2*xe);var Le=ue/Je,Ce=_e-Le,Pe=_e+Le,Xe=Math.max(0,Math.min(Je,$)),ut=Xe-xe,kt=Xe+xe;return"M"+lt(ut,Ce)+"A"+[ut,ut]+" 0,0,0 "+lt(ut,Pe)+"L"+lt(kt,Pe)+"A"+[kt,kt]+" 0,0,1 "+lt(kt,Ce)+"Z"}function wt(Je,_e,Le){if(Je===0)return K.pathSector(2*xe);var Ce,Pe,Xe=lt(Je,_e),ut=lt(Je,Le),kt=ke((Xe[0]+ut[0])/2),ft=ke((Xe[1]+ut[1])/2);if(kt&&ft){var Et=ft/kt,mt=-1/Et,It=Ee(xe,Et,kt,ft);Ce=Ee(ue,mt,It[0][0],It[0][1]),Pe=Ee(ue,mt,It[1][0],It[1][1])}else{var vt,nt;ft?(vt=ue,nt=xe):(vt=xe,nt=ue),Ce=[[kt-vt,ft-nt],[kt+vt,ft-nt]],Pe=[[kt-vt,ft+nt],[kt+vt,ft+nt]]}return"M"+Ce.join("L")+"L"+Pe.reverse().join("L")+"Z"}function rt(Je,_e){return _e=Math.max(Math.min(_e,$),te),Je<J?Je=0:$-Je<J?Je=$:_e<J?_e=0:$-_e<J&&(_e=$),Math.abs(_e-Je)>ee?(Je<_e?(Se=Je,De=_e):(Se=_e,De=Je),!0):(Se=null,De=null,!1)}function $e(Je,_e){Je=Je||Fe,_e=_e||"M0,0Z",Oe.attr("d",Je),je.attr("d",_e),n.transitionZoombox(Oe,je,Ye,et),Ye=!0;var Le={};He(Le),D.emit("plotly_relayouting",Le)}function xt(Je,_e){var Le,Ce,Pe=we+(Je*=G),Xe=Me+(_e*=Y),ut=Qe(we,Me),kt=Math.min(Qe(Pe,Xe),$),ft=it(we,Me);rt(ut,kt)&&(Le=Fe+K.pathSector(De),Se&&(Le+=K.pathSector(Se)),Ce=Lt(Se,ft)+Lt(De,ft)),$e(Le,Ce)}function Qt(Je,_e,Le,Ce){var Pe=k.findIntersectionXY(Le,Ce,Le,[Je-he,se-_e]);return Ge(Pe[0],Pe[1])}function $t(Je,_e){var Le,Ce,Pe=we+Je,Xe=Me+_e,ut=it(we,Me),kt=it(Pe,Xe),ft=be(ut,ce),Et=be(kt,ce);rt(Qt(we,Me,ft[0],ft[1]),Math.min(Qt(Pe,Xe,Et[0],Et[1]),$))&&(Le=Fe+K.pathSector(De),Se&&(Le+=K.pathSector(Se)),Ce=[wt(Se,ft[0],ft[1]),wt(De,ft[0],ft[1])].join(" ")),$e(Le,Ce)}function Ue(){if(n.removeZoombox(D),Se!==null&&De!==null){var Je={};He(Je),n.showDoubleClickNotifier(D),g.call("_guiRelayout",D,Je)}}function He(Je){var _e=ve._rl,Le=(_e[1]-_e[0])/(1-te/$)/$,Ce=[_e[0]+(Se-te)*Le,_e[0]+(De-te)*Le];Je[K.id+".radialaxis.range"]=Ce}function Be(Je,_e){var Le=D._fullLayout.clickmode;if(n.removeZoombox(D),Je===2){var Ce={};for(var Pe in K.viewInitial)Ce[K.id+"."+Pe]=K.viewInitial[Pe];D.emit("plotly_doubleclick",null),g.call("_guiRelayout",D,Ce)}Le.indexOf("select")>-1&&Je===1&&_(_e,D,[K.xaxis],[K.yaxis],K.id,We),Le.indexOf("event")>-1&&l.click(D,_e,K.id)}We.prepFn=function(Je,_e,Le){var Ce=D._fullLayout.dragmode,Pe=me.getBoundingClientRect();D._fullLayout._calcInverseTransform(D);var Xe=D._fullLayout._invTransform;G=D._fullLayout._invScaleX,Y=D._fullLayout._invScaleY;var ut=p.apply3DTransform(Xe)(_e-Pe.left,Le-Pe.top);if(we=ut[0],Me=ut[1],ce){var kt=k.findPolygonOffset($,de[0],de[1],ce);we+=he+kt[0],Me+=se+kt[1]}switch(Ce){case"zoom":We.moveFn=ce?$t:xt,We.clickFn=Be,We.doneFn=Ue,function(){Se=null,De=null,Fe=K.pathSubplot(),Ye=!1;var ft=D._fullLayout[K.id];et=m(ft.bgcolor).getLuminance(),(Oe=n.makeZoombox(q,et,ie,ae,Fe)).attr("fill-rule","evenodd"),je=n.makeCorners(q,ie,ae),x(D)}();break;case"select":case"lasso":v(Je,_e,Le,We,Ce)}},me.onmousemove=function(Je){l.hover(D,Je,K.id),D._fullLayout._lasthover=me,D._fullLayout._hoversubplot=K.id},me.onmouseout=function(Je){D._dragging||d.unhover(D,Je)},d.init(We)},j.updateRadialDrag=function(X,G,Y){var K=this,D=K.gd,B=K.layers,q=K.radius,ee=K.innerRadius,J=K.cx,$=K.cy,te=K.radialAxis,ie=L.radialDragBoxSize,ae=ie/2;if(te.visible){var he,se,de,ce=P(K.radialAxisAngle),ve=te._rl,ke=ve[0],Ee=ve[1],be=ve[Y],xe=.75*(ve[1]-ve[0])/(1-G.hole)/q;Y?(he=J+(q+ae)*Math.cos(ce),se=$-(q+ae)*Math.sin(ce),de="radialdrag"):(he=J+(ee-ae)*Math.cos(ce),se=$-(ee-ae)*Math.sin(ce),de="radialdrag-inner");var ue,me,we,Me=n.makeRectDragger(B,de,"crosshair",-ae,-ae,ie,ie),Se={element:Me,gd:D};Q(t.select(Me),te.visible&&ee<q,{transform:f(he,se)}),Se.prepFn=function(){ue=null,me=null,we=null,Se.moveFn=De,Se.doneFn=Fe,x(D)},Se.clampFn=function(Oe,je){return Math.sqrt(Oe*Oe+je*je)<L.MINDRAG&&(Oe=0,je=0),[Oe,je]},d.init(Se)}function De(Oe,je){if(ue)ue(Oe,je);else{var We=[Oe,-je],Ge=[Math.cos(ce),Math.sin(ce)],Qe=Math.abs(p.dot(We,Ge)/Math.sqrt(p.dot(We,We)));isNaN(Qe)||(ue=Qe<.5?Ye:et)}var it={};(function(lt){me!==null?lt[K.id+".radialaxis.angle"]=me:we!==null&&(lt[K.id+".radialaxis.range["+Y+"]"]=we)})(it),D.emit("plotly_relayouting",it)}function Fe(){me!==null?g.call("_guiRelayout",D,K.id+".radialaxis.angle",me):we!==null&&g.call("_guiRelayout",D,K.id+".radialaxis.range["+Y+"]",we)}function Ye(Oe,je){if(Y!==0){var We=he+Oe,Ge=se+je;me=Math.atan2($-Ge,We-J),K.vangles&&(me=Z(me,K.vangles)),me=O(me);var Qe=f(J,$)+e(-me);B["radial-axis"].attr("transform",Qe),B["radial-line"].select("line").attr("transform",Qe);var it=K.gd._fullLayout,lt=it[K.id];K.updateRadialAxisTitle(it,lt,me)}}function et(Oe,je){var We=p.dot([Oe,-je],[Math.cos(ce),Math.sin(ce)]);if(we=be-xe*We,xe>0==(Y?we>ke:we<Ee)){var Ge=D._fullLayout,Qe=Ge[K.id];te.range[Y]=we,te._rl[Y]=we,K.updateRadialAxis(Ge,Qe),K.xaxis.setRange(),K.xaxis.setScale(),K.yaxis.setRange(),K.yaxis.setScale();var it=!1;for(var lt in K.traceHash){var Lt=K.traceHash[lt],wt=p.filterVisible(Lt);Lt[0][0].trace._module.plot(D,K,wt,Qe),g.traceIs(lt,"gl")&&wt.length&&(it=!0)}it&&(A(D),S(D))}else we=null}},j.updateAngularDrag=function(X){var G=this,Y=G.gd,K=G.layers,D=G.radius,B=G.angularAxis,q=G.cx,ee=G.cy,J=G.cxx,$=G.cyy,te=L.angularDragBoxSize,ie=n.makeDragger(K,"path","angulardrag","move"),ae={element:ie,gd:Y};function he(Se,De){return Math.atan2($+te-De,Se-J-te)}t.select(ie).attr("d",G.pathAnnulus(D,D+te)).attr("transform",f(q,ee)).call(T,"move");var se,de,ce,ve,ke,Ee,be=K.frontplot.select(".scatterlayer").selectAll(".trace"),xe=be.selectAll(".point"),ue=be.selectAll(".textpoint");function me(Se,De){var Fe=G.gd._fullLayout,Ye=Fe[G.id],et=he(se+Se*X._invScaleX,de+De*X._invScaleY),Oe=O(et-Ee);if(ve=ce+Oe,K.frontplot.attr("transform",f(G.xOffset2,G.yOffset2)+e([-Oe,J,$])),G.vangles){ke=G.radialAxisAngle+Oe;var je=f(q,ee)+e(-Oe),We=f(q,ee)+e(-ke);K.bg.attr("transform",je),K["radial-grid"].attr("transform",je),K["radial-axis"].attr("transform",We),K["radial-line"].select("line").attr("transform",We),G.updateRadialAxisTitle(Fe,Ye,ke)}else G.clipPaths.forTraces.select("path").attr("transform",f(J,$)+e(Oe));xe.each(function(){var wt=t.select(this),rt=i.getTranslate(wt);wt.attr("transform",f(rt.x,rt.y)+e([Oe]))}),ue.each(function(){var wt=t.select(this),rt=wt.select("text"),$e=i.getTranslate(wt);wt.attr("transform",e([Oe,rt.attr("x"),rt.attr("y")])+f($e.x,$e.y))}),B.rotation=p.modHalf(ve,360),G.updateAngularAxis(Fe,Ye),G._hasClipOnAxisFalse&&!p.isFullCircle(G.sectorInRad)&&be.call(i.hideOutsideRangePoints,G);var Ge=!1;for(var Qe in G.traceHash)if(g.traceIs(Qe,"gl")){var it=G.traceHash[Qe],lt=p.filterVisible(it);it[0][0].trace._module.plot(Y,G,lt,Ye),lt.length&&(Ge=!0)}Ge&&(A(Y),S(Y));var Lt={};we(Lt),Y.emit("plotly_relayouting",Lt)}function we(Se){Se[G.id+".angularaxis.rotation"]=ve,G.vangles&&(Se[G.id+".radialaxis.angle"]=ke)}function Me(){ue.select("text").attr("transform",null);var Se={};we(Se),g.call("_guiRelayout",Y,Se)}ae.prepFn=function(Se,De,Fe){var Ye=X[G.id];ce=Ye.angularaxis.rotation;var et=ie.getBoundingClientRect();se=De-et.left,de=Fe-et.top,Y._fullLayout._calcInverseTransform(Y);var Oe=p.apply3DTransform(X._invTransform)(se,de);se=Oe[0],de=Oe[1],Ee=he(se,de),ae.moveFn=me,ae.doneFn=Me,x(Y)},G.vangles&&!p.isFullCircle(G.sectorInRad)&&(ae.prepFn=p.noop,T(t.select(ie),null)),d.init(ae)},j.isPtInside=function(X){var G=this.sectorInRad,Y=this.vangles,K=this.angularAxis.c2g(X.theta),D=this.radialAxis,B=D.c2l(X.r),q=D._rl;return(Y?k.isPtInsidePolygon:p.isPtInsideSector)(B,K,q,G,Y)},j.pathArc=function(X){var G=this.sectorInRad,Y=this.vangles;return(Y?k.pathPolygon:p.pathArc)(X,G[0],G[1],Y)},j.pathSector=function(X){var G=this.sectorInRad,Y=this.vangles;return(Y?k.pathPolygon:p.pathSector)(X,G[0],G[1],Y)},j.pathAnnulus=function(X,G){var Y=this.sectorInRad,K=this.vangles;return(K?k.pathPolygonAnnulus:p.pathAnnulus)(X,G,Y[0],Y[1],K)},j.pathSubplot=function(){var X=this.innerRadius,G=this.radius;return X?this.pathAnnulus(X,G):this.pathSector(G)},j.fillViewInitialKey=function(X,G){X in this.viewInitial||(this.viewInitial[X]=G)}},{"../../components/color":650,"../../components/dragelement":669,"../../components/drawing":672,"../../components/fx":690,"../../components/titles":748,"../../constants/alignment":755,"../../lib":787,"../../lib/clear_gl_canvases":771,"../../lib/setcursor":808,"../../plot_api/subroutines":828,"../../plots/cartesian/axes":838,"../../registry":915,"../cartesian/autorange":837,"../cartesian/dragbox":847,"../cartesian/select":858,"../cartesian/set_convert":859,"../plots":901,"./constants":902,"./helpers":903,"./set_convert":908,"@plotly/d3":58,tinycolor2:583}],908:[function(h,N,H){var t=h("../../lib"),m=h("../cartesian/set_convert"),g=t.deg2rad,p=t.rad2deg;N.exports=function(e,f,u){switch(m(e,u),e._id){case"x":case"radialaxis":(function(i,s){var o=s._subplot;i.setGeometry=function(){var a=i._rl[0],c=i._rl[1],r=o.innerRadius,n=(o.radius-r)/(c-a),d=r/n,l=a>c?function(y){return y<=0}:function(y){return y>=0};i.c2g=function(y){var v=i.c2l(y)-a;return(l(v)?v:0)+d},i.g2c=function(y){return i.l2c(y+a-d)},i.g2p=function(y){return y*n},i.c2p=function(y){return i.g2p(i.c2g(y))}}})(e,f);break;case"angularaxis":(function(i,s){var o=i.type;if(o==="linear"){var a=i.d2c,c=i.c2d;i.d2c=function(r,n){return function(d,l){return l==="degrees"?g(d):d}(a(r),n)},i.c2d=function(r,n){return c(function(d,l){return l==="degrees"?p(d):d}(r,n))}}i.makeCalcdata=function(r,n){var d,l,y=r[n],v=r._length,_=function(w){return i.d2c(w,r.thetaunit)};if(y){if(t.isTypedArray(y)&&o==="linear"){if(v===y.length)return y;if(y.subarray)return y.subarray(0,v)}for(d=new Array(v),l=0;l<v;l++)d[l]=_(y[l])}else{var x=n+"0",T="d"+n,A=x in r?_(r[x]):0,S=r[T]?_(r[T]):(i.period||2*Math.PI)/v;for(d=new Array(v),l=0;l<v;l++)d[l]=A+l*S}return d},i.setGeometry=function(){var r,n,d,l,y=s.sector,v=y.map(g),_={clockwise:-1,counterclockwise:1}[i.direction],x=g(i.rotation),T=function(L){return _*L+x},A=function(L){return(L-x)/_};switch(o){case"linear":n=r=t.identity,l=g,d=p,i.range=t.isFullCircle(v)?[y[0],y[0]+360]:v.map(A).map(p);break;case"category":var S=i._categories.length,w=i.period?Math.max(i.period,S):S;w===0&&(w=1),n=l=function(L){return 2*L*Math.PI/w},r=d=function(L){return L*w/Math.PI/2},i.range=[0,w]}i.c2g=function(L){return T(n(L))},i.g2c=function(L){return r(A(L))},i.t2g=function(L){return T(l(L))},i.g2t=function(L){return d(A(L))}}})(e,f)}}},{"../../lib":787,"../cartesian/set_convert":859}],909:[function(h,N,H){var t=h("../lib"),m=h("../plot_api/plot_template"),g=h("./domain").defaults;N.exports=function(p,e,f,u){var i,s,o=u.type,a=u.attributes,c=u.handleDefaults,r=u.partition||"x",n=e._subplots[o],d=n.length,l=d&&n[0].replace(/\d+$/,"");function y(T,A){return t.coerce(i,s,a,T,A)}for(var v=0;v<d;v++){var _=n[v];i=p[_]?p[_]:p[_]={},s=m.newContainer(e,_,l),y("uirevision",e.uirevision);var x={};x[r]=[v/d,(v+1)/d],g(s,e,y,x),u.id=_,c(i,s,y,u)}}},{"../lib":787,"../plot_api/plot_template":827,"./domain":866}],910:[function(h,N,H){var t=h("../constants/docs");t.FORMAT_LINK,t.DATE_FORMAT_LINK;function m(g){var p=g.description?" "+g.description:"",e=g.keys||[];if(e.length>0){for(var f=[],u=0;u<e.length;u++)f[u]="`"+e[u]+"`";p+="Finally, the template string has access to ",p=e.length===1?"variable "+f[0]:"variables "+f.slice(0,-1).join(", ")+" and "+f.slice(-1)+"."}return p}H.hovertemplateAttrs=function(g,p){g=g||{},m(p=p||{});var e={valType:"string",dflt:"",editType:g.editType||"none"};return g.arrayOk!==!1&&(e.arrayOk=!0),e},H.texttemplateAttrs=function(g,p){g=g||{},m(p=p||{});var e={valType:"string",dflt:"",editType:g.editType||"calc"};return g.arrayOk!==!1&&(e.arrayOk=!0),e}},{"../constants/docs":758}],911:[function(h,N,H){var t=h("./ternary"),m=h("../../plots/get_data").getSubplotCalcData,g=h("../../lib").counterRegex;H.name="ternary";var p=H.attr="subplot";H.idRoot="ternary",H.idRegex=H.attrRegex=g("ternary"),(H.attributes={})[p]={valType:"subplotid",dflt:"ternary",editType:"calc"},H.layoutAttributes=h("./layout_attributes"),H.supplyLayoutDefaults=h("./layout_defaults"),H.plot=function(e){for(var f=e._fullLayout,u=e.calcdata,i=f._subplots.ternary,s=0;s<i.length;s++){var o=i[s],a=m(u,"ternary",o),c=f[o]._subplot;c||(c=new t({id:o,graphDiv:e,container:f._ternarylayer.node()},f),f[o]._subplot=c),c.plot(a,f,e._promises)}},H.clean=function(e,f,u,i){for(var s=i._subplots.ternary||[],o=0;o<s.length;o++){var a=s[o],c=i[a]._subplot;!f[a]&&c&&(c.plotContainer.remove(),c.clipDef.remove(),c.clipDefRelative.remove(),c.layers["a-title"].remove(),c.layers["b-title"].remove(),c.layers["c-title"].remove())}}},{"../../lib":787,"../../plots/get_data":875,"./layout_attributes":912,"./layout_defaults":913,"./ternary":914}],912:[function(h,N,H){var t=h("../../components/color/attributes"),m=h("../domain").attributes,g=h("../cartesian/layout_attributes"),p=h("../../plot_api/edit_types").overrideAll,e=h("../../lib/extend").extendFlat,f={title:{text:g.title.text,font:g.title.font},color:g.color,tickmode:g.tickmode,nticks:e({},g.nticks,{dflt:6,min:1}),tick0:g.tick0,dtick:g.dtick,tickvals:g.tickvals,ticktext:g.ticktext,ticks:g.ticks,ticklen:g.ticklen,tickwidth:g.tickwidth,tickcolor:g.tickcolor,showticklabels:g.showticklabels,showtickprefix:g.showtickprefix,tickprefix:g.tickprefix,showticksuffix:g.showticksuffix,ticksuffix:g.ticksuffix,showexponent:g.showexponent,exponentformat:g.exponentformat,minexponent:g.minexponent,separatethousands:g.separatethousands,tickfont:g.tickfont,tickangle:g.tickangle,tickformat:g.tickformat,tickformatstops:g.tickformatstops,hoverformat:g.hoverformat,showline:e({},g.showline,{dflt:!0}),linecolor:g.linecolor,linewidth:g.linewidth,showgrid:e({},g.showgrid,{dflt:!0}),gridcolor:g.gridcolor,gridwidth:g.gridwidth,layer:g.layer,min:{valType:"number",dflt:0,min:0},_deprecated:{title:g._deprecated.title,titlefont:g._deprecated.titlefont}},u=N.exports=p({domain:m({name:"ternary"}),bgcolor:{valType:"color",dflt:t.background},sum:{valType:"number",dflt:1,min:0},aaxis:f,baxis:f,caxis:f},"plot","from-root");u.uirevision={valType:"any",editType:"none"},u.aaxis.uirevision=u.baxis.uirevision=u.caxis.uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":649,"../../lib/extend":777,"../../plot_api/edit_types":820,"../cartesian/layout_attributes":853,"../domain":866}],913:[function(h,N,H){var t=h("../../components/color"),m=h("../../plot_api/plot_template"),g=h("../../lib"),p=h("../subplot_defaults"),e=h("../cartesian/tick_label_defaults"),f=h("../cartesian/tick_mark_defaults"),u=h("../cartesian/tick_value_defaults"),i=h("../cartesian/line_grid_defaults"),s=h("./layout_attributes"),o=["aaxis","baxis","caxis"];function a(r,n,d,l){var y,v,_,x=d("bgcolor"),T=d("sum");l.bgColor=t.combine(x,l.paper_bgcolor);for(var A=0;A<o.length;A++)v=r[y=o[A]]||{},(_=m.newContainer(n,y))._name=y,c(v,_,l,n);var S=n.aaxis,w=n.baxis,L=n.caxis;S.min+w.min+L.min>=T&&(S.min=0,w.min=0,L.min=0,r.aaxis&&delete r.aaxis.min,r.baxis&&delete r.baxis.min,r.caxis&&delete r.caxis.min)}function c(r,n,d,l){var y=s[n._name];function v(w,L){return g.coerce(r,n,y,w,L)}v("uirevision",l.uirevision),n.type="linear";var _=v("color"),x=_!==y.color.dflt?_:d.font.color,T=n._name.charAt(0).toUpperCase(),A="Component "+T,S=v("title.text",A);n._hovertitle=S===A?S:T,g.coerceFont(v,"title.font",{family:d.font.family,size:g.bigFont(d.font.size),color:x}),v("min"),u(r,n,v,"linear"),e(r,n,v,"linear",{}),f(r,n,v,{outerTicks:!0}),v("showticklabels")&&(g.coerceFont(v,"tickfont",{family:d.font.family,size:d.font.size,color:x}),v("tickangle"),v("tickformat")),i(r,n,v,{dfltColor:_,bgColor:d.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:y}),v("hoverformat"),v("layer")}N.exports=function(r,n,d){p(r,n,d,{type:"ternary",attributes:s,handleDefaults:a,font:n.font,paper_bgcolor:n.paper_bgcolor})}},{"../../components/color":650,"../../lib":787,"../../plot_api/plot_template":827,"../cartesian/line_grid_defaults":855,"../cartesian/tick_label_defaults":860,"../cartesian/tick_mark_defaults":861,"../cartesian/tick_value_defaults":862,"../subplot_defaults":909,"./layout_attributes":912}],914:[function(h,N,H){var t=h("@plotly/d3"),m=h("tinycolor2"),g=h("../../registry"),p=h("../../lib"),e=p.strTranslate,f=p._,u=h("../../components/color"),i=h("../../components/drawing"),s=h("../cartesian/set_convert"),o=h("../../lib/extend").extendFlat,a=h("../plots"),c=h("../cartesian/axes"),r=h("../../components/dragelement"),n=h("../../components/fx"),d=h("../../components/dragelement/helpers"),l=d.freeMode,y=d.rectMode,v=h("../../components/titles"),_=h("../cartesian/select").prepSelect,x=h("../cartesian/select").selectOnClick,T=h("../cartesian/select").clearSelect,A=h("../cartesian/select").clearSelectionsCache,S=h("../cartesian/constants");function w(W,Z){this.id=W.id,this.graphDiv=W.graphDiv,this.init(Z),this.makeFramework(Z),this.aTickLayout=null,this.bTickLayout=null,this.cTickLayout=null}N.exports=w;var L=w.prototype;L.init=function(W){this.container=W._ternarylayer,this.defs=W._defs,this.layoutId=W._uid,this.traceHash={},this.layers={}},L.plot=function(W,Z){var Q=Z[this.id],X=Z._size;this._hasClipOnAxisFalse=!1;for(var G=0;G<W.length;G++)if(W[G][0].trace.cliponaxis===!1){this._hasClipOnAxisFalse=!0;break}this.updateLayers(Q),this.adjustLayout(Q,X),a.generalUpdatePerTraceModule(this.graphDiv,this,W,Q),this.layers.plotbg.select("path").call(u.fill,Q.bgcolor)},L.makeFramework=function(W){var Z=this.graphDiv,Q=W[this.id],X=this.clipId="clip"+this.layoutId+this.id,G=this.clipIdRelative="clip-relative"+this.layoutId+this.id;this.clipDef=p.ensureSingleById(W._clips,"clipPath",X,function(Y){Y.append("path").attr("d","M0,0Z")}),this.clipDefRelative=p.ensureSingleById(W._clips,"clipPath",G,function(Y){Y.append("path").attr("d","M0,0Z")}),this.plotContainer=p.ensureSingle(this.container,"g",this.id),this.updateLayers(Q),i.setClipUrl(this.layers.backplot,X,Z),i.setClipUrl(this.layers.grids,X,Z)},L.updateLayers=function(W){var Z=this.layers,Q=["draglayer","plotbg","backplot","grids"];W.aaxis.layer==="below traces"&&Q.push("aaxis","aline"),W.baxis.layer==="below traces"&&Q.push("baxis","bline"),W.caxis.layer==="below traces"&&Q.push("caxis","cline"),Q.push("frontplot"),W.aaxis.layer==="above traces"&&Q.push("aaxis","aline"),W.baxis.layer==="above traces"&&Q.push("baxis","bline"),W.caxis.layer==="above traces"&&Q.push("caxis","cline");var X=this.plotContainer.selectAll("g.toplevel").data(Q,String),G=["agrid","bgrid","cgrid"];X.enter().append("g").attr("class",function(Y){return"toplevel "+Y}).each(function(Y){var K=t.select(this);Z[Y]=K,Y==="frontplot"?K.append("g").classed("scatterlayer",!0):Y==="backplot"?K.append("g").classed("maplayer",!0):Y==="plotbg"?K.append("path").attr("d","M0,0Z"):Y==="aline"||Y==="bline"||Y==="cline"?K.append("path"):Y==="grids"&&G.forEach(function(D){Z[D]=K.append("g").classed("grid "+D,!0)})}),X.order()};var k=Math.sqrt(4/3);L.adjustLayout=function(W,Z){var Q,X,G,Y,K,D,B=this,q=W.domain,ee=(q.x[0]+q.x[1])/2,J=(q.y[0]+q.y[1])/2,$=q.x[1]-q.x[0],te=q.y[1]-q.y[0],ie=$*Z.w,ae=te*Z.h,he=W.sum,se=W.aaxis.min,de=W.baxis.min,ce=W.caxis.min;ie>k*ae?G=(Y=ae)*k:Y=(G=ie)/k,K=$*G/ie,D=te*Y/ae,Q=Z.l+Z.w*ee-G/2,X=Z.t+Z.h*(1-J)-Y/2,B.x0=Q,B.y0=X,B.w=G,B.h=Y,B.sum=he,B.xaxis={type:"linear",range:[se+2*ce-he,he-se-2*de],domain:[ee-K/2,ee+K/2],_id:"x"},s(B.xaxis,B.graphDiv._fullLayout),B.xaxis.setScale(),B.xaxis.isPtWithinRange=function(De){return De.a>=B.aaxis.range[0]&&De.a<=B.aaxis.range[1]&&De.b>=B.baxis.range[1]&&De.b<=B.baxis.range[0]&&De.c>=B.caxis.range[1]&&De.c<=B.caxis.range[0]},B.yaxis={type:"linear",range:[se,he-de-ce],domain:[J-D/2,J+D/2],_id:"y"},s(B.yaxis,B.graphDiv._fullLayout),B.yaxis.setScale(),B.yaxis.isPtWithinRange=function(){return!0};var ve=B.yaxis.domain[0],ke=B.aaxis=o({},W.aaxis,{range:[se,he-de-ce],side:"left",tickangle:(+W.aaxis.tickangle||0)-30,domain:[ve,ve+D*k],anchor:"free",position:0,_id:"y",_length:G});s(ke,B.graphDiv._fullLayout),ke.setScale();var Ee=B.baxis=o({},W.baxis,{range:[he-se-ce,de],side:"bottom",domain:B.xaxis.domain,anchor:"free",position:0,_id:"x",_length:G});s(Ee,B.graphDiv._fullLayout),Ee.setScale();var be=B.caxis=o({},W.caxis,{range:[he-se-de,ce],side:"right",tickangle:(+W.caxis.tickangle||0)+30,domain:[ve,ve+D*k],anchor:"free",position:0,_id:"y",_length:G});s(be,B.graphDiv._fullLayout),be.setScale();var xe="M"+Q+","+(X+Y)+"h"+G+"l-"+G/2+",-"+Y+"Z";B.clipDef.select("path").attr("d",xe),B.layers.plotbg.select("path").attr("d",xe);var ue="M0,"+Y+"h"+G+"l-"+G/2+",-"+Y+"Z";B.clipDefRelative.select("path").attr("d",ue);var me=e(Q,X);B.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",me),B.clipDefRelative.select("path").attr("transform",null);var we=e(Q-Ee._offset,X+Y);B.layers.baxis.attr("transform",we),B.layers.bgrid.attr("transform",we);var Me=e(Q+G/2,X)+"rotate(30)"+e(0,-ke._offset);B.layers.aaxis.attr("transform",Me),B.layers.agrid.attr("transform",Me);var Se=e(Q+G/2,X)+"rotate(-30)"+e(0,-be._offset);B.layers.caxis.attr("transform",Se),B.layers.cgrid.attr("transform",Se),B.drawAxes(!0),B.layers.aline.select("path").attr("d",ke.showline?"M"+Q+","+(X+Y)+"l"+G/2+",-"+Y:"M0,0").call(u.stroke,ke.linecolor||"#000").style("stroke-width",(ke.linewidth||0)+"px"),B.layers.bline.select("path").attr("d",Ee.showline?"M"+Q+","+(X+Y)+"h"+G:"M0,0").call(u.stroke,Ee.linecolor||"#000").style("stroke-width",(Ee.linewidth||0)+"px"),B.layers.cline.select("path").attr("d",be.showline?"M"+(Q+G/2)+","+X+"l"+G/2+","+Y:"M0,0").call(u.stroke,be.linecolor||"#000").style("stroke-width",(be.linewidth||0)+"px"),B.graphDiv._context.staticPlot||B.initInteractions(),i.setClipUrl(B.layers.frontplot,B._hasClipOnAxisFalse?null:B.clipId,B.graphDiv)},L.drawAxes=function(W){var Z=this.graphDiv,Q=this.id.substr(7)+"title",X=this.layers,G=this.aaxis,Y=this.baxis,K=this.caxis;if(this.drawAx(G),this.drawAx(Y),this.drawAx(K),W){var D=Math.max(G.showticklabels?G.tickfont.size/2:0,(K.showticklabels?.75*K.tickfont.size:0)+(K.ticks==="outside"?.87*K.ticklen:0)),B=(Y.showticklabels?Y.tickfont.size:0)+(Y.ticks==="outside"?Y.ticklen:0)+3;X["a-title"]=v.draw(Z,"a"+Q,{propContainer:G,propName:this.id+".aaxis.title",placeholder:f(Z,"Click to enter Component A title"),attributes:{x:this.x0+this.w/2,y:this.y0-G.title.font.size/3-D,"text-anchor":"middle"}}),X["b-title"]=v.draw(Z,"b"+Q,{propContainer:Y,propName:this.id+".baxis.title",placeholder:f(Z,"Click to enter Component B title"),attributes:{x:this.x0-B,y:this.y0+this.h+.83*Y.title.font.size+B,"text-anchor":"middle"}}),X["c-title"]=v.draw(Z,"c"+Q,{propContainer:K,propName:this.id+".caxis.title",placeholder:f(Z,"Click to enter Component C title"),attributes:{x:this.x0+this.w+B,y:this.y0+this.h+.83*K.title.font.size+B,"text-anchor":"middle"}})}},L.drawAx=function(W){var Z,Q=this.graphDiv,X=W._name,G=X.charAt(0),Y=W._id,K=this.layers[X],D=G+"tickLayout",B=(Z=W).ticks+String(Z.ticklen)+String(Z.showticklabels);this[D]!==B&&(K.selectAll("."+Y+"tick").remove(),this[D]=B),W.setScale();var q=c.calcTicks(W),ee=c.clipEnds(W,q),J=c.makeTransTickFn(W),$=c.getTickSigns(W)[2],te=p.deg2rad(30),ie=$*(W.linewidth||1)/2,ae=$*W.ticklen,he=this.w,se=this.h,de=G==="b"?"M0,"+ie+"l"+Math.sin(te)*ae+","+Math.cos(te)*ae:"M"+ie+",0l"+Math.cos(te)*ae+","+-Math.sin(te)*ae,ce={a:"M0,0l"+se+",-"+he/2,b:"M0,0l-"+he/2+",-"+se,c:"M0,0l-"+se+","+he/2}[G];c.drawTicks(Q,W,{vals:W.ticks==="inside"?ee:q,layer:K,path:de,transFn:J,crisp:!1}),c.drawGrid(Q,W,{vals:ee,layer:this.layers[G+"grid"],path:ce,transFn:J,crisp:!1}),c.drawLabels(Q,W,{vals:q,layer:K,transFn:J,labelFns:c.makeLabelFns(W,0,30)})};var C=S.MINZOOM/2+.87,M="m-0.87,.5h"+C+"v3h-"+(C+5.2)+"l"+(C/2+2.6)+",-"+(.87*C+4.5)+"l2.6,1.5l-"+C/2+","+.87*C+"Z",P="m0.87,.5h-"+C+"v3h"+(C+5.2)+"l-"+(C/2+2.6)+",-"+(.87*C+4.5)+"l-2.6,1.5l"+C/2+","+.87*C+"Z",O="m0,1l"+C/2+","+.87*C+"l2.6,-1.5l-"+(C/2+2.6)+",-"+(.87*C+4.5)+"l-"+(C/2+2.6)+","+(.87*C+4.5)+"l2.6,1.5l"+C/2+",-"+.87*C+"Z",F=!0;function j(W){t.select(W).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}L.clearSelect=function(){A(this.dragOptions),T(this.dragOptions.gd)},L.initInteractions=function(){var W,Z,Q,X,G,Y,K,D,B,q,ee,J,$=this,te=$.layers.plotbg.select("path").node(),ie=$.graphDiv,ae=ie._fullLayout._zoomlayer;function he(ue){var me={};return me[$.id+".aaxis.min"]=ue.a,me[$.id+".baxis.min"]=ue.b,me[$.id+".caxis.min"]=ue.c,me}function se(ue,me){var we=ie._fullLayout.clickmode;j(ie),ue===2&&(ie.emit("plotly_doubleclick",null),g.call("_guiRelayout",ie,he({a:0,b:0,c:0}))),we.indexOf("select")>-1&&ue===1&&x(me,ie,[$.xaxis],[$.yaxis],$.id,$.dragOptions),we.indexOf("event")>-1&&n.click(ie,me,$.id)}function de(ue,me){return 1-me/$.h}function ce(ue,me){return 1-(ue+($.h-me)/Math.sqrt(3))/$.w}function ve(ue,me){return(ue-($.h-me)/Math.sqrt(3))/$.w}function ke(ue,me){var we=Q+ue*W,Me=X+me*Z,Se=Math.max(0,Math.min(1,de(0,X),de(0,Me))),De=Math.max(0,Math.min(1,ce(Q,X),ce(we,Me))),Fe=Math.max(0,Math.min(1,ve(Q,X),ve(we,Me))),Ye=(Se/2+Fe)*$.w,et=(1-Se/2-De)*$.w,Oe=(Ye+et)/2,je=et-Ye,We=(1-Se)*$.h,Ge=We-je/k;je<S.MINZOOM?(K=G,ee.attr("d",B),J.attr("d","M0,0Z")):(K={a:G.a+Se*Y,b:G.b+De*Y,c:G.c+Fe*Y},ee.attr("d",B+"M"+Ye+","+We+"H"+et+"L"+Oe+","+Ge+"L"+Ye+","+We+"Z"),J.attr("d","M"+Q+","+X+"m0.5,0.5h5v-2h-5v-5h-2v5h-5v2h5v5h2ZM"+Ye+","+We+M+"M"+et+","+We+P+"M"+Oe+","+Ge+O)),q||(ee.transition().style("fill",D>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),J.transition().style("opacity",1).duration(200),q=!0),ie.emit("plotly_relayouting",he(K))}function Ee(){j(ie),K!==G&&(g.call("_guiRelayout",ie,he(K)),F&&ie.data&&ie._context.showTips&&(p.notifier(f(ie,"Double-click to zoom back out"),"long"),F=!1))}function be(ue,me){var we=ue/$.xaxis._m,Me=me/$.yaxis._m,Se=[(K={a:G.a-Me,b:G.b+(we+Me)/2,c:G.c-(we-Me)/2}).a,K.b,K.c].sort(p.sorterAsc),De=Se.indexOf(K.a),Fe=Se.indexOf(K.b),Ye=Se.indexOf(K.c);Se[0]<0&&(Se[1]+Se[0]/2<0?(Se[2]+=Se[0]+Se[1],Se[0]=Se[1]=0):(Se[2]+=Se[0]/2,Se[1]+=Se[0]/2,Se[0]=0),K={a:Se[De],b:Se[Fe],c:Se[Ye]},me=(G.a-K.a)*$.yaxis._m,ue=(G.c-K.c-G.b+K.b)*$.xaxis._m);var et=e($.x0+ue,$.y0+me);$.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",et);var Oe=e(-ue,-me);$.clipDefRelative.select("path").attr("transform",Oe),$.aaxis.range=[K.a,$.sum-K.b-K.c],$.baxis.range=[$.sum-K.a-K.c,K.b],$.caxis.range=[$.sum-K.a-K.b,K.c],$.drawAxes(!1),$._hasClipOnAxisFalse&&$.plotContainer.select(".scatterlayer").selectAll(".trace").call(i.hideOutsideRangePoints,$),ie.emit("plotly_relayouting",he(K))}function xe(){g.call("_guiRelayout",ie,he(K))}this.dragOptions={element:te,gd:ie,plotinfo:{id:$.id,domain:ie._fullLayout[$.id].domain,xaxis:$.xaxis,yaxis:$.yaxis},subplot:$.id,prepFn:function(ue,me,we){$.dragOptions.xaxes=[$.xaxis],$.dragOptions.yaxes=[$.yaxis],W=ie._fullLayout._invScaleX,Z=ie._fullLayout._invScaleY;var Me=$.dragOptions.dragmode=ie._fullLayout.dragmode;l(Me)?$.dragOptions.minDrag=1:$.dragOptions.minDrag=void 0,Me==="zoom"?($.dragOptions.moveFn=ke,$.dragOptions.clickFn=se,$.dragOptions.doneFn=Ee,function(Se,De,Fe){var Ye=te.getBoundingClientRect();Q=De-Ye.left,X=Fe-Ye.top,ie._fullLayout._calcInverseTransform(ie);var et=ie._fullLayout._invTransform,Oe=p.apply3DTransform(et)(Q,X);Q=Oe[0],X=Oe[1],G={a:$.aaxis.range[0],b:$.baxis.range[1],c:$.caxis.range[1]},K=G,Y=$.aaxis.range[1]-G.a,D=m($.graphDiv._fullLayout[$.id].bgcolor).getLuminance(),B="M0,"+$.h+"L"+$.w/2+", 0L"+$.w+","+$.h+"Z",q=!1,ee=ae.append("path").attr("class","zoombox").attr("transform",e($.x0,$.y0)).style({fill:D>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("d",B),J=ae.append("path").attr("class","zoombox-corners").attr("transform",e($.x0,$.y0)).style({fill:u.background,stroke:u.defaultLine,"stroke-width":1,opacity:0}).attr("d","M0,0Z"),$.clearSelect(ie)}(0,me,we)):Me==="pan"?($.dragOptions.moveFn=be,$.dragOptions.clickFn=se,$.dragOptions.doneFn=xe,G={a:$.aaxis.range[0],b:$.baxis.range[1],c:$.caxis.range[1]},K=G,$.clearSelect(ie)):(y(Me)||l(Me))&&_(ue,me,we,$.dragOptions,Me)}},te.onmousemove=function(ue){n.hover(ie,ue,$.id),ie._fullLayout._lasthover=te,ie._fullLayout._hoversubplot=$.id},te.onmouseout=function(ue){ie._dragging||r.unhover(ie,ue)},r.init(this.dragOptions)}},{"../../components/color":650,"../../components/dragelement":669,"../../components/dragelement/helpers":668,"../../components/drawing":672,"../../components/fx":690,"../../components/titles":748,"../../lib":787,"../../lib/extend":777,"../../registry":915,"../cartesian/axes":838,"../cartesian/constants":845,"../cartesian/select":858,"../cartesian/set_convert":859,"../plots":901,"@plotly/d3":58,tinycolor2:583}],915:[function(h,N,H){var t=h("./lib/loggers"),m=h("./lib/noop"),g=h("./lib/push_unique"),p=h("./lib/is_plain_object"),e=h("./lib/dom").addStyleRule,f=h("./lib/extend"),u=h("./plots/attributes"),i=h("./plots/layout_attributes"),s=f.extendFlat,o=f.extendDeepAll;function a(x){var T=x.name,A=x.categories,S=x.meta;if(H.modules[T])t.log("Type "+T+" already registered");else{H.subplotsRegistry[x.basePlotModule.name]||function(F){var j=F.name;if(H.subplotsRegistry[j])return void t.log("Plot type "+j+" already registered.");for(var W in d(F),H.subplotsRegistry[j]=F,H.componentsRegistry)v(W,F.name)}(x.basePlotModule);for(var w={},L=0;L<A.length;L++)w[A[L]]=!0,H.allCategories[A[L]]=!0;for(var k in H.modules[T]={_module:x,categories:w},S&&Object.keys(S).length&&(H.modules[T].meta=S),H.allTypes.push(T),H.componentsRegistry)l(k,T);x.layoutAttributes&&s(H.traceLayoutAttributes,x.layoutAttributes);var C=x.basePlotModule,M=C.name;if(M==="mapbox"){var P=C.constants.styleRules;for(var O in P)e(".js-plotly-plot .plotly .mapboxgl-"+O,P[O])}M!=="geo"&&M!=="mapbox"||typeof window===void 0||window.PlotlyGeoAssets!==void 0||(window.PlotlyGeoAssets={topojson:{}})}}function c(x){if(typeof x.name!="string")throw new Error("Component module *name* must be a string.");var T=x.name;for(var A in H.componentsRegistry[T]=x,x.layoutAttributes&&(x.layoutAttributes._isLinkedToArray&&g(H.layoutArrayContainers,T),d(x)),H.modules)l(T,A);for(var S in H.subplotsRegistry)v(T,S);for(var w in H.transformsRegistry)y(T,w);x.schema&&x.schema.layout&&o(i,x.schema.layout)}function r(x){if(typeof x.name!="string")throw new Error("Transform module *name* must be a string.");var T="Transform module "+x.name,A=typeof x.transform=="function",S=typeof x.calcTransform=="function";if(!A&&!S)throw new Error(T+" is missing a *transform* or *calcTransform* method.");for(var w in A&&S&&t.log([T+" has both a *transform* and *calcTransform* methods.","Please note that all *transform* methods are executed","before all *calcTransform* methods."].join(" ")),p(x.attributes)||t.log(T+" registered without an *attributes* object."),typeof x.supplyDefaults!="function"&&t.log(T+" registered without a *supplyDefaults* method."),H.transformsRegistry[x.name]=x,H.componentsRegistry)y(w,x.name)}function n(x){var T=x.name,A=T.split("-")[0],S=x.dictionary,w=x.format,L=S&&Object.keys(S).length,k=w&&Object.keys(w).length,C=H.localeRegistry,M=C[T];if(M||(C[T]=M={}),A!==T){var P=C[A];P||(C[A]=P={}),L&&P.dictionary===M.dictionary&&(P.dictionary=S),k&&P.format===M.format&&(P.format=w)}L&&(M.dictionary=S),k&&(M.format=w)}function d(x){if(x.layoutAttributes){var T=x.layoutAttributes._arrayAttrRegexps;if(T)for(var A=0;A<T.length;A++)g(H.layoutArrayRegexes,T[A])}}function l(x,T){var A=H.componentsRegistry[x].schema;if(A&&A.traces){var S=A.traces[T];S&&o(H.modules[T]._module.attributes,S)}}function y(x,T){var A=H.componentsRegistry[x].schema;if(A&&A.transforms){var S=A.transforms[T];S&&o(H.transformsRegistry[T].attributes,S)}}function v(x,T){var A=H.componentsRegistry[x].schema;if(A&&A.subplots){var S=H.subplotsRegistry[T],w=S.layoutAttributes,L=S.attr==="subplot"?S.name:S.attr;Array.isArray(L)&&(L=L[0]);var k=A.subplots[L];w&&k&&o(w,k)}}function _(x){return typeof x=="object"&&(x=x.type),x}H.modules={},H.allCategories={},H.allTypes=[],H.subplotsRegistry={},H.transformsRegistry={},H.componentsRegistry={},H.layoutArrayContainers=[],H.layoutArrayRegexes=[],H.traceLayoutAttributes={},H.localeRegistry={},H.apiMethodRegistry={},H.collectableSubplotTypes=null,H.register=function(x){if(H.collectableSubplotTypes=null,!x)throw new Error("No argument passed to Plotly.register.");x&&!Array.isArray(x)&&(x=[x]);for(var T=0;T<x.length;T++){var A=x[T];if(!A)throw new Error("Invalid module was attempted to be registered!");switch(A.moduleType){case"trace":a(A);break;case"transform":r(A);break;case"component":c(A);break;case"locale":n(A);break;case"apiMethod":var S=A.name;H.apiMethodRegistry[S]=A.fn;break;default:throw new Error("Invalid module was attempted to be registered!")}}},H.getModule=function(x){var T=H.modules[_(x)];return!!T&&T._module},H.traceIs=function(x,T){if((x=_(x))==="various")return!1;var A=H.modules[x];return A||(x&&t.log("Unrecognized trace type "+x+"."),A=H.modules[u.type.dflt]),!!A.categories[T]},H.getTransformIndices=function(x,T){for(var A=[],S=x.transforms||[],w=0;w<S.length;w++)S[w].type===T&&A.push(w);return A},H.hasTransform=function(x,T){for(var A=x.transforms||[],S=0;S<A.length;S++)if(A[S].type===T)return!0;return!1},H.getComponentMethod=function(x,T){var A=H.componentsRegistry[x];return A&&A[T]||m},H.call=function(){var x=arguments[0],T=[].slice.call(arguments,1);return H.apiMethodRegistry[x].apply(null,T)}},{"./lib/dom":775,"./lib/extend":777,"./lib/is_plain_object":788,"./lib/loggers":791,"./lib/noop":796,"./lib/push_unique":802,"./plots/attributes":834,"./plots/layout_attributes":892}],916:[function(h,N,H){var t=h("../registry"),m=h("../lib"),g=m.extendFlat,p=m.extendDeep;function e(f){var u;switch(f){case"themes__thumb":u={autosize:!0,width:150,height:150,title:{text:""},showlegend:!1,margin:{l:5,r:5,t:5,b:5,pad:0},annotations:[]};break;case"thumbnail":u={title:{text:""},hidesources:!0,showlegend:!1,borderwidth:0,bordercolor:"",margin:{l:1,r:1,t:1,b:1,pad:0},annotations:[]};break;default:u={}}return u}N.exports=function(f,u){var i,s,o=f.data,a=f.layout,c=p([],o),r=p({},a,e(u.tileClass)),n=f._context||{};if(u.width&&(r.width=u.width),u.height&&(r.height=u.height),u.tileClass==="thumbnail"||u.tileClass==="themes__thumb"){r.annotations=[];var d=Object.keys(r);for(i=0;i<d.length;i++)s=d[i],["xaxis","yaxis","zaxis"].indexOf(s.slice(0,5))>-1&&(r[d[i]].title={text:""});for(i=0;i<c.length;i++){var l=c[i];l.showscale=!1,l.marker&&(l.marker.showscale=!1),t.traceIs(l,"pie-like")&&(l.textposition="none")}}if(Array.isArray(u.annotations))for(i=0;i<u.annotations.length;i++)r.annotations.push(u.annotations[i]);var y=Object.keys(r).filter(function(A){return A.match(/^scene\d*$/)});if(y.length){var v={};for(u.tileClass==="thumbnail"&&(v={title:{text:""},showaxeslabels:!1,showticklabels:!1,linetickenable:!1}),i=0;i<y.length;i++){var _=r[y[i]];_.xaxis||(_.xaxis={}),_.yaxis||(_.yaxis={}),_.zaxis||(_.zaxis={}),g(_.xaxis,v),g(_.yaxis,v),g(_.zaxis,v),_._scene=null}}var x=document.createElement("div");u.tileClass&&(x.className=u.tileClass);var T={gd:x,td:x,layout:r,data:c,config:{staticPlot:u.staticPlot===void 0||u.staticPlot,plotGlPixelRatio:u.plotGlPixelRatio===void 0?2:u.plotGlPixelRatio,displaylogo:u.displaylogo||!1,showLink:u.showLink||!1,showTips:u.showTips||!1,mapboxAccessToken:n.mapboxAccessToken}};return u.setBackground!=="transparent"&&(T.config.setBackground=u.setBackground||"opaque"),T.gd.defaultLayout=e(u.tileClass),T}},{"../lib":787,"../registry":915}],917:[function(h,N,H){var t=h("../lib"),m=h("../plot_api/to_image"),g=h("./filesaver"),p=h("./helpers");N.exports=function(e,f){var u;return t.isPlainObject(e)||(u=t.getGraphDiv(e)),(f=f||{}).format=f.format||"png",f.width=f.width||null,f.height=f.height||null,f.imageDataOnly=!0,new Promise(function(i,s){u&&u._snapshotInProgress&&s(new Error("Snapshotting already in progress.")),t.isIE()&&f.format!=="svg"&&s(new Error(p.MSG_IE_BAD_FORMAT)),u&&(u._snapshotInProgress=!0);var o=m(e,f),a=f.filename||e.fn||"newplot";a+="."+f.format.replace("-","."),o.then(function(c){return u&&(u._snapshotInProgress=!1),g(c,a,f.format)}).then(function(c){i(c)}).catch(function(c){u&&(u._snapshotInProgress=!1),s(c)})})}},{"../lib":787,"../plot_api/to_image":830,"./filesaver":918,"./helpers":919}],918:[function(h,N,H){var t=h("../lib"),m=h("./helpers");N.exports=function(g,p,e){var f=document.createElement("a"),u="download"in f;return new Promise(function(i,s){var o,a;if(t.isIE())return o=m.createBlob(g,"svg"),window.navigator.msSaveBlob(o,p),o=null,i(p);if(u)return o=m.createBlob(g,e),a=m.createObjectURL(o),f.href=a,f.download=p,document.body.appendChild(f),f.click(),document.body.removeChild(f),m.revokeObjectURL(a),o=null,i(p);if(t.isSafari()){var c=e==="svg"?",":";base64,";return m.octetStream(c+encodeURIComponent(g)),i(p)}s(new Error("download error"))})}},{"../lib":787,"./helpers":919}],919:[function(h,N,H){var t=h("../registry");H.getDelay=function(g){return g._has&&(g._has("gl3d")||g._has("gl2d")||g._has("mapbox"))?500:0},H.getRedrawFunc=function(g){return function(){t.getComponentMethod("colorbar","draw")(g)}},H.encodeSVG=function(g){return"data:image/svg+xml,"+encodeURIComponent(g)},H.encodeJSON=function(g){return"data:application/json,"+encodeURIComponent(g)};var m=window.URL||window.webkitURL;H.createObjectURL=function(g){return m.createObjectURL(g)},H.revokeObjectURL=function(g){return m.revokeObjectURL(g)},H.createBlob=function(g,p){if(p==="svg")return new window.Blob([g],{type:"image/svg+xml;charset=utf-8"});if(p==="full-json")return new window.Blob([g],{type:"application/json;charset=utf-8"});var e=function(f){for(var u=f.length,i=new ArrayBuffer(u),s=new Uint8Array(i),o=0;o<u;o++)s[o]=f.charCodeAt(o);return i}(window.atob(g));return new window.Blob([e],{type:"image/"+p})},H.octetStream=function(g){document.location.href="data:application/octet-stream"+g},H.IMAGE_URL_PREFIX=/^data:image\/\w+;base64,/,H.MSG_IE_BAD_FORMAT="Sorry IE does not support downloading from canvas. Try {format:'svg'} instead."},{"../registry":915}],920:[function(h,N,H){var t=h("./helpers"),m={getDelay:t.getDelay,getRedrawFunc:t.getRedrawFunc,clone:h("./cloneplot"),toSVG:h("./tosvg"),svgToImg:h("./svgtoimg"),toImage:h("./toimage"),downloadImage:h("./download")};N.exports=m},{"./cloneplot":916,"./download":917,"./helpers":919,"./svgtoimg":921,"./toimage":922,"./tosvg":923}],921:[function(h,N,H){var t=h("../lib"),m=h("events").EventEmitter,g=h("./helpers");N.exports=function(p){var e=p.emitter||new m,f=new Promise(function(u,i){var s=window.Image,o=p.svg,a=p.format||"png";if(t.isIE()&&a!=="svg"){var c=new Error(g.MSG_IE_BAD_FORMAT);return i(c),p.promise?f:e.emit("error",c)}var r,n,d=p.canvas,l=p.scale||1,y=p.width||300,v=p.height||150,_=l*y,x=l*v,T=d.getContext("2d"),A=new s;a==="svg"||t.isSafari()?n=g.encodeSVG(o):(r=g.createBlob(o,"svg"),n=g.createObjectURL(r)),d.width=_,d.height=x,A.onload=function(){var S;switch(r=null,g.revokeObjectURL(n),a!=="svg"&&T.drawImage(A,0,0,_,x),a){case"jpeg":S=d.toDataURL("image/jpeg");break;case"png":S=d.toDataURL("image/png");break;case"webp":S=d.toDataURL("image/webp");break;case"svg":S=n;break;default:var w="Image format is not jpeg, png, svg or webp.";if(i(new Error(w)),!p.promise)return e.emit("error",w)}u(S),p.promise||e.emit("success",S)},A.onerror=function(S){if(r=null,g.revokeObjectURL(n),i(S),!p.promise)return e.emit("error",S)},A.src=n});return p.promise?f:e}},{"../lib":787,"./helpers":919,events:116}],922:[function(h,N,H){var t=h("events").EventEmitter,m=h("../registry"),g=h("../lib"),p=h("./helpers"),e=h("./cloneplot"),f=h("./tosvg"),u=h("./svgtoimg");N.exports=function(i,s){var o=new t,a=e(i,{format:"png"}),c=a.gd;c.style.position="absolute",c.style.left="-5000px",document.body.appendChild(c);var r=p.getRedrawFunc(c);return m.call("_doPlot",c,a.data,a.layout,a.config).then(r).then(function(){var n=p.getDelay(c._fullLayout);setTimeout(function(){var d=f(c),l=document.createElement("canvas");l.id=g.randstr(),(o=u({format:s.format,width:c._fullLayout.width,height:c._fullLayout.height,canvas:l,emitter:o,svg:d})).clean=function(){c&&document.body.removeChild(c)}},n)}).catch(function(n){o.emit("error",n)}),o}},{"../lib":787,"../registry":915,"./cloneplot":916,"./helpers":919,"./svgtoimg":921,"./tosvg":923,events:116}],923:[function(h,N,H){var t=h("@plotly/d3"),m=h("../lib"),g=h("../components/drawing"),p=h("../components/color"),e=h("../constants/xmlns_namespaces"),f=/"/g,u=new RegExp('("TOBESTRIPPED)|(TOBESTRIPPED")',"g");N.exports=function(i,s,o){var a,c,r=i._fullLayout,n=r._paper,d=r._toppaper,l=r.width,y=r.height;n.insert("rect",":first-child").call(g.setRect,0,0,l,y).call(p.fill,r.paper_bgcolor);var v=r._basePlotModules||[];for(a=0;a<v.length;a++){var _=v[a];_.toSVG&&_.toSVG(i)}if(d){var x=d.node().childNodes,T=Array.prototype.slice.call(x);for(a=0;a<T.length;a++){var A=T[a];A.childNodes.length&&n.node().appendChild(A)}}r._draggers&&r._draggers.remove(),n.node().style.background="",n.selectAll("text").attr({"data-unformatted":null,"data-math":null}).each(function(){var L=t.select(this);if(this.style.visibility!=="hidden"&&this.style.display!=="none"){L.style({visibility:null,display:null});var k=this.style.fontFamily;k&&k.indexOf('"')!==-1&&L.style("font-family",k.replace(f,"TOBESTRIPPED"))}else L.remove()});var S=[];if(r._gradientUrlQueryParts)for(c in r._gradientUrlQueryParts)S.push(c);if(r._patternUrlQueryParts)for(c in r._patternUrlQueryParts)S.push(c);S.length&&n.selectAll(S.join(",")).each(function(){var L=t.select(this),k=this.style.fill;k&&k.indexOf("url(")!==-1&&L.style("fill",k.replace(f,"TOBESTRIPPED"));var C=this.style.stroke;C&&C.indexOf("url(")!==-1&&L.style("stroke",C.replace(f,"TOBESTRIPPED"))}),s!=="pdf"&&s!=="eps"||n.selectAll("#MathJax_SVG_glyphs path").attr("stroke-width",0),n.node().setAttributeNS(e.xmlns,"xmlns",e.svg),n.node().setAttributeNS(e.xmlns,"xmlns:xlink",e.xlink),s==="svg"&&o&&(n.attr("width",o*l),n.attr("height",o*y),n.attr("viewBox","0 0 "+l+" "+y));var w=new window.XMLSerializer().serializeToString(n.node());return w=function(L){var k=t.select("body").append("div").style({display:"none"}).html(""),C=L.replace(/(&[^;]*;)/gi,function(M){return M==="&lt;"?"&#60;":M==="&rt;"?"&#62;":M.indexOf("<")!==-1||M.indexOf(">")!==-1?"":k.html(M).text()});return k.remove(),C}(w),w=(w=w.replace(/&(?!\w+;|\#[0-9]+;| \#x[0-9A-F]+;)/g,"&amp;")).replace(u,"'"),m.isIE()&&(w=(w=(w=w.replace(/"/gi,"'")).replace(/(\('#)([^']*)('\))/gi,'("#$2")')).replace(/(\\')/gi,'"')),w}},{"../components/color":650,"../components/drawing":672,"../constants/xmlns_namespaces":764,"../lib":787,"@plotly/d3":58}],924:[function(h,N,H){var t=h("../../lib");N.exports=function(m,g){for(var p=0;p<m.length;p++)m[p].i=p;t.mergeArray(g.text,m,"tx"),t.mergeArray(g.hovertext,m,"htx");var e=g.marker;if(e){t.mergeArray(e.opacity,m,"mo",!0),t.mergeArray(e.color,m,"mc");var f=e.line;f&&(t.mergeArray(f.color,m,"mlc"),t.mergeArrayCastPositive(f.width,m,"mlw"))}}},{"../../lib":787}],925:[function(h,N,H){var t=h("../scatter/attributes"),m=h("../../plots/cartesian/axis_format_attributes").axisHoverFormat,g=h("../../plots/template_attributes").hovertemplateAttrs,p=h("../../plots/template_attributes").texttemplateAttrs,e=h("../../components/colorscale/attributes"),f=h("../../plots/font_attributes"),u=h("./constants"),i=h("../../components/drawing/attributes").pattern,s=h("../../lib/extend").extendFlat,o=f({editType:"calc",arrayOk:!0,colorEditType:"style"}),a=s({},t.marker.line.width,{dflt:0}),c=s({width:a,editType:"calc"},e("marker.line")),r=s({line:c,editType:"calc"},e("marker"),{opacity:{valType:"number",arrayOk:!0,dflt:1,min:0,max:1,editType:"style"},pattern:i});N.exports={x:t.x,x0:t.x0,dx:t.dx,y:t.y,y0:t.y0,dy:t.dy,xperiod:t.xperiod,yperiod:t.yperiod,xperiod0:t.xperiod0,yperiod0:t.yperiod0,xperiodalignment:t.xperiodalignment,yperiodalignment:t.yperiodalignment,xhoverformat:m("x"),yhoverformat:m("y"),text:t.text,texttemplate:p({editType:"plot"},{keys:u.eventDataKeys}),hovertext:t.hovertext,hovertemplate:g({},{keys:u.eventDataKeys}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"calc"},insidetextanchor:{valType:"enumerated",values:["end","middle","start"],dflt:"end",editType:"plot"},textangle:{valType:"angle",dflt:"auto",editType:"plot"},textfont:s({},o,{}),insidetextfont:s({},o,{}),outsidetextfont:s({},o,{}),constraintext:{valType:"enumerated",values:["inside","outside","both","none"],dflt:"both",editType:"calc"},cliponaxis:s({},t.cliponaxis,{}),orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},base:{valType:"any",dflt:null,arrayOk:!0,editType:"calc"},offset:{valType:"number",dflt:null,arrayOk:!0,editType:"calc"},width:{valType:"number",dflt:null,min:0,arrayOk:!0,editType:"calc"},marker:r,offsetgroup:{valType:"string",dflt:"",editType:"calc"},alignmentgroup:{valType:"string",dflt:"",editType:"calc"},selected:{marker:{opacity:t.selected.marker.opacity,color:t.selected.marker.color,editType:"style"},textfont:t.selected.textfont,editType:"style"},unselected:{marker:{opacity:t.unselected.marker.opacity,color:t.unselected.marker.color,editType:"style"},textfont:t.unselected.textfont,editType:"style"},_deprecated:{bardir:{valType:"enumerated",editType:"calc",values:["v","h"]}}}},{"../../components/colorscale/attributes":657,"../../components/drawing/attributes":671,"../../lib/extend":777,"../../plots/cartesian/axis_format_attributes":841,"../../plots/font_attributes":867,"../../plots/template_attributes":910,"../scatter/attributes":1202,"./constants":927}],926:[function(h,N,H){var t=h("../../plots/cartesian/axes"),m=h("../../plots/cartesian/align_period"),g=h("../../components/colorscale/helpers").hasColorscale,p=h("../../components/colorscale/calc"),e=h("./arrays_to_calcdata"),f=h("../scatter/calc_selection");N.exports=function(u,i){var s,o,a,c,r,n,d=t.getFromId(u,i.xaxis||"x"),l=t.getFromId(u,i.yaxis||"y"),y={msUTC:!(!i.base&&i.base!==0)};i.orientation==="h"?(s=d.makeCalcdata(i,"x",y),a=l.makeCalcdata(i,"y"),c=m(i,l,"y",a),r=!!i.yperiodalignment,n="y"):(s=l.makeCalcdata(i,"y",y),a=d.makeCalcdata(i,"x"),c=m(i,d,"x",a),r=!!i.xperiodalignment,n="x"),o=c.vals;for(var v=Math.min(o.length,s.length),_=new Array(v),x=0;x<v;x++)_[x]={p:o[x],s:s[x]},r&&(_[x].orig_p=a[x],_[x][n+"End"]=c.ends[x],_[x][n+"Start"]=c.starts[x]),i.ids&&(_[x].id=String(i.ids[x]));return g(i,"marker")&&p(u,i,{vals:i.marker.color,containerStr:"marker",cLetter:"c"}),g(i,"marker.line")&&p(u,i,{vals:i.marker.line.color,containerStr:"marker.line",cLetter:"c"}),e(_,i),f(_,i),_}},{"../../components/colorscale/calc":658,"../../components/colorscale/helpers":661,"../../plots/cartesian/align_period":835,"../../plots/cartesian/axes":838,"../scatter/calc_selection":1204,"./arrays_to_calcdata":924}],927:[function(h,N,H){N.exports={TEXTPAD:3,eventDataKeys:["value","label"]}},{}],928:[function(h,N,H){var t=h("fast-isnumeric"),m=h("../../lib").isArrayOrTypedArray,g=h("../../constants/numerical").BADNUM,p=h("../../registry"),e=h("../../plots/cartesian/axes"),f=h("../../plots/cartesian/constraints").getAxisGroup,u=h("./sieve.js");function i(v,_,x,T,A){if(T.length){var S,w,L,k;switch(function(C,M){var P,O;for(P=0;P<M.length;P++){var F,j=M[P],W=j[0].trace,Z=W.type==="funnel"?W._base:W.base,Q=W.orientation==="h"?W.xcalendar:W.ycalendar,X=C.type==="category"||C.type==="multicategory"?function(){return null}:C.d2c;if(m(Z)){for(O=0;O<Math.min(Z.length,j.length);O++)F=X(Z[O],0,Q),t(F)?(j[O].b=+F,j[O].hasB=1):j[O].b=0;for(;O<j.length;O++)j[O].b=0}else{F=X(Z,0,Q);var G=t(F);for(F=G?F:0,O=0;O<j.length;O++)j[O].b=F,G&&(j[O].hasB=1)}}}(x,T),A.mode){case"overlay":s(_,x,T,A);break;case"group":for(S=[],w=[],L=0;L<T.length;L++)(k=T[L])[0].trace.offset===void 0?w.push(k):S.push(k);w.length&&function(C,M,P,O,F){var j=new u(O,{posAxis:M,sepNegVal:!1,overlapNoMerge:!F.norm});(function(W,Z,Q,X){for(var G=W._fullLayout,Y=Q.positions,K=Q.distinctPositions,D=Q.minDiff,B=Q.traces,q=B.length,ee=Y.length!==K.length,J=D*(1-X.gap),$=f(G,Z._id)+B[0][0].trace.orientation,te=G._alignmentOpts[$]||{},ie=0;ie<q;ie++){var ae,he,se=B[ie],de=se[0].trace,ce=te[de.alignmentgroup]||{},ve=Object.keys(ce.offsetGroups||{}).length,ke=(ae=ve?J/ve:ee?J/q:J)*(1-(X.groupgap||0));he=ve?((2*de._offsetIndex+1-ve)*ae-ke)/2:ee?((2*ie+1-q)*ae-ke)/2:-ke/2;var Ee=se[0].t;Ee.barwidth=ke,Ee.poffset=he,Ee.bargroupwidth=J,Ee.bardelta=D}Q.binWidth=B[0][0].t.barwidth/100,a(Q),c(Z,Q),r(Z,Q,ee)})(C,M,j,F),function(W,Z){for(var Q=W.traces,X=0;X<Q.length;X++){var G=Q[X];if(G[0].trace.base===void 0)for(var Y=new u([G],{posAxis:Z,sepNegVal:!0,overlapNoMerge:!0}),K=0;K<G.length;K++){var D=G[K];if(D.p!==g){var B=Y.put(D.p,D.b+D.s);B&&(D.b=B)}}}}(j,M),F.norm?(d(j),l(P,j,F)):n(P,j)}(v,_,x,w,A),S.length&&s(_,x,S,A);break;case"stack":case"relative":for(S=[],w=[],L=0;L<T.length;L++)(k=T[L])[0].trace.base===void 0?w.push(k):S.push(k);w.length&&function(C,M,P,O,F){var j=new u(O,{posAxis:M,sepNegVal:F.mode==="relative",overlapNoMerge:!(F.norm||F.mode==="stack"||F.mode==="relative")});o(M,j,F),function(G,Y,K){var D,B,q,ee,J,$,te=y(G),ie=Y.traces;for(ee=0;ee<ie.length;ee++)if(D=ie[ee],(B=D[0].trace).type==="funnel")for(J=0;J<D.length;J++)($=D[J]).s!==g&&Y.put($.p,-.5*$.s);for(ee=0;ee<ie.length;ee++){D=ie[ee],B=D[0].trace,q=B.type==="funnel";var ae=[];for(J=0;J<D.length;J++)if(($=D[J]).s!==g){var he;he=q?$.s:$.s+$.b;var se=Y.put($.p,he),de=se+he;$.b=se,$[te]=de,K.norm||(ae.push(de),$.hasB&&ae.push(se))}K.norm||(B._extremes[G._id]=e.findExtremes(G,ae,{tozero:!0,padded:!0}))}}(P,j,F);for(var W=0;W<O.length;W++)for(var Z=O[W],Q=0;Q<Z.length;Q++){var X=Z[Q];X.s!==g&&X.b+X.s===j.get(X.p,X.s)&&(X._outmost=!0)}F.norm&&l(P,j,F)}(0,_,x,w,A),S.length&&s(_,x,S,A)}(function(C,M){var P,O,F,j=y(M),W={},Z=1/0,Q=-1/0;for(P=0;P<C.length;P++)for(F=C[P],O=0;O<F.length;O++){var X=F[O].p;t(X)&&(Z=Math.min(Z,X),Q=Math.max(Q,X))}var G=1e4/(Q-Z),Y=W.round=function($){return String(Math.round(G*($-Z)))};for(P=0;P<C.length;P++){(F=C[P])[0].t.extents=W;var K=F[0].t.poffset,D=Array.isArray(K);for(O=0;O<F.length;O++){var B=F[O],q=B[j]-B.w/2;if(t(q)){var ee=B[j]+B.w/2,J=Y(B.p);W[J]?W[J]=[Math.min(q,W[J][0]),Math.max(ee,W[J][1])]:W[J]=[q,ee]}B.p0=B.p+(D?K[O]:K),B.p1=B.p0+B.w,B.s0=B.b,B.s1=B.s0+B.s}}})(T,_)}}function s(v,_,x,T){for(var A=0;A<x.length;A++){var S=x[A],w=new u([S],{posAxis:v,sepNegVal:!1,overlapNoMerge:!T.norm});o(v,w,T),T.norm?(d(w),l(_,w,T)):n(_,w)}}function o(v,_,x){for(var T=_.minDiff,A=_.traces,S=T*(1-x.gap),w=S*(1-(x.groupgap||0)),L=-w/2,k=0;k<A.length;k++){var C=A[k][0].t;C.barwidth=w,C.poffset=L,C.bargroupwidth=S,C.bardelta=T}_.binWidth=A[0][0].t.barwidth/100,a(_),c(v,_),r(v,_)}function a(v){var _,x,T=v.traces;for(_=0;_<T.length;_++){var A,S=T[_],w=S[0],L=w.trace,k=w.t,C=L._offset||L.offset,M=k.poffset;if(m(C)){for(A=Array.prototype.slice.call(C,0,S.length),x=0;x<A.length;x++)t(A[x])||(A[x]=M);for(x=A.length;x<S.length;x++)A.push(M);k.poffset=A}else C!==void 0&&(k.poffset=C);var P=L._width||L.width,O=k.barwidth;if(m(P)){var F=Array.prototype.slice.call(P,0,S.length);for(x=0;x<F.length;x++)t(F[x])||(F[x]=O);for(x=F.length;x<S.length;x++)F.push(O);if(k.barwidth=F,C===void 0){for(A=[],x=0;x<S.length;x++)A.push(M+(O-F[x])/2);k.poffset=A}}else P!==void 0&&(k.barwidth=P,C===void 0&&(k.poffset=M+(O-P)/2))}}function c(v,_){for(var x=_.traces,T=y(v),A=0;A<x.length;A++)for(var S=x[A],w=S[0].t,L=w.poffset,k=Array.isArray(L),C=w.barwidth,M=Array.isArray(C),P=0;P<S.length;P++){var O=S[P],F=O.w=M?C[P]:C;O[T]=O.p+(k?L[P]:L)+F/2}}function r(v,_,x){var T=_.traces,A=_.minDiff/2;e.minDtick(v,_.minDiff,_.distinctPositions[0],x);for(var S=0;S<T.length;S++){var w,L,k,C,M=T[S],P=M[0],O=P.trace,F=[];for(C=0;C<M.length;C++)L=(w=M[C]).p-A,k=w.p+A,F.push(L,k);if(O.width||O.offset){var j=P.t,W=j.poffset,Z=j.barwidth,Q=Array.isArray(W),X=Array.isArray(Z);for(C=0;C<M.length;C++){w=M[C];var G=Q?W[C]:W,Y=X?Z[C]:Z;k=(L=w.p+G)+Y,F.push(L,k)}}O._extremes[v._id]=e.findExtremes(v,F,{padded:!1})}}function n(v,_){for(var x=_.traces,T=y(v),A=0;A<x.length;A++){for(var S=x[A],w=S[0].trace,L=[],k=!1,C=0;C<S.length;C++){var M=S[C],P=M.b,O=P+M.s;M[T]=O,L.push(O),M.hasB&&L.push(P),M.hasB&&M.b||(k=!0)}w._extremes[v._id]=e.findExtremes(v,L,{tozero:k,padded:!0})}}function d(v){for(var _=v.traces,x=0;x<_.length;x++)for(var T=_[x],A=0;A<T.length;A++){var S=T[A];S.s!==g&&v.put(S.p,S.b+S.s)}}function l(v,_,x){var T=_.traces,A=y(v),S=x.norm==="fraction"?1:100,w=S/1e9,L=v.l2c(v.c2l(0)),k=x.mode==="stack"?S:L;function C(K){return t(v.c2l(K))&&(K<L-w||K>k+w||!t(L))}for(var M=0;M<T.length;M++){for(var P=T[M],O=P[0].trace,F=[],j=!1,W=!1,Z=0;Z<P.length;Z++){var Q=P[Z];if(Q.s!==g){var X=Math.abs(S/_.get(Q.p,Q.s));Q.b*=X,Q.s*=X;var G=Q.b,Y=G+Q.s;Q[A]=Y,F.push(Y),W=W||C(Y),Q.hasB&&(F.push(G),W=W||C(G)),Q.hasB&&Q.b||(j=!0)}}O._extremes[v._id]=e.findExtremes(v,F,{tozero:j,padded:W})}}function y(v){return v._id.charAt(0)}N.exports={crossTraceCalc:function(v,_){for(var x=_.xaxis,T=_.yaxis,A=v._fullLayout,S=v._fullData,w=v.calcdata,L=[],k=[],C=0;C<S.length;C++){var M=S[C];if(M.visible===!0&&p.traceIs(M,"bar")&&M.xaxis===x._id&&M.yaxis===T._id&&(M.orientation==="h"?L.push(w[C]):k.push(w[C]),M._computePh))for(var P=v.calcdata[C],O=0;O<P.length;O++)typeof P[O].ph0=="function"&&(P[O].ph0=P[O].ph0()),typeof P[O].ph1=="function"&&(P[O].ph1=P[O].ph1())}var F={xCat:x.type==="category"||x.type==="multicategory",yCat:T.type==="category"||T.type==="multicategory",mode:A.barmode,norm:A.barnorm,gap:A.bargap,groupgap:A.bargroupgap};i(v,x,T,k,F),i(v,T,x,L,F)},setGroupPositions:i}},{"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/axes":838,"../../plots/cartesian/constraints":846,"../../registry":915,"./sieve.js":938,"fast-isnumeric":246}],929:[function(h,N,H){var t=h("../../lib"),m=h("../../components/color"),g=h("../../registry"),p=h("../scatter/xy_defaults"),e=h("../scatter/period_defaults"),f=h("./style_defaults"),u=h("../../plots/cartesian/constraints").getAxisGroup,i=h("./attributes"),s=t.coerceFont;function o(c,r,n,d){var l=r.orientation,y=r[{v:"x",h:"y"}[l]+"axis"],v=u(n,y)+l,_=n._alignmentOpts||{},x=d("alignmentgroup"),T=_[v];T||(T=_[v]={});var A=T[x];A?A.traces.push(r):A=T[x]={traces:[r],alignmentIndex:Object.keys(T).length,offsetGroups:{}};var S=d("offsetgroup"),w=A.offsetGroups,L=w[S];S&&(L||(L=w[S]={offsetIndex:Object.keys(w).length}),r._offsetIndex=L.offsetIndex)}function a(c,r,n,d,l,y){var v=(y=y||{}).moduleHasSelected!==!1,_=y.moduleHasUnselected!==!1,x=y.moduleHasConstrain!==!1,T=y.moduleHasCliponaxis!==!1,A=y.moduleHasTextangle!==!1,S=y.moduleHasInsideanchor!==!1,w=!!y.hasPathbar,L=Array.isArray(l)||l==="auto",k=L||l==="inside",C=L||l==="outside";if(k||C){var M=s(d,"textfont",n.font),P=t.extendFlat({},M),O=!(c.textfont&&c.textfont.color);if(O&&delete P.color,s(d,"insidetextfont",P),w){var F=t.extendFlat({},M);O&&delete F.color,s(d,"pathbar.textfont",F)}C&&s(d,"outsidetextfont",M),v&&d("selected.textfont.color"),_&&d("unselected.textfont.color"),x&&d("constraintext"),T&&d("cliponaxis"),A&&d("textangle"),d("texttemplate")}k&&S&&d("insidetextanchor")}N.exports={supplyDefaults:function(c,r,n,d){function l(x,T){return t.coerce(c,r,i,x,T)}if(p(c,r,d,l)){e(c,r,d,l),l("xhoverformat"),l("yhoverformat"),l("orientation",r.x&&!r.y?"h":"v"),l("base"),l("offset"),l("width"),l("text"),l("hovertext"),l("hovertemplate");var y=l("textposition");a(c,r,d,l,y,{moduleHasSelected:!0,moduleHasUnselected:!0,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),f(c,r,l,n,d);var v=(r.marker.line||{}).color,_=g.getComponentMethod("errorbars","supplyDefaults");_(c,r,v||m.defaultLine,{axis:"y"}),_(c,r,v||m.defaultLine,{axis:"x",inherit:"y"}),t.coerceSelectionMarkerOpacity(r,l)}else r.visible=!1},crossTraceDefaults:function(c,r){var n;function d(y){return t.coerce(n._input,n,i,y)}if(r.barmode==="group")for(var l=0;l<c.length;l++)(n=c[l]).type==="bar"&&(n._input,o(0,n,r,d))},handleGroupingDefaults:o,handleText:a}},{"../../components/color":650,"../../lib":787,"../../plots/cartesian/constraints":846,"../../registry":915,"../scatter/period_defaults":1222,"../scatter/xy_defaults":1229,"./attributes":925,"./style_defaults":940}],930:[function(h,N,H){N.exports=function(t,m,g){return t.x="xVal"in m?m.xVal:m.x,t.y="yVal"in m?m.yVal:m.y,m.xa&&(t.xaxis=m.xa),m.ya&&(t.yaxis=m.ya),g.orientation==="h"?(t.label=t.y,t.value=t.x):(t.label=t.x,t.value=t.y),t}},{}],931:[function(h,N,H){var t=h("fast-isnumeric"),m=h("tinycolor2"),g=h("../../lib").isArrayOrTypedArray;H.coerceString=function(p,e,f){if(typeof e=="string"){if(e||!p.noBlank)return e}else if((typeof e=="number"||e===!0)&&!p.strict)return String(e);return f!==void 0?f:p.dflt},H.coerceNumber=function(p,e,f){if(t(e)){e=+e;var u=p.min,i=p.max;if(!(u!==void 0&&e<u||i!==void 0&&e>i))return e}return f!==void 0?f:p.dflt},H.coerceColor=function(p,e,f){return m(e).isValid()?e:f!==void 0?f:p.dflt},H.coerceEnumerated=function(p,e,f){return p.coerceNumber&&(e=+e),p.values.indexOf(e)!==-1?e:f!==void 0?f:p.dflt},H.getValue=function(p,e){var f;return Array.isArray(p)?e<p.length&&(f=p[e]):f=p,f},H.getLineWidth=function(p,e){return 0<e.mlw?e.mlw:g(p.marker.line.width)?0:p.marker.line.width}},{"../../lib":787,"fast-isnumeric":246,tinycolor2:583}],932:[function(h,N,H){var t=h("../../components/fx"),m=h("../../registry"),g=h("../../components/color"),p=h("../../lib").fillText,e=h("./helpers").getLineWidth,f=h("../../plots/cartesian/axes").hoverLabelText,u=h("../../constants/numerical").BADNUM;function i(o,a,c,r,n){var d,l,y,v,_,x,T,A=o.cd,S=A[0].trace,w=A[0].t,L=r==="closest",k=S.type==="waterfall",C=o.maxHoverDistance,M=o.maxSpikeDistance;S.orientation==="h"?(d=c,l=a,y="y",v="x",_=D,x=Y):(d=a,l=c,y="x",v="y",x=D,_=Y);var P=S[y+"period"],O=L||P;function F(ae){return W(ae,-1)}function j(ae){return W(ae,1)}function W(ae,he){var se=ae.w;return ae[y]+he*se/2}function Z(ae){return ae[y+"End"]-ae[y+"Start"]}var Q=L?F:P?function(ae){return ae.p-Z(ae)/2}:function(ae){return Math.min(F(ae),ae.p-w.bardelta/2)},X=L?j:P?function(ae){return ae.p+Z(ae)/2}:function(ae){return Math.max(j(ae),ae.p+w.bardelta/2)};function G(ae,he,se){return n.finiteRange&&(se=0),t.inbox(ae-d,he-d,se+Math.min(1,Math.abs(he-ae)/T)-1)}function Y(ae){return G(Q(ae),X(ae),C)}function K(ae){var he=ae[v];if(k){var se=Math.abs(ae.rawS)||0;l>0?he+=se:l<0&&(he-=se)}return he}function D(ae){var he=l,se=ae.b,de=K(ae);return t.inbox(se-he,de-he,C+(de-he)/(de-se)-1)}var B=o[y+"a"],q=o[v+"a"];T=Math.abs(B.r2c(B.range[1])-B.r2c(B.range[0]));var ee=t.getDistanceFunction(r,_,x,function(ae){return(_(ae)+x(ae))/2});if(t.getClosest(A,ee,o),o.index!==!1&&A[o.index].p!==u){O||(Q=function(ae){return Math.min(F(ae),ae.p-w.bargroupwidth/2)},X=function(ae){return Math.max(j(ae),ae.p+w.bargroupwidth/2)});var J=A[o.index],$=S.base?J.b+J.s:J.s;o[v+"0"]=o[v+"1"]=q.c2p(J[v],!0),o[v+"LabelVal"]=$;var te=w.extents[w.extents.round(J.p)];o[y+"0"]=B.c2p(L?Q(J):te[0],!0),o[y+"1"]=B.c2p(L?X(J):te[1],!0);var ie=J.orig_p!==void 0;return o[y+"LabelVal"]=ie?J.orig_p:J.p,o.labelLabel=f(B,o[y+"LabelVal"],S[y+"hoverformat"]),o.valueLabel=f(q,o[v+"LabelVal"],S[v+"hoverformat"]),o.baseLabel=f(q,J.b,S[v+"hoverformat"]),o.spikeDistance=(function(ae){var he=l,se=ae.b,de=K(ae);return t.inbox(se-he,de-he,M+(de-he)/(de-se)-1)}(J)+function(ae){return G(F(ae),j(ae),M)}(J))/2,o[y+"Spike"]=B.c2p(J.p,!0),p(J,S,o),o.hovertemplate=S.hovertemplate,o}}function s(o,a){var c=a.mcc||o.marker.color,r=a.mlcc||o.marker.line.color,n=e(o,a);return g.opacity(c)?c:g.opacity(r)&&n?r:void 0}N.exports={hoverPoints:function(o,a,c,r,n){var d=i(o,a,c,r,n);if(d){var l=d.cd,y=l[0].trace,v=l[d.index];return d.color=s(y,v),m.getComponentMethod("errorbars","hoverInfo")(v,y,d),[d]}},hoverOnBars:i,getTraceColor:s}},{"../../components/color":650,"../../components/fx":690,"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/axes":838,"../../registry":915,"./helpers":931}],933:[function(h,N,H){N.exports={attributes:h("./attributes"),layoutAttributes:h("./layout_attributes"),supplyDefaults:h("./defaults").supplyDefaults,crossTraceDefaults:h("./defaults").crossTraceDefaults,supplyLayoutDefaults:h("./layout_defaults"),calc:h("./calc"),crossTraceCalc:h("./cross_trace_calc").crossTraceCalc,colorbar:h("../scatter/marker_colorbar"),arraysToCalcdata:h("./arrays_to_calcdata"),plot:h("./plot").plot,style:h("./style").style,styleOnSelect:h("./style").styleOnSelect,hoverPoints:h("./hover").hoverPoints,eventData:h("./event_data"),selectPoints:h("./select"),moduleType:"trace",name:"bar",basePlotModule:h("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","oriented","errorBarsOK","showLegend","zoomScale"],animatable:!0,meta:{}}},{"../../plots/cartesian":852,"../scatter/marker_colorbar":1220,"./arrays_to_calcdata":924,"./attributes":925,"./calc":926,"./cross_trace_calc":928,"./defaults":929,"./event_data":930,"./hover":932,"./layout_attributes":934,"./layout_defaults":935,"./plot":936,"./select":937,"./style":939}],934:[function(h,N,H){N.exports={barmode:{valType:"enumerated",values:["stack","group","overlay","relative"],dflt:"group",editType:"calc"},barnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},bargap:{valType:"number",min:0,max:1,editType:"calc"},bargroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],935:[function(h,N,H){var t=h("../../registry"),m=h("../../plots/cartesian/axes"),g=h("../../lib"),p=h("./layout_attributes");N.exports=function(e,f,u){function i(y,v){return g.coerce(e,f,p,y,v)}for(var s=!1,o=!1,a=!1,c={},r=i("barmode"),n=0;n<u.length;n++){var d=u[n];if(t.traceIs(d,"bar")&&d.visible){if(s=!0,r==="group"){var l=d.xaxis+d.yaxis;c[l]&&(a=!0),c[l]=!0}d.visible&&d.type==="histogram"&&m.getFromId({_fullLayout:f},d[d.orientation==="v"?"xaxis":"yaxis"]).type!=="category"&&(o=!0)}}s?(r!=="overlay"&&i("barnorm"),i("bargap",o&&!a?0:.2),i("bargroupgap")):delete f.barmode}},{"../../lib":787,"../../plots/cartesian/axes":838,"../../registry":915,"./layout_attributes":934}],936:[function(h,N,H){var t=h("@plotly/d3"),m=h("fast-isnumeric"),g=h("../../lib"),p=h("../../lib/svg_text_utils"),e=h("../../components/color"),f=h("../../components/drawing"),u=h("../../registry"),i=h("../../plots/cartesian/axes").tickText,s=h("./uniform_text"),o=s.recordMinTextSize,a=s.clearMinTextSize,c=h("./style"),r=h("./helpers"),n=h("./constants"),d=h("./attributes"),l=d.text,y=d.textposition,v=h("../../components/fx/helpers").appendArrayPointValue,_=n.TEXTPAD;function x(M){return M.id}function T(M){if(M.ids)return x}function A(M,P){return M<P?1:-1}function S(M,P,O,F){var j;return!P.uniformtext.mode&&w(O)?(F&&(j=F()),M.transition().duration(O.duration).ease(O.easing).each("end",function(){j&&j()}).each("interrupt",function(){j&&j()})):M}function w(M){return M&&M.duration>0}function L(M){return M==="auto"?0:M}function k(M,P){var O=Math.PI/180*P,F=Math.abs(Math.sin(O)),j=Math.abs(Math.cos(O));return{x:M.width*j+M.height*F,y:M.width*F+M.height*j}}function C(M,P,O,F,j,W){var Z=!!W.isHorizontal,Q=!!W.constrained,X=W.angle||0,G=W.anchor||"end",Y=G==="end",K=G==="start",D=((W.leftToRight||0)+1)/2,B=1-D,q=j.width,ee=j.height,J=Math.abs(P-M),$=Math.abs(F-O),te=J>2*_&&$>2*_?_:0;J-=2*te,$-=2*te;var ie=L(X);X!=="auto"||q<=J&&ee<=$||!(q>J||ee>$)||(q>$||ee>J)&&q<ee==J<$||(ie+=90);var ae=k(j,ie),he=1;Q&&(he=Math.min(1,J/ae.x,$/ae.y));var se=j.left*B+j.right*D,de=(j.top+j.bottom)/2,ce=(M+_)*B+(P-_)*D,ve=(O+F)/2,ke=0,Ee=0;if(K||Y){var be=(Z?ae.x:ae.y)/2,xe=Z?A(M,P):A(O,F);Z?K?(ce=M+xe*te,ke=-xe*be):(ce=P-xe*te,ke=xe*be):K?(ve=O+xe*te,Ee=-xe*be):(ve=F-xe*te,Ee=xe*be)}return{textX:se,textY:de,targetX:ce,targetY:ve,anchorX:ke,anchorY:Ee,scale:he,rotate:ie}}N.exports={plot:function(M,P,O,F,j,W){var Z=P.xaxis,Q=P.yaxis,X=M._fullLayout;j||(j={mode:X.barmode,norm:X.barmode,gap:X.bargap,groupgap:X.bargroupgap},a("bar",X));var G=g.makeTraceGroups(F,O,"trace bars").each(function(Y){var K=t.select(this),D=Y[0].trace,B=D.type==="waterfall",q=D.type==="funnel",ee=D.type==="bar"||q,J=0;B&&D.connector.visible&&D.connector.mode==="between"&&(J=D.connector.line.width/2);var $=D.orientation==="h",te=w(j),ie=g.ensureSingle(K,"g","points"),ae=T(D),he=ie.selectAll("g.point").data(g.identity,ae);he.enter().append("g").classed("point",!0),he.exit().remove(),he.each(function(de,ce){var ve,ke,Ee=t.select(this),be=function(Oe,je,We,Ge){var Qe=[],it=[],lt=Ge?je:We,Lt=Ge?We:je;return Qe[0]=lt.c2p(Oe.s0,!0),it[0]=Lt.c2p(Oe.p0,!0),Qe[1]=lt.c2p(Oe.s1,!0),it[1]=Lt.c2p(Oe.p1,!0),Ge?[Qe,it]:[it,Qe]}(de,Z,Q,$),xe=be[0][0],ue=be[0][1],me=be[1][0],we=be[1][1],Me=($?ue-xe:we-me)==0;if(Me&&ee&&r.getLineWidth(D,de)&&(Me=!1),Me||(Me=!(m(xe)&&m(ue)&&m(me)&&m(we))),de.isBlank=Me,Me&&($?ue=xe:we=me),J&&!Me&&($?(xe-=A(xe,ue)*J,ue+=A(xe,ue)*J):(me-=A(me,we)*J,we+=A(me,we)*J)),D.type==="waterfall"){if(!Me){var Se=D[de.dir].marker;ve=Se.line.width,ke=Se.color}}else ve=r.getLineWidth(D,de),ke=de.mc||D.marker.color;function De(Oe){var je=t.round(ve/2%1,2);return j.gap===0&&j.groupgap===0?t.round(Math.round(Oe)-je,2):Oe}if(!M._context.staticPlot){var Fe=e.opacity(ke)<1||ve>.01?De:function(Oe,je,We){return We&&Oe===je?Oe:Math.abs(Oe-je)>=2?De(Oe):Oe>je?Math.ceil(Oe):Math.floor(Oe)};xe=Fe(xe,ue,$),ue=Fe(ue,xe,$),me=Fe(me,we,!$),we=Fe(we,me,!$)}var Ye=S(g.ensureSingle(Ee,"path"),X,j,W);if(Ye.style("vector-effect","non-scaling-stroke").attr("d",isNaN((ue-xe)*(we-me))||Me&&M._context.staticPlot?"M0,0Z":"M"+xe+","+me+"V"+we+"H"+ue+"V"+me+"Z").call(f.setClipUrl,P.layerClipId,M),!X.uniformtext.mode&&te){var et=f.makePointStyleFns(D);f.singlePointStyle(de,Ye,D,et,M)}(function(Oe,je,We,Ge,Qe,it,lt,Lt,wt,rt,$e){var xt,Qt=je.xaxis,$t=je.yaxis,Ue=Oe._fullLayout;function He(Yt,Xt,ar){return g.ensureSingle(Yt,"text").text(Xt).attr({class:"bartext bartext-"+xt,"text-anchor":"middle","data-notex":1}).call(f.font,ar).call(p.convertToTspans,Oe)}var Be=Ge[0].trace,Je=Be.orientation==="h",_e=function(Yt,Xt,ar,hr,mr){var sr,fr=Xt[0].trace;return sr=fr.texttemplate?function(yr,zr,xr,Br,Jr){var fn=zr[0].trace,Cn=g.castOption(fn,xr,"texttemplate");if(!Cn)return"";var Pn,An,rn,Fr,Lr=fn.type==="waterfall",Qr=fn.type==="funnel";fn.orientation==="h"?(Pn="y",An=Jr,rn="x",Fr=Br):(Pn="x",An=Br,rn="y",Fr=Jr);function $r(Ct){return i(Fr,Fr.c2l(Ct),!0).text}var Kr=zr[xr],en={};en.label=Kr.p,en.labelLabel=en[Pn+"Label"]=(Tn=Kr.p,i(An,An.c2l(Tn),!0).text);var Tn,Mn=g.castOption(fn,Kr.i,"text");(Mn===0||Mn)&&(en.text=Mn),en.value=Kr.s,en.valueLabel=en[rn+"Label"]=$r(Kr.s);var Rn={};v(Rn,fn,Kr.i),Lr&&(en.delta=+Kr.rawS||Kr.s,en.deltaLabel=$r(en.delta),en.final=Kr.v,en.finalLabel=$r(en.final),en.initial=en.final-en.delta,en.initialLabel=$r(en.initial)),Qr&&(en.value=Kr.s,en.valueLabel=$r(en.value),en.percentInitial=Kr.begR,en.percentInitialLabel=g.formatPercent(Kr.begR),en.percentPrevious=Kr.difR,en.percentPreviousLabel=g.formatPercent(Kr.difR),en.percentTotal=Kr.sumR,en.percenTotalLabel=g.formatPercent(Kr.sumR));var Zt=g.castOption(fn,Kr.i,"customdata");return Zt&&(en.customdata=Zt),g.texttemplateString(Cn,en,yr._d3locale,Rn,en,fn._meta||{})}(Yt,Xt,ar,hr,mr):fr.textinfo?function(yr,zr,xr,Br){var Jr=yr[0].trace,fn=Jr.orientation==="h",Cn=Jr.type==="waterfall",Pn=Jr.type==="funnel";function An(Ht){return i(fn?xr:Br,+Ht,!0).text}var rn,Fr=Jr.textinfo,Lr=yr[zr],Qr=Fr.split("+"),$r=[],Kr=function(Ht){return Qr.indexOf(Ht)!==-1};Kr("label")&&$r.push((en=yr[zr].p,i(fn?Br:xr,en,!0).text));var en;if(Kr("text")&&((rn=g.castOption(Jr,Lr.i,"text"))===0||rn)&&$r.push(rn),Cn){var Tn=+Lr.rawS||Lr.s,Mn=Lr.v,Rn=Mn-Tn;Kr("initial")&&$r.push(An(Rn)),Kr("delta")&&$r.push(An(Tn)),Kr("final")&&$r.push(An(Mn))}if(Pn){Kr("value")&&$r.push(An(Lr.s));var Zt=0;Kr("percent initial")&&Zt++,Kr("percent previous")&&Zt++,Kr("percent total")&&Zt++;var Ct=Zt>1;Kr("percent initial")&&(rn=g.formatPercent(Lr.begR),Ct&&(rn+=" of initial"),$r.push(rn)),Kr("percent previous")&&(rn=g.formatPercent(Lr.difR),Ct&&(rn+=" of previous"),$r.push(rn)),Kr("percent total")&&(rn=g.formatPercent(Lr.sumR),Ct&&(rn+=" of total"),$r.push(rn))}return $r.join("<br>")}(Xt,ar,hr,mr):r.getValue(fr.text,ar),r.coerceString(l,sr)}(Ue,Ge,Qe,Qt,$t);xt=function(Yt,Xt){var ar=r.getValue(Yt.textposition,Xt);return r.coerceEnumerated(y,ar)}(Be,Qe);var Le=rt.mode==="stack"||rt.mode==="relative",Ce=Ge[Qe],Pe=!Le||Ce._outmost;if(!_e||xt==="none"||(Ce.isBlank||it===lt||Lt===wt)&&(xt==="auto"||xt==="inside"))return void We.select("text").remove();var Xe=Ue.font,ut=c.getBarColor(Ge[Qe],Be),kt=c.getInsideTextFont(Be,Qe,Xe,ut),ft=c.getOutsideTextFont(Be,Qe,Xe),Et=We.datum();Je?Qt.type==="log"&&Et.s0<=0&&(it=Qt.range[0]<Qt.range[1]?0:Qt._length):$t.type==="log"&&Et.s0<=0&&(Lt=$t.range[0]<$t.range[1]?$t._length:0);var mt,It,vt,nt,At,Ft=Math.abs(lt-it)-2*_,Nt=Math.abs(wt-Lt)-2*_;if(xt==="outside"&&(Pe||Ce.hasB||(xt="inside")),xt==="auto")if(Pe){xt="inside",At=g.ensureUniformFontSize(Oe,kt),mt=He(We,_e,At),It=f.bBox(mt.node()),vt=It.width,nt=It.height;var Kt=vt<=Ft&&nt<=Nt,Ie=vt<=Nt&&nt<=Ft,ot=Je?Ft>=vt*(Nt/nt):Nt>=nt*(Ft/vt);vt>0&&nt>0&&(Kt||Ie||ot)?xt="inside":(xt="outside",mt.remove(),mt=null)}else xt="inside";if(!mt){At=g.ensureUniformFontSize(Oe,xt==="outside"?ft:kt);var bt=(mt=He(We,_e,At)).attr("transform");if(mt.attr("transform",""),It=f.bBox(mt.node()),vt=It.width,nt=It.height,mt.attr("transform",bt),vt<=0||nt<=0)return void mt.remove()}var Pt,Vt,nr=Be.textangle;xt==="outside"?(Vt=Be.constraintext==="both"||Be.constraintext==="outside",Pt=function(Yt,Xt,ar,hr,mr,sr){var fr,yr=!!sr.isHorizontal,zr=!!sr.constrained,xr=sr.angle||0,Br=mr.width,Jr=mr.height,fn=Math.abs(Xt-Yt),Cn=Math.abs(hr-ar);fr=yr?Cn>2*_?_:0:fn>2*_?_:0;var Pn=1;zr&&(Pn=yr?Math.min(1,Cn/Jr):Math.min(1,fn/Br));var An=L(xr),rn=k(mr,An),Fr=(yr?rn.x:rn.y)/2,Lr=(mr.left+mr.right)/2,Qr=(mr.top+mr.bottom)/2,$r=(Yt+Xt)/2,Kr=(ar+hr)/2,en=0,Tn=0,Mn=yr?A(Xt,Yt):A(ar,hr);return yr?($r=Xt-Mn*fr,en=Mn*Fr):(Kr=hr+Mn*fr,Tn=-Mn*Fr),{textX:Lr,textY:Qr,targetX:$r,targetY:Kr,anchorX:en,anchorY:Tn,scale:Pn,rotate:An}}(it,lt,Lt,wt,It,{isHorizontal:Je,constrained:Vt,angle:nr})):(Vt=Be.constraintext==="both"||Be.constraintext==="inside",Pt=C(it,lt,Lt,wt,It,{isHorizontal:Je,constrained:Vt,angle:nr,anchor:Be.insidetextanchor})),Pt.fontSize=At.size,o(Be.type,Pt,Ue),Ce.transform=Pt,S(mt,Ue,rt,$e).attr("transform",g.getTextTransform(Pt))})(M,P,Ee,Y,ce,xe,ue,me,we,j,W),P.layerClipId&&f.hideOutsideRangePoint(de,Ee.select("text"),Z,Q,D.xcalendar,D.ycalendar)});var se=D.cliponaxis===!1;f.setClipUrl(K,se?null:P.layerClipId,M)});u.getComponentMethod("errorbars","plot")(M,G,P,j)},toMoveInsideBar:C}},{"../../components/color":650,"../../components/drawing":672,"../../components/fx/helpers":686,"../../lib":787,"../../lib/svg_text_utils":813,"../../plots/cartesian/axes":838,"../../registry":915,"./attributes":925,"./constants":927,"./helpers":931,"./style":939,"./uniform_text":941,"@plotly/d3":58,"fast-isnumeric":246}],937:[function(h,N,H){function t(m,g,p,e,f){var u=g.c2p(e?m.s0:m.p0,!0),i=g.c2p(e?m.s1:m.p1,!0),s=p.c2p(e?m.p0:m.s0,!0),o=p.c2p(e?m.p1:m.s1,!0);return f?[(u+i)/2,(s+o)/2]:e?[i,(s+o)/2]:[(u+i)/2,o]}N.exports=function(m,g){var p,e=m.cd,f=m.xaxis,u=m.yaxis,i=e[0].trace,s=i.type==="funnel",o=i.orientation==="h",a=[];if(g===!1)for(p=0;p<e.length;p++)e[p].selected=0;else for(p=0;p<e.length;p++){var c=e[p],r="ct"in c?c.ct:t(c,f,u,o,s);g.contains(r,!1,p,m)?(a.push({pointNumber:p,x:f.c2d(c.x),y:u.c2d(c.y)}),c.selected=1):c.selected=0}return a}},{}],938:[function(h,N,H){N.exports=g;var t=h("../../lib").distinctVals,m=h("../../constants/numerical").BADNUM;function g(p,e){this.traces=p,this.sepNegVal=e.sepNegVal,this.overlapNoMerge=e.overlapNoMerge;for(var f=1/0,u=[],i=0;i<p.length;i++){for(var s=p[i],o=0;o<s.length;o++){var a=s[o];a.p!==m&&u.push(a.p)}s[0]&&s[0].width1&&(f=Math.min(s[0].width1,f))}this.positions=u;var c=t(u);this.distinctPositions=c.vals,c.vals.length===1&&f!==1/0?this.minDiff=f:this.minDiff=Math.min(c.minDiff,f);var r=(e.posAxis||{}).type;r!=="category"&&r!=="multicategory"||(this.minDiff=1),this.binWidth=this.minDiff,this.bins={}}g.prototype.put=function(p,e){var f=this.getLabel(p,e),u=this.bins[f]||0;return this.bins[f]=u+e,u},g.prototype.get=function(p,e){var f=this.getLabel(p,e);return this.bins[f]||0},g.prototype.getLabel=function(p,e){return(e<0&&this.sepNegVal?"v":"^")+(this.overlapNoMerge?p:Math.round(p/this.binWidth))}},{"../../constants/numerical":763,"../../lib":787}],939:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../components/color"),g=h("../../components/drawing"),p=h("../../lib"),e=h("../../registry"),f=h("./uniform_text").resizeText,u=h("./attributes"),i=u.textfont,s=u.insidetextfont,o=u.outsidetextfont,a=h("./helpers");function c(x,T,A){g.pointStyle(x.selectAll("path"),T,A),r(x,T,A)}function r(x,T,A){x.selectAll("text").each(function(S){var w=t.select(this),L=p.ensureUniformFontSize(A,n(w,S,T,A));g.font(w,L)})}function n(x,T,A,S){var w=S._fullLayout.font,L=A.textfont;if(x.classed("bartext-inside")){var k=_(T,A);L=l(A,T.i,w,k)}else x.classed("bartext-outside")&&(L=y(A,T.i,w));return L}function d(x,T,A){return v(i,x.textfont,T,A)}function l(x,T,A,S){var w=d(x,T,A);return(x._input.textfont===void 0||x._input.textfont.color===void 0||Array.isArray(x.textfont.color)&&x.textfont.color[T]===void 0)&&(w={color:m.contrast(S),family:w.family,size:w.size}),v(s,x.insidetextfont,T,w)}function y(x,T,A){var S=d(x,T,A);return v(o,x.outsidetextfont,T,S)}function v(x,T,A,S){T=T||{};var w=a.getValue(T.family,A),L=a.getValue(T.size,A),k=a.getValue(T.color,A);return{family:a.coerceString(x.family,w,S.family),size:a.coerceNumber(x.size,L,S.size),color:a.coerceColor(x.color,k,S.color)}}function _(x,T){return T.type==="waterfall"?T[x.dir].marker.color:x.mcc||x.mc||T.marker.color}N.exports={style:function(x){var T=t.select(x).selectAll("g.barlayer").selectAll("g.trace");f(x,T,"bar");var A=T.size(),S=x._fullLayout;T.style("opacity",function(w){return w[0].trace.opacity}).each(function(w){(S.barmode==="stack"&&A>1||S.bargap===0&&S.bargroupgap===0&&!w[0].trace.marker.line.width)&&t.select(this).attr("shape-rendering","crispEdges")}),T.selectAll("g.points").each(function(w){c(t.select(this),w[0].trace,x)}),e.getComponentMethod("errorbars","style")(T)},styleTextPoints:r,styleOnSelect:function(x,T,A){var S=T[0].trace;S.selectedpoints?function(w,L,k){g.selectedPointStyle(w.selectAll("path"),L),function(C,M,P){C.each(function(O){var F,j=t.select(this);if(O.selected){F=p.ensureUniformFontSize(P,n(j,O,M,P));var W=M.selected.textfont&&M.selected.textfont.color;W&&(F.color=W),g.font(j,F)}else g.selectedTextStyle(j,M)})}(w.selectAll("text"),L,k)}(A,S,x):(c(A,S,x),e.getComponentMethod("errorbars","style")(A))},getInsideTextFont:l,getOutsideTextFont:y,getBarColor:_,resizeText:f}},{"../../components/color":650,"../../components/drawing":672,"../../lib":787,"../../registry":915,"./attributes":925,"./helpers":931,"./uniform_text":941,"@plotly/d3":58}],940:[function(h,N,H){var t=h("../../components/color"),m=h("../../components/colorscale/helpers").hasColorscale,g=h("../../components/colorscale/defaults"),p=h("../../lib").coercePattern;N.exports=function(e,f,u,i,s){var o=u("marker.color",i),a=m(e,"marker");a&&g(e,f,s,u,{prefix:"marker.",cLetter:"c"}),u("marker.line.color",t.defaultLine),m(e,"marker.line")&&g(e,f,s,u,{prefix:"marker.line.",cLetter:"c"}),u("marker.line.width"),u("marker.opacity"),p(u,"marker.pattern",o,a),u("selected.marker.color"),u("unselected.marker.color")}},{"../../components/color":650,"../../components/colorscale/defaults":660,"../../components/colorscale/helpers":661,"../../lib":787}],941:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../lib");function g(p){return"_"+p+"Text_minsize"}N.exports={recordMinTextSize:function(p,e,f){if(f.uniformtext.mode){var u=g(p),i=f.uniformtext.minsize,s=e.scale*e.fontSize;e.hide=s<i,f[u]=f[u]||1/0,e.hide||(f[u]=Math.min(f[u],Math.max(s,i)))}},clearMinTextSize:function(p,e){e[g(p)]=void 0},resizeText:function(p,e,f){var u=p._fullLayout,i=u["_"+f+"Text_minsize"];if(i){var s,o=u.uniformtext.mode==="hide";switch(f){case"funnelarea":case"pie":case"sunburst":s="g.slice";break;case"treemap":case"icicle":s="g.slice, g.pathbar";break;default:s="g.points > g.point"}e.selectAll(s).each(function(a){var c=a.transform;c&&(c.scale=o&&c.hide?0:i/c.fontSize,t.select(this).select("text").attr("transform",m.getTextTransform(c)))})}}}},{"../../lib":787,"@plotly/d3":58}],942:[function(h,N,H){var t=h("../../plots/template_attributes").hovertemplateAttrs,m=h("../../lib/extend").extendFlat,g=h("../scatterpolar/attributes"),p=h("../bar/attributes");N.exports={r:g.r,theta:g.theta,r0:g.r0,dr:g.dr,theta0:g.theta0,dtheta:g.dtheta,thetaunit:g.thetaunit,base:m({},p.base,{}),offset:m({},p.offset,{}),width:m({},p.width,{}),text:m({},p.text,{}),hovertext:m({},p.hovertext,{}),marker:p.marker,hoverinfo:g.hoverinfo,hovertemplate:t(),selected:p.selected,unselected:p.unselected}},{"../../lib/extend":777,"../../plots/template_attributes":910,"../bar/attributes":925,"../scatterpolar/attributes":1276}],943:[function(h,N,H){var t=h("../../components/colorscale/helpers").hasColorscale,m=h("../../components/colorscale/calc"),g=h("../bar/arrays_to_calcdata"),p=h("../bar/cross_trace_calc").setGroupPositions,e=h("../scatter/calc_selection"),f=h("../../registry").traceIs,u=h("../../lib").extendFlat;N.exports={calc:function(i,s){for(var o=i._fullLayout,a=s.subplot,c=o[a].radialaxis,r=o[a].angularaxis,n=c.makeCalcdata(s,"r"),d=r.makeCalcdata(s,"theta"),l=s._length,y=new Array(l),v=n,_=d,x=0;x<l;x++)y[x]={p:_[x],s:v[x]};function T(A){var S=s[A];S!==void 0&&(s["_"+A]=Array.isArray(S)?r.makeCalcdata(s,A):r.d2c(S,s.thetaunit))}return r.type==="linear"&&(T("width"),T("offset")),t(s,"marker")&&m(i,s,{vals:s.marker.color,containerStr:"marker",cLetter:"c"}),t(s,"marker.line")&&m(i,s,{vals:s.marker.line.color,containerStr:"marker.line",cLetter:"c"}),g(y,s),e(y,s),y},crossTraceCalc:function(i,s,o){for(var a=i.calcdata,c=[],r=0;r<a.length;r++){var n=a[r],d=n[0].trace;d.visible===!0&&f(d,"bar")&&d.subplot===o&&c.push(n)}var l=u({},s.radialaxis,{_id:"x"}),y=s.angularaxis;p(i,y,l,c,{mode:s.barmode,norm:s.barnorm,gap:s.bargap,groupgap:s.bargroupgap})}}},{"../../components/colorscale/calc":658,"../../components/colorscale/helpers":661,"../../lib":787,"../../registry":915,"../bar/arrays_to_calcdata":924,"../bar/cross_trace_calc":928,"../scatter/calc_selection":1204}],944:[function(h,N,H){var t=h("../../lib"),m=h("../scatterpolar/defaults").handleRThetaDefaults,g=h("../bar/style_defaults"),p=h("./attributes");N.exports=function(e,f,u,i){function s(o,a){return t.coerce(e,f,p,o,a)}m(e,f,i,s)?(s("thetaunit"),s("base"),s("offset"),s("width"),s("text"),s("hovertext"),s("hovertemplate"),g(e,f,s,u,i),t.coerceSelectionMarkerOpacity(f,s)):f.visible=!1}},{"../../lib":787,"../bar/style_defaults":940,"../scatterpolar/defaults":1278,"./attributes":942}],945:[function(h,N,H){var t=h("../../components/fx"),m=h("../../lib"),g=h("../bar/hover").getTraceColor,p=m.fillText,e=h("../scatterpolar/hover").makeHoverPointText,f=h("../../plots/polar/helpers").isPtInsidePolygon;N.exports=function(u,i,s){var o=u.cd,a=o[0].trace,c=u.subplot,r=c.radialAxis,n=c.angularAxis,d=c.vangles,l=d?f:m.isPtInsideSector,y=u.maxHoverDistance,v=n._period||2*Math.PI,_=Math.abs(r.g2p(Math.sqrt(i*i+s*s))),x=Math.atan2(s,i);if(r.range[0]>r.range[1]&&(x+=Math.PI),t.getClosest(o,function(S){return l(_,x,[S.rp0,S.rp1],[S.thetag0,S.thetag1],d)?y+Math.min(1,Math.abs(S.thetag1-S.thetag0)/v)-1+(S.rp1-_)/(S.rp1-S.rp0)-1:1/0},u),u.index!==!1){var T=o[u.index];u.x0=u.x1=T.ct[0],u.y0=u.y1=T.ct[1];var A=m.extendFlat({},T,{r:T.s,theta:T.p});return p(T,a,u),e(A,a,c,u),u.hovertemplate=a.hovertemplate,u.color=g(a,T),u.xLabelVal=u.yLabelVal=void 0,T.s<0&&(u.idealAlign="left"),[u]}}},{"../../components/fx":690,"../../lib":787,"../../plots/polar/helpers":903,"../bar/hover":932,"../scatterpolar/hover":1280}],946:[function(h,N,H){N.exports={moduleType:"trace",name:"barpolar",basePlotModule:h("../../plots/polar"),categories:["polar","bar","showLegend"],attributes:h("./attributes"),layoutAttributes:h("./layout_attributes"),supplyDefaults:h("./defaults"),supplyLayoutDefaults:h("./layout_defaults"),calc:h("./calc").calc,crossTraceCalc:h("./calc").crossTraceCalc,plot:h("./plot"),colorbar:h("../scatter/marker_colorbar"),formatLabels:h("../scatterpolar/format_labels"),style:h("../bar/style").style,styleOnSelect:h("../bar/style").styleOnSelect,hoverPoints:h("./hover"),selectPoints:h("../bar/select"),meta:{}}},{"../../plots/polar":904,"../bar/select":937,"../bar/style":939,"../scatter/marker_colorbar":1220,"../scatterpolar/format_labels":1279,"./attributes":942,"./calc":943,"./defaults":944,"./hover":945,"./layout_attributes":947,"./layout_defaults":948,"./plot":949}],947:[function(h,N,H){N.exports={barmode:{valType:"enumerated",values:["stack","overlay"],dflt:"stack",editType:"calc"},bargap:{valType:"number",dflt:.1,min:0,max:1,editType:"calc"}}},{}],948:[function(h,N,H){var t=h("../../lib"),m=h("./layout_attributes");N.exports=function(g,p,e){var f,u={};function i(a,c){return t.coerce(g[f]||{},p[f],m,a,c)}for(var s=0;s<e.length;s++){var o=e[s];o.type==="barpolar"&&o.visible===!0&&(u[f=o.subplot]||(i("barmode"),i("bargap"),u[f]=1))}}},{"../../lib":787,"./layout_attributes":947}],949:[function(h,N,H){var t=h("@plotly/d3"),m=h("fast-isnumeric"),g=h("../../lib"),p=h("../../components/drawing"),e=h("../../plots/polar/helpers");N.exports=function(f,u,i){var s=u.xaxis,o=u.yaxis,a=u.radialAxis,c=u.angularAxis,r=function(d){var l=d.cxx,y=d.cyy;return d.vangles?function(v,_,x,T){var A,S;g.angleDelta(x,T)>0?(A=x,S=T):(A=T,S=x);var w=[e.findEnclosingVertexAngles(A,d.vangles)[0],(A+S)/2,e.findEnclosingVertexAngles(S,d.vangles)[1]];return e.pathPolygonAnnulus(v,_,A,S,w,l,y)}:function(v,_,x,T){return g.pathAnnulus(v,_,x,T,l,y)}}(u),n=u.layers.frontplot.select("g.barlayer");g.makeTraceGroups(n,i,"trace bars").each(function(){var d=t.select(this),l=g.ensureSingle(d,"g","points").selectAll("g.point").data(g.identity);l.enter().append("g").style("vector-effect","non-scaling-stroke").style("stroke-miterlimit",2).classed("point",!0),l.exit().remove(),l.each(function(y){var v,_=t.select(this),x=y.rp0=a.c2p(y.s0),T=y.rp1=a.c2p(y.s1),A=y.thetag0=c.c2g(y.p0),S=y.thetag1=c.c2g(y.p1);if(m(x)&&m(T)&&m(A)&&m(S)&&x!==T&&A!==S){var w=a.c2g(y.s1),L=(A+S)/2;y.ct=[s.c2p(w*Math.cos(L)),o.c2p(w*Math.sin(L))],v=r(x,T,A,S)}else v="M0,0Z";g.ensureSingle(_,"path").attr("d",v)}),p.setClipUrl(d,u._hasClipOnAxisFalse?u.clipIds.forTraces:null,f)})}},{"../../components/drawing":672,"../../lib":787,"../../plots/polar/helpers":903,"@plotly/d3":58,"fast-isnumeric":246}],950:[function(h,N,H){var t=h("../scatter/attributes"),m=h("../bar/attributes"),g=h("../../components/color/attributes"),p=h("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=h("../../plots/template_attributes").hovertemplateAttrs,f=h("../../lib/extend").extendFlat,u=t.marker,i=u.line;N.exports={y:{valType:"data_array",editType:"calc+clearAxisTypes"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},x0:{valType:"any",editType:"calc+clearAxisTypes"},y0:{valType:"any",editType:"calc+clearAxisTypes"},dx:{valType:"number",editType:"calc"},dy:{valType:"number",editType:"calc"},xperiod:t.xperiod,yperiod:t.yperiod,xperiod0:t.xperiod0,yperiod0:t.yperiod0,xperiodalignment:t.xperiodalignment,yperiodalignment:t.yperiodalignment,xhoverformat:p("x"),yhoverformat:p("y"),name:{valType:"string",editType:"calc+clearAxisTypes"},q1:{valType:"data_array",editType:"calc+clearAxisTypes"},median:{valType:"data_array",editType:"calc+clearAxisTypes"},q3:{valType:"data_array",editType:"calc+clearAxisTypes"},lowerfence:{valType:"data_array",editType:"calc"},upperfence:{valType:"data_array",editType:"calc"},notched:{valType:"boolean",editType:"calc"},notchwidth:{valType:"number",min:0,max:.5,dflt:.25,editType:"calc"},notchspan:{valType:"data_array",editType:"calc"},boxpoints:{valType:"enumerated",values:["all","outliers","suspectedoutliers",!1],editType:"calc"},jitter:{valType:"number",min:0,max:1,editType:"calc"},pointpos:{valType:"number",min:-2,max:2,editType:"calc"},boxmean:{valType:"enumerated",values:[!0,"sd",!1],editType:"calc"},mean:{valType:"data_array",editType:"calc"},sd:{valType:"data_array",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},quartilemethod:{valType:"enumerated",values:["linear","exclusive","inclusive"],dflt:"linear",editType:"calc"},width:{valType:"number",min:0,dflt:0,editType:"calc"},marker:{outliercolor:{valType:"color",dflt:"rgba(0, 0, 0, 0)",editType:"style"},symbol:f({},u.symbol,{arrayOk:!1,editType:"plot"}),opacity:f({},u.opacity,{arrayOk:!1,dflt:1,editType:"style"}),size:f({},u.size,{arrayOk:!1,editType:"calc"}),color:f({},u.color,{arrayOk:!1,editType:"style"}),line:{color:f({},i.color,{arrayOk:!1,dflt:g.defaultLine,editType:"style"}),width:f({},i.width,{arrayOk:!1,dflt:0,editType:"style"}),outliercolor:{valType:"color",editType:"style"},outlierwidth:{valType:"number",min:0,dflt:1,editType:"style"},editType:"style"},editType:"plot"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:t.fillcolor,whiskerwidth:{valType:"number",min:0,max:1,dflt:.5,editType:"calc"},offsetgroup:m.offsetgroup,alignmentgroup:m.alignmentgroup,selected:{marker:t.selected.marker,editType:"style"},unselected:{marker:t.unselected.marker,editType:"style"},text:f({},t.text,{}),hovertext:f({},t.hovertext,{}),hovertemplate:e({}),hoveron:{valType:"flaglist",flags:["boxes","points"],dflt:"boxes+points",editType:"style"}}},{"../../components/color/attributes":649,"../../lib/extend":777,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../bar/attributes":925,"../scatter/attributes":1202}],951:[function(h,N,H){var t=h("fast-isnumeric"),m=h("../../plots/cartesian/axes"),g=h("../../plots/cartesian/align_period"),p=h("../../lib"),e=h("../../constants/numerical").BADNUM,f=p._;N.exports=function(l,y){var v,_,x,T,A,S,w,L=l._fullLayout,k=m.getFromId(l,y.xaxis||"x"),C=m.getFromId(l,y.yaxis||"y"),M=[],P=y.type==="violin"?"_numViolins":"_numBoxes";y.orientation==="h"?(x=k,T="x",A=C,S="y",w=!!y.yperiodalignment):(x=C,T="y",A=k,S="x",w=!!y.xperiodalignment);var O,F,j,W,Z,Q,X=function(We,Ge,Qe,it){var lt,Lt=Ge+"0"in We,wt="d"+Ge in We;if(Ge in We||Lt&&wt){var rt=Qe.makeCalcdata(We,Ge);return[g(We,Qe,Ge,rt).vals,rt]}lt=Lt?We[Ge+"0"]:"name"in We&&(Qe.type==="category"||t(We.name)&&["linear","log"].indexOf(Qe.type)!==-1||p.isDateTime(We.name)&&Qe.type==="date")?We.name:it;for(var $e=Qe.type==="multicategory"?Qe.r2c_just_indices(lt):Qe.d2c(lt,0,We[Ge+"calendar"]),xt=We._length,Qt=new Array(xt),$t=0;$t<xt;$t++)Qt[$t]=$e;return[Qt]}(y,S,A,L[P]),G=X[0],Y=X[1],K=p.distinctVals(G,A),D=K.vals,B=K.minDiff/2,q=(y.boxpoints||y.points)==="all"?p.identity:function(We){return We.v<O.lf||We.v>O.uf};if(y._hasPreCompStats){var ee=y[T],J=function(We){return x.d2c((y[We]||[])[v])},$=1/0,te=-1/0;for(v=0;v<y._length;v++){var ie=G[v];if(t(ie)){if((O={}).pos=O[S]=ie,w&&Y&&(O.orig_p=Y[v]),O.q1=J("q1"),O.med=J("median"),O.q3=J("q3"),F=[],ee&&p.isArrayOrTypedArray(ee[v]))for(_=0;_<ee[v].length;_++)(Q=x.d2c(ee[v][_]))!==e&&(i(Z={v:Q,i:[v,_]},y,[v,_]),F.push(Z));if(O.pts=F.sort(s),W=(j=O[T]=F.map(o)).length,O.med!==e&&O.q1!==e&&O.q3!==e&&O.med>=O.q1&&O.q3>=O.med){var ae=J("lowerfence");O.lf=ae!==e&&ae<=O.q1?ae:a(O,j,W);var he=J("upperfence");O.uf=he!==e&&he>=O.q3?he:c(O,j,W);var se=J("mean");O.mean=se!==e?se:W?p.mean(j,W):(O.q1+O.q3)/2;var de=J("sd");O.sd=se!==e&&de>=0?de:W?p.stdev(j,W,O.mean):O.q3-O.q1,O.lo=r(O),O.uo=n(O);var ce=J("notchspan");ce=ce!==e&&ce>0?ce:d(O,W),O.ln=O.med-ce,O.un=O.med+ce;var ve=O.lf,ke=O.uf;y.boxpoints&&j.length&&(ve=Math.min(ve,j[0]),ke=Math.max(ke,j[W-1])),y.notched&&(ve=Math.min(ve,O.ln),ke=Math.max(ke,O.un)),O.min=ve,O.max=ke}else{var Ee;p.warn(["Invalid input - make sure that q1 <= median <= q3","q1 = "+O.q1,"median = "+O.med,"q3 = "+O.q3].join(`
`)),Ee=O.med!==e?O.med:O.q1!==e?O.q3!==e?(O.q1+O.q3)/2:O.q1:O.q3!==e?O.q3:0,O.med=Ee,O.q1=O.q3=Ee,O.lf=O.uf=Ee,O.mean=O.sd=Ee,O.ln=O.un=Ee,O.min=O.max=Ee}$=Math.min($,O.min),te=Math.max(te,O.max),O.pts2=F.filter(q),M.push(O)}}y._extremes[x._id]=m.findExtremes(x,[$,te],{padded:!0})}else{var be=x.makeCalcdata(y,T),xe=function(We,Ge){for(var Qe=We.length,it=new Array(Qe+1),lt=0;lt<Qe;lt++)it[lt]=We[lt]-Ge;return it[Qe]=We[Qe-1]+Ge,it}(D,B),ue=D.length,me=function(We){for(var Ge=new Array(We),Qe=0;Qe<We;Qe++)Ge[Qe]=[];return Ge}(ue);for(v=0;v<y._length;v++)if(Q=be[v],t(Q)){var we=p.findBin(G[v],xe);we>=0&&we<ue&&(i(Z={v:Q,i:v},y,v),me[we].push(Z))}var Me=1/0,Se=-1/0,De=y.quartilemethod,Fe=De==="exclusive",Ye=De==="inclusive";for(v=0;v<ue;v++)if(me[v].length>0){var et,Oe;(O={}).pos=O[S]=D[v],F=O.pts=me[v].sort(s),W=(j=O[T]=F.map(o)).length,O.min=j[0],O.max=j[W-1],O.mean=p.mean(j,W),O.sd=p.stdev(j,W,O.mean),O.med=p.interp(j,.5),W%2&&(Fe||Ye)?(Fe?(et=j.slice(0,W/2),Oe=j.slice(W/2+1)):Ye&&(et=j.slice(0,W/2+1),Oe=j.slice(W/2)),O.q1=p.interp(et,.5),O.q3=p.interp(Oe,.5)):(O.q1=p.interp(j,.25),O.q3=p.interp(j,.75)),O.lf=a(O,j,W),O.uf=c(O,j,W),O.lo=r(O),O.uo=n(O);var je=d(O,W);O.ln=O.med-je,O.un=O.med+je,Me=Math.min(Me,O.ln),Se=Math.max(Se,O.un),O.pts2=F.filter(q),M.push(O)}y._extremes[x._id]=m.findExtremes(x,y.notched?be.concat([Me,Se]):be,{padded:!0})}return function(We,Ge){if(p.isArrayOrTypedArray(Ge.selectedpoints))for(var Qe=0;Qe<We.length;Qe++){for(var it=We[Qe].pts||[],lt={},Lt=0;Lt<it.length;Lt++)lt[it[Lt].i]=Lt;p.tagSelected(it,Ge,lt)}}(M,y),M.length>0?(M[0].t={num:L[P],dPos:B,posLetter:S,valLetter:T,labels:{med:f(l,"median:"),min:f(l,"min:"),q1:f(l,"q1:"),q3:f(l,"q3:"),max:f(l,"max:"),mean:y.boxmean==="sd"?f(l,"mean \xB1 \u03C3:"):f(l,"mean:"),lf:f(l,"lower fence:"),uf:f(l,"upper fence:")}},L[P]++,M):[{t:{empty:!0}}]};var u={text:"tx",hovertext:"htx"};function i(l,y,v){for(var _ in u)p.isArrayOrTypedArray(y[_])&&(Array.isArray(v)?p.isArrayOrTypedArray(y[_][v[0]])&&(l[u[_]]=y[_][v[0]][v[1]]):l[u[_]]=y[_][v])}function s(l,y){return l.v-y.v}function o(l){return l.v}function a(l,y,v){return v===0?l.q1:Math.min(l.q1,y[Math.min(p.findBin(2.5*l.q1-1.5*l.q3,y,!0)+1,v-1)])}function c(l,y,v){return v===0?l.q3:Math.max(l.q3,y[Math.max(p.findBin(2.5*l.q3-1.5*l.q1,y),0)])}function r(l){return 4*l.q1-3*l.q3}function n(l){return 4*l.q3-3*l.q1}function d(l,y){return y===0?0:1.57*(l.q3-l.q1)/Math.sqrt(y)}},{"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/align_period":835,"../../plots/cartesian/axes":838,"fast-isnumeric":246}],952:[function(h,N,H){var t=h("../../plots/cartesian/axes"),m=h("../../lib"),g=h("../../plots/cartesian/constraints").getAxisGroup,p=["v","h"];function e(f,u,i,s){var o,a,c,r=u.calcdata,n=u._fullLayout,d=s._id,l=d.charAt(0),y=[],v=0;for(o=0;o<i.length;o++)for(c=r[i[o]],a=0;a<c.length;a++)y.push(s.c2l(c[a].pos,!0)),v+=(c[a].pts2||[]).length;if(y.length){var _=m.distinctVals(y);s.type!=="category"&&s.type!=="multicategory"||(_.minDiff=1);var x=_.minDiff/2;t.minDtick(s,_.minDiff,_.vals[0],!0);var T=n[f==="violin"?"_numViolins":"_numBoxes"],A=n[f+"mode"]==="group"&&T>1,S=1-n[f+"gap"],w=1-n[f+"groupgap"];for(o=0;o<i.length;o++){var L,k,C,M,P,O,F=(c=r[i[o]])[0].trace,j=c[0].t,W=F.width,Z=F.side;if(W)L=k=M=W/2,C=0;else if(L=x,A){var Q=g(n,s._id)+F.orientation,X=(n._alignmentOpts[Q]||{})[F.alignmentgroup]||{},G=Object.keys(X.offsetGroups||{}).length,Y=G||T;k=L*S*w/Y,C=2*L*(((G?F._offsetIndex:j.num)+.5)/Y-.5)*S,M=L*S/Y}else k=L*S*w,C=0,M=L;j.dPos=L,j.bPos=C,j.bdPos=k,j.wHover=M;var K,D,B,q,ee,J,$=C+k,te=Boolean(W);if(Z==="positive"?(P=L*(W?1:.5),K=$,O=K=C):Z==="negative"?(P=K=C,O=L*(W?1:.5),D=$):(P=O=L,K=D=$),(F.boxpoints||F.points)&&v>0){var ie=F.pointpos,ae=F.jitter,he=F.marker.size/2,se=0;ie+ae>=0&&((se=$*(ie+ae))>P?(te=!0,ee=he,B=se):se>K&&(ee=he,B=P)),se<=P&&(B=P);var de=0;ie-ae<=0&&((de=-$*(ie-ae))>O?(te=!0,J=he,q=de):de>D&&(J=he,q=O)),de<=O&&(q=O)}else B=P,q=O;var ce=new Array(c.length);for(a=0;a<c.length;a++)ce[a]=c[a].pos;F._extremes[d]=t.findExtremes(s,ce,{padded:te,vpadminus:q,vpadplus:B,vpadLinearized:!0,ppadminus:{x:J,y:ee}[l],ppadplus:{x:ee,y:J}[l]})}}}N.exports={crossTraceCalc:function(f,u){for(var i=f.calcdata,s=u.xaxis,o=u.yaxis,a=0;a<p.length;a++){for(var c=p[a],r=c==="h"?o:s,n=[],d=0;d<i.length;d++){var l=i[d],y=l[0].t,v=l[0].trace;v.visible!==!0||v.type!=="box"&&v.type!=="candlestick"||y.empty||(v.orientation||"v")!==c||v.xaxis!==s._id||v.yaxis!==o._id||n.push(d)}e("box",f,n,r)}},setPositionOffset:e}},{"../../lib":787,"../../plots/cartesian/axes":838,"../../plots/cartesian/constraints":846}],953:[function(h,N,H){var t=h("../../lib"),m=h("../../registry"),g=h("../../components/color"),p=h("../scatter/period_defaults"),e=h("../bar/defaults").handleGroupingDefaults,f=h("../../plots/cartesian/axis_autotype"),u=h("./attributes");function i(o,a,c,r){function n(Z){var Q=0;return Z&&Z.length&&(Q+=1,t.isArrayOrTypedArray(Z[0])&&Z[0].length&&(Q+=1)),Q}function d(Z){return t.validate(o[Z],u[Z])}var l,y=c("y"),v=c("x");if(a.type==="box"){var _=c("q1"),x=c("median"),T=c("q3");a._hasPreCompStats=_&&_.length&&x&&x.length&&T&&T.length,l=Math.min(t.minRowLength(_),t.minRowLength(x),t.minRowLength(T))}var A,S,w=n(y),L=n(v),k=w&&t.minRowLength(y),C=L&&t.minRowLength(v),M=r.calendar,P={autotypenumbers:r.autotypenumbers};if(a._hasPreCompStats)switch(String(L)+String(w)){case"00":var O=d("x0")||d("dx");A=(d("y0")||d("dy"))&&!O?"h":"v",S=l;break;case"10":A="v",S=Math.min(l,C);break;case"20":A="h",S=Math.min(l,v.length);break;case"01":A="h",S=Math.min(l,k);break;case"02":A="v",S=Math.min(l,y.length);break;case"12":A="v",S=Math.min(l,C,y.length);break;case"21":A="h",S=Math.min(l,v.length,k);break;case"11":S=0;break;case"22":var F,j=!1;for(F=0;F<v.length;F++)if(f(v[F],M,P)==="category"){j=!0;break}if(j)A="v",S=Math.min(l,C,y.length);else{for(F=0;F<y.length;F++)if(f(y[F],M,P)==="category"){j=!0;break}j?(A="h",S=Math.min(l,v.length,k)):(A="v",S=Math.min(l,C,y.length))}}else w>0?(A="v",S=L>0?Math.min(C,k):Math.min(k)):L>0?(A="h",S=Math.min(C)):S=0;if(S){a._length=S;var W=c("orientation",A);a._hasPreCompStats?W==="v"&&L===0?(c("x0",0),c("dx",1)):W==="h"&&w===0&&(c("y0",0),c("dy",1)):W==="v"&&L===0?c("x0"):W==="h"&&w===0&&c("y0"),m.getComponentMethod("calendars","handleTraceDefaults")(o,a,["x","y"],r)}else a.visible=!1}function s(o,a,c,r){var n=r.prefix,d=t.coerce2(o,a,u,"marker.outliercolor"),l=c("marker.line.outliercolor"),y="outliers";a._hasPreCompStats?y="all":(d||l)&&(y="suspectedoutliers");var v=c(n+"points",y);v?(c("jitter",v==="all"?.3:0),c("pointpos",v==="all"?-1.5:0),c("marker.symbol"),c("marker.opacity"),c("marker.size"),c("marker.color",a.line.color),c("marker.line.color"),c("marker.line.width"),v==="suspectedoutliers"&&(c("marker.line.outliercolor",a.marker.color),c("marker.line.outlierwidth")),c("selected.marker.color"),c("unselected.marker.color"),c("selected.marker.size"),c("unselected.marker.size"),c("text"),c("hovertext")):delete a.marker;var _=c("hoveron");_!=="all"&&_.indexOf("points")===-1||c("hovertemplate"),t.coerceSelectionMarkerOpacity(a,c)}N.exports={supplyDefaults:function(o,a,c,r){function n(T,A){return t.coerce(o,a,u,T,A)}if(i(o,a,n,r),a.visible!==!1){p(o,a,r,n),n("xhoverformat"),n("yhoverformat");var d=a._hasPreCompStats;d&&(n("lowerfence"),n("upperfence")),n("line.color",(o.marker||{}).color||c),n("line.width"),n("fillcolor",g.addOpacity(a.line.color,.5));var l=!1;if(d){var y=n("mean"),v=n("sd");y&&y.length&&(l=!0,v&&v.length&&(l="sd"))}n("boxmean",l),n("whiskerwidth"),n("width"),n("quartilemethod");var _=!1;if(d){var x=n("notchspan");x&&x.length&&(_=!0)}else t.validate(o.notchwidth,u.notchwidth)&&(_=!0);n("notched",_)&&n("notchwidth"),s(o,a,n,{prefix:"box"})}},crossTraceDefaults:function(o,a){var c,r;function n(y){return t.coerce(r._input,r,u,y)}for(var d=0;d<o.length;d++){var l=(r=o[d]).type;l!=="box"&&l!=="violin"||(c=r._input,a[l+"mode"]==="group"&&e(c,r,a,n))}},handleSampleDefaults:i,handlePointsDefaults:s}},{"../../components/color":650,"../../lib":787,"../../plots/cartesian/axis_autotype":839,"../../registry":915,"../bar/defaults":929,"../scatter/period_defaults":1222,"./attributes":950}],954:[function(h,N,H){N.exports=function(t,m){return m.hoverOnBox&&(t.hoverOnBox=m.hoverOnBox),"xVal"in m&&(t.x=m.xVal),"yVal"in m&&(t.y=m.yVal),m.xa&&(t.xaxis=m.xa),m.ya&&(t.yaxis=m.ya),t}},{}],955:[function(h,N,H){var t=h("../../plots/cartesian/axes"),m=h("../../lib"),g=h("../../components/fx"),p=h("../../components/color"),e=m.fillText;function f(i,s,o,a){var c,r,n,d,l,y,v,_,x,T,A,S,w,L,k=i.cd,C=i.xa,M=i.ya,P=k[0].trace,O=k[0].t,F=P.type==="violin",j=[],W=O.bdPos,Z=O.wHover,Q=function(se){return n.c2l(se.pos)+O.bPos-n.c2l(y)};F&&P.side!=="both"?(P.side==="positive"&&(x=function(se){var de=Q(se);return g.inbox(de,de+Z,T)},S=W,w=0),P.side==="negative"&&(x=function(se){var de=Q(se);return g.inbox(de-Z,de,T)},S=0,w=W)):(x=function(se){var de=Q(se);return g.inbox(de-Z,de+Z,T)},S=w=W),L=F?function(se){return g.inbox(se.span[0]-l,se.span[1]-l,T)}:function(se){return g.inbox(se.min-l,se.max-l,T)},P.orientation==="h"?(l=s,y=o,v=L,_=x,c="y",n=M,r="x",d=C):(l=o,y=s,v=x,_=L,c="x",n=C,r="y",d=M);var X=Math.min(1,W/Math.abs(n.r2c(n.range[1])-n.r2c(n.range[0])));function G(se){return(v(se)+_(se))/2}T=i.maxHoverDistance-X,A=i.maxSpikeDistance-X;var Y=g.getDistanceFunction(a,v,_,G);if(g.getClosest(k,Y,i),i.index===!1)return[];var K=k[i.index],D=P.line.color,B=(P.marker||{}).color;p.opacity(D)&&P.line.width?i.color=D:p.opacity(B)&&P.boxpoints?i.color=B:i.color=P.fillcolor,i[c+"0"]=n.c2p(K.pos+O.bPos-w,!0),i[c+"1"]=n.c2p(K.pos+O.bPos+S,!0),i[c+"LabelVal"]=K.orig_p!==void 0?K.orig_p:K.pos;var q=c+"Spike";i.spikeDistance=G(K)*A/T,i[q]=n.c2p(K.pos,!0);var ee={},J=["med","q1","q3","min","max"];(P.boxmean||(P.meanline||{}).visible)&&J.push("mean"),(P.boxpoints||P.points)&&J.push("lf","uf");for(var $=0;$<J.length;$++){var te=J[$];if(te in K&&!(K[te]in ee)){ee[K[te]]=!0;var ie=K[te],ae=d.c2p(ie,!0),he=m.extendFlat({},i);he.attr=te,he[r+"0"]=he[r+"1"]=ae,he[r+"LabelVal"]=ie,he[r+"Label"]=(O.labels?O.labels[te]+" ":"")+t.hoverLabelText(d,ie,P[r+"hoverformat"]),he.hoverOnBox=!0,te==="mean"&&"sd"in K&&P.boxmean==="sd"&&(he[r+"err"]=K.sd),i.name="",i.spikeDistance=void 0,i[q]=void 0,he.hovertemplate=!1,j.push(he)}}return j}function u(i,s,o){for(var a,c,r,n=i.cd,d=i.xa,l=i.ya,y=n[0].trace,v=d.c2p(s),_=l.c2p(o),x=g.quadrature(function(F){var j=Math.max(3,F.mrc||0);return Math.max(Math.abs(d.c2p(F.x)-v)-j,1-3/j)},function(F){var j=Math.max(3,F.mrc||0);return Math.max(Math.abs(l.c2p(F.y)-_)-j,1-3/j)}),T=!1,A=0;A<n.length;A++){c=n[A];for(var S=0;S<(c.pts||[]).length;S++){var w=x(r=c.pts[S]);w<=i.distance&&(i.distance=w,T=[A,S])}}if(!T)return!1;r=(c=n[T[0]]).pts[T[1]];var L=d.c2p(r.x,!0),k=l.c2p(r.y,!0),C=r.mrc||1;a=m.extendFlat({},i,{index:r.i,color:(y.marker||{}).color,name:y.name,x0:L-C,x1:L+C,y0:k-C,y1:k+C,spikeDistance:i.distance,hovertemplate:y.hovertemplate});var M,P=c.orig_p,O=P!==void 0?P:c.pos;return y.orientation==="h"?(M=l,a.xLabelVal=r.x,a.yLabelVal=O):(M=d,a.xLabelVal=O,a.yLabelVal=r.y),a[M._id.charAt(0)+"Spike"]=M.c2p(c.pos,!0),e(r,y,a),a}N.exports={hoverPoints:function(i,s,o,a){var c,r=i.cd[0].trace.hoveron,n=[];return r.indexOf("boxes")!==-1&&(n=n.concat(f(i,s,o,a))),r.indexOf("points")!==-1&&(c=u(i,s,o)),a==="closest"?c?[c]:n:(c&&n.push(c),n)},hoverOnBoxes:f,hoverOnPoints:u}},{"../../components/color":650,"../../components/fx":690,"../../lib":787,"../../plots/cartesian/axes":838}],956:[function(h,N,H){N.exports={attributes:h("./attributes"),layoutAttributes:h("./layout_attributes"),supplyDefaults:h("./defaults").supplyDefaults,crossTraceDefaults:h("./defaults").crossTraceDefaults,supplyLayoutDefaults:h("./layout_defaults").supplyLayoutDefaults,calc:h("./calc"),crossTraceCalc:h("./cross_trace_calc").crossTraceCalc,plot:h("./plot").plot,style:h("./style").style,styleOnSelect:h("./style").styleOnSelect,hoverPoints:h("./hover").hoverPoints,eventData:h("./event_data"),selectPoints:h("./select"),moduleType:"trace",name:"box",basePlotModule:h("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","boxLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":852,"./attributes":950,"./calc":951,"./cross_trace_calc":952,"./defaults":953,"./event_data":954,"./hover":955,"./layout_attributes":957,"./layout_defaults":958,"./plot":959,"./select":960,"./style":961}],957:[function(h,N,H){N.exports={boxmode:{valType:"enumerated",values:["group","overlay"],dflt:"overlay",editType:"calc"},boxgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"},boxgroupgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"}}},{}],958:[function(h,N,H){var t=h("../../registry"),m=h("../../lib"),g=h("./layout_attributes");function p(e,f,u,i,s){for(var o=s+"Layout",a=!1,c=0;c<u.length;c++){var r=u[c];if(t.traceIs(r,o)){a=!0;break}}a&&(i(s+"mode"),i(s+"gap"),i(s+"groupgap"))}N.exports={supplyLayoutDefaults:function(e,f,u){p(0,0,u,function(i,s){return m.coerce(e,f,g,i,s)},"box")},_supply:p}},{"../../lib":787,"../../registry":915,"./layout_attributes":957}],959:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../lib"),g=h("../../components/drawing");function p(u,i,s,o){var a,c,r=s.orientation==="h",n=i.val,d=i.pos,l=!!d.rangebreaks,y=o.bPos,v=o.wdPos||0,_=o.bPosPxOffset||0,x=s.whiskerwidth||0,T=s.notched||!1,A=T?1-2*s.notchwidth:1;Array.isArray(o.bdPos)?(a=o.bdPos[0],c=o.bdPos[1]):(a=o.bdPos,c=o.bdPos);var S=u.selectAll("path.box").data(s.type!=="violin"||s.box.visible?m.identity:[]);S.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","box"),S.exit().remove(),S.each(function(w){if(w.empty)return"M0,0Z";var L=d.c2l(w.pos+y,!0),k=d.l2p(L-a)+_,C=d.l2p(L+c)+_,M=l?(k+C)/2:d.l2p(L)+_,P=s.whiskerwidth,O=l?k*P+(1-P)*M:d.l2p(L-v)+_,F=l?C*P+(1-P)*M:d.l2p(L+v)+_,j=d.l2p(L-a*A)+_,W=d.l2p(L+c*A)+_,Z=n.c2p(w.q1,!0),Q=n.c2p(w.q3,!0),X=m.constrain(n.c2p(w.med,!0),Math.min(Z,Q)+1,Math.max(Z,Q)-1),G=w.lf===void 0||s.boxpoints===!1,Y=n.c2p(G?w.min:w.lf,!0),K=n.c2p(G?w.max:w.uf,!0),D=n.c2p(w.ln,!0),B=n.c2p(w.un,!0);r?t.select(this).attr("d","M"+X+","+j+"V"+W+"M"+Z+","+k+"V"+C+(T?"H"+D+"L"+X+","+W+"L"+B+","+C:"")+"H"+Q+"V"+k+(T?"H"+B+"L"+X+","+j+"L"+D+","+k:"")+"ZM"+Z+","+M+"H"+Y+"M"+Q+","+M+"H"+K+(x===0?"":"M"+Y+","+O+"V"+F+"M"+K+","+O+"V"+F)):t.select(this).attr("d","M"+j+","+X+"H"+W+"M"+k+","+Z+"H"+C+(T?"V"+D+"L"+W+","+X+"L"+C+","+B:"")+"V"+Q+"H"+k+(T?"V"+B+"L"+j+","+X+"L"+k+","+D:"")+"ZM"+M+","+Z+"V"+Y+"M"+M+","+Q+"V"+K+(x===0?"":"M"+O+","+Y+"H"+F+"M"+O+","+K+"H"+F))})}function e(u,i,s,o){var a=i.x,c=i.y,r=o.bdPos,n=o.bPos,d=s.boxpoints||s.points;m.seedPseudoRandom();var l=u.selectAll("g.points").data(d?function(v){return v.forEach(function(_){_.t=o,_.trace=s}),v}:[]);l.enter().append("g").attr("class","points"),l.exit().remove();var y=l.selectAll("path").data(function(v){var _,x,T=v.pts2,A=Math.max((v.max-v.min)/10,v.q3-v.q1),S=1e-9*A,w=.01*A,L=[],k=0;if(s.jitter){if(A===0)for(k=1,L=new Array(T.length),_=0;_<T.length;_++)L[_]=1;else for(_=0;_<T.length;_++){var C=Math.max(0,_-5),M=T[C].v,P=Math.min(T.length-1,_+5),O=T[P].v;d!=="all"&&(T[_].v<v.lf?O=Math.min(O,v.lf):M=Math.max(M,v.uf));var F=Math.sqrt(w*(P-C)/(O-M+S))||0;F=m.constrain(Math.abs(F),0,1),L.push(F),k=Math.max(F,k)}x=2*s.jitter/(k||1)}for(_=0;_<T.length;_++){var j=T[_],W=j.v,Z=s.jitter?x*L[_]*(m.pseudoRandom()-.5):0,Q=v.pos+n+r*(s.pointpos+Z);s.orientation==="h"?(j.y=Q,j.x=W):(j.x=Q,j.y=W),d==="suspectedoutliers"&&W<v.uo&&W>v.lo&&(j.so=!0)}return T});y.enter().append("path").classed("point",!0),y.exit().remove(),y.call(g.translatePoints,a,c)}function f(u,i,s,o){var a,c,r=i.val,n=i.pos,d=!!n.rangebreaks,l=o.bPos,y=o.bPosPxOffset||0,v=s.boxmean||(s.meanline||{}).visible;Array.isArray(o.bdPos)?(a=o.bdPos[0],c=o.bdPos[1]):(a=o.bdPos,c=o.bdPos);var _=u.selectAll("path.mean").data(s.type==="box"&&s.boxmean||s.type==="violin"&&s.box.visible&&s.meanline.visible?m.identity:[]);_.enter().append("path").attr("class","mean").style({fill:"none","vector-effect":"non-scaling-stroke"}),_.exit().remove(),_.each(function(x){var T=n.c2l(x.pos+l,!0),A=n.l2p(T-a)+y,S=n.l2p(T+c)+y,w=d?(A+S)/2:n.l2p(T)+y,L=r.c2p(x.mean,!0),k=r.c2p(x.mean-x.sd,!0),C=r.c2p(x.mean+x.sd,!0);s.orientation==="h"?t.select(this).attr("d","M"+L+","+A+"V"+S+(v==="sd"?"m0,0L"+k+","+w+"L"+L+","+A+"L"+C+","+w+"Z":"")):t.select(this).attr("d","M"+A+","+L+"H"+S+(v==="sd"?"m0,0L"+w+","+k+"L"+A+","+L+"L"+w+","+C+"Z":""))})}N.exports={plot:function(u,i,s,o){var a=i.xaxis,c=i.yaxis;m.makeTraceGroups(o,s,"trace boxes").each(function(r){var n,d,l=t.select(this),y=r[0],v=y.t,_=y.trace;v.wdPos=v.bdPos*_.whiskerwidth,_.visible!==!0||v.empty?l.remove():(_.orientation==="h"?(n=c,d=a):(n=a,d=c),p(l,{pos:n,val:d},_,v),e(l,{x:a,y:c},_,v),f(l,{pos:n,val:d},_,v))})},plotBoxAndWhiskers:p,plotPoints:e,plotBoxMean:f}},{"../../components/drawing":672,"../../lib":787,"@plotly/d3":58}],960:[function(h,N,H){N.exports=function(t,m){var g,p,e=t.cd,f=t.xaxis,u=t.yaxis,i=[];if(m===!1)for(g=0;g<e.length;g++)for(p=0;p<(e[g].pts||[]).length;p++)e[g].pts[p].selected=0;else for(g=0;g<e.length;g++)for(p=0;p<(e[g].pts||[]).length;p++){var s=e[g].pts[p],o=f.c2p(s.x),a=u.c2p(s.y);m.contains([o,a],null,s.i,t)?(i.push({pointNumber:s.i,x:f.c2d(s.x),y:u.c2d(s.y)}),s.selected=1):s.selected=0}return i}},{}],961:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../components/color"),g=h("../../components/drawing");N.exports={style:function(p,e,f){var u=f||t.select(p).selectAll("g.trace.boxes");u.style("opacity",function(i){return i[0].trace.opacity}),u.each(function(i){var s=t.select(this),o=i[0].trace,a=o.line.width;function c(d,l,y,v){d.style("stroke-width",l+"px").call(m.stroke,y).call(m.fill,v)}var r=s.selectAll("path.box");if(o.type==="candlestick")r.each(function(d){if(!d.empty){var l=t.select(this),y=o[d.dir];c(l,y.line.width,y.line.color,y.fillcolor),l.style("opacity",o.selectedpoints&&!d.selected?.3:1)}});else{c(r,a,o.line.color,o.fillcolor),s.selectAll("path.mean").style({"stroke-width":a,"stroke-dasharray":2*a+"px,"+a+"px"}).call(m.stroke,o.line.color);var n=s.selectAll("path.point");g.pointStyle(n,o,p)}})},styleOnSelect:function(p,e,f){var u=e[0].trace,i=f.selectAll("path.point");u.selectedpoints?g.selectedPointStyle(i,u):g.pointStyle(i,u,p)}}},{"../../components/color":650,"../../components/drawing":672,"@plotly/d3":58}],962:[function(h,N,H){var t=h("../../lib").extendFlat,m=h("../../plots/cartesian/axis_format_attributes").axisHoverFormat,g=h("../ohlc/attributes"),p=h("../box/attributes");function e(f){return{line:{color:t({},p.line.color,{dflt:f}),width:p.line.width,editType:"style"},fillcolor:p.fillcolor,editType:"style"}}N.exports={xperiod:g.xperiod,xperiod0:g.xperiod0,xperiodalignment:g.xperiodalignment,xhoverformat:m("x"),yhoverformat:m("y"),x:g.x,open:g.open,high:g.high,low:g.low,close:g.close,line:{width:t({},p.line.width,{}),editType:"style"},increasing:e(g.increasing.line.color.dflt),decreasing:e(g.decreasing.line.color.dflt),text:g.text,hovertext:g.hovertext,whiskerwidth:t({},p.whiskerwidth,{dflt:0}),hoverlabel:g.hoverlabel}},{"../../lib":787,"../../plots/cartesian/axis_format_attributes":841,"../box/attributes":950,"../ohlc/attributes":1148}],963:[function(h,N,H){var t=h("../../lib"),m=h("../../plots/cartesian/axes"),g=h("../../plots/cartesian/align_period"),p=h("../ohlc/calc").calcCommon;function e(f,u,i,s){return{min:i,q1:Math.min(f,s),med:s,q3:Math.max(f,s),max:u}}N.exports=function(f,u){var i=f._fullLayout,s=m.getFromId(f,u.xaxis),o=m.getFromId(f,u.yaxis),a=s.makeCalcdata(u,"x"),c=g(u,s,"x",a).vals,r=p(f,u,a,c,o,e);return r.length?(t.extendFlat(r[0].t,{num:i._numBoxes,dPos:t.distinctVals(c).minDiff/2,posLetter:"x",valLetter:"y"}),i._numBoxes++,r):[{t:{empty:!0}}]}},{"../../lib":787,"../../plots/cartesian/align_period":835,"../../plots/cartesian/axes":838,"../ohlc/calc":1149}],964:[function(h,N,H){var t=h("../../lib"),m=h("../../components/color"),g=h("../ohlc/ohlc_defaults"),p=h("../scatter/period_defaults"),e=h("./attributes");function f(u,i,s,o){var a=s(o+".line.color");s(o+".line.width",i.line.width),s(o+".fillcolor",m.addOpacity(a,.5))}N.exports=function(u,i,s,o){function a(c,r){return t.coerce(u,i,e,c,r)}g(u,i,a,o)?(p(u,i,o,a,{x:!0}),a("xhoverformat"),a("yhoverformat"),a("line.width"),f(u,i,a,"increasing"),f(u,i,a,"decreasing"),a("text"),a("hovertext"),a("whiskerwidth"),o._requestRangeslider[i.xaxis]=!0):i.visible=!1}},{"../../components/color":650,"../../lib":787,"../ohlc/ohlc_defaults":1153,"../scatter/period_defaults":1222,"./attributes":962}],965:[function(h,N,H){N.exports={moduleType:"trace",name:"candlestick",basePlotModule:h("../../plots/cartesian"),categories:["cartesian","svg","showLegend","candlestick","boxLayout"],meta:{},attributes:h("./attributes"),layoutAttributes:h("../box/layout_attributes"),supplyLayoutDefaults:h("../box/layout_defaults").supplyLayoutDefaults,crossTraceCalc:h("../box/cross_trace_calc").crossTraceCalc,supplyDefaults:h("./defaults"),calc:h("./calc"),plot:h("../box/plot").plot,layerName:"boxlayer",style:h("../box/style").style,hoverPoints:h("../ohlc/hover").hoverPoints,selectPoints:h("../ohlc/select")}},{"../../plots/cartesian":852,"../box/cross_trace_calc":952,"../box/layout_attributes":957,"../box/layout_defaults":958,"../box/plot":959,"../box/style":961,"../ohlc/hover":1151,"../ohlc/select":1155,"./attributes":962,"./calc":963,"./defaults":964}],966:[function(h,N,H){var t=h("./axis_defaults"),m=h("../../plot_api/plot_template");N.exports=function(g,p,e,f,u){f("a")||(f("da"),f("a0")),f("b")||(f("db"),f("b0")),function(i,s,o,a){["aaxis","baxis"].forEach(function(c){var r=c.charAt(0),n=i[c]||{},d=m.newContainer(s,c),l={tickfont:"x",id:r+"axis",letter:r,font:s.font,name:c,data:i[r],calendar:s.calendar,dfltColor:a,bgColor:o.paper_bgcolor,autotypenumbersDflt:o.autotypenumbers,fullLayout:o};t(n,d,l),d._categories=d._categories||[],i[c]||n.type==="-"||(i[c]={type:n.type})})}(g,p,e,u)}},{"../../plot_api/plot_template":827,"./axis_defaults":971}],967:[function(h,N,H){var t=h("../../lib").isArrayOrTypedArray;N.exports=function(m){return function g(p,e){if(!t(p)||e>=10)return null;for(var f=1/0,u=-1/0,i=p.length,s=0;s<i;s++){var o=p[s];if(t(o)){var a=g(o,e+1);a&&(f=Math.min(a[0],f),u=Math.max(a[1],u))}else f=Math.min(o,f),u=Math.max(o,u)}return[f,u]}(m,0)}},{"../../lib":787}],968:[function(h,N,H){var t=h("../../plots/font_attributes"),m=h("./axis_attributes"),g=h("../../components/color/attributes"),p=t({editType:"calc"});p.family.dflt='"Open Sans", verdana, arial, sans-serif',p.size.dflt=12,p.color.dflt=g.defaultLine,N.exports={carpet:{valType:"string",editType:"calc"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},a:{valType:"data_array",editType:"calc"},a0:{valType:"number",dflt:0,editType:"calc"},da:{valType:"number",dflt:1,editType:"calc"},b:{valType:"data_array",editType:"calc"},b0:{valType:"number",dflt:0,editType:"calc"},db:{valType:"number",dflt:1,editType:"calc"},cheaterslope:{valType:"number",dflt:1,editType:"calc"},aaxis:m,baxis:m,font:p,color:{valType:"color",dflt:g.defaultLine,editType:"plot"},transforms:void 0}},{"../../components/color/attributes":649,"../../plots/font_attributes":867,"./axis_attributes":970}],969:[function(h,N,H){var t=h("../../lib").isArrayOrTypedArray;N.exports=function(m,g,p,e){var f,u,i,s,o,a,c,r,n,d,l,y,v,_=t(p)?"a":"b",x=(_==="a"?m.aaxis:m.baxis).smoothing,T=_==="a"?m.a2i:m.b2j,A=_==="a"?p:e,S=_==="a"?e:p,w=_==="a"?g.a.length:g.b.length,L=_==="a"?g.b.length:g.a.length,k=Math.floor(_==="a"?m.b2j(S):m.a2i(S)),C=_==="a"?function(K){return m.evalxy([],K,k)}:function(K){return m.evalxy([],k,K)};x&&(i=Math.max(0,Math.min(L-2,k)),s=k-i,u=_==="a"?function(K,D){return m.dxydi([],K,i,D,s)}:function(K,D){return m.dxydj([],i,K,s,D)});var M=T(A[0]),P=T(A[1]),O=M<P?1:-1,F=1e-8*(P-M),j=O>0?Math.floor:Math.ceil,W=O>0?Math.ceil:Math.floor,Z=O>0?Math.min:Math.max,Q=O>0?Math.max:Math.min,X=j(M+F),G=W(P-F),Y=[[c=C(M)]];for(f=X;f*O<G*O;f+=O)o=[],l=Q(M,f),v=(y=Z(P,f+O))-l,a=Math.max(0,Math.min(w-2,Math.floor(.5*(l+y)))),r=C(y),x&&(n=u(a,l-a),d=u(a,y-a),o.push([c[0]+n[0]/3*v,c[1]+n[1]/3*v]),o.push([r[0]-d[0]/3*v,r[1]-d[1]/3*v])),o.push(r),Y.push(o),c=r;return Y}},{"../../lib":787}],970:[function(h,N,H){var t=h("../../plots/font_attributes"),m=h("../../components/color/attributes"),g=h("../../plots/cartesian/layout_attributes"),p=h("../../plots/cartesian/axis_format_attributes").descriptionWithDates,e=h("../../plot_api/edit_types").overrideAll;N.exports={color:{valType:"color",editType:"calc"},smoothing:{valType:"number",dflt:1,min:0,max:1.3,editType:"calc"},title:{text:{valType:"string",dflt:"",editType:"calc"},font:t({editType:"calc"}),offset:{valType:"number",dflt:10,editType:"calc"},editType:"calc"},type:{valType:"enumerated",values:["-","linear","date","category"],dflt:"-",editType:"calc"},autotypenumbers:g.autotypenumbers,autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"calc"},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"calc"},range:{valType:"info_array",editType:"calc",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}]},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},cheatertype:{valType:"enumerated",values:["index","value"],dflt:"value",editType:"calc"},tickmode:{valType:"enumerated",values:["linear","array"],dflt:"array",editType:"calc"},nticks:{valType:"integer",min:0,dflt:0,editType:"calc"},tickvals:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},showticklabels:{valType:"enumerated",values:["start","end","both","none"],dflt:"start",editType:"calc"},tickfont:t({editType:"calc"}),tickangle:{valType:"angle",dflt:"auto",editType:"calc"},tickprefix:{valType:"string",dflt:"",editType:"calc"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},ticksuffix:{valType:"string",dflt:"",editType:"calc"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"calc"},minexponent:{valType:"number",dflt:3,min:0,editType:"calc"},separatethousands:{valType:"boolean",dflt:!1,editType:"calc"},tickformat:{valType:"string",dflt:"",editType:"calc",description:p("tick label")},tickformatstops:e(g.tickformatstops,"calc","from-root"),categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},labelpadding:{valType:"integer",dflt:10,editType:"calc"},labelprefix:{valType:"string",editType:"calc"},labelsuffix:{valType:"string",dflt:"",editType:"calc"},showline:{valType:"boolean",dflt:!1,editType:"calc"},linecolor:{valType:"color",dflt:m.defaultLine,editType:"calc"},linewidth:{valType:"number",min:0,dflt:1,editType:"calc"},gridcolor:{valType:"color",editType:"calc"},gridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},showgrid:{valType:"boolean",dflt:!0,editType:"calc"},minorgridcount:{valType:"integer",min:0,dflt:0,editType:"calc"},minorgridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},minorgridcolor:{valType:"color",dflt:m.lightLine,editType:"calc"},startline:{valType:"boolean",editType:"calc"},startlinecolor:{valType:"color",editType:"calc"},startlinewidth:{valType:"number",dflt:1,editType:"calc"},endline:{valType:"boolean",editType:"calc"},endlinewidth:{valType:"number",dflt:1,editType:"calc"},endlinecolor:{valType:"color",editType:"calc"},tick0:{valType:"number",min:0,dflt:0,editType:"calc"},dtick:{valType:"number",min:0,dflt:1,editType:"calc"},arraytick0:{valType:"integer",min:0,dflt:0,editType:"calc"},arraydtick:{valType:"integer",min:1,dflt:1,editType:"calc"},_deprecated:{title:{valType:"string",editType:"calc"},titlefont:t({editType:"calc"}),titleoffset:{valType:"number",dflt:10,editType:"calc"}},editType:"calc"}},{"../../components/color/attributes":649,"../../plot_api/edit_types":820,"../../plots/cartesian/axis_format_attributes":841,"../../plots/cartesian/layout_attributes":853,"../../plots/font_attributes":867}],971:[function(h,N,H){var t=h("./attributes"),m=h("../../components/color").addOpacity,g=h("../../registry"),p=h("../../lib"),e=h("../../plots/cartesian/tick_value_defaults"),f=h("../../plots/cartesian/tick_label_defaults"),u=h("../../plots/cartesian/category_order_defaults"),i=h("../../plots/cartesian/set_convert"),s=h("../../plots/cartesian/axis_autotype");N.exports=function(o,a,c){var r=c.letter,n=c.font||{},d=t[r+"axis"];function l(M,P){return p.coerce(o,a,d,M,P)}function y(M,P){return p.coerce2(o,a,d,M,P)}c.name&&(a._name=c.name,a._id=c.name),l("autotypenumbers",c.autotypenumbersDflt);var v=l("type");v==="-"&&(c.data&&function(M,P){if(M.type==="-"){var O=M._id.charAt(0),F=M[O+"calendar"];M.type=s(P,F,{autotypenumbers:M.autotypenumbers})}}(a,c.data),a.type==="-"?a.type="linear":v=o.type=a.type),l("smoothing"),l("cheatertype"),l("showticklabels"),l("labelprefix",r+" = "),l("labelsuffix"),l("showtickprefix"),l("showticksuffix"),l("separatethousands"),l("tickformat"),l("exponentformat"),l("minexponent"),l("showexponent"),l("categoryorder"),l("tickmode"),l("tickvals"),l("ticktext"),l("tick0"),l("dtick"),a.tickmode==="array"&&(l("arraytick0"),l("arraydtick")),l("labelpadding"),a._hovertitle=r,v==="date"&&g.getComponentMethod("calendars","handleDefaults")(o,a,"calendar",c.calendar),i(a,c.fullLayout),a.c2p=p.identity;var _=l("color",c.dfltColor),x=_===o.color?_:n.color;l("title.text")&&(p.coerceFont(l,"title.font",{family:n.family,size:p.bigFont(n.size),color:x}),l("title.offset")),l("tickangle"),l("autorange",!a.isValidRange(o.range))&&l("rangemode"),l("range"),a.cleanRange(),l("fixedrange"),e(o,a,l,v),f(o,a,l,v,c),u(o,a,l,{data:c.data,dataAttr:r});var T=y("gridcolor",m(_,.3)),A=y("gridwidth"),S=l("showgrid");S||(delete a.gridcolor,delete a.gridwidth);var w=y("startlinecolor",_),L=y("startlinewidth",A);l("startline",a.showgrid||!!w||!!L)||(delete a.startlinecolor,delete a.startlinewidth);var k=y("endlinecolor",_),C=y("endlinewidth",A);return l("endline",a.showgrid||!!k||!!C)||(delete a.endlinecolor,delete a.endlinewidth),S?(l("minorgridcount"),l("minorgridwidth",A),l("minorgridcolor",m(T,.06)),a.minorgridcount||(delete a.minorgridwidth,delete a.minorgridcolor)):(delete a.gridcolor,delete a.gridWidth),a.showticklabels==="none"&&(delete a.tickfont,delete a.tickangle,delete a.showexponent,delete a.exponentformat,delete a.minexponent,delete a.tickformat,delete a.showticksuffix,delete a.showtickprefix),a.showticksuffix||delete a.ticksuffix,a.showtickprefix||delete a.tickprefix,l("tickmode"),a}},{"../../components/color":650,"../../lib":787,"../../plots/cartesian/axis_autotype":839,"../../plots/cartesian/category_order_defaults":843,"../../plots/cartesian/set_convert":859,"../../plots/cartesian/tick_label_defaults":860,"../../plots/cartesian/tick_value_defaults":862,"../../registry":915,"./attributes":968}],972:[function(h,N,H){var t=h("../../plots/cartesian/axes"),m=h("../../lib").isArray1D,g=h("./cheater_basis"),p=h("./array_minmax"),e=h("./calc_gridlines"),f=h("./calc_labels"),u=h("./calc_clippath"),i=h("../heatmap/clean_2d_array"),s=h("./smooth_fill_2d_array"),o=h("../heatmap/convert_column_xyz"),a=h("./set_convert");N.exports=function(c,r){var n=t.getFromId(c,r.xaxis),d=t.getFromId(c,r.yaxis),l=r.aaxis,y=r.baxis,v=r.x,_=r.y,x=[];v&&m(v)&&x.push("x"),_&&m(_)&&x.push("y"),x.length&&o(r,l,y,"a","b",x);var T=r._a=r._a||r.a,A=r._b=r._b||r.b;v=r._x||r.x,_=r._y||r.y;var S={};if(r._cheater){var w=l.cheatertype==="index"?T.length:T,L=y.cheatertype==="index"?A.length:A;v=g(w,L,r.cheaterslope)}r._x=v=i(v),r._y=_=i(_),s(v,T,A),s(_,T,A),a(r),r.setScale();var k=p(v),C=p(_),M=.5*(k[1]-k[0]),P=.5*(k[1]+k[0]),O=.5*(C[1]-C[0]),F=.5*(C[1]+C[0]);return k=[P-1.3*M,P+1.3*M],C=[F-1.3*O,F+1.3*O],r._extremes[n._id]=t.findExtremes(n,k,{padded:!0}),r._extremes[d._id]=t.findExtremes(d,C,{padded:!0}),e(r,"a","b"),e(r,"b","a"),f(r,l),f(r,y),S.clipsegments=u(r._xctrl,r._yctrl,l,y),S.x=v,S.y=_,S.a=T,S.b=A,[S]}},{"../../lib":787,"../../plots/cartesian/axes":838,"../heatmap/clean_2d_array":1071,"../heatmap/convert_column_xyz":1073,"./array_minmax":967,"./calc_clippath":973,"./calc_gridlines":974,"./calc_labels":975,"./cheater_basis":977,"./set_convert":990,"./smooth_fill_2d_array":991}],973:[function(h,N,H){N.exports=function(t,m,g,p){var e,f,u,i=[],s=!!g.smoothing,o=!!p.smoothing,a=t[0].length-1,c=t.length-1;for(e=0,f=[],u=[];e<=a;e++)f[e]=t[0][e],u[e]=m[0][e];for(i.push({x:f,y:u,bicubic:s}),e=0,f=[],u=[];e<=c;e++)f[e]=t[e][a],u[e]=m[e][a];for(i.push({x:f,y:u,bicubic:o}),e=a,f=[],u=[];e>=0;e--)f[a-e]=t[c][e],u[a-e]=m[c][e];for(i.push({x:f,y:u,bicubic:s}),e=c,f=[],u=[];e>=0;e--)f[c-e]=t[e][0],u[c-e]=m[e][0];return i.push({x:f,y:u,bicubic:o}),i}},{}],974:[function(h,N,H){var t=h("../../plots/cartesian/axes"),m=h("../../lib/extend").extendFlat;N.exports=function(g,p,e){var f,u,i,s,o,a,c,r,n,d,l,y,v,_,x=g["_"+p],T=g[p+"axis"],A=T._gridlines=[],S=T._minorgridlines=[],w=T._boundarylines=[],L=g["_"+e],k=g[e+"axis"];T.tickmode==="array"&&(T.tickvals=x.slice());var C=g._xctrl,M=g._yctrl,P=C[0].length,O=C.length,F=g._a.length,j=g._b.length;t.prepTicks(T),T.tickmode==="array"&&delete T.tickvals;var W=T.smoothing?3:1;function Z(X){var G,Y,K,D,B,q,ee,J,$,te,ie,ae,he=[],se=[],de={};if(p==="b")for(Y=g.b2j(X),K=Math.floor(Math.max(0,Math.min(j-2,Y))),D=Y-K,de.length=j,de.crossLength=F,de.xy=function(ce){return g.evalxy([],ce,Y)},de.dxy=function(ce,ve){return g.dxydi([],ce,K,ve,D)},G=0;G<F;G++)q=Math.min(F-2,G),ee=G-q,J=g.evalxy([],G,Y),k.smoothing&&G>0&&($=g.dxydi([],G-1,K,0,D),he.push(B[0]+$[0]/3),se.push(B[1]+$[1]/3),te=g.dxydi([],G-1,K,1,D),he.push(J[0]-te[0]/3),se.push(J[1]-te[1]/3)),he.push(J[0]),se.push(J[1]),B=J;else for(G=g.a2i(X),q=Math.floor(Math.max(0,Math.min(F-2,G))),ee=G-q,de.length=F,de.crossLength=j,de.xy=function(ce){return g.evalxy([],G,ce)},de.dxy=function(ce,ve){return g.dxydj([],q,ce,ee,ve)},Y=0;Y<j;Y++)K=Math.min(j-2,Y),D=Y-K,J=g.evalxy([],G,Y),k.smoothing&&Y>0&&(ie=g.dxydj([],q,Y-1,ee,0),he.push(B[0]+ie[0]/3),se.push(B[1]+ie[1]/3),ae=g.dxydj([],q,Y-1,ee,1),he.push(J[0]-ae[0]/3),se.push(J[1]-ae[1]/3)),he.push(J[0]),se.push(J[1]),B=J;return de.axisLetter=p,de.axis=T,de.crossAxis=k,de.value=X,de.constvar=e,de.index=r,de.x=he,de.y=se,de.smoothing=k.smoothing,de}function Q(X){var G,Y,K,D,B,q=[],ee=[],J={};if(J.length=x.length,J.crossLength=L.length,p==="b")for(K=Math.max(0,Math.min(j-2,X)),B=Math.min(1,Math.max(0,X-K)),J.xy=function($){return g.evalxy([],$,X)},J.dxy=function($,te){return g.dxydi([],$,K,te,B)},G=0;G<P;G++)q[G]=C[X*W][G],ee[G]=M[X*W][G];else for(Y=Math.max(0,Math.min(F-2,X)),D=Math.min(1,Math.max(0,X-Y)),J.xy=function($){return g.evalxy([],X,$)},J.dxy=function($,te){return g.dxydj([],Y,$,D,te)},G=0;G<O;G++)q[G]=C[G][X*W],ee[G]=M[G][X*W];return J.axisLetter=p,J.axis=T,J.crossAxis=k,J.value=x[X],J.constvar=e,J.index=X,J.x=q,J.y=ee,J.smoothing=k.smoothing,J}if(T.tickmode==="array"){for(s=5e-15,a=(o=[Math.floor((x.length-1-T.arraytick0)/T.arraydtick*(1+s)),Math.ceil(-T.arraytick0/T.arraydtick/(1+s))].sort(function(X,G){return X-G}))[0]-1,c=o[1]+1,r=a;r<c;r++)(u=T.arraytick0+T.arraydtick*r)<0||u>x.length-1||A.push(m(Q(u),{color:T.gridcolor,width:T.gridwidth}));for(r=a;r<c;r++)if(i=T.arraytick0+T.arraydtick*r,l=Math.min(i+T.arraydtick,x.length-1),!(i<0||i>x.length-1||l<0||l>x.length-1))for(y=x[i],v=x[l],f=0;f<T.minorgridcount;f++)(_=l-i)<=0||(d=y+(v-y)*(f+1)/(T.minorgridcount+1)*(T.arraydtick/_))<x[0]||d>x[x.length-1]||S.push(m(Z(d),{color:T.minorgridcolor,width:T.minorgridwidth}));T.startline&&w.push(m(Q(0),{color:T.startlinecolor,width:T.startlinewidth})),T.endline&&w.push(m(Q(x.length-1),{color:T.endlinecolor,width:T.endlinewidth}))}else{for(s=5e-15,a=(o=[Math.floor((x[x.length-1]-T.tick0)/T.dtick*(1+s)),Math.ceil((x[0]-T.tick0)/T.dtick/(1+s))].sort(function(X,G){return X-G}))[0],c=o[1],r=a;r<=c;r++)n=T.tick0+T.dtick*r,A.push(m(Z(n),{color:T.gridcolor,width:T.gridwidth}));for(r=a-1;r<c+1;r++)for(n=T.tick0+T.dtick*r,f=0;f<T.minorgridcount;f++)(d=n+T.dtick*(f+1)/(T.minorgridcount+1))<x[0]||d>x[x.length-1]||S.push(m(Z(d),{color:T.minorgridcolor,width:T.minorgridwidth}));T.startline&&w.push(m(Z(x[0]),{color:T.startlinecolor,width:T.startlinewidth})),T.endline&&w.push(m(Z(x[x.length-1]),{color:T.endlinecolor,width:T.endlinewidth}))}}},{"../../lib/extend":777,"../../plots/cartesian/axes":838}],975:[function(h,N,H){var t=h("../../plots/cartesian/axes"),m=h("../../lib/extend").extendFlat;N.exports=function(g,p){var e,f,u,i=p._labels=[],s=p._gridlines;for(e=0;e<s.length;e++)u=s[e],["start","both"].indexOf(p.showticklabels)!==-1&&(f=t.tickText(p,u.value),m(f,{prefix:void 0,suffix:void 0,endAnchor:!0,xy:u.xy(0),dxy:u.dxy(0,0),axis:u.axis,length:u.crossAxis.length,font:u.axis.tickfont,isFirst:e===0,isLast:e===s.length-1}),i.push(f)),["end","both"].indexOf(p.showticklabels)!==-1&&(f=t.tickText(p,u.value),m(f,{endAnchor:!1,xy:u.xy(u.crossLength-1),dxy:u.dxy(u.crossLength-2,1),axis:u.axis,length:u.crossAxis.length,font:u.axis.tickfont,isFirst:e===0,isLast:e===s.length-1}),i.push(f))}},{"../../lib/extend":777,"../../plots/cartesian/axes":838}],976:[function(h,N,H){N.exports=function(t,m,g,p){var e=t[0]-m[0],f=t[1]-m[1],u=g[0]-m[0],i=g[1]-m[1],s=Math.pow(e*e+f*f,.25),o=Math.pow(u*u+i*i,.25),a=(o*o*e-s*s*u)*p,c=(o*o*f-s*s*i)*p,r=o*(s+o)*3,n=s*(s+o)*3;return[[m[0]+(r&&a/r),m[1]+(r&&c/r)],[m[0]-(n&&a/n),m[1]-(n&&c/n)]]}},{}],977:[function(h,N,H){var t=h("../../lib").isArrayOrTypedArray;N.exports=function(m,g,p){var e,f,u,i,s,o,a=[],c=t(m)?m.length:m,r=t(g)?g.length:g,n=t(m)?m:null,d=t(g)?g:null;n&&(u=(n.length-1)/(n[n.length-1]-n[0])/(c-1)),d&&(i=(d.length-1)/(d[d.length-1]-d[0])/(r-1));var l=1/0,y=-1/0;for(f=0;f<r;f++)for(a[f]=[],s=d?(d[f]-d[0])*i:f/(r-1),e=0;e<c;e++)o=(n?(n[e]-n[0])*u:e/(c-1))-s*p,l=Math.min(o,l),y=Math.max(o,y),a[f][e]=o;var v=1/(y-l),_=-l*v;for(f=0;f<r;f++)for(e=0;e<c;e++)a[f][e]=v*a[f][e]+_;return a}},{"../../lib":787}],978:[function(h,N,H){var t=h("./catmull_rom"),m=h("../../lib").ensureArray;function g(p,e,f){var u=-.5*f[0]+1.5*e[0],i=-.5*f[1]+1.5*e[1];return[(2*u+p[0])/3,(2*i+p[1])/3]}N.exports=function(p,e,f,u,i,s){var o,a,c,r,n,d,l,y,v,_,x=f[0].length,T=f.length,A=i?3*x-2:x,S=s?3*T-2:T;for(p=m(p,S),e=m(e,S),c=0;c<S;c++)p[c]=m(p[c],A),e[c]=m(e[c],A);for(a=0,r=0;a<T;a++,r+=s?3:1)for(n=p[r],d=e[r],l=f[a],y=u[a],o=0,c=0;o<x;o++,c+=i?3:1)n[c]=l[o],d[c]=y[o];if(i)for(a=0,r=0;a<T;a++,r+=s?3:1){for(o=1,c=3;o<x-1;o++,c+=3)v=t([f[a][o-1],u[a][o-1]],[f[a][o],u[a][o]],[f[a][o+1],u[a][o+1]],i),p[r][c-1]=v[0][0],e[r][c-1]=v[0][1],p[r][c+1]=v[1][0],e[r][c+1]=v[1][1];_=g([p[r][0],e[r][0]],[p[r][2],e[r][2]],[p[r][3],e[r][3]]),p[r][1]=_[0],e[r][1]=_[1],_=g([p[r][A-1],e[r][A-1]],[p[r][A-3],e[r][A-3]],[p[r][A-4],e[r][A-4]]),p[r][A-2]=_[0],e[r][A-2]=_[1]}if(s)for(c=0;c<A;c++){for(r=3;r<S-3;r+=3)v=t([p[r-3][c],e[r-3][c]],[p[r][c],e[r][c]],[p[r+3][c],e[r+3][c]],s),p[r-1][c]=v[0][0],e[r-1][c]=v[0][1],p[r+1][c]=v[1][0],e[r+1][c]=v[1][1];_=g([p[0][c],e[0][c]],[p[2][c],e[2][c]],[p[3][c],e[3][c]]),p[1][c]=_[0],e[1][c]=_[1],_=g([p[S-1][c],e[S-1][c]],[p[S-3][c],e[S-3][c]],[p[S-4][c],e[S-4][c]]),p[S-2][c]=_[0],e[S-2][c]=_[1]}if(i&&s)for(r=1;r<S;r+=(r+1)%3==0?2:1){for(c=3;c<A-3;c+=3)v=t([p[r][c-3],e[r][c-3]],[p[r][c],e[r][c]],[p[r][c+3],e[r][c+3]],i),p[r][c-1]=.5*(p[r][c-1]+v[0][0]),e[r][c-1]=.5*(e[r][c-1]+v[0][1]),p[r][c+1]=.5*(p[r][c+1]+v[1][0]),e[r][c+1]=.5*(e[r][c+1]+v[1][1]);_=g([p[r][0],e[r][0]],[p[r][2],e[r][2]],[p[r][3],e[r][3]]),p[r][1]=.5*(p[r][1]+_[0]),e[r][1]=.5*(e[r][1]+_[1]),_=g([p[r][A-1],e[r][A-1]],[p[r][A-3],e[r][A-3]],[p[r][A-4],e[r][A-4]]),p[r][A-2]=.5*(p[r][A-2]+_[0]),e[r][A-2]=.5*(e[r][A-2]+_[1])}return[p,e]}},{"../../lib":787,"./catmull_rom":976}],979:[function(h,N,H){N.exports={RELATIVE_CULL_TOLERANCE:1e-6}},{}],980:[function(h,N,H){N.exports=function(t,m,g){return m&&g?function(p,e,f,u,i){var s,o,a,c,r,n;p||(p=[]),e*=3,f*=3;var d=u*u,l=1-u,y=l*l,v=l*u*2,_=-3*y,x=3*(y-v),T=3*(v-d),A=3*d,S=i*i,w=S*i,L=1-i,k=L*L,C=k*L;for(n=0;n<t.length;n++)s=_*(r=t[n])[f][e]+x*r[f][e+1]+T*r[f][e+2]+A*r[f][e+3],o=_*r[f+1][e]+x*r[f+1][e+1]+T*r[f+1][e+2]+A*r[f+1][e+3],a=_*r[f+2][e]+x*r[f+2][e+1]+T*r[f+2][e+2]+A*r[f+2][e+3],c=_*r[f+3][e]+x*r[f+3][e+1]+T*r[f+3][e+2]+A*r[f+3][e+3],p[n]=C*s+3*(k*i*o+L*S*a)+w*c;return p}:m?function(p,e,f,u,i){var s,o,a,c;p||(p=[]),e*=3;var r=u*u,n=1-u,d=n*n,l=n*u*2,y=-3*d,v=3*(d-l),_=3*(l-r),x=3*r,T=1-i;for(a=0;a<t.length;a++)s=y*(c=t[a])[f][e]+v*c[f][e+1]+_*c[f][e+2]+x*c[f][e+3],o=y*c[f+1][e]+v*c[f+1][e+1]+_*c[f+1][e+2]+x*c[f+1][e+3],p[a]=T*s+i*o;return p}:g?function(p,e,f,u,i){var s,o,a,c,r,n;p||(p=[]),f*=3;var d=i*i,l=d*i,y=1-i,v=y*y,_=v*y;for(r=0;r<t.length;r++)s=(n=t[r])[f][e+1]-n[f][e],o=n[f+1][e+1]-n[f+1][e],a=n[f+2][e+1]-n[f+2][e],c=n[f+3][e+1]-n[f+3][e],p[r]=_*s+3*(v*i*o+y*d*a)+l*c;return p}:function(p,e,f,u,i){var s,o,a,c;p||(p=[]);var r=1-i;for(a=0;a<t.length;a++)s=(c=t[a])[f][e+1]-c[f][e],o=c[f+1][e+1]-c[f+1][e],p[a]=r*s+i*o;return p}}},{}],981:[function(h,N,H){N.exports=function(t,m,g){return m&&g?function(p,e,f,u,i){var s,o,a,c,r,n;p||(p=[]),e*=3,f*=3;var d=u*u,l=d*u,y=1-u,v=y*y,_=v*y,x=i*i,T=1-i,A=T*T,S=T*i*2,w=-3*A,L=3*(A-S),k=3*(S-x),C=3*x;for(n=0;n<t.length;n++)s=w*(r=t[n])[f][e]+L*r[f+1][e]+k*r[f+2][e]+C*r[f+3][e],o=w*r[f][e+1]+L*r[f+1][e+1]+k*r[f+2][e+1]+C*r[f+3][e+1],a=w*r[f][e+2]+L*r[f+1][e+2]+k*r[f+2][e+2]+C*r[f+3][e+2],c=w*r[f][e+3]+L*r[f+1][e+3]+k*r[f+2][e+3]+C*r[f+3][e+3],p[n]=_*s+3*(v*u*o+y*d*a)+l*c;return p}:m?function(p,e,f,u,i){var s,o,a,c,r,n;p||(p=[]),e*=3;var d=i*i,l=d*i,y=1-i,v=y*y,_=v*y;for(r=0;r<t.length;r++)s=(n=t[r])[f+1][e]-n[f][e],o=n[f+1][e+1]-n[f][e+1],a=n[f+1][e+2]-n[f][e+2],c=n[f+1][e+3]-n[f][e+3],p[r]=_*s+3*(v*i*o+y*d*a)+l*c;return p}:g?function(p,e,f,u,i){var s,o,a,c;p||(p=[]),f*=3;var r=1-u,n=i*i,d=1-i,l=d*d,y=d*i*2,v=-3*l,_=3*(l-y),x=3*(y-n),T=3*n;for(a=0;a<t.length;a++)s=v*(c=t[a])[f][e]+_*c[f+1][e]+x*c[f+2][e]+T*c[f+3][e],o=v*c[f][e+1]+_*c[f+1][e+1]+x*c[f+2][e+1]+T*c[f+3][e+1],p[a]=r*s+u*o;return p}:function(p,e,f,u,i){var s,o,a,c;p||(p=[]);var r=1-u;for(a=0;a<t.length;a++)s=(c=t[a])[f+1][e]-c[f][e],o=c[f+1][e+1]-c[f][e+1],p[a]=r*s+u*o;return p}}},{}],982:[function(h,N,H){N.exports=function(t,m,g,p,e){var f=m-2,u=g-2;return p&&e?function(i,s,o){var a,c,r,n,d,l;i||(i=[]);var y=Math.max(0,Math.min(Math.floor(s),f)),v=Math.max(0,Math.min(Math.floor(o),u)),_=Math.max(0,Math.min(1,s-y)),x=Math.max(0,Math.min(1,o-v));y*=3,v*=3;var T=_*_,A=T*_,S=1-_,w=S*S,L=w*S,k=x*x,C=k*x,M=1-x,P=M*M,O=P*M;for(l=0;l<t.length;l++)a=L*(d=t[l])[v][y]+3*(w*_*d[v][y+1]+S*T*d[v][y+2])+A*d[v][y+3],c=L*d[v+1][y]+3*(w*_*d[v+1][y+1]+S*T*d[v+1][y+2])+A*d[v+1][y+3],r=L*d[v+2][y]+3*(w*_*d[v+2][y+1]+S*T*d[v+2][y+2])+A*d[v+2][y+3],n=L*d[v+3][y]+3*(w*_*d[v+3][y+1]+S*T*d[v+3][y+2])+A*d[v+3][y+3],i[l]=O*a+3*(P*x*c+M*k*r)+C*n;return i}:p?function(i,s,o){i||(i=[]);var a,c,r,n,d,l,y=Math.max(0,Math.min(Math.floor(s),f)),v=Math.max(0,Math.min(Math.floor(o),u)),_=Math.max(0,Math.min(1,s-y)),x=Math.max(0,Math.min(1,o-v));y*=3;var T=_*_,A=T*_,S=1-_,w=S*S,L=w*S,k=1-x;for(d=0;d<t.length;d++)a=k*(l=t[d])[v][y]+x*l[v+1][y],c=k*l[v][y+1]+x*l[v+1][y+1],r=k*l[v][y+2]+x*l[v+1][y+1],n=k*l[v][y+3]+x*l[v+1][y+1],i[d]=L*a+3*(w*_*c+S*T*r)+A*n;return i}:e?function(i,s,o){i||(i=[]);var a,c,r,n,d,l,y=Math.max(0,Math.min(Math.floor(s),f)),v=Math.max(0,Math.min(Math.floor(o),u)),_=Math.max(0,Math.min(1,s-y)),x=Math.max(0,Math.min(1,o-v));v*=3;var T=x*x,A=T*x,S=1-x,w=S*S,L=w*S,k=1-_;for(d=0;d<t.length;d++)a=k*(l=t[d])[v][y]+_*l[v][y+1],c=k*l[v+1][y]+_*l[v+1][y+1],r=k*l[v+2][y]+_*l[v+2][y+1],n=k*l[v+3][y]+_*l[v+3][y+1],i[d]=L*a+3*(w*x*c+S*T*r)+A*n;return i}:function(i,s,o){i||(i=[]);var a,c,r,n,d=Math.max(0,Math.min(Math.floor(s),f)),l=Math.max(0,Math.min(Math.floor(o),u)),y=Math.max(0,Math.min(1,s-d)),v=Math.max(0,Math.min(1,o-l)),_=1-v,x=1-y;for(r=0;r<t.length;r++)a=x*(n=t[r])[l][d]+y*n[l][d+1],c=x*n[l+1][d]+y*n[l+1][d+1],i[r]=_*a+v*c;return i}}},{}],983:[function(h,N,H){var t=h("../../lib"),m=h("./xy_defaults"),g=h("./ab_defaults"),p=h("./attributes"),e=h("../../components/color/attributes");N.exports=function(f,u,i,s){function o(c,r){return t.coerce(f,u,p,c,r)}u._clipPathId="clip"+u.uid+"carpet";var a=o("color",e.defaultLine);t.coerceFont(o,"font"),o("carpet"),g(f,u,s,o,a),u.a&&u.b?(u.a.length<3&&(u.aaxis.smoothing=0),u.b.length<3&&(u.baxis.smoothing=0),m(f,u,o)||(u.visible=!1),u._cheater&&o("cheaterslope")):u.visible=!1}},{"../../components/color/attributes":649,"../../lib":787,"./ab_defaults":966,"./attributes":968,"./xy_defaults":992}],984:[function(h,N,H){N.exports={attributes:h("./attributes"),supplyDefaults:h("./defaults"),plot:h("./plot"),calc:h("./calc"),animatable:!0,isContainer:!0,moduleType:"trace",name:"carpet",basePlotModule:h("../../plots/cartesian"),categories:["cartesian","svg","carpet","carpetAxis","notLegendIsolatable","noMultiCategory","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":852,"./attributes":968,"./calc":972,"./defaults":983,"./plot":989}],985:[function(h,N,H){N.exports=function(t,m){for(var g,p=t._fullData.length,e=0;e<p;e++){var f=t._fullData[e];if(f.index!==m.index&&f.type==="carpet"&&(g||(g=f),f.carpet===m.carpet))return f}return g}},{}],986:[function(h,N,H){N.exports=function(t,m,g){if(t.length===0)return"";var p,e=[],f=g?3:1;for(p=0;p<t.length;p+=f)e.push(t[p]+","+m[p]),g&&p<t.length-f&&(e.push("C"),e.push([t[p+1]+","+m[p+1],t[p+2]+","+m[p+2]+" "].join(" ")));return e.join(g?"":"L")}},{}],987:[function(h,N,H){var t=h("../../lib").isArrayOrTypedArray;N.exports=function(m,g,p){var e;for(t(m)?m.length>g.length&&(m=m.slice(0,g.length)):m=[],e=0;e<g.length;e++)m[e]=p(g[e]);return m}},{"../../lib":787}],988:[function(h,N,H){N.exports=function(t,m,g,p,e,f){var u=e[0]*t.dpdx(m),i=e[1]*t.dpdy(g),s=1,o=1;if(f){var a=Math.sqrt(e[0]*e[0]+e[1]*e[1]),c=Math.sqrt(f[0]*f[0]+f[1]*f[1]),r=(e[0]*f[0]+e[1]*f[1])/a/c;o=Math.max(0,r)}var n=180*Math.atan2(i,u)/Math.PI;return n<-90?(n+=180,s=-s):n>90&&(n-=180,s=-s),{angle:n,flip:s,p:t.c2p(p,m,g),offsetMultplier:o}}},{}],989:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../components/drawing"),g=h("./map_1d_array"),p=h("./makepath"),e=h("./orient_text"),f=h("../../lib/svg_text_utils"),u=h("../../lib"),i=u.strRotate,s=u.strTranslate,o=h("../../constants/alignment");function a(l,y,v,_,x,T){var A="const-"+x+"-lines",S=v.selectAll("."+A).data(T);S.enter().append("path").classed(A,!0).style("vector-effect","non-scaling-stroke"),S.each(function(w){var L=w,k=L.x,C=L.y,M=g([],k,l.c2p),P=g([],C,y.c2p),O="M"+p(M,P,L.smoothing);t.select(this).attr("d",O).style("stroke-width",L.width).style("stroke",L.color).style("fill","none")}),S.exit().remove()}function c(l,y,v,_,x,T,A,S){var w=T.selectAll("text."+S).data(A);w.enter().append("text").classed(S,!0);var L=0,k={};return w.each(function(C,M){var P;if(C.axis.tickangle==="auto")P=e(_,y,v,C.xy,C.dxy);else{var O=(C.axis.tickangle+180)*Math.PI/180;P=e(_,y,v,C.xy,[Math.cos(O),Math.sin(O)])}M||(k={angle:P.angle,flip:P.flip});var F=(C.endAnchor?-1:1)*P.flip,j=t.select(this).attr({"text-anchor":F>0?"start":"end","data-notex":1}).call(m.font,C.font).text(C.text).call(f.convertToTspans,l),W=m.bBox(this);j.attr("transform",s(P.p[0],P.p[1])+i(P.angle)+s(C.axis.labelpadding*F,.3*W.height)),L=Math.max(L,W.width+C.axis.labelpadding)}),w.exit().remove(),k.maxExtent=L,k}N.exports=function(l,y,v,_){var x=y.xaxis,T=y.yaxis,A=l._fullLayout._clips;u.makeTraceGroups(_,v,"trace").each(function(S){var w=t.select(this),L=S[0],k=L.trace,C=k.aaxis,M=k.baxis,P=u.ensureSingle(w,"g","minorlayer"),O=u.ensureSingle(w,"g","majorlayer"),F=u.ensureSingle(w,"g","boundarylayer"),j=u.ensureSingle(w,"g","labellayer");w.style("opacity",k.opacity),a(x,T,O,C,"a",C._gridlines),a(x,T,O,M,"b",M._gridlines),a(x,T,P,C,"a",C._minorgridlines),a(x,T,P,M,"b",M._minorgridlines),a(x,T,F,C,"a-boundary",C._boundarylines),a(x,T,F,M,"b-boundary",M._boundarylines);var W=c(l,x,T,k,L,j,C._labels,"a-label"),Z=c(l,x,T,k,L,j,M._labels,"b-label");(function(Q,X,G,Y,K,D,B,q){var ee,J,$,te,ie=u.aggNums(Math.min,null,G.a),ae=u.aggNums(Math.max,null,G.a),he=u.aggNums(Math.min,null,G.b),se=u.aggNums(Math.max,null,G.b);ee=.5*(ie+ae),J=he,$=G.ab2xy(ee,J,!0),te=G.dxyda_rough(ee,J),B.angle===void 0&&u.extendFlat(B,e(G,K,D,$,G.dxydb_rough(ee,J))),d(Q,X,G,Y,$,te,G.aaxis,K,D,B,"a-title"),ee=ie,J=.5*(he+se),$=G.ab2xy(ee,J,!0),te=G.dxydb_rough(ee,J),q.angle===void 0&&u.extendFlat(q,e(G,K,D,$,G.dxyda_rough(ee,J))),d(Q,X,G,Y,$,te,G.baxis,K,D,q,"b-title")})(l,j,k,L,x,T,W,Z),function(Q,X,G,Y,K){var D,B,q,ee,J=G.select("#"+Q._clipPathId);J.size()||(J=G.append("clipPath").classed("carpetclip",!0));var $=u.ensureSingle(J,"path","carpetboundary"),te=X.clipsegments,ie=[];for(ee=0;ee<te.length;ee++)D=te[ee],B=g([],D.x,Y.c2p),q=g([],D.y,K.c2p),ie.push(p(B,q,D.bicubic));var ae="M"+ie.join("L")+"Z";J.attr("id",Q._clipPathId),$.attr("d",ae)}(k,L,A,x,T)})};var r=o.LINE_SPACING,n=(1-o.MID_SHIFT)/r+1;function d(l,y,v,_,x,T,A,S,w,L,k){var C=[];A.title.text&&C.push(A.title.text);var M=y.selectAll("text."+k).data(C),P=L.maxExtent;M.enter().append("text").classed(k,!0),M.each(function(){var O=e(v,S,w,x,T);["start","both"].indexOf(A.showticklabels)===-1&&(P=0);var F=A.title.font.size;P+=F+A.title.offset;var j=(L.angle+(L.flip<0?180:0)-O.angle+450)%360,W=j>90&&j<270,Z=t.select(this);Z.text(A.title.text).call(f.convertToTspans,l),W&&(P=(-f.lineCount(Z)+n)*r*F-P),Z.attr("transform",s(O.p[0],O.p[1])+i(O.angle)+s(0,P)).attr("text-anchor","middle").call(m.font,A.title.font)}),M.exit().remove()}},{"../../components/drawing":672,"../../constants/alignment":755,"../../lib":787,"../../lib/svg_text_utils":813,"./makepath":986,"./map_1d_array":987,"./orient_text":988,"@plotly/d3":58}],990:[function(h,N,H){var t=h("./constants"),m=h("../../lib/search").findBin,g=h("./compute_control_points"),p=h("./create_spline_evaluator"),e=h("./create_i_derivative_evaluator"),f=h("./create_j_derivative_evaluator");N.exports=function(u){var i=u._a,s=u._b,o=i.length,a=s.length,c=u.aaxis,r=u.baxis,n=i[0],d=i[o-1],l=s[0],y=s[a-1],v=i[i.length-1]-i[0],_=s[s.length-1]-s[0],x=v*t.RELATIVE_CULL_TOLERANCE,T=_*t.RELATIVE_CULL_TOLERANCE;n-=x,d+=x,l-=T,y+=T,u.isVisible=function(A,S){return A>n&&A<d&&S>l&&S<y},u.isOccluded=function(A,S){return A<n||A>d||S<l||S>y},u.setScale=function(){var A=u._x,S=u._y,w=g(u._xctrl,u._yctrl,A,S,c.smoothing,r.smoothing);u._xctrl=w[0],u._yctrl=w[1],u.evalxy=p([u._xctrl,u._yctrl],o,a,c.smoothing,r.smoothing),u.dxydi=e([u._xctrl,u._yctrl],c.smoothing,r.smoothing),u.dxydj=f([u._xctrl,u._yctrl],c.smoothing,r.smoothing)},u.i2a=function(A){var S=Math.max(0,Math.floor(A[0]),o-2),w=A[0]-S;return(1-w)*i[S]+w*i[S+1]},u.j2b=function(A){var S=Math.max(0,Math.floor(A[1]),o-2),w=A[1]-S;return(1-w)*s[S]+w*s[S+1]},u.ij2ab=function(A){return[u.i2a(A[0]),u.j2b(A[1])]},u.a2i=function(A){var S=Math.max(0,Math.min(m(A,i),o-2)),w=i[S],L=i[S+1];return Math.max(0,Math.min(o-1,S+(A-w)/(L-w)))},u.b2j=function(A){var S=Math.max(0,Math.min(m(A,s),a-2)),w=s[S],L=s[S+1];return Math.max(0,Math.min(a-1,S+(A-w)/(L-w)))},u.ab2ij=function(A){return[u.a2i(A[0]),u.b2j(A[1])]},u.i2c=function(A,S){return u.evalxy([],A,S)},u.ab2xy=function(A,S,w){if(!w&&(A<i[0]||A>i[o-1]|S<s[0]||S>s[a-1]))return[!1,!1];var L=u.a2i(A),k=u.b2j(S),C=u.evalxy([],L,k);if(w){var M,P,O,F,j=0,W=0,Z=[];A<i[0]?(M=0,P=0,j=(A-i[0])/(i[1]-i[0])):A>i[o-1]?(M=o-2,P=1,j=(A-i[o-1])/(i[o-1]-i[o-2])):P=L-(M=Math.max(0,Math.min(o-2,Math.floor(L)))),S<s[0]?(O=0,F=0,W=(S-s[0])/(s[1]-s[0])):S>s[a-1]?(O=a-2,F=1,W=(S-s[a-1])/(s[a-1]-s[a-2])):F=k-(O=Math.max(0,Math.min(a-2,Math.floor(k)))),j&&(u.dxydi(Z,M,O,P,F),C[0]+=Z[0]*j,C[1]+=Z[1]*j),W&&(u.dxydj(Z,M,O,P,F),C[0]+=Z[0]*W,C[1]+=Z[1]*W)}return C},u.c2p=function(A,S,w){return[S.c2p(A[0]),w.c2p(A[1])]},u.p2x=function(A,S,w){return[S.p2c(A[0]),w.p2c(A[1])]},u.dadi=function(A){var S=Math.max(0,Math.min(i.length-2,A));return i[S+1]-i[S]},u.dbdj=function(A){var S=Math.max(0,Math.min(s.length-2,A));return s[S+1]-s[S]},u.dxyda=function(A,S,w,L){var k=u.dxydi(null,A,S,w,L),C=u.dadi(A,w);return[k[0]/C,k[1]/C]},u.dxydb=function(A,S,w,L){var k=u.dxydj(null,A,S,w,L),C=u.dbdj(S,L);return[k[0]/C,k[1]/C]},u.dxyda_rough=function(A,S,w){var L=v*(w||.1),k=u.ab2xy(A+L,S,!0),C=u.ab2xy(A-L,S,!0);return[.5*(k[0]-C[0])/L,.5*(k[1]-C[1])/L]},u.dxydb_rough=function(A,S,w){var L=_*(w||.1),k=u.ab2xy(A,S+L,!0),C=u.ab2xy(A,S-L,!0);return[.5*(k[0]-C[0])/L,.5*(k[1]-C[1])/L]},u.dpdx=function(A){return A._m},u.dpdy=function(A){return A._m}}},{"../../lib/search":807,"./compute_control_points":978,"./constants":979,"./create_i_derivative_evaluator":980,"./create_j_derivative_evaluator":981,"./create_spline_evaluator":982}],991:[function(h,N,H){var t=h("../../lib");N.exports=function(m,g,p){var e,f,u,i=[],s=[],o=m[0].length,a=m.length;function c(X,G){var Y,K=0,D=0;return X>0&&(Y=m[G][X-1])!==void 0&&(D++,K+=Y),X<o-1&&(Y=m[G][X+1])!==void 0&&(D++,K+=Y),G>0&&(Y=m[G-1][X])!==void 0&&(D++,K+=Y),G<a-1&&(Y=m[G+1][X])!==void 0&&(D++,K+=Y),K/Math.max(1,D)}var r,n,d,l,y,v,_,x,T,A,S,w=0;for(e=0;e<o;e++)for(f=0;f<a;f++)m[f][e]===void 0&&(i.push(e),s.push(f),m[f][e]=c(e,f)),w=Math.max(w,Math.abs(m[f][e]));if(!i.length)return m;var L=0,k=0,C=i.length;do{for(L=0,u=0;u<C;u++){e=i[u],f=s[u];var M,P,O,F,j,W,Z=0,Q=0;e===0?(O=g[j=Math.min(o-1,2)],F=g[1],M=m[f][j],Q+=(P=m[f][1])+(P-M)*(g[0]-F)/(F-O),Z++):e===o-1&&(O=g[j=Math.max(0,o-3)],F=g[o-2],M=m[f][j],Q+=(P=m[f][o-2])+(P-M)*(g[o-1]-F)/(F-O),Z++),(e===0||e===o-1)&&f>0&&f<a-1&&(r=p[f+1]-p[f],Q+=((n=p[f]-p[f-1])*m[f+1][e]+r*m[f-1][e])/(n+r),Z++),f===0?(O=p[W=Math.min(a-1,2)],F=p[1],M=m[W][e],Q+=(P=m[1][e])+(P-M)*(p[0]-F)/(F-O),Z++):f===a-1&&(O=p[W=Math.max(0,a-3)],F=p[a-2],M=m[W][e],Q+=(P=m[a-2][e])+(P-M)*(p[a-1]-F)/(F-O),Z++),(f===0||f===a-1)&&e>0&&e<o-1&&(r=g[e+1]-g[e],Q+=((n=g[e]-g[e-1])*m[f][e+1]+r*m[f][e-1])/(n+r),Z++),Z?Q/=Z:(d=g[e+1]-g[e],l=g[e]-g[e-1],x=(y=p[f+1]-p[f])*(v=p[f]-p[f-1])*(y+v),Q=((_=d*l*(d+l))*(v*m[f+1][e]+y*m[f-1][e])+x*(l*m[f][e+1]+d*m[f][e-1]))/(x*(l+d)+_*(v+y))),L+=(A=(T=Q-m[f][e])/w)*A,S=Z?0:.85,m[f][e]+=T*(1+S)}L=Math.sqrt(L)}while(k++<100&&L>1e-5);return t.log("Smoother converged to",L,"after",k,"iterations"),m}},{"../../lib":787}],992:[function(h,N,H){var t=h("../../lib").isArray1D;N.exports=function(m,g,p){var e=p("x"),f=e&&e.length,u=p("y"),i=u&&u.length;if(!f&&!i)return!1;if(g._cheater=!e,f&&!t(e)||i&&!t(u))g._length=null;else{var s=f?e.length:1/0;i&&(s=Math.min(s,u.length)),g.a&&g.a.length&&(s=Math.min(s,g.a.length)),g.b&&g.b.length&&(s=Math.min(s,g.b.length)),g._length=s}return!0}},{"../../lib":787}],993:[function(h,N,H){var t=h("../../plots/template_attributes").hovertemplateAttrs,m=h("../scattergeo/attributes"),g=h("../../components/colorscale/attributes"),p=h("../../plots/attributes"),e=h("../../components/color/attributes").defaultLine,f=h("../../lib/extend").extendFlat,u=m.marker.line;N.exports=f({locations:{valType:"data_array",editType:"calc"},locationmode:m.locationmode,z:{valType:"data_array",editType:"calc"},geojson:f({},m.geojson,{}),featureidkey:m.featureidkey,text:f({},m.text,{}),hovertext:f({},m.hovertext,{}),marker:{line:{color:f({},u.color,{dflt:e}),width:f({},u.width,{dflt:1}),editType:"calc"},opacity:{valType:"number",arrayOk:!0,min:0,max:1,dflt:1,editType:"style"},editType:"calc"},selected:{marker:{opacity:m.selected.marker.opacity,editType:"plot"},editType:"plot"},unselected:{marker:{opacity:m.unselected.marker.opacity,editType:"plot"},editType:"plot"},hoverinfo:f({},p.hoverinfo,{editType:"calc",flags:["location","z","text","name"]}),hovertemplate:t(),showlegend:f({},p.showlegend,{dflt:!1})},g("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/color/attributes":649,"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/template_attributes":910,"../scattergeo/attributes":1244}],994:[function(h,N,H){var t=h("fast-isnumeric"),m=h("../../constants/numerical").BADNUM,g=h("../../components/colorscale/calc"),p=h("../scatter/arrays_to_calcdata"),e=h("../scatter/calc_selection");function f(u){return u&&typeof u=="string"}N.exports=function(u,i){var s,o=i._length,a=new Array(o);s=i.geojson?function(l){return f(l)||t(l)}:f;for(var c=0;c<o;c++){var r=a[c]={},n=i.locations[c],d=i.z[c];s(n)&&t(d)?(r.loc=n,r.z=d):(r.loc=null,r.z=m),r.index=c}return p(a,i),g(u,i,{vals:i.z,containerStr:"",cLetter:"z"}),e(a,i),a}},{"../../components/colorscale/calc":658,"../../constants/numerical":763,"../scatter/arrays_to_calcdata":1201,"../scatter/calc_selection":1204,"fast-isnumeric":246}],995:[function(h,N,H){var t=h("../../lib"),m=h("../../components/colorscale/defaults"),g=h("./attributes");N.exports=function(p,e,f,u){function i(r,n){return t.coerce(p,e,g,r,n)}var s=i("locations"),o=i("z");if(s&&s.length&&t.isArrayOrTypedArray(o)&&o.length){e._length=Math.min(s.length,o.length);var a,c=i("geojson");(typeof c=="string"&&c!==""||t.isPlainObject(c))&&(a="geojson-id"),i("locationmode",a)==="geojson-id"&&i("featureidkey"),i("text"),i("hovertext"),i("hovertemplate"),i("marker.line.width")&&i("marker.line.color"),i("marker.opacity"),m(p,e,u,i,{prefix:"",cLetter:"z"}),t.coerceSelectionMarkerOpacity(e,i)}else e.visible=!1}},{"../../components/colorscale/defaults":660,"../../lib":787,"./attributes":993}],996:[function(h,N,H){N.exports=function(t,m,g,p,e){t.location=m.location,t.z=m.z;var f=p[e];return f.fIn&&f.fIn.properties&&(t.properties=f.fIn.properties),t.ct=f.ct,t}},{}],997:[function(h,N,H){var t=h("../../plots/cartesian/axes"),m=h("./attributes"),g=h("../../lib").fillText;N.exports=function(p,e,f){var u,i,s,o,a=p.cd,c=a[0].trace,r=p.subplot,n=[e,f],d=[e+360,f];for(i=0;i<a.length;i++)if(o=!1,(u=a[i])._polygons){for(s=0;s<u._polygons.length;s++)u._polygons[s].contains(n)&&(o=!o),u._polygons[s].contains(d)&&(o=!o);if(o)break}if(o&&u)return p.x0=p.x1=p.xa.c2p(u.ct),p.y0=p.y1=p.ya.c2p(u.ct),p.index=u.index,p.location=u.loc,p.z=u.z,p.zLabel=t.tickText(r.mockAxis,r.mockAxis.c2l(u.z),"hover").text,p.hovertemplate=u.hovertemplate,function(l,y,v){if(!y.hovertemplate){var _=v.hi||y.hoverinfo,x=String(v.loc),T=_==="all"?m.hoverinfo.flags:_.split("+"),A=T.indexOf("name")!==-1,S=T.indexOf("location")!==-1,w=T.indexOf("z")!==-1,L=T.indexOf("text")!==-1,k=[];!A&&S?l.nameOverride=x:(A&&(l.nameOverride=y.name),S&&k.push(x)),w&&k.push(l.zLabel),L&&g(v,y,k),l.extraText=k.join("<br>")}}(p,c,u),[p]}},{"../../lib":787,"../../plots/cartesian/axes":838,"./attributes":993}],998:[function(h,N,H){N.exports={attributes:h("./attributes"),supplyDefaults:h("./defaults"),colorbar:h("../heatmap/colorbar"),calc:h("./calc"),calcGeoJSON:h("./plot").calcGeoJSON,plot:h("./plot").plot,style:h("./style").style,styleOnSelect:h("./style").styleOnSelect,hoverPoints:h("./hover"),eventData:h("./event_data"),selectPoints:h("./select"),moduleType:"trace",name:"choropleth",basePlotModule:h("../../plots/geo"),categories:["geo","noOpacity","showLegend"],meta:{}}},{"../../plots/geo":871,"../heatmap/colorbar":1072,"./attributes":993,"./calc":994,"./defaults":995,"./event_data":996,"./hover":997,"./plot":999,"./select":1e3,"./style":1001}],999:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../lib"),g=h("../../lib/geo_location_utils"),p=h("../../lib/topojson_utils").getTopojsonFeatures,e=h("../../plots/cartesian/autorange").findExtremes,f=h("./style").style;N.exports={calcGeoJSON:function(u,i){for(var s=u[0].trace,o=i[s.geo],a=o._subplot,c=s.locationmode,r=s._length,n=c==="geojson-id"?g.extractTraceFeature(u):p(s,a.topojson),d=[],l=[],y=0;y<r;y++){var v=u[y],_=c==="geojson-id"?v.fOut:g.locationToFeature(c,v.loc,n);if(_){v.geojson=_,v.ct=_.properties.ct,v._polygons=g.feature2polygons(_);var x=g.computeBbox(_);d.push(x[0],x[2]),l.push(x[1],x[3])}else v.geojson=null}if(o.fitbounds==="geojson"&&c==="geojson-id"){var T=g.computeBbox(g.getTraceGeojson(s));d=[T[0],T[2]],l=[T[1],T[3]]}var A={padded:!0};s._extremes.lon=e(o.lonaxis._ax,d,A),s._extremes.lat=e(o.lataxis._ax,l,A)},plot:function(u,i,s){var o=i.layers.backplot.select(".choroplethlayer");m.makeTraceGroups(o,s,"trace choropleth").each(function(a){var c=t.select(this).selectAll("path.choroplethlocation").data(m.identity);c.enter().append("path").classed("choroplethlocation",!0),c.exit().remove(),f(u,a)})}}},{"../../lib":787,"../../lib/geo_location_utils":780,"../../lib/topojson_utils":816,"../../plots/cartesian/autorange":837,"./style":1001,"@plotly/d3":58}],1e3:[function(h,N,H){N.exports=function(t,m){var g,p,e,f,u,i=t.cd,s=t.xaxis,o=t.yaxis,a=[];if(m===!1)for(g=0;g<i.length;g++)i[g].selected=0;else for(g=0;g<i.length;g++)(e=(p=i[g]).ct)&&(f=s.c2p(e),u=o.c2p(e),m.contains([f,u],null,g,t)?(a.push({pointNumber:g,lon:e[0],lat:e[1]}),p.selected=1):p.selected=0);return a}},{}],1001:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../components/color"),g=h("../../components/drawing"),p=h("../../components/colorscale");function e(f,u){var i=u[0].trace,s=u[0].node3.selectAll(".choroplethlocation"),o=i.marker||{},a=o.line||{},c=p.makeColorScaleFuncFromTrace(i);s.each(function(r){t.select(this).attr("fill",c(r.z)).call(m.stroke,r.mlc||a.color).call(g.dashLine,"",r.mlw||a.width||0).style("opacity",o.opacity)}),g.selectedPointStyle(s,i,f)}N.exports={style:function(f,u){u&&e(f,u)},styleOnSelect:function(f,u){var i=u[0].node3,s=u[0].trace;s.selectedpoints?g.selectedPointStyle(i.selectAll(".choroplethlocation"),s,f):e(f,u)}}},{"../../components/color":650,"../../components/colorscale":662,"../../components/drawing":672,"@plotly/d3":58}],1002:[function(h,N,H){var t=h("../choropleth/attributes"),m=h("../../components/colorscale/attributes"),g=h("../../plots/template_attributes").hovertemplateAttrs,p=h("../../plots/attributes"),e=h("../../lib/extend").extendFlat;N.exports=e({locations:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},geojson:{valType:"any",editType:"calc"},featureidkey:e({},t.featureidkey,{}),below:{valType:"string",editType:"plot"},text:t.text,hovertext:t.hovertext,marker:{line:{color:e({},t.marker.line.color,{editType:"plot"}),width:e({},t.marker.line.width,{editType:"plot"}),editType:"calc"},opacity:e({},t.marker.opacity,{editType:"plot"}),editType:"calc"},selected:{marker:{opacity:e({},t.selected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},unselected:{marker:{opacity:e({},t.unselected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},hoverinfo:t.hoverinfo,hovertemplate:g({},{keys:["properties"]}),showlegend:e({},p.showlegend,{dflt:!1})},m("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/template_attributes":910,"../choropleth/attributes":993}],1003:[function(h,N,H){var t=h("fast-isnumeric"),m=h("../../lib"),g=h("../../components/colorscale"),p=h("../../components/drawing"),e=h("../../lib/geojson_utils").makeBlank,f=h("../../lib/geo_location_utils");function u(i){var s,o=i[0].trace,a=o._opts;if(o.selectedpoints){for(var c=p.makeSelectedPointStyleFns(o),r=0;r<i.length;r++){var n=i[r];n.fOut&&(n.fOut.properties.mo2=c.selectedOpacityFn(n))}s={type:"identity",property:"mo2"}}else s=m.isArrayOrTypedArray(o.marker.opacity)?{type:"identity",property:"mo"}:o.marker.opacity;return m.extendFlat(a.fill.paint,{"fill-opacity":s}),m.extendFlat(a.line.paint,{"line-opacity":s}),a}N.exports={convert:function(i){var s=i[0].trace,o=s.visible===!0&&s._length!==0,a={layout:{visibility:"none"},paint:{}},c={layout:{visibility:"none"},paint:{}},r=s._opts={fill:a,line:c,geojson:e()};if(!o)return r;var n=f.extractTraceFeature(i);if(!n)return r;var d,l,y,v=g.makeColorScaleFuncFromTrace(s),_=s.marker,x=_.line||{};m.isArrayOrTypedArray(_.opacity)&&(d=function(k){var C=k.mo;return t(C)?+m.constrain(C,0,1):0}),m.isArrayOrTypedArray(x.color)&&(l=function(k){return k.mlc}),m.isArrayOrTypedArray(x.width)&&(y=function(k){return k.mlw});for(var T=0;T<i.length;T++){var A=i[T],S=A.fOut;if(S){var w=S.properties;w.fc=v(A.z),d&&(w.mo=d(A)),l&&(w.mlc=l(A)),y&&(w.mlw=y(A)),A.ct=w.ct,A._polygons=f.feature2polygons(S)}}var L=d?{type:"identity",property:"mo"}:_.opacity;return m.extendFlat(a.paint,{"fill-color":{type:"identity",property:"fc"},"fill-opacity":L}),m.extendFlat(c.paint,{"line-color":l?{type:"identity",property:"mlc"}:x.color,"line-width":y?{type:"identity",property:"mlw"}:x.width,"line-opacity":L}),a.layout.visibility="visible",c.layout.visibility="visible",r.geojson={type:"FeatureCollection",features:n},u(i),r},convertOnSelect:u}},{"../../components/colorscale":662,"../../components/drawing":672,"../../lib":787,"../../lib/geo_location_utils":780,"../../lib/geojson_utils":781,"fast-isnumeric":246}],1004:[function(h,N,H){var t=h("../../lib"),m=h("../../components/colorscale/defaults"),g=h("./attributes");N.exports=function(p,e,f,u){function i(c,r){return t.coerce(p,e,g,c,r)}var s=i("locations"),o=i("z"),a=i("geojson");t.isArrayOrTypedArray(s)&&s.length&&t.isArrayOrTypedArray(o)&&o.length&&(typeof a=="string"&&a!==""||t.isPlainObject(a))?(i("featureidkey"),e._length=Math.min(s.length,o.length),i("below"),i("text"),i("hovertext"),i("hovertemplate"),i("marker.line.width")&&i("marker.line.color"),i("marker.opacity"),m(p,e,u,i,{prefix:"",cLetter:"z"}),t.coerceSelectionMarkerOpacity(e,i)):e.visible=!1}},{"../../components/colorscale/defaults":660,"../../lib":787,"./attributes":1002}],1005:[function(h,N,H){N.exports={attributes:h("./attributes"),supplyDefaults:h("./defaults"),colorbar:h("../heatmap/colorbar"),calc:h("../choropleth/calc"),plot:h("./plot"),hoverPoints:h("../choropleth/hover"),eventData:h("../choropleth/event_data"),selectPoints:h("../choropleth/select"),styleOnSelect:function(t,m){m&&m[0].trace._glTrace.updateOnSelect(m)},getBelow:function(t,m){for(var g=m.getMapLayers(),p=g.length-2;p>=0;p--){var e=g[p].id;if(typeof e=="string"&&e.indexOf("water")===0){for(var f=p+1;f<g.length;f++)if(typeof(e=g[f].id)=="string"&&e.indexOf("plotly-")===-1)return e}}},moduleType:"trace",name:"choroplethmapbox",basePlotModule:h("../../plots/mapbox"),categories:["mapbox","gl","noOpacity","showLegend"],meta:{hr_name:"choropleth_mapbox"}}},{"../../plots/mapbox":895,"../choropleth/calc":994,"../choropleth/event_data":996,"../choropleth/hover":997,"../choropleth/select":1e3,"../heatmap/colorbar":1072,"./attributes":1002,"./defaults":1004,"./plot":1006}],1006:[function(h,N,H){var t=h("./convert").convert,m=h("./convert").convertOnSelect,g=h("../../plots/mapbox/constants").traceLayerPrefix;function p(f,u){this.type="choroplethmapbox",this.subplot=f,this.uid=u,this.sourceId="source-"+u,this.layerList=[["fill",g+u+"-fill"],["line",g+u+"-line"]],this.below=null}var e=p.prototype;e.update=function(f){this._update(t(f))},e.updateOnSelect=function(f){this._update(m(f))},e._update=function(f){var u=this.subplot,i=this.layerList,s=u.belowLookup["trace-"+this.uid];u.map.getSource(this.sourceId).setData(f.geojson),s!==this.below&&(this._removeLayers(),this._addLayers(f,s),this.below=s);for(var o=0;o<i.length;o++){var a=i[o],c=a[0],r=a[1],n=f[c];u.setOptions(r,"setLayoutProperty",n.layout),n.layout.visibility==="visible"&&u.setOptions(r,"setPaintProperty",n.paint)}},e._addLayers=function(f,u){for(var i=this.subplot,s=this.layerList,o=this.sourceId,a=0;a<s.length;a++){var c=s[a],r=c[0],n=f[r];i.addLayer({type:r,id:c[1],source:o,layout:n.layout,paint:n.paint},u)}},e._removeLayers=function(){for(var f=this.subplot.map,u=this.layerList,i=u.length-1;i>=0;i--)f.removeLayer(u[i][1])},e.dispose=function(){var f=this.subplot.map;this._removeLayers(),f.removeSource(this.sourceId)},N.exports=function(f,u){var i=u[0].trace,s=new p(f,i.uid),o=s.sourceId,a=t(u),c=s.below=f.belowLookup["trace-"+i.uid];return f.map.addSource(o,{type:"geojson",data:a.geojson}),s._addLayers(a,c),u[0].trace._glTrace=s,s}},{"../../plots/mapbox/constants":893,"./convert":1003}],1007:[function(h,N,H){var t=h("../../components/colorscale/attributes"),m=h("../../plots/cartesian/axis_format_attributes").axisHoverFormat,g=h("../../plots/template_attributes").hovertemplateAttrs,p=h("../mesh3d/attributes"),e=h("../../plots/attributes"),f=h("../../lib/extend").extendFlat,u={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},sizemode:{valType:"enumerated",values:["scaled","absolute"],editType:"calc",dflt:"scaled"},sizeref:{valType:"number",editType:"calc",min:0},anchor:{valType:"enumerated",editType:"calc",values:["tip","tail","cm","center"],dflt:"cm"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:g({editType:"calc"},{keys:["norm"]}),uhoverformat:m("u",1),vhoverformat:m("v",1),whoverformat:m("w",1),xhoverformat:m("x"),yhoverformat:m("y"),zhoverformat:m("z"),showlegend:f({},e.showlegend,{dflt:!1})};f(u,t("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"})),["opacity","lightposition","lighting"].forEach(function(i){u[i]=p[i]}),u.hoverinfo=f({},e.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","text","name"],dflt:"x+y+z+norm+text+name"}),u.transforms=void 0,N.exports=u},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../mesh3d/attributes":1143}],1008:[function(h,N,H){var t=h("../../components/colorscale/calc");N.exports=function(m,g){for(var p=g.u,e=g.v,f=g.w,u=Math.min(g.x.length,g.y.length,g.z.length,p.length,e.length,f.length),i=-1/0,s=1/0,o=0;o<u;o++){var a=p[o],c=e[o],r=f[o],n=Math.sqrt(a*a+c*c+r*r);i=Math.max(i,n),s=Math.min(s,n)}g._len=u,g._normMax=i,t(m,g,{vals:[s,i],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":658}],1009:[function(h,N,H){var t=h("gl-cone3d"),m=h("gl-cone3d").createConeMesh,g=h("../../lib").simpleMap,p=h("../../lib/gl_format_color").parseColorScale,e=h("../../components/colorscale").extractOpts,f=h("../../plots/gl3d/zip3");function u(r,n){this.scene=r,this.uid=n,this.mesh=null,this.data=null}var i=u.prototype;i.handlePick=function(r){if(r.object===this.mesh){var n=r.index=r.data.index,d=this.data.x[n],l=this.data.y[n],y=this.data.z[n],v=this.data.u[n],_=this.data.v[n],x=this.data.w[n];r.traceCoordinate=[d,l,y,v,_,x,Math.sqrt(v*v+_*_+x*x)];var T=this.data.hovertext||this.data.text;return Array.isArray(T)&&T[n]!==void 0?r.textLabel=T[n]:T&&(r.textLabel=T),!0}};var s={xaxis:0,yaxis:1,zaxis:2},o={tip:1,tail:0,cm:.25,center:.5},a={tip:1,tail:1,cm:.75,center:.5};function c(r,n){var d=r.fullSceneLayout,l=r.dataScale,y={};function v(A,S){var w=d[S],L=l[s[S]];return g(A,function(k){return w.d2l(k)*L})}y.vectors=f(v(n.u,"xaxis"),v(n.v,"yaxis"),v(n.w,"zaxis"),n._len),y.positions=f(v(n.x,"xaxis"),v(n.y,"yaxis"),v(n.z,"zaxis"),n._len);var _=e(n);y.colormap=p(n),y.vertexIntensityBounds=[_.min/n._normMax,_.max/n._normMax],y.coneOffset=o[n.anchor],n.sizemode==="scaled"?y.coneSize=n.sizeref||.5:y.coneSize=n.sizeref&&n._normMax?n.sizeref/n._normMax:.5;var x=t(y),T=n.lightposition;return x.lightPosition=[T.x,T.y,T.z],x.ambient=n.lighting.ambient,x.diffuse=n.lighting.diffuse,x.specular=n.lighting.specular,x.roughness=n.lighting.roughness,x.fresnel=n.lighting.fresnel,x.opacity=n.opacity,n._pad=a[n.anchor]*x.vectorScale*x.coneScale*n._normMax,x}i.update=function(r){this.data=r;var n=c(this.scene,r);this.mesh.update(n)},i.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},N.exports=function(r,n){var d=r.glplot.gl,l=c(r,n),y=m(d,l),v=new u(r,n.uid);return v.mesh=y,v.data=n,y._trace=v,r.glplot.add(y),v}},{"../../components/colorscale":662,"../../lib":787,"../../lib/gl_format_color":783,"../../plots/gl3d/zip3":891,"gl-cone3d":262}],1010:[function(h,N,H){var t=h("../../lib"),m=h("../../components/colorscale/defaults"),g=h("./attributes");N.exports=function(p,e,f,u){function i(d,l){return t.coerce(p,e,g,d,l)}var s=i("u"),o=i("v"),a=i("w"),c=i("x"),r=i("y"),n=i("z");s&&s.length&&o&&o.length&&a&&a.length&&c&&c.length&&r&&r.length&&n&&n.length?(i("sizeref"),i("sizemode"),i("anchor"),i("lighting.ambient"),i("lighting.diffuse"),i("lighting.specular"),i("lighting.roughness"),i("lighting.fresnel"),i("lightposition.x"),i("lightposition.y"),i("lightposition.z"),m(p,e,u,i,{prefix:"",cLetter:"c"}),i("text"),i("hovertext"),i("hovertemplate"),i("uhoverformat"),i("vhoverformat"),i("whoverformat"),i("xhoverformat"),i("yhoverformat"),i("zhoverformat"),e._length=null):e.visible=!1}},{"../../components/colorscale/defaults":660,"../../lib":787,"./attributes":1007}],1011:[function(h,N,H){N.exports={moduleType:"trace",name:"cone",basePlotModule:h("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:h("./attributes"),supplyDefaults:h("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:h("./calc"),plot:h("./convert"),eventData:function(t,m){return t.norm=m.traceCoordinate[6],t},meta:{}}},{"../../plots/gl3d":880,"./attributes":1007,"./calc":1008,"./convert":1009,"./defaults":1010}],1012:[function(h,N,H){var t=h("../heatmap/attributes"),m=h("../scatter/attributes"),g=h("../../plots/cartesian/axis_format_attributes"),p=g.axisHoverFormat,e=g.descriptionOnlyNumbers,f=h("../../components/colorscale/attributes"),u=h("../../components/drawing/attributes").dash,i=h("../../plots/font_attributes"),s=h("../../lib/extend").extendFlat,o=h("../../constants/filter_ops"),a=o.COMPARISON_OPS2,c=o.INTERVAL_OPS,r=m.line;N.exports=s({z:t.z,x:t.x,x0:t.x0,dx:t.dx,y:t.y,y0:t.y0,dy:t.dy,xperiod:t.xperiod,yperiod:t.yperiod,xperiod0:m.xperiod0,yperiod0:m.yperiod0,xperiodalignment:t.xperiodalignment,yperiodalignment:t.yperiodalignment,text:t.text,hovertext:t.hovertext,transpose:t.transpose,xtype:t.xtype,ytype:t.ytype,xhoverformat:p("x"),yhoverformat:p("y"),zhoverformat:p("z",1),hovertemplate:t.hovertemplate,hoverongaps:t.hoverongaps,connectgaps:s({},t.connectgaps,{}),fillcolor:{valType:"color",editType:"calc"},autocontour:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"contours.start":void 0,"contours.end":void 0,"contours.size":void 0}},ncontours:{valType:"integer",dflt:15,min:1,editType:"calc"},contours:{type:{valType:"enumerated",values:["levels","constraint"],dflt:"levels",editType:"calc"},start:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},end:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},size:{valType:"number",dflt:null,min:0,editType:"plot",impliedEdits:{"^autocontour":!1}},coloring:{valType:"enumerated",values:["fill","heatmap","lines","none"],dflt:"fill",editType:"calc"},showlines:{valType:"boolean",dflt:!0,editType:"plot"},showlabels:{valType:"boolean",dflt:!1,editType:"plot"},labelfont:i({editType:"plot",colorEditType:"style"}),labelformat:{valType:"string",dflt:"",editType:"plot",description:e("contour label")},operation:{valType:"enumerated",values:[].concat(a).concat(c),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},editType:"calc",impliedEdits:{autocontour:!1}},line:{color:s({},r.color,{editType:"style+colorbars"}),width:{valType:"number",min:0,editType:"style+colorbars"},dash:u,smoothing:s({},r.smoothing,{}),editType:"plot"}},f("",{cLetter:"z",autoColorDflt:!1,editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":657,"../../components/drawing/attributes":671,"../../constants/filter_ops":759,"../../lib/extend":777,"../../plots/cartesian/axis_format_attributes":841,"../../plots/font_attributes":867,"../heatmap/attributes":1069,"../scatter/attributes":1202}],1013:[function(h,N,H){var t=h("../../components/colorscale"),m=h("../heatmap/calc"),g=h("./set_contours"),p=h("./end_plus");N.exports=function(e,f){var u=m(e,f),i=u[0].z;g(f,i);var s,o=f.contours,a=t.extractOpts(f);if(o.coloring==="heatmap"&&a.auto&&f.autocontour===!1){var c=o.start,r=p(o),n=o.size||1,d=Math.floor((r-c)/n)+1;isFinite(n)||(n=1,d=1);var l=c-n/2;s=[l,l+d*n]}else s=i;return t.calc(e,f,{vals:s,cLetter:"z"}),u}},{"../../components/colorscale":662,"../heatmap/calc":1070,"./end_plus":1023,"./set_contours":1031}],1014:[function(h,N,H){N.exports=function(t,m){var g,p=t[0],e=p.z;switch(m.type){case"levels":var f=Math.min(e[0][0],e[0][1]);for(g=0;g<t.length;g++){var u=t[g];u.prefixBoundary=!u.edgepaths.length&&(f>u.level||u.starts.length&&f===u.level)}break;case"constraint":if(p.prefixBoundary=!1,p.edgepaths.length)return;var i=p.x.length,s=p.y.length,o=-1/0,a=1/0;for(g=0;g<s;g++)a=Math.min(a,e[g][0]),a=Math.min(a,e[g][i-1]),o=Math.max(o,e[g][0]),o=Math.max(o,e[g][i-1]);for(g=1;g<i-1;g++)a=Math.min(a,e[0][g]),a=Math.min(a,e[s-1][g]),o=Math.max(o,e[0][g]),o=Math.max(o,e[s-1][g]);var c,r,n=m.value;switch(m._operation){case">":n>o&&(p.prefixBoundary=!0);break;case"<":(n<a||p.starts.length&&n===a)&&(p.prefixBoundary=!0);break;case"[]":c=Math.min(n[0],n[1]),((r=Math.max(n[0],n[1]))<a||c>o||p.starts.length&&r===a)&&(p.prefixBoundary=!0);break;case"][":c=Math.min(n[0],n[1]),r=Math.max(n[0],n[1]),c<a&&r>o&&(p.prefixBoundary=!0)}}}},{}],1015:[function(h,N,H){var t=h("../../components/colorscale"),m=h("./make_color_map"),g=h("./end_plus");N.exports={min:"zmin",max:"zmax",calc:function(p,e,f){var u=e.contours,i=e.line,s=u.size||1,o=u.coloring,a=m(e,{isColorbar:!0});if(o==="heatmap"){var c=t.extractOpts(e);f._fillgradient=c.reversescale?t.flipScale(c.colorscale):c.colorscale,f._zrange=[c.min,c.max]}else o==="fill"&&(f._fillcolor=a);f._line={color:o==="lines"?a:i.color,width:u.showlines!==!1?i.width:0,dash:i.dash},f._levels={start:u.start,end:g(u),size:s}}}},{"../../components/colorscale":662,"./end_plus":1023,"./make_color_map":1028}],1016:[function(h,N,H){N.exports={BOTTOMSTART:[1,9,13,104,713],TOPSTART:[4,6,7,104,713],LEFTSTART:[8,12,14,208,1114],RIGHTSTART:[2,3,11,208,1114],NEWDELTA:[null,[-1,0],[0,-1],[-1,0],[1,0],null,[0,-1],[-1,0],[0,1],[0,1],null,[0,1],[1,0],[1,0],[0,-1]],CHOOSESADDLE:{104:[4,1],208:[2,8],713:[7,13],1114:[11,14]},SADDLEREMAINDER:{1:4,2:8,4:1,7:13,8:2,11:14,13:7,14:11},LABELDISTANCE:2,LABELINCREASE:10,LABELMIN:3,LABELMAX:10,LABELOPTIMIZER:{EDGECOST:1,ANGLECOST:1,NEIGHBORCOST:5,SAMELEVELFACTOR:10,SAMELEVELDISTANCE:5,MAXCOST:100,INITIALSEARCHPOINTS:10,ITERATIONS:5}}},{}],1017:[function(h,N,H){var t=h("fast-isnumeric"),m=h("./label_defaults"),g=h("../../components/color"),p=g.addOpacity,e=g.opacity,f=h("../../constants/filter_ops"),u=f.CONSTRAINT_REDUCTION,i=f.COMPARISON_OPS2;N.exports=function(s,o,a,c,r,n){var d,l,y,v=o.contours,_=a("contours.operation");v._operation=u[_],function(x,T){var A;i.indexOf(T.operation)===-1?(x("contours.value",[0,1]),Array.isArray(T.value)?T.value.length>2?T.value=T.value.slice(2):T.length===0?T.value=[0,1]:T.length<2?(A=parseFloat(T.value[0]),T.value=[A,A+1]):T.value=[parseFloat(T.value[0]),parseFloat(T.value[1])]:t(T.value)&&(A=parseFloat(T.value),T.value=[A,A+1])):(x("contours.value",0),t(T.value)||(Array.isArray(T.value)?T.value=parseFloat(T.value[0]):T.value=0))}(a,v),_==="="?d=v.showlines=!0:(d=a("contours.showlines"),y=a("fillcolor",p((s.line||{}).color||r,.5))),d&&(l=a("line.color",y&&e(y)?p(o.fillcolor,1):r),a("line.width",2),a("line.dash")),a("line.smoothing"),m(a,c,l,n)}},{"../../components/color":650,"../../constants/filter_ops":759,"./label_defaults":1027,"fast-isnumeric":246}],1018:[function(h,N,H){var t=h("../../constants/filter_ops"),m=h("fast-isnumeric");function g(f,u){var i,s=Array.isArray(u);function o(a){return m(a)?+a:null}return t.COMPARISON_OPS2.indexOf(f)!==-1?i=o(s?u[0]:u):t.INTERVAL_OPS.indexOf(f)!==-1?i=s?[o(u[0]),o(u[1])]:[o(u),o(u)]:t.SET_OPS.indexOf(f)!==-1&&(i=s?u.map(o):[o(u)]),i}function p(f){return function(u){u=g(f,u);var i=Math.min(u[0],u[1]),s=Math.max(u[0],u[1]);return{start:i,end:s,size:s-i}}}function e(f){return function(u){return{start:u=g(f,u),end:1/0,size:1/0}}}N.exports={"[]":p("[]"),"][":p("]["),">":e(">"),"<":e("<"),"=":e("=")}},{"../../constants/filter_ops":759,"fast-isnumeric":246}],1019:[function(h,N,H){N.exports=function(t,m,g,p){var e=p("contours.start"),f=p("contours.end"),u=e===!1||f===!1,i=g("contours.size");!(u?m.autocontour=!0:g("autocontour",!1))&&i||g("ncontours")}},{}],1020:[function(h,N,H){var t=h("../../lib");function m(g){return t.extendFlat({},g,{edgepaths:t.extendDeep([],g.edgepaths),paths:t.extendDeep([],g.paths),starts:t.extendDeep([],g.starts)})}N.exports=function(g,p){var e,f,u,i=function(a){return a.reverse()},s=function(a){return a};switch(p){case"=":case"<":return g;case">":for(g.length!==1&&t.warn("Contour data invalid for the specified inequality operation."),f=g[0],e=0;e<f.edgepaths.length;e++)f.edgepaths[e]=i(f.edgepaths[e]);for(e=0;e<f.paths.length;e++)f.paths[e]=i(f.paths[e]);for(e=0;e<f.starts.length;e++)f.starts[e]=i(f.starts[e]);return g;case"][":var o=i;i=s,s=o;case"[]":for(g.length!==2&&t.warn("Contour data invalid for the specified inequality range operation."),f=m(g[0]),u=m(g[1]),e=0;e<f.edgepaths.length;e++)f.edgepaths[e]=i(f.edgepaths[e]);for(e=0;e<f.paths.length;e++)f.paths[e]=i(f.paths[e]);for(e=0;e<f.starts.length;e++)f.starts[e]=i(f.starts[e]);for(;u.edgepaths.length;)f.edgepaths.push(s(u.edgepaths.shift()));for(;u.paths.length;)f.paths.push(s(u.paths.shift()));for(;u.starts.length;)f.starts.push(s(u.starts.shift()));return[f]}}},{"../../lib":787}],1021:[function(h,N,H){var t=h("../../lib"),m=h("../heatmap/xyz_defaults"),g=h("../scatter/period_defaults"),p=h("./constraint_defaults"),e=h("./contours_defaults"),f=h("./style_defaults"),u=h("./attributes");N.exports=function(i,s,o,a){function c(n,d){return t.coerce(i,s,u,n,d)}if(m(i,s,c,a)){g(i,s,a,c),c("xhoverformat"),c("yhoverformat"),c("text"),c("hovertext"),c("hovertemplate"),c("hoverongaps");var r=c("contours.type")==="constraint";c("connectgaps",t.isArray1D(s.z)),r?p(i,s,c,a,o):(e(i,s,c,function(n){return t.coerce2(i,s,u,n)}),f(i,s,c,a))}else s.visible=!1}},{"../../lib":787,"../heatmap/xyz_defaults":1083,"../scatter/period_defaults":1222,"./attributes":1012,"./constraint_defaults":1017,"./contours_defaults":1019,"./style_defaults":1033}],1022:[function(h,N,H){var t=h("../../lib"),m=h("./constraint_mapping"),g=h("./end_plus");N.exports=function(p,e,f){for(var u=p.type==="constraint"?m[p._operation](p.value):p,i=u.size,s=[],o=g(u),a=f.trace._carpetTrace,c=a?{xaxis:a.aaxis,yaxis:a.baxis,x:f.a,y:f.b}:{xaxis:e.xaxis,yaxis:e.yaxis,x:f.x,y:f.y},r=u.start;r<o;r+=i)if(s.push(t.extendFlat({level:r,crossings:{},starts:[],edgepaths:[],paths:[],z:f.z,smoothing:f.trace.line.smoothing},c)),s.length>1e3){t.warn("Too many contours, clipping at 1000",p);break}return s}},{"../../lib":787,"./constraint_mapping":1018,"./end_plus":1023}],1023:[function(h,N,H){N.exports=function(t){return t.end+t.size/1e6}},{}],1024:[function(h,N,H){var t=h("../../lib"),m=h("./constants");function g(f,u,i,s){return Math.abs(f[0]-u[0])<i&&Math.abs(f[1]-u[1])<s}function p(f,u,i,s,o){var a,c=u.join(","),r=f.crossings[c],n=function($,te,ie){var ae=0,he=0;return $>20&&te?$===208||$===1114?ae=ie[0]===0?1:-1:he=ie[1]===0?1:-1:m.BOTTOMSTART.indexOf($)!==-1?he=1:m.LEFTSTART.indexOf($)!==-1?ae=1:m.TOPSTART.indexOf($)!==-1?he=-1:ae=-1,[ae,he]}(r,i,u),d=[e(f,u,[-n[0],-n[1]])],l=f.z.length,y=f.z[0].length,v=u.slice(),_=n.slice();for(a=0;a<1e4;a++){if(r>20?(r=m.CHOOSESADDLE[r][(n[0]||n[1])<0?0:1],f.crossings[c]=m.SADDLEREMAINDER[r]):delete f.crossings[c],!(n=m.NEWDELTA[r])){t.log("Found bad marching index:",r,u,f.level);break}d.push(e(f,u,n)),u[0]+=n[0],u[1]+=n[1],c=u.join(","),g(d[d.length-1],d[d.length-2],s,o)&&d.pop();var x=n[0]&&(u[0]<0||u[0]>y-2)||n[1]&&(u[1]<0||u[1]>l-2);if(u[0]===v[0]&&u[1]===v[1]&&n[0]===_[0]&&n[1]===_[1]||i&&x)break;r=f.crossings[c]}a===1e4&&t.log("Infinite loop in contour?");var T,A,S,w,L,k,C,M,P,O,F,j,W,Z,Q,X=g(d[0],d[d.length-1],s,o),G=0,Y=.2*f.smoothing,K=[],D=0;for(a=1;a<d.length;a++)j=d[a],W=d[a-1],Z=void 0,Q=void 0,Z=j[2]-W[2],Q=j[3]-W[3],G+=C=Math.sqrt(Z*Z+Q*Q),K.push(C);var B=G/K.length*Y;function q($){return d[$%d.length]}for(a=d.length-2;a>=D;a--)if((T=K[a])<B){for(S=0,A=a-1;A>=D&&T+K[A]<B;A--)T+=K[A];if(X&&a===d.length-2)for(S=0;S<A&&T+K[S]<B;S++)T+=K[S];L=a-A+S+1,k=Math.floor((a+A+S+2)/2),w=X||a!==d.length-2?X||A!==-1?L%2?q(k):[(q(k)[0]+q(k+1)[0])/2,(q(k)[1]+q(k+1)[1])/2]:d[0]:d[d.length-1],d.splice(A+1,a-A+1,w),a=A+1,S&&(D=S),X&&(a===d.length-2?d[S]=d[d.length-1]:a===0&&(d[d.length-1]=d[0]))}for(d.splice(0,D),a=0;a<d.length;a++)d[a].length=2;if(!(d.length<2))if(X)d.pop(),f.paths.push(d);else{i||t.log("Unclosed interior contour?",f.level,v.join(","),d.join("L"));var ee=!1;for(M=0;M<f.edgepaths.length;M++)if(O=f.edgepaths[M],!ee&&g(O[0],d[d.length-1],s,o)){d.pop(),ee=!0;var J=!1;for(P=0;P<f.edgepaths.length;P++)if(g((F=f.edgepaths[P])[F.length-1],d[0],s,o)){J=!0,d.shift(),f.edgepaths.splice(M,1),P===M?f.paths.push(d.concat(F)):(P>M&&P--,f.edgepaths[P]=F.concat(d,O));break}J||(f.edgepaths[M]=d.concat(O))}for(M=0;M<f.edgepaths.length&&!ee;M++)g((O=f.edgepaths[M])[O.length-1],d[0],s,o)&&(d.shift(),f.edgepaths[M]=O.concat(d),ee=!0);ee||f.edgepaths.push(d)}}function e(f,u,i){var s=u[0]+Math.max(i[0],0),o=u[1]+Math.max(i[1],0),a=f.z[o][s],c=f.xaxis,r=f.yaxis;if(i[1]){var n=(f.level-a)/(f.z[o][s+1]-a);return[c.c2p((1-n)*f.x[s]+n*f.x[s+1],!0),r.c2p(f.y[o],!0),s+n,o]}var d=(f.level-a)/(f.z[o+1][s]-a);return[c.c2p(f.x[s],!0),r.c2p((1-d)*f.y[o]+d*f.y[o+1],!0),s,o+d]}N.exports=function(f,u,i){var s,o,a,c;for(u=u||.01,i=i||.01,o=0;o<f.length;o++){for(a=f[o],c=0;c<a.starts.length;c++)p(a,a.starts[c],"edge",u,i);for(s=0;Object.keys(a.crossings).length&&s<1e4;)s++,p(a,Object.keys(a.crossings)[0].split(",").map(Number),void 0,u,i);s===1e4&&t.log("Infinite loop in contour?")}}},{"../../lib":787,"./constants":1016}],1025:[function(h,N,H){var t=h("../../components/color"),m=h("../heatmap/hover");N.exports=function(g,p,e,f,u){u||(u={}),u.isContour=!0;var i=m(g,p,e,f,u);return i&&i.forEach(function(s){var o=s.trace;o.contours.type==="constraint"&&(o.fillcolor&&t.opacity(o.fillcolor)?s.color=t.addOpacity(o.fillcolor,1):o.contours.showlines&&t.opacity(o.line.color)&&(s.color=t.addOpacity(o.line.color,1)))}),i}},{"../../components/color":650,"../heatmap/hover":1076}],1026:[function(h,N,H){N.exports={attributes:h("./attributes"),supplyDefaults:h("./defaults"),calc:h("./calc"),plot:h("./plot").plot,style:h("./style"),colorbar:h("./colorbar"),hoverPoints:h("./hover"),moduleType:"trace",name:"contour",basePlotModule:h("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","showLegend"],meta:{}}},{"../../plots/cartesian":852,"./attributes":1012,"./calc":1013,"./colorbar":1015,"./defaults":1021,"./hover":1025,"./plot":1030,"./style":1032}],1027:[function(h,N,H){var t=h("../../lib");N.exports=function(m,g,p,e){if(e||(e={}),m("contours.showlabels")){var f=g.font;t.coerceFont(m,"contours.labelfont",{family:f.family,size:f.size,color:p}),m("contours.labelformat")}e.hasHover!==!1&&m("zhoverformat")}},{"../../lib":787}],1028:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../components/colorscale"),g=h("./end_plus");N.exports=function(p){var e=p.contours,f=e.start,u=g(e),i=e.size||1,s=Math.floor((u-f)/i)+1,o=e.coloring==="lines"?0:1,a=m.extractOpts(p);isFinite(i)||(i=1,s=1);var c,r,n=a.reversescale?m.flipScale(a.colorscale):a.colorscale,d=n.length,l=new Array(d),y=new Array(d);if(e.coloring==="heatmap"){var v=a.min,_=a.max;for(r=0;r<d;r++)c=n[r],l[r]=c[0]*(_-v)+v,y[r]=c[1];var x=t.extent([v,_,e.start,e.start+i*(s-1)]),T=x[v<_?0:1],A=x[v<_?1:0];T!==v&&(l.splice(0,0,T),y.splice(0,0,y[0])),A!==_&&(l.push(A),y.push(y[y.length-1]))}else for(r=0;r<d;r++)c=n[r],l[r]=(c[0]*(s+o-1)-o/2)*i+f,y[r]=c[1];return m.makeColorScaleFunc({domain:l,range:y},{noNumericCheck:!0})}},{"../../components/colorscale":662,"./end_plus":1023,"@plotly/d3":58}],1029:[function(h,N,H){var t=h("./constants");function m(g,p){var e=(p[0][0]>g?0:1)+(p[0][1]>g?0:2)+(p[1][1]>g?0:4)+(p[1][0]>g?0:8);return e===5||e===10?g>(p[0][0]+p[0][1]+p[1][0]+p[1][1])/4?e===5?713:1114:e===5?104:208:e===15?0:e}N.exports=function(g){var p,e,f,u,i,s,o,a,c,r=g[0].z,n=r.length,d=r[0].length,l=n===2||d===2;for(e=0;e<n-1;e++)for(u=[],e===0&&(u=u.concat(t.BOTTOMSTART)),e===n-2&&(u=u.concat(t.TOPSTART)),p=0;p<d-1;p++)for(f=u.slice(),p===0&&(f=f.concat(t.LEFTSTART)),p===d-2&&(f=f.concat(t.RIGHTSTART)),i=p+","+e,s=[[r[e][p],r[e][p+1]],[r[e+1][p],r[e+1][p+1]]],c=0;c<g.length;c++)(o=m((a=g[c]).level,s))&&(a.crossings[i]=o,f.indexOf(o)!==-1&&(a.starts.push([p,e]),l&&f.indexOf(o,f.indexOf(o)+1)!==-1&&a.starts.push([p,e])))}},{"./constants":1016}],1030:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../lib"),g=h("../../components/drawing"),p=h("../../components/colorscale"),e=h("../../lib/svg_text_utils"),f=h("../../plots/cartesian/axes"),u=h("../../plots/cartesian/set_convert"),i=h("../heatmap/plot"),s=h("./make_crossings"),o=h("./find_all_paths"),a=h("./empty_pathinfo"),c=h("./convert_to_constraints"),r=h("./close_boundaries"),n=h("./constants"),d=n.LABELOPTIMIZER;function l(_,x){var T,A,S,w,L,k,C,M="",P=0,O=_.edgepaths.map(function(X,G){return G}),F=!0;function j(X){return Math.abs(X[1]-x[2][1])<.01}function W(X){return Math.abs(X[0]-x[0][0])<.01}function Z(X){return Math.abs(X[0]-x[2][0])<.01}for(;O.length;){for(k=g.smoothopen(_.edgepaths[P],_.smoothing),M+=F?k:k.replace(/^M/,"L"),O.splice(O.indexOf(P),1),T=_.edgepaths[P][_.edgepaths[P].length-1],w=-1,S=0;S<4;S++){if(!T){m.log("Missing end?",P,_);break}for(C=T,Math.abs(C[1]-x[0][1])<.01&&!Z(T)?A=x[1]:W(T)?A=x[0]:j(T)?A=x[3]:Z(T)&&(A=x[2]),L=0;L<_.edgepaths.length;L++){var Q=_.edgepaths[L][0];Math.abs(T[0]-A[0])<.01?Math.abs(T[0]-Q[0])<.01&&(Q[1]-T[1])*(A[1]-Q[1])>=0&&(A=Q,w=L):Math.abs(T[1]-A[1])<.01?Math.abs(T[1]-Q[1])<.01&&(Q[0]-T[0])*(A[0]-Q[0])>=0&&(A=Q,w=L):m.log("endpt to newendpt is not vert. or horz.",T,A,Q)}if(T=A,w>=0)break;M+="L"+A}if(w===_.edgepaths.length){m.log("unclosed perimeter path");break}P=w,(F=O.indexOf(P)===-1)&&(P=O[0],M+="Z")}for(P=0;P<_.paths.length;P++)M+=g.smoothclosed(_.paths[P],_.smoothing);return M}function y(_,x,T,A){var S=x.width/2,w=x.height/2,L=_.x,k=_.y,C=_.theta,M=Math.cos(C)*S,P=Math.sin(C)*S,O=(L>A.center?A.right-L:L-A.left)/(M+Math.abs(Math.sin(C)*w)),F=(k>A.middle?A.bottom-k:k-A.top)/(Math.abs(P)+Math.cos(C)*w);if(O<1||F<1)return 1/0;var j=d.EDGECOST*(1/(O-1)+1/(F-1));j+=d.ANGLECOST*C*C;for(var W=L-M,Z=k-P,Q=L+M,X=k+P,G=0;G<T.length;G++){var Y=T[G],K=Math.cos(Y.theta)*Y.width/2,D=Math.sin(Y.theta)*Y.width/2,B=2*m.segmentDistance(W,Z,Q,X,Y.x-K,Y.y-D,Y.x+K,Y.y+D)/(x.height+Y.height),q=Y.level===x.level,ee=q?d.SAMELEVELDISTANCE:1;if(B<=ee)return 1/0;j+=d.NEIGHBORCOST*(q?d.SAMELEVELFACTOR:1)/(B-ee)}return j}function v(_){var x,T,A=_.trace._emptypoints,S=[],w=_.z.length,L=_.z[0].length,k=[];for(x=0;x<L;x++)k.push(1);for(x=0;x<w;x++)S.push(k.slice());for(x=0;x<A.length;x++)S[(T=A[x])[0]][T[1]]=0;return _.zmask=S,S}H.plot=function(_,x,T,A){var S=x.xaxis,w=x.yaxis;m.makeTraceGroups(A,T,"contour").each(function(L){var k=t.select(this),C=L[0],M=C.trace,P=C.x,O=C.y,F=M.contours,j=a(F,x,C),W=m.ensureSingle(k,"g","heatmapcoloring"),Z=[];F.coloring==="heatmap"&&(Z=[L]),i(_,x,Z,W),s(j),o(j);var Q=S.c2p(P[0],!0),X=S.c2p(P[P.length-1],!0),G=w.c2p(O[0],!0),Y=w.c2p(O[O.length-1],!0),K=[[Q,Y],[X,Y],[X,G],[Q,G]],D=j;F.type==="constraint"&&(D=c(j,F._operation)),function(B,q,ee){var J=m.ensureSingle(B,"g","contourbg").selectAll("path").data(ee.coloring==="fill"?[0]:[]);J.enter().append("path"),J.exit().remove(),J.attr("d","M"+q.join("L")+"Z").style("stroke","none")}(k,K,F),function(B,q,ee,J){var $=J.coloring==="fill"||J.type==="constraint"&&J._operation!=="=",te="M"+ee.join("L")+"Z";$&&r(q,J);var ie=m.ensureSingle(B,"g","contourfill").selectAll("path").data($?q:[]);ie.enter().append("path"),ie.exit().remove(),ie.each(function(ae){var he=(ae.prefixBoundary?te:"")+l(ae,ee);he?t.select(this).attr("d",he).style("stroke","none"):t.select(this).remove()})}(k,D,K,F),function(B,q,ee,J,$){var te=m.ensureSingle(B,"g","contourlines"),ie=$.showlines!==!1,ae=$.showlabels,he=ie&&ae,se=H.createLines(te,ie||ae,q),de=H.createLineClip(te,he,ee,J.trace.uid),ce=B.selectAll("g.contourlabels").data(ae?[0]:[]);if(ce.exit().remove(),ce.enter().append("g").classed("contourlabels",!0),ae){var ve=[],ke=[];m.clearLocationCache();var Ee=H.labelFormatter(ee,J),be=g.tester.append("text").attr("data-notex",1).call(g.font,$.labelfont),xe=q[0].xaxis,ue=q[0].yaxis,me=xe._length,we=ue._length,Me=xe.range,Se=ue.range,De=m.aggNums(Math.min,null,J.x),Fe=m.aggNums(Math.max,null,J.x),Ye=m.aggNums(Math.min,null,J.y),et=m.aggNums(Math.max,null,J.y),Oe=Math.max(xe.c2p(De,!0),0),je=Math.min(xe.c2p(Fe,!0),me),We=Math.max(ue.c2p(et,!0),0),Ge=Math.min(ue.c2p(Ye,!0),we),Qe={};Me[0]<Me[1]?(Qe.left=Oe,Qe.right=je):(Qe.left=je,Qe.right=Oe),Se[0]<Se[1]?(Qe.top=We,Qe.bottom=Ge):(Qe.top=Ge,Qe.bottom=We),Qe.middle=(Qe.top+Qe.bottom)/2,Qe.center=(Qe.left+Qe.right)/2,ve.push([[Qe.left,Qe.top],[Qe.right,Qe.top],[Qe.right,Qe.bottom],[Qe.left,Qe.bottom]]);var it=Math.sqrt(me*me+we*we),lt=n.LABELDISTANCE*it/Math.max(1,q.length/n.LABELINCREASE);se.each(function(Lt){var wt=H.calcTextOpts(Lt.level,Ee,be,ee);t.select(this).selectAll("path").each(function(){var rt=m.getVisibleSegment(this,Qe,wt.height/2);if(rt&&!(rt.len<(wt.width+wt.height)*n.LABELMIN))for(var $e=Math.min(Math.ceil(rt.len/lt),n.LABELMAX),xt=0;xt<$e;xt++){var Qt=H.findBestTextLocation(this,rt,wt,ke,Qe);if(!Qt)break;H.addLabelData(Qt,wt,ke,ve)}})}),be.remove(),H.drawLabels(ce,ke,ee,de,he?ve:null)}ae&&!ie&&se.remove()}(k,j,_,C,F),function(B,q,ee,J,$){var te=J.trace,ie=ee._fullLayout._clips,ae="clip"+te.uid,he=ie.selectAll("#"+ae).data(te.connectgaps?[]:[0]);if(he.enter().append("clipPath").classed("contourclip",!0).attr("id",ae),he.exit().remove(),te.connectgaps===!1){var se={level:.9,crossings:{},starts:[],edgepaths:[],paths:[],xaxis:q.xaxis,yaxis:q.yaxis,x:J.x,y:J.y,z:v(J),smoothing:0};s([se]),o([se]),r([se],{type:"levels"}),m.ensureSingle(he,"path","").attr("d",(se.prefixBoundary?"M"+$.join("L")+"Z":"")+l(se,$))}else ae=null;g.setClipUrl(B,ae,ee)}(k,x,_,C,K)})},H.createLines=function(_,x,T){var A=T[0].smoothing,S=_.selectAll("g.contourlevel").data(x?T:[]);if(S.exit().remove(),S.enter().append("g").classed("contourlevel",!0),x){var w=S.selectAll("path.openline").data(function(k){return k.pedgepaths||k.edgepaths});w.exit().remove(),w.enter().append("path").classed("openline",!0),w.attr("d",function(k){return g.smoothopen(k,A)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke");var L=S.selectAll("path.closedline").data(function(k){return k.ppaths||k.paths});L.exit().remove(),L.enter().append("path").classed("closedline",!0),L.attr("d",function(k){return g.smoothclosed(k,A)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke")}return S},H.createLineClip=function(_,x,T,A){var S=x?"clipline"+A:null,w=T._fullLayout._clips.selectAll("#"+S).data(x?[0]:[]);return w.exit().remove(),w.enter().append("clipPath").classed("contourlineclip",!0).attr("id",S),g.setClipUrl(_,S,T),w},H.labelFormatter=function(_,x){var T=_._fullLayout,A=x.trace,S=A.contours,w={type:"linear",_id:"ycontour",showexponent:"all",exponentformat:"B"};if(S.labelformat)w.tickformat=S.labelformat,u(w,T);else{var L=p.extractOpts(A);if(L&&L.colorbar&&L.colorbar._axis)w=L.colorbar._axis;else{if(S.type==="constraint"){var k=S.value;Array.isArray(k)?w.range=[k[0],k[k.length-1]]:w.range=[k,k]}else w.range=[S.start,S.end],w.nticks=(S.end-S.start)/S.size;w.range[0]===w.range[1]&&(w.range[1]+=w.range[0]||1),w.nticks||(w.nticks=1e3),u(w,T),f.prepTicks(w),w._tmin=null,w._tmax=null}}return function(C){return f.tickText(w,C).text}},H.calcTextOpts=function(_,x,T,A){var S=x(_);T.text(S).call(e.convertToTspans,A);var w=T.node(),L=g.bBox(w,!0);return{text:S,width:L.width,height:L.height,fontSize:+w.style["font-size"].replace("px",""),level:_,dy:(L.top+L.bottom)/2}},H.findBestTextLocation=function(_,x,T,A,S){var w,L,k,C,M,P=T.width;x.isClosed?(L=x.len/d.INITIALSEARCHPOINTS,w=x.min+L/2,k=x.max):(L=(x.len-P)/(d.INITIALSEARCHPOINTS+1),w=x.min+L+P/2,k=x.max-(L+P)/2);for(var O=1/0,F=0;F<d.ITERATIONS;F++){for(var j=w;j<k;j+=L){var W=m.getTextLocation(_,x.total,j,P),Z=y(W,T,A,S);Z<O&&(O=Z,M=W,C=j)}if(O>2*d.MAXCOST)break;F&&(L/=2),k=(w=C-L/2)+1.5*L}if(O<=d.MAXCOST)return M},H.addLabelData=function(_,x,T,A){var S=x.fontSize,w=x.width+S/3,L=Math.max(0,x.height-S/3),k=_.x,C=_.y,M=_.theta,P=Math.sin(M),O=Math.cos(M),F=function(W,Z){return[k+W*O-Z*P,C+W*P+Z*O]},j=[F(-w/2,-L/2),F(-w/2,L/2),F(w/2,L/2),F(w/2,-L/2)];T.push({text:x.text,x:k,y:C,dy:x.dy,theta:M,level:x.level,width:w,height:L}),A.push(j)},H.drawLabels=function(_,x,T,A,S){var w=_.selectAll("text").data(x,function(C){return C.text+","+C.x+","+C.y+","+C.theta});if(w.exit().remove(),w.enter().append("text").attr({"data-notex":1,"text-anchor":"middle"}).each(function(C){var M=C.x+Math.sin(C.theta)*C.dy,P=C.y-Math.cos(C.theta)*C.dy;t.select(this).text(C.text).attr({x:M,y:P,transform:"rotate("+180*C.theta/Math.PI+" "+M+" "+P+")"}).call(e.convertToTspans,T)}),S){for(var L="",k=0;k<S.length;k++)L+="M"+S[k].join("L")+"Z";m.ensureSingle(A,"path","").attr("d",L)}}},{"../../components/colorscale":662,"../../components/drawing":672,"../../lib":787,"../../lib/svg_text_utils":813,"../../plots/cartesian/axes":838,"../../plots/cartesian/set_convert":859,"../heatmap/plot":1080,"./close_boundaries":1014,"./constants":1016,"./convert_to_constraints":1020,"./empty_pathinfo":1022,"./find_all_paths":1024,"./make_crossings":1029,"@plotly/d3":58}],1031:[function(h,N,H){var t=h("../../plots/cartesian/axes"),m=h("../../lib");function g(p,e,f){var u={type:"linear",range:[p,e]};return t.autoTicks(u,(e-p)/(f||15)),u}N.exports=function(p,e){var f=p.contours;if(p.autocontour){var u=p.zmin,i=p.zmax;(p.zauto||u===void 0)&&(u=m.aggNums(Math.min,null,e)),(p.zauto||i===void 0)&&(i=m.aggNums(Math.max,null,e));var s=g(u,i,p.ncontours);f.size=s.dtick,f.start=t.tickFirst(s),s.range.reverse(),f.end=t.tickFirst(s),f.start===u&&(f.start+=f.size),f.end===i&&(f.end-=f.size),f.start>f.end&&(f.start=f.end=(f.start+f.end)/2),p._input.contours||(p._input.contours={}),m.extendFlat(p._input.contours,{start:f.start,end:f.end,size:f.size}),p._input.autocontour=!0}else if(f.type!=="constraint"){var o,a=f.start,c=f.end,r=p._input.contours;a>c&&(f.start=r.start=c,c=f.end=r.end=a,a=f.start),!(f.size>0)&&(o=a===c?1:g(a,c,p.ncontours).dtick,r.size=f.size=o)}}},{"../../lib":787,"../../plots/cartesian/axes":838}],1032:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../components/drawing"),g=h("../heatmap/style"),p=h("./make_color_map");N.exports=function(e){var f=t.select(e).selectAll("g.contour");f.style("opacity",function(u){return u[0].trace.opacity}),f.each(function(u){var i=t.select(this),s=u[0].trace,o=s.contours,a=s.line,c=o.size||1,r=o.start,n=o.type==="constraint",d=!n&&o.coloring==="lines",l=!n&&o.coloring==="fill",y=d||l?p(s):null;i.selectAll("g.contourlevel").each(function(x){t.select(this).selectAll("path").call(m.lineGroupStyle,a.width,d?y(x.level):a.color,a.dash)});var v=o.labelfont;if(i.selectAll("g.contourlabels text").each(function(x){m.font(t.select(this),{family:v.family,size:v.size,color:v.color||(d?y(x.level):a.color)})}),n)i.selectAll("g.contourfill path").style("fill",s.fillcolor);else if(l){var _;i.selectAll("g.contourfill path").style("fill",function(x){return _===void 0&&(_=x.level),y(x.level+.5*c)}),_===void 0&&(_=r),i.selectAll("g.contourbg path").style("fill",y(_-.5*c))}}),g(e)}},{"../../components/drawing":672,"../heatmap/style":1081,"./make_color_map":1028,"@plotly/d3":58}],1033:[function(h,N,H){var t=h("../../components/colorscale/defaults"),m=h("./label_defaults");N.exports=function(g,p,e,f,u){var i,s=e("contours.coloring"),o="";s==="fill"&&(i=e("contours.showlines")),i!==!1&&(s!=="lines"&&(o=e("line.color","#000")),e("line.width",.5),e("line.dash")),s!=="none"&&(g.showlegend!==!0&&(p.showlegend=!1),p._dfltShowLegend=!1,t(g,p,f,e,{prefix:"",cLetter:"z"})),e("line.smoothing"),m(e,f,o,u)}},{"../../components/colorscale/defaults":660,"./label_defaults":1027}],1034:[function(h,N,H){var t=h("../heatmap/attributes"),m=h("../contour/attributes"),g=h("../../components/colorscale/attributes"),p=h("../../lib/extend").extendFlat,e=m.contours;N.exports=p({carpet:{valType:"string",editType:"calc"},z:t.z,a:t.x,a0:t.x0,da:t.dx,b:t.y,b0:t.y0,db:t.dy,text:t.text,hovertext:t.hovertext,transpose:t.transpose,atype:t.xtype,btype:t.ytype,fillcolor:m.fillcolor,autocontour:m.autocontour,ncontours:m.ncontours,contours:{type:e.type,start:e.start,end:e.end,size:e.size,coloring:{valType:"enumerated",values:["fill","lines","none"],dflt:"fill",editType:"calc"},showlines:e.showlines,showlabels:e.showlabels,labelfont:e.labelfont,labelformat:e.labelformat,operation:e.operation,value:e.value,editType:"calc",impliedEdits:{autocontour:!1}},line:{color:m.line.color,width:m.line.width,dash:m.line.dash,smoothing:m.line.smoothing,editType:"plot"},transforms:void 0},g("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../contour/attributes":1012,"../heatmap/attributes":1069}],1035:[function(h,N,H){var t=h("../../components/colorscale/calc"),m=h("../../lib"),g=h("../heatmap/convert_column_xyz"),p=h("../heatmap/clean_2d_array"),e=h("../heatmap/interp2d"),f=h("../heatmap/find_empties"),u=h("../heatmap/make_bound_array"),i=h("./defaults"),s=h("../carpet/lookup_carpetid"),o=h("../contour/set_contours");N.exports=function(a,c){var r=c._carpetTrace=s(a,c);if(r&&r.visible&&r.visible!=="legendonly"){if(!c.a||!c.b){var n=a.data[r.index],d=a.data[c.index];d.a||(d.a=n.a),d.b||(d.b=n.b),i(d,c,c._defaultColor,a._fullLayout)}var l=function(y,v){var _,x,T,A,S,w,L,k=v._carpetTrace,C=k.aaxis,M=k.baxis;C._minDtick=0,M._minDtick=0,m.isArray1D(v.z)&&g(v,C,M,"a","b",["z"]),_=v._a=v._a||v.a,A=v._b=v._b||v.b,_=_?C.makeCalcdata(v,"_a"):[],A=A?M.makeCalcdata(v,"_b"):[],x=v.a0||0,T=v.da||1,S=v.b0||0,w=v.db||1,L=v._z=p(v._z||v.z,v.transpose),v._emptypoints=f(L),e(L,v._emptypoints);var P=m.maxRowLength(L),O=v.xtype==="scaled"?"":_,F=u(v,O,x,T,P,C),j=v.ytype==="scaled"?"":A,W=u(v,j,S,w,L.length,M),Z={a:F,b:W,z:L};return v.contours.type==="levels"&&v.contours.coloring!=="none"&&t(y,v,{vals:L,containerStr:"",cLetter:"z"}),[Z]}(a,c);return o(c,c._z),l}}},{"../../components/colorscale/calc":658,"../../lib":787,"../carpet/lookup_carpetid":985,"../contour/set_contours":1031,"../heatmap/clean_2d_array":1071,"../heatmap/convert_column_xyz":1073,"../heatmap/find_empties":1075,"../heatmap/interp2d":1078,"../heatmap/make_bound_array":1079,"./defaults":1036}],1036:[function(h,N,H){var t=h("../../lib"),m=h("../heatmap/xyz_defaults"),g=h("./attributes"),p=h("../contour/constraint_defaults"),e=h("../contour/contours_defaults"),f=h("../contour/style_defaults");N.exports=function(u,i,s,o){function a(c,r){return t.coerce(u,i,g,c,r)}if(a("carpet"),u.a&&u.b){if(!m(u,i,a,o,"a","b"))return void(i.visible=!1);a("text"),a("contours.type")==="constraint"?p(u,i,a,o,s,{hasHover:!1}):(e(u,i,a,function(c){return t.coerce2(u,i,g,c)}),f(u,i,a,o,{hasHover:!1}))}else i._defaultColor=s,i._length=null}},{"../../lib":787,"../contour/constraint_defaults":1017,"../contour/contours_defaults":1019,"../contour/style_defaults":1033,"../heatmap/xyz_defaults":1083,"./attributes":1034}],1037:[function(h,N,H){N.exports={attributes:h("./attributes"),supplyDefaults:h("./defaults"),colorbar:h("../contour/colorbar"),calc:h("./calc"),plot:h("./plot"),style:h("../contour/style"),moduleType:"trace",name:"contourcarpet",basePlotModule:h("../../plots/cartesian"),categories:["cartesian","svg","carpet","contour","symbols","showLegend","hasLines","carpetDependent","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":852,"../contour/colorbar":1015,"../contour/style":1032,"./attributes":1034,"./calc":1035,"./defaults":1036,"./plot":1038}],1038:[function(h,N,H){var t=h("@plotly/d3"),m=h("../carpet/map_1d_array"),g=h("../carpet/makepath"),p=h("../../components/drawing"),e=h("../../lib"),f=h("../contour/make_crossings"),u=h("../contour/find_all_paths"),i=h("../contour/plot"),s=h("../contour/constants"),o=h("../contour/convert_to_constraints"),a=h("../contour/empty_pathinfo"),c=h("../contour/close_boundaries"),r=h("../carpet/lookup_carpetid"),n=h("../carpet/axis_aligned_line");function d(v,_,x){var T=v.getPointAtLength(_),A=v.getPointAtLength(x),S=A.x-T.x,w=A.y-T.y,L=Math.sqrt(S*S+w*w);return[S/L,w/L]}function l(v){var _=Math.sqrt(v[0]*v[0]+v[1]*v[1]);return[v[0]/_,v[1]/_]}function y(v,_){var x=Math.abs(v[0]*_[0]+v[1]*_[1]);return Math.sqrt(1-x*x)/x}N.exports=function(v,_,x,T){var A=_.xaxis,S=_.yaxis;e.makeTraceGroups(T,x,"contour").each(function(w){var L=t.select(this),k=w[0],C=k.trace,M=C._carpetTrace=r(v,C),P=v.calcdata[M.index][0];if(M.visible&&M.visible!=="legendonly"){var O=k.a,F=k.b,j=C.contours,W=a(j,_,k),Z=j.type==="constraint",Q=j._operation,X=Z?Q==="="?"lines":"fill":j.coloring,G=[[O[0],F[F.length-1]],[O[O.length-1],F[F.length-1]],[O[O.length-1],F[0]],[O[0],F[0]]];f(W);var Y=1e-8*(O[O.length-1]-O[0]),K=1e-8*(F[F.length-1]-F[0]);u(W,Y,K);var D,B,q,ee,J=W;j.type==="constraint"&&(J=o(W,Q)),function(ae,he){var se,de,ce,ve,ke,Ee,be,xe,ue;for(se=0;se<ae.length;se++){for(ve=ae[se],ke=ve.pedgepaths=[],Ee=ve.ppaths=[],de=0;de<ve.edgepaths.length;de++){for(ue=ve.edgepaths[de],be=[],ce=0;ce<ue.length;ce++)be[ce]=he(ue[ce]);ke.push(be)}for(de=0;de<ve.paths.length;de++){for(ue=ve.paths[de],xe=[],ce=0;ce<ue.length;ce++)xe[ce]=he(ue[ce]);Ee.push(xe)}}}(W,ie);var $=[];for(ee=P.clipsegments.length-1;ee>=0;ee--)D=P.clipsegments[ee],B=m([],D.x,A.c2p),q=m([],D.y,S.c2p),B.reverse(),q.reverse(),$.push(g(B,q,D.bicubic));var te="M"+$.join("L")+"Z";(function(ae,he,se,de,ce,ve){var ke,Ee,be,xe,ue=e.ensureSingle(ae,"g","contourbg").selectAll("path").data(ve!=="fill"||ce?[]:[0]);ue.enter().append("path"),ue.exit().remove();var me=[];for(xe=0;xe<he.length;xe++)ke=he[xe],Ee=m([],ke.x,se.c2p),be=m([],ke.y,de.c2p),me.push(g(Ee,be,ke.bicubic));ue.attr("d","M"+me.join("L")+"Z").style("stroke","none")})(L,P.clipsegments,A,S,Z,X),function(ae,he,se,de,ce,ve,ke,Ee,be,xe,ue){var me=xe==="fill";me&&c(ce,ae.contours);var we=e.ensureSingle(he,"g","contourfill").selectAll("path").data(me?ce:[]);we.enter().append("path"),we.exit().remove(),we.each(function(Me){var Se=(Me.prefixBoundary?ue:"")+function(De,Fe,Ye,et,Oe,je,We,Ge){var Qe,it,lt,Lt,wt,rt,$e,xt="",Qt=Fe.edgepaths.map(function(ut,kt){return kt}),$t=!0,Ue=1e-4*Math.abs(Ye[0][0]-Ye[2][0]),He=1e-4*Math.abs(Ye[0][1]-Ye[2][1]);function Be(ut){return Math.abs(ut[1]-Ye[0][1])<He}function Je(ut){return Math.abs(ut[1]-Ye[2][1])<He}function _e(ut){return Math.abs(ut[0]-Ye[0][0])<Ue}function Le(ut){return Math.abs(ut[0]-Ye[2][0])<Ue}function Ce(ut,kt){var ft,Et,mt,It,vt="";for(Be(ut)&&!Le(ut)||Je(ut)&&!_e(ut)?(It=Oe.aaxis,mt=n(Oe,je,[ut[0],kt[0]],.5*(ut[1]+kt[1]))):(It=Oe.baxis,mt=n(Oe,je,.5*(ut[0]+kt[0]),[ut[1],kt[1]])),ft=1;ft<mt.length;ft++)for(vt+=It.smoothing?"C":"L",Et=0;Et<mt[ft].length;Et++){var nt=mt[ft][Et];vt+=[We.c2p(nt[0]),Ge.c2p(nt[1])]+" "}return vt}for(Qe=0,it=null;Qt.length;){var Pe=Fe.edgepaths[Qe][0];for(it&&(xt+=Ce(it,Pe)),$e=p.smoothopen(Fe.edgepaths[Qe].map(et),Fe.smoothing),xt+=$t?$e:$e.replace(/^M/,"L"),Qt.splice(Qt.indexOf(Qe),1),it=Fe.edgepaths[Qe][Fe.edgepaths[Qe].length-1],wt=-1,Lt=0;Lt<4;Lt++){if(!it){e.log("Missing end?",Qe,Fe);break}for(Be(it)&&!Le(it)?lt=Ye[1]:_e(it)?lt=Ye[0]:Je(it)?lt=Ye[3]:Le(it)&&(lt=Ye[2]),rt=0;rt<Fe.edgepaths.length;rt++){var Xe=Fe.edgepaths[rt][0];Math.abs(it[0]-lt[0])<Ue?Math.abs(it[0]-Xe[0])<Ue&&(Xe[1]-it[1])*(lt[1]-Xe[1])>=0&&(lt=Xe,wt=rt):Math.abs(it[1]-lt[1])<He?Math.abs(it[1]-Xe[1])<He&&(Xe[0]-it[0])*(lt[0]-Xe[0])>=0&&(lt=Xe,wt=rt):e.log("endpt to newendpt is not vert. or horz.",it,lt,Xe)}if(wt>=0)break;xt+=Ce(it,lt),it=lt}if(wt===Fe.edgepaths.length){e.log("unclosed perimeter path");break}Qe=wt,($t=Qt.indexOf(Qe)===-1)&&(Qe=Qt[0],xt+=Ce(it,lt)+"Z",it=null)}for(Qe=0;Qe<Fe.paths.length;Qe++)xt+=p.smoothclosed(Fe.paths[Qe].map(et),Fe.smoothing);return xt}(0,Me,ve,ke,Ee,be,se,de);Se?t.select(this).attr("d",Se).style("stroke","none"):t.select(this).remove()})}(C,L,A,S,J,G,ie,M,P,X,te),function(ae,he,se,de,ce,ve,ke){var Ee=e.ensureSingle(ae,"g","contourlines"),be=ce.showlines!==!1,xe=ce.showlabels,ue=be&&xe,me=i.createLines(Ee,be||xe,he),we=i.createLineClip(Ee,ue,se,de.trace.uid),Me=ae.selectAll("g.contourlabels").data(xe?[0]:[]);if(Me.exit().remove(),Me.enter().append("g").classed("contourlabels",!0),xe){var Se=ve.xaxis,De=ve.yaxis,Fe=Se._length,Ye=De._length,et=[[[0,0],[Fe,0],[Fe,Ye],[0,Ye]]],Oe=[];e.clearLocationCache();var je=i.labelFormatter(se,de),We=p.tester.append("text").attr("data-notex",1).call(p.font,ce.labelfont),Ge={left:0,right:Fe,center:Fe/2,top:0,bottom:Ye,middle:Ye/2},Qe=Math.sqrt(Fe*Fe+Ye*Ye),it=s.LABELDISTANCE*Qe/Math.max(1,he.length/s.LABELINCREASE);me.each(function(lt){var Lt=i.calcTextOpts(lt.level,je,We,se);t.select(this).selectAll("path").each(function(wt){var rt=e.getVisibleSegment(this,Ge,Lt.height/2);if(rt&&(function($t,Ue,He,Be,Je,_e){for(var Le,Ce=0;Ce<He.pedgepaths.length;Ce++)Ue===He.pedgepaths[Ce]&&(Le=He.edgepaths[Ce]);if(!Le)return;var Pe=Je.a[0],Xe=Je.a[Je.a.length-1],ut=Je.b[0],kt=Je.b[Je.b.length-1];function ft(nt,At){var Ft,Nt=0;return(Math.abs(nt[0]-Pe)<.1||Math.abs(nt[0]-Xe)<.1)&&(Ft=l(Je.dxydb_rough(nt[0],nt[1],.1)),Nt=Math.max(Nt,_e*y(At,Ft)/2)),(Math.abs(nt[1]-ut)<.1||Math.abs(nt[1]-kt)<.1)&&(Ft=l(Je.dxyda_rough(nt[0],nt[1],.1)),Nt=Math.max(Nt,_e*y(At,Ft)/2)),Nt}var Et=d($t,0,1),mt=d($t,Be.total,Be.total-1),It=ft(Le[0],Et),vt=Be.total-ft(Le[Le.length-1],mt);Be.min<It&&(Be.min=It),Be.max>vt&&(Be.max=vt),Be.len=Be.max-Be.min}(this,wt,lt,rt,ke,Lt.height),!(rt.len<(Lt.width+Lt.height)*s.LABELMIN)))for(var $e=Math.min(Math.ceil(rt.len/it),s.LABELMAX),xt=0;xt<$e;xt++){var Qt=i.findBestTextLocation(this,rt,Lt,Oe,Ge);if(!Qt)break;i.addLabelData(Qt,Lt,Oe,et)}})}),We.remove(),i.drawLabels(Me,Oe,se,we,ue?et:null)}xe&&!be&&me.remove()}(L,W,v,k,j,_,M),p.setClipUrl(L,M._clipPathId,v)}function ie(ae){var he=M.ab2xy(ae[0],ae[1],!0);return[A.c2p(he[0]),S.c2p(he[1])]}})}},{"../../components/drawing":672,"../../lib":787,"../carpet/axis_aligned_line":969,"../carpet/lookup_carpetid":985,"../carpet/makepath":986,"../carpet/map_1d_array":987,"../contour/close_boundaries":1014,"../contour/constants":1016,"../contour/convert_to_constraints":1020,"../contour/empty_pathinfo":1022,"../contour/find_all_paths":1024,"../contour/make_crossings":1029,"../contour/plot":1030,"@plotly/d3":58}],1039:[function(h,N,H){var t=h("../../components/colorscale/attributes"),m=h("../../plots/template_attributes").hovertemplateAttrs,g=h("../../plots/attributes"),p=h("../scattermapbox/attributes"),e=h("../../lib/extend").extendFlat;N.exports=e({lon:p.lon,lat:p.lat,z:{valType:"data_array",editType:"calc"},radius:{valType:"number",editType:"plot",arrayOk:!0,min:1,dflt:30},below:{valType:"string",editType:"plot"},text:p.text,hovertext:p.hovertext,hoverinfo:e({},g.hoverinfo,{flags:["lon","lat","z","text","name"]}),hovertemplate:m(),showlegend:e({},g.showlegend,{dflt:!1})},t("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/template_attributes":910,"../scattermapbox/attributes":1267}],1040:[function(h,N,H){var t=h("fast-isnumeric"),m=h("../../lib").isArrayOrTypedArray,g=h("../../constants/numerical").BADNUM,p=h("../../components/colorscale/calc"),e=h("../../lib")._;N.exports=function(f,u){for(var i=u._length,s=new Array(i),o=u.z,a=m(o)&&o.length,c=0;c<i;c++){var r=s[c]={},n=u.lon[c],d=u.lat[c];if(r.lonlat=t(n)&&t(d)?[+n,+d]:[g,g],a){var l=o[c];r.z=t(l)?l:g}}return p(f,u,{vals:a?o:[0,1],containerStr:"",cLetter:"z"}),i&&(s[0].t={labels:{lat:e(f,"lat:")+" ",lon:e(f,"lon:")+" "}}),s}},{"../../components/colorscale/calc":658,"../../constants/numerical":763,"../../lib":787,"fast-isnumeric":246}],1041:[function(h,N,H){var t=h("fast-isnumeric"),m=h("../../lib"),g=h("../../components/color"),p=h("../../components/colorscale"),e=h("../../constants/numerical").BADNUM,f=h("../../lib/geojson_utils").makeBlank;N.exports=function(u){var i=u[0].trace,s=i.visible===!0&&i._length!==0,o=i._opts={heatmap:{layout:{visibility:"none"},paint:{}},geojson:f()};if(!s)return o;var a,c=[],r=i.z,n=i.radius,d=m.isArrayOrTypedArray(r)&&r.length,l=m.isArrayOrTypedArray(n);for(a=0;a<u.length;a++){var y=u[a],v=y.lonlat;if(v[0]!==e){var _={};if(d){var x=y.z;_.z=x!==e?x:0}l&&(_.r=t(n[a])&&n[a]>0?+n[a]:0),c.push({type:"Feature",geometry:{type:"Point",coordinates:v},properties:_})}}var T=p.extractOpts(i),A=T.reversescale?p.flipScale(T.colorscale):T.colorscale,S=A[0][1],w=["interpolate",["linear"],["heatmap-density"],0,g.opacity(S)<1?S:g.addOpacity(S,0)];for(a=1;a<A.length;a++)w.push(A[a][0],A[a][1]);var L=["interpolate",["linear"],["get","z"],T.min,0,T.max,1];return m.extendFlat(o.heatmap.paint,{"heatmap-weight":d?L:1/(T.max-T.min),"heatmap-color":w,"heatmap-radius":l?{type:"identity",property:"r"}:i.radius,"heatmap-opacity":i.opacity}),o.geojson={type:"FeatureCollection",features:c},o.heatmap.layout.visibility="visible",o}},{"../../components/color":650,"../../components/colorscale":662,"../../constants/numerical":763,"../../lib":787,"../../lib/geojson_utils":781,"fast-isnumeric":246}],1042:[function(h,N,H){var t=h("../../lib"),m=h("../../components/colorscale/defaults"),g=h("./attributes");N.exports=function(p,e,f,u){function i(c,r){return t.coerce(p,e,g,c,r)}var s=i("lon")||[],o=i("lat")||[],a=Math.min(s.length,o.length);a?(e._length=a,i("z"),i("radius"),i("below"),i("text"),i("hovertext"),i("hovertemplate"),m(p,e,u,i,{prefix:"",cLetter:"z"})):e.visible=!1}},{"../../components/colorscale/defaults":660,"../../lib":787,"./attributes":1039}],1043:[function(h,N,H){N.exports=function(t,m){return t.lon=m.lon,t.lat=m.lat,t.z=m.z,t}},{}],1044:[function(h,N,H){var t=h("../../plots/cartesian/axes"),m=h("../scattermapbox/hover").hoverPoints,g=h("../scattermapbox/hover").getExtraText;N.exports=function(p,e,f){var u=m(p,e,f);if(u){var i=u[0],s=i.cd,o=s[0].trace,a=s[i.index];if(delete i.color,"z"in a){var c=i.subplot.mockAxis;i.z=a.z,i.zLabel=t.tickText(c,c.c2l(a.z),"hover").text}return i.extraText=g(o,a,s[0].t.labels),[i]}}},{"../../plots/cartesian/axes":838,"../scattermapbox/hover":1272}],1045:[function(h,N,H){N.exports={attributes:h("./attributes"),supplyDefaults:h("./defaults"),colorbar:h("../heatmap/colorbar"),formatLabels:h("../scattermapbox/format_labels"),calc:h("./calc"),plot:h("./plot"),hoverPoints:h("./hover"),eventData:h("./event_data"),getBelow:function(t,m){for(var g=m.getMapLayers(),p=0;p<g.length;p++){var e=g[p],f=e.id;if(e.type==="symbol"&&typeof f=="string"&&f.indexOf("plotly-")===-1)return f}},moduleType:"trace",name:"densitymapbox",basePlotModule:h("../../plots/mapbox"),categories:["mapbox","gl","showLegend"],meta:{hr_name:"density_mapbox"}}},{"../../plots/mapbox":895,"../heatmap/colorbar":1072,"../scattermapbox/format_labels":1271,"./attributes":1039,"./calc":1040,"./defaults":1042,"./event_data":1043,"./hover":1044,"./plot":1046}],1046:[function(h,N,H){var t=h("./convert"),m=h("../../plots/mapbox/constants").traceLayerPrefix;function g(e,f){this.type="densitymapbox",this.subplot=e,this.uid=f,this.sourceId="source-"+f,this.layerList=[["heatmap",m+f+"-heatmap"]],this.below=null}var p=g.prototype;p.update=function(e){var f=this.subplot,u=this.layerList,i=t(e),s=f.belowLookup["trace-"+this.uid];f.map.getSource(this.sourceId).setData(i.geojson),s!==this.below&&(this._removeLayers(),this._addLayers(i,s),this.below=s);for(var o=0;o<u.length;o++){var a=u[o],c=a[0],r=a[1],n=i[c];f.setOptions(r,"setLayoutProperty",n.layout),n.layout.visibility==="visible"&&f.setOptions(r,"setPaintProperty",n.paint)}},p._addLayers=function(e,f){for(var u=this.subplot,i=this.layerList,s=this.sourceId,o=0;o<i.length;o++){var a=i[o],c=a[0],r=e[c];u.addLayer({type:c,id:a[1],source:s,layout:r.layout,paint:r.paint},f)}},p._removeLayers=function(){for(var e=this.subplot.map,f=this.layerList,u=f.length-1;u>=0;u--)e.removeLayer(f[u][1])},p.dispose=function(){var e=this.subplot.map;this._removeLayers(),e.removeSource(this.sourceId)},N.exports=function(e,f){var u=f[0].trace,i=new g(e,u.uid),s=i.sourceId,o=t(f),a=i.below=e.belowLookup["trace-"+u.uid];return e.map.addSource(s,{type:"geojson",data:o.geojson}),i._addLayers(o,a),i}},{"../../plots/mapbox/constants":893,"./convert":1041}],1047:[function(h,N,H){var t=h("../../lib");N.exports=function(m,g){for(var p=0;p<m.length;p++)m[p].i=p;t.mergeArray(g.text,m,"tx"),t.mergeArray(g.hovertext,m,"htx");var e=g.marker;if(e){t.mergeArray(e.opacity,m,"mo"),t.mergeArray(e.color,m,"mc");var f=e.line;f&&(t.mergeArray(f.color,m,"mlc"),t.mergeArrayCastPositive(f.width,m,"mlw"))}}},{"../../lib":787}],1048:[function(h,N,H){var t,m=h("../bar/attributes"),g=h("../scatter/attributes").line,p=h("../../plots/attributes"),e=h("../../plots/cartesian/axis_format_attributes").axisHoverFormat,f=h("../../plots/template_attributes").hovertemplateAttrs,u=h("../../plots/template_attributes").texttemplateAttrs,i=h("./constants"),s=h("../../lib/extend").extendFlat,o=h("../../components/color");N.exports={x:m.x,x0:m.x0,dx:m.dx,y:m.y,y0:m.y0,dy:m.dy,xperiod:m.xperiod,yperiod:m.yperiod,xperiod0:m.xperiod0,yperiod0:m.yperiod0,xperiodalignment:m.xperiodalignment,yperiodalignment:m.yperiodalignment,xhoverformat:e("x"),yhoverformat:e("y"),hovertext:m.hovertext,hovertemplate:f({},{keys:i.eventDataKeys}),hoverinfo:s({},p.hoverinfo,{flags:["name","x","y","text","percent initial","percent previous","percent total"]}),textinfo:{valType:"flaglist",flags:["label","text","percent initial","percent previous","percent total","value"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:u({editType:"plot"},{keys:i.eventDataKeys.concat(["label","value"])}),text:m.text,textposition:m.textposition,insidetextanchor:s({},m.insidetextanchor,{dflt:"middle"}),textangle:s({},m.textangle,{dflt:0}),textfont:m.textfont,insidetextfont:m.insidetextfont,outsidetextfont:m.outsidetextfont,constraintext:m.constraintext,cliponaxis:m.cliponaxis,orientation:s({},m.orientation,{}),offset:s({},m.offset,{arrayOk:!1}),width:s({},m.width,{arrayOk:!1}),marker:(t=s({},m.marker),delete t.pattern,t),connector:{fillcolor:{valType:"color",editType:"style"},line:{color:s({},g.color,{dflt:o.defaultLine}),width:s({},g.width,{dflt:0,editType:"plot"}),dash:g.dash,editType:"style"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:m.offsetgroup,alignmentgroup:m.alignmentgroup}},{"../../components/color":650,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../bar/attributes":925,"../scatter/attributes":1202,"./constants":1050}],1049:[function(h,N,H){var t=h("../../plots/cartesian/axes"),m=h("../../plots/cartesian/align_period"),g=h("./arrays_to_calcdata"),p=h("../scatter/calc_selection"),e=h("../../constants/numerical").BADNUM;function f(u){return u===e?0:u}N.exports=function(u,i){var s,o,a,c,r,n,d,l,y=t.getFromId(u,i.xaxis||"x"),v=t.getFromId(u,i.yaxis||"y");i.orientation==="h"?(s=y.makeCalcdata(i,"x"),a=v.makeCalcdata(i,"y"),c=m(i,v,"y",a),r=!!i.yperiodalignment,n="y"):(s=v.makeCalcdata(i,"y"),a=y.makeCalcdata(i,"x"),c=m(i,y,"x",a),r=!!i.xperiodalignment,n="x"),o=c.vals;var _,x=Math.min(o.length,s.length),T=new Array(x);for(i._base=[],d=0;d<x;d++){s[d]<0&&(s[d]=e);var A=!1;s[d]!==e&&d+1<x&&s[d+1]!==e&&(A=!0),l=T[d]={p:o[d],s:s[d],cNext:A},i._base[d]=-.5*l.s,r&&(T[d].orig_p=a[d],T[d][n+"End"]=c.ends[d],T[d][n+"Start"]=c.starts[d]),i.ids&&(l.id=String(i.ids[d])),d===0&&(T[0].vTotal=0),T[0].vTotal+=f(l.s),l.begR=f(l.s)/f(T[0].s)}for(d=0;d<x;d++)(l=T[d]).s!==e&&(l.sumR=l.s/T[0].vTotal,l.difR=_!==void 0?l.s/_:1,_=l.s);return g(T,i),p(T,i),T}},{"../../constants/numerical":763,"../../plots/cartesian/align_period":835,"../../plots/cartesian/axes":838,"../scatter/calc_selection":1204,"./arrays_to_calcdata":1047}],1050:[function(h,N,H){N.exports={eventDataKeys:["percentInitial","percentPrevious","percentTotal"]}},{}],1051:[function(h,N,H){var t=h("../bar/cross_trace_calc").setGroupPositions;N.exports=function(m,g){var p,e,f=m._fullLayout,u=m._fullData,i=m.calcdata,s=g.xaxis,o=g.yaxis,a=[],c=[],r=[];for(e=0;e<u.length;e++){var n=u[e],d=n.orientation==="h";n.visible===!0&&n.xaxis===s._id&&n.yaxis===o._id&&n.type==="funnel"&&(p=i[e],d?r.push(p):c.push(p),a.push(p))}var l={mode:f.funnelmode,norm:f.funnelnorm,gap:f.funnelgap,groupgap:f.funnelgroupgap};for(t(m,s,o,c,l),t(m,o,s,r,l),e=0;e<a.length;e++){p=a[e];for(var y=0;y<p.length;y++)y+1<p.length&&(p[y].nextP0=p[y+1].p0,p[y].nextS0=p[y+1].s0,p[y].nextP1=p[y+1].p1,p[y].nextS1=p[y+1].s1)}}},{"../bar/cross_trace_calc":928}],1052:[function(h,N,H){var t=h("../../lib"),m=h("../bar/defaults").handleGroupingDefaults,g=h("../bar/defaults").handleText,p=h("../scatter/xy_defaults"),e=h("../scatter/period_defaults"),f=h("./attributes"),u=h("../../components/color");N.exports={supplyDefaults:function(i,s,o,a){function c(l,y){return t.coerce(i,s,f,l,y)}if(p(i,s,a,c)){e(i,s,a,c),c("xhoverformat"),c("yhoverformat"),c("orientation",s.y&&!s.x?"v":"h"),c("offset"),c("width");var r=c("text");c("hovertext"),c("hovertemplate");var n=c("textposition");g(i,s,a,c,n,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),s.textposition==="none"||s.texttemplate||c("textinfo",Array.isArray(r)?"text+value":"value");var d=c("marker.color",o);c("marker.line.color",u.defaultLine),c("marker.line.width"),c("connector.visible")&&(c("connector.fillcolor",function(l){var y=t.isArrayOrTypedArray(l)?"#000":l;return u.addOpacity(y,.5*u.opacity(y))}(d)),c("connector.line.width")&&(c("connector.line.color"),c("connector.line.dash")))}else s.visible=!1},crossTraceDefaults:function(i,s){var o,a;function c(n){return t.coerce(a._input,a,f,n)}if(s.funnelmode==="group")for(var r=0;r<i.length;r++)o=(a=i[r])._input,m(o,a,s,c)}}},{"../../components/color":650,"../../lib":787,"../bar/defaults":929,"../scatter/period_defaults":1222,"../scatter/xy_defaults":1229,"./attributes":1048}],1053:[function(h,N,H){N.exports=function(t,m){return t.x="xVal"in m?m.xVal:m.x,t.y="yVal"in m?m.yVal:m.y,"percentInitial"in m&&(t.percentInitial=m.percentInitial),"percentPrevious"in m&&(t.percentPrevious=m.percentPrevious),"percentTotal"in m&&(t.percentTotal=m.percentTotal),m.xa&&(t.xaxis=m.xa),m.ya&&(t.yaxis=m.ya),t}},{}],1054:[function(h,N,H){var t=h("../../components/color").opacity,m=h("../bar/hover").hoverOnBars,g=h("../../lib").formatPercent;N.exports=function(p,e,f,u,i){var s=m(p,e,f,u,i);if(s){var o=s.cd,a=o[0].trace,c=a.orientation==="h",r=o[s.index];s[(c?"x":"y")+"LabelVal"]=r.s,s.percentInitial=r.begR,s.percentInitialLabel=g(r.begR,1),s.percentPrevious=r.difR,s.percentPreviousLabel=g(r.difR,1),s.percentTotal=r.sumR,s.percentTotalLabel=g(r.sumR,1);var n=r.hi||a.hoverinfo,d=[];if(n&&n!=="none"&&n!=="skip"){var l=n==="all",y=n.split("+"),v=function(_){return l||y.indexOf(_)!==-1};v("percent initial")&&d.push(s.percentInitialLabel+" of initial"),v("percent previous")&&d.push(s.percentPreviousLabel+" of previous"),v("percent total")&&d.push(s.percentTotalLabel+" of total")}return s.extraText=d.join("<br>"),s.color=function(_,x){var T=_.marker,A=x.mc||T.color,S=x.mlc||T.line.color,w=x.mlw||T.line.width;if(t(A))return A;if(t(S)&&w)return S}(a,r),[s]}}},{"../../components/color":650,"../../lib":787,"../bar/hover":932}],1055:[function(h,N,H){N.exports={attributes:h("./attributes"),layoutAttributes:h("./layout_attributes"),supplyDefaults:h("./defaults").supplyDefaults,crossTraceDefaults:h("./defaults").crossTraceDefaults,supplyLayoutDefaults:h("./layout_defaults"),calc:h("./calc"),crossTraceCalc:h("./cross_trace_calc"),plot:h("./plot"),style:h("./style").style,hoverPoints:h("./hover"),eventData:h("./event_data"),selectPoints:h("../bar/select"),moduleType:"trace",name:"funnel",basePlotModule:h("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":852,"../bar/select":937,"./attributes":1048,"./calc":1049,"./cross_trace_calc":1051,"./defaults":1052,"./event_data":1053,"./hover":1054,"./layout_attributes":1056,"./layout_defaults":1057,"./plot":1058,"./style":1059}],1056:[function(h,N,H){N.exports={funnelmode:{valType:"enumerated",values:["stack","group","overlay"],dflt:"stack",editType:"calc"},funnelgap:{valType:"number",min:0,max:1,editType:"calc"},funnelgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],1057:[function(h,N,H){var t=h("../../lib"),m=h("./layout_attributes");N.exports=function(g,p,e){var f=!1;function u(o,a){return t.coerce(g,p,m,o,a)}for(var i=0;i<e.length;i++){var s=e[i];if(s.visible&&s.type==="funnel"){f=!0;break}}f&&(u("funnelmode"),u("funnelgap",.2),u("funnelgroupgap"))}},{"../../lib":787,"./layout_attributes":1056}],1058:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../lib"),g=h("../../components/drawing"),p=h("../../constants/numerical").BADNUM,e=h("../bar/plot"),f=h("../bar/uniform_text").clearMinTextSize;function u(i,s,o,a){var c=[],r=[],n=a?s:o,d=a?o:s;return c[0]=n.c2p(i.s0,!0),r[0]=d.c2p(i.p0,!0),c[1]=n.c2p(i.s1,!0),r[1]=d.c2p(i.p1,!0),c[2]=n.c2p(i.nextS0,!0),r[2]=d.c2p(i.nextP0,!0),c[3]=n.c2p(i.nextS1,!0),r[3]=d.c2p(i.nextP1,!0),a?[c,r]:[r,c]}N.exports=function(i,s,o,a){var c=i._fullLayout;f("funnel",c),function(r,n,d,l){var y=n.xaxis,v=n.yaxis;m.makeTraceGroups(l,d,"trace bars").each(function(_){var x=t.select(this),T=_[0].trace,A=m.ensureSingle(x,"g","regions");if(T.connector&&T.connector.visible){var S=T.orientation==="h",w=A.selectAll("g.region").data(m.identity);w.enter().append("g").classed("region",!0),w.exit().remove();var L=w.size();w.each(function(k,C){if(C===L-1||k.cNext){var M=u(k,y,v,S),P=M[0],O=M[1],F="";P[0]!==p&&O[0]!==p&&P[1]!==p&&O[1]!==p&&P[2]!==p&&O[2]!==p&&P[3]!==p&&O[3]!==p&&(F+=S?"M"+P[0]+","+O[1]+"L"+P[2]+","+O[2]+"H"+P[3]+"L"+P[1]+","+O[1]+"Z":"M"+P[1]+","+O[1]+"L"+P[2]+","+O[3]+"V"+O[2]+"L"+P[1]+","+O[0]+"Z"),F===""&&(F="M0,0Z"),m.ensureSingle(t.select(this),"path").attr("d",F).call(g.setClipUrl,n.layerClipId,r)}})}else A.remove()})}(i,s,o,a),function(r,n,d,l){var y=n.xaxis,v=n.yaxis;m.makeTraceGroups(l,d,"trace bars").each(function(_){var x=t.select(this),T=_[0].trace,A=m.ensureSingle(x,"g","lines");if(T.connector&&T.connector.visible&&T.connector.line.width){var S=T.orientation==="h",w=A.selectAll("g.line").data(m.identity);w.enter().append("g").classed("line",!0),w.exit().remove();var L=w.size();w.each(function(k,C){if(C===L-1||k.cNext){var M=u(k,y,v,S),P=M[0],O=M[1],F="";P[3]!==void 0&&O[3]!==void 0&&(S?(F+="M"+P[0]+","+O[1]+"L"+P[2]+","+O[2],F+="M"+P[1]+","+O[1]+"L"+P[3]+","+O[2]):(F+="M"+P[1]+","+O[1]+"L"+P[2]+","+O[3],F+="M"+P[1]+","+O[0]+"L"+P[2]+","+O[2])),F===""&&(F="M0,0Z"),m.ensureSingle(t.select(this),"path").attr("d",F).call(g.setClipUrl,n.layerClipId,r)}})}else A.remove()})}(i,s,o,a),e.plot(i,s,o,a,{mode:c.funnelmode,norm:c.funnelmode,gap:c.funnelgap,groupgap:c.funnelgroupgap})}},{"../../components/drawing":672,"../../constants/numerical":763,"../../lib":787,"../bar/plot":936,"../bar/uniform_text":941,"@plotly/d3":58}],1059:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../components/drawing"),g=h("../../components/color"),p=h("../../constants/interactions").DESELECTDIM,e=h("../bar/style"),f=h("../bar/uniform_text").resizeText,u=e.styleTextPoints;N.exports={style:function(i,s,o){var a=o||t.select(i).selectAll("g.funnellayer").selectAll("g.trace");f(i,a,"funnel"),a.style("opacity",function(c){return c[0].trace.opacity}),a.each(function(c){var r=t.select(this),n=c[0].trace;r.selectAll(".point > path").each(function(d){if(!d.isBlank){var l=n.marker;t.select(this).call(g.fill,d.mc||l.color).call(g.stroke,d.mlc||l.line.color).call(m.dashLine,l.line.dash,d.mlw||l.line.width).style("opacity",n.selectedpoints&&!d.selected?p:1)}}),u(r,n,i),r.selectAll(".regions").each(function(){t.select(this).selectAll("path").style("stroke-width",0).call(g.fill,n.connector.fillcolor)}),r.selectAll(".lines").each(function(){var d=n.connector.line;m.lineGroupStyle(t.select(this).selectAll("path"),d.width,d.color,d.dash)})})}}},{"../../components/color":650,"../../components/drawing":672,"../../constants/interactions":762,"../bar/style":939,"../bar/uniform_text":941,"@plotly/d3":58}],1060:[function(h,N,H){var t=h("../pie/attributes"),m=h("../../plots/attributes"),g=h("../../plots/domain").attributes,p=h("../../plots/template_attributes").hovertemplateAttrs,e=h("../../plots/template_attributes").texttemplateAttrs,f=h("../../lib/extend").extendFlat;N.exports={labels:t.labels,label0:t.label0,dlabel:t.dlabel,values:t.values,marker:{colors:t.marker.colors,line:{color:f({},t.marker.line.color,{dflt:null}),width:f({},t.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},text:t.text,hovertext:t.hovertext,scalegroup:f({},t.scalegroup,{}),textinfo:f({},t.textinfo,{flags:["label","text","value","percent"]}),texttemplate:e({editType:"plot"},{keys:["label","color","value","text","percent"]}),hoverinfo:f({},m.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:p({},{keys:["label","color","value","text","percent"]}),textposition:f({},t.textposition,{values:["inside","none"],dflt:"inside"}),textfont:t.textfont,insidetextfont:t.insidetextfont,title:{text:t.title.text,font:t.title.font,position:f({},t.title.position,{values:["top left","top center","top right"],dflt:"top center"}),editType:"plot"},domain:g({name:"funnelarea",trace:!0,editType:"calc"}),aspectratio:{valType:"number",min:0,dflt:1,editType:"plot"},baseratio:{valType:"number",min:0,max:1,dflt:.333,editType:"plot"}}},{"../../lib/extend":777,"../../plots/attributes":834,"../../plots/domain":866,"../../plots/template_attributes":910,"../pie/attributes":1176}],1061:[function(h,N,H){var t=h("../../plots/plots");H.name="funnelarea",H.plot=function(m,g,p,e){t.plotBasePlot(H.name,m,g,p,e)},H.clean=function(m,g,p,e){t.cleanBasePlot(H.name,m,g,p,e)}},{"../../plots/plots":901}],1062:[function(h,N,H){var t=h("../pie/calc");N.exports={calc:function(m,g){return t.calc(m,g)},crossTraceCalc:function(m){t.crossTraceCalc(m,{type:"funnelarea"})}}},{"../pie/calc":1178}],1063:[function(h,N,H){var t=h("../../lib"),m=h("./attributes"),g=h("../../plots/domain").defaults,p=h("../bar/defaults").handleText,e=h("../pie/defaults").handleLabelsAndValues;N.exports=function(f,u,i,s){function o(_,x){return t.coerce(f,u,m,_,x)}var a=o("labels"),c=o("values"),r=e(a,c),n=r.len;if(u._hasLabels=r.hasLabels,u._hasValues=r.hasValues,!u._hasLabels&&u._hasValues&&(o("label0"),o("dlabel")),n){u._length=n,o("marker.line.width")&&o("marker.line.color",s.paper_bgcolor),o("marker.colors"),o("scalegroup");var d,l=o("text"),y=o("texttemplate");if(y||(d=o("textinfo",Array.isArray(l)?"text+percent":"percent")),o("hovertext"),o("hovertemplate"),y||d&&d!=="none"){var v=o("textposition");p(f,u,s,o,v,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1})}g(u,s,o),o("title.text")&&(o("title.position"),t.coerceFont(o,"title.font",s.font)),o("aspectratio"),o("baseratio")}else u.visible=!1}},{"../../lib":787,"../../plots/domain":866,"../bar/defaults":929,"../pie/defaults":1179,"./attributes":1060}],1064:[function(h,N,H){N.exports={moduleType:"trace",name:"funnelarea",basePlotModule:h("./base_plot"),categories:["pie-like","funnelarea","showLegend"],attributes:h("./attributes"),layoutAttributes:h("./layout_attributes"),supplyDefaults:h("./defaults"),supplyLayoutDefaults:h("./layout_defaults"),calc:h("./calc").calc,crossTraceCalc:h("./calc").crossTraceCalc,plot:h("./plot"),style:h("./style"),styleOne:h("../pie/style_one"),meta:{}}},{"../pie/style_one":1187,"./attributes":1060,"./base_plot":1061,"./calc":1062,"./defaults":1063,"./layout_attributes":1065,"./layout_defaults":1066,"./plot":1067,"./style":1068}],1065:[function(h,N,H){var t=h("../pie/layout_attributes").hiddenlabels;N.exports={hiddenlabels:t,funnelareacolorway:{valType:"colorlist",editType:"calc"},extendfunnelareacolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{"../pie/layout_attributes":1183}],1066:[function(h,N,H){var t=h("../../lib"),m=h("./layout_attributes");N.exports=function(g,p){function e(f,u){return t.coerce(g,p,m,f,u)}e("hiddenlabels"),e("funnelareacolorway",p.colorway),e("extendfunnelareacolors")}},{"../../lib":787,"./layout_attributes":1065}],1067:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../components/drawing"),g=h("../../lib"),p=g.strScale,e=g.strTranslate,f=h("../../lib/svg_text_utils"),u=h("../bar/plot").toMoveInsideBar,i=h("../bar/uniform_text"),s=i.recordMinTextSize,o=i.clearMinTextSize,a=h("../pie/helpers"),c=h("../pie/plot"),r=c.attachFxHandlers,n=c.determineInsideTextFont,d=c.layoutAreas,l=c.prerenderTitles,y=c.positionTitleOutside,v=c.formatSliceLabel;function _(x,T){return"l"+(T[0]-x[0])+","+(T[1]-x[1])}N.exports=function(x,T){var A=x._fullLayout;o("funnelarea",A),l(T,x),d(T,A._size),g.makeTraceGroups(A._funnelarealayer,T,"trace").each(function(S){var w=t.select(this),L=S[0],k=L.trace;(function(C){if(!C.length)return;var M=C[0],P=M.trace,O=P.aspectratio,F=P.baseratio;F>.999&&(F=.999);var j,W=Math.pow(F,2),Z=M.vTotal,Q=Z,X=Z*W/(1-W)/Z;function G(){var be,xe={x:be=Math.sqrt(X),y:-be};return[xe.x,xe.y]}var Y,K,D=[];for(D.push(G()),Y=C.length-1;Y>-1;Y--)if(!(K=C[Y]).hidden){var B=K.v/Q;X+=B,D.push(G())}var q=1/0,ee=-1/0;for(Y=0;Y<D.length;Y++)j=D[Y],q=Math.min(q,j[1]),ee=Math.max(ee,j[1]);for(Y=0;Y<D.length;Y++)D[Y][1]-=(ee+q)/2;var J=D[D.length-1][0],$=M.r,te=(ee-q)/2,ie=$/J,ae=$/te*O;for(M.r=ae*te,Y=0;Y<D.length;Y++)D[Y][0]*=ie,D[Y][1]*=ae;var he=[-(j=D[0])[0],j[1]],se=[j[0],j[1]],de=0;for(Y=C.length-1;Y>-1;Y--)if(!(K=C[Y]).hidden){var ce=D[de+=1][0],ve=D[de][1];K.TL=[-ce,ve],K.TR=[ce,ve],K.BL=he,K.BR=se,K.pxmid=(ke=K.TR,Ee=K.BR,[.5*(ke[0]+Ee[0]),.5*(ke[1]+Ee[1])]),he=K.TL,se=K.TR}var ke,Ee})(S),w.each(function(){var C=t.select(this).selectAll("g.slice").data(S);C.enter().append("g").classed("slice",!0),C.exit().remove(),C.each(function(P,O){if(P.hidden)t.select(this).selectAll("path,g").remove();else{P.pointNumber=P.i,P.curveNumber=k.index;var F=L.cx,j=L.cy,W=t.select(this),Z=W.selectAll("path.surface").data([P]);Z.enter().append("path").classed("surface",!0).style({"pointer-events":"all"}),W.call(r,x,S);var Q="M"+(F+P.TR[0])+","+(j+P.TR[1])+_(P.TR,P.BR)+_(P.BR,P.BL)+_(P.BL,P.TL)+"Z";Z.attr("d",Q),v(x,P,L);var X=a.castOption(k.textposition,P.pts),G=W.selectAll("g.slicetext").data(P.text&&X!=="none"?[0]:[]);G.enter().append("g").classed("slicetext",!0),G.exit().remove(),G.each(function(){var Y=g.ensureSingle(t.select(this),"text","",function(te){te.attr("data-notex",1)}),K=g.ensureUniformFontSize(x,n(k,P,A.font));Y.text(P.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(m.font,K).call(f.convertToTspans,x);var D,B,q,ee=m.bBox(Y.node()),J=Math.min(P.BL[1],P.BR[1])+j,$=Math.max(P.TL[1],P.TR[1])+j;B=Math.max(P.TL[0],P.BL[0])+F,q=Math.min(P.TR[0],P.BR[0])+F,(D=u(B,q,J,$,ee,{isHorizontal:!0,constrained:!0,angle:0,anchor:"middle"})).fontSize=K.size,s(k.type,D,A),S[O].transform=D,Y.attr("transform",g.getTextTransform(D))})}});var M=t.select(this).selectAll("g.titletext").data(k.title.text?[0]:[]);M.enter().append("g").classed("titletext",!0),M.exit().remove(),M.each(function(){var P=g.ensureSingle(t.select(this),"text","",function(j){j.attr("data-notex",1)}),O=k.title.text;k._meta&&(O=g.templateString(O,k._meta)),P.text(O).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(m.font,k.title.font).call(f.convertToTspans,x);var F=y(L,A._size);P.attr("transform",e(F.x,F.y)+p(Math.min(1,F.scale))+e(F.tx,F.ty))})})})}},{"../../components/drawing":672,"../../lib":787,"../../lib/svg_text_utils":813,"../bar/plot":936,"../bar/uniform_text":941,"../pie/helpers":1181,"../pie/plot":1185,"@plotly/d3":58}],1068:[function(h,N,H){var t=h("@plotly/d3"),m=h("../pie/style_one"),g=h("../bar/uniform_text").resizeText;N.exports=function(p){var e=p._fullLayout._funnelarealayer.selectAll(".trace");g(p,e,"funnelarea"),e.each(function(f){var u=f[0].trace,i=t.select(this);i.style({opacity:u.opacity}),i.selectAll("path.surface").each(function(s){t.select(this).call(m,s,u)})})}},{"../bar/uniform_text":941,"../pie/style_one":1187,"@plotly/d3":58}],1069:[function(h,N,H){var t=h("../scatter/attributes"),m=h("../../plots/attributes"),g=h("../../plots/cartesian/axis_format_attributes").axisHoverFormat,p=h("../../plots/template_attributes").hovertemplateAttrs,e=h("../../components/colorscale/attributes"),f=h("../../lib/extend").extendFlat;N.exports=f({z:{valType:"data_array",editType:"calc"},x:f({},t.x,{impliedEdits:{xtype:"array"}}),x0:f({},t.x0,{impliedEdits:{xtype:"scaled"}}),dx:f({},t.dx,{impliedEdits:{xtype:"scaled"}}),y:f({},t.y,{impliedEdits:{ytype:"array"}}),y0:f({},t.y0,{impliedEdits:{ytype:"scaled"}}),dy:f({},t.dy,{impliedEdits:{ytype:"scaled"}}),xperiod:f({},t.xperiod,{impliedEdits:{xtype:"scaled"}}),yperiod:f({},t.yperiod,{impliedEdits:{ytype:"scaled"}}),xperiod0:f({},t.xperiod0,{impliedEdits:{xtype:"scaled"}}),yperiod0:f({},t.yperiod0,{impliedEdits:{ytype:"scaled"}}),xperiodalignment:f({},t.xperiodalignment,{impliedEdits:{xtype:"scaled"}}),yperiodalignment:f({},t.yperiodalignment,{impliedEdits:{ytype:"scaled"}}),text:{valType:"data_array",editType:"calc"},hovertext:{valType:"data_array",editType:"calc"},transpose:{valType:"boolean",dflt:!1,editType:"calc"},xtype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},ytype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},zsmooth:{valType:"enumerated",values:["fast","best",!1],dflt:!1,editType:"calc"},hoverongaps:{valType:"boolean",dflt:!0,editType:"none"},connectgaps:{valType:"boolean",editType:"calc"},xgap:{valType:"number",dflt:0,min:0,editType:"plot"},ygap:{valType:"number",dflt:0,min:0,editType:"plot"},xhoverformat:g("x"),yhoverformat:g("y"),zhoverformat:g("z",1),hovertemplate:p(),showlegend:f({},m.showlegend,{dflt:!1})},{transforms:void 0},e("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../scatter/attributes":1202}],1070:[function(h,N,H){var t=h("../../registry"),m=h("../../lib"),g=h("../../plots/cartesian/axes"),p=h("../../plots/cartesian/align_period"),e=h("../histogram2d/calc"),f=h("../../components/colorscale/calc"),u=h("./convert_column_xyz"),i=h("./clean_2d_array"),s=h("./interp2d"),o=h("./find_empties"),a=h("./make_bound_array"),c=h("../../constants/numerical").BADNUM;function r(n){for(var d=[],l=n.length,y=0;y<l;y++){var v=n[y];v!==c&&d.push(v)}return d}N.exports=function(n,d){var l,y,v,_,x,T,A,S,w,L,k,C=g.getFromId(n,d.xaxis||"x"),M=g.getFromId(n,d.yaxis||"y"),P=t.traceIs(d,"contour"),O=t.traceIs(d,"histogram"),F=t.traceIs(d,"gl2d"),j=P?"best":d.zsmooth;if(C._minDtick=0,M._minDtick=0,O)_=(k=e(n,d)).orig_x,l=k.x,y=k.x0,v=k.dx,S=k.orig_y,x=k.y,T=k.y0,A=k.dy,w=k.z;else{var W=d.z;m.isArray1D(W)?(u(d,C,M,"x","y",["z"]),l=d._x,x=d._y,W=d._z):(_=d.x?C.makeCalcdata(d,"x"):[],S=d.y?M.makeCalcdata(d,"y"):[],l=p(d,C,"x",_).vals,x=p(d,M,"y",S).vals,d._x=l,d._y=x),y=d.x0,v=d.dx,T=d.y0,A=d.dy,w=i(W,d,C,M)}function Z(te){j=d._input.zsmooth=d.zsmooth=!1,m.warn('cannot use zsmooth: "fast": '+te)}if((C.rangebreaks||M.rangebreaks)&&(w=function(te,ie,ae){for(var he=[],se=-1,de=0;de<ae.length;de++)if(ie[de]!==c){se++,he[se]=[];for(var ce=0;ce<ae[de].length;ce++)te[ce]!==c&&he[se].push(ae[de][ce])}return he}(l,x,w),O||(l=r(l),x=r(x),d._x=l,d._y=x)),O||!P&&!d.connectgaps||(d._emptypoints=o(w),s(w,d._emptypoints)),j==="fast"){if(C.type==="log"||M.type==="log")Z("log axis found");else if(!O){if(l.length){var Q=(l[l.length-1]-l[0])/(l.length-1),X=Math.abs(Q/100);for(L=0;L<l.length-1;L++)if(Math.abs(l[L+1]-l[L]-Q)>X){Z("x scale is not linear");break}}if(x.length&&j==="fast"){var G=(x[x.length-1]-x[0])/(x.length-1),Y=Math.abs(G/100);for(L=0;L<x.length-1;L++)if(Math.abs(x[L+1]-x[L]-G)>Y){Z("y scale is not linear");break}}}}var K=m.maxRowLength(w),D=d.xtype==="scaled"?"":l,B=a(d,D,y,v,K,C),q=d.ytype==="scaled"?"":x,ee=a(d,q,T,A,w.length,M);F||(d._extremes[C._id]=g.findExtremes(C,B),d._extremes[M._id]=g.findExtremes(M,ee));var J={x:B,y:ee,z:w,text:d._text||d.text,hovertext:d._hovertext||d.hovertext};if(d.xperiodalignment&&_&&(J.orig_x=_),d.yperiodalignment&&S&&(J.orig_y=S),D&&D.length===B.length-1&&(J.xCenter=D),q&&q.length===ee.length-1&&(J.yCenter=q),O&&(J.xRanges=k.xRanges,J.yRanges=k.yRanges,J.pts=k.pts),P||f(n,d,{vals:w,cLetter:"z"}),P&&d.contours&&d.contours.coloring==="heatmap"){var $={type:d.type==="contour"?"heatmap":"histogram2d",xcalendar:d.xcalendar,ycalendar:d.ycalendar};J.xfill=a($,D,y,v,K,C),J.yfill=a($,q,T,A,w.length,M)}return[J]}},{"../../components/colorscale/calc":658,"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/align_period":835,"../../plots/cartesian/axes":838,"../../registry":915,"../histogram2d/calc":1102,"./clean_2d_array":1071,"./convert_column_xyz":1073,"./find_empties":1075,"./interp2d":1078,"./make_bound_array":1079}],1071:[function(h,N,H){var t=h("fast-isnumeric"),m=h("../../lib"),g=h("../../constants/numerical").BADNUM;N.exports=function(p,e,f,u){var i,s,o,a,c,r;function n(x){if(t(x))return+x}if(e&&e.transpose){for(i=0,c=0;c<p.length;c++)i=Math.max(i,p[c].length);if(i===0)return!1;o=function(x){return x.length},a=function(x,T,A){return(x[A]||[])[T]}}else i=p.length,o=function(x,T){return x[T].length},a=function(x,T,A){return(x[T]||[])[A]};var d=function(x,T,A){return T===g||A===g?g:a(x,T,A)};function l(x){if(e&&e.type!=="carpet"&&e.type!=="contourcarpet"&&x&&x.type==="category"&&e["_"+x._id.charAt(0)].length){var T=x._id.charAt(0),A={},S=e["_"+T+"CategoryMap"]||e[T];for(c=0;c<S.length;c++)A[S[c]]=c;return function(w){var L=A[x._categories[w]];return L+1?L:g}}return m.identity}var y=l(f),v=l(u);u&&u.type==="category"&&(i=u._categories.length);var _=new Array(i);for(c=0;c<i;c++)for(s=f&&f.type==="category"?f._categories.length:o(p,c),_[c]=new Array(s),r=0;r<s;r++)_[c][r]=n(d(p,v(c),y(r)));return _}},{"../../constants/numerical":763,"../../lib":787,"fast-isnumeric":246}],1072:[function(h,N,H){N.exports={min:"zmin",max:"zmax"}},{}],1073:[function(h,N,H){var t=h("../../lib"),m=h("../../constants/numerical").BADNUM,g=h("../../plots/cartesian/align_period");N.exports=function(p,e,f,u,i,s){var o=p._length,a=e.makeCalcdata(p,u),c=f.makeCalcdata(p,i);a=g(p,e,u,a).vals,c=g(p,f,i,c).vals;var r,n,d,l,y=p.text,v=y!==void 0&&t.isArray1D(y),_=p.hovertext,x=_!==void 0&&t.isArray1D(_),T=t.distinctVals(a),A=T.vals,S=t.distinctVals(c),w=S.vals,L=[],k=w.length,C=A.length;for(r=0;r<s.length;r++)L[r]=t.init2dArray(k,C);v&&(d=t.init2dArray(k,C)),x&&(l=t.init2dArray(k,C));var M=t.init2dArray(k,C);for(r=0;r<o;r++)if(a[r]!==m&&c[r]!==m){var P=t.findBin(a[r]+T.minDiff/2,A),O=t.findBin(c[r]+S.minDiff/2,w);for(n=0;n<s.length;n++){var F=p[s[n]];L[n][O][P]=F[r],M[O][P]=r}v&&(d[O][P]=y[r]),x&&(l[O][P]=_[r])}for(p["_"+u]=A,p["_"+i]=w,n=0;n<s.length;n++)p["_"+s[n]]=L[n];v&&(p._text=d),x&&(p._hovertext=l),e&&e.type==="category"&&(p["_"+u+"CategoryMap"]=A.map(function(j){return e._categories[j]})),f&&f.type==="category"&&(p["_"+i+"CategoryMap"]=w.map(function(j){return f._categories[j]})),p._after2before=M}},{"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/align_period":835}],1074:[function(h,N,H){var t=h("../../lib"),m=h("./xyz_defaults"),g=h("../scatter/period_defaults"),p=h("./style_defaults"),e=h("../../components/colorscale/defaults"),f=h("./attributes");N.exports=function(u,i,s,o){function a(c,r){return t.coerce(u,i,f,c,r)}m(u,i,a,o)?(g(u,i,o,a),a("xhoverformat"),a("yhoverformat"),a("text"),a("hovertext"),a("hovertemplate"),p(u,i,a,o),a("hoverongaps"),a("connectgaps",t.isArray1D(i.z)&&i.zsmooth!==!1),e(u,i,o,a,{prefix:"",cLetter:"z"})):i.visible=!1}},{"../../components/colorscale/defaults":660,"../../lib":787,"../scatter/period_defaults":1222,"./attributes":1069,"./style_defaults":1082,"./xyz_defaults":1083}],1075:[function(h,N,H){var t=h("../../lib").maxRowLength;N.exports=function(m){var g,p,e,f,u,i,s,o,a=[],c={},r=[],n=m[0],d=[],l=[0,0,0],y=t(m);for(p=0;p<m.length;p++)for(g=d,d=n,n=m[p+1]||[],e=0;e<y;e++)d[e]===void 0&&((i=(d[e-1]!==void 0?1:0)+(d[e+1]!==void 0?1:0)+(g[e]!==void 0?1:0)+(n[e]!==void 0?1:0))?(p===0&&i++,e===0&&i++,p===m.length-1&&i++,e===d.length-1&&i++,i<4&&(c[[p,e]]=[p,e,i]),a.push([p,e,i])):r.push([p,e]));for(;r.length;){for(s={},o=!1,u=r.length-1;u>=0;u--)(i=((c[[(p=(f=r[u])[0])-1,e=f[1]]]||l)[2]+(c[[p+1,e]]||l)[2]+(c[[p,e-1]]||l)[2]+(c[[p,e+1]]||l)[2])/20)&&(s[f]=[p,e,i],r.splice(u,1),o=!0);if(!o)throw"findEmpties iterated with no new neighbors";for(f in s)c[f]=s[f],a.push(s[f])}return a.sort(function(v,_){return _[2]-v[2]})}},{"../../lib":787}],1076:[function(h,N,H){var t=h("../../components/fx"),m=h("../../lib"),g=h("../../plots/cartesian/axes"),p=h("../../components/colorscale").extractOpts;N.exports=function(e,f,u,i,s){s||(s={});var o,a,c,r,n=s.isContour,d=e.cd[0],l=d.trace,y=e.xa,v=e.ya,_=d.x,x=d.y,T=d.z,A=d.xCenter,S=d.yCenter,w=d.zmask,L=l.zhoverformat,k=_,C=x;if(e.index!==!1){try{c=Math.round(e.index[1]),r=Math.round(e.index[0])}catch(D){return void m.error("Error hovering on heatmap, pointNumber must be [row,col], found:",e.index)}if(c<0||c>=T[0].length||r<0||r>T.length)return}else{if(t.inbox(f-_[0],f-_[_.length-1],0)>0||t.inbox(u-x[0],u-x[x.length-1],0)>0)return;if(n){var M;for(k=[2*_[0]-_[1]],M=1;M<_.length;M++)k.push((_[M]+_[M-1])/2);for(k.push([2*_[_.length-1]-_[_.length-2]]),C=[2*x[0]-x[1]],M=1;M<x.length;M++)C.push((x[M]+x[M-1])/2);C.push([2*x[x.length-1]-x[x.length-2]])}c=Math.max(0,Math.min(k.length-2,m.findBin(f,k))),r=Math.max(0,Math.min(C.length-2,m.findBin(u,C)))}var P,O,F=y.c2p(_[c]),j=y.c2p(_[c+1]),W=v.c2p(x[r]),Z=v.c2p(x[r+1]);n?(P=d.orig_x||_,O=d.orig_y||x,j=F,o=P[c],Z=W,a=O[r]):(P=d.orig_x||A||_,O=d.orig_y||S||x,o=A?P[c]:(P[c]+P[c+1])/2,a=S?O[r]:(O[r]+O[r+1])/2,y&&y.type==="category"&&(o=_[c]),v&&v.type==="category"&&(a=x[r]),l.zsmooth&&(F=j=y.c2p(o),W=Z=v.c2p(a)));var Q=T[r][c];if(w&&!w[r][c]&&(Q=void 0),Q!==void 0||l.hoverongaps){var X;Array.isArray(d.hovertext)&&Array.isArray(d.hovertext[r])?X=d.hovertext[r][c]:Array.isArray(d.text)&&Array.isArray(d.text[r])&&(X=d.text[r][c]);var G=p(l),Y={type:"linear",range:[G.min,G.max],hoverformat:L,_separators:y._separators,_numFormat:y._numFormat},K=g.tickText(Y,Q,"hover").text;return[m.extendFlat(e,{index:l._after2before?l._after2before[r][c]:[r,c],distance:e.maxHoverDistance,spikeDistance:e.maxSpikeDistance,x0:F,x1:j,y0:W,y1:Z,xLabelVal:o,yLabelVal:a,zLabelVal:Q,zLabel:K,text:X})]}}},{"../../components/colorscale":662,"../../components/fx":690,"../../lib":787,"../../plots/cartesian/axes":838}],1077:[function(h,N,H){N.exports={attributes:h("./attributes"),supplyDefaults:h("./defaults"),calc:h("./calc"),plot:h("./plot"),colorbar:h("./colorbar"),style:h("./style"),hoverPoints:h("./hover"),moduleType:"trace",name:"heatmap",basePlotModule:h("../../plots/cartesian"),categories:["cartesian","svg","2dMap","showLegend"],meta:{}}},{"../../plots/cartesian":852,"./attributes":1069,"./calc":1070,"./colorbar":1072,"./defaults":1074,"./hover":1076,"./plot":1080,"./style":1081}],1078:[function(h,N,H){var t=h("../../lib"),m=[[-1,0],[1,0],[0,-1],[0,1]];function g(e){return .5-.25*Math.min(1,.5*e)}function p(e,f,u){var i,s,o,a,c,r,n,d,l,y,v,_,x,T=0;for(a=0;a<f.length;a++){for(s=(i=f[a])[0],o=i[1],v=e[s][o],y=0,l=0,c=0;c<4;c++)(n=e[s+(r=m[c])[0]])&&(d=n[o+r[1]])!==void 0&&(y===0?_=x=d:(_=Math.min(_,d),x=Math.max(x,d)),l++,y+=d);if(l===0)throw"iterateInterp2d order is wrong: no defined neighbors";e[s][o]=y/l,v===void 0?l<4&&(T=1):(e[s][o]=(1+u)*e[s][o]-u*v,x>_&&(T=Math.max(T,Math.abs(e[s][o]-v)/(x-_))))}return T}N.exports=function(e,f){var u,i=1;for(p(e,f),u=0;u<f.length&&!(f[u][2]<4);u++);for(f=f.slice(u),u=0;u<100&&i>.01;u++)i=p(e,f,g(i));return i>.01&&t.log("interp2d didn't converge quickly",i),e}},{"../../lib":787}],1079:[function(h,N,H){var t=h("../../registry"),m=h("../../lib").isArrayOrTypedArray;N.exports=function(g,p,e,f,u,i){var s,o,a,c=[],r=t.traceIs(g,"contour"),n=t.traceIs(g,"histogram"),d=t.traceIs(g,"gl2d");if(m(p)&&p.length>1&&!n&&i.type!=="category"){var l=p.length;if(!(l<=u))return r?p.slice(0,u):p.slice(0,u+1);if(r||d)c=p.slice(0,u);else if(u===1)c=[p[0]-.5,p[0]+.5];else{for(c=[1.5*p[0]-.5*p[1]],a=1;a<l;a++)c.push(.5*(p[a-1]+p[a]));c.push(1.5*p[l-1]-.5*p[l-2])}if(l<u){var y=c[c.length-1],v=y-c[c.length-2];for(a=l;a<u;a++)y+=v,c.push(y)}}else{var _=g[i._id.charAt(0)+"calendar"];for(n?s=i.r2c(e,0,_):m(p)&&p.length===1?s=p[0]:e===void 0?s=0:s=(i.type==="log"?i.d2c:i.r2c)(e,0,_),o=f||1,a=r||d?0:-.5;a<u;a++)c.push(s+o*a)}return c}},{"../../lib":787,"../../registry":915}],1080:[function(h,N,H){var t=h("@plotly/d3"),m=h("tinycolor2"),g=h("../../registry"),p=h("../../lib"),e=h("../../components/colorscale").makeColorScaleFuncFromTrace,f=h("../../constants/xmlns_namespaces");function u(o,a){var c=a.length-2,r=p.constrain(p.findBin(o,a),0,c),n=a[r],d=a[r+1],l=p.constrain(r+(o-n)/(d-n)-.5,0,c),y=Math.round(l),v=Math.abs(l-y);return l&&l!==c&&v?{bin0:y,frac:v,bin1:Math.round(y+v/(l-y))}:{bin0:y,bin1:y,frac:0}}function i(o,a){var c=a.length-1,r=p.constrain(p.findBin(o,a),0,c),n=a[r],d=(o-n)/(a[r+1]-n)||0;return d<=0?{bin0:r,bin1:r,frac:0}:d<.5?{bin0:r,bin1:r+1,frac:d}:{bin0:r+1,bin1:r,frac:1-d}}function s(o,a,c){o[a]=c[0],o[a+1]=c[1],o[a+2]=c[2],o[a+3]=Math.round(255*c[3])}N.exports=function(o,a,c,r){var n=a.xaxis,d=a.yaxis;p.makeTraceGroups(r,c,"hm").each(function(l){var y,v,_,x,T,A,S=t.select(this),w=l[0],L=w.trace,k=w.z,C=w.x,M=w.y,P=w.xCenter,O=w.yCenter,F=g.traceIs(L,"contour"),j=F?"best":L.zsmooth,W=k.length,Z=p.maxRowLength(k),Q=!1,X=!1;for(A=0;y===void 0&&A<C.length-1;)y=n.c2p(C[A]),A++;for(A=C.length-1;v===void 0&&A>0;)v=n.c2p(C[A]),A--;for(v<y&&(_=v,v=y,y=_,Q=!0),A=0;x===void 0&&A<M.length-1;)x=d.c2p(M[A]),A++;for(A=M.length-1;T===void 0&&A>0;)T=d.c2p(M[A]),A--;if(T<x&&(_=x,x=T,T=_,X=!0),F&&(P=C,O=M,C=w.xfill,M=w.yfill),j!=="fast"){var G=j==="best"?0:.5;y=Math.max(-G*n._length,y),v=Math.min((1+G)*n._length,v),x=Math.max(-G*d._length,x),T=Math.min((1+G)*d._length,T)}var Y=Math.round(v-y),K=Math.round(T-x);if(Y<=0||K<=0)S.selectAll("image").data([]).exit().remove();else{var D,B;j==="fast"?(D=Z,B=W):(D=Y,B=K);var q=document.createElement("canvas");q.width=D,q.height=B;var ee,J,$=q.getContext("2d"),te=e(L,{noNumericCheck:!0,returnArray:!0});j==="fast"?(ee=Q?function(Be){return Z-1-Be}:p.identity,J=X?function(Be){return W-1-Be}:p.identity):(ee=function(Be){return p.constrain(Math.round(n.c2p(C[Be])-y),0,Y)},J=function(Be){return p.constrain(Math.round(d.c2p(M[Be])-x),0,K)});var ie,ae,he,se,de,ce=J(0),ve=[ce,ce],ke=Q?0:1,Ee=X?0:1,be=0,xe=0,ue=0,me=0;if(j){var we,Me=0;try{we=new Uint8Array(Y*K*4)}catch(Be){we=new Array(Y*K*4)}if(j==="best"){var Se,De,Fe,Ye=P||C,et=O||M,Oe=new Array(Ye.length),je=new Array(et.length),We=new Array(Y),Ge=P?i:u,Qe=O?i:u;for(A=0;A<Ye.length;A++)Oe[A]=Math.round(n.c2p(Ye[A])-y);for(A=0;A<et.length;A++)je[A]=Math.round(d.c2p(et[A])-x);for(A=0;A<Y;A++)We[A]=Ge(A,Oe);for(ae=0;ae<K;ae++)for(De=k[(Se=Qe(ae,je)).bin0],Fe=k[Se.bin1],A=0;A<Y;A++,Me+=4)s(we,Me,de=He(De,Fe,We[A],Se))}else for(ae=0;ae<W;ae++)for(se=k[ae],ve=J(ae),A=0;A<Y;A++)de=Ue(se[A],1),s(we,Me=4*(ve*Y+ee(A)),de);var it=$.createImageData(Y,K);try{it.data.set(we)}catch(Be){var lt=it.data,Lt=lt.length;for(ae=0;ae<Lt;ae++)lt[ae]=we[ae]}$.putImageData(it,0,0)}else{var wt=L.xgap,rt=L.ygap,$e=Math.floor(wt/2),xt=Math.floor(rt/2);for(ae=0;ae<W;ae++)if(se=k[ae],ve.reverse(),ve[Ee]=J(ae+1),ve[0]!==ve[1]&&ve[0]!==void 0&&ve[1]!==void 0)for(ie=[he=ee(0),he],A=0;A<Z;A++)ie.reverse(),ie[ke]=ee(A+1),ie[0]!==ie[1]&&ie[0]!==void 0&&ie[1]!==void 0&&(de=Ue(se[A],(ie[1]-ie[0])*(ve[1]-ve[0])),$.fillStyle="rgba("+de.join(",")+")",$.fillRect(ie[0]+$e,ve[0]+xt,ie[1]-ie[0]-wt,ve[1]-ve[0]-rt))}xe=Math.round(xe/be),ue=Math.round(ue/be),me=Math.round(me/be);var Qt=m("rgb("+xe+","+ue+","+me+")");o._hmpixcount=(o._hmpixcount||0)+be,o._hmlumcount=(o._hmlumcount||0)+be*Qt.getLuminance();var $t=S.selectAll("image").data(l);$t.enter().append("svg:image").attr({xmlns:f.svg,preserveAspectRatio:"none"}),$t.attr({height:K,width:Y,x:y,y:x,"xlink:href":q.toDataURL("image/png")})}function Ue(Be,Je){if(Be!==void 0){var _e=te(Be);return _e[0]=Math.round(_e[0]),_e[1]=Math.round(_e[1]),_e[2]=Math.round(_e[2]),be+=Je,xe+=_e[0]*Je,ue+=_e[1]*Je,me+=_e[2]*Je,_e}return[0,0,0,0]}function He(Be,Je,_e,Le){var Ce=Be[_e.bin0];if(Ce===void 0)return Ue(void 0,1);var Pe,Xe=Be[_e.bin1],ut=Je[_e.bin0],kt=Je[_e.bin1],ft=Xe-Ce||0,Et=ut-Ce||0;return Pe=Xe===void 0?kt===void 0?0:ut===void 0?2*(kt-Ce):2*(2*kt-ut-Ce)/3:kt===void 0?ut===void 0?0:2*(2*Ce-Xe-ut)/3:ut===void 0?2*(2*kt-Xe-Ce)/3:kt+Ce-Xe-ut,Ue(Ce+_e.frac*ft+Le.frac*(Et+_e.frac*Pe))}})}},{"../../components/colorscale":662,"../../constants/xmlns_namespaces":764,"../../lib":787,"../../registry":915,"@plotly/d3":58,tinycolor2:583}],1081:[function(h,N,H){var t=h("@plotly/d3");N.exports=function(m){t.select(m).selectAll(".hm image").style("opacity",function(g){return g.trace.opacity})}},{"@plotly/d3":58}],1082:[function(h,N,H){N.exports=function(t,m,g){g("zsmooth")===!1&&(g("xgap"),g("ygap")),g("zhoverformat")}},{}],1083:[function(h,N,H){var t=h("fast-isnumeric"),m=h("../../lib"),g=h("../../registry");function p(e,f){var u=f(e);return(u?f(e+"type","array"):"scaled")==="scaled"&&(f(e+"0"),f("d"+e)),u}N.exports=function(e,f,u,i,s,o){var a,c,r=u("z");if(s=s||"x",o=o||"y",r===void 0||!r.length)return 0;if(m.isArray1D(e.z)){a=u(s),c=u(o);var n=m.minRowLength(a),d=m.minRowLength(c);if(n===0||d===0)return 0;f._length=Math.min(n,d,r.length)}else{if(a=p(s,u),c=p(o,u),!function(l){for(var y,v=!0,_=!1,x=!1,T=0;T<l.length;T++){if(y=l[T],!m.isArrayOrTypedArray(y)){v=!1;break}y.length>0&&(_=!0);for(var A=0;A<y.length;A++)if(t(y[A])){x=!0;break}}return v&&_&&x}(r))return 0;u("transpose"),f._length=null}return e.type==="heatmapgl"||g.getComponentMethod("calendars","handleTraceDefaults")(e,f,[s,o],i),!0}},{"../../lib":787,"../../registry":915,"fast-isnumeric":246}],1084:[function(h,N,H){for(var t=h("../heatmap/attributes"),m=h("../../components/colorscale/attributes"),g=h("../../lib/extend").extendFlat,p=h("../../plot_api/edit_types").overrideAll,e=["z","x","x0","dx","y","y0","dy","text","transpose","xtype","ytype"],f={},u=0;u<e.length;u++){var i=e[u];f[i]=t[i]}f.zsmooth={valType:"enumerated",values:["fast",!1],dflt:"fast",editType:"calc"},g(f,m("",{cLetter:"z",autoColorDflt:!1})),N.exports=p(f,"calc","nested")},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plot_api/edit_types":820,"../heatmap/attributes":1069}],1085:[function(h,N,H){var t=h("gl-heatmap2d"),m=h("../../plots/cartesian/axes"),g=h("../../lib/str2rgbarray");function p(f,u){this.scene=f,this.uid=u,this.type="heatmapgl",this.name="",this.hoverinfo="all",this.xData=[],this.yData=[],this.zData=[],this.textLabels=[],this.idToIndex=[],this.bounds=[0,0,0,0],this.options={zsmooth:"fast",z:[],x:[],y:[],shape:[0,0],colorLevels:[0],colorValues:[0,0,0,1]},this.heatmap=t(f.glplot,this.options),this.heatmap._trace=this}var e=p.prototype;e.handlePick=function(f){var u=this.options,i=u.shape,s=f.pointId,o=s%i[0],a=Math.floor(s/i[0]),c=s;return{trace:this,dataCoord:f.dataCoord,traceCoord:[u.x[o],u.y[a],u.z[c]],textLabel:this.textLabels[s],name:this.name,pointIndex:[a,o],hoverinfo:this.hoverinfo}},e.update=function(f,u){var i=u[0];this.index=f.index,this.name=f.name,this.hoverinfo=f.hoverinfo;var s=i.z;this.options.z=[].concat.apply([],s);var o=s[0].length,a=s.length;this.options.shape=[o,a],this.options.x=i.x,this.options.y=i.y,this.options.zsmooth=f.zsmooth;var c=function(y){for(var v=y.colorscale,_=y.zmin,x=y.zmax,T=v.length,A=new Array(T),S=new Array(4*T),w=0;w<T;w++){var L=v[w],k=g(L[1]);A[w]=_+L[0]*(x-_);for(var C=0;C<4;C++)S[4*w+C]=k[C]}return{colorLevels:A,colorValues:S}}(f);this.options.colorLevels=c.colorLevels,this.options.colorValues=c.colorValues,this.textLabels=[].concat.apply([],f.text),this.heatmap.update(this.options);var r,n,d=this.scene.xaxis,l=this.scene.yaxis;f.zsmooth===!1&&(r={ppad:i.x[1]-i.x[0]},n={ppad:i.y[1]-i.y[0]}),f._extremes[d._id]=m.findExtremes(d,i.x,r),f._extremes[l._id]=m.findExtremes(l,i.y,n)},e.dispose=function(){this.heatmap.dispose()},N.exports=function(f,u,i){var s=new p(f,u.uid);return s.update(u,i),s}},{"../../lib/str2rgbarray":812,"../../plots/cartesian/axes":838,"gl-heatmap2d":272}],1086:[function(h,N,H){var t=h("../../lib"),m=h("../heatmap/xyz_defaults"),g=h("../../components/colorscale/defaults"),p=h("./attributes");N.exports=function(e,f,u,i){function s(o,a){return t.coerce(e,f,p,o,a)}m(e,f,s,i)?(s("text"),s("zsmooth"),g(e,f,i,s,{prefix:"",cLetter:"z"})):f.visible=!1}},{"../../components/colorscale/defaults":660,"../../lib":787,"../heatmap/xyz_defaults":1083,"./attributes":1084}],1087:[function(h,N,H){N.exports={attributes:h("./attributes"),supplyDefaults:h("./defaults"),colorbar:h("../heatmap/colorbar"),calc:h("../heatmap/calc"),plot:h("./convert"),moduleType:"trace",name:"heatmapgl",basePlotModule:h("../../plots/gl2d"),categories:["gl","gl2d","2dMap"],meta:{}}},{"../../plots/gl2d":878,"../heatmap/calc":1070,"../heatmap/colorbar":1072,"./attributes":1084,"./convert":1085,"./defaults":1086}],1088:[function(h,N,H){var t=h("../bar/attributes"),m=h("../../plots/cartesian/axis_format_attributes").axisHoverFormat,g=h("../../plots/template_attributes").hovertemplateAttrs,p=h("./bin_attributes"),e=h("./constants"),f=h("../../lib/extend").extendFlat;N.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},xhoverformat:m("x"),yhoverformat:m("y"),text:f({},t.text,{}),hovertext:f({},t.hovertext,{}),orientation:t.orientation,histfunc:{valType:"enumerated",values:["count","sum","avg","min","max"],dflt:"count",editType:"calc"},histnorm:{valType:"enumerated",values:["","percent","probability","density","probability density"],dflt:"",editType:"calc"},cumulative:{enabled:{valType:"boolean",dflt:!1,editType:"calc"},direction:{valType:"enumerated",values:["increasing","decreasing"],dflt:"increasing",editType:"calc"},currentbin:{valType:"enumerated",values:["include","exclude","half"],dflt:"include",editType:"calc"},editType:"calc"},nbinsx:{valType:"integer",min:0,dflt:0,editType:"calc"},xbins:p("x",!0),nbinsy:{valType:"integer",min:0,dflt:0,editType:"calc"},ybins:p("y",!0),autobinx:{valType:"boolean",dflt:null,editType:"calc"},autobiny:{valType:"boolean",dflt:null,editType:"calc"},bingroup:{valType:"string",dflt:"",editType:"calc"},hovertemplate:g({},{keys:e.eventDataKeys}),marker:t.marker,offsetgroup:t.offsetgroup,alignmentgroup:t.alignmentgroup,selected:t.selected,unselected:t.unselected,_deprecated:{bardir:t._deprecated.bardir}}},{"../../lib/extend":777,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../bar/attributes":925,"./bin_attributes":1090,"./constants":1094}],1089:[function(h,N,H){N.exports=function(t,m){for(var g=t.length,p=0,e=0;e<g;e++)m[e]?(t[e]/=m[e],p+=t[e]):t[e]=null;return p}},{}],1090:[function(h,N,H){N.exports=function(t,m){return{start:{valType:"any",editType:"calc"},end:{valType:"any",editType:"calc"},size:{valType:"any",editType:"calc"},editType:"calc"}}},{}],1091:[function(h,N,H){var t=h("fast-isnumeric");N.exports={count:function(m,g,p){return p[m]++,1},sum:function(m,g,p,e){var f=e[g];return t(f)?(f=Number(f),p[m]+=f,f):0},avg:function(m,g,p,e,f){var u=e[g];return t(u)&&(u=Number(u),p[m]+=u,f[m]++),0},min:function(m,g,p,e){var f=e[g];if(t(f)){if(f=Number(f),!t(p[m]))return p[m]=f,f;if(p[m]>f){var u=f-p[m];return p[m]=f,u}}return 0},max:function(m,g,p,e){var f=e[g];if(t(f)){if(f=Number(f),!t(p[m]))return p[m]=f,f;if(p[m]<f){var u=f-p[m];return p[m]=f,u}}return 0}}},{"fast-isnumeric":246}],1092:[function(h,N,H){var t=h("../../constants/numerical"),m=t.ONEAVGYEAR,g=t.ONEAVGMONTH,p=t.ONEDAY,e=t.ONEHOUR,f=t.ONEMIN,u=t.ONESEC,i=h("../../plots/cartesian/axes").tickIncrement;function s(r,n,d,l){if(r*n<=0)return 1/0;for(var y=Math.abs(n-r),v=d.type==="date",_=o(y,v),x=0;x<10;x++){var T=o(80*_,v);if(_===T||!a(T,r,n,v,d,l))break;_=T}return _}function o(r,n){return n&&r>u?r>p?r>1.1*m?m:r>1.1*g?g:p:r>e?e:r>f?f:u:Math.pow(10,Math.floor(Math.log(r)/Math.LN10))}function a(r,n,d,l,y,v){if(l&&r>p){var _=c(n,y,v),x=c(d,y,v),T=r===m?0:1;return _[T]!==x[T]}return Math.floor(d/r)-Math.floor(n/r)>.1}function c(r,n,d){var l=n.c2d(r,m,d).split("-");return l[0]===""&&(l.unshift(),l[0]="-"+l[0]),l}N.exports=function(r,n,d,l,y){var v,_,x=-1.1*n,T=-.1*n,A=r-T,S=d[0],w=d[1],L=Math.min(s(S+T,S+A,l,y),s(w+T,w+A,l,y)),k=Math.min(s(S+x,S+T,l,y),s(w+x,w+T,l,y));if(L>k&&k<Math.abs(w-S)/4e3?(v=L,_=!1):(v=Math.min(L,k),_=!0),l.type==="date"&&v>p){var C=v===m?1:6,M=v===m?"M12":"M1";return function(P,O){var F=l.c2d(P,m,y),j=F.indexOf("-",C);j>0&&(F=F.substr(0,j));var W=l.d2c(F,0,y);if(W<P){var Z=i(W,M,!1,y);(W+Z)/2<P+r&&(W=Z)}return O&&_?i(W,M,!0,y):W}}return function(P,O){var F=v*Math.round(P/v);return F+v/10<P&&F+.9*v<P+r&&(F+=v),O&&_&&(F-=v),F}}},{"../../constants/numerical":763,"../../plots/cartesian/axes":838}],1093:[function(h,N,H){var t=h("fast-isnumeric"),m=h("../../lib"),g=h("../../registry"),p=h("../../plots/cartesian/axes"),e=h("../bar/arrays_to_calcdata"),f=h("./bin_functions"),u=h("./norm_functions"),i=h("./average"),s=h("./bin_label_vals");function o(a,c,r,n,d){var l,y,v,_,x,T,A,S=n+"bins",w=a._fullLayout,L=c["_"+n+"bingroup"],k=w._histogramBinOpts[L],C=w.barmode==="overlay",M=function(ce){return r.r2c(ce,0,_)},P=function(ce){return r.c2r(ce,0,_)},O=r.type==="date"?function(ce){return ce||ce===0?m.cleanDate(ce,null,_):null}:function(ce){return t(ce)?Number(ce):null};function F(ce,ve,ke){ve[ce+"Found"]?(ve[ce]=O(ve[ce]),ve[ce]===null&&(ve[ce]=ke[ce])):(T[ce]=ve[ce]=ke[ce],m.nestedProperty(y[0],S+"."+ce).set(ke[ce]))}if(c["_"+n+"autoBinFinished"])delete c["_"+n+"autoBinFinished"];else{y=k.traces;var j=[],W=!0,Z=!1,Q=!1;for(l=0;l<y.length;l++)if((v=y[l]).visible){var X=k.dirs[l];x=v["_"+X+"pos0"]=r.makeCalcdata(v,X),j=m.concat(j,x),delete v["_"+n+"autoBinFinished"],c.visible===!0&&(W?W=!1:(delete v._autoBin,v["_"+n+"autoBinFinished"]=1),g.traceIs(v,"2dMap")&&(Z=!0),v.type==="histogram2dcontour"&&(Q=!0))}_=y[0][n+"calendar"];var G=p.autoBin(j,r,k.nbins,Z,_,k.sizeFound&&k.size),Y=y[0]._autoBin={};if(T=Y[k.dirs[0]]={},Q&&(k.size||(G.start=P(p.tickIncrement(M(G.start),G.size,!0,_))),k.end===void 0&&(G.end=P(p.tickIncrement(M(G.end),G.size,!1,_)))),C&&!g.traceIs(c,"2dMap")&&G._dataSpan===0&&r.type!=="category"&&r.type!=="multicategory"){if(d)return[G,x,!0];G=function(ce,ve,ke,Ee,be){var xe,ue,me,we=ce._fullLayout,Me=function(lt,Lt){for(var wt=Lt.xaxis,rt=Lt.yaxis,$e=Lt.orientation,xt=[],Qt=lt._fullData,$t=0;$t<Qt.length;$t++){var Ue=Qt[$t];Ue.type==="histogram"&&Ue.visible===!0&&Ue.orientation===$e&&Ue.xaxis===wt&&Ue.yaxis===rt&&xt.push(Ue)}return xt}(ce,ve),Se=!1,De=1/0,Fe=[ve];for(xe=0;xe<Me.length;xe++)if((ue=Me[xe])===ve)Se=!0;else if(Se){var Ye=o(ce,ue,ke,Ee,!0),et=Ye[0],Oe=Ye[2];ue["_"+Ee+"autoBinFinished"]=1,ue["_"+Ee+"pos0"]=Ye[1],Oe?Fe.push(ue):De=Math.min(De,et.size)}else me=we._histogramBinOpts[ue["_"+Ee+"bingroup"]],De=Math.min(De,me.size||ue[be].size);var je=new Array(Fe.length);for(xe=0;xe<Fe.length;xe++)for(var We=Fe[xe]["_"+Ee+"pos0"],Ge=0;Ge<We.length;Ge++)if(We[Ge]!==void 0){je[xe]=We[Ge];break}for(isFinite(De)||(De=m.distinctVals(je).minDiff),xe=0;xe<Fe.length;xe++){var Qe=(ue=Fe[xe])[Ee+"calendar"],it={start:ke.c2r(je[xe]-De/2,0,Qe),end:ke.c2r(je[xe]+De/2,0,Qe),size:De};ue._input[be]=ue[be]=it,(me=we._histogramBinOpts[ue["_"+Ee+"bingroup"]])&&m.extendFlat(me,it)}return ve[be]}(a,c,r,n,S)}(A=v.cumulative||{}).enabled&&A.currentbin!=="include"&&(A.direction==="decreasing"?G.start=P(p.tickIncrement(M(G.start),G.size,!0,_)):G.end=P(p.tickIncrement(M(G.end),G.size,!1,_))),k.size=G.size,k.sizeFound||(T.size=G.size,m.nestedProperty(y[0],S+".size").set(G.size)),F("start",k,G),F("end",k,G)}x=c["_"+n+"pos0"],delete c["_"+n+"pos0"];var K=c._input[S]||{},D=m.extendFlat({},k),B=k.start,q=r.r2l(K.start),ee=q!==void 0;if((k.startFound||ee)&&q!==r.r2l(B)){var J=ee?q:m.aggNums(Math.min,null,x),$={type:r.type==="category"||r.type==="multicategory"?"linear":r.type,r2l:r.r2l,dtick:k.size,tick0:B,calendar:_,range:[J,p.tickIncrement(J,k.size,!1,_)].map(r.l2r)},te=p.tickFirst($);te>r.r2l(J)&&(te=p.tickIncrement(te,k.size,!0,_)),D.start=r.l2r(te),ee||m.nestedProperty(c,S+".start").set(D.start)}var ie=k.end,ae=r.r2l(K.end),he=ae!==void 0;if((k.endFound||he)&&ae!==r.r2l(ie)){var se=he?ae:m.aggNums(Math.max,null,x);D.end=r.l2r(se),he||m.nestedProperty(c,S+".start").set(D.end)}var de="autobin"+n;return c._input[de]===!1&&(c._input[S]=m.extendFlat({},c[S]||{}),delete c._input[de],delete c[de]),[D,x]}N.exports={calc:function(a,c){var r,n,d,l,y=[],v=[],_=p.getFromId(a,c.orientation==="h"?c.yaxis:c.xaxis),x=c.orientation==="h"?"y":"x",T={x:"y",y:"x"}[x],A=c[x+"calendar"],S=c.cumulative,w=o(a,c,_,x),L=w[0],k=w[1],C=typeof L.size=="string",M=[],P=C?M:L,O=[],F=[],j=[],W=0,Z=c.histnorm,Q=c.histfunc,X=Z.indexOf("density")!==-1;S.enabled&&X&&(Z=Z.replace(/ ?density$/,""),X=!1);var G,Y=Q==="max"||Q==="min"?null:0,K=f.count,D=u[Z],B=!1,q=function(xe){return _.r2c(xe,0,A)};for(m.isArrayOrTypedArray(c[T])&&Q!=="count"&&(G=c[T],B=Q==="avg",K=f[Q]),r=q(L.start),d=q(L.end)+(r-p.tickIncrement(r,L.size,!1,A))/1e6;r<d&&y.length<1e6&&(n=p.tickIncrement(r,L.size,!1,A),y.push((r+n)/2),v.push(Y),j.push([]),M.push(r),X&&O.push(1/(n-r)),B&&F.push(0),!(n<=r));)r=n;M.push(r),C||_.type!=="date"||(P={start:q(P.start),end:q(P.end),size:P.size}),a._fullLayout._roundFnOpts||(a._fullLayout._roundFnOpts={});var ee=c["_"+x+"bingroup"],J={leftGap:1/0,rightGap:1/0};ee&&(a._fullLayout._roundFnOpts[ee]||(a._fullLayout._roundFnOpts[ee]=J),J=a._fullLayout._roundFnOpts[ee]);var $,te=v.length,ie=!0,ae=J.leftGap,he=J.rightGap,se={};for(r=0;r<k.length;r++){var de=k[r];(l=m.findBin(de,P))>=0&&l<te&&(W+=K(l,r,v,G,F),ie&&j[l].length&&de!==k[j[l][0]]&&(ie=!1),j[l].push(r),se[r]=l,ae=Math.min(ae,de-M[l]),he=Math.min(he,M[l+1]-de))}J.leftGap=ae,J.rightGap=he,ie||($=function(xe,ue){return function(){var me=a._fullLayout._roundFnOpts[ee];return s(me.leftGap,me.rightGap,M,_,A)(xe,ue)}}),B&&(W=i(v,F)),D&&D(v,W,O),S.enabled&&function(xe,ue,me){var we,Me,Se;function De(Ye){Se=xe[Ye],xe[Ye]/=2}function Fe(Ye){Me=xe[Ye],xe[Ye]=Se+Me/2,Se+=Me}if(me==="half")if(ue==="increasing")for(De(0),we=1;we<xe.length;we++)Fe(we);else for(De(xe.length-1),we=xe.length-2;we>=0;we--)Fe(we);else if(ue==="increasing"){for(we=1;we<xe.length;we++)xe[we]+=xe[we-1];me==="exclude"&&(xe.unshift(0),xe.pop())}else{for(we=xe.length-2;we>=0;we--)xe[we]+=xe[we+1];me==="exclude"&&(xe.push(0),xe.shift())}}(v,S.direction,S.currentbin);var ce=Math.min(y.length,v.length),ve=[],ke=0,Ee=ce-1;for(r=0;r<ce;r++)if(v[r]){ke=r;break}for(r=ce-1;r>=ke;r--)if(v[r]){Ee=r;break}for(r=ke;r<=Ee;r++)if(t(y[r])&&t(v[r])){var be={p:y[r],s:v[r],b:0};S.enabled||(be.pts=j[r],ie?be.ph0=be.ph1=j[r].length?k[j[r][0]]:y[r]:(c._computePh=!0,be.ph0=$(M[r]),be.ph1=$(M[r+1],!0))),ve.push(be)}return ve.length===1&&(ve[0].width1=p.tickIncrement(ve[0].p,L.size,!1,A)-ve[0].p),e(ve,c),m.isArrayOrTypedArray(c.selectedpoints)&&m.tagSelected(ve,c,se),ve},calcAllAutoBins:o}},{"../../lib":787,"../../plots/cartesian/axes":838,"../../registry":915,"../bar/arrays_to_calcdata":924,"./average":1089,"./bin_functions":1091,"./bin_label_vals":1092,"./norm_functions":1100,"fast-isnumeric":246}],1094:[function(h,N,H){N.exports={eventDataKeys:["binNumber"]}},{}],1095:[function(h,N,H){var t=h("../../lib"),m=h("../../plots/cartesian/axis_ids"),g=h("../../registry").traceIs,p=h("../bar/defaults").handleGroupingDefaults,e=t.nestedProperty,f=h("../../plots/cartesian/constraints").getAxisGroup,u=[{aStr:{x:"xbins.start",y:"ybins.start"},name:"start"},{aStr:{x:"xbins.end",y:"ybins.end"},name:"end"},{aStr:{x:"xbins.size",y:"ybins.size"},name:"size"},{aStr:{x:"nbinsx",y:"nbinsy"},name:"nbins"}],i=["x","y"];N.exports=function(s,o){var a,c,r,n,d,l,y,v=o._histogramBinOpts={},_=[],x={},T=[];function A(G,Y){return t.coerce(a._input,a,a._module.attributes,G,Y)}function S(G){return G.orientation==="v"?"x":"y"}function w(G,Y,K){var D=G.uid+"__"+K;Y||(Y=D);var B=function($,te){return m.getFromTrace({_fullLayout:o},$,te).type}(G,K),q=G[K+"calendar"]||"",ee=v[Y],J=!0;ee&&(B===ee.axType&&q===ee.calendar?(J=!1,ee.traces.push(G),ee.dirs.push(K)):(Y=D,B!==ee.axType&&t.warn(["Attempted to group the bins of trace",G.index,"set on a","type:"+B,"axis","with bins on","type:"+ee.axType,"axis."].join(" ")),q!==ee.calendar&&t.warn(["Attempted to group the bins of trace",G.index,"set with a",q,"calendar","with bins",ee.calendar?"on a "+ee.calendar+" calendar":"w/o a set calendar"].join(" ")))),J&&(v[Y]={traces:[G],dirs:[K],axType:B,calendar:G[K+"calendar"]||""}),G["_"+K+"bingroup"]=Y}for(d=0;d<s.length;d++)a=s[d],g(a,"histogram")&&(_.push(a),delete a._xautoBinFinished,delete a._yautoBinFinished,g(a,"2dMap")||p(a._input,a,o,A));var L=o._alignmentOpts||{};for(d=0;d<_.length;d++){if(a=_[d],r="",!g(a,"2dMap")){if(n=S(a),o.barmode==="group"&&a.alignmentgroup){var k=a[n+"axis"],C=f(o,k)+a.orientation;(L[C]||{})[a.alignmentgroup]&&(r=C)}r||o.barmode==="overlay"||(r=f(o,a.xaxis)+f(o,a.yaxis)+S(a))}r?(x[r]||(x[r]=[]),x[r].push(a)):T.push(a)}for(r in x)if((c=x[r]).length!==1){var M=!1;for(c.length&&(a=c[0],M=A("bingroup")),r=M||r,d=0;d<c.length;d++){var P=(a=c[d])._input.bingroup;P&&P!==r&&t.warn(["Trace",a.index,"must match","within bingroup",r+".","Ignoring its bingroup:",P,"setting."].join(" ")),a.bingroup=r,w(a,r,S(a))}}else T.push(c[0]);for(d=0;d<T.length;d++){a=T[d];var O=A("bingroup");if(g(a,"2dMap"))for(y=0;y<2;y++){var F=A((n=i[y])+"bingroup",O?O+"__"+n:null);w(a,F,n)}else w(a,O,S(a))}for(r in v){var j=v[r];for(c=j.traces,l=0;l<u.length;l++){var W,Z,Q=u[l],X=Q.name;if(X!=="nbins"||!j.sizeFound){for(d=0;d<c.length;d++){if(a=c[d],n=j.dirs[d],W=Q.aStr[n],e(a._input,W).get()!==void 0){j[X]=A(W),j[X+"Found"]=!0;break}(Z=(a._autoBin||{})[n]||{})[X]&&e(a,W).set(Z[X])}if(X==="start"||X==="end")for(;d<c.length;d++)(a=c[d])["_"+n+"bingroup"]&&A(W,(Z=(a._autoBin||{})[n]||{})[X]);X!=="nbins"||j.sizeFound||j.nbinsFound||(a=c[0],j[X]=A(W))}}}}},{"../../lib":787,"../../plots/cartesian/axis_ids":842,"../../plots/cartesian/constraints":846,"../../registry":915,"../bar/defaults":929}],1096:[function(h,N,H){var t=h("../../registry"),m=h("../../lib"),g=h("../../components/color"),p=h("../bar/style_defaults"),e=h("./attributes");N.exports=function(f,u,i,s){function o(_,x){return m.coerce(f,u,e,_,x)}var a=o("x"),c=o("y");o("cumulative.enabled")&&(o("cumulative.direction"),o("cumulative.currentbin")),o("text"),o("hovertext"),o("hovertemplate"),o("xhoverformat"),o("yhoverformat");var r=o("orientation",c&&!a?"h":"v"),n=r==="v"?"x":"y",d=r==="v"?"y":"x",l=a&&c?Math.min(m.minRowLength(a)&&m.minRowLength(c)):m.minRowLength(u[n]||[]);if(l){u._length=l,t.getComponentMethod("calendars","handleTraceDefaults")(f,u,["x","y"],s),u[d]&&o("histfunc"),o("histnorm"),o("autobin"+n),p(f,u,o,i,s),m.coerceSelectionMarkerOpacity(u,o);var y=(u.marker.line||{}).color,v=t.getComponentMethod("errorbars","supplyDefaults");v(f,u,y||g.defaultLine,{axis:"y"}),v(f,u,y||g.defaultLine,{axis:"x",inherit:"y"})}else u.visible=!1}},{"../../components/color":650,"../../lib":787,"../../registry":915,"../bar/style_defaults":940,"./attributes":1088}],1097:[function(h,N,H){N.exports=function(t,m,g,p,e){if(t.x="xVal"in m?m.xVal:m.x,t.y="yVal"in m?m.yVal:m.y,"zLabelVal"in m&&(t.z=m.zLabelVal),m.xa&&(t.xaxis=m.xa),m.ya&&(t.yaxis=m.ya),!(g.cumulative||{}).enabled){var f,u=Array.isArray(e)?p[0].pts[e[0]][e[1]]:p[e].pts;if(t.pointNumbers=u,t.binNumber=t.pointNumber,delete t.pointNumber,delete t.pointIndex,g._indexToPoints){f=[];for(var i=0;i<u.length;i++)f=f.concat(g._indexToPoints[u[i]])}else f=u;t.pointIndices=f}return t}},{}],1098:[function(h,N,H){var t=h("../bar/hover").hoverPoints,m=h("../../plots/cartesian/axes").hoverLabelText;N.exports=function(g,p,e,f,u){var i=t(g,p,e,f,u);if(i){var s=(g=i[0]).cd[g.index],o=g.cd[0].trace;if(!o.cumulative.enabled){var a=o.orientation==="h"?"y":"x";g[a+"Label"]=m(g[a+"a"],[s.ph0,s.ph1],o[a+"hoverformat"])}return i}}},{"../../plots/cartesian/axes":838,"../bar/hover":932}],1099:[function(h,N,H){N.exports={attributes:h("./attributes"),layoutAttributes:h("../bar/layout_attributes"),supplyDefaults:h("./defaults"),crossTraceDefaults:h("./cross_trace_defaults"),supplyLayoutDefaults:h("../bar/layout_defaults"),calc:h("./calc").calc,crossTraceCalc:h("../bar/cross_trace_calc").crossTraceCalc,plot:h("../bar/plot").plot,layerName:"barlayer",style:h("../bar/style").style,styleOnSelect:h("../bar/style").styleOnSelect,colorbar:h("../scatter/marker_colorbar"),hoverPoints:h("./hover"),selectPoints:h("../bar/select"),eventData:h("./event_data"),moduleType:"trace",name:"histogram",basePlotModule:h("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","histogram","oriented","errorBarsOK","showLegend"],meta:{}}},{"../../plots/cartesian":852,"../bar/cross_trace_calc":928,"../bar/layout_attributes":934,"../bar/layout_defaults":935,"../bar/plot":936,"../bar/select":937,"../bar/style":939,"../scatter/marker_colorbar":1220,"./attributes":1088,"./calc":1093,"./cross_trace_defaults":1095,"./defaults":1096,"./event_data":1097,"./hover":1098}],1100:[function(h,N,H){N.exports={percent:function(t,m){for(var g=t.length,p=100/m,e=0;e<g;e++)t[e]*=p},probability:function(t,m){for(var g=t.length,p=0;p<g;p++)t[p]/=m},density:function(t,m,g,p){var e=t.length;p=p||1;for(var f=0;f<e;f++)t[f]*=g[f]*p},"probability density":function(t,m,g,p){var e=t.length;p&&(m/=p);for(var f=0;f<e;f++)t[f]*=g[f]/m}}},{}],1101:[function(h,N,H){var t=h("../histogram/attributes"),m=h("../histogram/bin_attributes"),g=h("../heatmap/attributes"),p=h("../../plots/attributes"),e=h("../../plots/cartesian/axis_format_attributes").axisHoverFormat,f=h("../../plots/template_attributes").hovertemplateAttrs,u=h("../../components/colorscale/attributes"),i=h("../../lib/extend").extendFlat;N.exports=i({x:t.x,y:t.y,z:{valType:"data_array",editType:"calc"},marker:{color:{valType:"data_array",editType:"calc"},editType:"calc"},histnorm:t.histnorm,histfunc:t.histfunc,nbinsx:t.nbinsx,xbins:m("x"),nbinsy:t.nbinsy,ybins:m("y"),autobinx:t.autobinx,autobiny:t.autobiny,bingroup:i({},t.bingroup,{}),xbingroup:i({},t.bingroup,{}),ybingroup:i({},t.bingroup,{}),xgap:g.xgap,ygap:g.ygap,zsmooth:g.zsmooth,xhoverformat:e("x"),yhoverformat:e("y"),zhoverformat:e("z",1),hovertemplate:f({},{keys:"z"}),showlegend:i({},p.showlegend,{dflt:!1})},u("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../heatmap/attributes":1069,"../histogram/attributes":1088,"../histogram/bin_attributes":1090}],1102:[function(h,N,H){var t=h("../../lib"),m=h("../../plots/cartesian/axes"),g=h("../histogram/bin_functions"),p=h("../histogram/norm_functions"),e=h("../histogram/average"),f=h("../histogram/bin_label_vals"),u=h("../histogram/calc").calcAllAutoBins;function i(a,c,r,n){var d,l=new Array(a);if(n)for(d=0;d<a;d++)l[d]=1/(c[d+1]-c[d]);else{var y=1/r;for(d=0;d<a;d++)l[d]=y}return l}function s(a,c){return{start:a(c.start),end:a(c.end),size:c.size}}function o(a,c,r,n,d,l){var y,v=a.length-1,_=new Array(v),x=f(r,n,a,d,l);for(y=0;y<v;y++){var T=(c||[])[y];_[y]=T===void 0?[x(a[y]),x(a[y+1],!0)]:[T,T]}return _}N.exports=function(a,c){var r,n,d,l,y=m.getFromId(a,c.xaxis),v=m.getFromId(a,c.yaxis),_=c.xcalendar,x=c.ycalendar,T=function(rt){return y.r2c(rt,0,_)},A=function(rt){return v.r2c(rt,0,x)},S=u(a,c,y,"x"),w=S[0],L=S[1],k=u(a,c,v,"y"),C=k[0],M=k[1],P=c._length;L.length>P&&L.splice(P,L.length-P),M.length>P&&M.splice(P,M.length-P);var O=[],F=[],j=[],W=typeof w.size=="string",Z=typeof C.size=="string",Q=[],X=[],G=W?Q:w,Y=Z?X:C,K=0,D=[],B=[],q=c.histnorm,ee=c.histfunc,J=q.indexOf("density")!==-1,$=ee==="max"||ee==="min"?null:0,te=g.count,ie=p[q],ae=!1,he=[],se=[],de="z"in c?c.z:"marker"in c&&Array.isArray(c.marker.color)?c.marker.color:"";de&&ee!=="count"&&(ae=ee==="avg",te=g[ee]);var ce=w.size,ve=T(w.start),ke=T(w.end)+(ve-m.tickIncrement(ve,ce,!1,_))/1e6;for(r=ve;r<ke;r=m.tickIncrement(r,ce,!1,_))F.push($),Q.push(r),ae&&j.push(0);Q.push(r);var Ee,be=F.length,xe=(r-ve)/be,ue=(Ee=ve+xe/2,y.c2r(Ee,0,_)),me=C.size,we=A(C.start),Me=A(C.end)+(we-m.tickIncrement(we,me,!1,x))/1e6;for(r=we;r<Me;r=m.tickIncrement(r,me,!1,x)){O.push(F.slice()),X.push(r);var Se=new Array(be);for(n=0;n<be;n++)Se[n]=[];B.push(Se),ae&&D.push(j.slice())}X.push(r);var De=O.length,Fe=(r-we)/De,Ye=function(rt){return v.c2r(rt,0,x)}(we+Fe/2);J&&(he=i(F.length,G,xe,W),se=i(O.length,Y,Fe,Z)),W||y.type!=="date"||(G=s(T,G)),Z||v.type!=="date"||(Y=s(A,Y));var et=!0,Oe=!0,je=new Array(be),We=new Array(De),Ge=1/0,Qe=1/0,it=1/0,lt=1/0;for(r=0;r<P;r++){var Lt=L[r],wt=M[r];d=t.findBin(Lt,G),l=t.findBin(wt,Y),d>=0&&d<be&&l>=0&&l<De&&(K+=te(d,r,O[l],de,D[l]),B[l][d].push(r),et&&(je[d]===void 0?je[d]=Lt:je[d]!==Lt&&(et=!1)),Oe&&(We[l]===void 0?We[l]=wt:We[l]!==wt&&(Oe=!1)),Ge=Math.min(Ge,Lt-Q[d]),Qe=Math.min(Qe,Q[d+1]-Lt),it=Math.min(it,wt-X[l]),lt=Math.min(lt,X[l+1]-wt))}if(ae)for(l=0;l<De;l++)K+=e(O[l],D[l]);if(ie)for(l=0;l<De;l++)ie(O[l],K,he,se[l]);return{x:L,xRanges:o(Q,et&&je,Ge,Qe,y,_),x0:ue,dx:xe,y:M,yRanges:o(X,Oe&&We,it,lt,v,x),y0:Ye,dy:Fe,z:O,pts:B}}},{"../../lib":787,"../../plots/cartesian/axes":838,"../histogram/average":1089,"../histogram/bin_functions":1091,"../histogram/bin_label_vals":1092,"../histogram/calc":1093,"../histogram/norm_functions":1100}],1103:[function(h,N,H){var t=h("../../lib"),m=h("./sample_defaults"),g=h("../heatmap/style_defaults"),p=h("../../components/colorscale/defaults"),e=h("./attributes");N.exports=function(f,u,i,s){function o(a,c){return t.coerce(f,u,e,a,c)}m(f,u,o,s),u.visible!==!1&&(g(f,u,o,s),p(f,u,s,o,{prefix:"",cLetter:"z"}),o("hovertemplate"),o("xhoverformat"),o("yhoverformat"))}},{"../../components/colorscale/defaults":660,"../../lib":787,"../heatmap/style_defaults":1082,"./attributes":1101,"./sample_defaults":1106}],1104:[function(h,N,H){var t=h("../heatmap/hover"),m=h("../../plots/cartesian/axes").hoverLabelText;N.exports=function(g,p,e,f,u){var i=t(g,p,e,f,u);if(i){var s=(g=i[0]).index,o=s[0],a=s[1],c=g.cd[0],r=c.trace,n=c.xRanges[a],d=c.yRanges[o];return g.xLabel=m(g.xa,[n[0],n[1]],r.xhoverformat),g.yLabel=m(g.ya,[d[0],d[1]],r.yhoverformat),i}}},{"../../plots/cartesian/axes":838,"../heatmap/hover":1076}],1105:[function(h,N,H){N.exports={attributes:h("./attributes"),supplyDefaults:h("./defaults"),crossTraceDefaults:h("../histogram/cross_trace_defaults"),calc:h("../heatmap/calc"),plot:h("../heatmap/plot"),layerName:"heatmaplayer",colorbar:h("../heatmap/colorbar"),style:h("../heatmap/style"),hoverPoints:h("./hover"),eventData:h("../histogram/event_data"),moduleType:"trace",name:"histogram2d",basePlotModule:h("../../plots/cartesian"),categories:["cartesian","svg","2dMap","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":852,"../heatmap/calc":1070,"../heatmap/colorbar":1072,"../heatmap/plot":1080,"../heatmap/style":1081,"../histogram/cross_trace_defaults":1095,"../histogram/event_data":1097,"./attributes":1101,"./defaults":1103,"./hover":1104}],1106:[function(h,N,H){var t=h("../../registry"),m=h("../../lib");N.exports=function(g,p,e,f){var u=e("x"),i=e("y"),s=m.minRowLength(u),o=m.minRowLength(i);s&&o?(p._length=Math.min(s,o),t.getComponentMethod("calendars","handleTraceDefaults")(g,p,["x","y"],f),(e("z")||e("marker.color"))&&e("histfunc"),e("histnorm"),e("autobinx"),e("autobiny")):p.visible=!1}},{"../../lib":787,"../../registry":915}],1107:[function(h,N,H){var t=h("../histogram2d/attributes"),m=h("../contour/attributes"),g=h("../../components/colorscale/attributes"),p=h("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=h("../../lib/extend").extendFlat;N.exports=e({x:t.x,y:t.y,z:t.z,marker:t.marker,histnorm:t.histnorm,histfunc:t.histfunc,nbinsx:t.nbinsx,xbins:t.xbins,nbinsy:t.nbinsy,ybins:t.ybins,autobinx:t.autobinx,autobiny:t.autobiny,bingroup:t.bingroup,xbingroup:t.xbingroup,ybingroup:t.ybingroup,autocontour:m.autocontour,ncontours:m.ncontours,contours:m.contours,line:{color:m.line.color,width:e({},m.line.width,{dflt:.5}),dash:m.line.dash,smoothing:m.line.smoothing,editType:"plot"},xhoverformat:p("x"),yhoverformat:p("y"),zhoverformat:p("z",1),hovertemplate:t.hovertemplate},g("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/cartesian/axis_format_attributes":841,"../contour/attributes":1012,"../histogram2d/attributes":1101}],1108:[function(h,N,H){var t=h("../../lib"),m=h("../histogram2d/sample_defaults"),g=h("../contour/contours_defaults"),p=h("../contour/style_defaults"),e=h("./attributes");N.exports=function(f,u,i,s){function o(a,c){return t.coerce(f,u,e,a,c)}m(f,u,o,s),u.visible!==!1&&(g(f,u,o,function(a){return t.coerce2(f,u,e,a)}),p(f,u,o,s),o("hovertemplate"),o("xhoverformat"),o("yhoverformat"))}},{"../../lib":787,"../contour/contours_defaults":1019,"../contour/style_defaults":1033,"../histogram2d/sample_defaults":1106,"./attributes":1107}],1109:[function(h,N,H){N.exports={attributes:h("./attributes"),supplyDefaults:h("./defaults"),crossTraceDefaults:h("../histogram/cross_trace_defaults"),calc:h("../contour/calc"),plot:h("../contour/plot").plot,layerName:"contourlayer",style:h("../contour/style"),colorbar:h("../contour/colorbar"),hoverPoints:h("../contour/hover"),moduleType:"trace",name:"histogram2dcontour",basePlotModule:h("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":852,"../contour/calc":1013,"../contour/colorbar":1015,"../contour/hover":1025,"../contour/plot":1030,"../contour/style":1032,"../histogram/cross_trace_defaults":1095,"./attributes":1107,"./defaults":1108}],1110:[function(h,N,H){var t=h("../../plots/template_attributes").hovertemplateAttrs,m=h("../../plots/template_attributes").texttemplateAttrs,g=h("../../components/colorscale/attributes"),p=h("../../plots/domain").attributes,e=h("../pie/attributes"),f=h("../sunburst/attributes"),u=h("../treemap/attributes"),i=h("../treemap/constants"),s=h("../../lib/extend").extendFlat;N.exports={labels:f.labels,parents:f.parents,values:f.values,branchvalues:f.branchvalues,count:f.count,level:f.level,maxdepth:f.maxdepth,tiling:{orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"plot"},flip:u.tiling.flip,pad:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},marker:s({colors:f.marker.colors,line:f.marker.line,editType:"calc"},g("marker",{colorAttr:"colors",anim:!1})),leaf:f.leaf,pathbar:u.pathbar,text:e.text,textinfo:f.textinfo,texttemplate:m({editType:"plot"},{keys:i.eventDataKeys.concat(["label","value"])}),hovertext:e.hovertext,hoverinfo:f.hoverinfo,hovertemplate:t({},{keys:i.eventDataKeys}),textfont:e.textfont,insidetextfont:e.insidetextfont,outsidetextfont:u.outsidetextfont,textposition:u.textposition,sort:e.sort,root:f.root,domain:p({name:"icicle",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/domain":866,"../../plots/template_attributes":910,"../pie/attributes":1176,"../sunburst/attributes":1314,"../treemap/attributes":1340,"../treemap/constants":1343}],1111:[function(h,N,H){var t=h("../../plots/plots");H.name="icicle",H.plot=function(m,g,p,e){t.plotBasePlot(H.name,m,g,p,e)},H.clean=function(m,g,p,e){t.cleanBasePlot(H.name,m,g,p,e)}},{"../../plots/plots":901}],1112:[function(h,N,H){var t=h("../sunburst/calc");H.calc=function(m,g){return t.calc(m,g)},H.crossTraceCalc=function(m){return t._runCrossTraceCalc("icicle",m)}},{"../sunburst/calc":1316}],1113:[function(h,N,H){var t=h("../../lib"),m=h("./attributes"),g=h("../../components/color"),p=h("../../plots/domain").defaults,e=h("../bar/defaults").handleText,f=h("../bar/constants").TEXTPAD,u=h("../../components/colorscale"),i=u.hasColorscale,s=u.handleDefaults;N.exports=function(o,a,c,r){function n(T,A){return t.coerce(o,a,m,T,A)}var d=n("labels"),l=n("parents");if(d&&d.length&&l&&l.length){var y=n("values");y&&y.length?n("branchvalues"):n("count"),n("level"),n("maxdepth"),n("tiling.orientation"),n("tiling.flip"),n("tiling.pad");var v=n("text");n("texttemplate"),a.texttemplate||n("textinfo",Array.isArray(v)?"text+label":"label"),n("hovertext"),n("hovertemplate");var _=n("pathbar.visible");e(o,a,r,n,"auto",{hasPathbar:_,moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),n("textposition"),n("marker.line.width")&&n("marker.line.color",r.paper_bgcolor),n("marker.colors");var x=a._hasColorscale=i(o,"marker","colors")||(o.marker||{}).coloraxis;x&&s(o,a,r,n,{prefix:"marker.",cLetter:"c"}),n("leaf.opacity",x?1:.7),a._hovered={marker:{line:{width:2,color:g.contrast(r.paper_bgcolor)}}},_&&(n("pathbar.thickness",a.pathbar.textfont.size+2*f),n("pathbar.side"),n("pathbar.edgeshape")),n("sort"),n("root.color"),p(a,r,n),a._length=null}else a.visible=!1}},{"../../components/color":650,"../../components/colorscale":662,"../../lib":787,"../../plots/domain":866,"../bar/constants":927,"../bar/defaults":929,"./attributes":1110}],1114:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../lib"),g=h("../../components/drawing"),p=h("../../lib/svg_text_utils"),e=h("./partition"),f=h("./style").styleOne,u=h("../treemap/constants"),i=h("../sunburst/helpers"),s=h("../sunburst/fx"),o=h("../sunburst/plot").formatSliceLabel;N.exports=function(a,c,r,n,d){var l=d.width,y=d.height,v=d.viewX,_=d.viewY,x=d.pathSlice,T=d.toMoveInsideSlice,A=d.strTransform,S=d.hasTransition,w=d.handleSlicesExit,L=d.makeUpdateSliceInterpolator,k=d.makeUpdateTextInterpolator,C=d.prevEntry,M=a._fullLayout,P=c[0].trace,O=P.textposition.indexOf("left")!==-1,F=P.textposition.indexOf("right")!==-1,j=P.textposition.indexOf("bottom")!==-1,W=e(r,[l,y],{flipX:P.tiling.flip.indexOf("x")>-1,flipY:P.tiling.flip.indexOf("y")>-1,orientation:P.tiling.orientation,pad:{inner:P.tiling.pad},maxDepth:P._maxDepth}).descendants(),Z=1/0,Q=-1/0;W.forEach(function(D){var B=D.depth;B>=P._maxDepth?(D.x0=D.x1=(D.x0+D.x1)/2,D.y0=D.y1=(D.y0+D.y1)/2):(Z=Math.min(Z,B),Q=Math.max(Q,B))}),n=n.data(W,i.getPtId),P._maxVisibleLayers=isFinite(Q)?Q-Z+1:0,n.enter().append("g").classed("slice",!0),w(n,!1,{},[l,y],x),n.order();var X=null;if(S&&C){var G=i.getPtId(C);n.each(function(D){X===null&&i.getPtId(D)===G&&(X={x0:D.x0,x1:D.x1,y0:D.y0,y1:D.y1})})}var Y=function(){return X||{x0:0,x1:l,y0:0,y1:y}},K=n;return S&&(K=K.transition().each("end",function(){var D=t.select(this);i.setSliceCursor(D,a,{hideOnRoot:!0,hideOnLeaves:!1,isTransitioning:!1})})),K.each(function(D){D._x0=v(D.x0),D._x1=v(D.x1),D._y0=_(D.y0),D._y1=_(D.y1),D._hoverX=v(D.x1-P.tiling.pad),D._hoverY=_(j?D.y1-P.tiling.pad/2:D.y0+P.tiling.pad/2);var B=t.select(this),q=m.ensureSingle(B,"path","surface",function(te){te.style("pointer-events","all")});S?q.transition().attrTween("d",function(te){var ie=L(te,!1,Y(),[l,y],{orientation:P.tiling.orientation,flipX:P.tiling.flip.indexOf("x")>-1,flipY:P.tiling.flip.indexOf("y")>-1});return function(ae){return x(ie(ae))}}):q.attr("d",x),B.call(s,r,a,c,{styleOne:f,eventDataKeys:u.eventDataKeys,transitionTime:u.CLICK_TRANSITION_TIME,transitionEasing:u.CLICK_TRANSITION_EASING}).call(i.setSliceCursor,a,{isTransitioning:a._transitioning}),q.call(f,D,P,{hovered:!1}),D.x0===D.x1||D.y0===D.y1?D._text="":D._text=o(D,r,P,c,M)||"";var ee=m.ensureSingle(B,"g","slicetext"),J=m.ensureSingle(ee,"text","",function(te){te.attr("data-notex",1)}),$=m.ensureUniformFontSize(a,i.determineTextFont(P,D,M.font));J.text(D._text||" ").classed("slicetext",!0).attr("text-anchor",F?"end":O?"start":"middle").call(g.font,$).call(p.convertToTspans,a),D.textBB=g.bBox(J.node()),D.transform=T(D,{fontSize:$.size}),D.transform.fontSize=$.size,S?J.transition().attrTween("transform",function(te){var ie=k(te,!1,Y(),[l,y]);return function(ae){return A(ie(ae))}}):J.attr("transform",A(D))}),X}},{"../../components/drawing":672,"../../lib":787,"../../lib/svg_text_utils":813,"../sunburst/fx":1319,"../sunburst/helpers":1320,"../sunburst/plot":1324,"../treemap/constants":1343,"./partition":1118,"./style":1120,"@plotly/d3":58}],1115:[function(h,N,H){N.exports={moduleType:"trace",name:"icicle",basePlotModule:h("./base_plot"),categories:[],animatable:!0,attributes:h("./attributes"),layoutAttributes:h("./layout_attributes"),supplyDefaults:h("./defaults"),supplyLayoutDefaults:h("./layout_defaults"),calc:h("./calc").calc,crossTraceCalc:h("./calc").crossTraceCalc,plot:h("./plot"),style:h("./style").style,colorbar:h("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":1220,"./attributes":1110,"./base_plot":1111,"./calc":1112,"./defaults":1113,"./layout_attributes":1116,"./layout_defaults":1117,"./plot":1119,"./style":1120}],1116:[function(h,N,H){N.exports={iciclecolorway:{valType:"colorlist",editType:"calc"},extendiciclecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1117:[function(h,N,H){var t=h("../../lib"),m=h("./layout_attributes");N.exports=function(g,p){function e(f,u){return t.coerce(g,p,m,f,u)}e("iciclecolorway",p.colorway),e("extendiciclecolors")}},{"../../lib":787,"./layout_attributes":1116}],1118:[function(h,N,H){var t=h("d3-hierarchy"),m=h("../treemap/flip_tree");N.exports=function(g,p,e){var f=e.flipX,u=e.flipY,i=e.orientation==="h",s=e.maxDepth,o=p[0],a=p[1];s&&(o=(g.height+1)*p[0]/Math.min(g.height+1,s),a=(g.height+1)*p[1]/Math.min(g.height+1,s));var c=t.partition().padding(e.pad.inner).size(i?[p[1],o]:[p[0],a])(g);return(i||f||u)&&m(c,p,{swapXY:i,flipX:f,flipY:u}),c}},{"../treemap/flip_tree":1348,"d3-hierarchy":167}],1119:[function(h,N,H){var t=h("../treemap/draw"),m=h("./draw_descendants");N.exports=function(g,p,e,f){return t(g,p,e,f,{type:"icicle",drawDescendants:m})}},{"../treemap/draw":1345,"./draw_descendants":1114}],1120:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../components/color"),g=h("../../lib"),p=h("../bar/uniform_text").resizeText;function e(f,u,i){var s=u.data.data,o=!u.children,a=s.i,c=g.castOption(i,a,"marker.line.color")||m.defaultLine,r=g.castOption(i,a,"marker.line.width")||0;f.style("stroke-width",r).call(m.fill,s.color).call(m.stroke,c).style("opacity",o?i.leaf.opacity:null)}N.exports={style:function(f){var u=f._fullLayout._iciclelayer.selectAll(".trace");p(f,u,"icicle"),u.each(function(i){var s=t.select(this),o=i[0].trace;s.style("opacity",o.opacity),s.selectAll("path.surface").each(function(a){t.select(this).call(e,a,o)})})},styleOne:e}},{"../../components/color":650,"../../lib":787,"../bar/uniform_text":941,"@plotly/d3":58}],1121:[function(h,N,H){for(var t=h("../../plots/attributes"),m=h("../../plots/template_attributes").hovertemplateAttrs,g=h("../../lib/extend").extendFlat,p=h("./constants").colormodel,e=["rgb","rgba","rgba256","hsl","hsla"],f=[],u=[],i=0;i<e.length;i++){var s=p[e[i]];f.push("For the `"+e[i]+"` colormodel, it is ["+(s.zminDflt||s.min).join(", ")+"]."),u.push("For the `"+e[i]+"` colormodel, it is ["+(s.zmaxDflt||s.max).join(", ")+"].")}N.exports=g({source:{valType:"string",editType:"calc"},z:{valType:"data_array",editType:"calc"},colormodel:{valType:"enumerated",values:e,editType:"calc"},zsmooth:{valType:"enumerated",values:["fast",!1],dflt:!1,editType:"plot"},zmin:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},zmax:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dx:{valType:"number",dflt:1,editType:"calc"},dy:{valType:"number",dflt:1,editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"data_array",editType:"plot"},hoverinfo:g({},t.hoverinfo,{flags:["x","y","z","color","name","text"],dflt:"x+y+z+text+name"}),hovertemplate:m({},{keys:["z","color","colormodel"]}),transforms:void 0})},{"../../lib/extend":777,"../../plots/attributes":834,"../../plots/template_attributes":910,"./constants":1123}],1122:[function(h,N,H){var t=h("../../lib"),m=h("./constants"),g=h("fast-isnumeric"),p=h("../../plots/cartesian/axes"),e=h("../../lib").maxRowLength,f=h("./helpers").getImageSize;function u(s,o,a,c){return function(r){return t.constrain((r-s)*o,a,c)}}function i(s,o){return function(a){return t.constrain(a,s,o)}}N.exports=function(s,o){var a,c;if(o._hasZ)a=o.z.length,c=e(o.z);else if(o._hasSource){var r=f(o.source);a=r.height,c=r.width}var n,d=p.getFromId(s,o.xaxis||"x"),l=p.getFromId(s,o.yaxis||"y"),y=d.d2c(o.x0)-o.dx/2,v=l.d2c(o.y0)-o.dy/2,_=[y,y+c*o.dx],x=[v,v+a*o.dy];if(d&&d.type==="log")for(n=0;n<c;n++)_.push(y+n*o.dx);if(l&&l.type==="log")for(n=0;n<a;n++)x.push(v+n*o.dy);return o._extremes[d._id]=p.findExtremes(d,_),o._extremes[l._id]=p.findExtremes(l,x),o._scaler=function(T){var A=m.colormodel[T.colormodel],S=(A.colormodel||T.colormodel).length;T._sArray=[];for(var w=0;w<S;w++)A.min[w]!==T.zmin[w]||A.max[w]!==T.zmax[w]?T._sArray.push(u(T.zmin[w],(A.max[w]-A.min[w])/(T.zmax[w]-T.zmin[w]),A.min[w],A.max[w])):T._sArray.push(i(A.min[w],A.max[w]));return function(L){for(var k=L.slice(0,S),C=0;C<S;C++){var M=k[C];if(!g(M))return!1;k[C]=T._sArray[C](M)}return k}}(o),[{x0:y,y0:v,z:o.z,w:c,h:a}]}},{"../../lib":787,"../../plots/cartesian/axes":838,"./constants":1123,"./helpers":1126,"fast-isnumeric":246}],1123:[function(h,N,H){N.exports={colormodel:{rgb:{min:[0,0,0],max:[255,255,255],fmt:function(t){return t.slice(0,3)},suffix:["","",""]},rgba:{min:[0,0,0,0],max:[255,255,255,1],fmt:function(t){return t.slice(0,4)},suffix:["","","",""]},rgba256:{colormodel:"rgba",zminDflt:[0,0,0,0],zmaxDflt:[255,255,255,255],min:[0,0,0,0],max:[255,255,255,1],fmt:function(t){return t.slice(0,4)},suffix:["","","",""]},hsl:{min:[0,0,0],max:[360,100,100],fmt:function(t){var m=t.slice(0,3);return m[1]=m[1]+"%",m[2]=m[2]+"%",m},suffix:["\xB0","%","%"]},hsla:{min:[0,0,0,0],max:[360,100,100,1],fmt:function(t){var m=t.slice(0,4);return m[1]=m[1]+"%",m[2]=m[2]+"%",m},suffix:["\xB0","%","%",""]}},pixelatedStyle:["image-rendering: optimizeSpeed","image-rendering: -moz-crisp-edges","image-rendering: -o-crisp-edges","image-rendering: -webkit-optimize-contrast","image-rendering: optimize-contrast","image-rendering: crisp-edges","image-rendering: pixelated",""].join("; ")}},{}],1124:[function(h,N,H){var t=h("../../lib"),m=h("./attributes"),g=h("./constants"),p=h("../../snapshot/helpers").IMAGE_URL_PREFIX;N.exports=function(e,f){function u(o,a){return t.coerce(e,f,m,o,a)}u("source"),f.source&&!f.source.match(p)&&delete f.source,f._hasSource=!!f.source;var i,s=u("z");f._hasZ=!(s===void 0||!s.length||!s[0]||!s[0].length),f._hasZ||f._hasSource?(u("x0"),u("y0"),u("dx"),u("dy"),f._hasZ?(u("colormodel","rgb"),u("zmin",(i=g.colormodel[f.colormodel]).zminDflt||i.min),u("zmax",i.zmaxDflt||i.max)):f._hasSource&&(f.colormodel="rgba256",i=g.colormodel[f.colormodel],f.zmin=i.zminDflt,f.zmax=i.zmaxDflt),u("zsmooth"),u("text"),u("hovertext"),u("hovertemplate"),f._length=null):f.visible=!1}},{"../../lib":787,"../../snapshot/helpers":919,"./attributes":1121,"./constants":1123}],1125:[function(h,N,H){N.exports=function(t,m){return"xVal"in m&&(t.x=m.xVal),"yVal"in m&&(t.y=m.yVal),m.xa&&(t.xaxis=m.xa),m.ya&&(t.yaxis=m.ya),t.color=m.color,t.colormodel=m.trace.colormodel,t.z||(t.z=m.color),t}},{}],1126:[function(h,N,H){var t=h("probe-image-size/sync"),m=h("../../snapshot/helpers").IMAGE_URL_PREFIX,g=h("buffer/").Buffer;H.getImageSize=function(p){var e=p.replace(m,""),f=new g(e,"base64");return t(f)}},{"../../snapshot/helpers":919,"buffer/":117,"probe-image-size/sync":513}],1127:[function(h,N,H){var t=h("../../components/fx"),m=h("../../lib"),g=h("./constants");N.exports=function(p,e,f){var u=p.cd[0],i=u.trace,s=p.xa,o=p.ya;if(!(t.inbox(e-u.x0,e-(u.x0+u.w*i.dx),0)>0||t.inbox(f-u.y0,f-(u.y0+u.h*i.dy),0)>0)){var a,c=Math.floor((e-u.x0)/i.dx),r=Math.floor(Math.abs(f-u.y0)/i.dy);if(i._hasZ?a=u.z[r][c]:i._hasSource&&(a=i._canvas.el.getContext("2d").getImageData(c,r,1,1).data),a){var n,d=u.hi||i.hoverinfo;if(d){var l=d.split("+");l.indexOf("all")!==-1&&(l=["color"]),l.indexOf("color")!==-1&&(n=!0)}var y,v=g.colormodel[i.colormodel],_=v.colormodel||i.colormodel,x=_.length,T=i._scaler(a),A=v.suffix,S=[];(i.hovertemplate||n)&&(S.push("["+[T[0]+A[0],T[1]+A[1],T[2]+A[2]].join(", ")),x===4&&S.push(", "+T[3]+A[3]),S.push("]"),S=S.join(""),p.extraText=_.toUpperCase()+": "+S),Array.isArray(i.hovertext)&&Array.isArray(i.hovertext[r])?y=i.hovertext[r][c]:Array.isArray(i.text)&&Array.isArray(i.text[r])&&(y=i.text[r][c]);var w=o.c2p(u.y0+(r+.5)*i.dy),L=u.x0+(c+.5)*i.dx,k=u.y0+(r+.5)*i.dy,C="["+a.slice(0,i.colormodel.length).join(", ")+"]";return[m.extendFlat(p,{index:[r,c],x0:s.c2p(u.x0+c*i.dx),x1:s.c2p(u.x0+(c+1)*i.dx),y0:w,y1:w,color:T,xVal:L,xLabelVal:L,yVal:k,yLabelVal:k,zLabelVal:C,text:y,hovertemplateLabels:{zLabel:C,colorLabel:S,"color[0]Label":T[0]+A[0],"color[1]Label":T[1]+A[1],"color[2]Label":T[2]+A[2],"color[3]Label":T[3]+A[3]}})]}}}},{"../../components/fx":690,"../../lib":787,"./constants":1123}],1128:[function(h,N,H){N.exports={attributes:h("./attributes"),supplyDefaults:h("./defaults"),calc:h("./calc"),plot:h("./plot"),style:h("./style"),hoverPoints:h("./hover"),eventData:h("./event_data"),moduleType:"trace",name:"image",basePlotModule:h("../../plots/cartesian"),categories:["cartesian","svg","2dMap","noSortingByValue"],animatable:!1,meta:{}}},{"../../plots/cartesian":852,"./attributes":1121,"./calc":1122,"./defaults":1124,"./event_data":1125,"./hover":1127,"./plot":1129,"./style":1130}],1129:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../lib"),g=m.strTranslate,p=h("../../constants/xmlns_namespaces"),e=h("./constants"),f=m.isIOS()||m.isSafari()||m.isIE();N.exports=function(u,i,s,o){var a=i.xaxis,c=i.yaxis,r=!(f||u._context._exportedPlot);m.makeTraceGroups(o,s,"im").each(function(n){var d=t.select(this),l=n[0],y=l.trace,v=(y.zsmooth==="fast"||y.zsmooth===!1&&r)&&!y._hasZ&&y._hasSource&&a.type==="linear"&&c.type==="linear";y._realImage=v;var _,x,T,A,S,w,L=l.z,k=l.x0,C=l.y0,M=l.w,P=l.h,O=y.dx,F=y.dy;for(w=0;_===void 0&&w<M;)_=a.c2p(k+w*O),w++;for(w=M;x===void 0&&w>0;)x=a.c2p(k+w*O),w--;for(w=0;A===void 0&&w<P;)A=c.c2p(C+w*F),w++;for(w=P;S===void 0&&w>0;)S=c.c2p(C+w*F),w--;x<_&&(T=x,x=_,_=T),S<A&&(T=A,A=S,S=T),!v&&(_=Math.max(-.5*a._length,_),x=Math.min(1.5*a._length,x),A=Math.max(-.5*c._length,A),S=Math.min(1.5*c._length,S));var j=Math.round(x-_),W=Math.round(S-A);if(j<=0||W<=0)d.selectAll("image").data([]).exit().remove();else{var Z=d.selectAll("image").data([n]);Z.enter().append("svg:image").attr({xmlns:p.svg,preserveAspectRatio:"none"}),Z.exit().remove();var Q=y.zsmooth===!1?e.pixelatedStyle:"";if(v){var X=m.simpleMap(a.range,a.r2l),G=m.simpleMap(c.range,c.r2l),Y=X[1]<X[0],K=G[1]>G[0];if(Y||K){var D=_+j/2,B=A+W/2;Q+="transform:"+g(D+"px",B+"px")+"scale("+(Y?-1:1)+","+(K?-1:1)+")"+g(-D+"px",-B+"px")+";"}}Z.attr("style",Q);var q=new Promise(function(J){if(y._hasZ)J();else if(y._hasSource)if(y._canvas&&y._canvas.el.width===M&&y._canvas.el.height===P&&y._canvas.source===y.source)J();else{var $=document.createElement("canvas");$.width=M,$.height=P;var te=$.getContext("2d");y._image=y._image||new Image;var ie=y._image;ie.onload=function(){te.drawImage(ie,0,0),y._canvas={el:$,source:y.source},J()},ie.setAttribute("src",y.source)}}).then(function(){var J;if(y._hasZ)J=ee(function(te,ie){return L[ie][te]}).toDataURL("image/png");else if(y._hasSource)if(v)J=y.source;else{var $=y._canvas.el.getContext("2d").getImageData(0,0,M,P).data;J=ee(function(te,ie){var ae=4*(ie*M+te);return[$[ae],$[ae+1],$[ae+2],$[ae+3]]}).toDataURL("image/png")}Z.attr({"xlink:href":J,height:W,width:j,x:_,y:A})});u._promises.push(q)}function ee(J){var $=document.createElement("canvas");$.width=j,$.height=W;var te,ie=$.getContext("2d"),ae=function(ue){return m.constrain(Math.round(a.c2p(k+ue*O)-_),0,j)},he=function(ue){return m.constrain(Math.round(c.c2p(C+ue*F)-A),0,W)},se=e.colormodel[y.colormodel],de=se.colormodel||y.colormodel,ce=se.fmt;for(w=0;w<l.w;w++){var ve=ae(w),ke=ae(w+1);if(ke!==ve&&!isNaN(ke)&&!isNaN(ve))for(var Ee=0;Ee<l.h;Ee++){var be=he(Ee),xe=he(Ee+1);xe===be||isNaN(xe)||isNaN(be)||!J(w,Ee)||(te=y._scaler(J(w,Ee)),ie.fillStyle=te?de+"("+ce(te).join(",")+")":"rgba(0,0,0,0)",ie.fillRect(ve,be,ke-ve,xe-be))}}return $}})}},{"../../constants/xmlns_namespaces":764,"../../lib":787,"./constants":1123,"@plotly/d3":58}],1130:[function(h,N,H){var t=h("@plotly/d3");N.exports=function(m){t.select(m).selectAll(".im image").style("opacity",function(g){return g[0].trace.opacity})}},{"@plotly/d3":58}],1131:[function(h,N,H){var t=h("../../lib/extend").extendFlat,m=h("../../lib/extend").extendDeep,g=h("../../plot_api/edit_types").overrideAll,p=h("../../plots/font_attributes"),e=h("../../components/color/attributes"),f=h("../../plots/domain").attributes,u=h("../../plots/cartesian/layout_attributes"),i=h("../../plot_api/plot_template").templatedArray,s=h("../../constants/delta.js"),o=h("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,a=p({editType:"plot",colorEditType:"plot"}),c={color:{valType:"color",editType:"plot"},line:{color:{valType:"color",dflt:e.defaultLine,editType:"plot"},width:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},thickness:{valType:"number",min:0,max:1,dflt:1,editType:"plot"},editType:"calc"},r={valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},n=i("step",m({},c,{range:r}));N.exports={mode:{valType:"flaglist",editType:"calc",flags:["number","delta","gauge"],dflt:"number"},value:{valType:"number",editType:"calc",anim:!0},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},domain:f({name:"indicator",trace:!0,editType:"calc"}),title:{text:{valType:"string",editType:"plot"},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},font:t({},a,{}),editType:"plot"},number:{valueformat:{valType:"string",dflt:"",editType:"plot",description:o("value")},font:t({},a,{}),prefix:{valType:"string",dflt:"",editType:"plot"},suffix:{valType:"string",dflt:"",editType:"plot"},editType:"plot"},delta:{reference:{valType:"number",editType:"calc"},position:{valType:"enumerated",values:["top","bottom","left","right"],dflt:"bottom",editType:"plot"},relative:{valType:"boolean",editType:"plot",dflt:!1},valueformat:{valType:"string",editType:"plot",description:o("value")},increasing:{symbol:{valType:"string",dflt:s.INCREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:s.INCREASING.COLOR,editType:"plot"},editType:"plot"},decreasing:{symbol:{valType:"string",dflt:s.DECREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:s.DECREASING.COLOR,editType:"plot"},editType:"plot"},font:t({},a,{}),editType:"calc"},gauge:{shape:{valType:"enumerated",editType:"plot",dflt:"angular",values:["angular","bullet"]},bar:m({},c,{color:{dflt:"green"}}),bgcolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:e.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:1,editType:"plot"},axis:g({range:r,visible:t({},u.visible,{dflt:!0}),tickmode:u.tickmode,nticks:u.nticks,tick0:u.tick0,dtick:u.dtick,tickvals:u.tickvals,ticktext:u.ticktext,ticks:t({},u.ticks,{dflt:"outside"}),ticklen:u.ticklen,tickwidth:u.tickwidth,tickcolor:u.tickcolor,showticklabels:u.showticklabels,tickfont:p({}),tickangle:u.tickangle,tickformat:u.tickformat,tickformatstops:u.tickformatstops,tickprefix:u.tickprefix,showtickprefix:u.showtickprefix,ticksuffix:u.ticksuffix,showticksuffix:u.showticksuffix,separatethousands:u.separatethousands,exponentformat:u.exponentformat,minexponent:u.minexponent,showexponent:u.showexponent,editType:"plot"},"plot"),steps:n,threshold:{line:{color:t({},c.line.color,{}),width:t({},c.line.width,{dflt:1}),editType:"plot"},thickness:t({},c.thickness,{dflt:.85}),value:{valType:"number",editType:"calc",dflt:!1},editType:"plot"},editType:"plot"}}},{"../../components/color/attributes":649,"../../constants/delta.js":757,"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plot_api/plot_template":827,"../../plots/cartesian/axis_format_attributes":841,"../../plots/cartesian/layout_attributes":853,"../../plots/domain":866,"../../plots/font_attributes":867}],1132:[function(h,N,H){var t=h("../../plots/plots");H.name="indicator",H.plot=function(m,g,p,e){t.plotBasePlot(H.name,m,g,p,e)},H.clean=function(m,g,p,e){t.cleanBasePlot(H.name,m,g,p,e)}},{"../../plots/plots":901}],1133:[function(h,N,H){N.exports={calc:function(t,m){var g=[],p=m.value;typeof m._lastValue!="number"&&(m._lastValue=m.value);var e=m._lastValue,f=e;return m._hasDelta&&typeof m.delta.reference=="number"&&(f=m.delta.reference),g[0]={y:p,lastY:e,delta:p-f,relativeDelta:(p-f)/f},g}}},{}],1134:[function(h,N,H){N.exports={defaultNumberFontSize:80,bulletNumberDomainSize:.25,bulletPadding:.025,innerRadius:.75,valueThickness:.5,titlePadding:5,horizontalPadding:10}},{}],1135:[function(h,N,H){var t=h("../../lib"),m=h("./attributes"),g=h("../../plots/domain").defaults,p=h("../../plot_api/plot_template"),e=h("../../plots/array_container_defaults"),f=h("./constants.js"),u=h("../../plots/cartesian/tick_value_defaults"),i=h("../../plots/cartesian/tick_mark_defaults"),s=h("../../plots/cartesian/tick_label_defaults");function o(a,c){function r(n,d){return t.coerce(a,c,m.gauge.steps,n,d)}r("color"),r("line.color"),r("line.width"),r("range"),r("thickness")}N.exports={supplyDefaults:function(a,c,r,n){function d(C,M){return t.coerce(a,c,m,C,M)}g(c,n,d),d("mode"),c._hasNumber=c.mode.indexOf("number")!==-1,c._hasDelta=c.mode.indexOf("delta")!==-1,c._hasGauge=c.mode.indexOf("gauge")!==-1;var l=d("value");c._range=[0,typeof l=="number"?1.5*l:1];var y,v,_,x,T,A,S=new Array(2);function w(C,M){return t.coerce(_,x,m.gauge,C,M)}function L(C,M){return t.coerce(T,A,m.gauge.axis,C,M)}if(c._hasNumber&&(d("number.valueformat"),d("number.font.color",n.font.color),d("number.font.family",n.font.family),d("number.font.size"),c.number.font.size===void 0&&(c.number.font.size=f.defaultNumberFontSize,S[0]=!0),d("number.prefix"),d("number.suffix"),y=c.number.font.size),c._hasDelta&&(d("delta.font.color",n.font.color),d("delta.font.family",n.font.family),d("delta.font.size"),c.delta.font.size===void 0&&(c.delta.font.size=(c._hasNumber?.5:1)*(y||f.defaultNumberFontSize),S[1]=!0),d("delta.reference",c.value),d("delta.relative"),d("delta.valueformat",c.delta.relative?"2%":""),d("delta.increasing.symbol"),d("delta.increasing.color"),d("delta.decreasing.symbol"),d("delta.decreasing.color"),d("delta.position"),v=c.delta.font.size),c._scaleNumbers=(!c._hasNumber||S[0])&&(!c._hasDelta||S[1])||!1,d("title.font.color",n.font.color),d("title.font.family",n.font.family),d("title.font.size",.25*(y||v||f.defaultNumberFontSize)),d("title.text"),c._hasGauge){(_=a.gauge)||(_={}),x=p.newContainer(c,"gauge"),w("shape"),(c._isBullet=c.gauge.shape==="bullet")||d("title.align","center"),(c._isAngular=c.gauge.shape==="angular")||d("align","center"),w("bgcolor",n.paper_bgcolor),w("borderwidth"),w("bordercolor"),w("bar.color"),w("bar.line.color"),w("bar.line.width"),w("bar.thickness",f.valueThickness*(c.gauge.shape==="bullet"?.5:1)),e(_,x,{name:"steps",handleItemDefaults:o}),w("threshold.value"),w("threshold.thickness"),w("threshold.line.width"),w("threshold.line.color"),T={},_&&(T=_.axis||{}),A=p.newContainer(x,"axis"),L("visible"),c._range=L("range",c._range);var k={outerTicks:!0};u(T,A,L,"linear"),s(T,A,L,"linear",k),i(T,A,L,k)}else d("title.align","center"),d("align","center"),c._isAngular=c._isBullet=!1;c._length=null}}},{"../../lib":787,"../../plot_api/plot_template":827,"../../plots/array_container_defaults":833,"../../plots/cartesian/tick_label_defaults":860,"../../plots/cartesian/tick_mark_defaults":861,"../../plots/cartesian/tick_value_defaults":862,"../../plots/domain":866,"./attributes":1131,"./constants.js":1134}],1136:[function(h,N,H){N.exports={moduleType:"trace",name:"indicator",basePlotModule:h("./base_plot"),categories:["svg","noOpacity","noHover"],animatable:!0,attributes:h("./attributes"),supplyDefaults:h("./defaults").supplyDefaults,calc:h("./calc").calc,plot:h("./plot"),meta:{}}},{"./attributes":1131,"./base_plot":1132,"./calc":1133,"./defaults":1135,"./plot":1137}],1137:[function(h,N,H){var t=h("@plotly/d3"),m=h("d3-interpolate").interpolate,g=h("d3-interpolate").interpolateNumber,p=h("../../lib"),e=p.strScale,f=p.strTranslate,u=p.rad2deg,i=h("../../constants/alignment").MID_SHIFT,s=h("../../components/drawing"),o=h("./constants"),a=h("../../lib/svg_text_utils"),c=h("../../plots/cartesian/axes"),r=h("../../plots/cartesian/axis_defaults"),n=h("../../plots/cartesian/position_defaults"),d=h("../../plots/cartesian/layout_attributes"),l=h("../../components/color"),y={left:"start",center:"middle",right:"end"},v={left:0,center:.5,right:1},_=/[yzafpn\xb5mkMGTPEZY]/;function x(k){return k&&k.duration>0}function T(k){k.each(function(C){l.stroke(t.select(this),C.line.color)}).each(function(C){l.fill(t.select(this),C.color)}).style("stroke-width",function(C){return C.line.width})}function A(k,C,M){var P=k._fullLayout,O=p.extendFlat({type:"linear",ticks:"outside",range:M,showline:!0},C),F={type:"linear",_id:"x"+C._id},j={letter:"x",font:P.font,noHover:!0,noTickson:!0};function W(Z,Q){return p.coerce(O,F,d,Z,Q)}return r(O,F,W,j,P),n(O,F,W,j),F}function S(k,C,M){return[Math.min(C/k.width,M/k.height),k,C+"x"+M]}function w(k,C,M,P){var O=document.createElementNS("http://www.w3.org/2000/svg","text"),F=t.select(O);return F.text(k).attr("x",0).attr("y",0).attr("text-anchor",M).attr("data-unformatted",k).call(a.convertToTspans,P).call(s.font,C),s.bBox(F.node())}function L(k,C,M,P,O,F){var j="_cache"+C;k[j]&&k[j].key===O||(k[j]={key:O,value:M});var W=p.aggNums(F,null,[k[j].value,P],2);return k[j].value=W,W}N.exports=function(k,C,M,P){var O,F=k._fullLayout;x(M)&&P&&(O=P()),p.makeTraceGroups(F._indicatorlayer,C,"trace").each(function(j){var W,Z,Q,X,G,Y=j[0].trace,K=t.select(this),D=Y._hasGauge,B=Y._isAngular,q=Y._isBullet,ee=Y.domain,J={w:F._size.w*(ee.x[1]-ee.x[0]),h:F._size.h*(ee.y[1]-ee.y[0]),l:F._size.l+F._size.w*ee.x[0],r:F._size.r+F._size.w*(1-ee.x[1]),t:F._size.t+F._size.h*(1-ee.y[1]),b:F._size.b+F._size.h*ee.y[0]},$=J.l+J.w/2,te=J.t+J.h/2,ie=Math.min(J.w/2,J.h),ae=o.innerRadius*ie,he=Y.align||"center";if(Z=te,D){if(B&&(W=$,Z=te+ie/2,Q=function(xe){return function(ue,me){var we=Math.sqrt(ue.width/2*(ue.width/2)+ue.height*ue.height);return[me/we,ue,me]}(xe,.9*ae)}),q){var se=o.bulletPadding,de=1-o.bulletNumberDomainSize+se;W=J.l+(de+(1-de)*v[he])*J.w,Q=function(xe){return S(xe,(o.bulletNumberDomainSize-se)*J.w,J.h)}}}else W=J.l+v[he]*J.w,Q=function(xe){return S(xe,J.w,J.h)};(function(xe,ue,me,we){var Me,Se,De,Fe=me[0].trace,Ye=we.numbersX,et=we.numbersY,Oe=Fe.align||"center",je=y[Oe],We=we.transitionOpts,Ge=we.onComplete,Qe=p.ensureSingle(ue,"g","numbers"),it=[];Fe._hasNumber&&it.push("number"),Fe._hasDelta&&(it.push("delta"),Fe.delta.position==="left"&&it.reverse());var lt=Qe.selectAll("text").data(it);function Lt(He,Be,Je,_e){if(!He.match("s")||Je>=0==_e>=0||Be(Je).slice(-1).match(_)||Be(_e).slice(-1).match(_))return Be;var Le=He.slice().replace("s","f").replace(/\d+/,function(Pe){return parseInt(Pe)-1}),Ce=A(xe,{tickformat:Le});return function(Pe){return Math.abs(Pe)<1?c.tickText(Ce,Pe).text:Be(Pe)}}lt.enter().append("text"),lt.attr("text-anchor",function(){return je}).attr("class",function(He){return He}).attr("x",null).attr("y",null).attr("dx",null).attr("dy",null),lt.exit().remove();var wt,rt=Fe.mode+Fe.align;if(Fe._hasDelta&&(wt=function(){var He=A(xe,{tickformat:Fe.delta.valueformat},Fe._range);He.setScale(),c.prepTicks(He);var Be=function(Xe){return c.tickText(He,Xe).text},Je=function(Xe){return Fe.delta.relative?Xe.relativeDelta:Xe.delta},_e=function(Xe,ut){return Xe===0||typeof Xe!="number"||isNaN(Xe)?"-":(Xe>0?Fe.delta.increasing.symbol:Fe.delta.decreasing.symbol)+ut(Xe)},Le=function(Xe){return Xe.delta>=0?Fe.delta.increasing.color:Fe.delta.decreasing.color};Fe._deltaLastValue===void 0&&(Fe._deltaLastValue=Je(me[0]));var Ce=Qe.select("text.delta");function Pe(){Ce.text(_e(Je(me[0]),Be)).call(l.fill,Le(me[0])).call(a.convertToTspans,xe)}return Ce.call(s.font,Fe.delta.font).call(l.fill,Le({delta:Fe._deltaLastValue})),x(We)?Ce.transition().duration(We.duration).ease(We.easing).tween("text",function(){var Xe=t.select(this),ut=Je(me[0]),kt=Fe._deltaLastValue,ft=Lt(Fe.delta.valueformat,Be,kt,ut),Et=g(kt,ut);return Fe._deltaLastValue=ut,function(mt){Xe.text(_e(Et(mt),ft)),Xe.call(l.fill,Le({delta:Et(mt)}))}}).each("end",function(){Pe(),Ge&&Ge()}).each("interrupt",function(){Pe(),Ge&&Ge()}):Pe(),Se=w(_e(Je(me[0]),Be),Fe.delta.font,je,xe),Ce}(),rt+=Fe.delta.position+Fe.delta.font.size+Fe.delta.font.family+Fe.delta.valueformat,rt+=Fe.delta.increasing.symbol+Fe.delta.decreasing.symbol,De=Se),Fe._hasNumber&&(function(){var He=A(xe,{tickformat:Fe.number.valueformat},Fe._range);He.setScale(),c.prepTicks(He);var Be=function(Pe){return c.tickText(He,Pe).text},Je=Fe.number.suffix,_e=Fe.number.prefix,Le=Qe.select("text.number");function Ce(){var Pe=typeof me[0].y=="number"?_e+Be(me[0].y)+Je:"-";Le.text(Pe).call(s.font,Fe.number.font).call(a.convertToTspans,xe)}x(We)?Le.transition().duration(We.duration).ease(We.easing).each("end",function(){Ce(),Ge&&Ge()}).each("interrupt",function(){Ce(),Ge&&Ge()}).attrTween("text",function(){var Pe=t.select(this),Xe=g(me[0].lastY,me[0].y);Fe._lastValue=me[0].y;var ut=Lt(Fe.number.valueformat,Be,me[0].lastY,me[0].y);return function(kt){Pe.text(_e+ut(Xe(kt))+Je)}}):Ce(),Me=w(_e+Be(me[0].y)+Je,Fe.number.font,je,xe)}(),rt+=Fe.number.font.size+Fe.number.font.family+Fe.number.valueformat+Fe.number.suffix+Fe.number.prefix,De=Me),Fe._hasDelta&&Fe._hasNumber){var $e,xt,Qt=[(Me.left+Me.right)/2,(Me.top+Me.bottom)/2],$t=[(Se.left+Se.right)/2,(Se.top+Se.bottom)/2],Ue=.75*Fe.delta.font.size;Fe.delta.position==="left"&&($e=L(Fe,"deltaPos",0,-1*(Me.width*v[Fe.align]+Se.width*(1-v[Fe.align])+Ue),rt,Math.min),xt=Qt[1]-$t[1],De={width:Me.width+Se.width+Ue,height:Math.max(Me.height,Se.height),left:Se.left+$e,right:Me.right,top:Math.min(Me.top,Se.top+xt),bottom:Math.max(Me.bottom,Se.bottom+xt)}),Fe.delta.position==="right"&&($e=L(Fe,"deltaPos",0,Me.width*(1-v[Fe.align])+Se.width*v[Fe.align]+Ue,rt,Math.max),xt=Qt[1]-$t[1],De={width:Me.width+Se.width+Ue,height:Math.max(Me.height,Se.height),left:Me.left,right:Se.right+$e,top:Math.min(Me.top,Se.top+xt),bottom:Math.max(Me.bottom,Se.bottom+xt)}),Fe.delta.position==="bottom"&&($e=null,xt=Se.height,De={width:Math.max(Me.width,Se.width),height:Me.height+Se.height,left:Math.min(Me.left,Se.left),right:Math.max(Me.right,Se.right),top:Me.bottom-Me.height,bottom:Me.bottom+Se.height}),Fe.delta.position==="top"&&($e=null,xt=Me.top,De={width:Math.max(Me.width,Se.width),height:Me.height+Se.height,left:Math.min(Me.left,Se.left),right:Math.max(Me.right,Se.right),top:Me.bottom-Me.height-Se.height,bottom:Me.bottom}),wt.attr({dx:$e,dy:xt})}(Fe._hasNumber||Fe._hasDelta)&&Qe.attr("transform",function(){var He=we.numbersScaler(De);rt+=He[2];var Be,Je=L(Fe,"numbersScale",1,He[0],rt,Math.min);Fe._scaleNumbers||(Je=1),Be=Fe._isAngular?et-Je*De.bottom:et-Je*(De.top+De.bottom)/2,Fe._numbersTop=Je*De.top+Be;var _e=De[Oe];Oe==="center"&&(_e=(De.left+De.right)/2);var Le=Ye-Je*_e;return Le=L(Fe,"numbersTranslate",0,Le,rt,Math.max),f(Le,Be)+e(Je)})})(k,K,j,{numbersX:W,numbersY:Z,numbersScaler:Q,transitionOpts:M,onComplete:O}),D&&(X={range:Y.gauge.axis.range,color:Y.gauge.bgcolor,line:{color:Y.gauge.bordercolor,width:0},thickness:1},G={range:Y.gauge.axis.range,color:"rgba(0, 0, 0, 0)",line:{color:Y.gauge.bordercolor,width:Y.gauge.borderwidth},thickness:1});var ce=K.selectAll("g.angular").data(B?j:[]);ce.exit().remove();var ve=K.selectAll("g.angularaxis").data(B?j:[]);ve.exit().remove(),B&&function(xe,ue,me,we){var Me,Se,De,Fe,Ye=me[0].trace,et=we.size,Oe=we.radius,je=we.innerRadius,We=we.gaugeBg,Ge=we.gaugeOutline,Qe=[et.l+et.w/2,et.t+et.h/2+Oe/2],it=we.gauge,lt=we.layer,Lt=we.transitionOpts,wt=we.onComplete,rt=Math.PI/2;function $e(vt){var nt=Ye.gauge.axis.range[0],At=(vt-nt)/(Ye.gauge.axis.range[1]-nt)*Math.PI-rt;return At<-rt?-rt:At>rt?rt:At}function xt(vt){return t.svg.arc().innerRadius((je+Oe)/2-vt/2*(Oe-je)).outerRadius((je+Oe)/2+vt/2*(Oe-je)).startAngle(-rt)}function Qt(vt){vt.attr("d",function(nt){return xt(nt.thickness).startAngle($e(nt.range[0])).endAngle($e(nt.range[1]))()})}it.enter().append("g").classed("angular",!0),it.attr("transform",f(Qe[0],Qe[1])),lt.enter().append("g").classed("angularaxis",!0).classed("crisp",!0),lt.selectAll("g.xangularaxistick,path,text").remove(),(Me=A(xe,Ye.gauge.axis)).type="linear",Me.range=Ye.gauge.axis.range,Me._id="xangularaxis",Me.ticklabeloverflow="allow",Me.setScale();var $t=function(vt){return(Me.range[0]-vt.x)/(Me.range[1]-Me.range[0])*Math.PI+Math.PI},Ue={},He=c.makeLabelFns(Me,0).labelStandoff;Ue.xFn=function(vt){var nt=$t(vt);return Math.cos(nt)*He},Ue.yFn=function(vt){var nt=$t(vt),At=Math.sin(nt)>0?.2:1;return-Math.sin(nt)*(He+vt.fontSize*At)+Math.abs(Math.cos(nt))*(vt.fontSize*i)},Ue.anchorFn=function(vt){var nt=$t(vt),At=Math.cos(nt);return Math.abs(At)<.1?"middle":At>0?"start":"end"},Ue.heightFn=function(vt,nt,At){var Ft=$t(vt);return-.5*(1+Math.sin(Ft))*At};var Be=function(vt){return f(Qe[0]+Oe*Math.cos(vt),Qe[1]-Oe*Math.sin(vt))};if(De=function(vt){return Be($t(vt))},Se=c.calcTicks(Me),Fe=c.getTickSigns(Me)[2],Me.visible){Fe=Me.ticks==="inside"?-1:1;var Je=(Me.linewidth||1)/2;c.drawTicks(xe,Me,{vals:Se,layer:lt,path:"M"+Fe*Je+",0h"+Fe*Me.ticklen,transFn:function(vt){var nt=$t(vt);return Be(nt)+"rotate("+-u(nt)+")"}}),c.drawLabels(xe,Me,{vals:Se,layer:lt,transFn:De,labelFns:Ue})}var _e=[We].concat(Ye.gauge.steps),Le=it.selectAll("g.bg-arc").data(_e);Le.enter().append("g").classed("bg-arc",!0).append("path"),Le.select("path").call(Qt).call(T),Le.exit().remove();var Ce=xt(Ye.gauge.bar.thickness),Pe=it.selectAll("g.value-arc").data([Ye.gauge.bar]);Pe.enter().append("g").classed("value-arc",!0).append("path");var Xe=Pe.select("path");x(Lt)?(Xe.transition().duration(Lt.duration).ease(Lt.easing).each("end",function(){wt&&wt()}).each("interrupt",function(){wt&&wt()}).attrTween("d",(ut=Ce,kt=$e(me[0].lastY),ft=$e(me[0].y),function(){var vt=m(kt,ft);return function(nt){return ut.endAngle(vt(nt))()}})),Ye._lastValue=me[0].y):Xe.attr("d",typeof me[0].y=="number"?Ce.endAngle($e(me[0].y)):"M0,0Z");var ut,kt,ft;Xe.call(T),Pe.exit().remove(),_e=[];var Et=Ye.gauge.threshold.value;(Et||Et===0)&&_e.push({range:[Et,Et],color:Ye.gauge.threshold.color,line:{color:Ye.gauge.threshold.line.color,width:Ye.gauge.threshold.line.width},thickness:Ye.gauge.threshold.thickness});var mt=it.selectAll("g.threshold-arc").data(_e);mt.enter().append("g").classed("threshold-arc",!0).append("path"),mt.select("path").call(Qt).call(T),mt.exit().remove();var It=it.selectAll("g.gauge-outline").data([Ge]);It.enter().append("g").classed("gauge-outline",!0).append("path"),It.select("path").call(Qt).call(T),It.exit().remove()}(k,0,j,{radius:ie,innerRadius:ae,gauge:ce,layer:ve,size:J,gaugeBg:X,gaugeOutline:G,transitionOpts:M,onComplete:O});var ke=K.selectAll("g.bullet").data(q?j:[]);ke.exit().remove();var Ee=K.selectAll("g.bulletaxis").data(q?j:[]);Ee.exit().remove(),q&&function(xe,ue,me,we){var Me,Se,De,Fe,Ye,et=me[0].trace,Oe=we.gauge,je=we.layer,We=we.gaugeBg,Ge=we.gaugeOutline,Qe=we.size,it=et.domain,lt=we.transitionOpts,Lt=we.onComplete;Oe.enter().append("g").classed("bullet",!0),Oe.attr("transform",f(Qe.l,Qe.t)),je.enter().append("g").classed("bulletaxis",!0).classed("crisp",!0),je.selectAll("g.xbulletaxistick,path,text").remove();var wt=Qe.h,rt=et.gauge.bar.thickness*wt,$e=it.x[0],xt=it.x[0]+(it.x[1]-it.x[0])*(et._hasNumber||et._hasDelta?1-o.bulletNumberDomainSize:1);(Me=A(xe,et.gauge.axis))._id="xbulletaxis",Me.domain=[$e,xt],Me.setScale(),Se=c.calcTicks(Me),De=c.makeTransTickFn(Me),Fe=c.getTickSigns(Me)[2],Ye=Qe.t+Qe.h,Me.visible&&(c.drawTicks(xe,Me,{vals:Me.ticks==="inside"?c.clipEnds(Me,Se):Se,layer:je,path:c.makeTickPath(Me,Ye,Fe),transFn:De}),c.drawLabels(xe,Me,{vals:Se,layer:je,transFn:De,labelFns:c.makeLabelFns(Me,Ye)}));function Qt(Le){Le.attr("width",function(Ce){return Math.max(0,Me.c2p(Ce.range[1])-Me.c2p(Ce.range[0]))}).attr("x",function(Ce){return Me.c2p(Ce.range[0])}).attr("y",function(Ce){return .5*(1-Ce.thickness)*wt}).attr("height",function(Ce){return Ce.thickness*wt})}var $t=[We].concat(et.gauge.steps),Ue=Oe.selectAll("g.bg-bullet").data($t);Ue.enter().append("g").classed("bg-bullet",!0).append("rect"),Ue.select("rect").call(Qt).call(T),Ue.exit().remove();var He=Oe.selectAll("g.value-bullet").data([et.gauge.bar]);He.enter().append("g").classed("value-bullet",!0).append("rect"),He.select("rect").attr("height",rt).attr("y",(wt-rt)/2).call(T),x(lt)?He.select("rect").transition().duration(lt.duration).ease(lt.easing).each("end",function(){Lt&&Lt()}).each("interrupt",function(){Lt&&Lt()}).attr("width",Math.max(0,Me.c2p(Math.min(et.gauge.axis.range[1],me[0].y)))):He.select("rect").attr("width",typeof me[0].y=="number"?Math.max(0,Me.c2p(Math.min(et.gauge.axis.range[1],me[0].y))):0),He.exit().remove();var Be=me.filter(function(){return et.gauge.threshold.value||et.gauge.threshold.value===0}),Je=Oe.selectAll("g.threshold-bullet").data(Be);Je.enter().append("g").classed("threshold-bullet",!0).append("line"),Je.select("line").attr("x1",Me.c2p(et.gauge.threshold.value)).attr("x2",Me.c2p(et.gauge.threshold.value)).attr("y1",(1-et.gauge.threshold.thickness)/2*wt).attr("y2",(1-(1-et.gauge.threshold.thickness)/2)*wt).call(l.stroke,et.gauge.threshold.line.color).style("stroke-width",et.gauge.threshold.line.width),Je.exit().remove();var _e=Oe.selectAll("g.gauge-outline").data([Ge]);_e.enter().append("g").classed("gauge-outline",!0).append("rect"),_e.select("rect").call(Qt).call(T),_e.exit().remove()}(k,0,j,{gauge:ke,layer:Ee,size:J,gaugeBg:X,gaugeOutline:G,transitionOpts:M,onComplete:O});var be=K.selectAll("text.title").data(j);be.exit().remove(),be.enter().append("text").classed("title",!0),be.attr("text-anchor",function(){return q?y.right:y[Y.title.align]}).text(Y.title.text).call(s.font,Y.title.font).call(a.convertToTspans,k),be.attr("transform",function(){var xe,ue=J.l+J.w*v[Y.title.align],me=o.titlePadding,we=s.bBox(be.node());return D?(B&&(Y.gauge.axis.visible?xe=s.bBox(ve.node()).top-me-we.bottom:xe=J.t+J.h/2-ie/2-we.bottom-me),q&&(xe=Z-(we.top+we.bottom)/2,ue=J.l-o.bulletPadding*J.w)):xe=Y._numbersTop-me-we.bottom,f(ue,xe)})})}},{"../../components/color":650,"../../components/drawing":672,"../../constants/alignment":755,"../../lib":787,"../../lib/svg_text_utils":813,"../../plots/cartesian/axes":838,"../../plots/cartesian/axis_defaults":840,"../../plots/cartesian/layout_attributes":853,"../../plots/cartesian/position_defaults":856,"./constants":1134,"@plotly/d3":58,"d3-interpolate":168}],1138:[function(h,N,H){var t=h("../../components/colorscale/attributes"),m=h("../../plots/cartesian/axis_format_attributes").axisHoverFormat,g=h("../../plots/template_attributes").hovertemplateAttrs,p=h("../mesh3d/attributes"),e=h("../../plots/attributes"),f=h("../../lib/extend").extendFlat,u=h("../../plot_api/edit_types").overrideAll,i=N.exports=u(f({x:{valType:"data_array"},y:{valType:"data_array"},z:{valType:"data_array"},value:{valType:"data_array"},isomin:{valType:"number"},isomax:{valType:"number"},surface:{show:{valType:"boolean",dflt:!0},count:{valType:"integer",dflt:2,min:1},fill:{valType:"number",min:0,max:1,dflt:1},pattern:{valType:"flaglist",flags:["A","B","C","D","E"],extras:["all","odd","even"],dflt:"all"}},spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:.15}},slices:{x:{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}},y:{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}},z:{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}}},caps:{x:{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}},y:{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}},z:{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}}},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:g(),xhoverformat:m("x"),yhoverformat:m("y"),zhoverformat:m("z"),valuehoverformat:m("value",1),showlegend:f({},e.showlegend,{dflt:!1})},t("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:p.opacity,lightposition:p.lightposition,lighting:p.lighting,flatshading:p.flatshading,contour:p.contour,hoverinfo:f({},e.hoverinfo)}),"calc","nested");i.flatshading.dflt=!0,i.lighting.facenormalsepsilon.dflt=0,i.x.editType=i.y.editType=i.z.editType=i.value.editType="calc+clearAxisTypes",i.transforms=void 0},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../mesh3d/attributes":1143}],1139:[function(h,N,H){var t=h("../../components/colorscale/calc"),m=h("../streamtube/calc").processGrid,g=h("../streamtube/calc").filter;N.exports=function(p,e){e._len=Math.min(e.x.length,e.y.length,e.z.length,e.value.length),e._x=g(e.x,e._len),e._y=g(e.y,e._len),e._z=g(e.z,e._len),e._value=g(e.value,e._len);var f=m(e);e._gridFill=f.fill,e._Xs=f.Xs,e._Ys=f.Ys,e._Zs=f.Zs,e._len=f.len;for(var u=1/0,i=-1/0,s=0;s<e._len;s++){var o=e._value[s];u=Math.min(u,o),i=Math.max(i,o)}e._minValues=u,e._maxValues=i,e._vMin=e.isomin===void 0||e.isomin===null?u:e.isomin,e._vMax=e.isomax===void 0||e.isomin===null?i:e.isomax,t(p,e,{vals:[e._vMin,e._vMax],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":658,"../streamtube/calc":1310}],1140:[function(h,N,H){var t=h("gl-mesh3d"),m=h("../../lib/gl_format_color").parseColorScale,g=h("../../lib/str2rgbarray"),p=h("../../components/colorscale").extractOpts,e=h("../../plots/gl3d/zip3"),f=function(a,c){for(var r=c.length-1;r>0;r--){var n=Math.min(c[r],c[r-1]),d=Math.max(c[r],c[r-1]);if(d>n&&n<a&&a<=d)return{id:r,distRatio:(d-a)/(d-n)}}return{id:0,distRatio:0}};function u(a,c,r){this.scene=a,this.uid=r,this.mesh=c,this.name="",this.data=null,this.showContour=!1}var i=u.prototype;i.handlePick=function(a){if(a.object===this.mesh){var c=a.data.index,r=this.data._meshX[c],n=this.data._meshY[c],d=this.data._meshZ[c],l=this.data._Ys.length,y=this.data._Zs.length,v=f(r,this.data._Xs).id,_=f(n,this.data._Ys).id,x=f(d,this.data._Zs).id,T=a.index=x+y*_+y*l*v;a.traceCoordinate=[this.data._meshX[T],this.data._meshY[T],this.data._meshZ[T],this.data._value[T]];var A=this.data.hovertext||this.data.text;return Array.isArray(A)&&A[T]!==void 0?a.textLabel=A[T]:A&&(a.textLabel=A),!0}},i.update=function(a){var c=this.scene,r=c.fullSceneLayout;function n(y,v,_,x){return v.map(function(T){return y.d2l(T,0,x)*_})}this.data=o(a);var d={positions:e(n(r.xaxis,a._meshX,c.dataScale[0],a.xcalendar),n(r.yaxis,a._meshY,c.dataScale[1],a.ycalendar),n(r.zaxis,a._meshZ,c.dataScale[2],a.zcalendar)),cells:e(a._meshI,a._meshJ,a._meshK),lightPosition:[a.lightposition.x,a.lightposition.y,a.lightposition.z],ambient:a.lighting.ambient,diffuse:a.lighting.diffuse,specular:a.lighting.specular,roughness:a.lighting.roughness,fresnel:a.lighting.fresnel,vertexNormalsEpsilon:a.lighting.vertexnormalsepsilon,faceNormalsEpsilon:a.lighting.facenormalsepsilon,opacity:a.opacity,contourEnable:a.contour.show,contourColor:g(a.contour.color).slice(0,3),contourWidth:a.contour.width,useFacetNormals:a.flatshading},l=p(a);d.vertexIntensity=a._meshIntensity,d.vertexIntensityBounds=[l.min,l.max],d.colormap=m(a),this.mesh.update(d)},i.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};var s=["xyz","xzy","yxz","yzx","zxy","zyx"];function o(a){a._meshI=[],a._meshJ=[],a._meshK=[];var c,r,n,d,l,y,v,_=a.surface.show,x=a.spaceframe.show,T=a.surface.fill,A=a.spaceframe.fill,S=!1,w=!1,L=0,k=a._Xs,C=a._Ys,M=a._Zs,P=k.length,O=C.length,F=M.length,j=s.indexOf(a._gridFill.replace(/-/g,"").replace(/\+/g,"")),W=function(Oe,je,We){switch(j){case 5:return We+F*je+F*O*Oe;case 4:return We+F*Oe+F*P*je;case 3:return je+O*We+O*F*Oe;case 2:return je+O*Oe+O*P*We;case 1:return Oe+P*We+P*F*je;default:return Oe+P*je+P*O*We}},Z=a._minValues,Q=a._maxValues,X=a._vMin,G=a._vMax;function Y(Oe,je,We){for(var Ge=y.length,Qe=r;Qe<Ge;Qe++)if(Oe===n[Qe]&&je===d[Qe]&&We===l[Qe])return Qe;return-1}function K(){r=c}function D(){n=[],d=[],l=[],y=[],c=0,K()}function B(Oe,je,We,Ge){return n.push(Oe),d.push(je),l.push(We),y.push(Ge),++c-1}function q(Oe,je,We){for(var Ge=[],Qe=0;Qe<Oe.length;Qe++)Ge[Qe]=Oe[Qe]*(1-We)+We*je[Qe];return Ge}function ee(Oe){v=Oe}function J(Oe,je){return Oe==="all"||Oe===null||Oe.indexOf(je)>-1}function $(Oe,je){return Oe===null?je:Oe}function te(Oe,je,We){K();var Ge,Qe,it,lt=[je],Lt=[We];if(v>=1)lt=[je],Lt=[We];else if(v>0){var wt=function(Je,_e){var Le=Je[0],Ce=Je[1],Pe=Je[2],Xe=function(nt,At,Ft){for(var Nt=[],Kt=0;Kt<nt.length;Kt++)Nt[Kt]=(nt[Kt]+At[Kt]+Ft[Kt])/3;return Nt}(Le,Ce,Pe),ut=Math.sqrt(1-v),kt=q(Xe,Le,ut),ft=q(Xe,Ce,ut),Et=q(Xe,Pe,ut),mt=_e[0],It=_e[1],vt=_e[2];return{xyzv:[[Le,Ce,ft],[ft,kt,Le],[Ce,Pe,Et],[Et,ft,Ce],[Pe,Le,kt],[kt,Et,Pe]],abc:[[mt,It,-1],[-1,-1,mt],[It,vt,-1],[-1,-1,It],[vt,mt,-1],[-1,-1,vt]]}}(je,We);lt=wt.xyzv,Lt=wt.abc}for(var rt=0;rt<lt.length;rt++){je=lt[rt],We=Lt[rt];for(var $e=[],xt=0;xt<3;xt++){var Qt=je[xt][0],$t=je[xt][1],Ue=je[xt][2],He=je[xt][3],Be=We[xt]>-1?We[xt]:Y(Qt,$t,Ue);$e[xt]=Be>-1?Be:B(Qt,$t,Ue,$(Oe,He))}Ge=$e[0],Qe=$e[1],it=$e[2],a._meshI.push(Ge),a._meshJ.push(Qe),a._meshK.push(it),++L}}function ie(Oe,je,We,Ge){var Qe=Oe[3];Qe<We&&(Qe=We),Qe>Ge&&(Qe=Ge);for(var it=(Oe[3]-Qe)/(Oe[3]-je[3]+1e-9),lt=[],Lt=0;Lt<4;Lt++)lt[Lt]=(1-it)*Oe[Lt]+it*je[Lt];return lt}function ae(Oe,je,We){return Oe>=je&&Oe<=We}function he(Oe){var je=.001*(G-X);return Oe>=X-je&&Oe<=G+je}function se(Oe){for(var je=[],We=0;We<4;We++){var Ge=Oe[We];je.push([a._x[Ge],a._y[Ge],a._z[Ge],a._value[Ge]])}return je}function de(Oe,je,We,Ge,Qe,it){it||(it=1),We=[-1,-1,-1];var lt=!1,Lt=[ae(je[0][3],Ge,Qe),ae(je[1][3],Ge,Qe),ae(je[2][3],Ge,Qe)];if(!Lt[0]&&!Lt[1]&&!Lt[2])return!1;var wt=function($e,xt,Qt){return he(xt[0][3])&&he(xt[1][3])&&he(xt[2][3])?(te($e,xt,Qt),!0):it<3&&de($e,xt,Qt,X,G,++it)};if(Lt[0]&&Lt[1]&&Lt[2])return wt(Oe,je,We)||lt;var rt=!1;return[[0,1,2],[2,0,1],[1,2,0]].forEach(function($e){if(Lt[$e[0]]&&Lt[$e[1]]&&!Lt[$e[2]]){var xt=je[$e[0]],Qt=je[$e[1]],$t=je[$e[2]],Ue=ie($t,xt,Ge,Qe),He=ie($t,Qt,Ge,Qe);lt=wt(Oe,[He,Ue,xt],[-1,-1,We[$e[0]]])||lt,lt=wt(Oe,[xt,Qt,He],[We[$e[0]],We[$e[1]],-1])||lt,rt=!0}}),rt||[[0,1,2],[1,2,0],[2,0,1]].forEach(function($e){if(Lt[$e[0]]&&!Lt[$e[1]]&&!Lt[$e[2]]){var xt=je[$e[0]],Qt=je[$e[1]],$t=je[$e[2]],Ue=ie(Qt,xt,Ge,Qe),He=ie($t,xt,Ge,Qe);lt=wt(Oe,[He,Ue,xt],[-1,-1,We[$e[0]]])||lt,rt=!0}}),lt}function ce(Oe,je,We,Ge){var Qe=!1,it=se(je),lt=[ae(it[0][3],We,Ge),ae(it[1][3],We,Ge),ae(it[2][3],We,Ge),ae(it[3][3],We,Ge)];if(!(lt[0]||lt[1]||lt[2]||lt[3]))return Qe;if(lt[0]&&lt[1]&&lt[2]&&lt[3])return w&&(Qe=function(wt,rt,$e){var xt=function(Qt,$t,Ue){te(wt,[rt[Qt],rt[$t],rt[Ue]],[$e[Qt],$e[$t],$e[Ue]])};xt(0,1,2),xt(3,0,1),xt(2,3,0),xt(1,2,3)}(Oe,it,je)||Qe),Qe;var Lt=!1;return[[0,1,2,3],[3,0,1,2],[2,3,0,1],[1,2,3,0]].forEach(function(wt){if(lt[wt[0]]&&lt[wt[1]]&&lt[wt[2]]&&!lt[wt[3]]){var rt=it[wt[0]],$e=it[wt[1]],xt=it[wt[2]],Qt=it[wt[3]];if(w)Qe=te(Oe,[rt,$e,xt],[je[wt[0]],je[wt[1]],je[wt[2]]])||Qe;else{var $t=ie(Qt,rt,We,Ge),Ue=ie(Qt,$e,We,Ge),He=ie(Qt,xt,We,Ge);Qe=te(null,[$t,Ue,He],[-1,-1,-1])||Qe}Lt=!0}}),Lt||([[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2],[0,2,3,1],[1,3,2,0]].forEach(function(wt){if(lt[wt[0]]&&lt[wt[1]]&&!lt[wt[2]]&&!lt[wt[3]]){var rt=it[wt[0]],$e=it[wt[1]],xt=it[wt[2]],Qt=it[wt[3]],$t=ie(xt,rt,We,Ge),Ue=ie(xt,$e,We,Ge),He=ie(Qt,$e,We,Ge),Be=ie(Qt,rt,We,Ge);w?(Qe=te(Oe,[rt,Be,$t],[je[wt[0]],-1,-1])||Qe,Qe=te(Oe,[$e,Ue,He],[je[wt[1]],-1,-1])||Qe):Qe=function(Je,_e,Le){var Ce=function(Pe,Xe,ut){te(Je,[_e[Pe],_e[Xe],_e[ut]],[Le[Pe],Le[Xe],Le[ut]])};Ce(0,1,2),Ce(2,3,0)}(null,[$t,Ue,He,Be],[-1,-1,-1,-1])||Qe,Lt=!0}}),Lt||[[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2]].forEach(function(wt){if(lt[wt[0]]&&!lt[wt[1]]&&!lt[wt[2]]&&!lt[wt[3]]){var rt=it[wt[0]],$e=it[wt[1]],xt=it[wt[2]],Qt=it[wt[3]],$t=ie($e,rt,We,Ge),Ue=ie(xt,rt,We,Ge),He=ie(Qt,rt,We,Ge);w?(Qe=te(Oe,[rt,$t,Ue],[je[wt[0]],-1,-1])||Qe,Qe=te(Oe,[rt,Ue,He],[je[wt[0]],-1,-1])||Qe,Qe=te(Oe,[rt,He,$t],[je[wt[0]],-1,-1])||Qe):Qe=te(null,[$t,Ue,He],[-1,-1,-1])||Qe,Lt=!0}})),Qe}function ve(Oe,je,We,Ge,Qe,it,lt,Lt,wt,rt,$e){var xt=!1;return S&&(J(Oe,"A")&&(xt=ce(null,[je,We,Ge,it],rt,$e)||xt),J(Oe,"B")&&(xt=ce(null,[We,Ge,Qe,wt],rt,$e)||xt),J(Oe,"C")&&(xt=ce(null,[We,it,lt,wt],rt,$e)||xt),J(Oe,"D")&&(xt=ce(null,[Ge,it,Lt,wt],rt,$e)||xt),J(Oe,"E")&&(xt=ce(null,[We,Ge,it,wt],rt,$e)||xt)),w&&(xt=ce(Oe,[We,Ge,it,wt],rt,$e)||xt),xt}function ke(Oe,je,We,Ge,Qe,it,lt,Lt){return[Lt[0]===!0||de(Oe,se([je,We,Ge]),[je,We,Ge],it,lt),Lt[1]===!0||de(Oe,se([Ge,Qe,je]),[Ge,Qe,je],it,lt)]}function Ee(Oe,je,We,Ge,Qe,it,lt,Lt,wt){return Lt?ke(Oe,je,We,Qe,Ge,it,lt,wt):ke(Oe,We,Qe,Ge,je,it,lt,wt)}function be(Oe,je,We,Ge,Qe,it,lt){var Lt,wt,rt,$e,xt=!1,Qt=function(){xt=de(Oe,[Lt,wt,rt],[-1,-1,-1],Qe,it)||xt,xt=de(Oe,[rt,$e,Lt],[-1,-1,-1],Qe,it)||xt},$t=lt[0],Ue=lt[1],He=lt[2];return $t&&(Lt=q(se([W(je,We-0,Ge-0)])[0],se([W(je-1,We-0,Ge-0)])[0],$t),wt=q(se([W(je,We-0,Ge-1)])[0],se([W(je-1,We-0,Ge-1)])[0],$t),rt=q(se([W(je,We-1,Ge-1)])[0],se([W(je-1,We-1,Ge-1)])[0],$t),$e=q(se([W(je,We-1,Ge-0)])[0],se([W(je-1,We-1,Ge-0)])[0],$t),Qt()),Ue&&(Lt=q(se([W(je-0,We,Ge-0)])[0],se([W(je-0,We-1,Ge-0)])[0],Ue),wt=q(se([W(je-0,We,Ge-1)])[0],se([W(je-0,We-1,Ge-1)])[0],Ue),rt=q(se([W(je-1,We,Ge-1)])[0],se([W(je-1,We-1,Ge-1)])[0],Ue),$e=q(se([W(je-1,We,Ge-0)])[0],se([W(je-1,We-1,Ge-0)])[0],Ue),Qt()),He&&(Lt=q(se([W(je-0,We-0,Ge)])[0],se([W(je-0,We-0,Ge-1)])[0],He),wt=q(se([W(je-0,We-1,Ge)])[0],se([W(je-0,We-1,Ge-1)])[0],He),rt=q(se([W(je-1,We-1,Ge)])[0],se([W(je-1,We-1,Ge-1)])[0],He),$e=q(se([W(je-1,We-0,Ge)])[0],se([W(je-1,We-0,Ge-1)])[0],He),Qt()),xt}function xe(Oe,je,We,Ge,Qe,it,lt,Lt,wt,rt,$e,xt){var Qt=Oe;return xt?(S&&Oe==="even"&&(Qt=null),ve(Qt,je,We,Ge,Qe,it,lt,Lt,wt,rt,$e)):(S&&Oe==="odd"&&(Qt=null),ve(Qt,wt,Lt,lt,it,Qe,Ge,We,je,rt,$e))}function ue(Oe,je,We,Ge,Qe){for(var it=[],lt=0,Lt=0;Lt<je.length;Lt++)for(var wt=je[Lt],rt=1;rt<F;rt++)for(var $e=1;$e<O;$e++)it.push(Ee(Oe,W(wt,$e-1,rt-1),W(wt,$e-1,rt),W(wt,$e,rt-1),W(wt,$e,rt),We,Ge,(wt+$e+rt)%2,Qe&&Qe[lt]?Qe[lt]:[])),lt++;return it}function me(Oe,je,We,Ge,Qe){for(var it=[],lt=0,Lt=0;Lt<je.length;Lt++)for(var wt=je[Lt],rt=1;rt<P;rt++)for(var $e=1;$e<F;$e++)it.push(Ee(Oe,W(rt-1,wt,$e-1),W(rt,wt,$e-1),W(rt-1,wt,$e),W(rt,wt,$e),We,Ge,(rt+wt+$e)%2,Qe&&Qe[lt]?Qe[lt]:[])),lt++;return it}function we(Oe,je,We,Ge,Qe){for(var it=[],lt=0,Lt=0;Lt<je.length;Lt++)for(var wt=je[Lt],rt=1;rt<O;rt++)for(var $e=1;$e<P;$e++)it.push(Ee(Oe,W($e-1,rt-1,wt),W($e-1,rt,wt),W($e,rt-1,wt),W($e,rt,wt),We,Ge,($e+rt+wt)%2,Qe&&Qe[lt]?Qe[lt]:[])),lt++;return it}function Me(Oe,je,We){for(var Ge=1;Ge<F;Ge++)for(var Qe=1;Qe<O;Qe++)for(var it=1;it<P;it++)xe(Oe,W(it-1,Qe-1,Ge-1),W(it-1,Qe-1,Ge),W(it-1,Qe,Ge-1),W(it-1,Qe,Ge),W(it,Qe-1,Ge-1),W(it,Qe-1,Ge),W(it,Qe,Ge-1),W(it,Qe,Ge),je,We,(it+Qe+Ge)%2)}function Se(Oe,je,We){S=!0,Me(Oe,je,We),S=!1}function De(Oe,je,We,Ge,Qe,it){for(var lt=[],Lt=0,wt=0;wt<je.length;wt++)for(var rt=je[wt],$e=1;$e<F;$e++)for(var xt=1;xt<O;xt++)lt.push(be(Oe,rt,xt,$e,We,Ge,Qe[wt],it&&it[Lt]&&it[Lt])),Lt++;return lt}function Fe(Oe,je,We,Ge,Qe,it){for(var lt=[],Lt=0,wt=0;wt<je.length;wt++)for(var rt=je[wt],$e=1;$e<P;$e++)for(var xt=1;xt<F;xt++)lt.push(be(Oe,$e,rt,xt,We,Ge,Qe[wt],it&&it[Lt]&&it[Lt])),Lt++;return lt}function Ye(Oe,je,We,Ge,Qe,it){for(var lt=[],Lt=0,wt=0;wt<je.length;wt++)for(var rt=je[wt],$e=1;$e<O;$e++)for(var xt=1;xt<P;xt++)lt.push(be(Oe,xt,$e,rt,We,Ge,Qe[wt],it&&it[Lt]&&it[Lt])),Lt++;return lt}function et(Oe,je){for(var We=[],Ge=Oe;Ge<je;Ge++)We.push(Ge);return We}return function(){if(D(),function(){for(var Lt=0;Lt<P;Lt++)for(var wt=0;wt<O;wt++)for(var rt=0;rt<F;rt++){var $e=W(Lt,wt,rt);B(a._x[$e],a._y[$e],a._z[$e],a._value[$e])}}(),x&&A&&(ee(A),w=!0,Me(null,X,G),w=!1),_&&T){ee(T);for(var Oe=a.surface.pattern,je=a.surface.count,We=0;We<je;We++){var Ge=je===1?.5:We/(je-1),Qe=(1-Ge)*X+Ge*G,it=Math.abs(Qe-Z)>Math.abs(Qe-Q)?[Z,Qe]:[Qe,Q];Se(Oe,it[0],it[1])}}var lt=[[Math.min(X,Q),Math.max(X,Q)],[Math.min(Z,G),Math.max(Z,G)]];["x","y","z"].forEach(function(Lt){for(var wt=[],rt=0;rt<lt.length;rt++){var $e=0,xt=lt[rt][0],Qt=lt[rt][1],$t=a.slices[Lt];if($t.show&&$t.fill){ee($t.fill);var Ue=[],He=[],Be=[];if($t.locations.length)for(var Je=0;Je<$t.locations.length;Je++){var _e=f($t.locations[Je],Lt==="x"?k:Lt==="y"?C:M);_e.distRatio===0?Ue.push(_e.id):_e.id>0&&(He.push(_e.id),Lt==="x"?Be.push([_e.distRatio,0,0]):Lt==="y"?Be.push([0,_e.distRatio,0]):Be.push([0,0,_e.distRatio]))}else Ue=et(1,Lt==="x"?P-1:Lt==="y"?O-1:F-1);He.length>0&&(wt[$e]=Lt==="x"?De(null,He,xt,Qt,Be,wt[$e]):Lt==="y"?Fe(null,He,xt,Qt,Be,wt[$e]):Ye(null,He,xt,Qt,Be,wt[$e]),$e++),Ue.length>0&&(wt[$e]=Lt==="x"?ue(null,Ue,xt,Qt,wt[$e]):Lt==="y"?me(null,Ue,xt,Qt,wt[$e]):we(null,Ue,xt,Qt,wt[$e]),$e++)}var Le=a.caps[Lt];Le.show&&Le.fill&&(ee(Le.fill),wt[$e]=Lt==="x"?ue(null,[0,P-1],xt,Qt,wt[$e]):Lt==="y"?me(null,[0,O-1],xt,Qt,wt[$e]):we(null,[0,F-1],xt,Qt,wt[$e]),$e++)}}),L===0&&D(),a._meshX=n,a._meshY=d,a._meshZ=l,a._meshIntensity=y,a._Xs=k,a._Ys=C,a._Zs=M}(),a}N.exports={findNearestOnAxis:f,generateIsoMeshes:o,createIsosurfaceTrace:function(a,c){var r=a.glplot.gl,n=t({gl:r}),d=new u(a,n,c.uid);return n._trace=d,d.update(c),a.glplot.add(n),d}}},{"../../components/colorscale":662,"../../lib/gl_format_color":783,"../../lib/str2rgbarray":812,"../../plots/gl3d/zip3":891,"gl-mesh3d":309}],1141:[function(h,N,H){var t=h("../../lib"),m=h("../../registry"),g=h("./attributes"),p=h("../../components/colorscale/defaults");function e(f,u,i,s,o){var a=o("isomin"),c=o("isomax");c!=null&&a!=null&&a>c&&(u.isomin=null,u.isomax=null);var r=o("x"),n=o("y"),d=o("z"),l=o("value");r&&r.length&&n&&n.length&&d&&d.length&&l&&l.length?(m.getComponentMethod("calendars","handleTraceDefaults")(f,u,["x","y","z"],s),o("valuehoverformat"),["x","y","z"].forEach(function(y){o(y+"hoverformat");var v="caps."+y;o(v+".show")&&o(v+".fill");var _="slices."+y;o(_+".show")&&(o(_+".fill"),o(_+".locations"))}),o("spaceframe.show")&&o("spaceframe.fill"),o("surface.show")&&(o("surface.count"),o("surface.fill"),o("surface.pattern")),o("contour.show")&&(o("contour.color"),o("contour.width")),["text","hovertext","hovertemplate","lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","opacity"].forEach(function(y){o(y)}),p(f,u,s,o,{prefix:"",cLetter:"c"}),u._length=null):u.visible=!1}N.exports={supplyDefaults:function(f,u,i,s){e(f,u,i,s,function(o,a){return t.coerce(f,u,g,o,a)})},supplyIsoDefaults:e}},{"../../components/colorscale/defaults":660,"../../lib":787,"../../registry":915,"./attributes":1138}],1142:[function(h,N,H){N.exports={attributes:h("./attributes"),supplyDefaults:h("./defaults").supplyDefaults,calc:h("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:h("./convert").createIsosurfaceTrace,moduleType:"trace",name:"isosurface",basePlotModule:h("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":880,"./attributes":1138,"./calc":1139,"./convert":1140,"./defaults":1141}],1143:[function(h,N,H){var t=h("../../components/colorscale/attributes"),m=h("../../plots/cartesian/axis_format_attributes").axisHoverFormat,g=h("../../plots/template_attributes").hovertemplateAttrs,p=h("../surface/attributes"),e=h("../../plots/attributes"),f=h("../../lib/extend").extendFlat;N.exports=f({x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},i:{valType:"data_array",editType:"calc"},j:{valType:"data_array",editType:"calc"},k:{valType:"data_array",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:g({editType:"calc"}),xhoverformat:m("x"),yhoverformat:m("y"),zhoverformat:m("z"),delaunayaxis:{valType:"enumerated",values:["x","y","z"],dflt:"z",editType:"calc"},alphahull:{valType:"number",dflt:-1,editType:"calc"},intensity:{valType:"data_array",editType:"calc"},intensitymode:{valType:"enumerated",values:["vertex","cell"],dflt:"vertex",editType:"calc"},color:{valType:"color",editType:"calc"},vertexcolor:{valType:"data_array",editType:"calc"},facecolor:{valType:"data_array",editType:"calc"},transforms:void 0},t("",{colorAttr:"`intensity`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:p.opacity,flatshading:{valType:"boolean",dflt:!1,editType:"calc"},contour:{show:f({},p.contours.x.show,{}),color:p.contours.x.color,width:p.contours.x.width,editType:"calc"},lightposition:{x:f({},p.lightposition.x,{dflt:1e5}),y:f({},p.lightposition.y,{dflt:1e5}),z:f({},p.lightposition.z,{dflt:0}),editType:"calc"},lighting:f({vertexnormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-12,editType:"calc"},facenormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-6,editType:"calc"},editType:"calc"},p.lighting),hoverinfo:f({},e.hoverinfo,{editType:"calc"}),showlegend:f({},e.showlegend,{dflt:!1})})},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../surface/attributes":1326}],1144:[function(h,N,H){var t=h("../../components/colorscale/calc");N.exports=function(m,g){g.intensity&&t(m,g,{vals:g.intensity,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":658}],1145:[function(h,N,H){var t=h("gl-mesh3d"),m=h("delaunay-triangulate"),g=h("alpha-shape"),p=h("convex-hull"),e=h("../../lib/gl_format_color").parseColorScale,f=h("../../lib/str2rgbarray"),u=h("../../components/colorscale").extractOpts,i=h("../../plots/gl3d/zip3");function s(d,l,y){this.scene=d,this.uid=y,this.mesh=l,this.name="",this.color="#fff",this.data=null,this.showContour=!1}var o=s.prototype;function a(d){for(var l=[],y=d.length,v=0;v<y;v++)l[v]=f(d[v]);return l}function c(d,l,y,v){for(var _=[],x=l.length,T=0;T<x;T++)_[T]=d.d2l(l[T],0,v)*y;return _}function r(d){for(var l=[],y=d.length,v=0;v<y;v++)l[v]=Math.round(d[v]);return l}function n(d,l){for(var y=d.length,v=0;v<y;v++)if(d[v]<=-.5||d[v]>=l-.5)return!1;return!0}o.handlePick=function(d){if(d.object===this.mesh){var l=d.index=d.data.index;d.data._cellCenter?d.traceCoordinate=d.data.dataCoordinate:d.traceCoordinate=[this.data.x[l],this.data.y[l],this.data.z[l]];var y=this.data.hovertext||this.data.text;return Array.isArray(y)&&y[l]!==void 0?d.textLabel=y[l]:y&&(d.textLabel=y),!0}},o.update=function(d){var l=this.scene,y=l.fullSceneLayout;this.data=d;var v,_=d.x.length,x=i(c(y.xaxis,d.x,l.dataScale[0],d.xcalendar),c(y.yaxis,d.y,l.dataScale[1],d.ycalendar),c(y.zaxis,d.z,l.dataScale[2],d.zcalendar));if(d.i&&d.j&&d.k){if(d.i.length!==d.j.length||d.j.length!==d.k.length||!n(d.i,_)||!n(d.j,_)||!n(d.k,_))return;v=i(r(d.i),r(d.j),r(d.k))}else v=d.alphahull===0?p(x):d.alphahull>0?g(d.alphahull,x):function(w,L){for(var k=["x","y","z"].indexOf(w),C=[],M=L.length,P=0;P<M;P++)C[P]=[L[P][(k+1)%3],L[P][(k+2)%3]];return m(C)}(d.delaunayaxis,x);var T={positions:x,cells:v,lightPosition:[d.lightposition.x,d.lightposition.y,d.lightposition.z],ambient:d.lighting.ambient,diffuse:d.lighting.diffuse,specular:d.lighting.specular,roughness:d.lighting.roughness,fresnel:d.lighting.fresnel,vertexNormalsEpsilon:d.lighting.vertexnormalsepsilon,faceNormalsEpsilon:d.lighting.facenormalsepsilon,opacity:d.opacity,contourEnable:d.contour.show,contourColor:f(d.contour.color).slice(0,3),contourWidth:d.contour.width,useFacetNormals:d.flatshading};if(d.intensity){var A=u(d);this.color="#fff";var S=d.intensitymode;T[S+"Intensity"]=d.intensity,T[S+"IntensityBounds"]=[A.min,A.max],T.colormap=e(d)}else d.vertexcolor?(this.color=d.vertexcolor[0],T.vertexColors=a(d.vertexcolor)):d.facecolor?(this.color=d.facecolor[0],T.cellColors=a(d.facecolor)):(this.color=d.color,T.meshColor=f(d.color));this.mesh.update(T)},o.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},N.exports=function(d,l){var y=d.glplot.gl,v=t({gl:y}),_=new s(d,v,l.uid);return v._trace=_,_.update(l),d.glplot.add(v),_}},{"../../components/colorscale":662,"../../lib/gl_format_color":783,"../../lib/str2rgbarray":812,"../../plots/gl3d/zip3":891,"alpha-shape":75,"convex-hull":141,"delaunay-triangulate":177,"gl-mesh3d":309}],1146:[function(h,N,H){var t=h("../../registry"),m=h("../../lib"),g=h("../../components/colorscale/defaults"),p=h("./attributes");N.exports=function(e,f,u,i){function s(a,c){return m.coerce(e,f,p,a,c)}function o(a){var c=a.map(function(r){var n=s(r);return n&&m.isArrayOrTypedArray(n)?n:null});return c.every(function(r){return r&&r.length===c[0].length})&&c}o(["x","y","z"])?(o(["i","j","k"]),(!f.i||f.j&&f.k)&&(!f.j||f.k&&f.i)&&(!f.k||f.i&&f.j)?(t.getComponentMethod("calendars","handleTraceDefaults")(e,f,["x","y","z"],i),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","alphahull","delaunayaxis","opacity"].forEach(function(a){s(a)}),s("contour.show")&&(s("contour.color"),s("contour.width")),"intensity"in e?(s("intensity"),s("intensitymode"),g(e,f,i,s,{prefix:"",cLetter:"c"})):(f.showscale=!1,"facecolor"in e?s("facecolor"):"vertexcolor"in e?s("vertexcolor"):s("color",u)),s("text"),s("hovertext"),s("hovertemplate"),s("xhoverformat"),s("yhoverformat"),s("zhoverformat"),f._length=null):f.visible=!1):f.visible=!1}},{"../../components/colorscale/defaults":660,"../../lib":787,"../../registry":915,"./attributes":1143}],1147:[function(h,N,H){N.exports={attributes:h("./attributes"),supplyDefaults:h("./defaults"),calc:h("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:h("./convert"),moduleType:"trace",name:"mesh3d",basePlotModule:h("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":880,"./attributes":1143,"./calc":1144,"./convert":1145,"./defaults":1146}],1148:[function(h,N,H){var t=h("../../lib").extendFlat,m=h("../scatter/attributes"),g=h("../../plots/cartesian/axis_format_attributes").axisHoverFormat,p=h("../../components/drawing/attributes").dash,e=h("../../components/fx/attributes"),f=h("../../constants/delta.js"),u=f.INCREASING.COLOR,i=f.DECREASING.COLOR,s=m.line;function o(a){return{line:{color:t({},s.color,{dflt:a}),width:s.width,dash:p,editType:"style"},editType:"style"}}N.exports={xperiod:m.xperiod,xperiod0:m.xperiod0,xperiodalignment:m.xperiodalignment,xhoverformat:g("x"),yhoverformat:g("y"),x:{valType:"data_array",editType:"calc+clearAxisTypes"},open:{valType:"data_array",editType:"calc"},high:{valType:"data_array",editType:"calc"},low:{valType:"data_array",editType:"calc"},close:{valType:"data_array",editType:"calc"},line:{width:t({},s.width,{}),dash:t({},p,{}),editType:"style"},increasing:o(u),decreasing:o(i),text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},tickwidth:{valType:"number",min:0,max:.5,dflt:.3,editType:"calc"},hoverlabel:t({},e.hoverlabel,{split:{valType:"boolean",dflt:!1,editType:"style"}})}},{"../../components/drawing/attributes":671,"../../components/fx/attributes":681,"../../constants/delta.js":757,"../../lib":787,"../../plots/cartesian/axis_format_attributes":841,"../scatter/attributes":1202}],1149:[function(h,N,H){var t=h("../../lib"),m=t._,g=h("../../plots/cartesian/axes"),p=h("../../plots/cartesian/align_period"),e=h("../../constants/numerical").BADNUM;function f(i,s,o,a){return{o:i,h:s,l:o,c:a}}function u(i,s,o,a,c,r){for(var n=c.makeCalcdata(s,"open"),d=c.makeCalcdata(s,"high"),l=c.makeCalcdata(s,"low"),y=c.makeCalcdata(s,"close"),v=Array.isArray(s.text),_=Array.isArray(s.hovertext),x=!0,T=null,A=!!s.xperiodalignment,S=[],w=0;w<a.length;w++){var L=a[w],k=n[w],C=d[w],M=l[w],P=y[w];if(L!==e&&k!==e&&C!==e&&M!==e&&P!==e){P===k?T!==null&&P!==T&&(x=P>T):x=P>k,T=P;var O=r(k,C,M,P);O.pos=L,O.yc=(k+P)/2,O.i=w,O.dir=x?"increasing":"decreasing",O.x=O.pos,O.y=[M,C],A&&(O.orig_p=o[w]),v&&(O.tx=s.text[w]),_&&(O.htx=s.hovertext[w]),S.push(O)}else S.push({pos:L,empty:!0})}return s._extremes[c._id]=g.findExtremes(c,t.concat(l,d),{padded:!0}),S.length&&(S[0].t={labels:{open:m(i,"open:")+" ",high:m(i,"high:")+" ",low:m(i,"low:")+" ",close:m(i,"close:")+" "}}),S}N.exports={calc:function(i,s){var o=g.getFromId(i,s.xaxis),a=g.getFromId(i,s.yaxis),c=function(y,v,_){var x=_._minDiff;if(!x){var T,A=y._fullData,S=[];for(x=1/0,T=0;T<A.length;T++){var w=A[T];if(w.type==="ohlc"&&w.visible===!0&&w.xaxis===v._id){S.push(w);var L=v.makeCalcdata(w,"x");w._origX=L;var k=p(_,v,"x",L).vals;w._xcalc=k;var C=t.distinctVals(k).minDiff;C&&isFinite(C)&&(x=Math.min(x,C))}}for(x===1/0&&(x=1),T=0;T<S.length;T++)S[T]._minDiff=x}return x*_.tickwidth}(i,o,s),r=s._minDiff;s._minDiff=null;var n=s._origX;s._origX=null;var d=s._xcalc;s._xcalc=null;var l=u(i,s,n,d,a,f);return s._extremes[o._id]=g.findExtremes(o,d,{vpad:r/2}),l.length?(t.extendFlat(l[0].t,{wHover:r/2,tickLen:c}),l):[{t:{empty:!0}}]},calcCommon:u}},{"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/align_period":835,"../../plots/cartesian/axes":838}],1150:[function(h,N,H){var t=h("../../lib"),m=h("./ohlc_defaults"),g=h("../scatter/period_defaults"),p=h("./attributes");function e(f,u,i,s){i(s+".line.color"),i(s+".line.width",u.line.width),i(s+".line.dash",u.line.dash)}N.exports=function(f,u,i,s){function o(a,c){return t.coerce(f,u,p,a,c)}m(f,u,o,s)?(g(f,u,s,o,{x:!0}),o("xhoverformat"),o("yhoverformat"),o("line.width"),o("line.dash"),e(f,u,o,"increasing"),e(f,u,o,"decreasing"),o("text"),o("hovertext"),o("tickwidth"),s._requestRangeslider[u.xaxis]=!0):u.visible=!1}},{"../../lib":787,"../scatter/period_defaults":1222,"./attributes":1148,"./ohlc_defaults":1153}],1151:[function(h,N,H){var t=h("../../plots/cartesian/axes"),m=h("../../lib"),g=h("../../components/fx"),p=h("../../components/color"),e=h("../../lib").fillText,f=h("../../constants/delta.js"),u={increasing:f.INCREASING.SYMBOL,decreasing:f.DECREASING.SYMBOL};function i(a,c,r,n){var d,l,y=a.cd,v=a.xa,_=y[0].trace,x=y[0].t,T=_.type,A=T==="ohlc"?"l":"min",S=T==="ohlc"?"h":"max",w=x.bPos||0,L=x.bdPos||x.tickLen,k=x.wHover,C=Math.min(1,L/Math.abs(v.r2c(v.range[1])-v.r2c(v.range[0])));function M(Q){var X=function(G){return G.pos+w-c}(Q);return g.inbox(X-k,X+k,d)}function P(Q){var X=Q[A],G=Q[S];return X===G||g.inbox(X-r,G-r,d)}function O(Q){return(M(Q)+P(Q))/2}d=a.maxHoverDistance-C,l=a.maxSpikeDistance-C;var F=g.getDistanceFunction(n,M,P,O);if(g.getClosest(y,F,a),a.index===!1)return null;var j=y[a.index];if(j.empty)return null;var W=_[j.dir],Z=W.line.color;return p.opacity(Z)&&W.line.width?a.color=Z:a.color=W.fillcolor,a.x0=v.c2p(j.pos+w-L,!0),a.x1=v.c2p(j.pos+w+L,!0),a.xLabelVal=j.orig_p!==void 0?j.orig_p:j.pos,a.spikeDistance=O(j)*l/d,a.xSpike=v.c2p(j.pos,!0),a}function s(a,c,r,n){var d=a.cd,l=a.ya,y=d[0].trace,v=d[0].t,_=[],x=i(a,c,r,n);if(!x)return[];var T=d[x.index].hi||y.hoverinfo,A=T.split("+");if(!(T==="all"||A.indexOf("y")!==-1))return[];for(var S=["high","open","close","low"],w={},L=0;L<S.length;L++){var k,C=S[L],M=y[C][x.index],P=l.c2p(M,!0);M in w?(k=w[M]).yLabel+="<br>"+v.labels[C]+t.hoverLabelText(l,M,y.yhoverformat):((k=m.extendFlat({},x)).y0=k.y1=P,k.yLabelVal=M,k.yLabel=v.labels[C]+t.hoverLabelText(l,M,y.yhoverformat),k.name="",_.push(k),w[M]=k)}return _}function o(a,c,r,n){var d=a.cd,l=a.ya,y=d[0].trace,v=d[0].t,_=i(a,c,r,n);if(!_)return[];var x=d[_.index],T=_.index=x.i,A=x.dir;function S(O){return v.labels[O]+t.hoverLabelText(l,y[O][T],y.yhoverformat)}var w=x.hi||y.hoverinfo,L=w.split("+"),k=w==="all",C=k||L.indexOf("y")!==-1,M=k||L.indexOf("text")!==-1,P=C?[S("open"),S("high"),S("low"),S("close")+"  "+u[A]]:[];return M&&e(x,y,P),_.extraText=P.join("<br>"),_.y0=_.y1=l.c2p(x.yc,!0),[_]}N.exports={hoverPoints:function(a,c,r,n){return a.cd[0].trace.hoverlabel.split?s(a,c,r,n):o(a,c,r,n)},hoverSplit:s,hoverOnPoints:o}},{"../../components/color":650,"../../components/fx":690,"../../constants/delta.js":757,"../../lib":787,"../../plots/cartesian/axes":838}],1152:[function(h,N,H){N.exports={moduleType:"trace",name:"ohlc",basePlotModule:h("../../plots/cartesian"),categories:["cartesian","svg","showLegend"],meta:{},attributes:h("./attributes"),supplyDefaults:h("./defaults"),calc:h("./calc").calc,plot:h("./plot"),style:h("./style"),hoverPoints:h("./hover").hoverPoints,selectPoints:h("./select")}},{"../../plots/cartesian":852,"./attributes":1148,"./calc":1149,"./defaults":1150,"./hover":1151,"./plot":1154,"./select":1155,"./style":1156}],1153:[function(h,N,H){var t=h("../../registry"),m=h("../../lib");N.exports=function(g,p,e,f){var u=e("x"),i=e("open"),s=e("high"),o=e("low"),a=e("close");if(e("hoverlabel.split"),t.getComponentMethod("calendars","handleTraceDefaults")(g,p,["x"],f),i&&s&&o&&a){var c=Math.min(i.length,s.length,o.length,a.length);return u&&(c=Math.min(c,m.minRowLength(u))),p._length=c,c}}},{"../../lib":787,"../../registry":915}],1154:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../lib");N.exports=function(g,p,e,f){var u=p.yaxis,i=p.xaxis,s=!!i.rangebreaks;m.makeTraceGroups(f,e,"trace ohlc").each(function(o){var a=t.select(this),c=o[0],r=c.t;if(c.trace.visible!==!0||r.empty)a.remove();else{var n=r.tickLen,d=a.selectAll("path").data(m.identity);d.enter().append("path"),d.exit().remove(),d.attr("d",function(l){if(l.empty)return"M0,0Z";var y=i.c2p(l.pos-n,!0),v=i.c2p(l.pos+n,!0),_=s?(y+v)/2:i.c2p(l.pos,!0);return"M"+y+","+u.c2p(l.o,!0)+"H"+_+"M"+_+","+u.c2p(l.h,!0)+"V"+u.c2p(l.l,!0)+"M"+v+","+u.c2p(l.c,!0)+"H"+_})}})}},{"../../lib":787,"@plotly/d3":58}],1155:[function(h,N,H){N.exports=function(t,m){var g,p=t.cd,e=t.xaxis,f=t.yaxis,u=[],i=p[0].t.bPos||0;if(m===!1)for(g=0;g<p.length;g++)p[g].selected=0;else for(g=0;g<p.length;g++){var s=p[g];m.contains([e.c2p(s.pos+i),f.c2p(s.yc)],null,s.i,t)?(u.push({pointNumber:s.i,x:e.c2d(s.pos),y:f.c2d(s.yc)}),s.selected=1):s.selected=0}return u}},{}],1156:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../components/drawing"),g=h("../../components/color");N.exports=function(p,e,f){var u=f||t.select(p).selectAll("g.ohlclayer").selectAll("g.trace");u.style("opacity",function(i){return i[0].trace.opacity}),u.each(function(i){var s=i[0].trace;t.select(this).selectAll("path").each(function(o){if(!o.empty){var a=s[o.dir].line;t.select(this).style("fill","none").call(g.stroke,a.color).call(m.dashLine,a.dash,a.width).style("opacity",s.selectedpoints&&!o.selected?.3:1)}})})}},{"../../components/color":650,"../../components/drawing":672,"@plotly/d3":58}],1157:[function(h,N,H){var t=h("../../lib/extend").extendFlat,m=h("../../plots/attributes"),g=h("../../plots/font_attributes"),p=h("../../components/colorscale/attributes"),e=h("../../plots/template_attributes").hovertemplateAttrs,f=h("../../plots/domain").attributes,u=t({editType:"calc"},p("line",{editTypeOverride:"calc"}),{shape:{valType:"enumerated",values:["linear","hspline"],dflt:"linear",editType:"plot"},hovertemplate:e({editType:"plot",arrayOk:!1},{keys:["count","probability"]})});N.exports={domain:f({name:"parcats",trace:!0,editType:"calc"}),hoverinfo:t({},m.hoverinfo,{flags:["count","probability"],editType:"plot",arrayOk:!1}),hoveron:{valType:"enumerated",values:["category","color","dimension"],dflt:"category",editType:"plot"},hovertemplate:e({editType:"plot",arrayOk:!1},{keys:["count","probability","category","categorycount","colorcount","bandcolorcount"]}),arrangement:{valType:"enumerated",values:["perpendicular","freeform","fixed"],dflt:"perpendicular",editType:"plot"},bundlecolors:{valType:"boolean",dflt:!0,editType:"plot"},sortpaths:{valType:"enumerated",values:["forward","backward"],dflt:"forward",editType:"plot"},labelfont:g({editType:"calc"}),tickfont:g({editType:"calc"}),dimensions:{_isLinkedToArray:"dimension",label:{valType:"string",editType:"calc"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},values:{valType:"data_array",dflt:[],editType:"calc"},displayindex:{valType:"integer",editType:"calc"},editType:"calc",visible:{valType:"boolean",dflt:!0,editType:"calc"}},line:u,counts:{valType:"number",min:0,dflt:1,arrayOk:!0,editType:"calc"},customdata:void 0,hoverlabel:void 0,ids:void 0,legendgroup:void 0,legendrank:void 0,opacity:void 0,selectedpoints:void 0,showlegend:void 0}},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/domain":866,"../../plots/font_attributes":867,"../../plots/template_attributes":910}],1158:[function(h,N,H){var t=h("../../plots/get_data").getModuleCalcData,m=h("./plot");H.name="parcats",H.plot=function(g,p,e,f){var u=t(g.calcdata,"parcats");if(u.length){var i=u[0];m(g,i,e,f)}},H.clean=function(g,p,e,f){var u=f._has&&f._has("parcats"),i=p._has&&p._has("parcats");u&&!i&&f._paperdiv.selectAll(".parcats").remove()}},{"../../plots/get_data":875,"./plot":1163}],1159:[function(h,N,H){var t=h("../../lib/gup").wrap,m=h("../../components/colorscale/helpers").hasColorscale,g=h("../../components/colorscale/calc"),p=h("../../lib/filter_unique.js"),e=h("../../components/drawing"),f=h("../../lib"),u=h("fast-isnumeric");function i(a,c,r){a.valueInds.push(c),a.count+=r}function s(a,c,r){return{categoryInds:a,color:c,rawColor:r,valueInds:[],count:0}}function o(a,c,r){a.valueInds.push(c),a.count+=r}N.exports=function(a,c){var r=f.filterVisible(c.dimensions);if(r.length===0)return[];var n,d,l,y=r.map(function(Y){var K;if(Y.categoryorder==="trace")K=null;else if(Y.categoryorder==="array")K=Y.categoryarray;else{K=p(Y.values);for(var D=!0,B=0;B<K.length;B++)if(!u(K[B])){D=!1;break}K.sort(D?f.sorterAsc:void 0),Y.categoryorder==="category descending"&&(K=K.reverse())}return function(q,ee){ee=ee==null?[]:ee.map(function(de){return de});var J={},$={},te=[];ee.forEach(function(de,ce){J[de]=0,$[de]=ce});for(var ie=0;ie<q.length;ie++){var ae,he=q[ie];J[he]===void 0?(J[he]=1,ae=ee.push(he)-1,$[he]=ae):(J[he]++,ae=$[he]),te.push(ae)}var se=ee.map(function(de){return J[de]});return{uniqueValues:ee,uniqueCounts:se,inds:te}}(Y.values,K)});n=f.isArrayOrTypedArray(c.counts)?c.counts:[c.counts],function(Y){var K;if(function(D){for(var B=new Array(D.length),q=0;q<D.length;q++){if(D[q]<0||D[q]>=D.length||B[D[q]]!==void 0)return!1;B[D[q]]=!0}return!0}(Y.map(function(D){return D.displayindex})))for(K=0;K<Y.length;K++)Y[K]._displayindex=Y[K].displayindex;else for(K=0;K<Y.length;K++)Y[K]._displayindex=K}(r),r.forEach(function(Y,K){(function(D,B){D._categoryarray=B.uniqueValues,D.ticktext===null||D.ticktext===void 0?D._ticktext=[]:D._ticktext=D.ticktext.slice();for(var q=D._ticktext.length;q<B.uniqueValues.length;q++)D._ticktext.push(B.uniqueValues[q])})(Y,y[K])});var v,_=c.line;_?(m(c,"line")&&g(a,c,{vals:c.line.color,containerStr:"line",cLetter:"c"}),v=e.tryColorscale(_)):v=f.identity;var x,T,A,S,w,L=r[0].values.length,k={},C=y.map(function(Y){return Y.inds});for(l=0,x=0;x<L;x++){var M=[];for(T=0;T<C.length;T++)M.push(C[T][x]);d=n[x%n.length],l+=d;var P=(A=x,S=void 0,w=void 0,f.isArrayOrTypedArray(_.color)?w=S=_.color[A%_.color.length]:S=_.color,{color:v(S),rawColor:w}),O=M+"-"+P.rawColor;k[O]===void 0&&(k[O]=s(M,P.color,P.rawColor)),o(k[O],x,d)}var F,j=r.map(function(Y,K){return function(D,B,q,ee,J){return{dimensionInd:D,containerInd:B,displayInd:q,dimensionLabel:ee,count:J,categories:[],dragX:null}}(K,Y._index,Y._displayindex,Y.label,l)});for(x=0;x<L;x++)for(d=n[x%n.length],T=0;T<j.length;T++){var W=j[T].containerInd,Z=y[T].inds[x],Q=j[T].categories;if(Q[Z]===void 0){var X=c.dimensions[W]._categoryarray[Z],G=c.dimensions[W]._ticktext[Z];Q[Z]={dimensionInd:T,categoryInd:F=Z,categoryValue:X,displayInd:F,categoryLabel:G,valueInds:[],count:0,dragY:null}}i(Q[Z],x,d)}return t(function(Y,K,D){var B=Y.map(function(q){return q.categories.length}).reduce(function(q,ee){return Math.max(q,ee)});return{dimensions:Y,paths:K,trace:void 0,maxCats:B,count:D}}(j,k,l))}},{"../../components/colorscale/calc":658,"../../components/colorscale/helpers":661,"../../components/drawing":672,"../../lib":787,"../../lib/filter_unique.js":778,"../../lib/gup":784,"fast-isnumeric":246}],1160:[function(h,N,H){var t=h("../../lib"),m=h("../../components/colorscale/helpers").hasColorscale,g=h("../../components/colorscale/defaults"),p=h("../../plots/domain").defaults,e=h("../../plots/array_container_defaults"),f=h("./attributes"),u=h("../parcoords/merge_length");function i(s,o){function a(v,_){return t.coerce(s,o,f.dimensions,v,_)}var c=a("values"),r=a("visible");if(c&&c.length||(r=o.visible=!1),r){a("label"),a("displayindex",o._index);var n,d=s.categoryarray,l=Array.isArray(d)&&d.length>0;l&&(n="array");var y=a("categoryorder",n);y==="array"?(a("categoryarray"),a("ticktext")):(delete s.categoryarray,delete s.ticktext),l||y!=="array"||(o.categoryorder="trace")}}N.exports=function(s,o,a,c){function r(v,_){return t.coerce(s,o,f,v,_)}var n=e(s,o,{name:"dimensions",handleItemDefaults:i}),d=function(v,_,x,T,A){A("line.shape"),A("line.hovertemplate");var S=A("line.color",T.colorway[0]);if(m(v,"line")&&t.isArrayOrTypedArray(S)){if(S.length)return A("line.colorscale"),g(v,_,T,A,{prefix:"line.",cLetter:"c"}),S.length;_.line.color=x}return 1/0}(s,o,a,c,r);p(o,c,r),Array.isArray(n)&&n.length||(o.visible=!1),u(o,n,"values",d),r("hoveron"),r("hovertemplate"),r("arrangement"),r("bundlecolors"),r("sortpaths"),r("counts");var l={family:c.font.family,size:Math.round(c.font.size),color:c.font.color};t.coerceFont(r,"labelfont",l);var y={family:c.font.family,size:Math.round(c.font.size/1.2),color:c.font.color};t.coerceFont(r,"tickfont",y)}},{"../../components/colorscale/defaults":660,"../../components/colorscale/helpers":661,"../../lib":787,"../../plots/array_container_defaults":833,"../../plots/domain":866,"../parcoords/merge_length":1173,"./attributes":1157}],1161:[function(h,N,H){N.exports={attributes:h("./attributes"),supplyDefaults:h("./defaults"),calc:h("./calc"),plot:h("./plot"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcats",basePlotModule:h("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":1157,"./base_plot":1158,"./calc":1159,"./defaults":1160,"./plot":1163}],1162:[function(h,N,H){var t=h("@plotly/d3"),m=h("d3-interpolate").interpolateNumber,g=h("../../plot_api/plot_api"),p=h("../../components/fx"),e=h("../../lib"),f=e.strTranslate,u=h("../../components/drawing"),i=h("tinycolor2"),s=h("../../lib/svg_text_utils");function o(D,B,q,ee){var J=D.map(Q.bind(0,B,q)),$=ee.selectAll("g.parcatslayer").data([null]);$.enter().append("g").attr("class","parcatslayer").style("pointer-events","all");var te=$.selectAll("g.trace.parcats").data(J,a),ie=te.enter().append("g").attr("class","trace parcats");te.attr("transform",function(be){return f(be.x,be.y)}),ie.append("g").attr("class","paths");var ae=te.select("g.paths").selectAll("path.path").data(function(be){return be.paths},a);ae.attr("fill",function(be){return be.model.color});var he=ae.enter().append("path").attr("class","path").attr("stroke-opacity",0).attr("fill",function(be){return be.model.color}).attr("fill-opacity",0);_(he),ae.attr("d",function(be){return be.svgD}),he.empty()||ae.sort(r),ae.exit().remove(),ae.on("mouseover",n).on("mouseout",d).on("click",v),ie.append("g").attr("class","dimensions");var se=te.select("g.dimensions").selectAll("g.dimension").data(function(be){return be.dimensions},a);se.enter().append("g").attr("class","dimension"),se.attr("transform",function(be){return f(be.x,0)}),se.exit().remove();var de=se.selectAll("g.category").data(function(be){return be.categories},a),ce=de.enter().append("g").attr("class","category");de.attr("transform",function(be){return f(0,be.y)}),ce.append("rect").attr("class","catrect").attr("pointer-events","none"),de.select("rect.catrect").attr("fill","none").attr("width",function(be){return be.width}).attr("height",function(be){return be.height}),T(ce);var ve=de.selectAll("rect.bandrect").data(function(be){return be.bands},a);ve.each(function(){e.raiseToTop(this)}),ve.attr("fill",function(be){return be.color});var ke=ve.enter().append("rect").attr("class","bandrect").attr("stroke-opacity",0).attr("fill",function(be){return be.color}).attr("fill-opacity",0);ve.attr("fill",function(be){return be.color}).attr("width",function(be){return be.width}).attr("height",function(be){return be.height}).attr("y",function(be){return be.y}).attr("cursor",function(be){return be.parcatsViewModel.arrangement==="fixed"?"default":be.parcatsViewModel.arrangement==="perpendicular"?"ns-resize":"move"}),A(ke),ve.exit().remove(),ce.append("text").attr("class","catlabel").attr("pointer-events","none");var Ee=B._fullLayout.paper_bgcolor;de.select("text.catlabel").attr("text-anchor",function(be){return c(be)?"start":"end"}).attr("alignment-baseline","middle").style("text-shadow",s.makeTextShadow(Ee)).style("fill","rgb(0, 0, 0)").attr("x",function(be){return c(be)?be.width+5:-5}).attr("y",function(be){return be.height/2}).text(function(be){return be.model.categoryLabel}).each(function(be){u.font(t.select(this),be.parcatsViewModel.categorylabelfont),s.convertToTspans(t.select(this),B)}),ce.append("text").attr("class","dimlabel"),de.select("text.dimlabel").attr("text-anchor","middle").attr("alignment-baseline","baseline").attr("cursor",function(be){return be.parcatsViewModel.arrangement==="fixed"?"default":"ew-resize"}).attr("x",function(be){return be.width/2}).attr("y",-5).text(function(be,xe){return xe===0?be.parcatsViewModel.model.dimensions[be.model.dimensionInd].dimensionLabel:null}).each(function(be){u.font(t.select(this),be.parcatsViewModel.labelfont)}),de.selectAll("rect.bandrect").on("mouseover",C).on("mouseout",M),de.exit().remove(),se.call(t.behavior.drag().origin(function(be){return{x:be.x,y:0}}).on("dragstart",P).on("drag",O).on("dragend",F)),te.each(function(be){be.traceSelection=t.select(this),be.pathSelection=t.select(this).selectAll("g.paths").selectAll("path.path"),be.dimensionSelection=t.select(this).selectAll("g.dimensions").selectAll("g.dimension")}),te.exit().remove()}function a(D){return D.key}function c(D){var B=D.parcatsViewModel.dimensions.length,q=D.parcatsViewModel.dimensions[B-1].model.dimensionInd;return D.model.dimensionInd===q}function r(D,B){return D.model.rawColor>B.model.rawColor?1:D.model.rawColor<B.model.rawColor?-1:0}function n(D){if(!D.parcatsViewModel.dragDimension&&D.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){e.raiseToTop(this),x(t.select(this));var B=l(D),q=y(D);if(D.parcatsViewModel.graphDiv.emit("plotly_hover",{points:B,event:t.event,constraints:q}),D.parcatsViewModel.hoverinfoItems.indexOf("none")===-1){var ee,J,$,te=t.mouse(this)[0],ie=D.parcatsViewModel.graphDiv,ae=D.parcatsViewModel.trace,he=ie._fullLayout,se=he._paperdiv.node().getBoundingClientRect(),de=D.parcatsViewModel.graphDiv.getBoundingClientRect();for($=0;$<D.leftXs.length-1;$++)if(D.leftXs[$]+D.dimWidths[$]-2<=te&&te<=D.leftXs[$+1]+2){var ce=D.parcatsViewModel.dimensions[$],ve=D.parcatsViewModel.dimensions[$+1];ee=(ce.x+ce.width+ve.x)/2,J=(D.topYs[$]+D.topYs[$+1]+D.height)/2;break}var ke=D.parcatsViewModel.x+ee,Ee=D.parcatsViewModel.y+J,be=i.mostReadable(D.model.color,["black","white"]),xe=D.model.count,ue=xe/D.parcatsViewModel.model.count,me={countLabel:xe,probabilityLabel:ue.toFixed(3)},we=[];D.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&we.push(["Count:",me.countLabel].join(" ")),D.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&we.push(["P:",me.probabilityLabel].join(" "));var Me=we.join("<br>"),Se=t.mouse(ie)[0];p.loneHover({trace:ae,x:ke-se.left+de.left,y:Ee-se.top+de.top,text:Me,color:D.model.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:10,fontColor:be,idealAlign:Se<ke?"right":"left",hovertemplate:(ae.line||{}).hovertemplate,hovertemplateLabels:me,eventData:[{data:ae._input,fullData:ae,count:xe,probability:ue}]},{container:he._hoverlayer.node(),outerContainer:he._paper.node(),gd:ie})}}}function d(D){if(!D.parcatsViewModel.dragDimension&&(_(t.select(this)),p.loneUnhover(D.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()),D.parcatsViewModel.pathSelection.sort(r),D.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1)){var B=l(D),q=y(D);D.parcatsViewModel.graphDiv.emit("plotly_unhover",{points:B,event:t.event,constraints:q})}}function l(D){for(var B=[],q=j(D.parcatsViewModel),ee=0;ee<D.model.valueInds.length;ee++){var J=D.model.valueInds[ee];B.push({curveNumber:q,pointNumber:J})}return B}function y(D){for(var B={},q=D.parcatsViewModel.model.dimensions,ee=0;ee<q.length;ee++){var J=q[ee],$=J.categories[D.model.categoryInds[ee]];B[J.containerInd]=$.categoryValue}return D.model.rawColor!==void 0&&(B.color=D.model.rawColor),B}function v(D){if(D.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){var B=l(D),q=y(D);D.parcatsViewModel.graphDiv.emit("plotly_click",{points:B,event:t.event,constraints:q})}}function _(D){D.attr("fill",function(B){return B.model.color}).attr("fill-opacity",.6).attr("stroke","lightgray").attr("stroke-width",.2).attr("stroke-opacity",1)}function x(D){D.attr("fill-opacity",.8).attr("stroke",function(B){return i.mostReadable(B.model.color,["black","white"])}).attr("stroke-width",.3)}function T(D){D.select("rect.catrect").attr("stroke","black").attr("stroke-width",1).attr("stroke-opacity",1)}function A(D){D.attr("stroke","black").attr("stroke-width",.2).attr("stroke-opacity",1).attr("fill-opacity",1)}function S(D){var B=D.parcatsViewModel.pathSelection,q=D.categoryViewModel.model.dimensionInd,ee=D.categoryViewModel.model.categoryInd;return B.filter(function(J){return J.model.categoryInds[q]===ee&&J.model.color===D.color})}function w(D,B,q){var ee=t.select(D).datum(),J=ee.categoryViewModel.model,$=ee.parcatsViewModel.graphDiv,te=t.select(D.parentNode).selectAll("rect.bandrect"),ie=[];te.each(function(he){S(he).each(function(se){Array.prototype.push.apply(ie,l(se))})});var ae={};ae[J.dimensionInd]=J.categoryValue,$.emit(B,{points:ie,event:q,constraints:ae})}function L(D,B,q){var ee=t.select(D).datum(),J=ee.categoryViewModel.model,$=ee.parcatsViewModel.graphDiv,te=S(ee),ie=[];te.each(function(he){Array.prototype.push.apply(ie,l(he))});var ae={};ae[J.dimensionInd]=J.categoryValue,ee.rawColor!==void 0&&(ae.color=ee.rawColor),$.emit(B,{points:ie,event:q,constraints:ae})}function k(D,B,q){D._fullLayout._calcInverseTransform(D);var ee,J,$=D._fullLayout._invScaleX,te=D._fullLayout._invScaleY,ie=t.select(q.parentNode).select("rect.catrect"),ae=ie.node().getBoundingClientRect(),he=ie.datum(),se=he.parcatsViewModel,de=se.model.dimensions[he.model.dimensionInd],ce=se.trace,ve=ae.top+ae.height/2;se.dimensions.length>1&&de.displayInd===se.dimensions.length-1?(ee=ae.left,J="left"):(ee=ae.left+ae.width,J="right");var ke=he.model.count,Ee=he.model.categoryLabel,be=ke/he.parcatsViewModel.model.count,xe={countLabel:ke,categoryLabel:Ee,probabilityLabel:be.toFixed(3)},ue=[];he.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&ue.push(["Count:",xe.countLabel].join(" ")),he.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&ue.push(["P("+xe.categoryLabel+"):",xe.probabilityLabel].join(" "));var me=ue.join("<br>");return{trace:ce,x:$*(ee-B.left),y:te*(ve-B.top),text:me,color:"lightgray",borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:12,fontColor:"black",idealAlign:J,hovertemplate:ce.hovertemplate,hovertemplateLabels:xe,eventData:[{data:ce._input,fullData:ce,count:ke,category:Ee,probability:be}]}}function C(D){if(!D.parcatsViewModel.dragDimension&&D.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){if(t.mouse(this)[1]<-1)return;var B,q=D.parcatsViewModel.graphDiv,ee=q._fullLayout,J=ee._paperdiv.node().getBoundingClientRect(),$=D.parcatsViewModel.hoveron;$==="color"?(function(te){var ie=t.select(te).datum(),ae=S(ie);x(ae),ae.each(function(){e.raiseToTop(this)}),t.select(te.parentNode).selectAll("rect.bandrect").filter(function(he){return he.color===ie.color}).each(function(){e.raiseToTop(this),t.select(this).attr("stroke","black").attr("stroke-width",1.5)})}(this),L(this,"plotly_hover",t.event)):(function(te){t.select(te.parentNode).selectAll("rect.bandrect").each(function(ie){var ae=S(ie);x(ae),ae.each(function(){e.raiseToTop(this)})}),t.select(te.parentNode).select("rect.catrect").attr("stroke","black").attr("stroke-width",2.5)}(this),w(this,"plotly_hover",t.event)),D.parcatsViewModel.hoverinfoItems.indexOf("none")===-1&&($==="category"?B=k(q,J,this):$==="color"?B=function(te,ie,ae){te._fullLayout._calcInverseTransform(te);var he,se,de=te._fullLayout._invScaleX,ce=te._fullLayout._invScaleY,ve=ae.getBoundingClientRect(),ke=t.select(ae).datum(),Ee=ke.categoryViewModel,be=Ee.parcatsViewModel,xe=be.model.dimensions[Ee.model.dimensionInd],ue=be.trace,me=ve.y+ve.height/2;be.dimensions.length>1&&xe.displayInd===be.dimensions.length-1?(he=ve.left,se="left"):(he=ve.left+ve.width,se="right");var we=Ee.model.categoryLabel,Me=ke.parcatsViewModel.model.count,Se=0;ke.categoryViewModel.bands.forEach(function(it){it.color===ke.color&&(Se+=it.count)});var De=Ee.model.count,Fe=0;be.pathSelection.each(function(it){it.model.color===ke.color&&(Fe+=it.model.count)});var Ye=Se/Me,et=Se/Fe,Oe=Se/De,je={countLabel:Me,categoryLabel:we,probabilityLabel:Ye.toFixed(3)},We=[];Ee.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&We.push(["Count:",je.countLabel].join(" ")),Ee.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&(We.push("P(color \u2229 "+we+"): "+je.probabilityLabel),We.push("P("+we+" | color): "+et.toFixed(3)),We.push("P(color | "+we+"): "+Oe.toFixed(3)));var Ge=We.join("<br>"),Qe=i.mostReadable(ke.color,["black","white"]);return{trace:ue,x:de*(he-ie.left),y:ce*(me-ie.top),text:Ge,color:ke.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontColor:Qe,fontSize:10,idealAlign:se,hovertemplate:ue.hovertemplate,hovertemplateLabels:je,eventData:[{data:ue._input,fullData:ue,category:we,count:Me,probability:Ye,categorycount:De,colorcount:Fe,bandcolorcount:Se}]}}(q,J,this):$==="dimension"&&(B=function(te,ie,ae){var he=[];return t.select(ae.parentNode.parentNode).selectAll("g.category").select("rect.catrect").each(function(){he.push(k(te,ie,this))}),he}(q,J,this)),B&&p.loneHover(B,{container:ee._hoverlayer.node(),outerContainer:ee._paper.node(),gd:q}))}}function M(D){var B=D.parcatsViewModel;!B.dragDimension&&(_(B.pathSelection),T(B.dimensionSelection.selectAll("g.category")),A(B.dimensionSelection.selectAll("g.category").selectAll("rect.bandrect")),p.loneUnhover(B.graphDiv._fullLayout._hoverlayer.node()),B.pathSelection.sort(r),B.hoverinfoItems.indexOf("skip")===-1)&&(D.parcatsViewModel.hoveron==="color"?L(this,"plotly_unhover",t.event):w(this,"plotly_unhover",t.event))}function P(D){D.parcatsViewModel.arrangement!=="fixed"&&(D.dragDimensionDisplayInd=D.model.displayInd,D.initialDragDimensionDisplayInds=D.parcatsViewModel.model.dimensions.map(function(B){return B.displayInd}),D.dragHasMoved=!1,D.dragCategoryDisplayInd=null,t.select(this).selectAll("g.category").select("rect.catrect").each(function(B){var q=t.mouse(this)[0],ee=t.mouse(this)[1];-2<=q&&q<=B.width+2&&-2<=ee&&ee<=B.height+2&&(D.dragCategoryDisplayInd=B.model.displayInd,D.initialDragCategoryDisplayInds=D.model.categories.map(function(J){return J.displayInd}),B.model.dragY=B.y,e.raiseToTop(this.parentNode),t.select(this.parentNode).selectAll("rect.bandrect").each(function(J){J.y<ee&&ee<=J.y+J.height&&(D.potentialClickBand=this)}))}),D.parcatsViewModel.dragDimension=D,p.loneUnhover(D.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()))}function O(D){if(D.parcatsViewModel.arrangement!=="fixed"&&(D.dragHasMoved=!0,D.dragDimensionDisplayInd!==null)){var B=D.dragDimensionDisplayInd,q=B-1,ee=B+1,J=D.parcatsViewModel.dimensions[B];if(D.dragCategoryDisplayInd!==null){var $=J.categories[D.dragCategoryDisplayInd];$.model.dragY+=t.event.dy;var te=$.model.dragY,ie=$.model.displayInd,ae=J.categories,he=ae[ie-1],se=ae[ie+1];he!==void 0&&te<he.y+he.height/2&&($.model.displayInd=he.model.displayInd,he.model.displayInd=ie),se!==void 0&&te+$.height>se.y+se.height/2&&($.model.displayInd=se.model.displayInd,se.model.displayInd=ie),D.dragCategoryDisplayInd=$.model.displayInd}if(D.dragCategoryDisplayInd===null||D.parcatsViewModel.arrangement==="freeform"){J.model.dragX=t.event.x;var de=D.parcatsViewModel.dimensions[q],ce=D.parcatsViewModel.dimensions[ee];de!==void 0&&J.model.dragX<de.x+de.width&&(J.model.displayInd=de.model.displayInd,de.model.displayInd=B),ce!==void 0&&J.model.dragX+J.width>ce.x&&(J.model.displayInd=ce.model.displayInd,ce.model.displayInd=D.dragDimensionDisplayInd),D.dragDimensionDisplayInd=J.model.displayInd}Y(D.parcatsViewModel),G(D.parcatsViewModel),Z(D.parcatsViewModel),W(D.parcatsViewModel)}}function F(D){if(D.parcatsViewModel.arrangement!=="fixed"&&D.dragDimensionDisplayInd!==null){t.select(this).selectAll("text").attr("font-weight","normal");var B={},q=j(D.parcatsViewModel),ee=D.parcatsViewModel.model.dimensions.map(function(se){return se.displayInd}),J=D.initialDragDimensionDisplayInds.some(function(se,de){return se!==ee[de]});J&&ee.forEach(function(se,de){var ce=D.parcatsViewModel.model.dimensions[de].containerInd;B["dimensions["+ce+"].displayindex"]=se});var $=!1;if(D.dragCategoryDisplayInd!==null){var te=D.model.categories.map(function(se){return se.displayInd});if($=D.initialDragCategoryDisplayInds.some(function(se,de){return se!==te[de]})){var ie=D.model.categories.slice().sort(function(se,de){return se.displayInd-de.displayInd}),ae=ie.map(function(se){return se.categoryValue}),he=ie.map(function(se){return se.categoryLabel});B["dimensions["+D.model.containerInd+"].categoryarray"]=[ae],B["dimensions["+D.model.containerInd+"].ticktext"]=[he],B["dimensions["+D.model.containerInd+"].categoryorder"]="array"}}D.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1&&!D.dragHasMoved&&D.potentialClickBand&&(D.parcatsViewModel.hoveron==="color"?L(D.potentialClickBand,"plotly_click",t.event.sourceEvent):w(D.potentialClickBand,"plotly_click",t.event.sourceEvent)),D.model.dragX=null,D.dragCategoryDisplayInd!==null&&(D.parcatsViewModel.dimensions[D.dragDimensionDisplayInd].categories[D.dragCategoryDisplayInd].model.dragY=null,D.dragCategoryDisplayInd=null),D.dragDimensionDisplayInd=null,D.parcatsViewModel.dragDimension=null,D.dragHasMoved=null,D.potentialClickBand=null,Y(D.parcatsViewModel),G(D.parcatsViewModel),t.transition().duration(300).ease("cubic-in-out").each(function(){Z(D.parcatsViewModel,!0),W(D.parcatsViewModel,!0)}).each("end",function(){(J||$)&&g.restyle(D.parcatsViewModel.graphDiv,B,[q])})}}function j(D){for(var B,q=D.graphDiv._fullData,ee=0;ee<q.length;ee++)if(D.key===q[ee].uid){B=ee;break}return B}function W(D,B){var q;B===void 0&&(B=!1),D.pathSelection.data(function(ee){return ee.paths},a),(q=D.pathSelection,B?q.transition():q).attr("d",function(ee){return ee.svgD})}function Z(D,B){function q(te){return B?te.transition():te}B===void 0&&(B=!1),D.dimensionSelection.data(function(te){return te.dimensions},a);var ee=D.dimensionSelection.selectAll("g.category").data(function(te){return te.categories},a);q(D.dimensionSelection).attr("transform",function(te){return f(te.x,0)}),q(ee).attr("transform",function(te){return f(0,te.y)}),ee.select(".dimlabel").text(function(te,ie){return ie===0?te.parcatsViewModel.model.dimensions[te.model.dimensionInd].dimensionLabel:null}),ee.select(".catlabel").attr("text-anchor",function(te){return c(te)?"start":"end"}).attr("x",function(te){return c(te)?te.width+5:-5}).each(function(te){var ie,ae;c(te)?(ie=te.width+5,ae="start"):(ie=-5,ae="end"),t.select(this).selectAll("tspan").attr("x",ie).attr("text-anchor",ae)});var J=ee.selectAll("rect.bandrect").data(function(te){return te.bands},a),$=J.enter().append("rect").attr("class","bandrect").attr("cursor","move").attr("stroke-opacity",0).attr("fill",function(te){return te.color}).attr("fill-opacity",0);J.attr("fill",function(te){return te.color}).attr("width",function(te){return te.width}).attr("height",function(te){return te.height}).attr("y",function(te){return te.y}),A($),J.each(function(){e.raiseToTop(this)}),J.exit().remove()}function Q(D,B,q){var ee,J=q[0],$=B.margin||{l:80,r:80,t:100,b:80},te=J.trace,ie=te.domain,ae=B.width,he=B.height,se=Math.floor(ae*(ie.x[1]-ie.x[0])),de=Math.floor(he*(ie.y[1]-ie.y[0])),ce=ie.x[0]*ae+$.l,ve=B.height-ie.y[1]*B.height+$.t,ke=te.line.shape;ee=te.hoverinfo==="all"?["count","probability"]:(te.hoverinfo||"").split("+");var Ee={trace:te,key:te.uid,model:J,x:ce,y:ve,width:se,height:de,hoveron:te.hoveron,hoverinfoItems:ee,arrangement:te.arrangement,bundlecolors:te.bundlecolors,sortpaths:te.sortpaths,labelfont:te.labelfont,categorylabelfont:te.tickfont,pathShape:ke,dragDimension:null,margin:$,paths:[],dimensions:[],graphDiv:D,traceSelection:null,pathSelection:null,dimensionSelection:null};return J.dimensions&&(Y(Ee),G(Ee)),Ee}function X(D,B,q,ee,J){var $,te,ie=[],ae=[];for(te=0;te<q.length-1;te++)$=m(q[te]+D[te],D[te+1]),ie.push($(J)),ae.push($(1-J));var he="M "+D[0]+","+B[0];for(he+="l"+q[0]+",0 ",te=1;te<q.length;te++)he+="C"+ie[te-1]+","+B[te-1]+" "+ae[te-1]+","+B[te]+" "+D[te]+","+B[te],he+="l"+q[te]+",0 ";for(he+="l0,"+ee+" ",he+="l -"+q[q.length-1]+",0 ",te=q.length-2;te>=0;te--)he+="C"+ae[te]+","+(B[te+1]+ee)+" "+ie[te]+","+(B[te]+ee)+" "+(D[te]+q[te])+","+(B[te]+ee),he+="l-"+q[te]+",0 ";return he+="Z"}function G(D){var B=D.dimensions,q=D.model,ee=B.map(function(We){return We.categories.map(function(Ge){return Ge.y})}),J=D.model.dimensions.map(function(We){return We.categories.map(function(Ge){return Ge.displayInd})}),$=D.model.dimensions.map(function(We){return We.displayInd}),te=D.dimensions.map(function(We){return We.model.dimensionInd}),ie=B.map(function(We){return We.x}),ae=B.map(function(We){return We.width}),he=[];for(var se in q.paths)q.paths.hasOwnProperty(se)&&he.push(q.paths[se]);function de(We){var Ge=We.categoryInds.map(function(Qe,it){return J[it][Qe]});return te.map(function(Qe){return Ge[Qe]})}he.sort(function(We,Ge){var Qe=de(We),it=de(Ge);return D.sortpaths==="backward"&&(Qe.reverse(),it.reverse()),Qe.push(We.valueInds[0]),it.push(Ge.valueInds[0]),D.bundlecolors&&(Qe.unshift(We.rawColor),it.unshift(Ge.rawColor)),Qe<it?-1:Qe>it?1:0});for(var ce=new Array(he.length),ve=B[0].model.count,ke=B[0].categories.map(function(We){return We.height}).reduce(function(We,Ge){return We+Ge}),Ee=0;Ee<he.length;Ee++){var be,xe=he[Ee];be=ve>0?ke*(xe.count/ve):0;for(var ue,me=new Array(ee.length),we=0;we<xe.categoryInds.length;we++){var Me=xe.categoryInds[we],Se=J[we][Me],De=$[we];me[De]=ee[De][Se],ee[De][Se]+=be;var Fe=D.dimensions[De].categories[Se],Ye=Fe.bands.length,et=Fe.bands[Ye-1];if(et===void 0||xe.rawColor!==et.rawColor){var Oe=et===void 0?0:et.y+et.height;Fe.bands.push({key:Oe,color:xe.color,rawColor:xe.rawColor,height:be,width:Fe.width,count:xe.count,y:Oe,categoryViewModel:Fe,parcatsViewModel:D})}else{var je=Fe.bands[Ye-1];je.height+=be,je.count+=xe.count}}ue=D.pathShape==="hspline"?X(ie,me,ae,be,.5):X(ie,me,ae,be,0),ce[Ee]={key:xe.valueInds[0],model:xe,height:be,leftXs:ie,topYs:me,dimWidths:ae,svgD:ue,parcatsViewModel:D}}D.paths=ce}function Y(D){var B=D.model.dimensions.map(function(te){return{displayInd:te.displayInd,dimensionInd:te.dimensionInd}});B.sort(function(te,ie){return te.displayInd-ie.displayInd});var q=[];for(var ee in B){var J=B[ee].dimensionInd,$=D.model.dimensions[J];q.push(K(D,$))}D.dimensions=q}function K(D,B){var q,ee=D.model.dimensions.length,J=B.displayInd;q=40+(ee>1?(D.width-80-16)/(ee-1):0)*J;var $,te,ie,ae,he,se=[],de=D.model.maxCats,ce=B.categories.length,ve=B.count,ke=D.height-8*(de-1),Ee=8*(de-ce)/2,be=B.categories.map(function(xe){return{displayInd:xe.displayInd,categoryInd:xe.categoryInd}});for(be.sort(function(xe,ue){return xe.displayInd-ue.displayInd}),he=0;he<ce;he++)ae=be[he].categoryInd,te=B.categories[ae],$=ve>0?te.count/ve*ke:0,ie={key:te.valueInds[0],model:te,width:16,height:$,y:te.dragY!==null?te.dragY:Ee,bands:[],parcatsViewModel:D},Ee=Ee+$+8,se.push(ie);return{key:B.dimensionInd,x:B.dragX!==null?B.dragX:q,y:0,width:16,model:B,categories:se,parcatsViewModel:D,dragCategoryDisplayInd:null,dragDimensionDisplayInd:null,initialDragDimensionDisplayInds:null,initialDragCategoryDisplayInds:null,dragHasMoved:null,potentialClickBand:null}}N.exports=function(D,B,q,ee){o(q,D,ee,B)}},{"../../components/drawing":672,"../../components/fx":690,"../../lib":787,"../../lib/svg_text_utils":813,"../../plot_api/plot_api":824,"@plotly/d3":58,"d3-interpolate":168,tinycolor2:583}],1163:[function(h,N,H){var t=h("./parcats");N.exports=function(m,g,p,e){var f=m._fullLayout,u=f._paper,i=f._size;t(m,u,g,{width:i.w,height:i.h,margin:{t:i.t,r:i.r,b:i.b,l:i.l}},p,e)}},{"./parcats":1162}],1164:[function(h,N,H){var t=h("../../components/colorscale/attributes"),m=h("../../plots/cartesian/layout_attributes"),g=h("../../plots/font_attributes"),p=h("../../plots/domain").attributes,e=h("../../lib/extend").extendFlat,f=h("../../plot_api/plot_template").templatedArray;N.exports={domain:p({name:"parcoords",trace:!0,editType:"plot"}),labelangle:{valType:"angle",dflt:0,editType:"plot"},labelside:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},labelfont:g({editType:"plot"}),tickfont:g({editType:"plot"}),rangefont:g({editType:"plot"}),dimensions:f("dimension",{label:{valType:"string",editType:"plot"},tickvals:e({},m.tickvals,{editType:"plot"}),ticktext:e({},m.ticktext,{editType:"plot"}),tickformat:e({},m.tickformat,{editType:"plot"}),visible:{valType:"boolean",dflt:!0,editType:"plot"},range:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},constraintrange:{valType:"info_array",freeLength:!0,dimensions:"1-2",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},multiselect:{valType:"boolean",dflt:!0,editType:"plot"},values:{valType:"data_array",editType:"calc"},editType:"calc"}),line:e({editType:"calc"},t("line",{colorscaleDflt:"Viridis",autoColorDflt:!1,editTypeOverride:"calc"}))}},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plot_api/plot_template":827,"../../plots/cartesian/layout_attributes":853,"../../plots/domain":866,"../../plots/font_attributes":867}],1165:[function(h,N,H){var t=h("./constants"),m=h("@plotly/d3"),g=h("../../lib/gup").keyFun,p=h("../../lib/gup").repeat,e=h("../../lib").sorterAsc,f=h("../../lib").strTranslate,u=t.bar.snapRatio;function i(k,C){return k*(1-u)+C*u}var s=t.bar.snapClose;function o(k,C){return k*(1-s)+C*s}function a(k,C,M,P){if(function(K,D){for(var B=0;B<D.length;B++)if(K>=D[B][0]&&K<=D[B][1])return!0;return!1}(M,P))return M;var O=k?-1:1,F=0,j=C.length-1;if(O<0){var W=F;F=j,j=W}for(var Z=C[F],Q=Z,X=F;O*X<O*j;X+=O){var G=X+O,Y=C[G];if(O*M<O*o(Z,Y))return i(Z,Q);if(O*M<O*Y||G===j)return i(Y,Z);Q=Z,Z=Y}}function c(k){k.attr("x",-t.bar.captureWidth/2).attr("width",t.bar.captureWidth)}function r(k){k.attr("visibility","visible").style("visibility","visible").attr("fill","yellow").attr("opacity",0)}function n(k){if(!k.brush.filterSpecified)return"0,"+k.height;for(var C,M,P,O=d(k.brush.filter.getConsolidated(),k.height),F=[0],j=O.length?O[0][0]:null,W=0;W<O.length;W++)M=(C=O[W])[1]-C[0],F.push(j),F.push(M),(P=W+1)<O.length&&(j=O[P][0]-C[1]);return F.push(k.height),F}function d(k,C){return k.map(function(M){return M.map(function(P){return Math.max(0,P*C)}).sort(e)})}function l(){m.select(document.body).style("cursor",null)}function y(k){k.attr("stroke-dasharray",n)}function v(k,C){var M=m.select(k).selectAll(".highlight, .highlight-shadow");y(C?M.transition().duration(t.bar.snapDuration).each("end",C):M)}function _(k,C){var M,P=k.brush,O=NaN,F={};if(P.filterSpecified){var j=k.height,W=P.filter.getConsolidated(),Z=d(W,j),Q=NaN,X=NaN,G=NaN;for(M=0;M<=Z.length;M++){var Y=Z[M];if(Y&&Y[0]<=C&&C<=Y[1]){Q=M;break}if(X=M?M-1:NaN,Y&&Y[0]>C){G=M;break}}if(O=Q,isNaN(O)&&(O=isNaN(X)||isNaN(G)?isNaN(X)?G:X:C-Z[X][1]<Z[G][0]-C?X:G),!isNaN(O)){var K=Z[O],D=function(J,$){var te=t.bar.handleHeight;if(!($>J[1]+te||$<J[0]-te))return $>=.9*J[1]+.1*J[0]?"n":$<=.9*J[0]+.1*J[1]?"s":"ns"}(K,C);D&&(F.interval=W[O],F.intervalPix=K,F.region=D)}}if(k.ordinal&&!F.region){var B=k.unitTickvals,q=k.unitToPaddedPx.invert(C);for(M=0;M<B.length;M++){var ee=[.25*B[Math.max(M-1,0)]+.75*B[M],.25*B[Math.min(M+1,B.length-1)]+.75*B[M]];if(q>=ee[0]&&q<=ee[1]){F.clickableOrdinalRange=ee;break}}}return F}function x(k,C){m.event.sourceEvent.stopPropagation();var M=C.height-m.mouse(k)[1]-2*t.verticalPadding,P=C.brush.svgBrush;P.wasDragged=!0,P._dragging=!0,P.grabbingBar?P.newExtent=[M-P.grabPoint,M+P.barLength-P.grabPoint].map(C.unitToPaddedPx.invert):P.newExtent=[P.startExtent,C.unitToPaddedPx.invert(M)].sort(e),C.brush.filterSpecified=!0,P.extent=P.stayingIntervals.concat([P.newExtent]),P.brushCallback(C),v(k.parentNode)}function T(k,C){var M=_(C,C.height-m.mouse(k)[1]-2*t.verticalPadding),P="crosshair";M.clickableOrdinalRange?P="pointer":M.region&&(P=M.region+"-resize"),m.select(document.body).style("cursor",P)}function A(k){k.on("mousemove",function(C){m.event.preventDefault(),C.parent.inBrushDrag||T(this,C)}).on("mouseleave",function(C){C.parent.inBrushDrag||l()}).call(m.behavior.drag().on("dragstart",function(C){(function(M,P){m.event.sourceEvent.stopPropagation();var O=P.height-m.mouse(M)[1]-2*t.verticalPadding,F=P.unitToPaddedPx.invert(O),j=P.brush,W=_(P,O),Z=W.interval,Q=j.svgBrush;if(Q.wasDragged=!1,Q.grabbingBar=W.region==="ns",Q.grabbingBar){var X=Z.map(P.unitToPaddedPx);Q.grabPoint=O-X[0]-t.verticalPadding,Q.barLength=X[1]-X[0]}Q.clickableOrdinalRange=W.clickableOrdinalRange,Q.stayingIntervals=P.multiselect&&j.filterSpecified?j.filter.getConsolidated():[],Z&&(Q.stayingIntervals=Q.stayingIntervals.filter(function(G){return G[0]!==Z[0]&&G[1]!==Z[1]})),Q.startExtent=W.region?Z[W.region==="s"?1:0]:F,P.parent.inBrushDrag=!0,Q.brushStartCallback()})(this,C)}).on("drag",function(C){x(this,C)}).on("dragend",function(C){(function(M,P){var O=P.brush,F=O.filter,j=O.svgBrush;j._dragging||(T(M,P),x(M,P),P.brush.svgBrush.wasDragged=!1),j._dragging=!1,m.event.sourceEvent.stopPropagation();var W=j.grabbingBar;if(j.grabbingBar=!1,j.grabLocation=void 0,P.parent.inBrushDrag=!1,l(),!j.wasDragged)return j.wasDragged=void 0,j.clickableOrdinalRange?O.filterSpecified&&P.multiselect?j.extent.push(j.clickableOrdinalRange):(j.extent=[j.clickableOrdinalRange],O.filterSpecified=!0):W?(j.extent=j.stayingIntervals,j.extent.length===0&&w(O)):w(O),j.brushCallback(P),v(M.parentNode),void j.brushEndCallback(O.filterSpecified?F.getConsolidated():[]);var Z=function(){F.set(F.getConsolidated())};if(P.ordinal){var Q=P.unitTickvals;Q[Q.length-1]<Q[0]&&Q.reverse(),j.newExtent=[a(0,Q,j.newExtent[0],j.stayingIntervals),a(1,Q,j.newExtent[1],j.stayingIntervals)];var X=j.newExtent[1]>j.newExtent[0];j.extent=j.stayingIntervals.concat(X?[j.newExtent]:[]),j.extent.length||w(O),j.brushCallback(P),X?v(M.parentNode,Z):(Z(),v(M.parentNode))}else Z();j.brushEndCallback(O.filterSpecified?F.getConsolidated():[])})(this,C)}))}function S(k,C){return k[0]-C[0]}function w(k){k.filterSpecified=!1,k.svgBrush.extent=[[-1/0,1/0]]}function L(k){for(var C,M=k.slice(),P=[],O=M.shift();O;){for(C=O.slice();(O=M.shift())&&O[0]<=C[1];)C[1]=Math.max(C[1],O[1]);P.push(C)}return P.length===1&&P[0][0]>P[0][1]&&(P=[]),P}N.exports={makeBrush:function(k,C,M,P,O,F){var j,W=function(){var Z,Q,X=[];return{set:function(G){(X=G.map(function(Y){return Y.slice().sort(e)}).sort(S)).length===1&&X[0][0]===-1/0&&X[0][1]===1/0&&(X=[[0,-1]]),Z=L(X),Q=X.reduce(function(Y,K){return[Math.min(Y[0],K[0]),Math.max(Y[1],K[1])]},[1/0,-1/0])},get:function(){return X.slice()},getConsolidated:function(){return Z},getBounds:function(){return Q}}}();return W.set(M),{filter:W,filterSpecified:C,svgBrush:{extent:[],brushStartCallback:P,brushCallback:(j=O,function(Z){var Q=Z.brush,X=function(G){return G.svgBrush.extent.map(function(Y){return Y.slice()})}(Q).slice();Q.filter.set(X),j()}),brushEndCallback:F}}},ensureAxisBrush:function(k,C){var M=k.selectAll("."+t.cn.axisBrush).data(p,g);M.enter().append("g").classed(t.cn.axisBrush,!0),function(P,O){var F=P.selectAll(".background").data(p);F.enter().append("rect").classed("background",!0).call(c).call(r).style("pointer-events","auto").attr("transform",f(0,t.verticalPadding)),F.call(A).attr("height",function(Z){return Z.height-t.verticalPadding});var j=P.selectAll(".highlight-shadow").data(p);j.enter().append("line").classed("highlight-shadow",!0).attr("x",-t.bar.width/2).attr("stroke-width",t.bar.width+t.bar.strokeWidth).attr("stroke",O).attr("opacity",t.bar.strokeOpacity).attr("stroke-linecap","butt"),j.attr("y1",function(Z){return Z.height}).call(y);var W=P.selectAll(".highlight").data(p);W.enter().append("line").classed("highlight",!0).attr("x",-t.bar.width/2).attr("stroke-width",t.bar.width-t.bar.strokeWidth).attr("stroke",t.bar.fillColor).attr("opacity",t.bar.fillOpacity).attr("stroke-linecap","butt"),W.attr("y1",function(Z){return Z.height}).call(y)}(M,C)},cleanRanges:function(k,C){if(Array.isArray(k[0])?(k=k.map(function(P){return P.sort(e)}),k=C.multiselect?L(k.sort(S)):[k[0]]):k=[k.sort(e)],C.tickvals){var M=C.tickvals.slice().sort(e);if(!(k=k.map(function(P){var O=[a(0,M,P[0],[]),a(1,M,P[1],[])];if(O[1]>O[0])return O}).filter(function(P){return P})).length)return}return k.length>1?k:k[0]}}},{"../../lib":787,"../../lib/gup":784,"./constants":1168,"@plotly/d3":58}],1166:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../plots/get_data").getModuleCalcData,g=h("./plot"),p=h("../../constants/xmlns_namespaces");H.name="parcoords",H.plot=function(e){var f=m(e.calcdata,"parcoords")[0];f.length&&g(e,f)},H.clean=function(e,f,u,i){var s=i._has&&i._has("parcoords"),o=f._has&&f._has("parcoords");s&&!o&&(i._paperdiv.selectAll(".parcoords").remove(),i._glimages.selectAll("*").remove())},H.toSVG=function(e){var f=e._fullLayout._glimages,u=t.select(e).selectAll(".svg-container");u.filter(function(i,s){return s===u.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus").each(function(){var i=this.toDataURL("image/png");f.append("svg:image").attr({xmlns:p.svg,"xlink:href":i,preserveAspectRatio:"none",x:0,y:0,width:this.style.width,height:this.style.height})}),window.setTimeout(function(){t.selectAll("#filterBarPattern").attr("id","filterBarPattern")},60)}},{"../../constants/xmlns_namespaces":764,"../../plots/get_data":875,"./plot":1175,"@plotly/d3":58}],1167:[function(h,N,H){var t=h("../../lib").isArrayOrTypedArray,m=h("../../components/colorscale"),g=h("../../lib/gup").wrap;N.exports=function(p,e){var f,u;return m.hasColorscale(e,"line")&&t(e.line.color)?(f=e.line.color,u=m.extractOpts(e.line).colorscale,m.calc(p,e,{vals:f,containerStr:"line",cLetter:"c"})):(f=function(i){for(var s=new Array(i),o=0;o<i;o++)s[o]=.5;return s}(e._length),u=[[0,e.line.color],[1,e.line.color]]),g({lineColor:f,cscale:u})}},{"../../components/colorscale":662,"../../lib":787,"../../lib/gup":784}],1168:[function(h,N,H){N.exports={maxDimensionCount:60,overdrag:45,verticalPadding:2,tickDistance:50,canvasPixelRatio:1,blockLineCount:5e3,layers:["contextLineLayer","focusLineLayer","pickLineLayer"],axisTitleOffset:28,axisExtentOffset:10,deselectedLineColor:"#777",bar:{width:4,captureWidth:10,fillColor:"magenta",fillOpacity:1,snapDuration:150,snapRatio:.25,snapClose:.01,strokeOpacity:1,strokeWidth:1,handleHeight:8,handleOpacity:1,handleOverlap:0},cn:{axisExtentText:"axis-extent-text",parcoordsLineLayers:"parcoords-line-layers",parcoordsLineLayer:"parcoords-lines",parcoords:"parcoords",parcoordsControlView:"parcoords-control-view",yAxis:"y-axis",axisOverlays:"axis-overlays",axis:"axis",axisHeading:"axis-heading",axisTitle:"axis-title",axisExtent:"axis-extent",axisExtentTop:"axis-extent-top",axisExtentTopText:"axis-extent-top-text",axisExtentBottom:"axis-extent-bottom",axisExtentBottomText:"axis-extent-bottom-text",axisBrush:"axis-brush"},id:{filterBarPattern:"filter-bar-pattern"}}},{}],1169:[function(h,N,H){var t=h("../../lib"),m=h("../../components/colorscale/helpers").hasColorscale,g=h("../../components/colorscale/defaults"),p=h("../../plots/domain").defaults,e=h("../../plots/array_container_defaults"),f=h("../../plots/cartesian/axes"),u=h("./attributes"),i=h("./axisbrush"),s=h("./constants").maxDimensionCount,o=h("./merge_length");function a(c,r,n,d){function l(T,A){return t.coerce(c,r,u.dimensions,T,A)}var y=l("values"),v=l("visible");if(y&&y.length||(v=r.visible=!1),v){l("label"),l("tickvals"),l("ticktext"),l("tickformat");var _=l("range");r._ax={_id:"y",type:"linear",showexponent:"all",exponentformat:"B",range:_},f.setConvert(r._ax,d.layout),l("multiselect");var x=l("constraintrange");x&&(r.constraintrange=i.cleanRanges(x,r))}}N.exports=function(c,r,n,d){function l(T,A){return t.coerce(c,r,u,T,A)}var y=c.dimensions;Array.isArray(y)&&y.length>s&&(t.log("parcoords traces support up to "+s+" dimensions at the moment"),y.splice(s));var v=e(c,r,{name:"dimensions",layout:d,handleItemDefaults:a}),_=function(T,A,S,w,L){var k=L("line.color",S);if(m(T,"line")&&t.isArrayOrTypedArray(k)){if(k.length)return L("line.colorscale"),g(T,A,w,L,{prefix:"line.",cLetter:"c"}),k.length;A.line.color=S}return 1/0}(c,r,n,d,l);p(r,d,l),Array.isArray(v)&&v.length||(r.visible=!1),o(r,v,"values",_);var x={family:d.font.family,size:Math.round(d.font.size/1.2),color:d.font.color};t.coerceFont(l,"labelfont",x),t.coerceFont(l,"tickfont",x),t.coerceFont(l,"rangefont",x),l("labelangle"),l("labelside")}},{"../../components/colorscale/defaults":660,"../../components/colorscale/helpers":661,"../../lib":787,"../../plots/array_container_defaults":833,"../../plots/cartesian/axes":838,"../../plots/domain":866,"./attributes":1164,"./axisbrush":1165,"./constants":1168,"./merge_length":1173}],1170:[function(h,N,H){var t=h("../../lib").isTypedArray;H.convertTypedArray=function(m){return t(m)?Array.prototype.slice.call(m):m},H.isOrdinal=function(m){return!!m.tickvals},H.isVisible=function(m){return m.visible||!("visible"in m)}},{"../../lib":787}],1171:[function(h,N,H){N.exports={attributes:h("./attributes"),supplyDefaults:h("./defaults"),calc:h("./calc"),plot:h("./plot"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcoords",basePlotModule:h("./base_plot"),categories:["gl","regl","noOpacity","noHover"],meta:{}}},{"./attributes":1164,"./base_plot":1166,"./calc":1167,"./defaults":1169,"./plot":1175}],1172:[function(h,N,H){var t=h("glslify"),m=t([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

attribute vec4 p01_04, p05_08, p09_12, p13_16,
               p17_20, p21_24, p25_28, p29_32,
               p33_36, p37_40, p41_44, p45_48,
               p49_52, p53_56, p57_60, colors;

uniform mat4 dim0A, dim1A, dim0B, dim1B, dim0C, dim1C, dim0D, dim1D,
             loA, hiA, loB, hiB, loC, hiC, loD, hiD;

uniform vec2 resolution, viewBoxPos, viewBoxSize;
uniform float maskHeight;
uniform float drwLayer; // 0: context, 1: focus, 2: pick
uniform vec4 contextColor;
uniform sampler2D maskTexture, palette;

bool isPick    = (drwLayer > 1.5);
bool isContext = (drwLayer < 0.5);

const vec4 ZEROS = vec4(0.0, 0.0, 0.0, 0.0);
const vec4 UNITS = vec4(1.0, 1.0, 1.0, 1.0);

float val(mat4 p, mat4 v) {
    return dot(matrixCompMult(p, v) * UNITS, UNITS);
}

float axisY(float ratio, mat4 A, mat4 B, mat4 C, mat4 D) {
    float y1 = val(A, dim0A) + val(B, dim0B) + val(C, dim0C) + val(D, dim0D);
    float y2 = val(A, dim1A) + val(B, dim1B) + val(C, dim1C) + val(D, dim1D);
    return y1 * (1.0 - ratio) + y2 * ratio;
}

int iMod(int a, int b) {
    return a - b * (a / b);
}

bool fOutside(float p, float lo, float hi) {
    return (lo < hi) && (lo > p || p > hi);
}

bool vOutside(vec4 p, vec4 lo, vec4 hi) {
    return (
        fOutside(p[0], lo[0], hi[0]) ||
        fOutside(p[1], lo[1], hi[1]) ||
        fOutside(p[2], lo[2], hi[2]) ||
        fOutside(p[3], lo[3], hi[3])
    );
}

bool mOutside(mat4 p, mat4 lo, mat4 hi) {
    return (
        vOutside(p[0], lo[0], hi[0]) ||
        vOutside(p[1], lo[1], hi[1]) ||
        vOutside(p[2], lo[2], hi[2]) ||
        vOutside(p[3], lo[3], hi[3])
    );
}

bool outsideBoundingBox(mat4 A, mat4 B, mat4 C, mat4 D) {
    return mOutside(A, loA, hiA) ||
           mOutside(B, loB, hiB) ||
           mOutside(C, loC, hiC) ||
           mOutside(D, loD, hiD);
}

bool outsideRasterMask(mat4 A, mat4 B, mat4 C, mat4 D) {
    mat4 pnts[4];
    pnts[0] = A;
    pnts[1] = B;
    pnts[2] = C;
    pnts[3] = D;

    for(int i = 0; i < 4; ++i) {
        for(int j = 0; j < 4; ++j) {
            for(int k = 0; k < 4; ++k) {
                if(0 == iMod(
                    int(255.0 * texture2D(maskTexture,
                        vec2(
                            (float(i * 2 + j / 2) + 0.5) / 8.0,
                            (pnts[i][j][k] * (maskHeight - 1.0) + 1.0) / maskHeight
                        ))[3]
                    ) / int(pow(2.0, float(iMod(j * 4 + k, 8)))),
                    2
                )) return true;
            }
        }
    }
    return false;
}

vec4 position(bool isContext, float v, mat4 A, mat4 B, mat4 C, mat4 D) {
    float x = 0.5 * sign(v) + 0.5;
    float y = axisY(x, A, B, C, D);
    float z = 1.0 - abs(v);

    z += isContext ? 0.0 : 2.0 * float(
        outsideBoundingBox(A, B, C, D) ||
        outsideRasterMask(A, B, C, D)
    );

    return vec4(
        2.0 * (vec2(x, y) * viewBoxSize + viewBoxPos) / resolution - 1.0,
        z,
        1.0
    );
}

void main() {
    mat4 A = mat4(p01_04, p05_08, p09_12, p13_16);
    mat4 B = mat4(p17_20, p21_24, p25_28, p29_32);
    mat4 C = mat4(p33_36, p37_40, p41_44, p45_48);
    mat4 D = mat4(p49_52, p53_56, p57_60, ZEROS);

    float v = colors[3];

    gl_Position = position(isContext, v, A, B, C, D);

    fragColor =
        isContext ? vec4(contextColor) :
        isPick ? vec4(colors.rgb, 1.0) : texture2D(palette, vec2(abs(v), 0.5));
}
`]),g=t([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
    gl_FragColor = fragColor;
}
`]),p=h("./constants").maxDimensionCount,e=h("../../lib"),f=new Uint8Array(4),u=new Uint8Array(4),i={shape:[256,1],format:"rgba",type:"uint8",mag:"nearest",min:"nearest"};function s(v,_,x,T,A){var S=v._gl;S.enable(S.SCISSOR_TEST),S.scissor(_,x,T,A),v.clear({color:[0,0,0,0],depth:1})}function o(v,_,x,T,A,S){var w=S.key;x.drawCompleted||(function(L){L.read({x:0,y:0,width:1,height:1,data:f})}(v),x.drawCompleted=!0),function L(k){var C=Math.min(T,A-k*T);k===0&&(window.cancelAnimationFrame(x.currentRafs[w]),delete x.currentRafs[w],s(v,S.scissorX,S.scissorY,S.scissorWidth,S.viewBoxSize[1])),x.clearOnly||(S.count=2*C,S.offset=2*k*T,_(S),k*T+C<A&&(x.currentRafs[w]=window.requestAnimationFrame(function(){L(k+1)})),x.drawCompleted=!1)}(0)}function a(v,_){for(var x=new Array(256),T=0;T<256;T++)x[T]=v(T/255).concat(_);return x}function c(v,_){return(v>>>8*_)%256/255}function r(v,_,x){for(var T=new Array(8*_),A=0,S=0;S<_;S++)for(var w=0;w<2;w++)for(var L=0;L<4;L++){var k=4*v+L,C=x[64*S+k];k===63&&w===0&&(C*=-1),T[A++]=C}return T}function n(v){var _="0"+v;return _.substr(_.length-2)}function d(v){return v<p?"p"+n(v+1)+"_"+n(v+4):"colors"}function l(v,_,x,T,A,S,w,L,k,C,M,P,O,F){for(var j=[[],[]],W=0;W<64;W++)j[0][W]=W===A?1:0,j[1][W]=W===S?1:0;w*=F,L*=F,k*=F,C*=F;var Z=v.lines.canvasOverdrag*F,Q=v.domain,X=v.canvasWidth*F,G=v.canvasHeight*F,Y=v.pad.l*F,K=v.pad.b*F,D=v.layoutHeight*F,B=v.layoutWidth*F,q=v.deselectedLines.color;return e.extendFlat({key:M,resolution:[X,G],viewBoxPos:[w+Z,L],viewBoxSize:[k,C],i0:A,i1:S,dim0A:j[0].slice(0,16),dim0B:j[0].slice(16,32),dim0C:j[0].slice(32,48),dim0D:j[0].slice(48,64),dim1A:j[1].slice(0,16),dim1B:j[1].slice(16,32),dim1C:j[1].slice(32,48),dim1D:j[1].slice(48,64),drwLayer:P,contextColor:[q[0]/255,q[1]/255,q[2]/255,q[3]<1?q[3]:Math.max(1/255,Math.pow(1/v.lines.color.length,1/3))],scissorX:(T===_?0:w+Z)+(Y-Z)+B*Q.x[0],scissorWidth:(T===x?X-w+Z:k+.5)+(T===_?w+Z:0),scissorY:L+K+D*Q.y[0],scissorHeight:C,viewportX:Y-Z+B*Q.x[0],viewportY:K+D*Q.y[0],viewportWidth:X,viewportHeight:G},O)}function y(v){var _=Math.max(0,Math.floor(2047*v[0]),0),x=Math.min(2047,Math.ceil(2047*v[1]),2047);return[Math.min(_,x),Math.max(_,x)]}N.exports=function(v,_){var x,T,A,S,w,L=_.context,k=_.pick,C=_.regl,M=C._gl,P=M.getParameter(M.ALIASED_LINE_WIDTH_RANGE),O=Math.max(P[0],Math.min(P[1],_.viewModel.plotGlPixelRatio)),F={currentRafs:{},drawCompleted:!0,clearOnly:!1},j=function(G){for(var Y={},K=0;K<=p;K+=4)Y[d(K)]=G.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)});return Y}(C),W=C.texture(i),Z=[];X(_);var Q=C({profile:!1,blend:{enable:L,func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:1,dstAlpha:1},equation:{rgb:"add",alpha:"add"},color:[0,0,0,0]},depth:{enable:!L,mask:!0,func:"less",range:[0,1]},cull:{enable:!0,face:"back"},scissor:{enable:!0,box:{x:C.prop("scissorX"),y:C.prop("scissorY"),width:C.prop("scissorWidth"),height:C.prop("scissorHeight")}},viewport:{x:C.prop("viewportX"),y:C.prop("viewportY"),width:C.prop("viewportWidth"),height:C.prop("viewportHeight")},dither:!1,vert:m,frag:g,primitive:"lines",lineWidth:O,attributes:j,uniforms:{resolution:C.prop("resolution"),viewBoxPos:C.prop("viewBoxPos"),viewBoxSize:C.prop("viewBoxSize"),dim0A:C.prop("dim0A"),dim1A:C.prop("dim1A"),dim0B:C.prop("dim0B"),dim1B:C.prop("dim1B"),dim0C:C.prop("dim0C"),dim1C:C.prop("dim1C"),dim0D:C.prop("dim0D"),dim1D:C.prop("dim1D"),loA:C.prop("loA"),hiA:C.prop("hiA"),loB:C.prop("loB"),hiB:C.prop("hiB"),loC:C.prop("loC"),hiC:C.prop("hiC"),loD:C.prop("loD"),hiD:C.prop("hiD"),palette:W,contextColor:C.prop("contextColor"),maskTexture:C.prop("maskTexture"),drwLayer:C.prop("drwLayer"),maskHeight:C.prop("maskHeight")},offset:C.prop("offset"),count:C.prop("count")});function X(G){x=G.model,T=G.viewModel,A=T.dimensions.slice(),S=A[0]?A[0].values.length:0;var Y=x.lines,K=k?Y.color.map(function(B,q){return q/Y.color.length}):Y.color,D=function(B,q,ee){for(var J,$=new Array(B*(p+4)),te=0,ie=0;ie<B;ie++){for(var ae=0;ae<p;ae++)$[te++]=ae<q.length?q[ae].paddedUnitValues[ie]:.5;$[te++]=c(ie,2),$[te++]=c(ie,1),$[te++]=c(ie,0),$[te++]=(J=ee[ie],Math.max(1e-6,Math.min(.999999,J)))}return $}(S,A,K);(function(B,q,ee){for(var J=0;J<=p;J+=4)B[d(J)](r(J/4,q,ee))})(j,S,D),L||k||(W=C.texture(e.extendFlat({data:a(x.unitToColor,255)},i)))}return{render:function(G,Y,K){var D,B,q,ee=G.length,J=1/0,$=-1/0;for(D=0;D<ee;D++)G[D].dim0.canvasX<J&&(J=G[D].dim0.canvasX,B=D),G[D].dim1.canvasX>$&&($=G[D].dim1.canvasX,q=D);ee===0&&s(C,0,0,x.canvasWidth,x.canvasHeight);var te=function(be){var xe,ue,me,we=[[],[]];for(me=0;me<64;me++){var Me=!be&&me<A.length?A[me].brush.filter.getBounds():[-1/0,1/0];we[0][me]=Me[0],we[1][me]=Me[1]}var Se=new Array(16384);for(xe=0;xe<16384;xe++)Se[xe]=255;if(!be)for(xe=0;xe<A.length;xe++){var De=xe%8,Fe=(xe-De)/8,Ye=Math.pow(2,De),et=A[xe].brush.filter.get();if(!(et.length<2)){var Oe=y(et[0])[1];for(ue=1;ue<et.length;ue++){var je=y(et[ue]);for(me=Oe+1;me<je[0];me++)Se[8*me+Fe]&=~Ye;Oe=Math.max(Oe,je[1])}}}var We={shape:[8,2048],format:"alpha",type:"uint8",mag:"nearest",min:"nearest",data:Se};return w?w(We):w=C.texture(We),{maskTexture:w,maskHeight:2048,loA:we[0].slice(0,16),loB:we[0].slice(16,32),loC:we[0].slice(32,48),loD:we[0].slice(48,64),hiA:we[1].slice(0,16),hiB:we[1].slice(16,32),hiC:we[1].slice(32,48),hiD:we[1].slice(48,64)}}(L);for(D=0;D<ee;D++){var ie=G[D],ae=ie.dim0.crossfilterDimensionIndex,he=ie.dim1.crossfilterDimensionIndex,se=ie.canvasX,de=ie.canvasY,ce=se+ie.panelSizeX,ve=ie.plotGlPixelRatio;if(Y||!Z[ae]||Z[ae][0]!==se||Z[ae][1]!==ce){Z[ae]=[se,ce];var ke=l(x,B,q,D,ae,he,se,de,ie.panelSizeX,ie.panelSizeY,ie.dim0.crossfilterDimensionIndex,L?0:k?2:1,te,ve);F.clearOnly=K;var Ee=Y?x.lines.blockLineCount:S;o(C,Q,F,Ee,S,ke)}}},readPixel:function(G,Y){return C.read({x:G,y:Y,width:1,height:1,data:u}),u},readPixels:function(G,Y,K,D){var B=new Uint8Array(4*K*D);return C.read({x:G,y:Y,width:K,height:D,data:B}),B},destroy:function(){for(var G in v.style["pointer-events"]="none",W.destroy(),w&&w.destroy(),j)j[G].destroy()},update:X}}},{"../../lib":787,"./constants":1168,glslify:434}],1173:[function(h,N,H){N.exports=function(t,m,g,p){var e,f;for(p||(p=1/0),e=0;e<m.length;e++)(f=m[e]).visible&&(p=Math.min(p,f[g].length));for(p===1/0&&(p=0),t._length=p,e=0;e<m.length;e++)(f=m[e]).visible&&(f._length=p);return p}},{}],1174:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../lib"),g=m.numberFormat,p=h("color-rgba"),e=h("../../plots/cartesian/axes"),f=m.strRotate,u=m.strTranslate,i=h("../../lib/svg_text_utils"),s=h("../../components/drawing"),o=h("../../components/colorscale"),a=h("../../lib/gup"),c=a.keyFun,r=a.repeat,n=a.unwrap,d=h("./helpers"),l=h("./constants"),y=h("./axisbrush"),v=h("./lines");function _(Z,Q,X){return m.aggNums(Z,null,Q,X)}function x(Z,Q){return A(_(Math.min,Z,Q),_(Math.max,Z,Q))}function T(Z){var Q=Z.range;return Q?A(Q[0],Q[1]):x(Z.values,Z._length)}function A(Z,Q){return!isNaN(Z)&&isFinite(Z)||(Z=0),!isNaN(Q)&&isFinite(Q)||(Q=0),Z===Q&&(Z===0?(Z-=1,Q+=1):(Z*=.9,Q*=1.1)),[Z,Q]}function S(Z,Q,X,G,Y){var K,D,B=T(X);return G?t.scale.ordinal().domain(G.map((K=g(X.tickformat),D=Y,D?function(q,ee){var J=D[ee];return J==null?K(q):J}:K))).range(G.map(function(q){var ee=(q-B[0])/(B[1]-B[0]);return Z-Q+ee*(2*Q-Z)})):t.scale.linear().domain(B).range([Z-Q,Q])}function w(Z){if(Z.tickvals){var Q=T(Z);return t.scale.ordinal().domain(Z.tickvals).range(Z.tickvals.map(function(X){return(X-Q[0])/(Q[1]-Q[0])}))}}function L(Z){var Q=Z.map(function(Y){return Y[0]}),X=Z.map(function(Y){var K=p(Y[1]);return t.rgb("rgb("+K[0]+","+K[1]+","+K[2]+")")}),G="rgb".split("").map(function(Y){return t.scale.linear().clamp(!0).domain(Q).range(X.map((K=Y,function(D){return D[K]})));var K});return function(Y){return G.map(function(K){return K(Y)})}}function k(Z){return Z.dimensions.some(function(Q){return Q.brush.filterSpecified})}function C(Z,Q,X){var G=n(Q),Y=G.trace,K=d.convertTypedArray(G.lineColor),D=Y.line,B={color:p(l.deselectedLineColor)},q=o.extractOpts(D),ee=q.reversescale?o.flipScale(G.cscale):G.cscale,J=Y.domain,$=Y.dimensions,te=Z.width,ie=Y.labelangle,ae=Y.labelside,he=Y.labelfont,se=Y.tickfont,de=Y.rangefont,ce=m.extendDeepNoArrays({},D,{color:K.map(t.scale.linear().domain(T({values:K,range:[q.min,q.max],_length:Y._length}))),blockLineCount:l.blockLineCount,canvasOverdrag:l.overdrag*l.canvasPixelRatio}),ve=Math.floor(te*(J.x[1]-J.x[0])),ke=Math.floor(Z.height*(J.y[1]-J.y[0])),Ee=Z.margin||{l:80,r:80,t:100,b:80},be=ve,xe=ke;return{key:X,colCount:$.filter(d.isVisible).length,dimensions:$,tickDistance:l.tickDistance,unitToColor:L(ee),lines:ce,deselectedLines:B,labelAngle:ie,labelSide:ae,labelFont:he,tickFont:se,rangeFont:de,layoutWidth:te,layoutHeight:Z.height,domain:J,translateX:J.x[0]*te,translateY:Z.height-J.y[1]*Z.height,pad:Ee,canvasWidth:be*l.canvasPixelRatio+2*ce.canvasOverdrag,canvasHeight:xe*l.canvasPixelRatio,width:be,height:xe,canvasPixelRatio:l.canvasPixelRatio}}function M(Z,Q,X){var G=X.width,Y=X.height,K=X.dimensions,D=X.canvasPixelRatio,B=function(te){return G*te/Math.max(1,X.colCount-1)},q=l.verticalPadding/Y,ee=function(te,ie){return t.scale.linear().range([ie,te-ie])}(Y,l.verticalPadding),J={key:X.key,xScale:B,model:X,inBrushDrag:!1},$={};return J.dimensions=K.filter(d.isVisible).map(function(te,ie){var ae=function(Se,De){return t.scale.linear().domain(T(Se)).range([De,1-De])}(te,q),he=$[te.label];$[te.label]=(he||0)+1;var se=te.label+(he?"__"+he:""),de=te.constraintrange,ce=de&&de.length;ce&&!Array.isArray(de[0])&&(de=[de]);var ve=ce?de.map(function(Se){return Se.map(ae)}):[[-1/0,1/0]],ke=te.values;ke.length>te._length&&(ke=ke.slice(0,te._length));var Ee,be=te.tickvals;function xe(Se,De){return{val:Se,text:Ee[De]}}function ue(Se,De){return Se.val-De.val}if(Array.isArray(be)&&be.length){Ee=te.ticktext,Array.isArray(Ee)&&Ee.length?Ee.length>be.length?Ee=Ee.slice(0,be.length):be.length>Ee.length&&(be=be.slice(0,Ee.length)):Ee=be.map(g(te.tickformat));for(var me=1;me<be.length;me++)if(be[me]<be[me-1]){for(var we=be.map(xe).sort(ue),Me=0;Me<be.length;Me++)be[Me]=we[Me].val,Ee[Me]=we[Me].text;break}}else be=void 0;return ke=d.convertTypedArray(ke),{key:se,label:te.label,tickFormat:te.tickformat,tickvals:be,ticktext:Ee,ordinal:d.isOrdinal(te),multiselect:te.multiselect,xIndex:ie,crossfilterDimensionIndex:ie,visibleIndex:te._index,height:Y,values:ke,paddedUnitValues:ke.map(ae),unitTickvals:be&&be.map(ae),xScale:B,x:B(ie),canvasX:B(ie)*D,unitToPaddedPx:ee,domainScale:S(Y,l.verticalPadding,te,be,Ee),ordinalScale:w(te),parent:J,model:X,brush:y.makeBrush(Z,ce,ve,function(){Z.linePickActive(!1)},function(){var Se=J;Se.focusLayer&&Se.focusLayer.render(Se.panels,!0);var De=k(Se);!Z.contextShown()&&De?(Se.contextLayer&&Se.contextLayer.render(Se.panels,!0),Z.contextShown(!0)):Z.contextShown()&&!De&&(Se.contextLayer&&Se.contextLayer.render(Se.panels,!0,!0),Z.contextShown(!1))},function(Se){if(J.focusLayer.render(J.panels,!0),J.pickLayer&&J.pickLayer.render(J.panels,!0),Z.linePickActive(!0),Q&&Q.filterChanged){var De=ae.invert,Fe=Se.map(function(Ye){return Ye.map(De).sort(m.sorterAsc)}).sort(function(Ye,et){return Ye[0]-et[0]});Q.filterChanged(J.key,te._index,Fe)}})}}),J}function P(Z){Z.classed(l.cn.axisExtentText,!0).attr("text-anchor","middle").style("cursor","default")}function O(Z,Q){var X=Q==="top"?1:-1,G=Z*Math.PI/180;return{dir:X,dx:Math.sin(G),dy:Math.cos(G),degrees:Z}}function F(Z,Q,X){for(var G=Q.panels||(Q.panels=[]),Y=Z.data(),K=0;K<Y.length-1;K++){var D=G[K]||(G[K]={}),B=Y[K],q=Y[K+1];D.dim0=B,D.dim1=q,D.canvasX=B.canvasX,D.panelSizeX=q.canvasX-B.canvasX,D.panelSizeY=Q.model.canvasHeight,D.y=0,D.canvasY=0,D.plotGlPixelRatio=X}}function j(Z,Q){return e.tickText(Z._ax,Q,!1).text}function W(Z,Q){if(Z.ordinal)return"";var X=Z.domainScale.domain(),G=X[Q?X.length-1:0];return j(Z.model.dimensions[Z.visibleIndex],G)}N.exports=function(Z,Q,X,G){var Y=Z._fullLayout,K=Y._toppaper,D=Y._glcontainer,B=Z._context.plotGlPixelRatio,q=Z._fullLayout.paper_bgcolor;(function(Me){for(var Se=0;Se<Me.length;Se++)for(var De=0;De<Me[Se].length;De++)for(var Fe=Me[Se][De].trace,Ye=Fe.dimensions,et=0;et<Ye.length;et++){var Oe=Ye[et].values,je=Ye[et]._ax;je&&(je.range?je.range=A(je.range[0],je.range[1]):je.range=x(Oe,Fe._length),je.dtick||(je.dtick=.01*(Math.abs(je.range[1]-je.range[0])||1)),je.tickformat=Ye[et].tickformat,e.calcTicks(je),je.cleanRange())}})(Q);var ee,J,$=(ee=!0,J=!1,{linePickActive:function(Me){return arguments.length?ee=!!Me:ee},contextShown:function(Me){return arguments.length?J=!!Me:J}}),te=Q.filter(function(Me){return n(Me).trace.visible}).map(C.bind(0,X)).map(M.bind(0,$,G));D.each(function(Me,Se){return m.extendFlat(Me,te[Se])});var ie=D.selectAll(".gl-canvas").each(function(Me){Me.viewModel=te[0],Me.viewModel.plotGlPixelRatio=B,Me.viewModel.paperColor=q,Me.model=Me.viewModel?Me.viewModel.model:null}),ae=null;ie.filter(function(Me){return Me.pick}).style("pointer-events","auto").on("mousemove",function(Me){if($.linePickActive()&&Me.lineLayer&&G&&G.hover){var Se=t.event,De=this.width,Fe=this.height,Ye=t.mouse(this),et=Ye[0],Oe=Ye[1];if(et<0||Oe<0||et>=De||Oe>=Fe)return;var je=Me.lineLayer.readPixel(et,Fe-1-Oe),We=je[3]!==0,Ge=We?je[2]+256*(je[1]+256*je[0]):null,Qe={x:et,y:Oe,clientX:Se.clientX,clientY:Se.clientY,dataIndex:Me.model.key,curveNumber:Ge};Ge!==ae&&(We?G.hover(Qe):G.unhover&&G.unhover(Qe),ae=Ge)}}),ie.style("opacity",function(Me){return Me.pick?0:1}),K.style("background","rgba(255, 255, 255, 0)");var he=K.selectAll("."+l.cn.parcoords).data(te,c);he.exit().remove(),he.enter().append("g").classed(l.cn.parcoords,!0).style("shape-rendering","crispEdges").style("pointer-events","none"),he.attr("transform",function(Me){return u(Me.model.translateX,Me.model.translateY)});var se=he.selectAll("."+l.cn.parcoordsControlView).data(r,c);se.enter().append("g").classed(l.cn.parcoordsControlView,!0),se.attr("transform",function(Me){return u(Me.model.pad.l,Me.model.pad.t)});var de=se.selectAll("."+l.cn.yAxis).data(function(Me){return Me.dimensions},c);de.enter().append("g").classed(l.cn.yAxis,!0),se.each(function(Me){F(de,Me,B)}),ie.each(function(Me){if(Me.viewModel){!Me.lineLayer||G?Me.lineLayer=v(this,Me):Me.lineLayer.update(Me),(Me.key||Me.key===0)&&(Me.viewModel[Me.key]=Me.lineLayer);var Se=!Me.context||G;Me.lineLayer.render(Me.viewModel.panels,Se)}}),de.attr("transform",function(Me){return u(Me.xScale(Me.xIndex),0)}),de.call(t.behavior.drag().origin(function(Me){return Me}).on("drag",function(Me){var Se=Me.parent;$.linePickActive(!1),Me.x=Math.max(-l.overdrag,Math.min(Me.model.width+l.overdrag,t.event.x)),Me.canvasX=Me.x*Me.model.canvasPixelRatio,de.sort(function(De,Fe){return De.x-Fe.x}).each(function(De,Fe){De.xIndex=Fe,De.x=Me===De?De.x:De.xScale(De.xIndex),De.canvasX=De.x*De.model.canvasPixelRatio}),F(de,Se,B),de.filter(function(De){return Math.abs(Me.xIndex-De.xIndex)!==0}).attr("transform",function(De){return u(De.xScale(De.xIndex),0)}),t.select(this).attr("transform",u(Me.x,0)),de.each(function(De,Fe,Ye){Ye===Me.parent.key&&(Se.dimensions[Fe]=De)}),Se.contextLayer&&Se.contextLayer.render(Se.panels,!1,!k(Se)),Se.focusLayer.render&&Se.focusLayer.render(Se.panels)}).on("dragend",function(Me){var Se=Me.parent;Me.x=Me.xScale(Me.xIndex),Me.canvasX=Me.x*Me.model.canvasPixelRatio,F(de,Se,B),t.select(this).attr("transform",function(De){return u(De.x,0)}),Se.contextLayer&&Se.contextLayer.render(Se.panels,!1,!k(Se)),Se.focusLayer&&Se.focusLayer.render(Se.panels),Se.pickLayer&&Se.pickLayer.render(Se.panels,!0),$.linePickActive(!0),G&&G.axesMoved&&G.axesMoved(Se.key,Se.dimensions.map(function(De){return De.crossfilterDimensionIndex}))})),de.exit().remove();var ce=de.selectAll("."+l.cn.axisOverlays).data(r,c);ce.enter().append("g").classed(l.cn.axisOverlays,!0),ce.selectAll("."+l.cn.axis).remove();var ve=ce.selectAll("."+l.cn.axis).data(r,c);ve.enter().append("g").classed(l.cn.axis,!0),ve.each(function(Me){var Se=Me.model.height/Me.model.tickDistance,De=Me.domainScale,Fe=De.domain();t.select(this).call(t.svg.axis().orient("left").tickSize(4).outerTickSize(2).ticks(Se,Me.tickFormat).tickValues(Me.ordinal?Fe:null).tickFormat(function(Ye){return d.isOrdinal(Me)?Ye:j(Me.model.dimensions[Me.visibleIndex],Ye)}).scale(De)),s.font(ve.selectAll("text"),Me.model.tickFont)}),ve.selectAll(".domain, .tick>line").attr("fill","none").attr("stroke","black").attr("stroke-opacity",.25).attr("stroke-width","1px"),ve.selectAll("text").style("text-shadow",i.makeTextShadow(q)).style("cursor","default");var ke=ce.selectAll("."+l.cn.axisHeading).data(r,c);ke.enter().append("g").classed(l.cn.axisHeading,!0);var Ee=ke.selectAll("."+l.cn.axisTitle).data(r,c);Ee.enter().append("text").classed(l.cn.axisTitle,!0).attr("text-anchor","middle").style("cursor","ew-resize").style("pointer-events","auto"),Ee.text(function(Me){return Me.label}).each(function(Me){var Se=t.select(this);s.font(Se,Me.model.labelFont),i.convertToTspans(Se,Z)}).attr("transform",function(Me){var Se=O(Me.model.labelAngle,Me.model.labelSide),De=l.axisTitleOffset;return(Se.dir>0?"":u(0,2*De+Me.model.height))+f(Se.degrees)+u(-De*Se.dx,-De*Se.dy)}).attr("text-anchor",function(Me){var Se=O(Me.model.labelAngle,Me.model.labelSide);return 2*Math.abs(Se.dx)>Math.abs(Se.dy)?Se.dir*Se.dx<0?"start":"end":"middle"});var be=ce.selectAll("."+l.cn.axisExtent).data(r,c);be.enter().append("g").classed(l.cn.axisExtent,!0);var xe=be.selectAll("."+l.cn.axisExtentTop).data(r,c);xe.enter().append("g").classed(l.cn.axisExtentTop,!0),xe.attr("transform",u(0,-l.axisExtentOffset));var ue=xe.selectAll("."+l.cn.axisExtentTopText).data(r,c);ue.enter().append("text").classed(l.cn.axisExtentTopText,!0).call(P),ue.text(function(Me){return W(Me,!0)}).each(function(Me){s.font(t.select(this),Me.model.rangeFont)});var me=be.selectAll("."+l.cn.axisExtentBottom).data(r,c);me.enter().append("g").classed(l.cn.axisExtentBottom,!0),me.attr("transform",function(Me){return u(0,Me.model.height+l.axisExtentOffset)});var we=me.selectAll("."+l.cn.axisExtentBottomText).data(r,c);we.enter().append("text").classed(l.cn.axisExtentBottomText,!0).attr("dy","0.75em").call(P),we.text(function(Me){return W(Me,!1)}).each(function(Me){s.font(t.select(this),Me.model.rangeFont)}),y.ensureAxisBrush(ce,q)}},{"../../components/colorscale":662,"../../components/drawing":672,"../../lib":787,"../../lib/gup":784,"../../lib/svg_text_utils":813,"../../plots/cartesian/axes":838,"./axisbrush":1165,"./constants":1168,"./helpers":1170,"./lines":1172,"@plotly/d3":58,"color-rgba":133}],1175:[function(h,N,H){var t=h("./parcoords"),m=h("../../lib/prepare_regl"),g=h("./helpers").isVisible;function p(e,f,u){var i=f.indexOf(u),s=e.indexOf(i);return s===-1&&(s+=f.length),s}N.exports=function(e,f){var u=e._fullLayout;if(m(e)){var i={},s={},o={},a={},c=u._size;f.forEach(function(r,n){var d=r[0].trace;o[n]=d.index;var l=a[n]=d._fullInput.index;i[n]=e.data[l].dimensions,s[n]=e.data[l].dimensions.slice()}),t(e,f,{width:c.w,height:c.h,margin:{t:c.t,r:c.r,b:c.b,l:c.l}},{filterChanged:function(r,n,d){var l=s[r][n],y=d.map(function(S){return S.slice()}),v="dimensions["+n+"].constraintrange",_=u._tracePreGUI[e._fullData[o[r]]._fullInput.uid];if(_[v]===void 0){var x=l.constraintrange;_[v]=x||null}var T=e._fullData[o[r]].dimensions[n];y.length?(y.length===1&&(y=y[0]),l.constraintrange=y,T.constraintrange=y.slice(),y=[y]):(delete l.constraintrange,delete T.constraintrange,y=null);var A={};A[v]=y,e.emit("plotly_restyle",[A,[a[r]]])},hover:function(r){e.emit("plotly_hover",r)},unhover:function(r){e.emit("plotly_unhover",r)},axesMoved:function(r,n){var d=function(l,y){return function(v,_){return p(l,y,v)-p(l,y,_)}}(n,s[r].filter(g));i[r].sort(d),s[r].filter(function(l){return!g(l)}).sort(function(l){return s[r].indexOf(l)}).forEach(function(l){i[r].splice(i[r].indexOf(l),1),i[r].splice(s[r].indexOf(l),0,l)}),e.emit("plotly_restyle",[{dimensions:[i[r]]},[a[r]]])}})}}},{"../../lib/prepare_regl":800,"./helpers":1170,"./parcoords":1174}],1176:[function(h,N,H){var t=h("../../plots/attributes"),m=h("../../plots/domain").attributes,g=h("../../plots/font_attributes"),p=h("../../components/color/attributes"),e=h("../../plots/template_attributes").hovertemplateAttrs,f=h("../../plots/template_attributes").texttemplateAttrs,u=h("../../lib/extend").extendFlat,i=g({editType:"plot",arrayOk:!0,colorEditType:"plot"});N.exports={labels:{valType:"data_array",editType:"calc"},label0:{valType:"number",dflt:0,editType:"calc"},dlabel:{valType:"number",dflt:1,editType:"calc"},values:{valType:"data_array",editType:"calc"},marker:{colors:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:p.defaultLine,arrayOk:!0,editType:"style"},width:{valType:"number",min:0,dflt:0,arrayOk:!0,editType:"style"},editType:"calc"},editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},scalegroup:{valType:"string",dflt:"",editType:"calc"},textinfo:{valType:"flaglist",flags:["label","text","value","percent"],extras:["none"],editType:"calc"},hoverinfo:u({},t.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:e({},{keys:["label","color","value","percent","text"]}),texttemplate:f({editType:"plot"},{keys:["label","color","value","percent","text"]}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"plot"},textfont:u({},i,{}),insidetextorientation:{valType:"enumerated",values:["horizontal","radial","tangential","auto"],dflt:"auto",editType:"plot"},insidetextfont:u({},i,{}),outsidetextfont:u({},i,{}),automargin:{valType:"boolean",dflt:!1,editType:"plot"},title:{text:{valType:"string",dflt:"",editType:"plot"},font:u({},i,{}),position:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"plot"},editType:"plot"},domain:m({name:"pie",trace:!0,editType:"calc"}),hole:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},sort:{valType:"boolean",dflt:!0,editType:"calc"},direction:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"number",min:-360,max:360,dflt:0,editType:"calc"},pull:{valType:"number",min:0,max:1,dflt:0,arrayOk:!0,editType:"calc"},_deprecated:{title:{valType:"string",dflt:"",editType:"calc"},titlefont:u({},i,{}),titleposition:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"calc"}}}},{"../../components/color/attributes":649,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/domain":866,"../../plots/font_attributes":867,"../../plots/template_attributes":910}],1177:[function(h,N,H){var t=h("../../plots/plots");H.name="pie",H.plot=function(m,g,p,e){t.plotBasePlot(H.name,m,g,p,e)},H.clean=function(m,g,p,e){t.cleanBasePlot(H.name,m,g,p,e)}},{"../../plots/plots":901}],1178:[function(h,N,H){var t=h("fast-isnumeric"),m=h("tinycolor2"),g=h("../../components/color"),p={};function e(u){return function(i,s){return!!i&&!!(i=m(i)).isValid()&&(i=g.addOpacity(i,i.getAlpha()),u[s]||(u[s]=i),i)}}function f(u,i){var s,o=JSON.stringify(u),a=i[o];if(!a){for(a=u.slice(),s=0;s<u.length;s++)a.push(m(u[s]).lighten(20).toHexString());for(s=0;s<u.length;s++)a.push(m(u[s]).darken(20).toHexString());i[o]=a}return a}N.exports={calc:function(u,i){var s,o,a=[],c=u._fullLayout,r=c.hiddenlabels||[],n=i.labels,d=i.marker.colors||[],l=i.values,y=i._length,v=i._hasValues&&y;if(i.dlabel)for(n=new Array(y),s=0;s<y;s++)n[s]=String(i.label0+s*i.dlabel);var _={},x=e(c["_"+i.type+"colormap"]),T=0,A=!1;for(s=0;s<y;s++){var S,w,L;if(v){if(S=l[s],!t(S)||(S=+S)<0)continue}else S=1;(w=n[s])!==void 0&&w!==""||(w=s);var k=_[w=String(w)];k===void 0?(_[w]=a.length,(L=r.indexOf(w)!==-1)||(T+=S),a.push({v:S,label:w,color:x(d[s],w),i:s,pts:[s],hidden:L})):(A=!0,(o=a[k]).v+=S,o.pts.push(s),o.hidden||(T+=S),o.color===!1&&d[s]&&(o.color=x(d[s],w)))}return(i.type==="funnelarea"?A:i.sort)&&a.sort(function(C,M){return M.v-C.v}),a[0]&&(a[0].vTotal=T),a},crossTraceCalc:function(u,i){var s=(i||{}).type;s||(s="pie");var o=u._fullLayout,a=u.calcdata,c=o[s+"colorway"],r=o["_"+s+"colormap"];o["extend"+s+"colors"]&&(c=f(c,p));for(var n=0,d=0;d<a.length;d++){var l=a[d];if(l[0].trace.type===s)for(var y=0;y<l.length;y++){var v=l[y];v.color===!1&&(r[v.label]?v.color=r[v.label]:(r[v.label]=v.color=c[n%c.length],n++))}}},makePullColorFn:e,generateExtendedColors:f}},{"../../components/color":650,"fast-isnumeric":246,tinycolor2:583}],1179:[function(h,N,H){var t=h("fast-isnumeric"),m=h("../../lib"),g=h("./attributes"),p=h("../../plots/domain").defaults,e=h("../bar/defaults").handleText;function f(u,i){var s=Array.isArray(u),o=m.isArrayOrTypedArray(i),a=Math.min(s?u.length:1/0,o?i.length:1/0);if(isFinite(a)||(a=0),a&&o){for(var c,r=0;r<a;r++){var n=i[r];if(t(n)&&n>0){c=!0;break}}c||(a=0)}return{hasLabels:s,hasValues:o,len:a}}N.exports={handleLabelsAndValues:f,supplyDefaults:function(u,i,s,o){function a(x,T){return m.coerce(u,i,g,x,T)}var c=f(a("labels"),a("values")),r=c.len;if(i._hasLabels=c.hasLabels,i._hasValues=c.hasValues,!i._hasLabels&&i._hasValues&&(a("label0"),a("dlabel")),r){i._length=r,a("marker.line.width")&&a("marker.line.color"),a("marker.colors"),a("scalegroup");var n,d=a("text"),l=a("texttemplate");if(l||(n=a("textinfo",Array.isArray(d)?"text+percent":"percent")),a("hovertext"),a("hovertemplate"),l||n&&n!=="none"){var y=a("textposition");e(u,i,o,a,y,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),(Array.isArray(y)||y==="auto"||y==="outside")&&a("automargin"),(y==="inside"||y==="auto"||Array.isArray(y))&&a("insidetextorientation")}p(i,o,a);var v=a("hole");if(a("title.text")){var _=a("title.position",v?"middle center":"top center");v||_!=="middle center"||(i.title.position="top center"),m.coerceFont(a,"title.font",o.font)}a("sort"),a("direction"),a("rotation"),a("pull")}else i.visible=!1}}},{"../../lib":787,"../../plots/domain":866,"../bar/defaults":929,"./attributes":1176,"fast-isnumeric":246}],1180:[function(h,N,H){var t=h("../../components/fx/helpers").appendArrayMultiPointValues;N.exports=function(m,g){var p={curveNumber:g.index,pointNumbers:m.pts,data:g._input,fullData:g,label:m.label,color:m.color,value:m.v,percent:m.percent,text:m.text,bbox:m.bbox,v:m.v};return m.pts.length===1&&(p.pointNumber=p.i=m.pts[0]),t(p,g,m.pts),g.type==="funnelarea"&&(delete p.v,delete p.i),p}},{"../../components/fx/helpers":686}],1181:[function(h,N,H){var t=h("../../lib");function m(g){return g.indexOf("e")!==-1?g.replace(/[.]?0+e/,"e"):g.indexOf(".")!==-1?g.replace(/[.]?0+$/,""):g}H.formatPiePercent=function(g,p){var e=m((100*g).toPrecision(3));return t.numSeparate(e,p)+"%"},H.formatPieValue=function(g,p){var e=m(g.toPrecision(10));return t.numSeparate(e,p)},H.getFirstFilled=function(g,p){if(Array.isArray(g))for(var e=0;e<p.length;e++){var f=g[p[e]];if(f||f===0||f==="")return f}},H.castOption=function(g,p){return Array.isArray(g)?H.getFirstFilled(g,p):g||void 0},H.getRotationAngle=function(g){return(g==="auto"?0:g)*Math.PI/180}},{"../../lib":787}],1182:[function(h,N,H){N.exports={attributes:h("./attributes"),supplyDefaults:h("./defaults").supplyDefaults,supplyLayoutDefaults:h("./layout_defaults"),layoutAttributes:h("./layout_attributes"),calc:h("./calc").calc,crossTraceCalc:h("./calc").crossTraceCalc,plot:h("./plot").plot,style:h("./style"),styleOne:h("./style_one"),moduleType:"trace",name:"pie",basePlotModule:h("./base_plot"),categories:["pie-like","pie","showLegend"],meta:{}}},{"./attributes":1176,"./base_plot":1177,"./calc":1178,"./defaults":1179,"./layout_attributes":1183,"./layout_defaults":1184,"./plot":1185,"./style":1186,"./style_one":1187}],1183:[function(h,N,H){N.exports={hiddenlabels:{valType:"data_array",editType:"calc"},piecolorway:{valType:"colorlist",editType:"calc"},extendpiecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1184:[function(h,N,H){var t=h("../../lib"),m=h("./layout_attributes");N.exports=function(g,p){function e(f,u){return t.coerce(g,p,m,f,u)}e("hiddenlabels"),e("piecolorway",p.colorway),e("extendpiecolors")}},{"../../lib":787,"./layout_attributes":1183}],1185:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../plots/plots"),g=h("../../components/fx"),p=h("../../components/color"),e=h("../../components/drawing"),f=h("../../lib"),u=f.strScale,i=f.strTranslate,s=h("../../lib/svg_text_utils"),o=h("../bar/uniform_text"),a=o.recordMinTextSize,c=o.clearMinTextSize,r=h("../bar/constants").TEXTPAD,n=h("./helpers"),d=h("./event_data"),l=h("../../lib").isValidTextValue;function y(Q,X,G){var Y=G[0],K=Y.cx,D=Y.cy,B=Y.trace,q=B.type==="funnelarea";"_hasHoverLabel"in B||(B._hasHoverLabel=!1),"_hasHoverEvent"in B||(B._hasHoverEvent=!1),Q.on("mouseover",function(ee){var J=X._fullLayout,$=X._fullData[B.index];if(!X._dragging&&J.hovermode!==!1){var te=$.hoverinfo;if(Array.isArray(te)&&(te=g.castHoverinfo({hoverinfo:[n.castOption(te,ee.pts)],_module:B._module},J,0)),te==="all"&&(te="label+text+value+percent+name"),$.hovertemplate||te!=="none"&&te!=="skip"&&te){var ie=ee.rInscribed||0,ae=K+ee.pxmid[0]*(1-ie),he=D+ee.pxmid[1]*(1-ie),se=J.separators,de=[];if(te&&te.indexOf("label")!==-1&&de.push(ee.label),ee.text=n.castOption($.hovertext||$.text,ee.pts),te&&te.indexOf("text")!==-1){var ce=ee.text;f.isValidTextValue(ce)&&de.push(ce)}ee.value=ee.v,ee.valueLabel=n.formatPieValue(ee.v,se),te&&te.indexOf("value")!==-1&&de.push(ee.valueLabel),ee.percent=ee.v/Y.vTotal,ee.percentLabel=n.formatPiePercent(ee.percent,se),te&&te.indexOf("percent")!==-1&&de.push(ee.percentLabel);var ve=$.hoverlabel,ke=ve.font,Ee=[];g.loneHover({trace:B,x0:ae-ie*Y.r,x1:ae+ie*Y.r,y:he,_x0:q?K+ee.TL[0]:ae-ie*Y.r,_x1:q?K+ee.TR[0]:ae+ie*Y.r,_y0:q?D+ee.TL[1]:he-ie*Y.r,_y1:q?D+ee.BL[1]:he+ie*Y.r,text:de.join("<br>"),name:$.hovertemplate||te.indexOf("name")!==-1?$.name:void 0,idealAlign:ee.pxmid[0]<0?"left":"right",color:n.castOption(ve.bgcolor,ee.pts)||ee.color,borderColor:n.castOption(ve.bordercolor,ee.pts),fontFamily:n.castOption(ke.family,ee.pts),fontSize:n.castOption(ke.size,ee.pts),fontColor:n.castOption(ke.color,ee.pts),nameLength:n.castOption(ve.namelength,ee.pts),textAlign:n.castOption(ve.align,ee.pts),hovertemplate:n.castOption($.hovertemplate,ee.pts),hovertemplateLabels:ee,eventData:[d(ee,$)]},{container:J._hoverlayer.node(),outerContainer:J._paper.node(),gd:X,inOut_bbox:Ee}),ee.bbox=Ee[0],B._hasHoverLabel=!0}B._hasHoverEvent=!0,X.emit("plotly_hover",{points:[d(ee,$)],event:t.event})}}),Q.on("mouseout",function(ee){var J=X._fullLayout,$=X._fullData[B.index],te=t.select(this).datum();B._hasHoverEvent&&(ee.originalEvent=t.event,X.emit("plotly_unhover",{points:[d(te,$)],event:t.event}),B._hasHoverEvent=!1),B._hasHoverLabel&&(g.loneUnhover(J._hoverlayer.node()),B._hasHoverLabel=!1)}),Q.on("click",function(ee){var J=X._fullLayout,$=X._fullData[B.index];X._dragging||J.hovermode===!1||(X._hoverdata=[d(ee,$)],g.click(X,t.event))})}function v(Q,X,G){var Y=n.castOption(Q.insidetextfont.color,X.pts);!Y&&Q._input.textfont&&(Y=n.castOption(Q._input.textfont.color,X.pts));var K=n.castOption(Q.insidetextfont.family,X.pts)||n.castOption(Q.textfont.family,X.pts)||G.family,D=n.castOption(Q.insidetextfont.size,X.pts)||n.castOption(Q.textfont.size,X.pts)||G.size;return{color:Y||p.contrast(X.color),family:K,size:D}}function _(Q,X){for(var G,Y,K=0;K<Q.length;K++)if((Y=(G=Q[K][0]).trace).title.text){var D=Y.title.text;Y._meta&&(D=f.templateString(D,Y._meta));var B=e.tester.append("text").attr("data-notex",1).text(D).call(e.font,Y.title.font).call(s.convertToTspans,X),q=e.bBox(B.node(),!0);G.titleBox={width:q.width,height:q.height},B.remove()}}function x(Q,X,G){var Y=G.r||X.rpx1,K=X.rInscribed;if(X.startangle===X.stopangle)return{rCenter:1-K,scale:0,rotate:0,textPosAngle:0};var D,B=X.ring,q=B===1&&Math.abs(X.startangle-X.stopangle)===2*Math.PI,ee=X.halfangle,J=X.midangle,$=G.trace.insidetextorientation,te=$==="horizontal",ie=$==="tangential",ae=$==="radial",he=$==="auto",se=[];if(!he){var de,ce=function(ue,me){if(function(De,Fe){var Ye=De.startangle,et=De.stopangle;return Ye>Fe&&Fe>et||Ye<Fe&&Fe<et}(X,ue)){var we=Math.abs(ue-X.startangle),Me=Math.abs(ue-X.stopangle),Se=we<Me?we:Me;(D=me==="tan"?A(Q,Y,B,Se,0):T(Q,Y,B,Se,Math.PI/2)).textPosAngle=ue,se.push(D)}};if(te||ie){for(de=4;de>=-4;de-=2)ce(Math.PI*de,"tan");for(de=4;de>=-4;de-=2)ce(Math.PI*(de+1),"tan")}if(te||ae){for(de=4;de>=-4;de-=2)ce(Math.PI*(de+1.5),"rad");for(de=4;de>=-4;de-=2)ce(Math.PI*(de+.5),"rad")}}if(q||he||te){var ve=Math.sqrt(Q.width*Q.width+Q.height*Q.height);if((D={scale:K*Y*2/ve,rCenter:1-K,rotate:0}).textPosAngle=(X.startangle+X.stopangle)/2,D.scale>=1)return D;se.push(D)}(he||ae)&&((D=T(Q,Y,B,ee,J)).textPosAngle=(X.startangle+X.stopangle)/2,se.push(D)),(he||ie)&&((D=A(Q,Y,B,ee,J)).textPosAngle=(X.startangle+X.stopangle)/2,se.push(D));for(var ke=0,Ee=0,be=0;be<se.length;be++){var xe=se[be].scale;if(Ee<xe&&(Ee=xe,ke=be),!he&&Ee>=1)break}return se[ke]}function T(Q,X,G,Y,K){X=Math.max(0,X-2*r);var D=Q.width/Q.height,B=L(D,Y,X,G);return{scale:2*B/Q.height,rCenter:S(D,B/X),rotate:w(K)}}function A(Q,X,G,Y,K){X=Math.max(0,X-2*r);var D=Q.height/Q.width,B=L(D,Y,X,G);return{scale:2*B/Q.width,rCenter:S(D,B/X),rotate:w(K+Math.PI/2)}}function S(Q,X){return Math.cos(X)-Q*X}function w(Q){return(180/Math.PI*Q+720)%180-90}function L(Q,X,G,Y){var K=Q+1/(2*Math.tan(X));return G*Math.min(1/(Math.sqrt(K*K+.5)+K),Y/(Math.sqrt(Q*Q+Y/2)+Q))}function k(Q,X){return Q.v!==X.vTotal||X.trace.hole?Math.min(1/(1+1/Math.sin(Q.halfangle)),Q.ring/2):1}function C(Q,X){var G=X.pxmid[0],Y=X.pxmid[1],K=Q.width/2,D=Q.height/2;return G<0&&(K*=-1),Y<0&&(D*=-1),{scale:1,rCenter:1,rotate:0,x:K+Math.abs(D)*(K>0?1:-1)/2,y:D/(1+G*G/(Y*Y)),outside:!0}}function M(Q,X){var G,Y,K,D=Q.trace,B={x:Q.cx,y:Q.cy},q={tx:0,ty:0};q.ty+=D.title.font.size,K=O(D),D.title.position.indexOf("top")!==-1?(B.y-=(1+K)*Q.r,q.ty-=Q.titleBox.height):D.title.position.indexOf("bottom")!==-1&&(B.y+=(1+K)*Q.r);var ee,J,$=(ee=Q.r,J=Q.trace.aspectratio,ee/(J===void 0?1:J)),te=X.w*(D.domain.x[1]-D.domain.x[0])/2;return D.title.position.indexOf("left")!==-1?(te+=$,B.x-=(1+K)*$,q.tx+=Q.titleBox.width/2):D.title.position.indexOf("center")!==-1?te*=2:D.title.position.indexOf("right")!==-1&&(te+=$,B.x+=(1+K)*$,q.tx-=Q.titleBox.width/2),G=te/Q.titleBox.width,Y=P(Q,X)/Q.titleBox.height,{x:B.x,y:B.y,scale:Math.min(G,Y),tx:q.tx,ty:q.ty}}function P(Q,X){var G=Q.trace,Y=X.h*(G.domain.y[1]-G.domain.y[0]);return Math.min(Q.titleBox.height,Y/2)}function O(Q){var X,G=Q.pull;if(!G)return 0;if(Array.isArray(G))for(G=0,X=0;X<Q.pull.length;X++)Q.pull[X]>G&&(G=Q.pull[X]);return G}function F(Q,X){for(var G=[],Y=0;Y<Q.length;Y++){var K=Q[Y][0],D=K.trace,B=D.domain,q=X.w*(B.x[1]-B.x[0]),ee=X.h*(B.y[1]-B.y[0]);D.title.text&&D.title.position!=="middle center"&&(ee-=P(K,X));var J=q/2,$=ee/2;D.type!=="funnelarea"||D.scalegroup||($/=D.aspectratio),K.r=Math.min(J,$)/(1+O(D)),K.cx=X.l+X.w*(D.domain.x[1]+D.domain.x[0])/2,K.cy=X.t+X.h*(1-D.domain.y[0])-ee/2,D.title.text&&D.title.position.indexOf("bottom")!==-1&&(K.cy-=P(K,X)),D.scalegroup&&G.indexOf(D.scalegroup)===-1&&G.push(D.scalegroup)}(function(te,ie){for(var ae,he,se,de=0;de<ie.length;de++){var ce=1/0,ve=ie[de];for(he=0;he<te.length;he++)if(ae=te[he][0],(se=ae.trace).scalegroup===ve){var ke;if(se.type==="pie")ke=ae.r*ae.r;else if(se.type==="funnelarea"){var Ee,be;se.aspectratio>1?(Ee=ae.r,be=Ee/se.aspectratio):(be=ae.r,Ee=be*se.aspectratio),Ee*=(1+se.baseratio)/2,ke=Ee*be}ce=Math.min(ce,ke/ae.vTotal)}for(he=0;he<te.length;he++)if(ae=te[he][0],(se=ae.trace).scalegroup===ve){var xe=ce*ae.vTotal;se.type==="funnelarea"&&(xe/=(1+se.baseratio)/2,xe/=se.aspectratio),ae.r=Math.sqrt(xe)}}})(Q,G)}function j(Q,X){return[Q*Math.sin(X),-Q*Math.cos(X)]}function W(Q,X,G){var Y=Q._fullLayout,K=G.trace,D=K.texttemplate,B=K.textinfo;if(!D&&B&&B!=="none"){var q,ee=B.split("+"),J=function(ke){return ee.indexOf(ke)!==-1},$=J("label"),te=J("text"),ie=J("value"),ae=J("percent"),he=Y.separators;if(q=$?[X.label]:[],te){var se=n.getFirstFilled(K.text,X.pts);l(se)&&q.push(se)}ie&&q.push(n.formatPieValue(X.v,he)),ae&&q.push(n.formatPiePercent(X.v/G.vTotal,he)),X.text=q.join("<br>")}if(D){var de=f.castOption(K,X.i,"texttemplate");if(de){var ce=function(ke){return{label:ke.label,value:ke.v,valueLabel:n.formatPieValue(ke.v,Y.separators),percent:ke.v/G.vTotal,percentLabel:n.formatPiePercent(ke.v/G.vTotal,Y.separators),color:ke.color,text:ke.text,customdata:f.castOption(K,ke.i,"customdata")}}(X),ve=n.getFirstFilled(K.text,X.pts);(l(ve)||ve==="")&&(ce.text=ve),X.text=f.texttemplateString(de,ce,Q._fullLayout._d3locale,ce,K._meta||{})}else X.text=""}}function Z(Q,X){var G=Q.rotate*Math.PI/180,Y=Math.cos(G),K=Math.sin(G),D=(X.left+X.right)/2,B=(X.top+X.bottom)/2;Q.textX=D*Y-B*K,Q.textY=D*K+B*Y,Q.noCenter=!0}N.exports={plot:function(Q,X){var G=Q._fullLayout,Y=G._size;c("pie",G),_(X,Q),F(X,Y);var K=f.makeTraceGroups(G._pielayer,X,"trace").each(function(D){var B=t.select(this),q=D[0],ee=q.trace;(function(J){var $,te,ie,ae=J[0],he=ae.r,se=ae.trace,de=n.getRotationAngle(se.rotation),ce=2*Math.PI/ae.vTotal,ve="px0",ke="px1";if(se.direction==="counterclockwise"){for($=0;$<J.length&&J[$].hidden;$++);if($===J.length)return;de+=ce*J[$].v,ce*=-1,ve="px1",ke="px0"}for(ie=j(he,de),$=0;$<J.length;$++)(te=J[$]).hidden||(te[ve]=ie,te.startangle=de,de+=ce*te.v/2,te.pxmid=j(he,de),te.midangle=de,de+=ce*te.v/2,ie=j(he,de),te.stopangle=de,te[ke]=ie,te.largeArc=te.v>ae.vTotal/2?1:0,te.halfangle=Math.PI*Math.min(te.v/ae.vTotal,.5),te.ring=1-se.hole,te.rInscribed=k(te,ae))})(D),B.attr("stroke-linejoin","round"),B.each(function(){var J=t.select(this).selectAll("g.slice").data(D);J.enter().append("g").classed("slice",!0),J.exit().remove();var $=[[[],[]],[[],[]]],te=!1;J.each(function(ke,Ee){if(ke.hidden)t.select(this).selectAll("path,g").remove();else{ke.pointNumber=ke.i,ke.curveNumber=ee.index,$[ke.pxmid[1]<0?0:1][ke.pxmid[0]<0?0:1].push(ke);var be=q.cx,xe=q.cy,ue=t.select(this),me=ue.selectAll("path.surface").data([ke]);if(me.enter().append("path").classed("surface",!0).style({"pointer-events":"all"}),ue.call(y,Q,D),ee.pull){var we=+n.castOption(ee.pull,ke.pts)||0;we>0&&(be+=we*ke.pxmid[0],xe+=we*ke.pxmid[1])}ke.cxFinal=be,ke.cyFinal=xe;var Me=ee.hole;if(ke.v===q.vTotal){var Se="M"+(be+ke.px0[0])+","+(xe+ke.px0[1])+Oe(ke.px0,ke.pxmid,!0,1)+Oe(ke.pxmid,ke.px0,!0,1)+"Z";Me?me.attr("d","M"+(be+Me*ke.px0[0])+","+(xe+Me*ke.px0[1])+Oe(ke.px0,ke.pxmid,!1,Me)+Oe(ke.pxmid,ke.px0,!1,Me)+"Z"+Se):me.attr("d",Se)}else{var De=Oe(ke.px0,ke.px1,!0,1);if(Me){var Fe=1-Me;me.attr("d","M"+(be+Me*ke.px1[0])+","+(xe+Me*ke.px1[1])+Oe(ke.px1,ke.px0,!1,Me)+"l"+Fe*ke.px0[0]+","+Fe*ke.px0[1]+De+"Z")}else me.attr("d","M"+be+","+xe+"l"+ke.px0[0]+","+ke.px0[1]+De+"Z")}W(Q,ke,q);var Ye=n.castOption(ee.textposition,ke.pts),et=ue.selectAll("g.slicetext").data(ke.text&&Ye!=="none"?[0]:[]);et.enter().append("g").classed("slicetext",!0),et.exit().remove(),et.each(function(){var je=f.ensureSingle(t.select(this),"text","",function(rt){rt.attr("data-notex",1)}),We=f.ensureUniformFontSize(Q,Ye==="outside"?function(rt,$e,xt){var Qt=n.castOption(rt.outsidetextfont.color,$e.pts)||n.castOption(rt.textfont.color,$e.pts)||xt.color,$t=n.castOption(rt.outsidetextfont.family,$e.pts)||n.castOption(rt.textfont.family,$e.pts)||xt.family,Ue=n.castOption(rt.outsidetextfont.size,$e.pts)||n.castOption(rt.textfont.size,$e.pts)||xt.size;return{color:Qt,family:$t,size:Ue}}(ee,ke,G.font):v(ee,ke,G.font));je.text(ke.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(e.font,We).call(s.convertToTspans,Q);var Ge,Qe=e.bBox(je.node());if(Ye==="outside")Ge=C(Qe,ke);else if(Ge=x(Qe,ke,q),Ye==="auto"&&Ge.scale<1){var it=f.ensureUniformFontSize(Q,ee.outsidetextfont);je.call(e.font,it),Ge=C(Qe=e.bBox(je.node()),ke)}var lt=Ge.textPosAngle,Lt=lt===void 0?ke.pxmid:j(q.r,lt);if(Ge.targetX=be+Lt[0]*Ge.rCenter+(Ge.x||0),Ge.targetY=xe+Lt[1]*Ge.rCenter+(Ge.y||0),Z(Ge,Qe),Ge.outside){var wt=Ge.targetY;ke.yLabelMin=wt-Qe.height/2,ke.yLabelMid=wt,ke.yLabelMax=wt+Qe.height/2,ke.labelExtraX=0,ke.labelExtraY=0,te=!0}Ge.fontSize=We.size,a(ee.type,Ge,G),D[Ee].transform=Ge,je.attr("transform",f.getTextTransform(Ge))})}function Oe(je,We,Ge,Qe){var it=Qe*(We[0]-je[0]),lt=Qe*(We[1]-je[1]);return"a"+Qe*q.r+","+Qe*q.r+" 0 "+ke.largeArc+(Ge?" 1 ":" 0 ")+it+","+lt}});var ie=t.select(this).selectAll("g.titletext").data(ee.title.text?[0]:[]);if(ie.enter().append("g").classed("titletext",!0),ie.exit().remove(),ie.each(function(){var ke,Ee=f.ensureSingle(t.select(this),"text","",function(xe){xe.attr("data-notex",1)}),be=ee.title.text;ee._meta&&(be=f.templateString(be,ee._meta)),Ee.text(be).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(e.font,ee.title.font).call(s.convertToTspans,Q),ke=ee.title.position==="middle center"?function(xe){var ue=Math.sqrt(xe.titleBox.width*xe.titleBox.width+xe.titleBox.height*xe.titleBox.height);return{x:xe.cx,y:xe.cy,scale:xe.trace.hole*xe.r*2/ue,tx:0,ty:-xe.titleBox.height/2+xe.trace.title.font.size}}(q):M(q,Y),Ee.attr("transform",i(ke.x,ke.y)+u(Math.min(1,ke.scale))+i(ke.tx,ke.ty))}),te&&function(ke,Ee){var be,xe,ue,me,we,Me,Se,De,Fe,Ye,et,Oe,je;function We(lt,Lt){return lt.pxmid[1]-Lt.pxmid[1]}function Ge(lt,Lt){return Lt.pxmid[1]-lt.pxmid[1]}function Qe(lt,Lt){Lt||(Lt={});var wt,rt,$e,xt,Qt=Lt.labelExtraY+(xe?Lt.yLabelMax:Lt.yLabelMin),$t=xe?lt.yLabelMin:lt.yLabelMax,Ue=xe?lt.yLabelMax:lt.yLabelMin,He=lt.cyFinal+we(lt.px0[1],lt.px1[1]),Be=Qt-$t;if(Be*Se>0&&(lt.labelExtraY=Be),Array.isArray(Ee.pull))for(rt=0;rt<Ye.length;rt++)($e=Ye[rt])===lt||(n.castOption(Ee.pull,lt.pts)||0)>=(n.castOption(Ee.pull,$e.pts)||0)||((lt.pxmid[1]-$e.pxmid[1])*Se>0?(Be=$e.cyFinal+we($e.px0[1],$e.px1[1])-$t-lt.labelExtraY)*Se>0&&(lt.labelExtraY+=Be):(Ue+lt.labelExtraY-He)*Se>0&&(wt=3*Me*Math.abs(rt-Ye.indexOf(lt)),(xt=$e.cxFinal+me($e.px0[0],$e.px1[0])+wt-(lt.cxFinal+lt.pxmid[0])-lt.labelExtraX)*Me>0&&(lt.labelExtraX+=xt)))}for(xe=0;xe<2;xe++)for(ue=xe?We:Ge,we=xe?Math.max:Math.min,Se=xe?1:-1,be=0;be<2;be++){for(me=be?Math.max:Math.min,Me=be?1:-1,(De=ke[xe][be]).sort(ue),Fe=ke[1-xe][be],Ye=Fe.concat(De),Oe=[],et=0;et<De.length;et++)De[et].yLabelMid!==void 0&&Oe.push(De[et]);for(je=!1,et=0;xe&&et<Fe.length;et++)if(Fe[et].yLabelMid!==void 0){je=Fe[et];break}for(et=0;et<Oe.length;et++){var it=et&&Oe[et-1];je&&!et&&(it=je),Qe(Oe[et],it)}}}($,ee),function(ke,Ee){ke.each(function(be){var xe=t.select(this);if(be.labelExtraX||be.labelExtraY){var ue=xe.select("g.slicetext text");be.transform.targetX+=be.labelExtraX,be.transform.targetY+=be.labelExtraY,ue.attr("transform",f.getTextTransform(be.transform));var me=be.cxFinal+be.pxmid[0],we="M"+me+","+(be.cyFinal+be.pxmid[1]),Me=(be.yLabelMax-be.yLabelMin)*(be.pxmid[0]<0?-1:1)/4;if(be.labelExtraX){var Se=be.labelExtraX*be.pxmid[1]/be.pxmid[0],De=be.yLabelMid+be.labelExtraY-(be.cyFinal+be.pxmid[1]);Math.abs(Se)>Math.abs(De)?we+="l"+De*be.pxmid[0]/be.pxmid[1]+","+De+"H"+(me+be.labelExtraX+Me):we+="l"+be.labelExtraX+","+Se+"v"+(De-Se)+"h"+Me}else we+="V"+(be.yLabelMid+be.labelExtraY)+"h"+Me;f.ensureSingle(xe,"path","textline").call(p.stroke,Ee.outsidetextfont.color).attr({"stroke-width":Math.min(2,Ee.outsidetextfont.size/8),d:we,fill:"none"})}else xe.select("path.textline").remove()})}(J,ee),te&&ee.automargin){var ae=e.bBox(B.node()),he=ee.domain,se=Y.w*(he.x[1]-he.x[0]),de=Y.h*(he.y[1]-he.y[0]),ce=(.5*se-q.r)/Y.w,ve=(.5*de-q.r)/Y.h;m.autoMargin(Q,"pie."+ee.uid+".automargin",{xl:he.x[0]-ce,xr:he.x[1]+ce,yb:he.y[0]-ve,yt:he.y[1]+ve,l:Math.max(q.cx-q.r-ae.left,0),r:Math.max(ae.right-(q.cx+q.r),0),b:Math.max(ae.bottom-(q.cy+q.r),0),t:Math.max(q.cy-q.r-ae.top,0),pad:5})}})});setTimeout(function(){K.selectAll("tspan").each(function(){var D=t.select(this);D.attr("dy")&&D.attr("dy",D.attr("dy"))})},0)},formatSliceLabel:W,transformInsideText:x,determineInsideTextFont:v,positionTitleOutside:M,prerenderTitles:_,layoutAreas:F,attachFxHandlers:y,computeTransform:Z}},{"../../components/color":650,"../../components/drawing":672,"../../components/fx":690,"../../lib":787,"../../lib/svg_text_utils":813,"../../plots/plots":901,"../bar/constants":927,"../bar/uniform_text":941,"./event_data":1180,"./helpers":1181,"@plotly/d3":58}],1186:[function(h,N,H){var t=h("@plotly/d3"),m=h("./style_one"),g=h("../bar/uniform_text").resizeText;N.exports=function(p){var e=p._fullLayout._pielayer.selectAll(".trace");g(p,e,"pie"),e.each(function(f){var u=f[0].trace,i=t.select(this);i.style({opacity:u.opacity}),i.selectAll("path.surface").each(function(s){t.select(this).call(m,s,u)})})}},{"../bar/uniform_text":941,"./style_one":1187,"@plotly/d3":58}],1187:[function(h,N,H){var t=h("../../components/color"),m=h("./helpers").castOption;N.exports=function(g,p,e){var f=e.marker.line,u=m(f.color,p.pts)||t.defaultLine,i=m(f.width,p.pts)||0;g.style("stroke-width",i).call(t.fill,p.color).call(t.stroke,u)}},{"../../components/color":650,"./helpers":1181}],1188:[function(h,N,H){var t=h("../scatter/attributes");N.exports={x:t.x,y:t.y,xy:{valType:"data_array",editType:"calc"},indices:{valType:"data_array",editType:"calc"},xbounds:{valType:"data_array",editType:"calc"},ybounds:{valType:"data_array",editType:"calc"},text:t.text,marker:{color:{valType:"color",arrayOk:!1,editType:"calc"},opacity:{valType:"number",min:0,max:1,dflt:1,arrayOk:!1,editType:"calc"},blend:{valType:"boolean",dflt:null,editType:"calc"},sizemin:{valType:"number",min:.1,max:2,dflt:.5,editType:"calc"},sizemax:{valType:"number",min:.1,dflt:20,editType:"calc"},border:{color:{valType:"color",arrayOk:!1,editType:"calc"},arearatio:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},editType:"calc"},editType:"calc"},transforms:void 0}},{"../scatter/attributes":1202}],1189:[function(h,N,H){var t=h("gl-pointcloud2d"),m=h("../../lib/str2rgbarray"),g=h("../../plots/cartesian/autorange").findExtremes,p=h("../scatter/get_trace_color");function e(u,i){this.scene=u,this.uid=i,this.type="pointcloud",this.pickXData=[],this.pickYData=[],this.xData=[],this.yData=[],this.textLabels=[],this.color="rgb(0, 0, 0)",this.name="",this.hoverinfo="all",this.idToIndex=new Int32Array(0),this.bounds=[0,0,0,0],this.pointcloudOptions={positions:new Float32Array(0),idToIndex:this.idToIndex,sizemin:.5,sizemax:12,color:[0,0,0,1],areaRatio:1,borderColor:[0,0,0,1]},this.pointcloud=t(u.glplot,this.pointcloudOptions),this.pointcloud._trace=this}var f=e.prototype;f.handlePick=function(u){var i=this.idToIndex[u.pointId];return{trace:this,dataCoord:u.dataCoord,traceCoord:this.pickXYData?[this.pickXYData[2*i],this.pickXYData[2*i+1]]:[this.pickXData[i],this.pickYData[i]],textLabel:Array.isArray(this.textLabels)?this.textLabels[i]:this.textLabels,color:this.color,name:this.name,pointIndex:i,hoverinfo:this.hoverinfo}},f.update=function(u){this.index=u.index,this.textLabels=u.text,this.name=u.name,this.hoverinfo=u.hoverinfo,this.bounds=[1/0,1/0,-1/0,-1/0],this.updateFast(u),this.color=p(u,{})},f.updateFast=function(u){var i,s,o,a,c,r,n=this.xData=this.pickXData=u.x,d=this.yData=this.pickYData=u.y,l=this.pickXYData=u.xy,y=u.xbounds&&u.ybounds,v=u.indices,_=this.bounds;if(l){if(o=l,i=l.length>>>1,y)_[0]=u.xbounds[0],_[2]=u.xbounds[1],_[1]=u.ybounds[0],_[3]=u.ybounds[1];else for(r=0;r<i;r++)a=o[2*r],c=o[2*r+1],a<_[0]&&(_[0]=a),a>_[2]&&(_[2]=a),c<_[1]&&(_[1]=c),c>_[3]&&(_[3]=c);if(v)s=v;else for(s=new Int32Array(i),r=0;r<i;r++)s[r]=r}else for(i=n.length,o=new Float32Array(2*i),s=new Int32Array(i),r=0;r<i;r++)a=n[r],c=d[r],s[r]=r,o[2*r]=a,o[2*r+1]=c,a<_[0]&&(_[0]=a),a>_[2]&&(_[2]=a),c<_[1]&&(_[1]=c),c>_[3]&&(_[3]=c);this.idToIndex=s,this.pointcloudOptions.idToIndex=s,this.pointcloudOptions.positions=o;var x=m(u.marker.color),T=m(u.marker.border.color),A=u.opacity*u.marker.opacity;x[3]*=A,this.pointcloudOptions.color=x;var S=u.marker.blend;S===null&&(S=n.length<100||d.length<100),this.pointcloudOptions.blend=S,T[3]*=A,this.pointcloudOptions.borderColor=T;var w=u.marker.sizemin,L=Math.max(u.marker.sizemax,u.marker.sizemin);this.pointcloudOptions.sizeMin=w,this.pointcloudOptions.sizeMax=L,this.pointcloudOptions.areaRatio=u.marker.border.arearatio,this.pointcloud.update(this.pointcloudOptions);var k=this.scene.xaxis,C=this.scene.yaxis,M=L/2||.5;u._extremes[k._id]=g(k,[_[0],_[2]],{ppad:M}),u._extremes[C._id]=g(C,[_[1],_[3]],{ppad:M})},f.dispose=function(){this.pointcloud.dispose()},N.exports=function(u,i){var s=new e(u,i.uid);return s.update(i),s}},{"../../lib/str2rgbarray":812,"../../plots/cartesian/autorange":837,"../scatter/get_trace_color":1212,"gl-pointcloud2d":321}],1190:[function(h,N,H){var t=h("../../lib"),m=h("./attributes");N.exports=function(g,p,e){function f(u,i){return t.coerce(g,p,m,u,i)}f("x"),f("y"),f("xbounds"),f("ybounds"),g.xy&&g.xy instanceof Float32Array&&(p.xy=g.xy),g.indices&&g.indices instanceof Int32Array&&(p.indices=g.indices),f("text"),f("marker.color",e),f("marker.opacity"),f("marker.blend"),f("marker.sizemin"),f("marker.sizemax"),f("marker.border.color",e),f("marker.border.arearatio"),p._length=null}},{"../../lib":787,"./attributes":1188}],1191:[function(h,N,H){N.exports={attributes:h("./attributes"),supplyDefaults:h("./defaults"),calc:h("../scatter3d/calc"),plot:h("./convert"),moduleType:"trace",name:"pointcloud",basePlotModule:h("../../plots/gl2d"),categories:["gl","gl2d","showLegend"],meta:{}}},{"../../plots/gl2d":878,"../scatter3d/calc":1231,"./attributes":1188,"./convert":1189,"./defaults":1190}],1192:[function(h,N,H){var t=h("../../plots/font_attributes"),m=h("../../plots/attributes"),g=h("../../components/color/attributes"),p=h("../../components/fx/attributes"),e=h("../../plots/domain").attributes,f=h("../../plots/template_attributes").hovertemplateAttrs,u=h("../../components/colorscale/attributes"),i=h("../../plot_api/plot_template").templatedArray,s=h("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,o=h("../../lib/extend").extendFlat,a=h("../../plot_api/edit_types").overrideAll;(N.exports=a({hoverinfo:o({},m.hoverinfo,{flags:[],arrayOk:!1}),hoverlabel:p.hoverlabel,domain:e({name:"sankey",trace:!0}),orientation:{valType:"enumerated",values:["v","h"],dflt:"h"},valueformat:{valType:"string",dflt:".3s",description:s("value")},valuesuffix:{valType:"string",dflt:""},arrangement:{valType:"enumerated",values:["snap","perpendicular","freeform","fixed"],dflt:"snap"},textfont:t({}),customdata:void 0,node:{label:{valType:"data_array",dflt:[]},groups:{valType:"info_array",impliedEdits:{x:[],y:[]},dimensions:2,freeLength:!0,dflt:[],items:{valType:"number",editType:"calc"}},x:{valType:"data_array",dflt:[]},y:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:g.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:.5,arrayOk:!0}},pad:{valType:"number",arrayOk:!1,min:0,dflt:20},thickness:{valType:"number",arrayOk:!1,min:1,dflt:20},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:p.hoverlabel,hovertemplate:f({},{keys:["value","label"]})},link:{label:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:g.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:0,arrayOk:!0}},source:{valType:"data_array",dflt:[]},target:{valType:"data_array",dflt:[]},value:{valType:"data_array",dflt:[]},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:p.hoverlabel,hovertemplate:f({},{keys:["value","label"]}),colorscales:i("concentrationscales",{editType:"calc",label:{valType:"string",editType:"calc",dflt:""},cmax:{valType:"number",editType:"calc",dflt:1},cmin:{valType:"number",editType:"calc",dflt:0},colorscale:o(u().colorscale,{dflt:[[0,"white"],[1,"black"]]})})}},"calc","nested")).transforms=void 0},{"../../components/color/attributes":649,"../../components/colorscale/attributes":657,"../../components/fx/attributes":681,"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plot_api/plot_template":827,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/domain":866,"../../plots/font_attributes":867,"../../plots/template_attributes":910}],1193:[function(h,N,H){var t=h("../../plot_api/edit_types").overrideAll,m=h("../../plots/get_data").getModuleCalcData,g=h("./plot"),p=h("../../components/fx/layout_attributes"),e=h("../../lib/setcursor"),f=h("../../components/dragelement"),u=h("../../plots/cartesian/select").prepSelect,i=h("../../lib"),s=h("../../registry");function o(a,c){var r=a._fullData[c],n=a._fullLayout,d=n.dragmode,l=n.dragmode==="pan"?"move":"crosshair",y=r._bgRect;if(d!=="pan"&&d!=="zoom"){e(y,l);var v={_id:"x",c2p:i.identity,_offset:r._sankey.translateX,_length:r._sankey.width},_={_id:"y",c2p:i.identity,_offset:r._sankey.translateY,_length:r._sankey.height},x={gd:a,element:y.node(),plotinfo:{id:c,xaxis:v,yaxis:_,fillRangeItems:i.noop},subplot:c,xaxes:[v],yaxes:[_],doneFnCompleted:function(T){var A,S=a._fullData[c],w=S.node.groups.slice(),L=[];function k(O){for(var F=S._sankey.graph.nodes,j=0;j<F.length;j++)if(F[j].pointNumber===O)return F[j]}for(var C=0;C<T.length;C++){var M=k(T[C].pointNumber);if(M)if(M.group){for(var P=0;P<M.childrenNodes.length;P++)L.push(M.childrenNodes[P].pointNumber);w[M.pointNumber-S.node._count]=!1}else L.push(M.pointNumber)}A=w.filter(Boolean).concat([L]),s.call("_guiRestyle",a,{"node.groups":[A]},c)},prepFn:function(T,A,S){u(T,A,S,x,d)}};f.init(x)}}H.name="sankey",H.baseLayoutAttrOverrides=t({hoverlabel:p.hoverlabel},"plot","nested"),H.plot=function(a){var c=m(a.calcdata,"sankey")[0];g(a,c),H.updateFx(a)},H.clean=function(a,c,r,n){var d=n._has&&n._has("sankey"),l=c._has&&c._has("sankey");d&&!l&&(n._paperdiv.selectAll(".sankey").remove(),n._paperdiv.selectAll(".bgsankey").remove())},H.updateFx=function(a){for(var c=0;c<a._fullData.length;c++)o(a,c)}},{"../../components/dragelement":669,"../../components/fx/layout_attributes":691,"../../lib":787,"../../lib/setcursor":808,"../../plot_api/edit_types":820,"../../plots/cartesian/select":858,"../../plots/get_data":875,"../../registry":915,"./plot":1198}],1194:[function(h,N,H){var t=h("strongly-connected-components"),m=h("../../lib"),g=h("../../lib/gup").wrap,p=m.isArrayOrTypedArray,e=m.isIndex,f=h("../../components/colorscale");function u(i){var s,o=i.node,a=i.link,c=[],r=p(a.color),n=p(a.customdata),d={},l={},y=a.colorscales.length;for(s=0;s<y;s++){var v=a.colorscales[s],_=f.extractScale(v,{cLetter:"c"}),x=f.makeColorScaleFunc(_);l[v.label]=x}var T=0;for(s=0;s<a.value.length;s++)a.source[s]>T&&(T=a.source[s]),a.target[s]>T&&(T=a.target[s]);var A,S=T+1;i.node._count=S;var w=i.node.groups,L={};for(s=0;s<w.length;s++){var k=w[s];for(A=0;A<k.length;A++){var C=k[A],M=S+s;L.hasOwnProperty(C)?m.warn("Node "+C+" is already part of a group."):L[C]=M}}var P={source:[],target:[]};for(s=0;s<a.value.length;s++){var O=a.value[s],F=a.source[s],j=a.target[s];if(O>0&&e(F,S)&&e(j,S)&&(!L.hasOwnProperty(F)||!L.hasOwnProperty(j)||L[F]!==L[j])){L.hasOwnProperty(j)&&(j=L[j]),L.hasOwnProperty(F)&&(F=L[F]),j=+j,d[F=+F]=d[j]=!0;var W="";a.label&&a.label[s]&&(W=a.label[s]);var Z=null;W&&l.hasOwnProperty(W)&&(Z=l[W]),c.push({pointNumber:s,label:W,color:r?a.color[s]:a.color,customdata:n?a.customdata[s]:a.customdata,concentrationscale:Z,source:F,target:j,value:+O}),P.source.push(F),P.target.push(j)}}var Q=S+w.length,X=p(o.color),G=p(o.customdata),Y=[];for(s=0;s<Q;s++)if(d[s]){var K=o.label[s];Y.push({group:s>S-1,childrenNodes:[],pointNumber:s,label:K,color:X?o.color[s]:o.color,customdata:G?o.customdata[s]:o.customdata})}var D=!1;return function(B,q,ee){for(var J=m.init2dArray(B,0),$=0;$<Math.min(q.length,ee.length);$++)if(m.isIndex(q[$],B)&&m.isIndex(ee[$],B)){if(q[$]===ee[$])return!0;J[q[$]].push(ee[$])}return t(J).components.some(function(te){return te.length>1})}(Q,P.source,P.target)&&(D=!0),{circular:D,links:c,nodes:Y,groups:w,groupLookup:L}}N.exports=function(i,s){var o=u(s);return g({circular:o.circular,_nodes:o.nodes,_links:o.links,_groups:o.groups,_groupLookup:o.groupLookup})}},{"../../components/colorscale":662,"../../lib":787,"../../lib/gup":784,"strongly-connected-components":575}],1195:[function(h,N,H){N.exports={nodeTextOffsetHorizontal:4,nodeTextOffsetVertical:3,nodePadAcross:10,sankeyIterations:50,forceIterations:5,forceTicksPerFrame:10,duration:500,ease:"linear",cn:{sankey:"sankey",sankeyLinks:"sankey-links",sankeyLink:"sankey-link",sankeyNodeSet:"sankey-node-set",sankeyNode:"sankey-node",nodeRect:"node-rect",nodeLabel:"node-label"}}},{}],1196:[function(h,N,H){var t=h("../../lib"),m=h("./attributes"),g=h("../../components/color"),p=h("tinycolor2"),e=h("../../plots/domain").defaults,f=h("../../components/fx/hoverlabel_defaults"),u=h("../../plot_api/plot_template"),i=h("../../plots/array_container_defaults");function s(o,a){function c(r,n){return t.coerce(o,a,m.link.colorscales,r,n)}c("label"),c("cmin"),c("cmax"),c("colorscale")}N.exports=function(o,a,c,r){function n(L,k){return t.coerce(o,a,m,L,k)}var d=t.extendDeep(r.hoverlabel,o.hoverlabel),l=o.node,y=u.newContainer(a,"node");function v(L,k){return t.coerce(l,y,m.node,L,k)}v("label"),v("groups"),v("x"),v("y"),v("pad"),v("thickness"),v("line.color"),v("line.width"),v("hoverinfo",o.hoverinfo),f(l,y,v,d),v("hovertemplate");var _=r.colorway;v("color",y.label.map(function(L,k){return g.addOpacity(function(C){return _[C%_.length]}(k),.8)})),v("customdata");var x=o.link||{},T=u.newContainer(a,"link");function A(L,k){return t.coerce(x,T,m.link,L,k)}A("label"),A("source"),A("target"),A("value"),A("line.color"),A("line.width"),A("hoverinfo",o.hoverinfo),f(x,T,A,d),A("hovertemplate");var S,w=p(r.paper_bgcolor).getLuminance()<.333?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.2)";A("color",t.repeat(w,T.value.length)),A("customdata"),i(x,T,{name:"colorscales",handleItemDefaults:s}),e(a,r,n),n("orientation"),n("valueformat"),n("valuesuffix"),y.x.length&&y.y.length&&(S="freeform"),n("arrangement",S),t.coerceFont(n,"textfont",t.extendFlat({},r.font)),a._length=null}},{"../../components/color":650,"../../components/fx/hoverlabel_defaults":688,"../../lib":787,"../../plot_api/plot_template":827,"../../plots/array_container_defaults":833,"../../plots/domain":866,"./attributes":1192,tinycolor2:583}],1197:[function(h,N,H){N.exports={attributes:h("./attributes"),supplyDefaults:h("./defaults"),calc:h("./calc"),plot:h("./plot"),moduleType:"trace",name:"sankey",basePlotModule:h("./base_plot"),selectPoints:h("./select.js"),categories:["noOpacity"],meta:{}}},{"./attributes":1192,"./base_plot":1193,"./calc":1194,"./defaults":1196,"./plot":1198,"./select.js":1200}],1198:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../lib"),g=m.numberFormat,p=h("./render"),e=h("../../components/fx"),f=h("../../components/color"),u=h("./constants").cn,i=m._;function s(x){return x!==""}function o(x,T){return x.filter(function(A){return A.key===T.traceId})}function a(x,T){t.select(x).select("path").style("fill-opacity",T),t.select(x).select("rect").style("fill-opacity",T)}function c(x){t.select(x).select("text.name").style("fill","black")}function r(x){return function(T){return x.node.sourceLinks.indexOf(T.link)!==-1||x.node.targetLinks.indexOf(T.link)!==-1}}function n(x){return function(T){return T.node.sourceLinks.indexOf(x.link)!==-1||T.node.targetLinks.indexOf(x.link)!==-1}}function d(x,T,A){T&&A&&o(A,T).selectAll("."+u.sankeyLink).filter(r(T)).call(y.bind(0,T,A,!1))}function l(x,T,A){T&&A&&o(A,T).selectAll("."+u.sankeyLink).filter(r(T)).call(v.bind(0,T,A,!1))}function y(x,T,A,S){var w=S.datum().link.label;S.style("fill-opacity",function(L){if(!L.link.concentrationscale)return .4}),w&&o(T,x).selectAll("."+u.sankeyLink).filter(function(L){return L.link.label===w}).style("fill-opacity",function(L){if(!L.link.concentrationscale)return .4}),A&&o(T,x).selectAll("."+u.sankeyNode).filter(n(x)).call(d)}function v(x,T,A,S){var w=S.datum().link.label;S.style("fill-opacity",function(L){return L.tinyColorAlpha}),w&&o(T,x).selectAll("."+u.sankeyLink).filter(function(L){return L.link.label===w}).style("fill-opacity",function(L){return L.tinyColorAlpha}),A&&o(T,x).selectAll(u.sankeyNode).filter(n(x)).call(l)}function _(x,T){var A=x.hoverlabel||{},S=m.nestedProperty(A,T).get();return!Array.isArray(S)&&S}N.exports=function(x,T){for(var A=x._fullLayout,S=A._paper,w=A._size,L=0;L<x._fullData.length;L++)if(x._fullData[L].visible&&x._fullData[L].type===u.sankey&&!x._fullData[L]._viewInitial){var k=x._fullData[L].node;x._fullData[L]._viewInitial={node:{groups:k.groups.slice(),x:k.x.slice(),y:k.y.slice()}}}var C=i(x,"source:")+" ",M=i(x,"target:")+" ",P=i(x,"concentration:")+" ",O=i(x,"incoming flow count:")+" ",F=i(x,"outgoing flow count:")+" ";p(x,S,T,{width:w.w,height:w.h,margin:{t:w.t,r:w.r,b:w.b,l:w.l}},{linkEvents:{hover:function(j,W,Z){x._fullLayout.hovermode!==!1&&(t.select(j).call(y.bind(0,W,Z,!0)),W.link.trace.link.hoverinfo!=="skip"&&(W.link.fullData=W.link.trace,x.emit("plotly_hover",{event:t.event,points:[W.link]})))},follow:function(j,W){if(x._fullLayout.hovermode!==!1){var Z=W.link.trace.link;if(Z.hoverinfo!=="none"&&Z.hoverinfo!=="skip"){for(var Q=[],X=0,G=0;G<W.flow.links.length;G++){var Y=W.flow.links[G];if(x._fullLayout.hovermode!=="closest"||W.link.pointNumber===Y.pointNumber){W.link.pointNumber===Y.pointNumber&&(X=G),Y.fullData=Y.trace,Z=W.link.trace.link;var K=B(Y),D={valueLabel:g(W.valueFormat)(Y.value)+W.valueSuffix};Q.push({x:K[0],y:K[1],name:D.valueLabel,text:[Y.label||"",C+Y.source.label,M+Y.target.label,Y.concentrationscale?P+g("%0.2f")(Y.flow.labelConcentration):""].filter(s).join("<br>"),color:_(Z,"bgcolor")||f.addOpacity(Y.color,1),borderColor:_(Z,"bordercolor"),fontFamily:_(Z,"font.family"),fontSize:_(Z,"font.size"),fontColor:_(Z,"font.color"),nameLength:_(Z,"namelength"),textAlign:_(Z,"align"),idealAlign:t.event.x<K[0]?"right":"left",hovertemplate:Z.hovertemplate,hovertemplateLabels:D,eventData:[Y]})}}e.loneHover(Q,{container:A._hoverlayer.node(),outerContainer:A._paper.node(),gd:x,anchorIndex:X}).each(function(){W.link.concentrationscale||a(this,.65),c(this)})}}function B(q){var ee,J;q.circular?(ee=(q.circularPathData.leftInnerExtent+q.circularPathData.rightInnerExtent)/2,J=q.circularPathData.verticalFullExtent):(ee=(q.source.x1+q.target.x0)/2,J=(q.y0+q.y1)/2);var $=[ee,J];return q.trace.orientation==="v"&&$.reverse(),$[0]+=W.parent.translateX,$[1]+=W.parent.translateY,$}},unhover:function(j,W,Z){x._fullLayout.hovermode!==!1&&(t.select(j).call(v.bind(0,W,Z,!0)),W.link.trace.link.hoverinfo!=="skip"&&(W.link.fullData=W.link.trace,x.emit("plotly_unhover",{event:t.event,points:[W.link]})),e.loneUnhover(A._hoverlayer.node()))},select:function(j,W){var Z=W.link;Z.originalEvent=t.event,x._hoverdata=[Z],e.click(x,{target:!0})}},nodeEvents:{hover:function(j,W,Z){x._fullLayout.hovermode!==!1&&(t.select(j).call(d,W,Z),W.node.trace.node.hoverinfo!=="skip"&&(W.node.fullData=W.node.trace,x.emit("plotly_hover",{event:t.event,points:[W.node]})))},follow:function(j,W){if(x._fullLayout.hovermode!==!1){var Z=W.node.trace.node;if(Z.hoverinfo!=="none"&&Z.hoverinfo!=="skip"){var Q=t.select(j).select("."+u.nodeRect),X=x._fullLayout._paperdiv.node().getBoundingClientRect(),G=Q.node().getBoundingClientRect(),Y=G.left-2-X.left,K=G.right+2-X.left,D=G.top+G.height/4-X.top,B={valueLabel:g(W.valueFormat)(W.node.value)+W.valueSuffix};W.node.fullData=W.node.trace,x._fullLayout._calcInverseTransform(x);var q=x._fullLayout._invScaleX,ee=x._fullLayout._invScaleY,J=e.loneHover({x0:q*Y,x1:q*K,y:ee*D,name:g(W.valueFormat)(W.node.value)+W.valueSuffix,text:[W.node.label,O+W.node.targetLinks.length,F+W.node.sourceLinks.length].filter(s).join("<br>"),color:_(Z,"bgcolor")||W.tinyColorHue,borderColor:_(Z,"bordercolor"),fontFamily:_(Z,"font.family"),fontSize:_(Z,"font.size"),fontColor:_(Z,"font.color"),nameLength:_(Z,"namelength"),textAlign:_(Z,"align"),idealAlign:"left",hovertemplate:Z.hovertemplate,hovertemplateLabels:B,eventData:[W.node]},{container:A._hoverlayer.node(),outerContainer:A._paper.node(),gd:x});a(J,.85),c(J)}}},unhover:function(j,W,Z){x._fullLayout.hovermode!==!1&&(t.select(j).call(l,W,Z),W.node.trace.node.hoverinfo!=="skip"&&(W.node.fullData=W.node.trace,x.emit("plotly_unhover",{event:t.event,points:[W.node]})),e.loneUnhover(A._hoverlayer.node()))},select:function(j,W,Z){var Q=W.node;Q.originalEvent=t.event,x._hoverdata=[Q],t.select(j).call(l,W,Z),e.click(x,{target:!0})}}})}},{"../../components/color":650,"../../components/fx":690,"../../lib":787,"./constants":1195,"./render":1199,"@plotly/d3":58}],1199:[function(h,N,H){var t=h("d3-force"),m=h("d3-interpolate").interpolateNumber,g=h("@plotly/d3"),p=h("@plotly/d3-sankey"),e=h("@plotly/d3-sankey-circular"),f=h("./constants"),u=h("tinycolor2"),i=h("../../components/color"),s=h("../../components/drawing"),o=h("../../lib"),a=o.strTranslate,c=o.strRotate,r=h("../../lib/gup"),n=r.keyFun,d=r.repeat,l=r.unwrap,y=h("../../lib/svg_text_utils"),v=h("../../registry"),_=h("../../constants/alignment"),x=_.CAP_SHIFT,T=_.LINE_SPACING;function A(G,Y,K){var D,B=l(Y),q=B.trace,ee=q.domain,J=q.orientation==="h",$=q.node.pad,te=q.node.thickness,ie=G.width*(ee.x[1]-ee.x[0]),ae=G.height*(ee.y[1]-ee.y[0]),he=B._nodes,se=B._links,de=B.circular;(D=de?e.sankeyCircular().circularLinkGap(0):p.sankey()).iterations(f.sankeyIterations).size(J?[ie,ae]:[ae,ie]).nodeWidth(te).nodePadding($).nodeId(function(Se){return Se.pointNumber}).nodes(he).links(se);var ce,ve,ke,Ee=D();for(var be in D.nodePadding()<$&&o.warn("node.pad was reduced to ",D.nodePadding()," to fit within the figure."),B._groupLookup){var xe,ue=parseInt(B._groupLookup[be]);for(ce=0;ce<Ee.nodes.length;ce++)if(Ee.nodes[ce].pointNumber===ue){xe=Ee.nodes[ce];break}if(xe){var me={pointNumber:parseInt(be),x0:xe.x0,x1:xe.x1,y0:xe.y0,y1:xe.y1,partOfGroup:!0,sourceLinks:[],targetLinks:[]};Ee.nodes.unshift(me),xe.childrenNodes.unshift(me)}}if(function(){for(ce=0;ce<Ee.nodes.length;ce++){var Se,De,Fe=Ee.nodes[ce],Ye={};for(ve=0;ve<Fe.targetLinks.length;ve++)Se=(De=Fe.targetLinks[ve]).source.pointNumber+":"+De.target.pointNumber,Ye.hasOwnProperty(Se)||(Ye[Se]=[]),Ye[Se].push(De);var et=Object.keys(Ye);for(ve=0;ve<et.length;ve++){var Oe=Ye[Se=et[ve]],je=0,We={};for(ke=0;ke<Oe.length;ke++)We[(De=Oe[ke]).label]||(We[De.label]=0),We[De.label]+=De.value,je+=De.value;for(ke=0;ke<Oe.length;ke++)(De=Oe[ke]).flow={value:je,labelConcentration:We[De.label]/je,concentration:De.value/je,links:Oe},De.concentrationscale&&(De.color=u(De.concentrationscale(De.flow.labelConcentration)))}var Ge=0;for(ve=0;ve<Fe.sourceLinks.length;ve++)Ge+=Fe.sourceLinks[ve].value;for(ve=0;ve<Fe.sourceLinks.length;ve++)(De=Fe.sourceLinks[ve]).concentrationOut=De.value/Ge;var Qe=0;for(ve=0;ve<Fe.targetLinks.length;ve++)Qe+=Fe.targetLinks[ve].value;for(ve=0;ve<Fe.targetLinks.length;ve++)(De=Fe.targetLinks[ve]).concenrationIn=De.value/Qe}}(),q.node.x.length&&q.node.y.length){for(ce=0;ce<Math.min(q.node.x.length,q.node.y.length,Ee.nodes.length);ce++)if(q.node.x[ce]&&q.node.y[ce]){var we=[q.node.x[ce]*ie,q.node.y[ce]*ae];Ee.nodes[ce].x0=we[0]-te/2,Ee.nodes[ce].x1=we[0]+te/2;var Me=Ee.nodes[ce].y1-Ee.nodes[ce].y0;Ee.nodes[ce].y0=we[1]-Me/2,Ee.nodes[ce].y1=we[1]+Me/2}q.arrangement==="snap"&&function(Se){Se.forEach(function(De){var Fe,Ye,et,Oe=0,je=De.length;for(De.sort(function(We,Ge){return We.y0-Ge.y0}),et=0;et<je;++et)(Fe=De[et]).y0>=Oe||(Ye=Oe-Fe.y0)>1e-6&&(Fe.y0+=Ye,Fe.y1+=Ye),Oe=Fe.y1+$})}(function(Se){var De,Fe,Ye=Se.map(function(Ge,Qe){return{x0:Ge.x0,index:Qe}}).sort(function(Ge,Qe){return Ge.x0-Qe.x0}),et=[],Oe=-1,je=-1/0;for(ce=0;ce<Ye.length;ce++){var We=Se[Ye[ce].index];We.x0>je+te&&(Oe+=1,De=We.x0),je=We.x0,et[Oe]||(et[Oe]=[]),et[Oe].push(We),Fe=De-We.x0,We.x0+=Fe,We.x1+=Fe}return et}(he=Ee.nodes)),D.update(Ee)}return{circular:de,key:K,trace:q,guid:o.randstr(),horizontal:J,width:ie,height:ae,nodePad:q.node.pad,nodeLineColor:q.node.line.color,nodeLineWidth:q.node.line.width,linkLineColor:q.link.line.color,linkLineWidth:q.link.line.width,valueFormat:q.valueformat,valueSuffix:q.valuesuffix,textFont:q.textfont,translateX:ee.x[0]*G.width+G.margin.l,translateY:G.height-ee.y[1]*G.height+G.margin.t,dragParallel:J?ae:ie,dragPerpendicular:J?ie:ae,arrangement:q.arrangement,sankey:D,graph:Ee,forceLayouts:{},interactionState:{dragInProgress:!1,hovered:!1}}}function S(G,Y,K){var D=u(Y.color),B=Y.source.label+"|"+Y.target.label+"__"+K;return Y.trace=G.trace,Y.curveNumber=G.trace.index,{circular:G.circular,key:B,traceId:G.key,pointNumber:Y.pointNumber,link:Y,tinyColorHue:i.tinyRGB(D),tinyColorAlpha:D.getAlpha(),linkPath:w,linkLineColor:G.linkLineColor,linkLineWidth:G.linkLineWidth,valueFormat:G.valueFormat,valueSuffix:G.valueSuffix,sankey:G.sankey,parent:G,interactionState:G.interactionState,flow:Y.flow}}function w(){return function(G){if(G.link.circular)return Y=G.link,K=Y.width/2,D=Y.circularPathData,Y.circularLinkType==="top"?"M "+D.targetX+" "+(D.targetY+K)+" L"+D.rightInnerExtent+" "+(D.targetY+K)+"A"+(D.rightLargeArcRadius+K)+" "+(D.rightSmallArcRadius+K)+" 0 0 1 "+(D.rightFullExtent-K)+" "+(D.targetY-D.rightSmallArcRadius)+"L"+(D.rightFullExtent-K)+" "+D.verticalRightInnerExtent+"A"+(D.rightLargeArcRadius+K)+" "+(D.rightLargeArcRadius+K)+" 0 0 1 "+D.rightInnerExtent+" "+(D.verticalFullExtent-K)+"L"+D.leftInnerExtent+" "+(D.verticalFullExtent-K)+"A"+(D.leftLargeArcRadius+K)+" "+(D.leftLargeArcRadius+K)+" 0 0 1 "+(D.leftFullExtent+K)+" "+D.verticalLeftInnerExtent+"L"+(D.leftFullExtent+K)+" "+(D.sourceY-D.leftSmallArcRadius)+"A"+(D.leftLargeArcRadius+K)+" "+(D.leftSmallArcRadius+K)+" 0 0 1 "+D.leftInnerExtent+" "+(D.sourceY+K)+"L"+D.sourceX+" "+(D.sourceY+K)+"L"+D.sourceX+" "+(D.sourceY-K)+"L"+D.leftInnerExtent+" "+(D.sourceY-K)+"A"+(D.leftLargeArcRadius-K)+" "+(D.leftSmallArcRadius-K)+" 0 0 0 "+(D.leftFullExtent-K)+" "+(D.sourceY-D.leftSmallArcRadius)+"L"+(D.leftFullExtent-K)+" "+D.verticalLeftInnerExtent+"A"+(D.leftLargeArcRadius-K)+" "+(D.leftLargeArcRadius-K)+" 0 0 0 "+D.leftInnerExtent+" "+(D.verticalFullExtent+K)+"L"+D.rightInnerExtent+" "+(D.verticalFullExtent+K)+"A"+(D.rightLargeArcRadius-K)+" "+(D.rightLargeArcRadius-K)+" 0 0 0 "+(D.rightFullExtent+K)+" "+D.verticalRightInnerExtent+"L"+(D.rightFullExtent+K)+" "+(D.targetY-D.rightSmallArcRadius)+"A"+(D.rightLargeArcRadius-K)+" "+(D.rightSmallArcRadius-K)+" 0 0 0 "+D.rightInnerExtent+" "+(D.targetY-K)+"L"+D.targetX+" "+(D.targetY-K)+"Z":"M "+D.targetX+" "+(D.targetY-K)+" L"+D.rightInnerExtent+" "+(D.targetY-K)+"A"+(D.rightLargeArcRadius+K)+" "+(D.rightSmallArcRadius+K)+" 0 0 0 "+(D.rightFullExtent-K)+" "+(D.targetY+D.rightSmallArcRadius)+"L"+(D.rightFullExtent-K)+" "+D.verticalRightInnerExtent+"A"+(D.rightLargeArcRadius+K)+" "+(D.rightLargeArcRadius+K)+" 0 0 0 "+D.rightInnerExtent+" "+(D.verticalFullExtent+K)+"L"+D.leftInnerExtent+" "+(D.verticalFullExtent+K)+"A"+(D.leftLargeArcRadius+K)+" "+(D.leftLargeArcRadius+K)+" 0 0 0 "+(D.leftFullExtent+K)+" "+D.verticalLeftInnerExtent+"L"+(D.leftFullExtent+K)+" "+(D.sourceY+D.leftSmallArcRadius)+"A"+(D.leftLargeArcRadius+K)+" "+(D.leftSmallArcRadius+K)+" 0 0 0 "+D.leftInnerExtent+" "+(D.sourceY-K)+"L"+D.sourceX+" "+(D.sourceY-K)+"L"+D.sourceX+" "+(D.sourceY+K)+"L"+D.leftInnerExtent+" "+(D.sourceY+K)+"A"+(D.leftLargeArcRadius-K)+" "+(D.leftSmallArcRadius-K)+" 0 0 1 "+(D.leftFullExtent-K)+" "+(D.sourceY+D.leftSmallArcRadius)+"L"+(D.leftFullExtent-K)+" "+D.verticalLeftInnerExtent+"A"+(D.leftLargeArcRadius-K)+" "+(D.leftLargeArcRadius-K)+" 0 0 1 "+D.leftInnerExtent+" "+(D.verticalFullExtent-K)+"L"+D.rightInnerExtent+" "+(D.verticalFullExtent-K)+"A"+(D.rightLargeArcRadius-K)+" "+(D.rightLargeArcRadius-K)+" 0 0 1 "+(D.rightFullExtent+K)+" "+D.verticalRightInnerExtent+"L"+(D.rightFullExtent+K)+" "+(D.targetY+D.rightSmallArcRadius)+"A"+(D.rightLargeArcRadius-K)+" "+(D.rightSmallArcRadius-K)+" 0 0 1 "+D.rightInnerExtent+" "+(D.targetY+K)+"L"+D.targetX+" "+(D.targetY+K)+"Z";var Y,K,D,B=G.link.source.x1,q=G.link.target.x0,ee=m(B,q),J=ee(.5),$=ee(.5),te=G.link.y0-G.link.width/2,ie=G.link.y0+G.link.width/2,ae=G.link.y1-G.link.width/2,he=G.link.y1+G.link.width/2;return"M"+B+","+te+"C"+J+","+te+" "+$+","+ae+" "+q+","+ae+"L"+q+","+he+"C"+$+","+he+" "+J+","+ie+" "+B+","+ie+"Z"}}function L(G,Y){var K=u(Y.color),D=f.nodePadAcross,B=G.nodePad/2;Y.dx=Y.x1-Y.x0,Y.dy=Y.y1-Y.y0;var q=Y.dx,ee=Math.max(.5,Y.dy),J="node_"+Y.pointNumber;return Y.group&&(J=o.randstr()),Y.trace=G.trace,Y.curveNumber=G.trace.index,{index:Y.pointNumber,key:J,partOfGroup:Y.partOfGroup||!1,group:Y.group,traceId:G.key,trace:G.trace,node:Y,nodePad:G.nodePad,nodeLineColor:G.nodeLineColor,nodeLineWidth:G.nodeLineWidth,textFont:G.textFont,size:G.horizontal?G.height:G.width,visibleWidth:Math.ceil(q),visibleHeight:ee,zoneX:-D,zoneY:-B,zoneWidth:q+2*D,zoneHeight:ee+2*B,labelY:G.horizontal?Y.dy/2+1:Y.dx/2+1,left:Y.originalLayer===1,sizeAcross:G.width,forceLayouts:G.forceLayouts,horizontal:G.horizontal,darkBackground:K.getBrightness()<=128,tinyColorHue:i.tinyRGB(K),tinyColorAlpha:K.getAlpha(),valueFormat:G.valueFormat,valueSuffix:G.valueSuffix,sankey:G.sankey,graph:G.graph,arrangement:G.arrangement,uniqueNodeLabelPathId:[G.guid,G.key,J].join("_"),interactionState:G.interactionState,figure:G}}function k(G){G.attr("transform",function(Y){return a(Y.node.x0.toFixed(3),Y.node.y0.toFixed(3))})}function C(G){G.call(k)}function M(G,Y){G.call(C),Y.attr("d",w())}function P(G){G.attr("width",function(Y){return Y.node.x1-Y.node.x0}).attr("height",function(Y){return Y.visibleHeight})}function O(G){return G.link.width>1||G.linkLineWidth>0}function F(G){return a(G.translateX,G.translateY)+(G.horizontal?"matrix(1 0 0 1 0 0)":"matrix(0 1 1 0 0 0)")}function j(G,Y,K){G.on(".basic",null).on("mouseover.basic",function(D){D.interactionState.dragInProgress||D.partOfGroup||(K.hover(this,D,Y),D.interactionState.hovered=[this,D])}).on("mousemove.basic",function(D){D.interactionState.dragInProgress||D.partOfGroup||(K.follow(this,D),D.interactionState.hovered=[this,D])}).on("mouseout.basic",function(D){D.interactionState.dragInProgress||D.partOfGroup||(K.unhover(this,D,Y),D.interactionState.hovered=!1)}).on("click.basic",function(D){D.interactionState.hovered&&(K.unhover(this,D,Y),D.interactionState.hovered=!1),D.interactionState.dragInProgress||D.partOfGroup||K.select(this,D,Y)})}function W(G,Y,K,D){var B=g.behavior.drag().origin(function(q){return{x:q.node.x0+q.visibleWidth/2,y:q.node.y0+q.visibleHeight/2}}).on("dragstart",function(q){if(q.arrangement!=="fixed"&&(o.ensureSingle(D._fullLayout._infolayer,"g","dragcover",function(J){D._fullLayout._dragCover=J}),o.raiseToTop(this),q.interactionState.dragInProgress=q.node,Q(q.node),q.interactionState.hovered&&(K.nodeEvents.unhover.apply(0,q.interactionState.hovered),q.interactionState.hovered=!1),q.arrangement==="snap")){var ee=q.traceId+"|"+q.key;q.forceLayouts[ee]?q.forceLayouts[ee].alpha(1):function(J,$,te,ie){(function(he){for(var se=0;se<he.length;se++)he[se].y=(he[se].y0+he[se].y1)/2,he[se].x=(he[se].x0+he[se].x1)/2})(te.graph.nodes);var ae=te.graph.nodes.filter(function(he){return he.originalX===te.node.originalX}).filter(function(he){return!he.partOfGroup});te.forceLayouts[$]=t.forceSimulation(ae).alphaDecay(0).force("collide",t.forceCollide().radius(function(he){return he.dy/2+te.nodePad/2}).strength(1).iterations(f.forceIterations)).force("constrain",function(he,se,de,ce){return function(){for(var ve=0,ke=0;ke<de.length;ke++){var Ee=de[ke];Ee===ce.interactionState.dragInProgress?(Ee.x=Ee.lastDraggedX,Ee.y=Ee.lastDraggedY):(Ee.vx=(Ee.originalX-Ee.x)/f.forceTicksPerFrame,Ee.y=Math.min(ce.size-Ee.dy/2,Math.max(Ee.dy/2,Ee.y))),ve=Math.max(ve,Math.abs(Ee.vx),Math.abs(Ee.vy))}!ce.interactionState.dragInProgress&&ve<.1&&ce.forceLayouts[se].alpha()>0&&ce.forceLayouts[se].alpha(0)}}(0,$,ae,te)).stop()}(0,ee,q),function(J,$,te,ie,ae){window.requestAnimationFrame(function he(){var se;for(se=0;se<f.forceTicksPerFrame;se++)te.forceLayouts[ie].tick();if(function(ce){for(var ve=0;ve<ce.length;ve++)ce[ve].y0=ce[ve].y-ce[ve].dy/2,ce[ve].y1=ce[ve].y0+ce[ve].dy,ce[ve].x0=ce[ve].x-ce[ve].dx/2,ce[ve].x1=ce[ve].x0+ce[ve].dx}(te.graph.nodes),te.sankey.update(te.graph),M(J.filter(X(te)),$),te.forceLayouts[ie].alpha()>0)window.requestAnimationFrame(he);else{var de=te.node.originalX;te.node.x0=de-te.visibleWidth/2,te.node.x1=de+te.visibleWidth/2,Z(te,ae)}})}(G,Y,q,ee,D)}}).on("drag",function(q){if(q.arrangement!=="fixed"){var ee=g.event.x,J=g.event.y;q.arrangement==="snap"?(q.node.x0=ee-q.visibleWidth/2,q.node.x1=ee+q.visibleWidth/2,q.node.y0=J-q.visibleHeight/2,q.node.y1=J+q.visibleHeight/2):(q.arrangement==="freeform"&&(q.node.x0=ee-q.visibleWidth/2,q.node.x1=ee+q.visibleWidth/2),J=Math.max(0,Math.min(q.size-q.visibleHeight/2,J)),q.node.y0=J-q.visibleHeight/2,q.node.y1=J+q.visibleHeight/2),Q(q.node),q.arrangement!=="snap"&&(q.sankey.update(q.graph),M(G.filter(X(q)),Y))}}).on("dragend",function(q){if(q.arrangement!=="fixed"){q.interactionState.dragInProgress=!1;for(var ee=0;ee<q.node.childrenNodes.length;ee++)q.node.childrenNodes[ee].x=q.node.x,q.node.childrenNodes[ee].y=q.node.y;q.arrangement!=="snap"&&Z(q,D)}});G.on(".drag",null).call(B)}function Z(G,Y){for(var K=[],D=[],B=0;B<G.graph.nodes.length;B++){var q=(G.graph.nodes[B].x0+G.graph.nodes[B].x1)/2,ee=(G.graph.nodes[B].y0+G.graph.nodes[B].y1)/2;K.push(q/G.figure.width),D.push(ee/G.figure.height)}v.call("_guiRestyle",Y,{"node.x":[K],"node.y":[D]},G.trace.index).then(function(){Y._fullLayout._dragCover&&Y._fullLayout._dragCover.remove()})}function Q(G){G.lastDraggedX=G.x0+G.dx/2,G.lastDraggedY=G.y0+G.dy/2}function X(G){return function(Y){return Y.node.originalX===G.node.originalX}}N.exports=function(G,Y,K,D,B){var q=!1;o.ensureSingle(G._fullLayout._infolayer,"g","first-render",function(){q=!0});var ee=G._fullLayout._dragCover,J=K.filter(function(ce){return l(ce).trace.visible}).map(A.bind(null,D)),$=Y.selectAll("."+f.cn.sankey).data(J,n);$.exit().remove(),$.enter().append("g").classed(f.cn.sankey,!0).style("box-sizing","content-box").style("position","absolute").style("left",0).style("shape-rendering","geometricPrecision").style("pointer-events","auto").attr("transform",F),$.each(function(ce,ve){G._fullData[ve]._sankey=ce;var ke="bgsankey-"+ce.trace.uid+"-"+ve;o.ensureSingle(G._fullLayout._draggers,"rect",ke),G._fullData[ve]._bgRect=g.select("."+ke),G._fullData[ve]._bgRect.style("pointer-events","all").attr("width",ce.width).attr("height",ce.height).attr("x",ce.translateX).attr("y",ce.translateY).classed("bgsankey",!0).style({fill:"transparent","stroke-width":0})}),$.transition().ease(f.ease).duration(f.duration).attr("transform",F);var te=$.selectAll("."+f.cn.sankeyLinks).data(d,n);te.enter().append("g").classed(f.cn.sankeyLinks,!0).style("fill","none");var ie=te.selectAll("."+f.cn.sankeyLink).data(function(ce){return ce.graph.links.filter(function(ve){return ve.value}).map(S.bind(null,ce))},n);ie.enter().append("path").classed(f.cn.sankeyLink,!0).call(j,$,B.linkEvents),ie.style("stroke",function(ce){return O(ce)?i.tinyRGB(u(ce.linkLineColor)):ce.tinyColorHue}).style("stroke-opacity",function(ce){return O(ce)?i.opacity(ce.linkLineColor):ce.tinyColorAlpha}).style("fill",function(ce){return ce.tinyColorHue}).style("fill-opacity",function(ce){return ce.tinyColorAlpha}).style("stroke-width",function(ce){return O(ce)?ce.linkLineWidth:1}).attr("d",w()),ie.style("opacity",function(){return G._context.staticPlot||q||ee?1:0}).transition().ease(f.ease).duration(f.duration).style("opacity",1),ie.exit().transition().ease(f.ease).duration(f.duration).style("opacity",0).remove();var ae=$.selectAll("."+f.cn.sankeyNodeSet).data(d,n);ae.enter().append("g").classed(f.cn.sankeyNodeSet,!0),ae.style("cursor",function(ce){switch(ce.arrangement){case"fixed":return"default";case"perpendicular":return"ns-resize";default:return"move"}});var he=ae.selectAll("."+f.cn.sankeyNode).data(function(ce){var ve=ce.graph.nodes;return function(ke){var Ee,be=[];for(Ee=0;Ee<ke.length;Ee++)ke[Ee].originalX=(ke[Ee].x0+ke[Ee].x1)/2,ke[Ee].originalY=(ke[Ee].y0+ke[Ee].y1)/2,be.indexOf(ke[Ee].originalX)===-1&&be.push(ke[Ee].originalX);for(be.sort(function(xe,ue){return xe-ue}),Ee=0;Ee<ke.length;Ee++)ke[Ee].originalLayerIndex=be.indexOf(ke[Ee].originalX),ke[Ee].originalLayer=ke[Ee].originalLayerIndex/(be.length-1)}(ve),ve.map(L.bind(null,ce))},n);he.enter().append("g").classed(f.cn.sankeyNode,!0).call(k).style("opacity",function(ce){return!G._context.staticPlot&&!q||ce.partOfGroup?0:1}),he.call(j,$,B.nodeEvents).call(W,ie,B,G),he.transition().ease(f.ease).duration(f.duration).call(k).style("opacity",function(ce){return ce.partOfGroup?0:1}),he.exit().transition().ease(f.ease).duration(f.duration).style("opacity",0).remove();var se=he.selectAll("."+f.cn.nodeRect).data(d);se.enter().append("rect").classed(f.cn.nodeRect,!0).call(P),se.style("stroke-width",function(ce){return ce.nodeLineWidth}).style("stroke",function(ce){return i.tinyRGB(u(ce.nodeLineColor))}).style("stroke-opacity",function(ce){return i.opacity(ce.nodeLineColor)}).style("fill",function(ce){return ce.tinyColorHue}).style("fill-opacity",function(ce){return ce.tinyColorAlpha}),se.transition().ease(f.ease).duration(f.duration).call(P);var de=he.selectAll("."+f.cn.nodeLabel).data(d);de.enter().append("text").classed(f.cn.nodeLabel,!0).style("cursor","default"),de.attr("data-notex",1).text(function(ce){return ce.node.label}).each(function(ce){var ve=g.select(this);s.font(ve,ce.textFont),y.convertToTspans(ve,G)}).style("text-shadow",y.makeTextShadow(G._fullLayout.paper_bgcolor)).attr("text-anchor",function(ce){return ce.horizontal&&ce.left?"end":"start"}).attr("transform",function(ce){var ve=g.select(this),ke=y.lineCount(ve),Ee=ce.textFont.size*((ke-1)*T-x),be=ce.nodeLineWidth/2+3,xe=((ce.horizontal?ce.visibleHeight:ce.visibleWidth)-Ee)/2;ce.horizontal&&(ce.left?be=-be:be+=ce.visibleWidth);var ue=ce.horizontal?"":"scale(-1,1)"+c(90);return a(ce.horizontal?be:xe,ce.horizontal?xe:be)+ue}),de.transition().ease(f.ease).duration(f.duration)}},{"../../components/color":650,"../../components/drawing":672,"../../constants/alignment":755,"../../lib":787,"../../lib/gup":784,"../../lib/svg_text_utils":813,"../../registry":915,"./constants":1195,"@plotly/d3":58,"@plotly/d3-sankey":57,"@plotly/d3-sankey-circular":56,"d3-force":163,"d3-interpolate":168,tinycolor2:583}],1200:[function(h,N,H){N.exports=function(t,m){for(var g=[],p=t.cd[0].trace,e=p._sankey.graph.nodes,f=0;f<e.length;f++){var u=e[f];if(!u.partOfGroup){var i=[(u.x0+u.x1)/2,(u.y0+u.y1)/2];p.orientation==="v"&&i.reverse(),m&&m.contains(i,!1,f,t)&&g.push({pointNumber:u.pointNumber})}}return g}},{}],1201:[function(h,N,H){var t=h("../../lib");N.exports=function(m,g){for(var p=0;p<m.length;p++)m[p].i=p;t.mergeArray(g.text,m,"tx"),t.mergeArray(g.texttemplate,m,"txt"),t.mergeArray(g.hovertext,m,"htx"),t.mergeArray(g.customdata,m,"data"),t.mergeArray(g.textposition,m,"tp"),g.textfont&&(t.mergeArrayCastPositive(g.textfont.size,m,"ts"),t.mergeArray(g.textfont.color,m,"tc"),t.mergeArray(g.textfont.family,m,"tf"));var e=g.marker;if(e){t.mergeArrayCastPositive(e.size,m,"ms"),t.mergeArrayCastPositive(e.opacity,m,"mo"),t.mergeArray(e.symbol,m,"mx"),t.mergeArray(e.color,m,"mc");var f=e.line;e.line&&(t.mergeArray(f.color,m,"mlc"),t.mergeArrayCastPositive(f.width,m,"mlw"));var u=e.gradient;u&&u.type!=="none"&&(t.mergeArray(u.type,m,"mgt"),t.mergeArray(u.color,m,"mgc"))}}},{"../../lib":787}],1202:[function(h,N,H){var t=h("../../plots/cartesian/axis_format_attributes").axisHoverFormat,m=h("../../plots/template_attributes").texttemplateAttrs,g=h("../../plots/template_attributes").hovertemplateAttrs,p=h("../../components/colorscale/attributes"),e=h("../../plots/font_attributes"),f=h("../../components/drawing/attributes").dash,u=h("../../components/drawing"),i=h("./constants"),s=h("../../lib/extend").extendFlat;N.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dx:{valType:"number",dflt:1,editType:"calc",anim:!0},y:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dy:{valType:"number",dflt:1,editType:"calc",anim:!0},xperiod:{valType:"any",dflt:0,editType:"calc"},yperiod:{valType:"any",dflt:0,editType:"calc"},xperiod0:{valType:"any",editType:"calc"},yperiod0:{valType:"any",editType:"calc"},xperiodalignment:{valType:"enumerated",values:["start","middle","end"],dflt:"middle",editType:"calc"},yperiodalignment:{valType:"enumerated",values:["start","middle","end"],dflt:"middle",editType:"calc"},xhoverformat:t("x"),yhoverformat:t("y"),stackgroup:{valType:"string",dflt:"",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc"},groupnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},stackgaps:{valType:"enumerated",values:["infer zero","interpolate"],dflt:"infer zero",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},texttemplate:m({},{}),hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"],editType:"calc"},hoveron:{valType:"flaglist",flags:["points","fills"],editType:"style"},hovertemplate:g({},{keys:i.eventDataKeys}),line:{color:{valType:"color",editType:"style",anim:!0},width:{valType:"number",min:0,dflt:2,editType:"style",anim:!0},shape:{valType:"enumerated",values:["linear","spline","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},smoothing:{valType:"number",min:0,max:1.3,dflt:1,editType:"plot"},dash:s({},f,{editType:"style"}),simplify:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},cliponaxis:{valType:"boolean",dflt:!0,editType:"plot"},fill:{valType:"enumerated",values:["none","tozeroy","tozerox","tonexty","tonextx","toself","tonext"],editType:"calc"},fillcolor:{valType:"color",editType:"style",anim:!0},marker:s({symbol:{valType:"enumerated",values:u.symbolList,dflt:"circle",arrayOk:!0,editType:"style"},opacity:{valType:"number",min:0,max:1,arrayOk:!0,editType:"style",anim:!0},size:{valType:"number",min:0,dflt:6,arrayOk:!0,editType:"calc",anim:!0},maxdisplayed:{valType:"number",min:0,dflt:0,editType:"plot"},sizeref:{valType:"number",dflt:1,editType:"calc"},sizemin:{valType:"number",min:0,dflt:0,editType:"calc"},sizemode:{valType:"enumerated",values:["diameter","area"],dflt:"diameter",editType:"calc"},line:s({width:{valType:"number",min:0,arrayOk:!0,editType:"style",anim:!0},editType:"calc"},p("marker.line",{anim:!0})),gradient:{type:{valType:"enumerated",values:["radial","horizontal","vertical","none"],arrayOk:!0,dflt:"none",editType:"calc"},color:{valType:"color",arrayOk:!0,editType:"calc"},editType:"calc"},editType:"calc"},p("marker",{anim:!0})),selected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},unselected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"middle center",arrayOk:!0,editType:"calc"},textfont:e({editType:"calc",colorEditType:"style",arrayOk:!0})}},{"../../components/colorscale/attributes":657,"../../components/drawing":672,"../../components/drawing/attributes":671,"../../lib/extend":777,"../../plots/cartesian/axis_format_attributes":841,"../../plots/font_attributes":867,"../../plots/template_attributes":910,"./constants":1206}],1203:[function(h,N,H){var t=h("fast-isnumeric"),m=h("../../lib"),g=h("../../plots/cartesian/axes"),p=h("../../plots/cartesian/align_period"),e=h("../../constants/numerical").BADNUM,f=h("./subtypes"),u=h("./colorscale_calc"),i=h("./arrays_to_calcdata"),s=h("./calc_selection");function o(d,l,y,v,_,x,T){var A=l._length,S=d._fullLayout,w=y._id,L=v._id,k=S._firstScatter[r(l)]===l.uid,C=(n(l,S,y,v)||{}).orientation,M=l.fill;y._minDtick=0,v._minDtick=0;var P={padded:!0},O={padded:!0};T&&(P.ppad=O.ppad=T);var F=A<2||_[0]!==_[A-1]||x[0]!==x[A-1];F&&(M==="tozerox"||M==="tonextx"&&(k||C==="h"))?P.tozero=!0:(l.error_y||{}).visible||M!=="tonexty"&&M!=="tozeroy"&&(f.hasMarkers(l)||f.hasText(l))||(P.padded=!1,P.ppad=0),F&&(M==="tozeroy"||M==="tonexty"&&(k||C==="v"))?O.tozero=!0:M!=="tonextx"&&M!=="tozerox"||(O.padded=!1),w&&(l._extremes[w]=g.findExtremes(y,_,P)),L&&(l._extremes[L]=g.findExtremes(v,x,O))}function a(d,l){if(f.hasMarkers(d)){var y,v=d.marker,_=1.6*(d.marker.sizeref||1);if(y=d.marker.sizemode==="area"?function(w){return Math.max(Math.sqrt((w||0)/_),3)}:function(w){return Math.max((w||0)/_,3)},m.isArrayOrTypedArray(v.size)){var x={type:"linear"};g.setConvert(x);for(var T=x.makeCalcdata(d.marker,"size"),A=new Array(l),S=0;S<l;S++)A[S]=y(T[S]);return A}return y(v.size)}}function c(d,l){var y=r(l),v=d._firstScatter;v[y]||(v[y]=l.uid)}function r(d){var l=d.stackgroup;return d.xaxis+d.yaxis+d.type+(l?"-"+l:"")}function n(d,l,y,v){var _=d.stackgroup;if(_){var x=l._scatterStackOpts[y._id+v._id][_],T=x.orientation==="v"?v:y;return T.type==="linear"||T.type==="log"?x:void 0}}N.exports={calc:function(d,l){var y,v,_,x,T,A,S=d._fullLayout,w=g.getFromId(d,l.xaxis||"x"),L=g.getFromId(d,l.yaxis||"y"),k=w.makeCalcdata(l,"x"),C=L.makeCalcdata(l,"y"),M=p(l,w,"x",k),P=p(l,L,"y",C),O=M.vals,F=P.vals,j=l._length,W=new Array(j),Z=l.ids,Q=n(l,S,w,L),X=!1;c(S,l);var G,Y="x",K="y";Q?(m.pushUnique(Q.traceIndices,l._expandedIndex),(y=Q.orientation==="v")?(K="s",G="x"):(Y="s",G="y"),T=Q.stackgaps==="interpolate"):o(d,l,w,L,O,F,a(l,j));var D=!!l.xperiodalignment,B=!!l.yperiodalignment;for(v=0;v<j;v++){var q=W[v]={},ee=t(O[v]),J=t(F[v]);ee&&J?(q[Y]=O[v],q[K]=F[v],D&&(q.orig_x=k[v],q.xEnd=M.ends[v],q.xStart=M.starts[v]),B&&(q.orig_y=C[v],q.yEnd=P.ends[v],q.yStart=P.starts[v])):Q&&(y?ee:J)?(q[G]=y?O[v]:F[v],q.gap=!0,T?(q.s=e,X=!0):q.s=0):q[Y]=q[K]=e,Z&&(q.id=String(Z[v]))}if(i(W,l),u(d,l),s(W,l),Q){for(v=0;v<W.length;)W[v][G]===e?W.splice(v,1):v++;if(m.sort(W,function(ae,he){return ae[G]-he[G]||ae.i-he.i}),X){for(v=0;v<W.length-1&&W[v].gap;)v++;for((A=W[v].s)||(A=W[v].s=0),_=0;_<v;_++)W[_].s=A;for(x=W.length-1;x>v&&W[x].gap;)x--;for(A=W[x].s,_=W.length-1;_>x;_--)W[_].s=A;for(;v<x;)if(W[++v].gap){for(_=v+1;W[_].gap;)_++;for(var $=W[v-1][G],te=W[v-1].s,ie=(W[_].s-te)/(W[_][G]-$);v<_;)W[v].s=te+(W[v][G]-$)*ie,v++}}}return W},calcMarkerSize:a,calcAxisExpansion:o,setFirstScatter:c,getStackOpts:n}},{"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/align_period":835,"../../plots/cartesian/axes":838,"./arrays_to_calcdata":1201,"./calc_selection":1204,"./colorscale_calc":1205,"./subtypes":1227,"fast-isnumeric":246}],1204:[function(h,N,H){var t=h("../../lib");N.exports=function(m,g){t.isArrayOrTypedArray(g.selectedpoints)&&t.tagSelected(m,g)}},{"../../lib":787}],1205:[function(h,N,H){var t=h("../../components/colorscale/helpers").hasColorscale,m=h("../../components/colorscale/calc"),g=h("./subtypes");N.exports=function(p,e){g.hasLines(e)&&t(e,"line")&&m(p,e,{vals:e.line.color,containerStr:"line",cLetter:"c"}),g.hasMarkers(e)&&(t(e,"marker")&&m(p,e,{vals:e.marker.color,containerStr:"marker",cLetter:"c"}),t(e,"marker.line")&&m(p,e,{vals:e.marker.line.color,containerStr:"marker.line",cLetter:"c"}))}},{"../../components/colorscale/calc":658,"../../components/colorscale/helpers":661,"./subtypes":1227}],1206:[function(h,N,H){N.exports={PTS_LINESONLY:20,minTolerance:.2,toleranceGrowth:10,maxScreensAway:20,eventDataKeys:[]}},{}],1207:[function(h,N,H){var t=h("./calc");function m(g,p,e,f,u,i,s){u[f]=!0;var o={i:null,gap:!0,s:0};if(o[s]=e,g.splice(p,0,o),p&&e===g[p-1][s]){var a=g[p-1];o.s=a.s,o.i=a.i,o.gap=a.gap}else i&&(o.s=function(c,r,n,d){var l=c[r-1],y=c[r+1];return y?l?l.s+(y.s-l.s)*(n-l[d])/(y[d]-l[d]):y.s:l.s}(g,p,e,s));p||(g[0].t=g[1].t,g[0].trace=g[1].trace,delete g[1].t,delete g[1].trace)}N.exports=function(g,p){var e=p.xaxis,f=p.yaxis,u=e._id+f._id,i=g._fullLayout._scatterStackOpts[u];if(i){var s,o,a,c,r,n,d,l,y,v,_,x,T,A,S,w=g.calcdata;for(var L in i){var k=(v=i[L]).traceIndices;if(k.length){for(_=v.stackgaps==="interpolate",x=v.groupnorm,v.orientation==="v"?(T="x",A="y"):(T="y",A="x"),S=new Array(k.length),s=0;s<S.length;s++)S[s]=!1;n=w[k[0]];var C=new Array(n.length);for(s=0;s<n.length;s++)C[s]=n[s][T];for(s=1;s<k.length;s++){for(r=w[k[s]],o=a=0;o<r.length;o++){for(d=r[o][T];d>C[a]&&a<C.length;a++)m(r,o,C[a],s,S,_,T),o++;if(d!==C[a]){for(c=0;c<s;c++)m(w[k[c]],a,d,c,S,_,T);C.splice(a,0,d)}a++}for(;a<C.length;a++)m(r,o,C[a],s,S,_,T),o++}var M=C.length;for(o=0;o<n.length;o++){for(l=n[o][A]=n[o].s,s=1;s<k.length;s++)(r=w[k[s]])[0].trace._rawLength=r[0].trace._length,r[0].trace._length=M,l+=r[o].s,r[o][A]=l;if(x)for(y=(x==="fraction"?l:l/100)||1,s=0;s<k.length;s++){var P=w[k[s]][o];P[A]/=y,P.sNorm=P.s/y}}for(s=0;s<k.length;s++){var O=(r=w[k[s]])[0].trace,F=t.calcMarkerSize(O,O._rawLength),j=Array.isArray(F);if(F&&S[s]||j){var W=F;for(F=new Array(M),o=0;o<M;o++)F[o]=r[o].gap?0:j?W[r[o].i]:W}var Z=new Array(M),Q=new Array(M);for(o=0;o<M;o++)Z[o]=r[o].x,Q[o]=r[o].y;t.calcAxisExpansion(g,O,e,f,Z,Q,F),r[0].t.orientation=v.orientation}}}}}},{"./calc":1203}],1208:[function(h,N,H){N.exports=function(t){for(var m=0;m<t.length;m++){var g=t[m];if(g.type==="scatter"){var p=g.fill;if(p!=="none"&&p!=="toself"&&(g.opacity=void 0,p==="tonexty"||p==="tonextx"))for(var e=m-1;e>=0;e--){var f=t[e];if(f.type==="scatter"&&f.xaxis===g.xaxis&&f.yaxis===g.yaxis){f.opacity=void 0;break}}}}}},{}],1209:[function(h,N,H){var t=h("../../lib"),m=h("../../registry"),g=h("./attributes"),p=h("./constants"),e=h("./subtypes"),f=h("./xy_defaults"),u=h("./period_defaults"),i=h("./stack_defaults"),s=h("./marker_defaults"),o=h("./line_defaults"),a=h("./line_shape_defaults"),c=h("./text_defaults"),r=h("./fillcolor_defaults");N.exports=function(n,d,l,y){function v(k,C){return t.coerce(n,d,g,k,C)}var _=f(n,d,y,v);if(_||(d.visible=!1),d.visible){u(n,d,y,v),v("xhoverformat"),v("yhoverformat");var x=i(n,d,y,v),T=!x&&_<p.PTS_LINESONLY?"lines+markers":"lines";v("text"),v("hovertext"),v("mode",T),e.hasLines(d)&&(o(n,d,l,y,v),a(n,d,v),v("connectgaps"),v("line.simplify")),e.hasMarkers(d)&&s(n,d,l,y,v,{gradient:!0}),e.hasText(d)&&(v("texttemplate"),c(n,d,y,v));var A=[];(e.hasMarkers(d)||e.hasText(d))&&(v("cliponaxis"),v("marker.maxdisplayed"),A.push("points")),v("fill",x?x.fillDflt:"none"),d.fill!=="none"&&(r(n,d,l,v),e.hasLines(d)||a(n,d,v));var S=(d.line||{}).color,w=(d.marker||{}).color;d.fill!=="tonext"&&d.fill!=="toself"||A.push("fills"),v("hoveron",A.join("+")||"points"),d.hoveron!=="fills"&&v("hovertemplate");var L=m.getComponentMethod("errorbars","supplyDefaults");L(n,d,S||w||l,{axis:"y"}),L(n,d,S||w||l,{axis:"x",inherit:"y"}),t.coerceSelectionMarkerOpacity(d,v)}}},{"../../lib":787,"../../registry":915,"./attributes":1202,"./constants":1206,"./fillcolor_defaults":1210,"./line_defaults":1215,"./line_shape_defaults":1217,"./marker_defaults":1221,"./period_defaults":1222,"./stack_defaults":1225,"./subtypes":1227,"./text_defaults":1228,"./xy_defaults":1229}],1210:[function(h,N,H){var t=h("../../components/color"),m=h("../../lib").isArrayOrTypedArray;N.exports=function(g,p,e,f){var u=!1;if(p.marker){var i=p.marker.color,s=(p.marker.line||{}).color;i&&!m(i)?u=i:s&&!m(s)&&(u=s)}f("fillcolor",t.addOpacity((p.line||{}).color||u||e,.5))}},{"../../components/color":650,"../../lib":787}],1211:[function(h,N,H){var t=h("../../plots/cartesian/axes");N.exports=function(m,g,p){var e={},f={_fullLayout:p},u=t.getFromTrace(f,g,"x"),i=t.getFromTrace(f,g,"y");return e.xLabel=t.tickText(u,u.c2l(m.x),!0).text,e.yLabel=t.tickText(i,i.c2l(m.y),!0).text,e}},{"../../plots/cartesian/axes":838}],1212:[function(h,N,H){var t=h("../../components/color"),m=h("./subtypes");N.exports=function(g,p){var e,f;if(g.mode==="lines")return(e=g.line.color)&&t.opacity(e)?e:g.fillcolor;if(g.mode==="none")return g.fill?g.fillcolor:"";var u=p.mcc||(g.marker||{}).color,i=p.mlcc||((g.marker||{}).line||{}).color;return(f=u&&t.opacity(u)?u:i&&t.opacity(i)&&(p.mlw||((g.marker||{}).line||{}).width)?i:"")?t.opacity(f)<.3?t.addOpacity(f,.3):f:(e=(g.line||{}).color)&&t.opacity(e)&&m.hasLines(g)&&g.line.width?e:g.fillcolor}},{"../../components/color":650,"./subtypes":1227}],1213:[function(h,N,H){var t=h("../../lib"),m=h("../../components/fx"),g=h("../../registry"),p=h("./get_trace_color"),e=h("../../components/color"),f=t.fillText;N.exports=function(u,i,s,o){var a=u.cd,c=a[0].trace,r=u.xa,n=u.ya,d=r.c2p(i),l=n.c2p(s),y=[d,l],v=c.hoveron||"",_=c.mode.indexOf("markers")!==-1?3:.5,x=!!c.xperiodalignment,T=!!c.yperiodalignment;if(v.indexOf("points")!==-1){var A=function(se){var de=Math.max(_,se.mrc||0),ce=r.c2p(se.x)-d,ve=n.c2p(se.y)-l;return Math.max(Math.sqrt(ce*ce+ve*ve)-de,1-_/de)},S=m.getDistanceFunction(o,function(se){if(x){var de=r.c2p(se.xStart),ce=r.c2p(se.xEnd);return d>=Math.min(de,ce)&&d<=Math.max(de,ce)?0:1/0}var ve=Math.max(3,se.mrc||0),ke=1-1/ve,Ee=Math.abs(r.c2p(se.x)-d);return Ee<ve?ke*Ee/ve:Ee-ve+ke},function(se){if(T){var de=n.c2p(se.yStart),ce=n.c2p(se.yEnd);return l>=Math.min(de,ce)&&l<=Math.max(de,ce)?0:1/0}var ve=Math.max(3,se.mrc||0),ke=1-1/ve,Ee=Math.abs(n.c2p(se.y)-l);return Ee<ve?ke*Ee/ve:Ee-ve+ke},A);if(m.getClosest(a,S,u),u.index!==!1){var w=a[u.index],L=r.c2p(w.x,!0),k=n.c2p(w.y,!0),C=w.mrc||1;u.index=w.i;var M=a[0].t.orientation,P=M&&(w.sNorm||w.s),O=M==="h"?P:w.orig_x!==void 0?w.orig_x:w.x,F=M==="v"?P:w.orig_y!==void 0?w.orig_y:w.y;return t.extendFlat(u,{color:p(c,w),x0:L-C,x1:L+C,xLabelVal:O,y0:k-C,y1:k+C,yLabelVal:F,spikeDistance:A(w),hovertemplate:c.hovertemplate}),f(w,c,u),g.getComponentMethod("errorbars","hoverInfo")(w,c,u),[u]}}if(v.indexOf("fills")!==-1&&c._polygons){var j,W,Z,Q,X,G,Y,K,D,B=c._polygons,q=[],ee=!1,J=1/0,$=-1/0,te=1/0,ie=-1/0;for(j=0;j<B.length;j++)(Z=B[j]).contains(y)&&(ee=!ee,q.push(Z),te=Math.min(te,Z.ymin),ie=Math.max(ie,Z.ymax));if(ee){var ae=((te=Math.max(te,0))+(ie=Math.min(ie,n._length)))/2;for(j=0;j<q.length;j++)for(Q=q[j].pts,W=1;W<Q.length;W++)(K=Q[W-1][1])>ae!=(D=Q[W][1])>=ae&&(G=Q[W-1][0],Y=Q[W][0],D-K&&(X=G+(Y-G)*(ae-K)/(D-K),J=Math.min(J,X),$=Math.max($,X)));J=Math.max(J,0),$=Math.min($,r._length);var he=e.defaultLine;return e.opacity(c.fillcolor)?he=c.fillcolor:e.opacity((c.line||{}).color)&&(he=c.line.color),t.extendFlat(u,{distance:u.maxHoverDistance,x0:J,x1:$,y0:ae,y1:ae,color:he,hovertemplate:!1}),delete u.index,c.text&&!Array.isArray(c.text)?u.text=String(c.text):u.text=c.name,[u]}}}},{"../../components/color":650,"../../components/fx":690,"../../lib":787,"../../registry":915,"./get_trace_color":1212}],1214:[function(h,N,H){var t=h("./subtypes");N.exports={hasLines:t.hasLines,hasMarkers:t.hasMarkers,hasText:t.hasText,isBubble:t.isBubble,attributes:h("./attributes"),supplyDefaults:h("./defaults"),crossTraceDefaults:h("./cross_trace_defaults"),calc:h("./calc").calc,crossTraceCalc:h("./cross_trace_calc"),arraysToCalcdata:h("./arrays_to_calcdata"),plot:h("./plot"),colorbar:h("./marker_colorbar"),formatLabels:h("./format_labels"),style:h("./style").style,styleOnSelect:h("./style").styleOnSelect,hoverPoints:h("./hover"),selectPoints:h("./select"),animatable:!0,moduleType:"trace",name:"scatter",basePlotModule:h("../../plots/cartesian"),categories:["cartesian","svg","symbols","errorBarsOK","showLegend","scatter-like","zoomScale"],meta:{}}},{"../../plots/cartesian":852,"./arrays_to_calcdata":1201,"./attributes":1202,"./calc":1203,"./cross_trace_calc":1207,"./cross_trace_defaults":1208,"./defaults":1209,"./format_labels":1211,"./hover":1213,"./marker_colorbar":1220,"./plot":1223,"./select":1224,"./style":1226,"./subtypes":1227}],1215:[function(h,N,H){var t=h("../../lib").isArrayOrTypedArray,m=h("../../components/colorscale/helpers").hasColorscale,g=h("../../components/colorscale/defaults");N.exports=function(p,e,f,u,i,s){var o=(p.marker||{}).color;i("line.color",f),m(p,"line")?g(p,e,u,i,{prefix:"line.",cLetter:"c"}):i("line.color",!t(o)&&o||f),i("line.width"),(s||{}).noDash||i("line.dash")}},{"../../components/colorscale/defaults":660,"../../components/colorscale/helpers":661,"../../lib":787}],1216:[function(h,N,H){var t=h("../../constants/numerical"),m=t.BADNUM,g=t.LOG_CLIP,p=g+.5,e=g-.5,f=h("../../lib"),u=f.segmentsIntersect,i=f.constrain,s=h("./constants");N.exports=function(o,a){var c,r,n,d,l,y,v,_,x,T,A,S,w,L,k,C,M,P,O=a.xaxis,F=a.yaxis,j=O.type==="log",W=F.type==="log",Z=O._length,Q=F._length,X=a.connectGaps,G=a.baseTolerance,Y=a.shape,K=Y==="linear",D=a.fill&&a.fill!=="none",B=[],q=s.minTolerance,ee=o.length,J=new Array(ee),$=0;function te(Ge){var Qe=o[Ge];if(!Qe)return!1;var it=a.linearized?O.l2p(Qe.x):O.c2p(Qe.x),lt=a.linearized?F.l2p(Qe.y):F.c2p(Qe.y);if(it===m){if(j&&(it=O.c2p(Qe.x,!0)),it===m)return!1;W&&lt===m&&(it*=Math.abs(O._m*Q*(O._m>0?p:e)/(F._m*Z*(F._m>0?p:e)))),it*=1e3}if(lt===m){if(W&&(lt=F.c2p(Qe.y,!0)),lt===m)return!1;lt*=1e3}return[it,lt]}function ie(Ge,Qe,it,lt){var Lt=it-Ge,wt=lt-Qe,rt=.5-Ge,$e=.5-Qe,xt=Lt*Lt+wt*wt,Qt=Lt*rt+wt*$e;if(Qt>0&&Qt<xt){var $t=rt*wt-$e*Lt;if($t*$t<xt)return!0}}function ae(Ge,Qe){var it=Ge[0]/Z,lt=Ge[1]/Q,Lt=Math.max(0,-it,it-1,-lt,lt-1);return Lt&&M!==void 0&&ie(it,lt,M,P)&&(Lt=0),Lt&&Qe&&ie(it,lt,Qe[0]/Z,Qe[1]/Q)&&(Lt=0),(1+s.toleranceGrowth*Lt)*G}function he(Ge,Qe){var it=Ge[0]-Qe[0],lt=Ge[1]-Qe[1];return Math.sqrt(it*it+lt*lt)}var se,de,ce,ve,ke,Ee,be,xe=s.maxScreensAway,ue=-Z*xe,me=Z*(1+xe),we=-Q*xe,Me=Q*(1+xe),Se=[[ue,we,me,we],[me,we,me,Me],[me,Me,ue,Me],[ue,Me,ue,we]];function De(Ge){if(Ge[0]<ue||Ge[0]>me||Ge[1]<we||Ge[1]>Me)return[i(Ge[0],ue,me),i(Ge[1],we,Me)]}function Fe(Ge,Qe){return Ge[0]===Qe[0]&&(Ge[0]===ue||Ge[0]===me)||Ge[1]===Qe[1]&&(Ge[1]===we||Ge[1]===Me)||void 0}function Ye(Ge,Qe,it){return function(lt,Lt){var wt=De(lt),rt=De(Lt),$e=[];if(wt&&rt&&Fe(wt,rt))return $e;wt&&$e.push(wt),rt&&$e.push(rt);var xt=2*f.constrain((lt[Ge]+Lt[Ge])/2,Qe,it)-((wt||lt)[Ge]+(rt||Lt)[Ge]);return xt&&((wt&&rt?xt>0==wt[Ge]>rt[Ge]?wt:rt:wt||rt)[Ge]+=xt),$e}}function et(Ge){var Qe=Ge[0],it=Ge[1],lt=Qe===J[$-1][0],Lt=it===J[$-1][1];if(!lt||!Lt)if($>1){var wt=Qe===J[$-2][0],rt=it===J[$-2][1];lt&&(Qe===ue||Qe===me)&&wt?rt?$--:J[$-1]=Ge:Lt&&(it===we||it===Me)&&rt?wt?$--:J[$-1]=Ge:J[$++]=Ge}else J[$++]=Ge}function Oe(Ge){J[$-1][0]!==Ge[0]&&J[$-1][1]!==Ge[1]&&et([ce,ve]),et(Ge),ke=null,ce=ve=0}function je(Ge){if(M=Ge[0]/Z,P=Ge[1]/Q,se=Ge[0]<ue?ue:Ge[0]>me?me:0,de=Ge[1]<we?we:Ge[1]>Me?Me:0,se||de){if($)if(ke){var Qe=be(ke,Ge);Qe.length>1&&(Oe(Qe[0]),J[$++]=Qe[1])}else Ee=be(J[$-1],Ge)[0],J[$++]=Ee;else J[$++]=[se||Ge[0],de||Ge[1]];var it=J[$-1];se&&de&&(it[0]!==se||it[1]!==de)?(ke&&(ce!==se&&ve!==de?et(ce&&ve?(lt=ke,wt=(Lt=Ge)[0]-lt[0],rt=(Lt[1]-lt[1])/wt,(lt[1]*Lt[0]-Lt[1]*lt[0])/wt>0?[rt>0?ue:me,Me]:[rt>0?me:ue,we]):[ce||se,ve||de]):ce&&ve&&et([ce,ve])),et([se,de])):ce-se&&ve-de&&et([se||ce,de||ve]),ke=Ge,ce=se,ve=de}else ke&&Oe(be(ke,Ge)[0]),J[$++]=Ge;var lt,Lt,wt,rt}for(Y==="linear"||Y==="spline"?be=function(Ge,Qe){for(var it=[],lt=0,Lt=0;Lt<4;Lt++){var wt=Se[Lt],rt=u(Ge[0],Ge[1],Qe[0],Qe[1],wt[0],wt[1],wt[2],wt[3]);rt&&(!lt||Math.abs(rt.x-it[0][0])>1||Math.abs(rt.y-it[0][1])>1)&&(rt=[rt.x,rt.y],lt&&he(rt,Ge)<he(it[0],Ge)?it.unshift(rt):it.push(rt),lt++)}return it}:Y==="hv"||Y==="vh"?be=function(Ge,Qe){var it=[],lt=De(Ge),Lt=De(Qe);return lt&&Lt&&Fe(lt,Lt)||(lt&&it.push(lt),Lt&&it.push(Lt)),it}:Y==="hvh"?be=Ye(0,ue,me):Y==="vhv"&&(be=Ye(1,we,Me)),c=0;c<ee;c++)if(r=te(c)){for($=0,ke=null,je(r),c++;c<ee;c++){if(!(d=te(c))){if(X)continue;break}if(K&&a.simplify){var We=te(c+1);if(T=he(d,r),D&&($===0||$===ee-1)||!(T<ae(d,We)*q)){for(_=[(d[0]-r[0])/T,(d[1]-r[1])/T],l=r,A=T,S=L=k=0,v=!1,n=d,c++;c<o.length;c++){if(y=We,We=te(c+1),!y){if(X)continue;break}if(C=(x=[y[0]-r[0],y[1]-r[1]])[0]*_[1]-x[1]*_[0],L=Math.min(L,C),(k=Math.max(k,C))-L>ae(y,We))break;n=y,(w=x[0]*_[0]+x[1]*_[1])>A?(A=w,d=y,v=!1):w<S&&(S=w,l=y,v=!0)}if(v?(je(d),n!==l&&je(l)):(l!==r&&je(l),n!==d&&je(d)),je(n),c>=o.length||!y)break;je(y),r=y}}else je(d)}ke&&et([ce||ke[0],ve||ke[1]]),B.push(J.slice(0,$))}return B}},{"../../constants/numerical":763,"../../lib":787,"./constants":1206}],1217:[function(h,N,H){N.exports=function(t,m,g){g("line.shape")==="spline"&&g("line.smoothing")}},{}],1218:[function(h,N,H){var t={tonextx:1,tonexty:1,tonext:1};N.exports=function(m,g,p){var e,f,u,i,s,o={},a=!1,c=-1,r=0,n=-1;for(f=0;f<p.length;f++)(u=(e=p[f][0].trace).stackgroup||"")?u in o?s=o[u]:(s=o[u]=r,r++):e.fill in t&&n>=0?s=n:(s=n=r,r++),s<c&&(a=!0),e._groupIndex=c=s;var d=p.slice();a&&d.sort(function(y,v){var _=y[0].trace,x=v[0].trace;return _._groupIndex-x._groupIndex||_.index-x.index});var l={};for(f=0;f<d.length;f++)u=(e=d[f][0].trace).stackgroup||"",e.visible===!0?(e._nexttrace=null,e.fill in t&&(i=l[u],e._prevtrace=i||null,i&&(i._nexttrace=e)),e._ownfill=e.fill&&(e.fill.substr(0,6)==="tozero"||e.fill==="toself"||e.fill.substr(0,2)==="to"&&!e._prevtrace),l[u]=e):e._prevtrace=e._nexttrace=e._ownfill=null;return d}},{}],1219:[function(h,N,H){var t=h("fast-isnumeric");N.exports=function(m,g){g||(g=2);var p=m.marker,e=p.sizeref||1,f=p.sizemin||0,u=p.sizemode==="area"?function(i){return Math.sqrt(i/e)}:function(i){return i/e};return function(i){var s=u(i/g);return t(s)&&s>0?Math.max(s,f):0}}},{"fast-isnumeric":246}],1220:[function(h,N,H){N.exports={container:"marker",min:"cmin",max:"cmax"}},{}],1221:[function(h,N,H){var t=h("../../components/color"),m=h("../../components/colorscale/helpers").hasColorscale,g=h("../../components/colorscale/defaults"),p=h("./subtypes");N.exports=function(e,f,u,i,s,o){var a=p.isBubble(e),c=(e.line||{}).color;o=o||{},c&&(u=c),s("marker.symbol"),s("marker.opacity",a?.7:1),s("marker.size"),s("marker.color",u),m(e,"marker")&&g(e,f,i,s,{prefix:"marker.",cLetter:"c"}),o.noSelect||(s("selected.marker.color"),s("unselected.marker.color"),s("selected.marker.size"),s("unselected.marker.size")),o.noLine||(s("marker.line.color",c&&!Array.isArray(c)&&f.marker.color!==c?c:a?t.background:t.defaultLine),m(e,"marker.line")&&g(e,f,i,s,{prefix:"marker.line.",cLetter:"c"}),s("marker.line.width",a?1:0)),a&&(s("marker.sizeref"),s("marker.sizemin"),s("marker.sizemode")),o.gradient&&s("marker.gradient.type")!=="none"&&s("marker.gradient.color")}},{"../../components/color":650,"../../components/colorscale/defaults":660,"../../components/colorscale/helpers":661,"./subtypes":1227}],1222:[function(h,N,H){var t=h("../../lib").dateTick0,m=h("../../constants/numerical").ONEWEEK;function g(p,e){return t(e,p%m==0?1:0)}N.exports=function(p,e,f,u,i){if(i||(i={x:!0,y:!0}),i.x){var s=u("xperiod");s&&(u("xperiod0",g(s,e.xcalendar)),u("xperiodalignment"))}if(i.y){var o=u("yperiod");o&&(u("yperiod0",g(o,e.ycalendar)),u("yperiodalignment"))}}},{"../../constants/numerical":763,"../../lib":787}],1223:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../registry"),g=h("../../lib"),p=g.ensureSingle,e=g.identity,f=h("../../components/drawing"),u=h("./subtypes"),i=h("./line_points"),s=h("./link_traces"),o=h("../../lib/polygon").tester;function a(c,r,n,d,l,y,v){var _;(function(me,we,Me,Se,De){var Fe=Me.xaxis,Ye=Me.yaxis,et=t.extent(g.simpleMap(Fe.range,Fe.r2c)),Oe=t.extent(g.simpleMap(Ye.range,Ye.r2c)),je=Se[0].trace;if(!!u.hasMarkers(je)){var We=je.marker.maxdisplayed;if(We!==0){var Ge=Se.filter(function(Lt){return Lt.x>=et[0]&&Lt.x<=et[1]&&Lt.y>=Oe[0]&&Lt.y<=Oe[1]}),Qe=Math.ceil(Ge.length/We),it=0;De.forEach(function(Lt,wt){var rt=Lt[0].trace;u.hasMarkers(rt)&&rt.marker.maxdisplayed>0&&wt<we&&it++});var lt=Math.round(it*Qe/3+Math.floor(it/3)*Qe/7.1);Se.forEach(function(Lt){delete Lt.vis}),Ge.forEach(function(Lt,wt){Math.round((wt+lt)%Qe)===0&&(Lt.vis=!0)})}}})(0,r,n,d,l);var x=!!v&&v.duration>0;function T(me){return x?me.transition():me}var A=n.xaxis,S=n.yaxis,w=d[0].trace,L=w.line,k=t.select(y),C=p(k,"g","errorbars"),M=p(k,"g","lines"),P=p(k,"g","points"),O=p(k,"g","text");if(m.getComponentMethod("errorbars","plot")(c,C,n,v),w.visible===!0){var F,j;T(k).style("opacity",w.opacity);var W=w.fill.charAt(w.fill.length-1);W!=="x"&&W!=="y"&&(W=""),d[0][n.isRangePlot?"nodeRangePlot3":"node3"]=k;var Z,Q,X="",G=[],Y=w._prevtrace;Y&&(X=Y._prevRevpath||"",j=Y._nextFill,G=Y._polygons);var K,D,B,q,ee,J,$,te="",ie="",ae=[],he=g.noop;if(F=w._ownFill,u.hasLines(w)||w.fill!=="none"){for(j&&j.datum(d),["hv","vh","hvh","vhv"].indexOf(L.shape)!==-1?(K=f.steps(L.shape),D=f.steps(L.shape.split("").reverse().join(""))):K=D=L.shape==="spline"?function(me){var we=me[me.length-1];return me.length>1&&me[0][0]===we[0]&&me[0][1]===we[1]?f.smoothclosed(me.slice(1),L.smoothing):f.smoothopen(me,L.smoothing)}:function(me){return"M"+me.join("L")},B=function(me){return D(me.reverse())},ae=i(d,{xaxis:A,yaxis:S,connectGaps:w.connectgaps,baseTolerance:Math.max(L.width||1,3)/4,shape:L.shape,simplify:L.simplify,fill:w.fill}),$=w._polygons=new Array(ae.length),_=0;_<ae.length;_++)w._polygons[_]=o(ae[_]);ae.length&&(q=ae[0][0],J=(ee=ae[ae.length-1])[ee.length-1]),he=function(me){return function(we){if(Z=K(we),Q=B(we),te?W?(te+="L"+Z.substr(1),ie=Q+"L"+ie.substr(1)):(te+="Z"+Z,ie=Q+"Z"+ie):(te=Z,ie=Q),u.hasLines(w)&&we.length>1){var Me=t.select(this);if(Me.datum(d),me)T(Me.style("opacity",0).attr("d",Z).call(f.lineGroupStyle)).style("opacity",1);else{var Se=T(Me);Se.attr("d",Z),f.singleLineStyle(d,Se)}}}}}var se=M.selectAll(".js-line").data(ae);T(se.exit()).style("opacity",0).remove(),se.each(he(!1)),se.enter().append("path").classed("js-line",!0).style("vector-effect","non-scaling-stroke").call(f.lineGroupStyle).each(he(!0)),f.setClipUrl(se,n.layerClipId,c),ae.length?(F?(F.datum(d),q&&J&&(W?(W==="y"?q[1]=J[1]=S.c2p(0,!0):W==="x"&&(q[0]=J[0]=A.c2p(0,!0)),T(F).attr("d","M"+J+"L"+q+"L"+te.substr(1)).call(f.singleFillStyle)):T(F).attr("d",te+"Z").call(f.singleFillStyle))):j&&(w.fill.substr(0,6)==="tonext"&&te&&X?(w.fill==="tonext"?T(j).attr("d",te+"Z"+X+"Z").call(f.singleFillStyle):T(j).attr("d",te+"L"+X.substr(1)+"Z").call(f.singleFillStyle),w._polygons=w._polygons.concat(G)):(ce(j),w._polygons=null)),w._prevRevpath=ie,w._prevPolygons=$):(F?ce(F):j&&ce(j),w._polygons=w._prevRevpath=w._prevPolygons=null),P.datum(d),O.datum(d),function(me,we,Me){var Se,De=Me[0].trace,Fe=u.hasMarkers(De),Ye=u.hasText(De),et=xe(De),Oe=ue,je=ue;if(Fe||Ye){var We=e,Ge=De.stackgroup,Qe=Ge&&c._fullLayout._scatterStackOpts[A._id+S._id][Ge].stackgaps==="infer zero";De.marker.maxdisplayed||De._needsCull?We=Qe?ke:ve:Ge&&!Qe&&(We=Ee),Fe&&(Oe=We),Ye&&(je=We)}var it,lt=(Se=me.selectAll("path.point").data(Oe,et)).enter().append("path").classed("point",!0);x&&lt.call(f.pointStyle,De,c).call(f.translatePoints,A,S).style("opacity",0).transition().style("opacity",1),Se.order(),Fe&&(it=f.makePointStyleFns(De)),Se.each(function(Lt){var wt=t.select(this),rt=T(wt);f.translatePoint(Lt,rt,A,S)?(f.singlePointStyle(Lt,rt,De,it,c),n.layerClipId&&f.hideOutsideRangePoint(Lt,rt,A,S,De.xcalendar,De.ycalendar),De.customdata&&wt.classed("plotly-customdata",Lt.data!==null&&Lt.data!==void 0)):rt.remove()}),x?Se.exit().transition().style("opacity",0).remove():Se.exit().remove(),(Se=we.selectAll("g").data(je,et)).enter().append("g").classed("textpoint",!0).append("text"),Se.order(),Se.each(function(Lt){var wt=t.select(this),rt=T(wt.select("text"));f.translatePoint(Lt,rt,A,S)?n.layerClipId&&f.hideOutsideRangePoint(Lt,wt,A,S,De.xcalendar,De.ycalendar):wt.remove()}),Se.selectAll("text").call(f.textPointStyle,De,c).each(function(Lt){var wt=A.c2p(Lt.x),rt=S.c2p(Lt.y);t.select(this).selectAll("tspan.line").each(function(){T(t.select(this)).attr({x:wt,y:rt})})}),Se.exit().remove()}(P,O,d);var de=w.cliponaxis===!1?null:n.layerClipId;f.setClipUrl(P,de,c),f.setClipUrl(O,de,c)}function ce(me){T(me).attr("d","M0,0Z")}function ve(me){return me.filter(function(we){return!we.gap&&we.vis})}function ke(me){return me.filter(function(we){return we.vis})}function Ee(me){return me.filter(function(we){return!we.gap})}function be(me){return me.id}function xe(me){if(me.ids)return be}function ue(){return!1}}N.exports=function(c,r,n,d,l,y){var v,_,x=!l,T=!!l&&l.duration>0,A=s(c,r,n);(v=d.selectAll("g.trace").data(A,function(S){return S[0].trace.uid})).enter().append("g").attr("class",function(S){return"trace scatter trace"+S[0].trace.uid}).style("stroke-miterlimit",2),v.order(),function(S,w,L){w.each(function(k){var C=p(t.select(this),"g","fills");f.setClipUrl(C,L.layerClipId,S);var M=k[0].trace,P=[];M._ownfill&&P.push("_ownFill"),M._nexttrace&&P.push("_nextFill");var O=C.selectAll("g").data(P,e);O.enter().append("g"),O.exit().each(function(F){M[F]=null}).remove(),O.order().each(function(F){M[F]=p(t.select(this),"path","js-fill")})})}(c,v,r),T?(y&&(_=y()),t.transition().duration(l.duration).ease(l.easing).each("end",function(){_&&_()}).each("interrupt",function(){_&&_()}).each(function(){d.selectAll("g.trace").each(function(S,w){a(c,w,r,S,A,this,l)})})):v.each(function(S,w){a(c,w,r,S,A,this,l)}),x&&v.exit().remove(),d.selectAll("path:not([d])").remove()}},{"../../components/drawing":672,"../../lib":787,"../../lib/polygon":799,"../../registry":915,"./line_points":1216,"./link_traces":1218,"./subtypes":1227,"@plotly/d3":58}],1224:[function(h,N,H){var t=h("./subtypes");N.exports=function(m,g){var p,e,f,u,i=m.cd,s=m.xaxis,o=m.yaxis,a=[],c=i[0].trace;if(!t.hasMarkers(c)&&!t.hasText(c))return[];if(g===!1)for(p=0;p<i.length;p++)i[p].selected=0;else for(p=0;p<i.length;p++)e=i[p],f=s.c2p(e.x),u=o.c2p(e.y),e.i!==null&&g.contains([f,u],!1,p,m)?(a.push({pointNumber:e.i,x:s.c2d(e.x),y:o.c2d(e.y)}),e.selected=1):e.selected=0;return a}},{"./subtypes":1227}],1225:[function(h,N,H){var t=["orientation","groupnorm","stackgaps"];N.exports=function(m,g,p,e){var f=p._scatterStackOpts,u=e("stackgroup");if(u){var i=g.xaxis+g.yaxis,s=f[i];s||(s=f[i]={});var o=s[u],a=!1;o?o.traces.push(g):(o=s[u]={traceIndices:[],traces:[g]},a=!0);for(var c={orientation:g.x&&!g.y?"h":"v"},r=0;r<t.length;r++){var n=t[r],d=n+"Found";if(!o[d]){var l=m[n]!==void 0,y=n==="orientation";if((l||a)&&(o[n]=e(n,c[n]),y&&(o.fillDflt=o[n]==="h"?"tonextx":"tonexty"),l&&(o[d]=!0,!a&&(delete o.traces[0][n],y))))for(var v=0;v<o.traces.length-1;v++){var _=o.traces[v];_._input.fill!==_.fill&&(_.fill=o.fillDflt)}}}return o}}},{}],1226:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../components/drawing"),g=h("../../registry");function p(f,u,i){m.pointStyle(f.selectAll("path.point"),u,i)}function e(f,u,i){m.textPointStyle(f.selectAll("text"),u,i)}N.exports={style:function(f){var u=t.select(f).selectAll("g.trace.scatter");u.style("opacity",function(i){return i[0].trace.opacity}),u.selectAll("g.points").each(function(i){p(t.select(this),i.trace||i[0].trace,f)}),u.selectAll("g.text").each(function(i){e(t.select(this),i.trace||i[0].trace,f)}),u.selectAll("g.trace path.js-line").call(m.lineGroupStyle),u.selectAll("g.trace path.js-fill").call(m.fillGroupStyle),g.getComponentMethod("errorbars","style")(u)},stylePoints:p,styleText:e,styleOnSelect:function(f,u,i){var s=u[0].trace;s.selectedpoints?(m.selectedPointStyle(i.selectAll("path.point"),s),m.selectedTextStyle(i.selectAll("text"),s)):(p(i,s,f),e(i,s,f))}}},{"../../components/drawing":672,"../../registry":915,"@plotly/d3":58}],1227:[function(h,N,H){var t=h("../../lib");N.exports={hasLines:function(m){return m.visible&&m.mode&&m.mode.indexOf("lines")!==-1},hasMarkers:function(m){return m.visible&&(m.mode&&m.mode.indexOf("markers")!==-1||m.type==="splom")},hasText:function(m){return m.visible&&m.mode&&m.mode.indexOf("text")!==-1},isBubble:function(m){return t.isPlainObject(m.marker)&&t.isArrayOrTypedArray(m.marker.size)}}},{"../../lib":787}],1228:[function(h,N,H){var t=h("../../lib");N.exports=function(m,g,p,e,f){f=f||{},e("textposition"),t.coerceFont(e,"textfont",p.font),f.noSelect||(e("selected.textfont.color"),e("unselected.textfont.color"))}},{"../../lib":787}],1229:[function(h,N,H){var t=h("../../lib"),m=h("../../registry");N.exports=function(g,p,e,f){var u,i=f("x"),s=f("y");if(m.getComponentMethod("calendars","handleTraceDefaults")(g,p,["x","y"],e),i){var o=t.minRowLength(i);s?u=Math.min(o,t.minRowLength(s)):(u=o,f("y0"),f("dy"))}else{if(!s)return 0;u=t.minRowLength(s),f("x0"),f("dx")}return p._length=u,u}},{"../../lib":787,"../../registry":915}],1230:[function(h,N,H){var t=h("../scatter/attributes"),m=h("../../components/colorscale/attributes"),g=h("../../plots/cartesian/axis_format_attributes").axisHoverFormat,p=h("../../plots/template_attributes").hovertemplateAttrs,e=h("../../plots/template_attributes").texttemplateAttrs,f=h("../../plots/attributes"),u=h("../../constants/gl3d_dashes"),i=h("../../constants/gl3d_markers"),s=h("../../lib/extend").extendFlat,o=h("../../plot_api/edit_types").overrideAll,a=h("../../lib/sort_object_keys"),c=t.line,r=t.marker,n=r.line,d=s({width:c.width,dash:{valType:"enumerated",values:a(u),dflt:"solid"}},m("line")),l=N.exports=o({x:t.x,y:t.y,z:{valType:"data_array"},text:s({},t.text,{}),texttemplate:e({},{}),hovertext:s({},t.hovertext,{}),hovertemplate:p(),xhoverformat:g("x"),yhoverformat:g("y"),zhoverformat:g("z"),mode:s({},t.mode,{dflt:"lines+markers"}),surfaceaxis:{valType:"enumerated",values:[-1,0,1,2],dflt:-1},surfacecolor:{valType:"color"},projection:{x:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}},y:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}},z:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}}},connectgaps:t.connectgaps,line:d,marker:s({symbol:{valType:"enumerated",values:a(i),dflt:"circle",arrayOk:!0},size:s({},r.size,{dflt:8}),sizeref:r.sizeref,sizemin:r.sizemin,sizemode:r.sizemode,opacity:s({},r.opacity,{arrayOk:!1}),colorbar:r.colorbar,line:s({width:s({},n.width,{arrayOk:!1})},m("marker.line"))},m("marker")),textposition:s({},t.textposition,{dflt:"top center"}),textfont:{color:t.textfont.color,size:t.textfont.size,family:s({},t.textfont.family,{arrayOk:!1})},hoverinfo:s({},f.hoverinfo)},"calc","nested");l.x.editType=l.y.editType=l.z.editType="calc+clearAxisTypes"},{"../../components/colorscale/attributes":657,"../../constants/gl3d_dashes":760,"../../constants/gl3d_markers":761,"../../lib/extend":777,"../../lib/sort_object_keys":810,"../../plot_api/edit_types":820,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../scatter/attributes":1202}],1231:[function(h,N,H){var t=h("../scatter/arrays_to_calcdata"),m=h("../scatter/colorscale_calc");N.exports=function(g,p){var e=[{x:!1,y:!1,trace:p,t:{}}];return t(e,p),m(g,p),e}},{"../scatter/arrays_to_calcdata":1201,"../scatter/colorscale_calc":1205}],1232:[function(h,N,H){var t=h("../../registry");function m(g,p,e,f){if(!p||!p.visible)return null;for(var u=t.getComponentMethod("errorbars","makeComputeError")(p),i=new Array(g.length),s=0;s<g.length;s++){var o=u(+g[s],s);if(f.type==="log"){var a=f.c2l(g[s]),c=g[s]-o[0],r=g[s]+o[1];if(i[s]=[(f.c2l(c,!0)-a)*e,(f.c2l(r,!0)-a)*e],c>0){var n=f.c2l(c);f._lowerLogErrorBound||(f._lowerLogErrorBound=n),f._lowerErrorBound=Math.min(f._lowerLogErrorBound,n)}}else i[s]=[-o[0]*e,o[1]*e]}return i}N.exports=function(g,p,e){var f=[m(g.x,g.error_x,p[0],e.xaxis),m(g.y,g.error_y,p[1],e.yaxis),m(g.z,g.error_z,p[2],e.zaxis)],u=function(r){for(var n=0;n<r.length;n++)if(r[n])return r[n].length;return 0}(f);if(u===0)return null;for(var i=new Array(u),s=0;s<u;s++){for(var o=[[0,0,0],[0,0,0]],a=0;a<3;a++)if(f[a])for(var c=0;c<2;c++)o[c][a]=f[a][s][c];i[s]=o}return i}},{"../../registry":915}],1233:[function(h,N,H){var t=h("gl-line3d"),m=h("gl-scatter3d"),g=h("gl-error3d"),p=h("gl-mesh3d"),e=h("delaunay-triangulate"),f=h("../../lib"),u=h("../../lib/str2rgbarray"),i=h("../../lib/gl_format_color").formatColor,s=h("../scatter/make_bubble_size_func"),o=h("../../constants/gl3d_dashes"),a=h("../../constants/gl3d_markers"),c=h("../../plots/cartesian/axes"),r=h("../../components/fx/helpers").appendArrayPointValue,n=h("./calc_errors");function d(L,k){this.scene=L,this.uid=k,this.linePlot=null,this.scatterPlot=null,this.errorBars=null,this.textMarkers=null,this.delaunayMesh=null,this.color=null,this.mode="",this.dataPoints=[],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.textLabels=null,this.data=null}var l=d.prototype;function y(L){return L==null?0:L.indexOf("left")>-1?-1:L.indexOf("right")>-1?1:0}function v(L){return L==null?0:L.indexOf("top")>-1?-1:L.indexOf("bottom")>-1?1:0}function _(L,k){return k(4*L)}function x(L){return a[L]}function T(L,k,C,M,P){var O=null;if(f.isArrayOrTypedArray(L)){O=[];for(var F=0;F<k;F++)L[F]===void 0?O[F]=M:O[F]=C(L[F],P)}else O=C(L,f.identity);return O}function A(L,k){var C,M,P,O,F,j,W=[],Z=L.fullSceneLayout,Q=L.dataScale,X=Z.xaxis,G=Z.yaxis,Y=Z.zaxis,K=k.marker,D=k.line,B=k.x||[],q=k.y||[],ee=k.z||[],J=B.length,$=k.xcalendar,te=k.ycalendar,ie=k.zcalendar;for(F=0;F<J;F++)C=X.d2l(B[F],0,$)*Q[0],M=G.d2l(q[F],0,te)*Q[1],P=Y.d2l(ee[F],0,ie)*Q[2],W[F]=[C,M,P];if(Array.isArray(k.text))j=k.text;else if(k.text!==void 0)for(j=new Array(J),F=0;F<J;F++)j[F]=k.text;function ae(Se,De){var Fe=Z[Se];return c.tickText(Fe,Fe.d2l(De),!0).text}var he=k.texttemplate;if(he){var se=L.fullLayout._d3locale,de=Array.isArray(he),ce=de?Math.min(he.length,J):J,ve=de?function(Se){return he[Se]}:function(){return he};for(j=new Array(ce),F=0;F<ce;F++){var ke={x:B[F],y:q[F],z:ee[F]},Ee={xLabel:ae("xaxis",B[F]),yLabel:ae("yaxis",q[F]),zLabel:ae("zaxis",ee[F])},be={};r(be,k,F);var xe=k._meta||{};j[F]=f.texttemplateString(ve(F),Ee,se,be,ke,xe)}}if(O={position:W,mode:k.mode,text:j},"line"in k&&(O.lineColor=i(D,1,J),O.lineWidth=D.width,O.lineDashes=D.dash),"marker"in k){var ue=s(k);O.scatterColor=i(K,1,J),O.scatterSize=T(K.size,J,_,20,ue),O.scatterMarker=T(K.symbol,J,x,"\u25CF"),O.scatterLineWidth=K.line.width,O.scatterLineColor=i(K.line,1,J),O.scatterAngle=0}"textposition"in k&&(O.textOffset=function(Se){var De=[0,0];if(Array.isArray(Se))for(var Fe=0;Fe<Se.length;Fe++)De[Fe]=[0,0],Se[Fe]&&(De[Fe][0]=y(Se[Fe]),De[Fe][1]=v(Se[Fe]));else De[0]=y(Se),De[1]=v(Se);return De}(k.textposition),O.textColor=i(k.textfont,1,J),O.textSize=T(k.textfont.size,J,f.identity,12),O.textFont=k.textfont.family,O.textAngle=0);var me=["x","y","z"];for(O.project=[!1,!1,!1],O.projectScale=[1,1,1],O.projectOpacity=[1,1,1],F=0;F<3;++F){var we=k.projection[me[F]];(O.project[F]=we.show)&&(O.projectOpacity[F]=we.opacity,O.projectScale[F]=we.scale)}O.errorBounds=n(k,Q,Z);var Me=function(Se){for(var De=[0,0,0],Fe=[[0,0,0],[0,0,0],[0,0,0]],Ye=[1,1,1],et=0;et<3;et++){var Oe=Se[et];Oe&&Oe.copy_zstyle!==!1&&Se[2].visible!==!1&&(Oe=Se[2]),Oe&&Oe.visible&&(De[et]=Oe.width/2,Fe[et]=u(Oe.color),Ye[et]=Oe.thickness)}return{capSize:De,color:Fe,lineWidth:Ye}}([k.error_x,k.error_y,k.error_z]);return O.errorColor=Me.color,O.errorLineWidth=Me.lineWidth,O.errorCapSize=Me.capSize,O.delaunayAxis=k.surfaceaxis,O.delaunayColor=u(k.surfacecolor),O}function S(L){if(f.isArrayOrTypedArray(L)){var k=L[0];return f.isArrayOrTypedArray(k)&&(L=k),"rgb("+L.slice(0,3).map(function(C){return Math.round(255*C)})+")"}return null}function w(L){return f.isArrayOrTypedArray(L)?L.length===4&&typeof L[0]=="number"?S(L):L.map(S):null}l.handlePick=function(L){if(L.object&&(L.object===this.linePlot||L.object===this.delaunayMesh||L.object===this.textMarkers||L.object===this.scatterPlot)){var k=L.index=L.data.index;return L.object.highlight&&L.object.highlight(null),this.scatterPlot&&(L.object=this.scatterPlot,this.scatterPlot.highlight(L.data)),L.textLabel="",this.textLabels&&(Array.isArray(this.textLabels)?(this.textLabels[k]||this.textLabels[k]===0)&&(L.textLabel=this.textLabels[k]):L.textLabel=this.textLabels),L.traceCoordinate=[this.data.x[k],this.data.y[k],this.data.z[k]],!0}},l.update=function(L){var k,C,M,P,O=this.scene.glplot.gl,F=o.solid;this.data=L;var j=A(this.scene,L);"mode"in j&&(this.mode=j.mode),"lineDashes"in j&&j.lineDashes in o&&(F=o[j.lineDashes]),this.color=w(j.scatterColor)||w(j.lineColor),this.dataPoints=j.position,k={gl:this.scene.glplot.gl,position:j.position,color:j.lineColor,lineWidth:j.lineWidth||1,dashes:F[0],dashScale:F[1],opacity:L.opacity,connectGaps:L.connectgaps},this.mode.indexOf("lines")!==-1?this.linePlot?this.linePlot.update(k):(this.linePlot=t(k),this.linePlot._trace=this,this.scene.glplot.add(this.linePlot)):this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose(),this.linePlot=null);var W=L.opacity;if(L.marker&&L.marker.opacity&&(W*=L.marker.opacity),C={gl:this.scene.glplot.gl,position:j.position,color:j.scatterColor,size:j.scatterSize,glyph:j.scatterMarker,opacity:W,orthographic:!0,lineWidth:j.scatterLineWidth,lineColor:j.scatterLineColor,project:j.project,projectScale:j.projectScale,projectOpacity:j.projectOpacity},this.mode.indexOf("markers")!==-1?this.scatterPlot?this.scatterPlot.update(C):(this.scatterPlot=m(C),this.scatterPlot._trace=this,this.scatterPlot.highlightScale=1,this.scene.glplot.add(this.scatterPlot)):this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose(),this.scatterPlot=null),P={gl:this.scene.glplot.gl,position:j.position,glyph:j.text,color:j.textColor,size:j.textSize,angle:j.textAngle,alignment:j.textOffset,font:j.textFont,orthographic:!0,lineWidth:0,project:!1,opacity:L.opacity},this.textLabels=L.hovertext||L.text,this.mode.indexOf("text")!==-1?this.textMarkers?this.textMarkers.update(P):(this.textMarkers=m(P),this.textMarkers._trace=this,this.textMarkers.highlightScale=1,this.scene.glplot.add(this.textMarkers)):this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose(),this.textMarkers=null),M={gl:this.scene.glplot.gl,position:j.position,color:j.errorColor,error:j.errorBounds,lineWidth:j.errorLineWidth,capSize:j.errorCapSize,opacity:L.opacity},this.errorBars?j.errorBounds?this.errorBars.update(M):(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose(),this.errorBars=null):j.errorBounds&&(this.errorBars=g(M),this.errorBars._trace=this,this.scene.glplot.add(this.errorBars)),j.delaunayAxis>=0){var Z=function(Q,X,G){var Y,K=(G+1)%3,D=(G+2)%3,B=[],q=[];for(Y=0;Y<Q.length;++Y){var ee=Q[Y];!isNaN(ee[K])&&isFinite(ee[K])&&!isNaN(ee[D])&&isFinite(ee[D])&&(B.push([ee[K],ee[D]]),q.push(Y))}var J=e(B);for(Y=0;Y<J.length;++Y)for(var $=J[Y],te=0;te<$.length;++te)$[te]=q[$[te]];return{positions:Q,cells:J,meshColor:X}}(j.position,j.delaunayColor,j.delaunayAxis);Z.opacity=L.opacity,this.delaunayMesh?this.delaunayMesh.update(Z):(Z.gl=O,this.delaunayMesh=p(Z),this.delaunayMesh._trace=this,this.scene.glplot.add(this.delaunayMesh))}else this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose(),this.delaunayMesh=null)},l.dispose=function(){this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose()),this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose()),this.errorBars&&(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose()),this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose()),this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose())},N.exports=function(L,k){var C=new d(L,k.uid);return C.update(k),C}},{"../../components/fx/helpers":686,"../../constants/gl3d_dashes":760,"../../constants/gl3d_markers":761,"../../lib":787,"../../lib/gl_format_color":783,"../../lib/str2rgbarray":812,"../../plots/cartesian/axes":838,"../scatter/make_bubble_size_func":1219,"./calc_errors":1232,"delaunay-triangulate":177,"gl-error3d":267,"gl-line3d":275,"gl-mesh3d":309,"gl-scatter3d":327}],1234:[function(h,N,H){var t=h("../../registry"),m=h("../../lib"),g=h("../scatter/subtypes"),p=h("../scatter/marker_defaults"),e=h("../scatter/line_defaults"),f=h("../scatter/text_defaults"),u=h("./attributes");N.exports=function(i,s,o,a){function c(_,x){return m.coerce(i,s,u,_,x)}if(function(_,x,T,A){var S=0,w=T("x"),L=T("y"),k=T("z");return t.getComponentMethod("calendars","handleTraceDefaults")(_,x,["x","y","z"],A),w&&L&&k&&(S=Math.min(w.length,L.length,k.length),x._length=x._xlength=x._ylength=x._zlength=S),S}(i,s,c,a)){c("text"),c("hovertext"),c("hovertemplate"),c("xhoverformat"),c("yhoverformat"),c("zhoverformat"),c("mode"),g.hasLines(s)&&(c("connectgaps"),e(i,s,o,a,c)),g.hasMarkers(s)&&p(i,s,o,a,c,{noSelect:!0}),g.hasText(s)&&(c("texttemplate"),f(i,s,a,c,{noSelect:!0}));var r=(s.line||{}).color,n=(s.marker||{}).color;c("surfaceaxis")>=0&&c("surfacecolor",r||n);for(var d=["x","y","z"],l=0;l<3;++l){var y="projection."+d[l];c(y+".show")&&(c(y+".opacity"),c(y+".scale"))}var v=t.getComponentMethod("errorbars","supplyDefaults");v(i,s,r||n||o,{axis:"z"}),v(i,s,r||n||o,{axis:"y",inherit:"z"}),v(i,s,r||n||o,{axis:"x",inherit:"z"})}else s.visible=!1}},{"../../lib":787,"../../registry":915,"../scatter/line_defaults":1215,"../scatter/marker_defaults":1221,"../scatter/subtypes":1227,"../scatter/text_defaults":1228,"./attributes":1230}],1235:[function(h,N,H){N.exports={plot:h("./convert"),attributes:h("./attributes"),markerSymbols:h("../../constants/gl3d_markers"),supplyDefaults:h("./defaults"),colorbar:[{container:"marker",min:"cmin",max:"cmax"},{container:"line",min:"cmin",max:"cmax"}],calc:h("./calc"),moduleType:"trace",name:"scatter3d",basePlotModule:h("../../plots/gl3d"),categories:["gl3d","symbols","showLegend","scatter-like"],meta:{}}},{"../../constants/gl3d_markers":761,"../../plots/gl3d":880,"./attributes":1230,"./calc":1231,"./convert":1233,"./defaults":1234}],1236:[function(h,N,H){var t=h("../scatter/attributes"),m=h("../../plots/attributes"),g=h("../../plots/template_attributes").hovertemplateAttrs,p=h("../../plots/template_attributes").texttemplateAttrs,e=h("../../components/colorscale/attributes"),f=h("../../lib/extend").extendFlat,u=t.marker,i=t.line,s=u.line;N.exports={carpet:{valType:"string",editType:"calc"},a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},mode:f({},t.mode,{dflt:"markers"}),text:f({},t.text,{}),texttemplate:p({editType:"plot"},{keys:["a","b","text"]}),hovertext:f({},t.hovertext,{}),line:{color:i.color,width:i.width,dash:i.dash,shape:f({},i.shape,{values:["linear","spline"]}),smoothing:i.smoothing,editType:"calc"},connectgaps:t.connectgaps,fill:f({},t.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:t.fillcolor,marker:f({symbol:u.symbol,opacity:u.opacity,maxdisplayed:u.maxdisplayed,size:u.size,sizeref:u.sizeref,sizemin:u.sizemin,sizemode:u.sizemode,line:f({width:s.width,editType:"calc"},e("marker.line")),gradient:u.gradient,editType:"calc"},e("marker")),textfont:t.textfont,textposition:t.textposition,selected:t.selected,unselected:t.unselected,hoverinfo:f({},m.hoverinfo,{flags:["a","b","text","name"]}),hoveron:t.hoveron,hovertemplate:g()}},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/template_attributes":910,"../scatter/attributes":1202}],1237:[function(h,N,H){var t=h("fast-isnumeric"),m=h("../scatter/colorscale_calc"),g=h("../scatter/arrays_to_calcdata"),p=h("../scatter/calc_selection"),e=h("../scatter/calc").calcMarkerSize,f=h("../carpet/lookup_carpetid");N.exports=function(u,i){var s=i._carpetTrace=f(u,i);if(s&&s.visible&&s.visible!=="legendonly"){var o;i.xaxis=s.xaxis,i.yaxis=s.yaxis;var a,c,r=i._length,n=new Array(r),d=!1;for(o=0;o<r;o++)if(a=i.a[o],c=i.b[o],t(a)&&t(c)){var l=s.ab2xy(+a,+c,!0),y=s.isVisible(+a,+c);y||(d=!0),n[o]={x:l[0],y:l[1],a,b:c,vis:y}}else n[o]={x:!1,y:!1};return i._needsCull=d,n[0].carpet=s,n[0].trace=i,e(i,r),m(u,i),g(n,i),p(n,i),n}}},{"../carpet/lookup_carpetid":985,"../scatter/arrays_to_calcdata":1201,"../scatter/calc":1203,"../scatter/calc_selection":1204,"../scatter/colorscale_calc":1205,"fast-isnumeric":246}],1238:[function(h,N,H){var t=h("../../lib"),m=h("../scatter/constants"),g=h("../scatter/subtypes"),p=h("../scatter/marker_defaults"),e=h("../scatter/line_defaults"),f=h("../scatter/line_shape_defaults"),u=h("../scatter/text_defaults"),i=h("../scatter/fillcolor_defaults"),s=h("./attributes");N.exports=function(o,a,c,r){function n(_,x){return t.coerce(o,a,s,_,x)}n("carpet"),a.xaxis="x",a.yaxis="y";var d=n("a"),l=n("b"),y=Math.min(d.length,l.length);if(y){a._length=y,n("text"),n("texttemplate"),n("hovertext"),n("mode",y<m.PTS_LINESONLY?"lines+markers":"lines"),g.hasLines(a)&&(e(o,a,c,r,n),f(o,a,n),n("connectgaps")),g.hasMarkers(a)&&p(o,a,c,r,n,{gradient:!0}),g.hasText(a)&&u(o,a,r,n);var v=[];(g.hasMarkers(a)||g.hasText(a))&&(n("marker.maxdisplayed"),v.push("points")),n("fill"),a.fill!=="none"&&(i(o,a,c,n),g.hasLines(a)||f(o,a,n)),a.fill!=="tonext"&&a.fill!=="toself"||v.push("fills"),n("hoveron",v.join("+")||"points")!=="fills"&&n("hovertemplate"),t.coerceSelectionMarkerOpacity(a,n)}else a.visible=!1}},{"../../lib":787,"../scatter/constants":1206,"../scatter/fillcolor_defaults":1210,"../scatter/line_defaults":1215,"../scatter/line_shape_defaults":1217,"../scatter/marker_defaults":1221,"../scatter/subtypes":1227,"../scatter/text_defaults":1228,"./attributes":1236}],1239:[function(h,N,H){N.exports=function(t,m,g,p,e){var f=p[e];return t.a=f.a,t.b=f.b,t.y=f.y,t}},{}],1240:[function(h,N,H){N.exports=function(t,m){var g={},p=m._carpet,e=p.ab2ij([t.a,t.b]),f=Math.floor(e[0]),u=e[0]-f,i=Math.floor(e[1]),s=e[1]-i,o=p.evalxy([],f,i,u,s);return g.yLabel=o[1].toFixed(3),g}},{}],1241:[function(h,N,H){var t=h("../scatter/hover"),m=h("../../lib").fillText;N.exports=function(g,p,e,f){var u=t(g,p,e,f);if(u&&u[0].index!==!1){var i=u[0];if(i.index===void 0){var s=1-i.y0/g.ya._length,o=g.xa._length,a=o*s/2,c=o-a;return i.x0=Math.max(Math.min(i.x0,c),a),i.x1=Math.max(Math.min(i.x1,c),a),u}var r=i.cd[i.index];i.a=r.a,i.b=r.b,i.xLabelVal=void 0,i.yLabelVal=void 0;var n=i.trace,d=n._carpet,l=n._module.formatLabels(r,n);i.yLabel=l.yLabel,delete i.text;var y=[];if(!n.hovertemplate){var v=(r.hi||n.hoverinfo).split("+");v.indexOf("all")!==-1&&(v=["a","b","text"]),v.indexOf("a")!==-1&&_(d.aaxis,r.a),v.indexOf("b")!==-1&&_(d.baxis,r.b),y.push("y: "+i.yLabel),v.indexOf("text")!==-1&&m(r,n,y),i.extraText=y.join("<br>")}return u}function _(x,T){var A;A=x.labelprefix&&x.labelprefix.length>0?x.labelprefix.replace(/ = $/,""):x._hovertitle,y.push(A+": "+T.toFixed(3)+x.labelsuffix)}}},{"../../lib":787,"../scatter/hover":1213}],1242:[function(h,N,H){N.exports={attributes:h("./attributes"),supplyDefaults:h("./defaults"),colorbar:h("../scatter/marker_colorbar"),formatLabels:h("./format_labels"),calc:h("./calc"),plot:h("./plot"),style:h("../scatter/style").style,styleOnSelect:h("../scatter/style").styleOnSelect,hoverPoints:h("./hover"),selectPoints:h("../scatter/select"),eventData:h("./event_data"),moduleType:"trace",name:"scattercarpet",basePlotModule:h("../../plots/cartesian"),categories:["svg","carpet","symbols","showLegend","carpetDependent","zoomScale"],meta:{}}},{"../../plots/cartesian":852,"../scatter/marker_colorbar":1220,"../scatter/select":1224,"../scatter/style":1226,"./attributes":1236,"./calc":1237,"./defaults":1238,"./event_data":1239,"./format_labels":1240,"./hover":1241,"./plot":1243}],1243:[function(h,N,H){var t=h("../scatter/plot"),m=h("../../plots/cartesian/axes"),g=h("../../components/drawing");N.exports=function(p,e,f,u){var i,s,o,a=f[0][0].carpet,c={xaxis:m.getFromId(p,a.xaxis||"x"),yaxis:m.getFromId(p,a.yaxis||"y"),plot:e.plot};for(t(p,c,f,u),i=0;i<f.length;i++)s=f[i][0].trace,o=u.selectAll("g.trace"+s.uid+" .js-line"),g.setClipUrl(o,f[i][0].carpet._clipPathId,p)}},{"../../components/drawing":672,"../../plots/cartesian/axes":838,"../scatter/plot":1223}],1244:[function(h,N,H){var t=h("../../plots/template_attributes").hovertemplateAttrs,m=h("../../plots/template_attributes").texttemplateAttrs,g=h("../scatter/attributes"),p=h("../../plots/attributes"),e=h("../../components/colorscale/attributes"),f=h("../../components/drawing/attributes").dash,u=h("../../lib/extend").extendFlat,i=h("../../plot_api/edit_types").overrideAll,s=g.marker,o=g.line,a=s.line;N.exports=i({lon:{valType:"data_array"},lat:{valType:"data_array"},locations:{valType:"data_array"},locationmode:{valType:"enumerated",values:["ISO-3","USA-states","country names","geojson-id"],dflt:"ISO-3"},geojson:{valType:"any",editType:"calc"},featureidkey:{valType:"string",editType:"calc",dflt:"id"},mode:u({},g.mode,{dflt:"markers"}),text:u({},g.text,{}),texttemplate:m({editType:"plot"},{keys:["lat","lon","location","text"]}),hovertext:u({},g.hovertext,{}),textfont:g.textfont,textposition:g.textposition,line:{color:o.color,width:o.width,dash:f},connectgaps:g.connectgaps,marker:u({symbol:s.symbol,opacity:s.opacity,size:s.size,sizeref:s.sizeref,sizemin:s.sizemin,sizemode:s.sizemode,colorbar:s.colorbar,line:u({width:a.width},e("marker.line")),gradient:s.gradient},e("marker")),fill:{valType:"enumerated",values:["none","toself"],dflt:"none"},fillcolor:g.fillcolor,selected:g.selected,unselected:g.unselected,hoverinfo:u({},p.hoverinfo,{flags:["lon","lat","location","text","name"]}),hovertemplate:t()},"calc","nested")},{"../../components/colorscale/attributes":657,"../../components/drawing/attributes":671,"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plots/attributes":834,"../../plots/template_attributes":910,"../scatter/attributes":1202}],1245:[function(h,N,H){var t=h("fast-isnumeric"),m=h("../../constants/numerical").BADNUM,g=h("../scatter/colorscale_calc"),p=h("../scatter/arrays_to_calcdata"),e=h("../scatter/calc_selection"),f=h("../../lib")._;function u(i){return i&&typeof i=="string"}N.exports=function(i,s){var o,a=Array.isArray(s.locations),c=a?s.locations.length:s._length,r=new Array(c);o=s.geojson?function(_){return u(_)||t(_)}:u;for(var n=0;n<c;n++){var d=r[n]={};if(a){var l=s.locations[n];d.loc=o(l)?l:null}else{var y=s.lon[n],v=s.lat[n];t(y)&&t(v)?d.lonlat=[+y,+v]:d.lonlat=[m,m]}}return p(r,s),g(i,s),e(r,s),c&&(r[0].t={labels:{lat:f(i,"lat:")+" ",lon:f(i,"lon:")+" "}}),r}},{"../../constants/numerical":763,"../../lib":787,"../scatter/arrays_to_calcdata":1201,"../scatter/calc_selection":1204,"../scatter/colorscale_calc":1205,"fast-isnumeric":246}],1246:[function(h,N,H){var t=h("../../lib"),m=h("../scatter/subtypes"),g=h("../scatter/marker_defaults"),p=h("../scatter/line_defaults"),e=h("../scatter/text_defaults"),f=h("../scatter/fillcolor_defaults"),u=h("./attributes");N.exports=function(i,s,o,a){function c(_,x){return t.coerce(i,s,u,_,x)}var r,n=c("locations");if(n&&n.length){var d,l=c("geojson");(typeof l=="string"&&l!==""||t.isPlainObject(l))&&(d="geojson-id"),c("locationmode",d)==="geojson-id"&&c("featureidkey"),r=n.length}else{var y=c("lon")||[],v=c("lat")||[];r=Math.min(y.length,v.length)}r?(s._length=r,c("text"),c("hovertext"),c("hovertemplate"),c("mode"),m.hasLines(s)&&(p(i,s,o,a,c),c("connectgaps")),m.hasMarkers(s)&&g(i,s,o,a,c,{gradient:!0}),m.hasText(s)&&(c("texttemplate"),e(i,s,a,c)),c("fill"),s.fill!=="none"&&f(i,s,o,c),t.coerceSelectionMarkerOpacity(s,c)):s.visible=!1}},{"../../lib":787,"../scatter/fillcolor_defaults":1210,"../scatter/line_defaults":1215,"../scatter/marker_defaults":1221,"../scatter/subtypes":1227,"../scatter/text_defaults":1228,"./attributes":1244}],1247:[function(h,N,H){N.exports=function(t,m,g,p,e){t.lon=m.lon,t.lat=m.lat,t.location=m.loc?m.loc:null;var f=p[e];return f.fIn&&f.fIn.properties&&(t.properties=f.fIn.properties),t}},{}],1248:[function(h,N,H){var t=h("../../plots/cartesian/axes");N.exports=function(m,g,p){var e={},f=p[g.geo]._subplot.mockAxis,u=m.lonlat;return e.lonLabel=t.tickText(f,f.c2l(u[0]),!0).text,e.latLabel=t.tickText(f,f.c2l(u[1]),!0).text,e}},{"../../plots/cartesian/axes":838}],1249:[function(h,N,H){var t=h("../../components/fx"),m=h("../../constants/numerical").BADNUM,g=h("../scatter/get_trace_color"),p=h("../../lib").fillText,e=h("./attributes");N.exports=function(f,u,i){var s=f.cd,o=s[0].trace,a=f.xa,c=f.ya,r=f.subplot,n=r.projection.isLonLatOverEdges,d=r.project;if(t.getClosest(s,function(A){var S=A.lonlat;if(S[0]===m||n(S))return 1/0;var w=d(S),L=d([u,i]),k=Math.abs(w[0]-L[0]),C=Math.abs(w[1]-L[1]),M=Math.max(3,A.mrc||0);return Math.max(Math.sqrt(k*k+C*C)-M,1-3/M)},f),f.index!==!1){var l=s[f.index],y=l.lonlat,v=[a.c2p(y),c.c2p(y)],_=l.mrc||1;f.x0=v[0]-_,f.x1=v[0]+_,f.y0=v[1]-_,f.y1=v[1]+_,f.loc=l.loc,f.lon=y[0],f.lat=y[1];var x={};x[o.geo]={_subplot:r};var T=o._module.formatLabels(l,o,x);return f.lonLabel=T.lonLabel,f.latLabel=T.latLabel,f.color=g(o,l),f.extraText=function(A,S,w,L){if(A.hovertemplate)return;var k=S.hi||A.hoverinfo,C=k==="all"?e.hoverinfo.flags:k.split("+"),M=C.indexOf("location")!==-1&&Array.isArray(A.locations),P=C.indexOf("lon")!==-1,O=C.indexOf("lat")!==-1,F=C.indexOf("text")!==-1,j=[];function W(Z){return Z+"\xB0"}return M?j.push(S.loc):P&&O?j.push("("+W(w.latLabel)+", "+W(w.lonLabel)+")"):P?j.push(L.lon+W(w.lonLabel)):O&&j.push(L.lat+W(w.latLabel)),F&&p(S,A,j),j.join("<br>")}(o,l,f,s[0].t.labels),f.hovertemplate=o.hovertemplate,[f]}}},{"../../components/fx":690,"../../constants/numerical":763,"../../lib":787,"../scatter/get_trace_color":1212,"./attributes":1244}],1250:[function(h,N,H){N.exports={attributes:h("./attributes"),supplyDefaults:h("./defaults"),colorbar:h("../scatter/marker_colorbar"),formatLabels:h("./format_labels"),calc:h("./calc"),calcGeoJSON:h("./plot").calcGeoJSON,plot:h("./plot").plot,style:h("./style"),styleOnSelect:h("../scatter/style").styleOnSelect,hoverPoints:h("./hover"),eventData:h("./event_data"),selectPoints:h("./select"),moduleType:"trace",name:"scattergeo",basePlotModule:h("../../plots/geo"),categories:["geo","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/geo":871,"../scatter/marker_colorbar":1220,"../scatter/style":1226,"./attributes":1244,"./calc":1245,"./defaults":1246,"./event_data":1247,"./format_labels":1248,"./hover":1249,"./plot":1251,"./select":1252,"./style":1253}],1251:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../lib"),g=h("../../lib/topojson_utils").getTopojsonFeatures,p=h("../../lib/geojson_utils"),e=h("../../lib/geo_location_utils"),f=h("../../plots/cartesian/autorange").findExtremes,u=h("../../constants/numerical").BADNUM,i=h("../scatter/calc").calcMarkerSize,s=h("../scatter/subtypes"),o=h("./style");N.exports={calcGeoJSON:function(a,c){var r,n,d=a[0].trace,l=c[d.geo],y=l._subplot,v=d._length;if(Array.isArray(d.locations)){var _=d.locationmode,x=_==="geojson-id"?e.extractTraceFeature(a):g(d,y.topojson);for(r=0;r<v;r++){n=a[r];var T=_==="geojson-id"?n.fOut:e.locationToFeature(_,n.loc,x);n.lonlat=T?T.properties.ct:[u,u]}}var A,S,w={padded:!0};if(l.fitbounds==="geojson"&&d.locationmode==="geojson-id"){var L=e.computeBbox(e.getTraceGeojson(d));A=[L[0],L[2]],S=[L[1],L[3]]}else{for(A=new Array(v),S=new Array(v),r=0;r<v;r++)n=a[r],A[r]=n.lonlat[0],S[r]=n.lonlat[1];w.ppad=i(d,v)}d._extremes.lon=f(l.lonaxis._ax,A,w),d._extremes.lat=f(l.lataxis._ax,S,w)},plot:function(a,c,r){var n=c.layers.frontplot.select(".scatterlayer"),d=m.makeTraceGroups(n,r,"trace scattergeo");function l(y,v){y.lonlat[0]===u&&t.select(v).remove()}d.selectAll("*").remove(),d.each(function(y){var v=t.select(this),_=y[0].trace;if(s.hasLines(_)||_.fill!=="none"){var x=p.calcTraceToLineCoords(y),T=_.fill!=="none"?p.makePolygon(x):p.makeLine(x);v.selectAll("path.js-line").data([{geojson:T,trace:_}]).enter().append("path").classed("js-line",!0).style("stroke-miterlimit",2)}s.hasMarkers(_)&&v.selectAll("path.point").data(m.identity).enter().append("path").classed("point",!0).each(function(A){l(A,this)}),s.hasText(_)&&v.selectAll("g").data(m.identity).enter().append("g").append("text").each(function(A){l(A,this)}),o(a,y)})}}},{"../../constants/numerical":763,"../../lib":787,"../../lib/geo_location_utils":780,"../../lib/geojson_utils":781,"../../lib/topojson_utils":816,"../../plots/cartesian/autorange":837,"../scatter/calc":1203,"../scatter/subtypes":1227,"./style":1253,"@plotly/d3":58}],1252:[function(h,N,H){var t=h("../scatter/subtypes"),m=h("../../constants/numerical").BADNUM;N.exports=function(g,p){var e,f,u,i,s,o=g.cd,a=g.xaxis,c=g.yaxis,r=[],n=o[0].trace;if(!t.hasMarkers(n)&&!t.hasText(n))return[];if(p===!1)for(s=0;s<o.length;s++)o[s].selected=0;else for(s=0;s<o.length;s++)(f=(e=o[s]).lonlat)[0]!==m&&(u=a.c2p(f),i=c.c2p(f),p.contains([u,i],null,s,g)?(r.push({pointNumber:s,lon:f[0],lat:f[1]}),e.selected=1):e.selected=0);return r}},{"../../constants/numerical":763,"../scatter/subtypes":1227}],1253:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../components/drawing"),g=h("../../components/color"),p=h("../scatter/style"),e=p.stylePoints,f=p.styleText;N.exports=function(u,i){i&&function(s,o){var a=o[0].trace,c=o[0].node3;c.style("opacity",o[0].trace.opacity),e(c,a,s),f(c,a,s),c.selectAll("path.js-line").style("fill","none").each(function(r){var n=t.select(this),d=r.trace,l=d.line||{};n.call(g.stroke,l.color).call(m.dashLine,l.dash||"",l.width||0),d.fill!=="none"&&n.call(g.fill,d.fillcolor)})}(u,i)}},{"../../components/color":650,"../../components/drawing":672,"../scatter/style":1226,"@plotly/d3":58}],1254:[function(h,N,H){var t=h("../../plots/attributes"),m=h("../scatter/attributes"),g=h("../../plots/cartesian/axis_format_attributes").axisHoverFormat,p=h("../../components/colorscale/attributes"),e=h("../../lib/sort_object_keys"),f=h("../../lib/extend").extendFlat,u=h("../../plot_api/edit_types").overrideAll,i=h("./constants").DASHES,s=m.line,o=m.marker,a=o.line,c=N.exports=u({x:m.x,x0:m.x0,dx:m.dx,y:m.y,y0:m.y0,dy:m.dy,xperiod:m.xperiod,yperiod:m.yperiod,xperiod0:m.xperiod0,yperiod0:m.yperiod0,xperiodalignment:m.xperiodalignment,yperiodalignment:m.yperiodalignment,xhoverformat:g("x"),yhoverformat:g("y"),text:m.text,hovertext:m.hovertext,textposition:m.textposition,textfont:m.textfont,mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"]},line:{color:s.color,width:s.width,shape:{valType:"enumerated",values:["linear","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},dash:{valType:"enumerated",values:e(i),dflt:"solid"}},marker:f({},p("marker"),{symbol:o.symbol,size:o.size,sizeref:o.sizeref,sizemin:o.sizemin,sizemode:o.sizemode,opacity:o.opacity,colorbar:o.colorbar,line:f({},p("marker.line"),{width:a.width})}),connectgaps:m.connectgaps,fill:f({},m.fill,{dflt:"none"}),fillcolor:m.fillcolor,selected:{marker:m.selected.marker,textfont:m.selected.textfont},unselected:{marker:m.unselected.marker,textfont:m.unselected.textfont},opacity:t.opacity},"calc","nested");c.x.editType=c.y.editType=c.x0.editType=c.y0.editType="calc+clearAxisTypes",c.hovertemplate=m.hovertemplate,c.texttemplate=m.texttemplate},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../lib/sort_object_keys":810,"../../plot_api/edit_types":820,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../scatter/attributes":1202,"./constants":1256}],1255:[function(h,N,H){var t=h("@plotly/point-cluster"),m=h("../../lib"),g=h("../../plots/cartesian/axis_ids"),p=h("../../plots/cartesian/autorange").findExtremes,e=h("../../plots/cartesian/align_period"),f=h("../scatter/calc"),u=f.calcMarkerSize,i=f.calcAxisExpansion,s=f.setFirstScatter,o=h("../scatter/colorscale_calc"),a=h("./convert"),c=h("./scene_update"),r=h("../../constants/numerical").BADNUM,n=h("./constants").TOO_MANY_POINTS;function d(l,y,v){var _=l._extremes[y._id],x=p(y,v._bnds,{padded:!0});_.min=_.min.concat(x.min),_.max=_.max.concat(x.max)}N.exports=function(l,y){var v,_=l._fullLayout,x=g.getFromId(l,y.xaxis),T=g.getFromId(l,y.yaxis),A=_._plots[y.xaxis+y.yaxis],S=y._length,w=S>=n,L=2*S,k={},C=x.makeCalcdata(y,"x"),M=T.makeCalcdata(y,"y"),P=e(y,x,"x",C),O=e(y,T,"y",M),F=P.vals,j=O.vals;y._x=F,y._y=j,y.xperiodalignment&&(y._origX=C,y._xStarts=P.starts,y._xEnds=P.ends),y.yperiodalignment&&(y._origY=M,y._yStarts=O.starts,y._yEnds=O.ends);var W=new Array(L),Z=new Array(S);for(v=0;v<S;v++)W[2*v]=F[v]===r?NaN:F[v],W[2*v+1]=j[v]===r?NaN:j[v],Z[v]=v;if(x.type==="log")for(v=0;v<L;v+=2)W[v]=x.c2l(W[v]);if(T.type==="log")for(v=1;v<L;v+=2)W[v]=T.c2l(W[v]);w&&x.type!=="log"&&T.type!=="log"?k.tree=t(W):k.ids=Z,o(l,y);var Q,X=function(Y,K,D,B,q,ee){var J=a.style(Y,D);if(J.marker&&(J.marker.positions=B),J.line&&B.length>1&&m.extendFlat(J.line,a.linePositions(Y,D,B)),J.errorX||J.errorY){var $=a.errorBarPositions(Y,D,B,q,ee);J.errorX&&m.extendFlat(J.errorX,$.x),J.errorY&&m.extendFlat(J.errorY,$.y)}return J.text&&(m.extendFlat(J.text,{positions:B},a.textPosition(Y,D,J.text,J.marker)),m.extendFlat(J.textSel,{positions:B},a.textPosition(Y,D,J.text,J.markerSel)),m.extendFlat(J.textUnsel,{positions:B},a.textPosition(Y,D,J.text,J.markerUnsel))),J}(l,0,y,W,F,j),G=c(l,A);return s(_,y),w?X.marker&&(Q=X.marker.sizeAvg||Math.max(X.marker.size,3)):Q=u(y,S),i(l,y,x,T,F,j,Q),X.errorX&&d(y,x,X.errorX),X.errorY&&d(y,T,X.errorY),X.fill&&!G.fill2d&&(G.fill2d=!0),X.marker&&!G.scatter2d&&(G.scatter2d=!0),X.line&&!G.line2d&&(G.line2d=!0),!X.errorX&&!X.errorY||G.error2d||(G.error2d=!0),X.text&&!G.glText&&(G.glText=!0),X.marker&&(X.marker.snap=S),G.lineOptions.push(X.line),G.errorXOptions.push(X.errorX),G.errorYOptions.push(X.errorY),G.fillOptions.push(X.fill),G.markerOptions.push(X.marker),G.markerSelectedOptions.push(X.markerSel),G.markerUnselectedOptions.push(X.markerUnsel),G.textOptions.push(X.text),G.textSelectedOptions.push(X.textSel),G.textUnselectedOptions.push(X.textUnsel),G.selectBatch.push([]),G.unselectBatch.push([]),k._scene=G,k.index=G.count,k.x=F,k.y=j,k.positions=W,G.count++,[{x:!1,y:!1,t:k,trace:y}]}},{"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/align_period":835,"../../plots/cartesian/autorange":837,"../../plots/cartesian/axis_ids":842,"../scatter/calc":1203,"../scatter/colorscale_calc":1205,"./constants":1256,"./convert":1257,"./scene_update":1265,"@plotly/point-cluster":59}],1256:[function(h,N,H){N.exports={TOO_MANY_POINTS:1e5,SYMBOL_SDF_SIZE:200,SYMBOL_SIZE:20,SYMBOL_STROKE:1,DOT_RE:/-dot/,OPEN_RE:/-open/,DASHES:{solid:[1],dot:[1,1],dash:[4,1],longdash:[8,1],dashdot:[4,1,1,1],longdashdot:[8,1,1,1]}}},{}],1257:[function(h,N,H){var t=h("fast-isnumeric"),m=h("svg-path-sdf"),g=h("color-normalize"),p=h("../../registry"),e=h("../../lib"),f=h("../../components/drawing"),u=h("../../plots/cartesian/axis_ids"),i=h("../../lib/gl_format_color").formatColor,s=h("../scatter/subtypes"),o=h("../scatter/make_bubble_size_func"),a=h("./helpers"),c=h("./constants"),r=h("../../constants/interactions").DESELECTDIM,n={start:1,left:1,end:-1,right:-1,middle:0,center:0,bottom:1,top:-1},d=h("../../components/fx/helpers").appendArrayPointValue;function l(C,M){var P,O=C._fullLayout,F=M._length,j=M.textfont,W=M.textposition,Z=Array.isArray(W)?W:[W],Q=j.color,X=j.size,G=j.family,Y={},K=C._context.plotGlPixelRatio,D=M.texttemplate;if(D){Y.text=[];var B=O._d3locale,q=Array.isArray(D),ee=q?Math.min(D.length,F):F,J=q?function(de){return D[de]}:function(){return D};for(P=0;P<ee;P++){var $={i:P},te=M._module.formatLabels($,M,O),ie={};d(ie,M,P);var ae=M._meta||{};Y.text.push(e.texttemplateString(J(P),te,B,ie,$,ae))}}else Array.isArray(M.text)&&M.text.length<F?Y.text=M.text.slice():Y.text=M.text;if(Array.isArray(Y.text))for(P=Y.text.length;P<F;P++)Y.text[P]="";for(Y.opacity=M.opacity,Y.font={},Y.align=[],Y.baseline=[],P=0;P<Z.length;P++){var he=Z[P].split(/\s+/);switch(he[1]){case"left":Y.align.push("right");break;case"right":Y.align.push("left");break;default:Y.align.push(he[1])}switch(he[0]){case"top":Y.baseline.push("bottom");break;case"bottom":Y.baseline.push("top");break;default:Y.baseline.push(he[0])}}if(Array.isArray(Q))for(Y.color=new Array(F),P=0;P<F;P++)Y.color[P]=Q[P];else Y.color=Q;if(e.isArrayOrTypedArray(X)||Array.isArray(G))for(Y.font=new Array(F),P=0;P<F;P++){var se=Y.font[P]={};se.size=(e.isTypedArray(X)?X[P]:Array.isArray(X)?t(X[P])?X[P]:0:X)*K,se.family=Array.isArray(G)?G[P]:G}else Y.font={size:X*K,family:G};return Y}function y(C){var M,P,O=C._length,F=C.marker,j={},W=e.isArrayOrTypedArray(F.symbol),Z=e.isArrayOrTypedArray(F.color),Q=e.isArrayOrTypedArray(F.line.color),X=e.isArrayOrTypedArray(F.opacity),G=e.isArrayOrTypedArray(F.size),Y=e.isArrayOrTypedArray(F.line.width);if(W||(P=a.isOpenSymbol(F.symbol)),W||Z||Q||X){j.colors=new Array(O),j.borderColors=new Array(O);var K=i(F,F.opacity,O),D=i(F.line,F.opacity,O);if(!Array.isArray(D[0])){var B=D;for(D=Array(O),M=0;M<O;M++)D[M]=B}if(!Array.isArray(K[0])){var q=K;for(K=Array(O),M=0;M<O;M++)K[M]=q}for(j.colors=K,j.borderColors=D,M=0;M<O;M++){if(W){var ee=F.symbol[M];P=a.isOpenSymbol(ee)}P&&(D[M]=K[M].slice(),K[M]=K[M].slice(),K[M][3]=0)}j.opacity=C.opacity}else P?(j.color=g(F.color,"uint8"),j.color[3]=0,j.borderColor=g(F.color,"uint8")):(j.color=g(F.color,"uint8"),j.borderColor=g(F.line.color,"uint8")),j.opacity=C.opacity*F.opacity;if(W)for(j.markers=new Array(O),M=0;M<O;M++)j.markers[M]=k(F.symbol[M]);else j.marker=k(F.symbol);var J,$=o(C,1);if(G||Y){var te,ie=j.sizes=new Array(O),ae=j.borderSizes=new Array(O),he=0;if(G){for(M=0;M<O;M++)ie[M]=$(F.size[M]),he+=ie[M];te=he/O}else for(J=$(F.size),M=0;M<O;M++)ie[M]=J;if(Y)for(M=0;M<O;M++)ae[M]=F.line.width[M];else for(J=F.line.width,M=0;M<O;M++)ae[M]=J;j.sizeAvg=te}else j.size=$(F&&F.size||10),j.borderSizes=$(F.line.width);return j}function v(C,M){var P=C.marker,O={};return M&&(M.marker&&M.marker.symbol?O=y(e.extendFlat({},P,M.marker)):M.marker&&(M.marker.size&&(O.size=M.marker.size),M.marker.color&&(O.colors=M.marker.color),M.marker.opacity!==void 0&&(O.opacity=M.marker.opacity))),O}function _(C,M,P){var O={};if(!P)return O;if(P.textfont){var F={opacity:1,text:M.text,texttemplate:M.texttemplate,textposition:M.textposition,textfont:e.extendFlat({},M.textfont)};P.textfont&&e.extendFlat(F.textfont,P.textfont),O=l(C,F)}return O}function x(C,M,P){var O={capSize:2*M.width*P,lineWidth:M.thickness*P,color:M.color};return M.copy_ystyle&&(O=C.error_y),O}var T=c.SYMBOL_SDF_SIZE,A=c.SYMBOL_SIZE,S=c.SYMBOL_STROKE,w={},L=f.symbolFuncs[0](.05*A);function k(C){if(C==="circle")return null;var M,P,O=f.symbolNumber(C),F=f.symbolFuncs[O%100],j=!!f.symbolNoDot[O%100],W=!!f.symbolNoFill[O%100],Z=a.isDotSymbol(C);return w[C]?w[C]:(M=Z&&!j?F(1.1*A)+L:F(A),P=m(M,{w:T,h:T,viewBox:[-A,-A,A,A],stroke:W?S:-S}),w[C]=P,P||null)}N.exports={style:function(C,M){var P,O={marker:void 0,markerSel:void 0,markerUnsel:void 0,line:void 0,fill:void 0,errorX:void 0,errorY:void 0,text:void 0,textSel:void 0,textUnsel:void 0},F=C._context.plotGlPixelRatio;if(M.visible!==!0)return O;if(s.hasText(M)&&(O.text=l(C,M),O.textSel=_(C,M,M.selected),O.textUnsel=_(C,M,M.unselected)),s.hasMarkers(M)&&(O.marker=y(M),O.markerSel=v(M,M.selected),O.markerUnsel=v(M,M.unselected),!M.unselected&&e.isArrayOrTypedArray(M.marker.opacity))){var j=M.marker.opacity;for(O.markerUnsel.opacity=new Array(j.length),P=0;P<j.length;P++)O.markerUnsel.opacity[P]=r*j[P]}if(s.hasLines(M)){O.line={overlay:!0,thickness:M.line.width*F,color:M.line.color,opacity:M.opacity};var W=(c.DASHES[M.line.dash]||[1]).slice();for(P=0;P<W.length;++P)W[P]*=M.line.width*F;O.line.dashes=W}return M.error_x&&M.error_x.visible&&(O.errorX=x(M,M.error_x,F)),M.error_y&&M.error_y.visible&&(O.errorY=x(M,M.error_y,F)),M.fill&&M.fill!=="none"&&(O.fill={closed:!0,fill:M.fillcolor,thickness:0}),O},markerStyle:y,markerSelection:v,linePositions:function(C,M,P){var O,F,j=P.length,W=j/2;if(s.hasLines(M)&&W)if(M.line.shape==="hv"){for(O=[],F=0;F<W-1;F++)isNaN(P[2*F])||isNaN(P[2*F+1])?O.push(NaN,NaN,NaN,NaN):(O.push(P[2*F],P[2*F+1]),isNaN(P[2*F+2])||isNaN(P[2*F+3])?O.push(NaN,NaN):O.push(P[2*F+2],P[2*F+1]));O.push(P[j-2],P[j-1])}else if(M.line.shape==="hvh"){for(O=[],F=0;F<W-1;F++)if(isNaN(P[2*F])||isNaN(P[2*F+1])||isNaN(P[2*F+2])||isNaN(P[2*F+3]))isNaN(P[2*F])||isNaN(P[2*F+1])?O.push(NaN,NaN):O.push(P[2*F],P[2*F+1]),O.push(NaN,NaN);else{var Z=(P[2*F]+P[2*F+2])/2;O.push(P[2*F],P[2*F+1],Z,P[2*F+1],Z,P[2*F+3])}O.push(P[j-2],P[j-1])}else if(M.line.shape==="vhv"){for(O=[],F=0;F<W-1;F++)if(isNaN(P[2*F])||isNaN(P[2*F+1])||isNaN(P[2*F+2])||isNaN(P[2*F+3]))isNaN(P[2*F])||isNaN(P[2*F+1])?O.push(NaN,NaN):O.push(P[2*F],P[2*F+1]),O.push(NaN,NaN);else{var Q=(P[2*F+1]+P[2*F+3])/2;O.push(P[2*F],P[2*F+1],P[2*F],Q,P[2*F+2],Q)}O.push(P[j-2],P[j-1])}else if(M.line.shape==="vh"){for(O=[],F=0;F<W-1;F++)isNaN(P[2*F])||isNaN(P[2*F+1])?O.push(NaN,NaN,NaN,NaN):(O.push(P[2*F],P[2*F+1]),isNaN(P[2*F+2])||isNaN(P[2*F+3])?O.push(NaN,NaN):O.push(P[2*F],P[2*F+3]));O.push(P[j-2],P[j-1])}else O=P;var X=!1;for(F=0;F<O.length;F++)if(isNaN(O[F])){X=!0;break}var G=X||O.length>c.TOO_MANY_POINTS||s.hasMarkers(M)?"rect":"round";if(X&&M.connectgaps){var Y=O[0],K=O[1];for(F=0;F<O.length;F+=2)isNaN(O[F])||isNaN(O[F+1])?(O[F]=Y,O[F+1]=K):(Y=O[F],K=O[F+1])}return{join:G,positions:O}},errorBarPositions:function(C,M,P,O,F){var j=p.getComponentMethod("errorbars","makeComputeError"),W=u.getFromId(C,M.xaxis),Z=u.getFromId(C,M.yaxis),Q=P.length/2,X={};function G(Y,K){var D=K._id.charAt(0),B=M["error_"+D];if(B&&B.visible&&(K.type==="linear"||K.type==="log")){for(var q=j(B),ee={x:0,y:1}[D],J={x:[0,1,2,3],y:[2,3,0,1]}[D],$=new Float64Array(4*Q),te=1/0,ie=-1/0,ae=0,he=0;ae<Q;ae++,he+=4){var se=Y[ae];if(t(se)){var de=P[2*ae+ee],ce=q(se,ae),ve=ce[0],ke=ce[1];if(t(ve)&&t(ke)){var Ee=se-ve,be=se+ke;$[he+J[0]]=de-K.c2l(Ee),$[he+J[1]]=K.c2l(be)-de,$[he+J[2]]=0,$[he+J[3]]=0,te=Math.min(te,se-ve),ie=Math.max(ie,se+ke)}}}X[D]={positions:P,errors:$,_bnds:[te,ie]}}}return G(O,W),G(F,Z),X},textPosition:function(C,M,P,O){var F,j=M._length,W={};if(s.hasMarkers(M)){var Z=P.font,Q=P.align,X=P.baseline;for(W.offset=new Array(j),F=0;F<j;F++){var G=O.sizes?O.sizes[F]:O.size,Y=Array.isArray(Z)?Z[F].size:Z.size,K=Array.isArray(Q)?Q.length>1?Q[F]:Q[0]:Q,D=Array.isArray(X)?X.length>1?X[F]:X[0]:X,B=n[K],q=n[D],ee=G?G/.8+1:0,J=-q*ee-.5*q;W.offset[F]=[B*ee/Y,J/Y]}}return W}}},{"../../components/drawing":672,"../../components/fx/helpers":686,"../../constants/interactions":762,"../../lib":787,"../../lib/gl_format_color":783,"../../plots/cartesian/axis_ids":842,"../../registry":915,"../scatter/make_bubble_size_func":1219,"../scatter/subtypes":1227,"./constants":1256,"./helpers":1261,"color-normalize":131,"fast-isnumeric":246,"svg-path-sdf":580}],1258:[function(h,N,H){var t=h("../../lib"),m=h("../../registry"),g=h("./helpers"),p=h("./attributes"),e=h("../scatter/constants"),f=h("../scatter/subtypes"),u=h("../scatter/xy_defaults"),i=h("../scatter/period_defaults"),s=h("../scatter/marker_defaults"),o=h("../scatter/line_defaults"),a=h("../scatter/fillcolor_defaults"),c=h("../scatter/text_defaults");N.exports=function(r,n,d,l){function y(L,k){return t.coerce(r,n,p,L,k)}var v=!!r.marker&&g.isOpenSymbol(r.marker.symbol),_=f.isBubble(r),x=u(r,n,l,y);if(x){i(r,n,l,y),y("xhoverformat"),y("yhoverformat");var T=x<e.PTS_LINESONLY?"lines+markers":"lines";y("text"),y("hovertext"),y("hovertemplate"),y("mode",T),f.hasLines(n)&&(y("connectgaps"),o(r,n,d,l,y),y("line.shape")),f.hasMarkers(n)&&(s(r,n,d,l,y),y("marker.line.width",v||_?1:0)),f.hasText(n)&&(y("texttemplate"),c(r,n,l,y));var A=(n.line||{}).color,S=(n.marker||{}).color;y("fill"),n.fill!=="none"&&a(r,n,d,y);var w=m.getComponentMethod("errorbars","supplyDefaults");w(r,n,A||S||d,{axis:"y"}),w(r,n,A||S||d,{axis:"x",inherit:"y"}),t.coerceSelectionMarkerOpacity(n,y)}else n.visible=!1}},{"../../lib":787,"../../registry":915,"../scatter/constants":1206,"../scatter/fillcolor_defaults":1210,"../scatter/line_defaults":1215,"../scatter/marker_defaults":1221,"../scatter/period_defaults":1222,"../scatter/subtypes":1227,"../scatter/text_defaults":1228,"../scatter/xy_defaults":1229,"./attributes":1254,"./helpers":1261}],1259:[function(h,N,H){var t=h("../../lib"),m=h("../../components/color"),g=h("../../constants/interactions").DESELECTDIM;N.exports={styleTextSelection:function(p){var e,f,u=p[0],i=u.trace,s=u.t,o=s._scene,a=s.index,c=o.selectBatch[a],r=o.unselectBatch[a],n=o.textOptions[a],d=o.textSelectedOptions[a]||{},l=o.textUnselectedOptions[a]||{},y=t.extendFlat({},n);if(c.length||r.length){var v=d.color,_=l.color,x=n.color,T=Array.isArray(x);for(y.color=new Array(i._length),e=0;e<c.length;e++)f=c[e],y.color[f]=v||(T?x[f]:x);for(e=0;e<r.length;e++){f=r[e];var A=T?x[f]:x;y.color[f]=_||(v?A:m.addOpacity(A,g))}}o.glText[a].update(y)}}},{"../../components/color":650,"../../constants/interactions":762,"../../lib":787}],1260:[function(h,N,H){var t=h("../scatter/format_labels");N.exports=function(m,g,p){var e=m.i;return"x"in m||(m.x=g._x[e]),"y"in m||(m.y=g._y[e]),t(m,g,p)}},{"../scatter/format_labels":1211}],1261:[function(h,N,H){var t=h("./constants");H.isOpenSymbol=function(m){return typeof m=="string"?t.OPEN_RE.test(m):m%200>100},H.isDotSymbol=function(m){return typeof m=="string"?t.DOT_RE.test(m):m>200}},{"./constants":1256}],1262:[function(h,N,H){var t=h("../../registry"),m=h("../../lib"),g=h("../scatter/get_trace_color");function p(e,f,u,i){var s=e.xa,o=e.ya,a=e.distance,c=e.dxy,r=e.index,n={pointNumber:r,x:f[r],y:u[r]};n.tx=Array.isArray(i.text)?i.text[r]:i.text,n.htx=Array.isArray(i.hovertext)?i.hovertext[r]:i.hovertext,n.data=Array.isArray(i.customdata)?i.customdata[r]:i.customdata,n.tp=Array.isArray(i.textposition)?i.textposition[r]:i.textposition;var d=i.textfont;d&&(n.ts=m.isArrayOrTypedArray(d.size)?d.size[r]:d.size,n.tc=Array.isArray(d.color)?d.color[r]:d.color,n.tf=Array.isArray(d.family)?d.family[r]:d.family);var l=i.marker;l&&(n.ms=m.isArrayOrTypedArray(l.size)?l.size[r]:l.size,n.mo=m.isArrayOrTypedArray(l.opacity)?l.opacity[r]:l.opacity,n.mx=m.isArrayOrTypedArray(l.symbol)?l.symbol[r]:l.symbol,n.mc=m.isArrayOrTypedArray(l.color)?l.color[r]:l.color);var y=l&&l.line;y&&(n.mlc=Array.isArray(y.color)?y.color[r]:y.color,n.mlw=m.isArrayOrTypedArray(y.width)?y.width[r]:y.width);var v=l&&l.gradient;v&&v.type!=="none"&&(n.mgt=Array.isArray(v.type)?v.type[r]:v.type,n.mgc=Array.isArray(v.color)?v.color[r]:v.color);var _=s.c2p(n.x,!0),x=o.c2p(n.y,!0),T=n.mrc||1,A=i.hoverlabel;A&&(n.hbg=Array.isArray(A.bgcolor)?A.bgcolor[r]:A.bgcolor,n.hbc=Array.isArray(A.bordercolor)?A.bordercolor[r]:A.bordercolor,n.hts=m.isArrayOrTypedArray(A.font.size)?A.font.size[r]:A.font.size,n.htc=Array.isArray(A.font.color)?A.font.color[r]:A.font.color,n.htf=Array.isArray(A.font.family)?A.font.family[r]:A.font.family,n.hnl=m.isArrayOrTypedArray(A.namelength)?A.namelength[r]:A.namelength);var S=i.hoverinfo;S&&(n.hi=Array.isArray(S)?S[r]:S);var w=i.hovertemplate;w&&(n.ht=Array.isArray(w)?w[r]:w);var L={};L[e.index]=n;var k=i._origX,C=i._origY,M=m.extendFlat({},e,{color:g(i,n),x0:_-T,x1:_+T,xLabelVal:k?k[r]:n.x,y0:x-T,y1:x+T,yLabelVal:C?C[r]:n.y,cd:L,distance:a,spikeDistance:c,hovertemplate:n.ht});return n.htx?M.text=n.htx:n.tx?M.text=n.tx:i.text&&(M.text=i.text),m.fillText(n,i,M),t.getComponentMethod("errorbars","hoverInfo")(n,i,M),M}N.exports={hoverPoints:function(e,f,u,i){var s,o,a,c,r,n,d,l,y,v,_=e.cd,x=_[0].t,T=_[0].trace,A=e.xa,S=e.ya,w=x.x,L=x.y,k=A.c2p(f),C=S.c2p(u),M=e.distance;if(x.tree){var P=A.p2c(k-M),O=A.p2c(k+M),F=S.p2c(C-M),j=S.p2c(C+M);s=i==="x"?x.tree.range(Math.min(P,O),Math.min(S._rl[0],S._rl[1]),Math.max(P,O),Math.max(S._rl[0],S._rl[1])):x.tree.range(Math.min(P,O),Math.min(F,j),Math.max(P,O),Math.max(F,j))}else s=x.ids;var W=M;if(i==="x"){var Z=!!T.xperiodalignment,Q=!!T.yperiodalignment;for(n=0;n<s.length;n++){if(c=w[o=s[n]],d=Math.abs(A.c2p(c)-k),Z){var X=A.c2p(T._xStarts[o]),G=A.c2p(T._xEnds[o]);d=k>=Math.min(X,G)&&k<=Math.max(X,G)?0:1/0}if(d<W){if(W=d,r=L[o],l=S.c2p(r)-C,Q){var Y=S.c2p(T._yStarts[o]),K=S.c2p(T._yEnds[o]);l=C>=Math.min(Y,K)&&C<=Math.max(Y,K)?0:1/0}v=Math.sqrt(d*d+l*l),a=s[n]}}}else for(n=s.length-1;n>-1;n--)c=w[o=s[n]],r=L[o],d=A.c2p(c)-k,l=S.c2p(r)-C,(y=Math.sqrt(d*d+l*l))<W&&(W=v=y,a=o);return e.index=a,e.distance=W,e.dxy=v,a===void 0?[e]:[p(e,w,L,T)]},calcHover:p}},{"../../lib":787,"../../registry":915,"../scatter/get_trace_color":1212}],1263:[function(h,N,H){var t=h("./hover");N.exports={moduleType:"trace",name:"scattergl",basePlotModule:h("../../plots/cartesian"),categories:["gl","regl","cartesian","symbols","errorBarsOK","showLegend","scatter-like"],attributes:h("./attributes"),supplyDefaults:h("./defaults"),crossTraceDefaults:h("../scatter/cross_trace_defaults"),colorbar:h("../scatter/marker_colorbar"),formatLabels:h("./format_labels"),calc:h("./calc"),plot:h("./plot"),hoverPoints:t.hoverPoints,selectPoints:h("./select"),meta:{}}},{"../../plots/cartesian":852,"../scatter/cross_trace_defaults":1208,"../scatter/marker_colorbar":1220,"./attributes":1254,"./calc":1255,"./defaults":1258,"./format_labels":1260,"./hover":1262,"./plot":1264,"./select":1266}],1264:[function(h,N,H){var t=h("regl-scatter2d"),m=h("regl-line2d"),g=h("regl-error2d"),p=h("gl-text"),e=h("../../lib"),f=h("../../components/dragelement/helpers").selectMode,u=h("../../lib/prepare_regl"),i=h("../scatter/subtypes"),s=h("../scatter/link_traces"),o=h("./edit_style").styleTextSelection;function a(c,r,n,d){var l=c._size,y=c.width*d,v=c.height*d,_=l.l*d,x=l.b*d,T=l.r*d,A=l.t*d,S=l.w*d,w=l.h*d;return[_+r.domain[0]*S,x+n.domain[0]*w,y-T-(1-r.domain[1])*S,v-A-(1-n.domain[1])*w]}N.exports=function(c,r,n){if(n.length){var d,l,y=c._fullLayout,v=r._scene,_=r.xaxis,x=r.yaxis;if(v)if(u(c,["ANGLE_instanced_arrays","OES_element_index_uint"])){var T=v.count,A=y._glcanvas.data()[0].regl;if(s(c,r,n),v.dirty){if(v.error2d===!0&&(v.error2d=g(A)),v.line2d===!0&&(v.line2d=m(A)),v.scatter2d===!0&&(v.scatter2d=t(A)),v.fill2d===!0&&(v.fill2d=m(A)),v.glText===!0)for(v.glText=new Array(T),d=0;d<T;d++)v.glText[d]=new p(A);if(v.glText){if(T>v.glText.length){var S=T-v.glText.length;for(d=0;d<S;d++)v.glText.push(new p(A))}else if(T<v.glText.length){var w=v.glText.length-T;v.glText.splice(T,w).forEach(function(J){J.destroy()})}for(d=0;d<T;d++)v.glText[d].update(v.textOptions[d])}if(v.line2d&&(v.line2d.update(v.lineOptions),v.lineOptions=v.lineOptions.map(function(J){if(J&&J.positions){for(var $=J.positions,te=0;te<$.length&&(isNaN($[te])||isNaN($[te+1]));)te+=2;for(var ie=$.length-2;ie>te&&(isNaN($[ie])||isNaN($[ie+1]));)ie-=2;J.positions=$.slice(te,ie+2)}return J}),v.line2d.update(v.lineOptions)),v.error2d){var L=(v.errorXOptions||[]).concat(v.errorYOptions||[]);v.error2d.update(L)}v.scatter2d&&v.scatter2d.update(v.markerOptions),v.fillOrder=e.repeat(null,T),v.fill2d&&(v.fillOptions=v.fillOptions.map(function(J,$){var te=n[$];if(J&&te&&te[0]&&te[0].trace){var ie,ae,he=te[0],se=he.trace,de=he.t,ce=v.lineOptions[$],ve=[];se._ownfill&&ve.push($),se._nexttrace&&ve.push($+1),ve.length&&(v.fillOrder[$]=ve);var ke,Ee,be=[],xe=ce&&ce.positions||de.positions;if(se.fill==="tozeroy"){for(ke=0;ke<xe.length&&isNaN(xe[ke+1]);)ke+=2;for(Ee=xe.length-2;Ee>ke&&isNaN(xe[Ee+1]);)Ee-=2;xe[ke+1]!==0&&(be=[xe[ke],0]),be=be.concat(xe.slice(ke,Ee+2)),xe[Ee+1]!==0&&(be=be.concat([xe[Ee],0]))}else if(se.fill==="tozerox"){for(ke=0;ke<xe.length&&isNaN(xe[ke]);)ke+=2;for(Ee=xe.length-2;Ee>ke&&isNaN(xe[Ee]);)Ee-=2;xe[ke]!==0&&(be=[0,xe[ke+1]]),be=be.concat(xe.slice(ke,Ee+2)),xe[Ee]!==0&&(be=be.concat([0,xe[Ee+1]]))}else if(se.fill==="toself"||se.fill==="tonext"){for(be=[],ie=0,J.splitNull=!0,ae=0;ae<xe.length;ae+=2)(isNaN(xe[ae])||isNaN(xe[ae+1]))&&((be=be.concat(xe.slice(ie,ae))).push(xe[ie],xe[ie+1]),be.push(null,null),ie=ae+2);be=be.concat(xe.slice(ie)),ie&&be.push(xe[ie],xe[ie+1])}else{var ue=se._nexttrace;if(ue){var me=v.lineOptions[$+1];if(me){var we=me.positions;if(se.fill==="tonexty"){for(be=xe.slice(),$=Math.floor(we.length/2);$--;){var Me=we[2*$],Se=we[2*$+1];isNaN(Me)||isNaN(Se)||be.push(Me,Se)}J.fill=ue.fillcolor}}}}if(se._prevtrace&&se._prevtrace.fill==="tonext"){var De=v.lineOptions[$-1].positions,Fe=be.length/2,Ye=[ie=Fe];for(ae=0;ae<De.length;ae+=2)(isNaN(De[ae])||isNaN(De[ae+1]))&&(Ye.push(ae/2+Fe+1),ie=ae+2);be=be.concat(De),J.hole=Ye}return J.fillmode=se.fill,J.opacity=se.opacity,J.positions=be,J}}),v.fill2d.update(v.fillOptions))}var k=y.dragmode,C=f(k),M=y.clickmode.indexOf("select")>-1;for(d=0;d<T;d++){var P=n[d][0],O=P.trace,F=P.t,j=F.index,W=O._length,Z=F.x,Q=F.y;if(O.selectedpoints||C||M){if(C||(C=!0),O.selectedpoints){var X=v.selectBatch[j]=e.selIndices2selPoints(O),G={};for(l=0;l<X.length;l++)G[X[l]]=1;var Y=[];for(l=0;l<W;l++)G[l]||Y.push(l);v.unselectBatch[j]=Y}var K=F.xpx=new Array(W),D=F.ypx=new Array(W);for(l=0;l<W;l++)K[l]=_.c2p(Z[l]),D[l]=x.c2p(Q[l])}else F.xpx=F.ypx=null}if(C){if(v.select2d||(v.select2d=t(y._glcanvas.data()[1].regl)),v.scatter2d){var B=new Array(T);for(d=0;d<T;d++)B[d]=v.selectBatch[d].length||v.unselectBatch[d].length?v.markerUnselectedOptions[d]:{};v.scatter2d.update(B)}v.select2d&&(v.select2d.update(v.markerOptions),v.select2d.update(v.markerSelectedOptions)),v.glText&&n.forEach(function(J){var $=((J||[])[0]||{}).trace||{};i.hasText($)&&o(J)})}else v.scatter2d&&v.scatter2d.update(v.markerOptions);var q={viewport:a(y,_,x,c._context.plotGlPixelRatio),range:[(_._rl||_.range)[0],(x._rl||x.range)[0],(_._rl||_.range)[1],(x._rl||x.range)[1]]},ee=e.repeat(q,v.count);v.fill2d&&v.fill2d.update(ee),v.line2d&&v.line2d.update(ee),v.error2d&&v.error2d.update(ee.concat(ee)),v.scatter2d&&v.scatter2d.update(ee),v.select2d&&v.select2d.update(ee),v.glText&&v.glText.forEach(function(J){J.update(q)})}else v.init()}}},{"../../components/dragelement/helpers":668,"../../lib":787,"../../lib/prepare_regl":800,"../scatter/link_traces":1218,"../scatter/subtypes":1227,"./edit_style":1259,"gl-text":347,"regl-error2d":522,"regl-line2d":523,"regl-scatter2d":524}],1265:[function(h,N,H){var t=h("../../lib");N.exports=function(m,g){var p=g._scene,e={count:0,dirty:!0,lineOptions:[],fillOptions:[],markerOptions:[],markerSelectedOptions:[],markerUnselectedOptions:[],errorXOptions:[],errorYOptions:[],textOptions:[],textSelectedOptions:[],textUnselectedOptions:[],selectBatch:[],unselectBatch:[]},f={fill2d:!1,scatter2d:!1,error2d:!1,line2d:!1,glText:!1,select2d:!1};return g._scene||((p=g._scene={}).init=function(){t.extendFlat(p,f,e)},p.init(),p.update=function(u){var i=t.repeat(u,p.count);if(p.fill2d&&p.fill2d.update(i),p.scatter2d&&p.scatter2d.update(i),p.line2d&&p.line2d.update(i),p.error2d&&p.error2d.update(i.concat(i)),p.select2d&&p.select2d.update(i),p.glText)for(var s=0;s<p.count;s++)p.glText[s].update(u)},p.draw=function(){for(var u=p.count,i=p.fill2d,s=p.error2d,o=p.line2d,a=p.scatter2d,c=p.glText,r=p.select2d,n=p.selectBatch,d=p.unselectBatch,l=0;l<u;l++){if(i&&p.fillOrder[l]&&i.draw(p.fillOrder[l]),o&&p.lineOptions[l]&&o.draw(l),s&&(p.errorXOptions[l]&&s.draw(l),p.errorYOptions[l]&&s.draw(l+u)),a&&p.markerOptions[l])if(d[l].length){var y=t.repeat([],p.count);y[l]=d[l],a.draw(y)}else n[l].length||a.draw(l);c[l]&&p.textOptions[l]&&c[l].render()}r&&r.draw(n),p.dirty=!1},p.destroy=function(){p.fill2d&&p.fill2d.destroy&&p.fill2d.destroy(),p.scatter2d&&p.scatter2d.destroy&&p.scatter2d.destroy(),p.error2d&&p.error2d.destroy&&p.error2d.destroy(),p.line2d&&p.line2d.destroy&&p.line2d.destroy(),p.select2d&&p.select2d.destroy&&p.select2d.destroy(),p.glText&&p.glText.forEach(function(u){u.destroy&&u.destroy()}),p.lineOptions=null,p.fillOptions=null,p.markerOptions=null,p.markerSelectedOptions=null,p.markerUnselectedOptions=null,p.errorXOptions=null,p.errorYOptions=null,p.textOptions=null,p.textSelectedOptions=null,p.textUnselectedOptions=null,p.selectBatch=null,p.unselectBatch=null,g._scene=null}),p.dirty||t.extendFlat(p,e),p}},{"../../lib":787}],1266:[function(h,N,H){var t=h("../scatter/subtypes"),m=h("./edit_style").styleTextSelection;N.exports=function(g,p){var e=g.cd,f=g.xaxis,u=g.yaxis,i=[],s=e[0].trace,o=e[0].t,a=s._length,c=o.x,r=o.y,n=o._scene,d=o.index;if(!n)return i;var l=t.hasText(s),y=t.hasMarkers(s),v=!y&&!l;if(s.visible!==!0||v)return i;var _=[],x=[];if(p!==!1&&!p.degenerate)for(var T=0;T<a;T++)p.contains([o.xpx[T],o.ypx[T]],!1,T,g)?(_.push(T),i.push({pointNumber:T,x:f.c2d(c[T]),y:u.c2d(r[T])})):x.push(T);if(y){var A=n.scatter2d;if(_.length||x.length){if(!n.selectBatch[d].length&&!n.unselectBatch[d].length){var S=new Array(n.count);S[d]=n.markerUnselectedOptions[d],A.update.apply(A,S)}}else{var w=new Array(n.count);w[d]=n.markerOptions[d],A.update.apply(A,w)}}return n.selectBatch[d]=_,n.unselectBatch[d]=x,l&&m(e),i}},{"../scatter/subtypes":1227,"./edit_style":1259}],1267:[function(h,N,H){var t=h("../../plots/template_attributes").hovertemplateAttrs,m=h("../../plots/template_attributes").texttemplateAttrs,g=h("../scattergeo/attributes"),p=h("../scatter/attributes"),e=h("../../plots/mapbox/layout_attributes"),f=h("../../plots/attributes"),u=h("../../components/colorscale/attributes"),i=h("../../lib/extend").extendFlat,s=h("../../plot_api/edit_types").overrideAll,o=g.line,a=g.marker;N.exports=s({lon:g.lon,lat:g.lat,mode:i({},p.mode,{dflt:"markers"}),text:i({},p.text,{}),texttemplate:m({editType:"plot"},{keys:["lat","lon","text"]}),hovertext:i({},p.hovertext,{}),line:{color:o.color,width:o.width},connectgaps:p.connectgaps,marker:i({symbol:{valType:"string",dflt:"circle",arrayOk:!0},angle:{valType:"number",dflt:"auto",arrayOk:!0},allowoverlap:{valType:"boolean",dflt:!1},opacity:a.opacity,size:a.size,sizeref:a.sizeref,sizemin:a.sizemin,sizemode:a.sizemode},u("marker")),fill:g.fill,fillcolor:p.fillcolor,textfont:e.layers.symbol.textfont,textposition:e.layers.symbol.textposition,below:{valType:"string"},selected:{marker:p.selected.marker},unselected:{marker:p.unselected.marker},hoverinfo:i({},f.hoverinfo,{flags:["lon","lat","text","name"]}),hovertemplate:t()},"calc","nested")},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plots/attributes":834,"../../plots/mapbox/layout_attributes":897,"../../plots/template_attributes":910,"../scatter/attributes":1202,"../scattergeo/attributes":1244}],1268:[function(h,N,H){var t=h("fast-isnumeric"),m=h("../../lib"),g=h("../../constants/numerical").BADNUM,p=h("../../lib/geojson_utils"),e=h("../../components/colorscale"),f=h("../../components/drawing"),u=h("../scatter/make_bubble_size_func"),i=h("../scatter/subtypes"),s=h("../../plots/mapbox/convert_text_opts"),o=h("../../components/fx/helpers").appendArrayPointValue,a=h("../../lib/svg_text_utils").NEWLINES,c=h("../../lib/svg_text_utils").BR_TAG_ALL;function r(){return{geojson:p.makeBlank(),layout:{visibility:"none"},paint:{}}}function n(y,v){return m.isArrayOrTypedArray(y)?v?function(_){return t(y[_])?+y[_]:0}:function(_){return y[_]}:y?function(){return y}:d}function d(){return""}function l(y){return y[0]===g}N.exports=function(y,v){var _,x=v[0].trace,T=x.visible===!0&&x._length!==0,A=x.fill!=="none",S=i.hasLines(x),w=i.hasMarkers(x),L=i.hasText(x),k=w&&x.marker.symbol==="circle",C=w&&x.marker.symbol!=="circle",M=r(),P=r(),O=r(),F=r(),j={fill:M,line:P,circle:O,symbol:F};if(!T)return j;if((A||S)&&(_=p.calcTraceToLineCoords(v)),A&&(M.geojson=p.makePolygon(_),M.layout.visibility="visible",m.extendFlat(M.paint,{"fill-color":x.fillcolor})),S&&(P.geojson=p.makeLine(_),P.layout.visibility="visible",m.extendFlat(P.paint,{"line-width":x.line.width,"line-color":x.line.color,"line-opacity":x.opacity})),k){var W=function(X){var G,Y,K,D,B=X[0].trace,q=B.marker,ee=B.selectedpoints,J=m.isArrayOrTypedArray(q.color),$=m.isArrayOrTypedArray(q.size),te=m.isArrayOrTypedArray(q.opacity);function ie(Ee){return B.opacity*Ee}J&&(Y=e.hasColorscale(B,"marker")?e.makeColorScaleFuncFromTrace(q):m.identity),$&&(K=u(B)),te&&(D=function(Ee){return ie(t(Ee)?+m.constrain(Ee,0,1):0)});var ae,he=[];for(G=0;G<X.length;G++){var se=X[G],de=se.lonlat;if(!l(de)){var ce={};Y&&(ce.mcc=se.mcc=Y(se.mc)),K&&(ce.mrc=se.mrc=K(se.ms)),D&&(ce.mo=D(se.mo)),ee&&(ce.selected=se.selected||0),he.push({type:"Feature",geometry:{type:"Point",coordinates:de},properties:ce})}}if(ee)for(ae=f.makeSelectedPointStyleFns(B),G=0;G<he.length;G++){var ve=he[G].properties;ae.selectedOpacityFn&&(ve.mo=ie(ae.selectedOpacityFn(ve))),ae.selectedColorFn&&(ve.mcc=ae.selectedColorFn(ve)),ae.selectedSizeFn&&(ve.mrc=ae.selectedSizeFn(ve))}return{geojson:{type:"FeatureCollection",features:he},mcc:J||ae&&ae.selectedColorFn?{type:"identity",property:"mcc"}:q.color,mrc:$||ae&&ae.selectedSizeFn?{type:"identity",property:"mrc"}:(ke=q.size,ke/2),mo:te||ae&&ae.selectedOpacityFn?{type:"identity",property:"mo"}:ie(q.opacity)};var ke}(v);O.geojson=W.geojson,O.layout.visibility="visible",m.extendFlat(O.paint,{"circle-color":W.mcc,"circle-radius":W.mrc,"circle-opacity":W.mo})}if((C||L)&&(F.geojson=function(X,G){for(var Y=G._fullLayout,K=X[0].trace,D=K.marker||{},B=D.symbol,q=D.angle,ee=B!=="circle"?n(B):d,J=q!=="auto"?n(q,!0):d,$=i.hasText(K)?n(K.text):d,te=[],ie=0;ie<X.length;ie++){var ae=X[ie];if(!l(ae.lonlat)){var he,se=K.texttemplate;if(se){var de=Array.isArray(se)?se[ie]||"":se,ce=K._module.formatLabels(ae,K,Y),ve={};o(ve,K,ae.i);var ke=K._meta||{};he=m.texttemplateString(de,ce,Y._d3locale,ve,ae,ke)}else he=$(ie);he&&(he=he.replace(a,"").replace(c,`
`)),te.push({type:"Feature",geometry:{type:"Point",coordinates:ae.lonlat},properties:{symbol:ee(ie),angle:J(ie),text:he}})}}return{type:"FeatureCollection",features:te}}(v,y),m.extendFlat(F.layout,{visibility:"visible","icon-image":"{symbol}-15","text-field":"{text}"}),C&&(m.extendFlat(F.layout,{"icon-size":x.marker.size/10}),"angle"in x.marker&&x.marker.angle!=="auto"&&m.extendFlat(F.layout,{"icon-rotate":{type:"identity",property:"angle"},"icon-rotation-alignment":"map"}),F.layout["icon-allow-overlap"]=x.marker.allowoverlap,m.extendFlat(F.paint,{"icon-opacity":x.opacity*x.marker.opacity,"icon-color":x.marker.color})),L)){var Z=(x.marker||{}).size,Q=s(x.textposition,Z);m.extendFlat(F.layout,{"text-size":x.textfont.size,"text-anchor":Q.anchor,"text-offset":Q.offset}),m.extendFlat(F.paint,{"text-color":x.textfont.color,"text-opacity":x.opacity})}return j}},{"../../components/colorscale":662,"../../components/drawing":672,"../../components/fx/helpers":686,"../../constants/numerical":763,"../../lib":787,"../../lib/geojson_utils":781,"../../lib/svg_text_utils":813,"../../plots/mapbox/convert_text_opts":894,"../scatter/make_bubble_size_func":1219,"../scatter/subtypes":1227,"fast-isnumeric":246}],1269:[function(h,N,H){var t=h("../../lib"),m=h("../scatter/subtypes"),g=h("../scatter/marker_defaults"),p=h("../scatter/line_defaults"),e=h("../scatter/text_defaults"),f=h("../scatter/fillcolor_defaults"),u=h("./attributes");N.exports=function(i,s,o,a){function c(n,d){return t.coerce(i,s,u,n,d)}if(function(n,d,l){var y=l("lon")||[],v=l("lat")||[],_=Math.min(y.length,v.length);return d._length=_,_}(0,s,c)){if(c("text"),c("texttemplate"),c("hovertext"),c("hovertemplate"),c("mode"),c("below"),m.hasLines(s)&&(p(i,s,o,a,c,{noDash:!0}),c("connectgaps")),m.hasMarkers(s)){g(i,s,o,a,c,{noLine:!0}),c("marker.allowoverlap"),c("marker.angle");var r=s.marker;r.symbol!=="circle"&&(t.isArrayOrTypedArray(r.size)&&(r.size=r.size[0]),t.isArrayOrTypedArray(r.color)&&(r.color=r.color[0]))}m.hasText(s)&&e(i,s,a,c,{noSelect:!0}),c("fill"),s.fill!=="none"&&f(i,s,o,c),t.coerceSelectionMarkerOpacity(s,c)}else s.visible=!1}},{"../../lib":787,"../scatter/fillcolor_defaults":1210,"../scatter/line_defaults":1215,"../scatter/marker_defaults":1221,"../scatter/subtypes":1227,"../scatter/text_defaults":1228,"./attributes":1267}],1270:[function(h,N,H){N.exports=function(t,m){return t.lon=m.lon,t.lat=m.lat,t}},{}],1271:[function(h,N,H){var t=h("../../plots/cartesian/axes");N.exports=function(m,g,p){var e={},f=p[g.subplot]._subplot.mockAxis,u=m.lonlat;return e.lonLabel=t.tickText(f,f.c2l(u[0]),!0).text,e.latLabel=t.tickText(f,f.c2l(u[1]),!0).text,e}},{"../../plots/cartesian/axes":838}],1272:[function(h,N,H){var t=h("../../components/fx"),m=h("../../lib"),g=h("../scatter/get_trace_color"),p=m.fillText,e=h("../../constants/numerical").BADNUM;function f(u,i,s){if(!u.hovertemplate){var o=(i.hi||u.hoverinfo).split("+"),a=o.indexOf("all")!==-1,c=o.indexOf("lon")!==-1,r=o.indexOf("lat")!==-1,n=i.lonlat,d=[];return a||c&&r?d.push("("+l(n[1])+", "+l(n[0])+")"):c?d.push(s.lon+l(n[0])):r&&d.push(s.lat+l(n[1])),(a||o.indexOf("text")!==-1)&&p(i,u,d),d.join("<br>")}function l(y){return y+"\xB0"}}N.exports={hoverPoints:function(u,i,s){var o=u.cd,a=o[0].trace,c=u.xa,r=u.ya,n=u.subplot,d=360*(i>=0?Math.floor((i+180)/360):Math.ceil((i-180)/360)),l=i-d;if(t.getClosest(o,function(L){var k=L.lonlat;if(k[0]===e)return 1/0;var C=m.modHalf(k[0],360),M=k[1],P=n.project([C,M]),O=P.x-c.c2p([l,M]),F=P.y-r.c2p([C,s]),j=Math.max(3,L.mrc||0);return Math.max(Math.sqrt(O*O+F*F)-j,1-3/j)},u),u.index!==!1){var y=o[u.index],v=y.lonlat,_=[m.modHalf(v[0],360)+d,v[1]],x=c.c2p(_),T=r.c2p(_),A=y.mrc||1;u.x0=x-A,u.x1=x+A,u.y0=T-A,u.y1=T+A;var S={};S[a.subplot]={_subplot:n};var w=a._module.formatLabels(y,a,S);return u.lonLabel=w.lonLabel,u.latLabel=w.latLabel,u.color=g(a,y),u.extraText=f(a,y,o[0].t.labels),u.hovertemplate=a.hovertemplate,[u]}},getExtraText:f}},{"../../components/fx":690,"../../constants/numerical":763,"../../lib":787,"../scatter/get_trace_color":1212}],1273:[function(h,N,H){N.exports={attributes:h("./attributes"),supplyDefaults:h("./defaults"),colorbar:h("../scatter/marker_colorbar"),formatLabels:h("./format_labels"),calc:h("../scattergeo/calc"),plot:h("./plot"),hoverPoints:h("./hover").hoverPoints,eventData:h("./event_data"),selectPoints:h("./select"),styleOnSelect:function(t,m){m&&m[0].trace._glTrace.update(m)},moduleType:"trace",name:"scattermapbox",basePlotModule:h("../../plots/mapbox"),categories:["mapbox","gl","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/mapbox":895,"../scatter/marker_colorbar":1220,"../scattergeo/calc":1245,"./attributes":1267,"./defaults":1269,"./event_data":1270,"./format_labels":1271,"./hover":1272,"./plot":1274,"./select":1275}],1274:[function(h,N,H){var t=h("./convert"),m=h("../../plots/mapbox/constants").traceLayerPrefix,g=["fill","line","circle","symbol"];function p(f,u){this.type="scattermapbox",this.subplot=f,this.uid=u,this.sourceIds={fill:"source-"+u+"-fill",line:"source-"+u+"-line",circle:"source-"+u+"-circle",symbol:"source-"+u+"-symbol"},this.layerIds={fill:m+u+"-fill",line:m+u+"-line",circle:m+u+"-circle",symbol:m+u+"-symbol"},this.below=null}var e=p.prototype;e.addSource=function(f,u){this.subplot.map.addSource(this.sourceIds[f],{type:"geojson",data:u.geojson})},e.setSourceData=function(f,u){this.subplot.map.getSource(this.sourceIds[f]).setData(u.geojson)},e.addLayer=function(f,u,i){this.subplot.addLayer({type:f,id:this.layerIds[f],source:this.sourceIds[f],layout:u.layout,paint:u.paint},i)},e.update=function(f){var u,i,s,o=this.subplot,a=o.map,c=t(o.gd,f),r=o.belowLookup["trace-"+this.uid];if(r!==this.below){for(u=g.length-1;u>=0;u--)i=g[u],a.removeLayer(this.layerIds[i]);for(u=0;u<g.length;u++)s=c[i=g[u]],this.addLayer(i,s,r);this.below=r}for(u=0;u<g.length;u++)s=c[i=g[u]],o.setOptions(this.layerIds[i],"setLayoutProperty",s.layout),s.layout.visibility==="visible"&&(this.setSourceData(i,s),o.setOptions(this.layerIds[i],"setPaintProperty",s.paint));f[0].trace._glTrace=this},e.dispose=function(){for(var f=this.subplot.map,u=g.length-1;u>=0;u--){var i=g[u];f.removeLayer(this.layerIds[i]),f.removeSource(this.sourceIds[i])}},N.exports=function(f,u){for(var i=u[0].trace,s=new p(f,i.uid),o=t(f.gd,u),a=s.below=f.belowLookup["trace-"+i.uid],c=0;c<g.length;c++){var r=g[c],n=o[r];s.addSource(r,n),s.addLayer(r,n,a)}return u[0].trace._glTrace=s,s}},{"../../plots/mapbox/constants":893,"./convert":1268}],1275:[function(h,N,H){var t=h("../../lib"),m=h("../scatter/subtypes"),g=h("../../constants/numerical").BADNUM;N.exports=function(p,e){var f,u=p.cd,i=p.xaxis,s=p.yaxis,o=[],a=u[0].trace;if(!m.hasMarkers(a))return[];if(e===!1)for(f=0;f<u.length;f++)u[f].selected=0;else for(f=0;f<u.length;f++){var c=u[f],r=c.lonlat;if(r[0]!==g){var n=[t.modHalf(r[0],360),r[1]],d=[i.c2p(n),s.c2p(n)];e.contains(d,null,f,p)?(o.push({pointNumber:f,lon:r[0],lat:r[1]}),c.selected=1):c.selected=0}}return o}},{"../../constants/numerical":763,"../../lib":787,"../scatter/subtypes":1227}],1276:[function(h,N,H){var t=h("../../plots/template_attributes").hovertemplateAttrs,m=h("../../plots/template_attributes").texttemplateAttrs,g=h("../../lib/extend").extendFlat,p=h("../scatter/attributes"),e=h("../../plots/attributes"),f=p.line;N.exports={mode:p.mode,r:{valType:"data_array",editType:"calc+clearAxisTypes"},theta:{valType:"data_array",editType:"calc+clearAxisTypes"},r0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dr:{valType:"number",dflt:1,editType:"calc"},theta0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dtheta:{valType:"number",editType:"calc"},thetaunit:{valType:"enumerated",values:["radians","degrees","gradians"],dflt:"degrees",editType:"calc+clearAxisTypes"},text:p.text,texttemplate:m({editType:"plot"},{keys:["r","theta","text"]}),hovertext:p.hovertext,line:{color:f.color,width:f.width,dash:f.dash,shape:g({},f.shape,{values:["linear","spline"]}),smoothing:f.smoothing,editType:"calc"},connectgaps:p.connectgaps,marker:p.marker,cliponaxis:g({},p.cliponaxis,{dflt:!1}),textposition:p.textposition,textfont:p.textfont,fill:g({},p.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:p.fillcolor,hoverinfo:g({},e.hoverinfo,{flags:["r","theta","text","name"]}),hoveron:p.hoveron,hovertemplate:t(),selected:p.selected,unselected:p.unselected}},{"../../lib/extend":777,"../../plots/attributes":834,"../../plots/template_attributes":910,"../scatter/attributes":1202}],1277:[function(h,N,H){var t=h("fast-isnumeric"),m=h("../../constants/numerical").BADNUM,g=h("../../plots/cartesian/axes"),p=h("../scatter/colorscale_calc"),e=h("../scatter/arrays_to_calcdata"),f=h("../scatter/calc_selection"),u=h("../scatter/calc").calcMarkerSize;N.exports=function(i,s){for(var o=i._fullLayout,a=s.subplot,c=o[a].radialaxis,r=o[a].angularaxis,n=c.makeCalcdata(s,"r"),d=r.makeCalcdata(s,"theta"),l=s._length,y=new Array(l),v=0;v<l;v++){var _=n[v],x=d[v],T=y[v]={};t(_)&&t(x)?(T.r=_,T.theta=x):T.r=m}var A=u(s,l);return s._extremes.x=g.findExtremes(c,n,{ppad:A}),p(i,s),e(y,s),f(y,s),y}},{"../../constants/numerical":763,"../../plots/cartesian/axes":838,"../scatter/arrays_to_calcdata":1201,"../scatter/calc":1203,"../scatter/calc_selection":1204,"../scatter/colorscale_calc":1205,"fast-isnumeric":246}],1278:[function(h,N,H){var t=h("../../lib"),m=h("../scatter/subtypes"),g=h("../scatter/marker_defaults"),p=h("../scatter/line_defaults"),e=h("../scatter/line_shape_defaults"),f=h("../scatter/text_defaults"),u=h("../scatter/fillcolor_defaults"),i=h("../scatter/constants").PTS_LINESONLY,s=h("./attributes");function o(a,c,r,n){var d,l=n("r"),y=n("theta");if(l)y?d=Math.min(l.length,y.length):(d=l.length,n("theta0"),n("dtheta"));else{if(!y)return 0;d=c.theta.length,n("r0"),n("dr")}return c._length=d,d}N.exports={handleRThetaDefaults:o,supplyDefaults:function(a,c,r,n){function d(v,_){return t.coerce(a,c,s,v,_)}var l=o(a,c,n,d);if(l){d("thetaunit"),d("mode",l<i?"lines+markers":"lines"),d("text"),d("hovertext"),c.hoveron!=="fills"&&d("hovertemplate"),m.hasLines(c)&&(p(a,c,r,n,d),e(a,c,d),d("connectgaps")),m.hasMarkers(c)&&g(a,c,r,n,d,{gradient:!0}),m.hasText(c)&&(d("texttemplate"),f(a,c,n,d));var y=[];(m.hasMarkers(c)||m.hasText(c))&&(d("cliponaxis"),d("marker.maxdisplayed"),y.push("points")),d("fill"),c.fill!=="none"&&(u(a,c,r,d),m.hasLines(c)||e(a,c,d)),c.fill!=="tonext"&&c.fill!=="toself"||y.push("fills"),d("hoveron",y.join("+")||"points"),t.coerceSelectionMarkerOpacity(c,d)}else c.visible=!1}}},{"../../lib":787,"../scatter/constants":1206,"../scatter/fillcolor_defaults":1210,"../scatter/line_defaults":1215,"../scatter/line_shape_defaults":1217,"../scatter/marker_defaults":1221,"../scatter/subtypes":1227,"../scatter/text_defaults":1228,"./attributes":1276}],1279:[function(h,N,H){var t=h("../../lib"),m=h("../../plots/cartesian/axes");N.exports=function(g,p,e){var f,u,i={},s=e[p.subplot]._subplot;s?(f=s.radialAxis,u=s.angularAxis):(f=(s=e[p.subplot]).radialaxis,u=s.angularaxis);var o=f.c2l(g.r);i.rLabel=m.tickText(f,o,!0).text;var a=u.thetaunit==="degrees"?t.rad2deg(g.theta):g.theta;return i.thetaLabel=m.tickText(u,a,!0).text,i}},{"../../lib":787,"../../plots/cartesian/axes":838}],1280:[function(h,N,H){var t=h("../scatter/hover");function m(g,p,e,f){var u=e.radialAxis,i=e.angularAxis;u._hovertitle="r",i._hovertitle="\u03B8";var s={};s[p.subplot]={_subplot:e};var o=p._module.formatLabels(g,p,s);f.rLabel=o.rLabel,f.thetaLabel=o.thetaLabel;var a=g.hi||p.hoverinfo,c=[];function r(d,l){c.push(d._hovertitle+": "+l)}if(!p.hovertemplate){var n=a.split("+");n.indexOf("all")!==-1&&(n=["r","theta","text"]),n.indexOf("r")!==-1&&r(u,f.rLabel),n.indexOf("theta")!==-1&&r(i,f.thetaLabel),n.indexOf("text")!==-1&&f.text&&(c.push(f.text),delete f.text),f.extraText=c.join("<br>")}}N.exports={hoverPoints:function(g,p,e,f){var u=t(g,p,e,f);if(u&&u[0].index!==!1){var i=u[0];if(i.index===void 0)return u;var s=g.subplot,o=i.cd[i.index],a=i.trace;if(s.isPtInside(o))return i.xLabelVal=void 0,i.yLabelVal=void 0,m(o,a,s,i),i.hovertemplate=a.hovertemplate,u}},makeHoverPointText:m}},{"../scatter/hover":1213}],1281:[function(h,N,H){N.exports={moduleType:"trace",name:"scatterpolar",basePlotModule:h("../../plots/polar"),categories:["polar","symbols","showLegend","scatter-like"],attributes:h("./attributes"),supplyDefaults:h("./defaults").supplyDefaults,colorbar:h("../scatter/marker_colorbar"),formatLabels:h("./format_labels"),calc:h("./calc"),plot:h("./plot"),style:h("../scatter/style").style,styleOnSelect:h("../scatter/style").styleOnSelect,hoverPoints:h("./hover").hoverPoints,selectPoints:h("../scatter/select"),meta:{}}},{"../../plots/polar":904,"../scatter/marker_colorbar":1220,"../scatter/select":1224,"../scatter/style":1226,"./attributes":1276,"./calc":1277,"./defaults":1278,"./format_labels":1279,"./hover":1280,"./plot":1282}],1282:[function(h,N,H){var t=h("../scatter/plot"),m=h("../../constants/numerical").BADNUM;N.exports=function(g,p,e){for(var f=p.layers.frontplot.select("g.scatterlayer"),u={xaxis:p.xaxis,yaxis:p.yaxis,plot:p.framework,layerClipId:p._hasClipOnAxisFalse?p.clipIds.forTraces:null},i=p.radialAxis,s=p.angularAxis,o=0;o<e.length;o++)for(var a=e[o],c=0;c<a.length;c++){var r=a[c],n=r.r;if(n===m)r.x=r.y=m;else{var d=i.c2g(n),l=s.c2g(r.theta);r.x=d*Math.cos(l),r.y=d*Math.sin(l)}}t(g,u,e,f)}},{"../../constants/numerical":763,"../scatter/plot":1223}],1283:[function(h,N,H){var t=h("../scatterpolar/attributes"),m=h("../scattergl/attributes"),g=h("../../plots/template_attributes").texttemplateAttrs;N.exports={mode:t.mode,r:t.r,theta:t.theta,r0:t.r0,dr:t.dr,theta0:t.theta0,dtheta:t.dtheta,thetaunit:t.thetaunit,text:t.text,texttemplate:g({editType:"plot"},{keys:["r","theta","text"]}),hovertext:t.hovertext,hovertemplate:t.hovertemplate,line:m.line,connectgaps:m.connectgaps,marker:m.marker,fill:m.fill,fillcolor:m.fillcolor,textposition:m.textposition,textfont:m.textfont,hoverinfo:t.hoverinfo,selected:t.selected,unselected:t.unselected}},{"../../plots/template_attributes":910,"../scattergl/attributes":1254,"../scatterpolar/attributes":1276}],1284:[function(h,N,H){var t=h("../scatter/colorscale_calc"),m=h("../scatter/calc").calcMarkerSize,g=h("../scattergl/convert"),p=h("../../plots/cartesian/axes"),e=h("../scattergl/constants").TOO_MANY_POINTS;N.exports=function(f,u){var i=f._fullLayout,s=u.subplot,o=i[s].radialaxis,a=i[s].angularaxis,c=u._r=o.makeCalcdata(u,"r"),r=u._theta=a.makeCalcdata(u,"theta"),n=u._length,d={};n<c.length&&(c=c.slice(0,n)),n<r.length&&(r=r.slice(0,n)),d.r=c,d.theta=r,t(f,u);var l,y=d.opts=g.style(f,u);return n<e?l=m(u,n):y.marker&&(l=2*(y.marker.sizeAvg||Math.max(y.marker.size,3))),u._extremes.x=p.findExtremes(o,c,{ppad:l}),[{x:!1,y:!1,t:d,trace:u}]}},{"../../plots/cartesian/axes":838,"../scatter/calc":1203,"../scatter/colorscale_calc":1205,"../scattergl/constants":1256,"../scattergl/convert":1257}],1285:[function(h,N,H){var t=h("../../lib"),m=h("../scatter/subtypes"),g=h("../scatterpolar/defaults").handleRThetaDefaults,p=h("../scatter/marker_defaults"),e=h("../scatter/line_defaults"),f=h("../scatter/text_defaults"),u=h("../scatter/fillcolor_defaults"),i=h("../scatter/constants").PTS_LINESONLY,s=h("./attributes");N.exports=function(o,a,c,r){function n(l,y){return t.coerce(o,a,s,l,y)}var d=g(o,a,r,n);d?(n("thetaunit"),n("mode",d<i?"lines+markers":"lines"),n("text"),n("hovertext"),a.hoveron!=="fills"&&n("hovertemplate"),m.hasLines(a)&&(e(o,a,c,r,n),n("connectgaps")),m.hasMarkers(a)&&p(o,a,c,r,n),m.hasText(a)&&(n("texttemplate"),f(o,a,r,n)),n("fill"),a.fill!=="none"&&u(o,a,c,n),t.coerceSelectionMarkerOpacity(a,n)):a.visible=!1}},{"../../lib":787,"../scatter/constants":1206,"../scatter/fillcolor_defaults":1210,"../scatter/line_defaults":1215,"../scatter/marker_defaults":1221,"../scatter/subtypes":1227,"../scatter/text_defaults":1228,"../scatterpolar/defaults":1278,"./attributes":1283}],1286:[function(h,N,H){var t=h("../scatterpolar/format_labels");N.exports=function(m,g,p){var e=m.i;return"r"in m||(m.r=g._r[e]),"theta"in m||(m.theta=g._theta[e]),t(m,g,p)}},{"../scatterpolar/format_labels":1279}],1287:[function(h,N,H){var t=h("../scattergl/hover"),m=h("../scatterpolar/hover").makeHoverPointText;N.exports={hoverPoints:function(g,p,e,f){var u=g.cd[0].t,i=u.r,s=u.theta,o=t.hoverPoints(g,p,e,f);if(o&&o[0].index!==!1){var a=o[0];if(a.index===void 0)return o;var c=g.subplot,r=a.cd[a.index],n=a.trace;if(r.r=i[a.index],r.theta=s[a.index],c.isPtInside(r))return a.xLabelVal=void 0,a.yLabelVal=void 0,m(r,n,c,a),o}}}},{"../scattergl/hover":1262,"../scatterpolar/hover":1280}],1288:[function(h,N,H){N.exports={moduleType:"trace",name:"scatterpolargl",basePlotModule:h("../../plots/polar"),categories:["gl","regl","polar","symbols","showLegend","scatter-like"],attributes:h("./attributes"),supplyDefaults:h("./defaults"),colorbar:h("../scatter/marker_colorbar"),formatLabels:h("./format_labels"),calc:h("./calc"),plot:h("./plot"),hoverPoints:h("./hover").hoverPoints,selectPoints:h("../scattergl/select"),meta:{}}},{"../../plots/polar":904,"../scatter/marker_colorbar":1220,"../scattergl/select":1266,"./attributes":1283,"./calc":1284,"./defaults":1285,"./format_labels":1286,"./hover":1287,"./plot":1289}],1289:[function(h,N,H){var t=h("@plotly/point-cluster"),m=h("fast-isnumeric"),g=h("../scattergl/plot"),p=h("../scattergl/scene_update"),e=h("../scattergl/convert"),f=h("../../lib"),u=h("../scattergl/constants").TOO_MANY_POINTS;N.exports=function(i,s,o){if(o.length){var a=s.radialAxis,c=s.angularAxis,r=p(i,s);return o.forEach(function(n){if(n&&n[0]&&n[0].trace){var d,l=n[0],y=l.trace,v=l.t,_=y._length,x=v.r,T=v.theta,A=v.opts,S=x.slice(),w=T.slice();for(d=0;d<x.length;d++)s.isPtInside({r:x[d],theta:T[d]})||(S[d]=NaN,w[d]=NaN);var L=new Array(2*_),k=Array(_),C=Array(_);for(d=0;d<_;d++){var M,P,O=S[d];if(m(O)){var F=a.c2g(O),j=c.c2g(w[d],y.thetaunit);M=F*Math.cos(j),P=F*Math.sin(j)}else M=P=NaN;k[d]=L[2*d]=M,C[d]=L[2*d+1]=P}v.tree=t(L),A.marker&&_>=u&&(A.marker.cluster=v.tree),A.marker&&(A.markerSel.positions=A.markerUnsel.positions=A.marker.positions=L),A.line&&L.length>1&&f.extendFlat(A.line,e.linePositions(i,y,L)),A.text&&(f.extendFlat(A.text,{positions:L},e.textPosition(i,y,A.text,A.marker)),f.extendFlat(A.textSel,{positions:L},e.textPosition(i,y,A.text,A.markerSel)),f.extendFlat(A.textUnsel,{positions:L},e.textPosition(i,y,A.text,A.markerUnsel))),A.fill&&!r.fill2d&&(r.fill2d=!0),A.marker&&!r.scatter2d&&(r.scatter2d=!0),A.line&&!r.line2d&&(r.line2d=!0),A.text&&!r.glText&&(r.glText=!0),r.lineOptions.push(A.line),r.fillOptions.push(A.fill),r.markerOptions.push(A.marker),r.markerSelectedOptions.push(A.markerSel),r.markerUnselectedOptions.push(A.markerUnsel),r.textOptions.push(A.text),r.textSelectedOptions.push(A.textSel),r.textUnselectedOptions.push(A.textUnsel),r.selectBatch.push([]),r.unselectBatch.push([]),v.x=k,v.y=C,v.rawx=k,v.rawy=C,v.r=x,v.theta=T,v.positions=L,v._scene=r,v.index=r.count,r.count++}}),g(i,s,o)}}},{"../../lib":787,"../scattergl/constants":1256,"../scattergl/convert":1257,"../scattergl/plot":1264,"../scattergl/scene_update":1265,"@plotly/point-cluster":59,"fast-isnumeric":246}],1290:[function(h,N,H){var t=h("../../plots/template_attributes").hovertemplateAttrs,m=h("../../plots/template_attributes").texttemplateAttrs,g=h("../scatter/attributes"),p=h("../../plots/attributes"),e=h("../../components/colorscale/attributes"),f=h("../../components/drawing/attributes").dash,u=h("../../lib/extend").extendFlat,i=g.marker,s=g.line,o=i.line;N.exports={a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},c:{valType:"data_array",editType:"calc"},sum:{valType:"number",dflt:0,min:0,editType:"calc"},mode:u({},g.mode,{dflt:"markers"}),text:u({},g.text,{}),texttemplate:m({editType:"plot"},{keys:["a","b","c","text"]}),hovertext:u({},g.hovertext,{}),line:{color:s.color,width:s.width,dash:f,shape:u({},s.shape,{values:["linear","spline"]}),smoothing:s.smoothing,editType:"calc"},connectgaps:g.connectgaps,cliponaxis:g.cliponaxis,fill:u({},g.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:g.fillcolor,marker:u({symbol:i.symbol,opacity:i.opacity,maxdisplayed:i.maxdisplayed,size:i.size,sizeref:i.sizeref,sizemin:i.sizemin,sizemode:i.sizemode,line:u({width:o.width,editType:"calc"},e("marker.line")),gradient:i.gradient,editType:"calc"},e("marker")),textfont:g.textfont,textposition:g.textposition,selected:g.selected,unselected:g.unselected,hoverinfo:u({},p.hoverinfo,{flags:["a","b","c","text","name"]}),hoveron:g.hoveron,hovertemplate:t()}},{"../../components/colorscale/attributes":657,"../../components/drawing/attributes":671,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/template_attributes":910,"../scatter/attributes":1202}],1291:[function(h,N,H){var t=h("fast-isnumeric"),m=h("../scatter/colorscale_calc"),g=h("../scatter/arrays_to_calcdata"),p=h("../scatter/calc_selection"),e=h("../scatter/calc").calcMarkerSize,f=["a","b","c"],u={a:["b","c"],b:["a","c"],c:["a","b"]};N.exports=function(i,s){var o,a,c,r,n,d,l=i._fullLayout[s.subplot].sum,y=s.sum||l,v={a:s.a,b:s.b,c:s.c};for(o=0;o<f.length;o++)if(!v[c=f[o]]){for(n=v[u[c][0]],d=v[u[c][1]],r=new Array(n.length),a=0;a<n.length;a++)r[a]=y-n[a]-d[a];v[c]=r}var _,x,T,A,S,w,L=s._length,k=new Array(L);for(o=0;o<L;o++)_=v.a[o],x=v.b[o],T=v.c[o],t(_)&&t(x)&&t(T)?((A=l/((_=+_)+(x=+x)+(T=+T)))!=1&&(_*=A,x*=A,T*=A),w=_,S=T-x,k[o]={x:S,y:w,a:_,b:x,c:T}):k[o]={x:!1,y:!1};return e(s,L),m(i,s),g(k,s),p(k,s),k}},{"../scatter/arrays_to_calcdata":1201,"../scatter/calc":1203,"../scatter/calc_selection":1204,"../scatter/colorscale_calc":1205,"fast-isnumeric":246}],1292:[function(h,N,H){var t=h("../../lib"),m=h("../scatter/constants"),g=h("../scatter/subtypes"),p=h("../scatter/marker_defaults"),e=h("../scatter/line_defaults"),f=h("../scatter/line_shape_defaults"),u=h("../scatter/text_defaults"),i=h("../scatter/fillcolor_defaults"),s=h("./attributes");N.exports=function(o,a,c,r){function n(x,T){return t.coerce(o,a,s,x,T)}var d,l=n("a"),y=n("b"),v=n("c");if(l?(d=l.length,y?(d=Math.min(d,y.length),v&&(d=Math.min(d,v.length))):d=v?Math.min(d,v.length):0):y&&v&&(d=Math.min(y.length,v.length)),d){a._length=d,n("sum"),n("text"),n("hovertext"),a.hoveron!=="fills"&&n("hovertemplate"),n("mode",d<m.PTS_LINESONLY?"lines+markers":"lines"),g.hasLines(a)&&(e(o,a,c,r,n),f(o,a,n),n("connectgaps")),g.hasMarkers(a)&&p(o,a,c,r,n,{gradient:!0}),g.hasText(a)&&(n("texttemplate"),u(o,a,r,n));var _=[];(g.hasMarkers(a)||g.hasText(a))&&(n("cliponaxis"),n("marker.maxdisplayed"),_.push("points")),n("fill"),a.fill!=="none"&&(i(o,a,c,n),g.hasLines(a)||f(o,a,n)),a.fill!=="tonext"&&a.fill!=="toself"||_.push("fills"),n("hoveron",_.join("+")||"points"),t.coerceSelectionMarkerOpacity(a,n)}else a.visible=!1}},{"../../lib":787,"../scatter/constants":1206,"../scatter/fillcolor_defaults":1210,"../scatter/line_defaults":1215,"../scatter/line_shape_defaults":1217,"../scatter/marker_defaults":1221,"../scatter/subtypes":1227,"../scatter/text_defaults":1228,"./attributes":1290}],1293:[function(h,N,H){N.exports=function(t,m,g,p,e){if(m.xa&&(t.xaxis=m.xa),m.ya&&(t.yaxis=m.ya),p[e]){var f=p[e];t.a=f.a,t.b=f.b,t.c=f.c}else t.a=m.a,t.b=m.b,t.c=m.c;return t}},{}],1294:[function(h,N,H){var t=h("../../plots/cartesian/axes");N.exports=function(m,g,p){var e={},f=p[g.subplot]._subplot;return e.aLabel=t.tickText(f.aaxis,m.a,!0).text,e.bLabel=t.tickText(f.baxis,m.b,!0).text,e.cLabel=t.tickText(f.caxis,m.c,!0).text,e}},{"../../plots/cartesian/axes":838}],1295:[function(h,N,H){var t=h("../scatter/hover");N.exports=function(m,g,p,e){var f=t(m,g,p,e);if(f&&f[0].index!==!1){var u=f[0];if(u.index===void 0){var i=1-u.y0/m.ya._length,s=m.xa._length,o=s*i/2,a=s-o;return u.x0=Math.max(Math.min(u.x0,a),o),u.x1=Math.max(Math.min(u.x1,a),o),f}var c=u.cd[u.index],r=u.trace,n=u.subplot;u.a=c.a,u.b=c.b,u.c=c.c,u.xLabelVal=void 0,u.yLabelVal=void 0;var d={};d[r.subplot]={_subplot:n};var l=r._module.formatLabels(c,r,d);u.aLabel=l.aLabel,u.bLabel=l.bLabel,u.cLabel=l.cLabel;var y=c.hi||r.hoverinfo,v=[];if(!r.hovertemplate){var _=y.split("+");_.indexOf("all")!==-1&&(_=["a","b","c"]),_.indexOf("a")!==-1&&x(n.aaxis,u.aLabel),_.indexOf("b")!==-1&&x(n.baxis,u.bLabel),_.indexOf("c")!==-1&&x(n.caxis,u.cLabel)}return u.extraText=v.join("<br>"),u.hovertemplate=r.hovertemplate,f}function x(T,A){v.push(T._hovertitle+": "+A)}}},{"../scatter/hover":1213}],1296:[function(h,N,H){N.exports={attributes:h("./attributes"),supplyDefaults:h("./defaults"),colorbar:h("../scatter/marker_colorbar"),formatLabels:h("./format_labels"),calc:h("./calc"),plot:h("./plot"),style:h("../scatter/style").style,styleOnSelect:h("../scatter/style").styleOnSelect,hoverPoints:h("./hover"),selectPoints:h("../scatter/select"),eventData:h("./event_data"),moduleType:"trace",name:"scatterternary",basePlotModule:h("../../plots/ternary"),categories:["ternary","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/ternary":911,"../scatter/marker_colorbar":1220,"../scatter/select":1224,"../scatter/style":1226,"./attributes":1290,"./calc":1291,"./defaults":1292,"./event_data":1293,"./format_labels":1294,"./hover":1295,"./plot":1297}],1297:[function(h,N,H){var t=h("../scatter/plot");N.exports=function(m,g,p){var e=g.plotContainer;e.select(".scatterlayer").selectAll("*").remove();var f={xaxis:g.xaxis,yaxis:g.yaxis,plot:e,layerClipId:g._hasClipOnAxisFalse?g.clipIdRelative:null},u=g.layers.frontplot.select("g.scatterlayer");t(m,f,p,u)}},{"../scatter/plot":1223}],1298:[function(h,N,H){var t=h("../scatter/attributes"),m=h("../../components/colorscale/attributes"),g=h("../../plots/cartesian/axis_format_attributes").axisHoverFormat,p=h("../../plots/template_attributes").hovertemplateAttrs,e=h("../scattergl/attributes"),f=h("../../plots/cartesian/constants").idRegex,u=h("../../plot_api/plot_template").templatedArray,i=h("../../lib/extend").extendFlat,s=t.marker,o=s.line,a=i(m("marker.line",{editTypeOverride:"calc"}),{width:i({},o.width,{editType:"calc"}),editType:"calc"}),c=i(m("marker"),{symbol:s.symbol,size:i({},s.size,{editType:"markerSize"}),sizeref:s.sizeref,sizemin:s.sizemin,sizemode:s.sizemode,opacity:s.opacity,colorbar:s.colorbar,line:a,editType:"calc"});function r(n){return{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"subplotid",regex:f[n],editType:"plot"}}}c.color.editType=c.cmin.editType=c.cmax.editType="style",N.exports={dimensions:u("dimension",{visible:{valType:"boolean",dflt:!0,editType:"calc"},label:{valType:"string",editType:"calc"},values:{valType:"data_array",editType:"calc+clearAxisTypes"},axis:{type:{valType:"enumerated",values:["linear","log","date","category"],editType:"calc+clearAxisTypes"},matches:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc+clearAxisTypes"},editType:"calc+clearAxisTypes"}),text:i({},e.text,{}),hovertext:i({},e.hovertext,{}),hovertemplate:p(),xhoverformat:g("x"),yhoverformat:g("y"),marker:c,xaxes:r("x"),yaxes:r("y"),diagonal:{visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},showupperhalf:{valType:"boolean",dflt:!0,editType:"calc"},showlowerhalf:{valType:"boolean",dflt:!0,editType:"calc"},selected:{marker:e.selected.marker,editType:"calc"},unselected:{marker:e.unselected.marker,editType:"calc"},opacity:e.opacity}},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plot_api/plot_template":827,"../../plots/cartesian/axis_format_attributes":841,"../../plots/cartesian/constants":845,"../../plots/template_attributes":910,"../scatter/attributes":1202,"../scattergl/attributes":1254}],1299:[function(h,N,H){var t=h("regl-line2d"),m=h("../../registry"),g=h("../../lib/prepare_regl"),p=h("../../plots/get_data").getModuleCalcData,e=h("../../plots/cartesian"),f=h("../../plots/cartesian/axis_ids").getFromId,u=h("../../plots/cartesian/axes").shouldShowZeroLine;function i(o,a,c){for(var r=c.matrixOptions.data.length,n=a._visibleDims,d=c.viewOpts.ranges=new Array(r),l=0;l<n.length;l++){var y=n[l],v=d[l]=new Array(4),_=f(o,a._diag[y][0]);_&&(v[0]=_.r2l(_.range[0]),v[2]=_.r2l(_.range[1]));var x=f(o,a._diag[y][1]);x&&(v[1]=x.r2l(x.range[0]),v[3]=x.r2l(x.range[1]))}c.selectBatch.length||c.unselectBatch.length?c.matrix.update({ranges:d},{ranges:d}):c.matrix.update({ranges:d})}function s(o){var a=o._fullLayout,c=a._glcanvas.data()[0].regl,r=a._splomGrid;r||(r=a._splomGrid=t(c)),r.update(function(n){var d,l=n._context.plotGlPixelRatio,y=n._fullLayout,v=y._size,_=[0,0,y.width*l,y.height*l],x={};function T(X,G,Y,K,D,B){Y*=l,K*=l,D*=l,B*=l;var q=G[X+"color"],ee=G[X+"width"],J=String(q+ee);J in x?x[J].data.push(NaN,NaN,Y,K,D,B):x[J]={data:[Y,K,D,B],join:"rect",thickness:ee*l,color:q,viewport:_,range:_,overlay:!1}}for(d in y._splomSubplots){var A,S,w=y._plots[d],L=w.xaxis,k=w.yaxis,C=L._gridVals,M=k._gridVals,P=L._offset,O=L._length,F=k._length,j=v.b+k.domain[0]*v.h,W=-k._m,Z=-W*k.r2l(k.range[0],k.calendar);if(L.showgrid)for(d=0;d<C.length;d++)A=P+L.l2p(C[d].x),T("grid",L,A,j,A,j+F);if(k.showgrid)for(d=0;d<M.length;d++)S=j+Z+W*M[d].x,T("grid",k,P,S,P+O,S);u(n,L,k)&&(A=P+L.l2p(0),T("zeroline",L,A,j,A,j+F)),u(n,k,L)&&T("zeroline",k,P,S=j+Z+0,P+O,S)}var Q=[];for(d in x)Q.push(x[d]);return Q}(o))}N.exports={name:"splom",attr:e.attr,attrRegex:e.attrRegex,layoutAttributes:e.layoutAttributes,supplyLayoutDefaults:e.supplyLayoutDefaults,drawFramework:e.drawFramework,plot:function(o){var a=o._fullLayout,c=m.getModule("splom"),r=p(o.calcdata,c)[0];g(o,["ANGLE_instanced_arrays","OES_element_index_uint"])&&(a._hasOnlyLargeSploms&&s(o),c.plot(o,{},r))},drag:function(o){var a=o.calcdata,c=o._fullLayout;c._hasOnlyLargeSploms&&s(o);for(var r=0;r<a.length;r++){var n=a[r][0].trace,d=c._splomScenes[n.uid];n.type==="splom"&&d&&d.matrix&&i(o,n,d)}},updateGrid:s,clean:function(o,a,c,r){var n,d={};if(r._splomScenes){for(n=0;n<o.length;n++){var l=o[n];l.type==="splom"&&(d[l.uid]=1)}for(n=0;n<c.length;n++){var y=c[n];if(!d[y.uid]){var v=r._splomScenes[y.uid];v&&v.destroy&&v.destroy(),r._splomScenes[y.uid]=null,delete r._splomScenes[y.uid]}}}Object.keys(r._splomScenes||{}).length===0&&delete r._splomScenes,r._splomGrid&&!a._hasOnlyLargeSploms&&r._hasOnlyLargeSploms&&(r._splomGrid.destroy(),r._splomGrid=null,delete r._splomGrid),e.clean(o,a,c,r)},updateFx:e.updateFx,toSVG:e.toSVG}},{"../../lib/prepare_regl":800,"../../plots/cartesian":852,"../../plots/cartesian/axes":838,"../../plots/cartesian/axis_ids":842,"../../plots/get_data":875,"../../registry":915,"regl-line2d":523}],1300:[function(h,N,H){var t=h("../../lib"),m=h("../../plots/cartesian/axis_ids"),g=h("../scatter/calc").calcMarkerSize,p=h("../scatter/calc").calcAxisExpansion,e=h("../scatter/colorscale_calc"),f=h("../scattergl/convert").markerSelection,u=h("../scattergl/convert").markerStyle,i=h("./scene_update"),s=h("../../constants/numerical").BADNUM,o=h("../scattergl/constants").TOO_MANY_POINTS;N.exports=function(a,c){var r,n,d,l,y,v,_=c.dimensions,x=c._length,T={},A=T.cdata=[],S=T.data=[],w=c._visibleDims=[];function L(C,M){for(var P=C.makeCalcdata({v:M.values,vcalendar:c.calendar},"v"),O=0;O<P.length;O++)P[O]=P[O]===s?NaN:P[O];A.push(P),S.push(C.type==="log"?t.simpleMap(P,C.c2l):P)}for(r=0;r<_.length;r++)if((d=_[r]).visible){if(l=m.getFromId(a,c._diag[r][0]),y=m.getFromId(a,c._diag[r][1]),l&&y&&l.type!==y.type){t.log("Skipping splom dimension "+r+" with conflicting axis types");continue}l?(L(l,d),y&&y.type==="category"&&(y._categories=l._categories.slice())):L(y,d),w.push(r)}for(e(a,c),t.extendFlat(T,u(c)),v=A.length*x>o?T.sizeAvg||Math.max(T.size,3):g(c,x),n=0;n<w.length;n++)d=_[r=w[n]],l=m.getFromId(a,c._diag[r][0])||{},y=m.getFromId(a,c._diag[r][1])||{},p(a,c,l,y,A[n],A[n],v);var k=i(a,c);return k.matrix||(k.matrix=!0),k.matrixOptions=T,k.selectedOptions=f(c,c.selected),k.unselectedOptions=f(c,c.unselected),[{x:!1,y:!1,t:{},trace:c}]}},{"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/axis_ids":842,"../scatter/calc":1203,"../scatter/colorscale_calc":1205,"../scattergl/constants":1256,"../scattergl/convert":1257,"./scene_update":1307}],1301:[function(h,N,H){var t=h("../../lib"),m=h("../../plots/array_container_defaults"),g=h("./attributes"),p=h("../scatter/subtypes"),e=h("../scatter/marker_defaults"),f=h("../parcoords/merge_length"),u=h("../scattergl/helpers").isOpenSymbol;function i(s,o){function a(r,n){return t.coerce(s,o,g.dimensions,r,n)}a("label");var c=a("values");c&&c.length?a("visible"):o.visible=!1,a("axis.type"),a("axis.matches")}N.exports=function(s,o,a,c){function r(x,T){return t.coerce(s,o,g,x,T)}var n=m(s,o,{name:"dimensions",handleItemDefaults:i}),d=r("diagonal.visible"),l=r("showupperhalf"),y=r("showlowerhalf");if(f(o,n,"values")&&(d||l||y)){r("text"),r("hovertext"),r("hovertemplate"),r("xhoverformat"),r("yhoverformat"),e(s,o,a,c,r);var v=u(o.marker.symbol),_=p.isBubble(o);r("marker.line.width",v||_?1:0),function(x,T,A,S){var w,L,k=T.dimensions,C=k.length,M=T.showupperhalf,P=T.showlowerhalf,O=T.diagonal.visible,F=new Array(C),j=new Array(C);for(w=0;w<C;w++){var W=w?w+1:"";F[w]="x"+W,j[w]="y"+W}var Z=S("xaxes",F),Q=S("yaxes",j),X=T._diag=new Array(C);T._xaxes={},T._yaxes={};var G=[],Y=[];function K(ae,he,se,de){if(ae){var ce=ae.charAt(0),ve=A._splomAxes[ce];if(T["_"+ce+"axes"][ae]=1,de.push(ae),!(ae in ve)){var ke=ve[ae]={};se&&(ke.label=se.label||"",se.visible&&se.axis&&(se.axis.type&&(ke.type=se.axis.type),se.axis.matches&&(ke.matches=he)))}}}var D=!O&&!P,B=!O&&!M;for(T._axesDim={},w=0;w<C;w++){var q=k[w],ee=w===0,J=w===C-1,$=ee&&D||J&&B?void 0:Z[w],te=ee&&B||J&&D?void 0:Q[w];K($,te,q,G),K(te,$,q,Y),X[w]=[$,te],T._axesDim[$]=w,T._axesDim[te]=w}for(w=0;w<G.length;w++)for(L=0;L<Y.length;L++){var ie=G[w]+Y[L];w>L&&M||w<L&&P?A._splomSubplots[ie]=1:w!==L||!O&&P&&M||(A._splomSubplots[ie]=1)}(!P||!O&&M&&P)&&(A._splomGridDflt.xside="bottom",A._splomGridDflt.yside="left")}(0,o,c,r),t.coerceSelectionMarkerOpacity(o,r)}else o.visible=!1}},{"../../lib":787,"../../plots/array_container_defaults":833,"../parcoords/merge_length":1173,"../scatter/marker_defaults":1221,"../scatter/subtypes":1227,"../scattergl/helpers":1261,"./attributes":1298}],1302:[function(h,N,H){var t=h("../../lib"),m=h("../scatter/colorscale_calc"),g=h("../scattergl/convert").markerStyle;N.exports=function(p,e){var f=e.trace,u=p._fullLayout._splomScenes[f.uid];if(u){m(p,f),t.extendFlat(u.matrixOptions,g(f));var i=t.extendFlat({},u.matrixOptions,u.viewOpts);u.matrix.update(i,null)}}},{"../../lib":787,"../scatter/colorscale_calc":1205,"../scattergl/convert":1257}],1303:[function(h,N,H){H.getDimIndex=function(t,m){for(var g=m._id,p={x:0,y:1}[g.charAt(0)],e=t._visibleDims,f=0;f<e.length;f++){var u=e[f];if(t._diag[u][p]===g)return f}return!1}},{}],1304:[function(h,N,H){var t=h("./helpers"),m=h("../scattergl/hover").calcHover;N.exports={hoverPoints:function(g,p,e){var f=g.cd[0].trace,u=g.scene.matrixOptions.cdata,i=g.xa,s=g.ya,o=i.c2p(p),a=s.c2p(e),c=g.distance,r=t.getDimIndex(f,i),n=t.getDimIndex(f,s);if(r===!1||n===!1)return[g];for(var d,l,y=u[r],v=u[n],_=c,x=0;x<y.length;x++){var T=y[x],A=v[x],S=i.c2p(T)-o,w=s.c2p(A)-a,L=Math.sqrt(S*S+w*w);L<_&&(_=l=L,d=x)}return g.index=d,g.distance=_,g.dxy=l,d===void 0?[g]:[m(g,y,v,f)]}}},{"../scattergl/hover":1262,"./helpers":1303}],1305:[function(h,N,H){var t=h("../../registry"),m=h("../../components/grid");N.exports={moduleType:"trace",name:"splom",basePlotModule:h("./base_plot"),categories:["gl","regl","cartesian","symbols","showLegend","scatter-like"],attributes:h("./attributes"),supplyDefaults:h("./defaults"),colorbar:h("../scatter/marker_colorbar"),calc:h("./calc"),plot:h("./plot"),hoverPoints:h("./hover").hoverPoints,selectPoints:h("./select"),editStyle:h("./edit_style"),meta:{}},t.register(m)},{"../../components/grid":694,"../../registry":915,"../scatter/marker_colorbar":1220,"./attributes":1298,"./base_plot":1299,"./calc":1300,"./defaults":1301,"./edit_style":1302,"./hover":1304,"./plot":1306,"./select":1308}],1306:[function(h,N,H){var t=h("regl-splom"),m=h("../../lib"),g=h("../../plots/cartesian/axis_ids"),p=h("../../components/dragelement/helpers").selectMode;function e(f,u){var i,s,o,a,c,r=f._fullLayout,n=r._size,d=u.trace,l=u.t,y=r._splomScenes[d.uid],v=y.matrixOptions,_=v.cdata,x=r._glcanvas.data()[0].regl,T=r.dragmode;if(_.length!==0){v.lower=d.showupperhalf,v.upper=d.showlowerhalf,v.diagonal=d.diagonal.visible;var A=d._visibleDims,S=_.length,w=y.viewOpts={};for(w.ranges=new Array(S),w.domains=new Array(S),c=0;c<A.length;c++){o=A[c];var L=w.ranges[c]=new Array(4),k=w.domains[c]=new Array(4);(i=g.getFromId(f,d._diag[o][0]))&&(L[0]=i._rl[0],L[2]=i._rl[1],k[0]=i.domain[0],k[2]=i.domain[1]),(s=g.getFromId(f,d._diag[o][1]))&&(L[1]=s._rl[0],L[3]=s._rl[1],k[1]=s.domain[0],k[3]=s.domain[1])}var C=f._context.plotGlPixelRatio,M=n.l*C,P=n.b*C,O=n.w*C,F=n.h*C;w.viewport=[M,P,O+M,F+P],y.matrix===!0&&(y.matrix=t(x));var j=r.clickmode.indexOf("select")>-1,W=!0;if(p(T)||!!d.selectedpoints||j){var Z=d._length;if(d.selectedpoints){y.selectBatch=d.selectedpoints;var Q=d.selectedpoints,X={};for(o=0;o<Q.length;o++)X[Q[o]]=!0;var G=[];for(o=0;o<Z;o++)X[o]||G.push(o);y.unselectBatch=G}var Y=l.xpx=new Array(S),K=l.ypx=new Array(S);for(c=0;c<A.length;c++){if(o=A[c],i=g.getFromId(f,d._diag[o][0]))for(Y[c]=new Array(Z),a=0;a<Z;a++)Y[c][a]=i.c2p(_[c][a]);if(s=g.getFromId(f,d._diag[o][1]))for(K[c]=new Array(Z),a=0;a<Z;a++)K[c][a]=s.c2p(_[c][a])}if(y.selectBatch.length||y.unselectBatch.length){var D=m.extendFlat({},v,y.unselectedOptions,w),B=m.extendFlat({},v,y.selectedOptions,w);y.matrix.update(D,B),W=!1}}else l.xpx=l.ypx=null;if(W){var q=m.extendFlat({},v,w);y.matrix.update(q,null)}}}N.exports=function(f,u,i){if(i.length)for(var s=0;s<i.length;s++)e(f,i[s][0])}},{"../../components/dragelement/helpers":668,"../../lib":787,"../../plots/cartesian/axis_ids":842,"regl-splom":525}],1307:[function(h,N,H){var t=h("../../lib");N.exports=function(m,g){var p=m._fullLayout,e=g.uid,f=p._splomScenes;f||(f=p._splomScenes={});var u={dirty:!0,selectBatch:[],unselectBatch:[]},i=f[g.uid];return i||((i=f[e]=t.extendFlat({},u,{matrix:!1,selectBatch:[],unselectBatch:[]})).draw=function(){i.matrix&&i.matrix.draw&&(i.selectBatch.length||i.unselectBatch.length?i.matrix.draw(i.unselectBatch,i.selectBatch):i.matrix.draw()),i.dirty=!1},i.destroy=function(){i.matrix&&i.matrix.destroy&&i.matrix.destroy(),i.matrixOptions=null,i.selectBatch=null,i.unselectBatch=null,i=null}),i.dirty||t.extendFlat(i,u),i}},{"../../lib":787}],1308:[function(h,N,H){var t=h("../../lib"),m=h("../scatter/subtypes"),g=h("./helpers");N.exports=function(p,e){var f=p.cd,u=f[0].trace,i=f[0].t,s=p.scene,o=s.matrixOptions.cdata,a=p.xaxis,c=p.yaxis,r=[];if(!s)return r;var n=!m.hasMarkers(u)&&!m.hasText(u);if(u.visible!==!0||n)return r;var d=g.getDimIndex(u,a),l=g.getDimIndex(u,c);if(d===!1||l===!1)return r;var y=i.xpx[d],v=i.ypx[l],_=o[d],x=o[l],T=[],A=[];if(e!==!1&&!e.degenerate)for(var S=0;S<_.length;S++)e.contains([y[S],v[S]],null,S,p)?(T.push(S),r.push({pointNumber:S,x:_[S],y:x[S]})):A.push(S);var w=s.matrixOptions;return T.length||A.length?s.selectBatch.length||s.unselectBatch.length||s.matrix.update(s.unselectedOptions,t.extendFlat({},w,s.selectedOptions,s.viewOpts)):s.matrix.update(w,null),s.selectBatch=T,s.unselectBatch=A,r}},{"../../lib":787,"../scatter/subtypes":1227,"./helpers":1303}],1309:[function(h,N,H){var t=h("../../components/colorscale/attributes"),m=h("../../plots/cartesian/axis_format_attributes").axisHoverFormat,g=h("../../plots/template_attributes").hovertemplateAttrs,p=h("../mesh3d/attributes"),e=h("../../plots/attributes"),f=h("../../lib/extend").extendFlat,u={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},starts:{x:{valType:"data_array",editType:"calc"},y:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},editType:"calc"},maxdisplayed:{valType:"integer",min:0,dflt:1e3,editType:"calc"},sizeref:{valType:"number",editType:"calc",min:0,dflt:1},text:{valType:"string",dflt:"",editType:"calc"},hovertext:{valType:"string",dflt:"",editType:"calc"},hovertemplate:g({editType:"calc"},{keys:["tubex","tubey","tubez","tubeu","tubev","tubew","norm","divergence"]}),uhoverformat:m("u",1),vhoverformat:m("v",1),whoverformat:m("w",1),xhoverformat:m("x"),yhoverformat:m("y"),zhoverformat:m("z"),showlegend:f({},e.showlegend,{dflt:!1})};f(u,t("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"})),["opacity","lightposition","lighting"].forEach(function(i){u[i]=p[i]}),u.hoverinfo=f({},e.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","divergence","text","name"],dflt:"x+y+z+norm+text+name"}),u.transforms=void 0,N.exports=u},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../mesh3d/attributes":1143}],1310:[function(h,N,H){var t=h("../../lib"),m=h("../../components/colorscale/calc");function g(f){var u,i,s,o,a,c,r,n,d,l,y,v,_=f._x,x=f._y,T=f._z,A=f._len,S=-1/0,w=1/0,L=-1/0,k=1/0,C=-1/0,M=1/0,P="";for(A&&(r=_[0],d=x[0],y=T[0]),A>1&&(n=_[A-1],l=x[A-1],v=T[A-1]),u=0;u<A;u++)S=Math.max(S,_[u]),w=Math.min(w,_[u]),L=Math.max(L,x[u]),k=Math.min(k,x[u]),C=Math.max(C,T[u]),M=Math.min(M,T[u]),o||_[u]===r||(o=!0,P+="x"),a||x[u]===d||(a=!0,P+="y"),c||T[u]===y||(c=!0,P+="z");o||(P+="x"),a||(P+="y"),c||(P+="z");var O=p(f._x),F=p(f._y),j=p(f._z);P=(P=(P=P.replace("x",(r>n?"-":"+")+"x")).replace("y",(d>l?"-":"+")+"y")).replace("z",(y>v?"-":"+")+"z");var W=function(){A=0,O=[],F=[],j=[]};(!A||A<O.length*F.length*j.length)&&W();var Z=function(ce){return ce==="x"?_:ce==="y"?x:T},Q=function(ce){return ce==="x"?O:ce==="y"?F:j},X=function(ce){return ce[A-1]<ce[0]?-1:1},G=Z(P[1]),Y=Z(P[3]),K=Z(P[5]),D=Q(P[1]).length,B=Q(P[3]).length,q=Q(P[5]).length,ee=!1,J=function(ce,ve,ke){return D*(B*ce+ve)+ke},$=X(Z(P[1])),te=X(Z(P[3])),ie=X(Z(P[5]));for(u=0;u<q-1;u++){for(i=0;i<B-1;i++){for(s=0;s<D-1;s++){var ae=J(u,i,s),he=J(u,i,s+1),se=J(u,i+1,s),de=J(u+1,i,s);if(G[ae]*$<G[he]*$&&Y[ae]*te<Y[se]*te&&K[ae]*ie<K[de]*ie||(ee=!0),ee)break}if(ee)break}if(ee)break}return ee&&(t.warn("Encountered arbitrary coordinates! Unable to input data grid."),W()),{xMin:w,yMin:k,zMin:M,xMax:S,yMax:L,zMax:C,Xs:O,Ys:F,Zs:j,len:A,fill:P}}function p(f){return t.distinctVals(f).vals}function e(f,u){if(u===void 0&&(u=f.length),t.isTypedArray(f))return f.subarray(0,u);for(var i=[],s=0;s<u;s++)i[s]=+f[s];return i}N.exports={calc:function(f,u){u._len=Math.min(u.u.length,u.v.length,u.w.length,u.x.length,u.y.length,u.z.length),u._u=e(u.u,u._len),u._v=e(u.v,u._len),u._w=e(u.w,u._len),u._x=e(u.x,u._len),u._y=e(u.y,u._len),u._z=e(u.z,u._len);var i=g(u);u._gridFill=i.fill,u._Xs=i.Xs,u._Ys=i.Ys,u._Zs=i.Zs,u._len=i.len;var s,o,a,c=0;u.starts&&(s=e(u.starts.x||[]),o=e(u.starts.y||[]),a=e(u.starts.z||[]),c=Math.min(s.length,o.length,a.length)),u._startsX=s||[],u._startsY=o||[],u._startsZ=a||[];var r,n=0,d=1/0;for(r=0;r<u._len;r++){var l=u._u[r],y=u._v[r],v=u._w[r],_=Math.sqrt(l*l+y*y+v*v);n=Math.max(n,_),d=Math.min(d,_)}for(m(f,u,{vals:[d,n],containerStr:"",cLetter:"c"}),r=0;r<c;r++){var x=s[r];i.xMax=Math.max(i.xMax,x),i.xMin=Math.min(i.xMin,x);var T=o[r];i.yMax=Math.max(i.yMax,T),i.yMin=Math.min(i.yMin,T);var A=a[r];i.zMax=Math.max(i.zMax,A),i.zMin=Math.min(i.zMin,A)}u._slen=c,u._normMax=n,u._xbnds=[i.xMin,i.xMax],u._ybnds=[i.yMin,i.yMax],u._zbnds=[i.zMin,i.zMax]},filter:e,processGrid:g}},{"../../components/colorscale/calc":658,"../../lib":787}],1311:[function(h,N,H){var t=h("gl-streamtube3d"),m=t.createTubeMesh,g=h("../../lib"),p=h("../../lib/gl_format_color").parseColorScale,e=h("../../components/colorscale").extractOpts,f=h("../../plots/gl3d/zip3"),u={xaxis:0,yaxis:1,zaxis:2};function i(r,n){this.scene=r,this.uid=n,this.mesh=null,this.data=null}var s=i.prototype;function o(r){var n=r.length;return n>2?r.slice(1,n-1):n===2?[(r[0]+r[1])/2]:r}function a(r){var n=r.length;return n===1?[.5,.5]:[r[1]-r[0],r[n-1]-r[n-2]]}function c(r,n){var d=r.fullSceneLayout,l=r.dataScale,y=n._len,v={};function _(D,B){var q=d[B],ee=l[u[B]];return g.simpleMap(D,function(J){return q.d2l(J)*ee})}if(v.vectors=f(_(n._u,"xaxis"),_(n._v,"yaxis"),_(n._w,"zaxis"),y),!y)return{positions:[],cells:[]};var x=_(n._Xs,"xaxis"),T=_(n._Ys,"yaxis"),A=_(n._Zs,"zaxis");if(v.meshgrid=[x,T,A],v.gridFill=n._gridFill,n._slen)v.startingPositions=f(_(n._startsX,"xaxis"),_(n._startsY,"yaxis"),_(n._startsZ,"zaxis"));else{for(var S=T[0],w=o(x),L=o(A),k=new Array(w.length*L.length),C=0,M=0;M<w.length;M++)for(var P=0;P<L.length;P++)k[C++]=[w[M],S,L[P]];v.startingPositions=k}v.colormap=p(n),v.tubeSize=n.sizeref,v.maxLength=n.maxdisplayed;var O=_(n._xbnds,"xaxis"),F=_(n._ybnds,"yaxis"),j=_(n._zbnds,"zaxis"),W=a(x),Z=a(T),Q=a(A),X=[[O[0]-W[0],F[0]-Z[0],j[0]-Q[0]],[O[1]+W[1],F[1]+Z[1],j[1]+Q[1]]],G=t(v,X),Y=e(n);G.vertexIntensityBounds=[Y.min/n._normMax,Y.max/n._normMax];var K=n.lightposition;return G.lightPosition=[K.x,K.y,K.z],G.ambient=n.lighting.ambient,G.diffuse=n.lighting.diffuse,G.specular=n.lighting.specular,G.roughness=n.lighting.roughness,G.fresnel=n.lighting.fresnel,G.opacity=n.opacity,n._pad=G.tubeScale*n.sizeref*2,G}s.handlePick=function(r){var n=this.scene.fullSceneLayout,d=this.scene.dataScale;function l(_,x){var T=n[x],A=d[u[x]];return T.l2c(_)/A}if(r.object===this.mesh){var y=r.data.position,v=r.data.velocity;return r.traceCoordinate=[l(y[0],"xaxis"),l(y[1],"yaxis"),l(y[2],"zaxis"),l(v[0],"xaxis"),l(v[1],"yaxis"),l(v[2],"zaxis"),r.data.intensity*this.data._normMax,r.data.divergence],r.textLabel=this.data.hovertext||this.data.text,!0}},s.update=function(r){this.data=r;var n=c(this.scene,r);this.mesh.update(n)},s.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},N.exports=function(r,n){var d=r.glplot.gl,l=c(r,n),y=m(d,l),v=new i(r,n.uid);return v.mesh=y,v.data=n,y._trace=v,r.glplot.add(y),v}},{"../../components/colorscale":662,"../../lib":787,"../../lib/gl_format_color":783,"../../plots/gl3d/zip3":891,"gl-streamtube3d":344}],1312:[function(h,N,H){var t=h("../../lib"),m=h("../../components/colorscale/defaults"),g=h("./attributes");N.exports=function(p,e,f,u){function i(d,l){return t.coerce(p,e,g,d,l)}var s=i("u"),o=i("v"),a=i("w"),c=i("x"),r=i("y"),n=i("z");s&&s.length&&o&&o.length&&a&&a.length&&c&&c.length&&r&&r.length&&n&&n.length?(i("starts.x"),i("starts.y"),i("starts.z"),i("maxdisplayed"),i("sizeref"),i("lighting.ambient"),i("lighting.diffuse"),i("lighting.specular"),i("lighting.roughness"),i("lighting.fresnel"),i("lightposition.x"),i("lightposition.y"),i("lightposition.z"),m(p,e,u,i,{prefix:"",cLetter:"c"}),i("text"),i("hovertext"),i("hovertemplate"),i("uhoverformat"),i("vhoverformat"),i("whoverformat"),i("xhoverformat"),i("yhoverformat"),i("zhoverformat"),e._length=null):e.visible=!1}},{"../../components/colorscale/defaults":660,"../../lib":787,"./attributes":1309}],1313:[function(h,N,H){N.exports={moduleType:"trace",name:"streamtube",basePlotModule:h("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:h("./attributes"),supplyDefaults:h("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:h("./calc").calc,plot:h("./convert"),eventData:function(t,m){return t.tubex=t.x,t.tubey=t.y,t.tubez=t.z,t.tubeu=m.traceCoordinate[3],t.tubev=m.traceCoordinate[4],t.tubew=m.traceCoordinate[5],t.norm=m.traceCoordinate[6],t.divergence=m.traceCoordinate[7],delete t.x,delete t.y,delete t.z,t},meta:{}}},{"../../plots/gl3d":880,"./attributes":1309,"./calc":1310,"./convert":1311,"./defaults":1312}],1314:[function(h,N,H){var t=h("../../plots/attributes"),m=h("../../plots/template_attributes").hovertemplateAttrs,g=h("../../plots/template_attributes").texttemplateAttrs,p=h("../../components/colorscale/attributes"),e=h("../../plots/domain").attributes,f=h("../pie/attributes"),u=h("./constants"),i=h("../../lib/extend").extendFlat;N.exports={labels:{valType:"data_array",editType:"calc"},parents:{valType:"data_array",editType:"calc"},values:{valType:"data_array",editType:"calc"},branchvalues:{valType:"enumerated",values:["remainder","total"],dflt:"remainder",editType:"calc"},count:{valType:"flaglist",flags:["branches","leaves"],dflt:"leaves",editType:"calc"},level:{valType:"any",editType:"plot",anim:!0},maxdepth:{valType:"integer",editType:"plot",dflt:-1},marker:i({colors:{valType:"data_array",editType:"calc"},line:{color:i({},f.marker.line.color,{dflt:null}),width:i({},f.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},p("marker",{colorAttr:"colors",anim:!1})),leaf:{opacity:{valType:"number",editType:"style",min:0,max:1},editType:"plot"},text:f.text,textinfo:{valType:"flaglist",flags:["label","text","value","current path","percent root","percent entry","percent parent"],extras:["none"],editType:"plot"},texttemplate:g({editType:"plot"},{keys:u.eventDataKeys.concat(["label","value"])}),hovertext:f.hovertext,hoverinfo:i({},t.hoverinfo,{flags:["label","text","value","name","current path","percent root","percent entry","percent parent"],dflt:"label+text+value+name"}),hovertemplate:m({},{keys:u.eventDataKeys}),textfont:f.textfont,insidetextorientation:f.insidetextorientation,insidetextfont:f.insidetextfont,outsidetextfont:i({},f.outsidetextfont,{}),rotation:{valType:"angle",dflt:0,editType:"plot"},sort:f.sort,root:{color:{valType:"color",editType:"calc",dflt:"rgba(0,0,0,0)"},editType:"calc"},domain:e({name:"sunburst",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/domain":866,"../../plots/template_attributes":910,"../pie/attributes":1176,"./constants":1317}],1315:[function(h,N,H){var t=h("../../plots/plots");H.name="sunburst",H.plot=function(m,g,p,e){t.plotBasePlot(H.name,m,g,p,e)},H.clean=function(m,g,p,e){t.cleanBasePlot(H.name,m,g,p,e)}},{"../../plots/plots":901}],1316:[function(h,N,H){var t=h("d3-hierarchy"),m=h("fast-isnumeric"),g=h("../../lib"),p=h("../../components/colorscale").makeColorScaleFuncFromTrace,e=h("../pie/calc").makePullColorFn,f=h("../pie/calc").generateExtendedColors,u=h("../../components/colorscale").calc,i=h("../../constants/numerical").ALMOST_EQUAL,s={},o={},a={};H.calc=function(c,r){var n,d,l,y,v,_,x=c._fullLayout,T=r.ids,A=g.isArrayOrTypedArray(T),S=r.labels,w=r.parents,L=r.values,k=g.isArrayOrTypedArray(L),C=[],M={},P={},O=function(te){return te||typeof te=="number"},F=function(te){return!k||m(L[te])&&L[te]>=0};A?(n=Math.min(T.length,w.length),d=function(te){return O(T[te])&&F(te)},l=function(te){return String(T[te])}):(n=Math.min(S.length,w.length),d=function(te){return O(S[te])&&F(te)},l=function(te){return String(S[te])}),k&&(n=Math.min(n,L.length));for(var j=0;j<n;j++)if(d(j)){var W=l(j),Z=O(w[j])?String(w[j]):"",Q={i:j,id:W,pid:Z,label:O(S[j])?String(S[j]):""};k&&(Q.v=+L[j]),C.push(Q),v=W,M[y=Z]?M[y].push(v):M[y]=[v],P[v]=1}if(M[""]){if(M[""].length>1){for(var X=g.randstr(),G=0;G<C.length;G++)C[G].pid===""&&(C[G].pid=X);C.unshift({hasMultipleRoots:!0,id:X,pid:"",label:""})}}else{var Y,K=[];for(Y in M)P[Y]||K.push(Y);if(K.length!==1)return g.warn(["Multiple implied roots, cannot build",r.type,"hierarchy of",r.name+".","These roots include:",K.join(", ")].join(" "));Y=K[0],C.unshift({hasImpliedRoot:!0,id:Y,pid:"",label:Y})}try{_=t.stratify().id(function(te){return te.id}).parentId(function(te){return te.pid})(C)}catch(te){return g.warn(["Failed to build",r.type,"hierarchy of",r.name+".","Error:",te.message].join(" "))}var D=t.hierarchy(_),B=!1;if(k)switch(r.branchvalues){case"remainder":D.sum(function(te){return te.data.v});break;case"total":D.each(function(te){var ie=te.data.data,ae=ie.v;if(te.children){var he=te.children.reduce(function(se,de){return se+de.data.data.v},0);if((ie.hasImpliedRoot||ie.hasMultipleRoots)&&(ae=he),ae<he*i)return B=!0,g.warn(["Total value for node",te.data.data.id,"of",r.name,"is smaller than the sum of its children.",`
parent value =`,ae,`
children sum =`,he].join(" "))}te.value=ae})}else(function te(ie,ae,he){var se=0,de=ie.children;if(de){for(var ce=de.length,ve=0;ve<ce;ve++)se+=te(de[ve],ae,he);he.branches&&se++}else he.leaves&&se++;return ie.value=ie.data.data.value=se,ae._values||(ae._values=[]),ae._values[ie.data.data.i]=se,se})(D,r,{branches:r.count.indexOf("branches")!==-1,leaves:r.count.indexOf("leaves")!==-1});if(!B){var q,ee;r.sort&&D.sort(function(te,ie){return ie.value-te.value});var J=r.marker.colors||[],$=!!J.length;return r._hasColorscale?($||(J=k?r.values:r._values),u(c,r,{vals:J,containerStr:"marker",cLetter:"c"}),ee=p(r.marker)):q=e(x["_"+r.type+"colormap"]),D.each(function(te){var ie=te.data.data;ie.color=r._hasColorscale?ee(J[ie.i]):q(J[ie.i],ie.id)}),C[0].hierarchy=D,C}},H._runCrossTraceCalc=function(c,r){var n=r._fullLayout,d=r.calcdata,l=n[c+"colorway"],y=n["_"+c+"colormap"];n["extend"+c+"colors"]&&(l=f(l,c==="icicle"?a:c==="treemap"?o:s));var v,_=0;function x(S){var w=S.data.data,L=w.id;w.color===!1&&(y[L]?w.color=y[L]:S.parent?S.parent.parent?w.color=S.parent.data.data.color:(y[L]=w.color=l[_%l.length],_++):w.color=v)}for(var T=0;T<d.length;T++){var A=d[T][0];A.trace.type===c&&A.hierarchy&&(v=A.trace.root.color,A.hierarchy.each(x))}},H.crossTraceCalc=function(c){return H._runCrossTraceCalc("sunburst",c)}},{"../../components/colorscale":662,"../../constants/numerical":763,"../../lib":787,"../pie/calc":1178,"d3-hierarchy":167,"fast-isnumeric":246}],1317:[function(h,N,H){N.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"linear",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"]}},{}],1318:[function(h,N,H){var t=h("../../lib"),m=h("./attributes"),g=h("../../plots/domain").defaults,p=h("../bar/defaults").handleText,e=h("../../components/colorscale"),f=e.hasColorscale,u=e.handleDefaults;N.exports=function(i,s,o,a){function c(v,_){return t.coerce(i,s,m,v,_)}var r=c("labels"),n=c("parents");if(r&&r.length&&n&&n.length){var d=c("values");d&&d.length?c("branchvalues"):c("count"),c("level"),c("maxdepth"),c("marker.line.width")&&c("marker.line.color",a.paper_bgcolor),c("marker.colors");var l=s._hasColorscale=f(i,"marker","colors")||(i.marker||{}).coloraxis;l&&u(i,s,a,c,{prefix:"marker.",cLetter:"c"}),c("leaf.opacity",l?1:.7);var y=c("text");c("texttemplate"),s.texttemplate||c("textinfo",Array.isArray(y)?"text+label":"label"),c("hovertext"),c("hovertemplate"),p(i,s,a,c,"auto",{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),c("insidetextorientation"),c("sort"),c("rotation"),c("root.color"),g(s,a,c),s._length=null}else s.visible=!1}},{"../../components/colorscale":662,"../../lib":787,"../../plots/domain":866,"../bar/defaults":929,"./attributes":1314}],1319:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../registry"),g=h("../../components/fx/helpers").appendArrayPointValue,p=h("../../components/fx"),e=h("../../lib"),f=h("../../lib/events"),u=h("./helpers"),i=h("../pie/helpers").formatPieValue;function s(o,a,c){for(var r=o.data.data,n={curveNumber:a.index,pointNumber:r.i,data:a._input,fullData:a},d=0;d<c.length;d++){var l=c[d];l in o&&(n[l]=o[l])}return"parentString"in o&&!u.isHierarchyRoot(o)&&(n.parent=o.parentString),g(n,a,r.i),n}N.exports=function(o,a,c,r,n){var d=r[0],l=d.trace,y=d.hierarchy,v=l.type==="sunburst",_=l.type==="treemap"||l.type==="icicle";"_hasHoverLabel"in l||(l._hasHoverLabel=!1),"_hasHoverEvent"in l||(l._hasHoverEvent=!1),o.on("mouseover",function(x){var T=c._fullLayout;if(!c._dragging&&T.hovermode!==!1){var A,S=c._fullData[l.index],w=x.data.data,L=w.i,k=u.isHierarchyRoot(x),C=u.getParent(y,x),M=u.getValue(x),P=function($){return e.castOption(S,L,$)},O=P("hovertemplate"),F=p.castHoverinfo(S,T,L),j=T.separators;if(O||F&&F!=="none"&&F!=="skip"){var W,Z;v&&(W=d.cx+x.pxmid[0]*(1-x.rInscribed),Z=d.cy+x.pxmid[1]*(1-x.rInscribed)),_&&(W=x._hoverX,Z=x._hoverY);var Q,X={},G=[],Y=[],K=function($){return G.indexOf($)!==-1};F&&(G=F==="all"?S._module.attributes.hoverinfo.flags:F.split("+")),X.label=w.label,K("label")&&X.label&&Y.push(X.label),w.hasOwnProperty("v")&&(X.value=w.v,X.valueLabel=i(X.value,j),K("value")&&Y.push(X.valueLabel)),X.currentPath=x.currentPath=u.getPath(x.data),K("current path")&&!k&&Y.push(X.currentPath);var D=[],B=function(){D.indexOf(Q)===-1&&(Y.push(Q),D.push(Q))};X.percentParent=x.percentParent=M/u.getValue(C),X.parent=x.parentString=u.getPtLabel(C),K("percent parent")&&(Q=u.formatPercent(X.percentParent,j)+" of "+X.parent,B()),X.percentEntry=x.percentEntry=M/u.getValue(a),X.entry=x.entry=u.getPtLabel(a),!K("percent entry")||k||x.onPathbar||(Q=u.formatPercent(X.percentEntry,j)+" of "+X.entry,B()),X.percentRoot=x.percentRoot=M/u.getValue(y),X.root=x.root=u.getPtLabel(y),K("percent root")&&!k&&(Q=u.formatPercent(X.percentRoot,j)+" of "+X.root,B()),X.text=P("hovertext")||P("text"),K("text")&&(Q=X.text,e.isValidTextValue(Q)&&Y.push(Q)),A=[s(x,S,n.eventDataKeys)];var q={trace:S,y:Z,_x0:x._x0,_x1:x._x1,_y0:x._y0,_y1:x._y1,text:Y.join("<br>"),name:O||K("name")?S.name:void 0,color:P("hoverlabel.bgcolor")||w.color,borderColor:P("hoverlabel.bordercolor"),fontFamily:P("hoverlabel.font.family"),fontSize:P("hoverlabel.font.size"),fontColor:P("hoverlabel.font.color"),nameLength:P("hoverlabel.namelength"),textAlign:P("hoverlabel.align"),hovertemplate:O,hovertemplateLabels:X,eventData:A};v&&(q.x0=W-x.rInscribed*x.rpx1,q.x1=W+x.rInscribed*x.rpx1,q.idealAlign=x.pxmid[0]<0?"left":"right"),_&&(q.x=W,q.idealAlign=W<0?"left":"right");var ee=[];p.loneHover(q,{container:T._hoverlayer.node(),outerContainer:T._paper.node(),gd:c,inOut_bbox:ee}),A[0].bbox=ee[0],l._hasHoverLabel=!0}if(_){var J=o.select("path.surface");n.styleOne(J,x,S,{hovered:!0})}l._hasHoverEvent=!0,c.emit("plotly_hover",{points:A||[s(x,S,n.eventDataKeys)],event:t.event})}}),o.on("mouseout",function(x){var T=c._fullLayout,A=c._fullData[l.index],S=t.select(this).datum();if(l._hasHoverEvent&&(x.originalEvent=t.event,c.emit("plotly_unhover",{points:[s(S,A,n.eventDataKeys)],event:t.event}),l._hasHoverEvent=!1),l._hasHoverLabel&&(p.loneUnhover(T._hoverlayer.node()),l._hasHoverLabel=!1),_){var w=o.select("path.surface");n.styleOne(w,S,A,{hovered:!1})}}),o.on("click",function(x){var T=c._fullLayout,A=c._fullData[l.index],S=v&&(u.isHierarchyRoot(x)||u.isLeaf(x)),w=u.getPtId(x),L=u.isEntry(x)?u.findEntryWithChild(y,w):u.findEntryWithLevel(y,w),k=u.getPtId(L),C={points:[s(x,A,n.eventDataKeys)],event:t.event};S||(C.nextLevel=k);var M=f.triggerHandler(c,"plotly_"+l.type+"click",C);if(M!==!1&&T.hovermode&&(c._hoverdata=[s(x,A,n.eventDataKeys)],p.click(c,t.event)),!S&&M!==!1&&!c._dragging&&!c._transitioning){m.call("_storeDirectGUIEdit",A,T._tracePreGUI[A.uid],{level:A.level});var P={data:[{level:k}],traces:[l.index]},O={frame:{redraw:!1,duration:n.transitionTime},transition:{duration:n.transitionTime,easing:n.transitionEasing},mode:"immediate",fromcurrent:!0};p.loneUnhover(T._hoverlayer.node()),m.call("animate",c,P,O)}})}},{"../../components/fx":690,"../../components/fx/helpers":686,"../../lib":787,"../../lib/events":776,"../../registry":915,"../pie/helpers":1181,"./helpers":1320,"@plotly/d3":58}],1320:[function(h,N,H){var t=h("../../lib"),m=h("../../components/color"),g=h("../../lib/setcursor"),p=h("../pie/helpers");function e(f){return f.data.data.pid}H.findEntryWithLevel=function(f,u){var i;return u&&f.eachAfter(function(s){if(H.getPtId(s)===u)return i=s.copy()}),i||f},H.findEntryWithChild=function(f,u){var i;return f.eachAfter(function(s){for(var o=s.children||[],a=0;a<o.length;a++){var c=o[a];if(H.getPtId(c)===u)return i=s.copy()}}),i||f},H.isEntry=function(f){return!f.parent},H.isLeaf=function(f){return!f.children},H.getPtId=function(f){return f.data.data.id},H.getPtLabel=function(f){return f.data.data.label},H.getValue=function(f){return f.value},H.isHierarchyRoot=function(f){return e(f)===""},H.setSliceCursor=function(f,u,i){var s=i.isTransitioning;if(!s){var o=f.datum();s=i.hideOnRoot&&H.isHierarchyRoot(o)||i.hideOnLeaves&&H.isLeaf(o)}g(f,s?null:"pointer")},H.getInsideTextFontKey=function(f,u,i,s,o){var a=(o||{}).onPathbar?"pathbar.textfont":"insidetextfont",c=i.data.data.i;return t.castOption(u,c,a+"."+f)||t.castOption(u,c,"textfont."+f)||s.size},H.getOutsideTextFontKey=function(f,u,i,s){var o=i.data.data.i;return t.castOption(u,o,"outsidetextfont."+f)||t.castOption(u,o,"textfont."+f)||s.size},H.isOutsideText=function(f,u){return!f._hasColorscale&&H.isHierarchyRoot(u)},H.determineTextFont=function(f,u,i,s){return H.isOutsideText(f,u)?function(o,a,c){return{color:H.getOutsideTextFontKey("color",o,a,c),family:H.getOutsideTextFontKey("family",o,a,c),size:H.getOutsideTextFontKey("size",o,a,c)}}(f,u,i):function(o,a,c,r){var n=(r||{}).onPathbar,d=a.data.data,l=d.i,y=t.castOption(o,l,(n?"pathbar.textfont":"insidetextfont")+".color");return!y&&o._input.textfont&&(y=t.castOption(o._input,l,"textfont.color")),{color:y||m.contrast(d.color),family:H.getInsideTextFontKey("family",o,a,c,r),size:H.getInsideTextFontKey("size",o,a,c,r)}}(f,u,i,s)},H.hasTransition=function(f){return!!(f&&f.duration>0)},H.getMaxDepth=function(f){return f.maxdepth>=0?f.maxdepth:1/0},H.isHeader=function(f,u){return!(H.isLeaf(f)||f.depth===u._maxDepth-1)},H.getParent=function(f,u){return H.findEntryWithLevel(f,e(u))},H.listPath=function(f,u){var i=f.parent;if(!i)return[];var s=u?[i.data[u]]:[i];return H.listPath(i,u).concat(s)},H.getPath=function(f){return H.listPath(f,"label").join("/")+"/"},H.formatValue=p.formatPieValue,H.formatPercent=function(f,u){var i=t.formatPercent(f,0);return i==="0%"&&(i=p.formatPiePercent(f,u)),i}},{"../../components/color":650,"../../lib":787,"../../lib/setcursor":808,"../pie/helpers":1181}],1321:[function(h,N,H){N.exports={moduleType:"trace",name:"sunburst",basePlotModule:h("./base_plot"),categories:[],animatable:!0,attributes:h("./attributes"),layoutAttributes:h("./layout_attributes"),supplyDefaults:h("./defaults"),supplyLayoutDefaults:h("./layout_defaults"),calc:h("./calc").calc,crossTraceCalc:h("./calc").crossTraceCalc,plot:h("./plot").plot,style:h("./style").style,colorbar:h("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":1220,"./attributes":1314,"./base_plot":1315,"./calc":1316,"./defaults":1318,"./layout_attributes":1322,"./layout_defaults":1323,"./plot":1324,"./style":1325}],1322:[function(h,N,H){N.exports={sunburstcolorway:{valType:"colorlist",editType:"calc"},extendsunburstcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1323:[function(h,N,H){var t=h("../../lib"),m=h("./layout_attributes");N.exports=function(g,p){function e(f,u){return t.coerce(g,p,m,f,u)}e("sunburstcolorway",p.colorway),e("extendsunburstcolors")}},{"../../lib":787,"./layout_attributes":1322}],1324:[function(h,N,H){var t=h("@plotly/d3"),m=h("d3-hierarchy"),g=h("d3-interpolate").interpolate,p=h("../../components/drawing"),e=h("../../lib"),f=h("../../lib/svg_text_utils"),u=h("../bar/uniform_text"),i=u.recordMinTextSize,s=u.clearMinTextSize,o=h("../pie/plot"),a=h("../pie/helpers").getRotationAngle,c=o.computeTransform,r=o.transformInsideText,n=h("./style").styleOne,d=h("../bar/style").resizeText,l=h("./fx"),y=h("./constants"),v=h("./helpers");function _(T,A,S,w){var L=T._fullLayout,k=!L.uniformtext.mode&&v.hasTransition(w),C=t.select(S).selectAll("g.slice"),M=A[0],P=M.trace,O=M.hierarchy,F=v.findEntryWithLevel(O,P.level),j=v.getMaxDepth(P),W=L._size,Z=P.domain,Q=W.w*(Z.x[1]-Z.x[0]),X=W.h*(Z.y[1]-Z.y[0]),G=.5*Math.min(Q,X),Y=M.cx=W.l+W.w*(Z.x[1]+Z.x[0])/2,K=M.cy=W.t+W.h*(1-Z.y[0])-X/2;if(!F)return C.remove();var D=null,B={};k&&C.each(function(xe){B[v.getPtId(xe)]={rpx0:xe.rpx0,rpx1:xe.rpx1,x0:xe.x0,x1:xe.x1,transform:xe.transform},!D&&v.isEntry(xe)&&(D=xe)});var q=function(xe){return m.partition().size([2*Math.PI,xe.height+1])(xe)}(F).descendants(),ee=F.height+1,J=0,$=j;M.hasMultipleRoots&&v.isHierarchyRoot(F)&&(q=q.slice(1),ee-=1,J=1,$+=1),q=q.filter(function(xe){return xe.y1<=$});var te=a(P.rotation);te&&q.forEach(function(xe){xe.x0+=te,xe.x1+=te});var ie=Math.min(ee,j),ae=function(xe){return(xe-J)/ie*G},he=function(xe,ue){return[xe*Math.cos(ue),-xe*Math.sin(ue)]},se=function(xe){return e.pathAnnulus(xe.rpx0,xe.rpx1,xe.x0,xe.x1,Y,K)},de=function(xe){return Y+x(xe)[0]*(xe.transform.rCenter||0)+(xe.transform.x||0)},ce=function(xe){return K+x(xe)[1]*(xe.transform.rCenter||0)+(xe.transform.y||0)};(C=C.data(q,v.getPtId)).enter().append("g").classed("slice",!0),k?C.exit().transition().each(function(){var xe=t.select(this);xe.select("path.surface").transition().attrTween("d",function(ue){var me=function(we){var Me,Se=v.getPtId(we),De=B[Se],Fe=B[v.getPtId(F)];if(Fe){var Ye=(we.x1>Fe.x1?2*Math.PI:0)+te;Me=we.rpx1<Fe.rpx1?{x0:we.x0,x1:we.x1,rpx0:0,rpx1:0}:{x0:Ye,x1:Ye,rpx0:we.rpx0,rpx1:we.rpx1}}else{var et,Oe=v.getPtId(we.parent);C.each(function(it){if(v.getPtId(it)===Oe)return et=it});var je,We=et.children;We.forEach(function(it,lt){if(v.getPtId(it)===Se)return je=lt});var Ge=We.length,Qe=g(et.x0,et.x1);Me={rpx0:G,rpx1:G,x0:Qe(je/Ge),x1:Qe((je+1)/Ge)}}return g(De,Me)}(ue);return function(we){return se(me(we))}}),xe.select("g.slicetext").attr("opacity",0)}).remove():C.exit().remove(),C.order();var ve=null;if(k&&D){var ke=v.getPtId(D);C.each(function(xe){ve===null&&v.getPtId(xe)===ke&&(ve=xe.x1)})}var Ee=C;function be(xe){var ue=xe.parent,me=B[v.getPtId(ue)],we={};if(me){var Me=ue.children,Se=Me.indexOf(xe),De=Me.length,Fe=g(me.x0,me.x1);we.x0=Fe(Se/De),we.x1=Fe(Se/De)}else we.x0=we.x1=0;return we}k&&(Ee=Ee.transition().each("end",function(){var xe=t.select(this);v.setSliceCursor(xe,T,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:!1})})),Ee.each(function(xe){var ue=t.select(this),me=e.ensureSingle(ue,"path","surface",function(Ye){Ye.style("pointer-events","all")});xe.rpx0=ae(xe.y0),xe.rpx1=ae(xe.y1),xe.xmid=(xe.x0+xe.x1)/2,xe.pxmid=he(xe.rpx1,xe.xmid),xe.midangle=-(xe.xmid-Math.PI/2),xe.startangle=-(xe.x0-Math.PI/2),xe.stopangle=-(xe.x1-Math.PI/2),xe.halfangle=.5*Math.min(e.angleDelta(xe.x0,xe.x1)||Math.PI,Math.PI),xe.ring=1-xe.rpx0/xe.rpx1,xe.rInscribed=function(Ye){return Ye.rpx0===0&&e.isFullCircle([Ye.x0,Ye.x1])?1:Math.max(0,Math.min(1/(1+1/Math.sin(Ye.halfangle)),Ye.ring/2))}(xe),k?me.transition().attrTween("d",function(Ye){var et=function(Oe){var je,We=B[v.getPtId(Oe)],Ge={x0:Oe.x0,x1:Oe.x1,rpx0:Oe.rpx0,rpx1:Oe.rpx1};if(We)je=We;else if(D)if(Oe.parent)if(ve){var Qe=(Oe.x1>ve?2*Math.PI:0)+te;je={x0:Qe,x1:Qe}}else je={rpx0:G,rpx1:G},e.extendFlat(je,be(Oe));else je={rpx0:0,rpx1:0};else je={x0:te,x1:te};return g(je,Ge)}(Ye);return function(Oe){return se(et(Oe))}}):me.attr("d",se),ue.call(l,F,T,A,{eventDataKeys:y.eventDataKeys,transitionTime:y.CLICK_TRANSITION_TIME,transitionEasing:y.CLICK_TRANSITION_EASING}).call(v.setSliceCursor,T,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:T._transitioning}),me.call(n,xe,P);var we=e.ensureSingle(ue,"g","slicetext"),Me=e.ensureSingle(we,"text","",function(Ye){Ye.attr("data-notex",1)}),Se=e.ensureUniformFontSize(T,v.determineTextFont(P,xe,L.font));Me.text(H.formatSliceLabel(xe,F,P,A,L)).classed("slicetext",!0).attr("text-anchor","middle").call(p.font,Se).call(f.convertToTspans,T);var De=p.bBox(Me.node());xe.transform=r(De,xe,M),xe.transform.targetX=de(xe),xe.transform.targetY=ce(xe);var Fe=function(Ye,et){var Oe=Ye.transform;return c(Oe,et),Oe.fontSize=Se.size,i(P.type,Oe,L),e.getTextTransform(Oe)};k?Me.transition().attrTween("transform",function(Ye){var et=function(Oe){var je,We=B[v.getPtId(Oe)],Ge=Oe.transform;if(We)je=We;else if(je={rpx1:Oe.rpx1,transform:{textPosAngle:Ge.textPosAngle,scale:0,rotate:Ge.rotate,rCenter:Ge.rCenter,x:Ge.x,y:Ge.y}},D)if(Oe.parent)if(ve){var Qe=Oe.x1>ve?2*Math.PI:0;je.x0=je.x1=Qe}else e.extendFlat(je,be(Oe));else je.x0=je.x1=te;else je.x0=je.x1=te;var it=g(je.transform.textPosAngle,Oe.transform.textPosAngle),lt=g(je.rpx1,Oe.rpx1),Lt=g(je.x0,Oe.x0),wt=g(je.x1,Oe.x1),rt=g(je.transform.scale,Ge.scale),$e=g(je.transform.rotate,Ge.rotate),xt=Ge.rCenter===0?3:je.transform.rCenter===0?1/3:1,Qt=g(je.transform.rCenter,Ge.rCenter);return function($t){var Ue=lt($t),He=Lt($t),Be=wt($t),Je=function(Le){return Qt(Math.pow(Le,xt))}($t),_e={pxmid:he(Ue,(He+Be)/2),rpx1:Ue,transform:{textPosAngle:it($t),rCenter:Je,x:Ge.x,y:Ge.y}};return i(P.type,Ge,L),{transform:{targetX:de(_e),targetY:ce(_e),scale:rt($t),rotate:$e($t),rCenter:Je}}}}(Ye);return function(Oe){return Fe(et(Oe),De)}}):Me.attr("transform",Fe(xe,De))})}function x(T){return A=T.rpx1,S=T.transform.textPosAngle,[A*Math.sin(S),-A*Math.cos(S)];var A,S}H.plot=function(T,A,S,w){var L,k,C=T._fullLayout,M=C._sunburstlayer,P=!S,O=!C.uniformtext.mode&&v.hasTransition(S);s("sunburst",C),(L=M.selectAll("g.trace.sunburst").data(A,function(F){return F[0].trace.uid})).enter().append("g").classed("trace",!0).classed("sunburst",!0).attr("stroke-linejoin","round"),L.order(),O?(w&&(k=w()),t.transition().duration(S.duration).ease(S.easing).each("end",function(){k&&k()}).each("interrupt",function(){k&&k()}).each(function(){M.selectAll("g.trace").each(function(F){_(T,F,this,S)})})):(L.each(function(F){_(T,F,this,S)}),C.uniformtext.mode&&d(T,C._sunburstlayer.selectAll(".trace"),"sunburst")),P&&L.exit().remove()},H.formatSliceLabel=function(T,A,S,w,L){var k=S.texttemplate,C=S.textinfo;if(!(k||C&&C!=="none"))return"";var M=L.separators,P=w[0],O=T.data.data,F=P.hierarchy,j=v.isHierarchyRoot(T),W=v.getParent(F,T),Z=v.getValue(T);if(!k){var Q,X=C.split("+"),G=function(te){return X.indexOf(te)!==-1},Y=[];if(G("label")&&O.label&&Y.push(O.label),O.hasOwnProperty("v")&&G("value")&&Y.push(v.formatValue(O.v,M)),!j){G("current path")&&Y.push(v.getPath(T.data));var K=0;G("percent parent")&&K++,G("percent entry")&&K++,G("percent root")&&K++;var D=K>1;if(K){var B,q=function(te){Q=v.formatPercent(B,M),D&&(Q+=" of "+te),Y.push(Q)};G("percent parent")&&!j&&(B=Z/v.getValue(W),q("parent")),G("percent entry")&&(B=Z/v.getValue(A),q("entry")),G("percent root")&&(B=Z/v.getValue(F),q("root"))}}return G("text")&&(Q=e.castOption(S,O.i,"text"),e.isValidTextValue(Q)&&Y.push(Q)),Y.join("<br>")}var ee=e.castOption(S,O.i,"texttemplate");if(!ee)return"";var J={};O.label&&(J.label=O.label),O.hasOwnProperty("v")&&(J.value=O.v,J.valueLabel=v.formatValue(O.v,M)),J.currentPath=v.getPath(T.data),j||(J.percentParent=Z/v.getValue(W),J.percentParentLabel=v.formatPercent(J.percentParent,M),J.parent=v.getPtLabel(W)),J.percentEntry=Z/v.getValue(A),J.percentEntryLabel=v.formatPercent(J.percentEntry,M),J.entry=v.getPtLabel(A),J.percentRoot=Z/v.getValue(F),J.percentRootLabel=v.formatPercent(J.percentRoot,M),J.root=v.getPtLabel(F),O.hasOwnProperty("color")&&(J.color=O.color);var $=e.castOption(S,O.i,"text");return(e.isValidTextValue($)||$==="")&&(J.text=$),J.customdata=e.castOption(S,O.i,"customdata"),e.texttemplateString(ee,J,L._d3locale,J,S._meta||{})}},{"../../components/drawing":672,"../../lib":787,"../../lib/svg_text_utils":813,"../bar/style":939,"../bar/uniform_text":941,"../pie/helpers":1181,"../pie/plot":1185,"./constants":1317,"./fx":1319,"./helpers":1320,"./style":1325,"@plotly/d3":58,"d3-hierarchy":167,"d3-interpolate":168}],1325:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../components/color"),g=h("../../lib"),p=h("../bar/uniform_text").resizeText;function e(f,u,i){var s=u.data.data,o=!u.children,a=s.i,c=g.castOption(i,a,"marker.line.color")||m.defaultLine,r=g.castOption(i,a,"marker.line.width")||0;f.style("stroke-width",r).call(m.fill,s.color).call(m.stroke,c).style("opacity",o?i.leaf.opacity:null)}N.exports={style:function(f){var u=f._fullLayout._sunburstlayer.selectAll(".trace");p(f,u,"sunburst"),u.each(function(i){var s=t.select(this),o=i[0].trace;s.style("opacity",o.opacity),s.selectAll("path.surface").each(function(a){t.select(this).call(e,a,o)})})},styleOne:e}},{"../../components/color":650,"../../lib":787,"../bar/uniform_text":941,"@plotly/d3":58}],1326:[function(h,N,H){var t=h("../../components/color"),m=h("../../components/colorscale/attributes"),g=h("../../plots/cartesian/axis_format_attributes").axisHoverFormat,p=h("../../plots/template_attributes").hovertemplateAttrs,e=h("../../plots/attributes"),f=h("../../lib/extend").extendFlat,u=h("../../plot_api/edit_types").overrideAll;function i(o){return{show:{valType:"boolean",dflt:!1},start:{valType:"number",dflt:null,editType:"plot"},end:{valType:"number",dflt:null,editType:"plot"},size:{valType:"number",dflt:null,min:0,editType:"plot"},project:{x:{valType:"boolean",dflt:!1},y:{valType:"boolean",dflt:!1},z:{valType:"boolean",dflt:!1}},color:{valType:"color",dflt:t.defaultLine},usecolormap:{valType:"boolean",dflt:!1},width:{valType:"number",min:1,max:16,dflt:2},highlight:{valType:"boolean",dflt:!0},highlightcolor:{valType:"color",dflt:t.defaultLine},highlightwidth:{valType:"number",min:1,max:16,dflt:2}}}var s=N.exports=u(f({z:{valType:"data_array"},x:{valType:"data_array"},y:{valType:"data_array"},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:p(),xhoverformat:g("x"),yhoverformat:g("y"),zhoverformat:g("z"),connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},surfacecolor:{valType:"data_array"}},m("",{colorAttr:"z or surfacecolor",showScaleDflt:!0,autoColorDflt:!1,editTypeOverride:"calc"}),{contours:{x:i(),y:i(),z:i()},hidesurface:{valType:"boolean",dflt:!1},lightposition:{x:{valType:"number",min:-1e5,max:1e5,dflt:10},y:{valType:"number",min:-1e5,max:1e5,dflt:1e4},z:{valType:"number",min:-1e5,max:1e5,dflt:0}},lighting:{ambient:{valType:"number",min:0,max:1,dflt:.8},diffuse:{valType:"number",min:0,max:1,dflt:.8},specular:{valType:"number",min:0,max:2,dflt:.05},roughness:{valType:"number",min:0,max:1,dflt:.5},fresnel:{valType:"number",min:0,max:5,dflt:.2}},opacity:{valType:"number",min:0,max:1,dflt:1},opacityscale:{valType:"any",editType:"calc"},_deprecated:{zauto:f({},m.zauto,{}),zmin:f({},m.zmin,{}),zmax:f({},m.zmax,{})},hoverinfo:f({},e.hoverinfo),showlegend:f({},e.showlegend,{dflt:!1})}),"calc","nested");s.x.editType=s.y.editType=s.z.editType="calc+clearAxisTypes",s.transforms=void 0},{"../../components/color":650,"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910}],1327:[function(h,N,H){var t=h("../../components/colorscale/calc");N.exports=function(m,g){g.surfacecolor?t(m,g,{vals:g.surfacecolor,containerStr:"",cLetter:"c"}):t(m,g,{vals:g.z,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":658}],1328:[function(h,N,H){var t=h("gl-surface3d"),m=h("ndarray"),g=h("ndarray-linear-interpolate").d2,p=h("../heatmap/interp2d"),e=h("../heatmap/find_empties"),f=h("../../lib").isArrayOrTypedArray,u=h("../../lib/gl_format_color").parseColorScale,i=h("../../lib/str2rgbarray"),s=h("../../components/colorscale").extractOpts;function o(S,w,L){this.scene=S,this.uid=L,this.surface=w,this.data=null,this.showContour=[!1,!1,!1],this.contourStart=[null,null,null],this.contourEnd=[null,null,null],this.contourSize=[0,0,0],this.minValues=[1/0,1/0,1/0],this.maxValues=[-1/0,-1/0,-1/0],this.dataScaleX=1,this.dataScaleY=1,this.refineData=!0,this.objectOffset=[0,0,0]}var a=o.prototype;a.getXat=function(S,w,L,k){var C=f(this.data.x)?f(this.data.x[0])?this.data.x[w][S]:this.data.x[S]:S;return L===void 0?C:k.d2l(C,0,L)},a.getYat=function(S,w,L,k){var C=f(this.data.y)?f(this.data.y[0])?this.data.y[w][S]:this.data.y[w]:w;return L===void 0?C:k.d2l(C,0,L)},a.getZat=function(S,w,L,k){var C=this.data.z[w][S];return C===null&&this.data.connectgaps&&this.data._interpolatedZ&&(C=this.data._interpolatedZ[w][S]),L===void 0?C:k.d2l(C,0,L)},a.handlePick=function(S){if(S.object===this.surface){var w=(S.data.index[0]-1)/this.dataScaleX-1,L=(S.data.index[1]-1)/this.dataScaleY-1,k=Math.max(Math.min(Math.round(w),this.data.z[0].length-1),0),C=Math.max(Math.min(Math.round(L),this.data._ylength-1),0);S.index=[k,C],S.traceCoordinate=[this.getXat(k,C),this.getYat(k,C),this.getZat(k,C)],S.dataCoordinate=[this.getXat(k,C,this.data.xcalendar,this.scene.fullSceneLayout.xaxis),this.getYat(k,C,this.data.ycalendar,this.scene.fullSceneLayout.yaxis),this.getZat(k,C,this.data.zcalendar,this.scene.fullSceneLayout.zaxis)];for(var M=0;M<3;M++){var P=S.dataCoordinate[M];P!=null&&(S.dataCoordinate[M]*=this.scene.dataScale[M])}var O=this.data.hovertext||this.data.text;return Array.isArray(O)&&O[C]&&O[C][k]!==void 0?S.textLabel=O[C][k]:S.textLabel=O||"",S.data.dataCoordinate=S.dataCoordinate.slice(),this.surface.highlight(S.data),this.scene.glplot.spikes.position=S.dataCoordinate,!0}};var c=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999];function r(S,w){if(S<w)return 0;for(var L=0;Math.floor(S%w)===0;)S/=w,L++;return L}function n(S){for(var w=[],L=0;L<c.length;L++){var k=c[L];w.push(r(S,k))}return w}function d(S){for(var w=n(S),L=S,k=0;k<c.length;k++)if(w[k]>0){L=c[k];break}return L}function l(S,w){if(!(S<1||w<1)){for(var L=n(S),k=n(w),C=1,M=0;M<c.length;M++)C*=Math.pow(c[M],Math.max(L[M],k[M]));return C}}a.calcXnums=function(S){var w,L=[];for(w=1;w<S;w++){var k=this.getXat(w-1,0),C=this.getXat(w,0);L[w-1]=C!==k&&k!=null&&C!=null?Math.abs(C-k):0}var M=0;for(w=1;w<S;w++)M+=L[w-1];for(w=1;w<S;w++)L[w-1]===0?L[w-1]=1:L[w-1]=Math.round(M/L[w-1]);return L},a.calcYnums=function(S){var w,L=[];for(w=1;w<S;w++){var k=this.getYat(0,w-1),C=this.getYat(0,w);L[w-1]=C!==k&&k!=null&&C!=null?Math.abs(C-k):0}var M=0;for(w=1;w<S;w++)M+=L[w-1];for(w=1;w<S;w++)L[w-1]===0?L[w-1]=1:L[w-1]=Math.round(M/L[w-1]);return L};var y=[1,2,4,6,12,24,36,48,60,120,180,240,360,720,840,1260],v=y[9],_=y[13];function x(S,w,L){var k=L[8]+L[2]*w[0]+L[5]*w[1];return S[0]=(L[6]+L[0]*w[0]+L[3]*w[1])/k,S[1]=(L[7]+L[1]*w[0]+L[4]*w[1])/k,S}function T(S,w,L){return function(k,C,M,P){for(var O=[0,0],F=k.shape[0],j=k.shape[1],W=0;W<F;W++)for(var Z=0;Z<j;Z++)M(O,[W,Z],P),k.set(W,Z,g(C,O[0],O[1]))}(S,w,x,L),S}function A(S,w){for(var L=!1,k=0;k<S.length;k++)if(w===S[k]){L=!0;break}L===!1&&S.push(w)}a.estimateScale=function(S,w){for(var L=1+function(C){if(C.length!==0){for(var M=1,P=0;P<C.length;P++)M=l(M,C[P]);return M}}(w===0?this.calcXnums(S):this.calcYnums(S));L<v;)L*=2;for(;L>_;)L--,L/=d(L),++L<v&&(L=_);var k=Math.round(L/S);return k>1?k:1},a.refineCoords=function(S){for(var w=this.dataScaleX,L=this.dataScaleY,k=S[0].shape[0],C=S[0].shape[1],M=0|Math.floor(S[0].shape[0]*w+1),P=0|Math.floor(S[0].shape[1]*L+1),O=1+k+1,F=1+C+1,j=m(new Float32Array(O*F),[O,F]),W=[1/w,0,0,0,1/L,0,0,0,1],Z=0;Z<S.length;++Z){this.surface.padField(j,S[Z]);var Q=m(new Float32Array(M*P),[M,P]);T(Q,j,W),S[Z]=Q}},a.setContourLevels=function(){var S,w,L,k=[[],[],[]],C=[!1,!1,!1],M=!1;for(S=0;S<3;++S)if(this.showContour[S]&&(M=!0,this.contourSize[S]>0&&this.contourStart[S]!==null&&this.contourEnd[S]!==null&&this.contourEnd[S]>this.contourStart[S]))for(C[S]=!0,w=this.contourStart[S];w<this.contourEnd[S];w+=this.contourSize[S])L=w*this.scene.dataScale[S],A(k[S],L);if(M){var P=[[],[],[]];for(S=0;S<3;++S)this.showContour[S]&&(P[S]=C[S]?k[S]:this.scene.contourLevels[S]);this.surface.update({levels:P})}},a.update=function(S){var w,L,k,C,M=this.scene,P=M.fullSceneLayout,O=this.surface,F=u(S),j=M.dataScale,W=S.z[0].length,Z=S._ylength,Q=M.contourLevels;this.data=S;var X=[];for(w=0;w<3;w++)for(X[w]=[],L=0;L<W;L++)X[w][L]=[];for(L=0;L<W;L++)for(k=0;k<Z;k++)X[0][L][k]=this.getXat(L,k,S.xcalendar,P.xaxis),X[1][L][k]=this.getYat(L,k,S.ycalendar,P.yaxis),X[2][L][k]=this.getZat(L,k,S.zcalendar,P.zaxis);if(S.connectgaps)for(S._emptypoints=e(X[2]),p(X[2],S._emptypoints),S._interpolatedZ=[],L=0;L<W;L++)for(S._interpolatedZ[L]=[],k=0;k<Z;k++)S._interpolatedZ[L][k]=X[2][L][k];for(w=0;w<3;w++)for(L=0;L<W;L++)for(k=0;k<Z;k++)(C=X[w][L][k])==null?X[w][L][k]=NaN:C=X[w][L][k]*=j[w];for(w=0;w<3;w++)for(L=0;L<W;L++)for(k=0;k<Z;k++)(C=X[w][L][k])!=null&&(this.minValues[w]>C&&(this.minValues[w]=C),this.maxValues[w]<C&&(this.maxValues[w]=C));for(w=0;w<3;w++)this.objectOffset[w]=.5*(this.minValues[w]+this.maxValues[w]);for(w=0;w<3;w++)for(L=0;L<W;L++)for(k=0;k<Z;k++)(C=X[w][L][k])!=null&&(X[w][L][k]-=this.objectOffset[w]);var G=[m(new Float32Array(W*Z),[W,Z]),m(new Float32Array(W*Z),[W,Z]),m(new Float32Array(W*Z),[W,Z])];for(w=0;w<3;w++)for(L=0;L<W;L++)for(k=0;k<Z;k++)G[w].set(L,k,X[w][L][k]);X=[];var Y={colormap:F,levels:[[],[],[]],showContour:[!0,!0,!0],showSurface:!S.hidesurface,contourProject:[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],contourWidth:[1,1,1],contourColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],contourTint:[1,1,1],dynamicColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],dynamicWidth:[1,1,1],dynamicTint:[1,1,1],opacityscale:S.opacityscale,opacity:S.opacity},K=s(S);if(Y.intensityBounds=[K.min,K.max],S.surfacecolor){var D=m(new Float32Array(W*Z),[W,Z]);for(L=0;L<W;L++)for(k=0;k<Z;k++)D.set(L,k,S.surfacecolor[k][L]);G.push(D)}else Y.intensityBounds[0]*=j[2],Y.intensityBounds[1]*=j[2];(_<G[0].shape[0]||_<G[0].shape[1])&&(this.refineData=!1),this.refineData===!0&&(this.dataScaleX=this.estimateScale(G[0].shape[0],0),this.dataScaleY=this.estimateScale(G[0].shape[1],1),this.dataScaleX===1&&this.dataScaleY===1||this.refineCoords(G)),S.surfacecolor&&(Y.intensity=G.pop());var B=[!0,!0,!0],q=["x","y","z"];for(w=0;w<3;++w){var ee=S.contours[q[w]];B[w]=ee.highlight,Y.showContour[w]=ee.show||ee.highlight,Y.showContour[w]&&(Y.contourProject[w]=[ee.project.x,ee.project.y,ee.project.z],ee.show?(this.showContour[w]=!0,Y.levels[w]=Q[w],O.highlightColor[w]=Y.contourColor[w]=i(ee.color),ee.usecolormap?O.highlightTint[w]=Y.contourTint[w]=0:O.highlightTint[w]=Y.contourTint[w]=1,Y.contourWidth[w]=ee.width,this.contourStart[w]=ee.start,this.contourEnd[w]=ee.end,this.contourSize[w]=ee.size):(this.showContour[w]=!1,this.contourStart[w]=null,this.contourEnd[w]=null,this.contourSize[w]=0),ee.highlight&&(Y.dynamicColor[w]=i(ee.highlightcolor),Y.dynamicWidth[w]=ee.highlightwidth))}(function(J){var $=J[0].rgb,te=J[J.length-1].rgb;return $[0]===te[0]&&$[1]===te[1]&&$[2]===te[2]&&$[3]===te[3]})(F)&&(Y.vertexColor=!0),Y.objectOffset=this.objectOffset,Y.coords=G,O.update(Y),O.visible=S.visible,O.enableDynamic=B,O.enableHighlight=B,O.snapToData=!0,"lighting"in S&&(O.ambientLight=S.lighting.ambient,O.diffuseLight=S.lighting.diffuse,O.specularLight=S.lighting.specular,O.roughness=S.lighting.roughness,O.fresnel=S.lighting.fresnel),"lightposition"in S&&(O.lightPosition=[S.lightposition.x,S.lightposition.y,S.lightposition.z])},a.dispose=function(){this.scene.glplot.remove(this.surface),this.surface.dispose()},N.exports=function(S,w){var L=S.glplot.gl,k=t({gl:L}),C=new o(S,k,w.uid);return k._trace=C,C.update(w),S.glplot.add(k),C}},{"../../components/colorscale":662,"../../lib":787,"../../lib/gl_format_color":783,"../../lib/str2rgbarray":812,"../heatmap/find_empties":1075,"../heatmap/interp2d":1078,"gl-surface3d":346,ndarray:472,"ndarray-linear-interpolate":466}],1329:[function(h,N,H){var t=h("../../registry"),m=h("../../lib"),g=h("../../components/colorscale/defaults"),p=h("./attributes");function e(u,i,s,o){var a=o("opacityscale");a==="max"?i.opacityscale=[[0,.1],[1,1]]:a==="min"?i.opacityscale=[[0,1],[1,.1]]:a==="extremes"?i.opacityscale=function(c,r){for(var n=[],d=0;d<32;d++){var l=d/31,y=r+(1-r)*(1-Math.pow(Math.sin(c*l*Math.PI),2));n.push([l,Math.max(0,Math.min(1,y))])}return n}(1,.1):function(c){var r=0;if(!Array.isArray(c)||c.length<2||!c[0]||!c[c.length-1]||+c[0][0]!=0||+c[c.length-1][0]!=1)return!1;for(var n=0;n<c.length;n++){var d=c[n];if(d.length!==2||+d[0]<r)return!1;r=+d[0]}return!0}(a)||(i.opacityscale=void 0)}function f(u,i,s){i in u&&!(s in u)&&(u[s]=u[i])}N.exports={supplyDefaults:function(u,i,s,o){var a,c;function r(A,S){return m.coerce(u,i,p,A,S)}var n=r("x"),d=r("y"),l=r("z");if(!l||!l.length||n&&n.length<1||d&&d.length<1)i.visible=!1;else{i._xlength=Array.isArray(n)&&m.isArrayOrTypedArray(n[0])?l.length:l[0].length,i._ylength=l.length,t.getComponentMethod("calendars","handleTraceDefaults")(u,i,["x","y","z"],o),r("text"),r("hovertext"),r("hovertemplate"),r("xhoverformat"),r("yhoverformat"),r("zhoverformat"),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lightposition.x","lightposition.y","lightposition.z","hidesurface","connectgaps","opacity"].forEach(function(A){r(A)});var y=r("surfacecolor"),v=["x","y","z"];for(a=0;a<3;++a){var _="contours."+v[a],x=r(_+".show"),T=r(_+".highlight");if(x||T)for(c=0;c<3;++c)r(_+".project."+v[c]);x&&(r(_+".color"),r(_+".width"),r(_+".usecolormap")),T&&(r(_+".highlightcolor"),r(_+".highlightwidth")),r(_+".start"),r(_+".end"),r(_+".size")}y||(f(u,"zmin","cmin"),f(u,"zmax","cmax"),f(u,"zauto","cauto")),g(u,i,o,r,{prefix:"",cLetter:"c"}),e(u,i,o,r),i._length=null}},opacityscaleDefaults:e}},{"../../components/colorscale/defaults":660,"../../lib":787,"../../registry":915,"./attributes":1326}],1330:[function(h,N,H){N.exports={attributes:h("./attributes"),supplyDefaults:h("./defaults").supplyDefaults,colorbar:{min:"cmin",max:"cmax"},calc:h("./calc"),plot:h("./convert"),moduleType:"trace",name:"surface",basePlotModule:h("../../plots/gl3d"),categories:["gl3d","2dMap","showLegend"],meta:{}}},{"../../plots/gl3d":880,"./attributes":1326,"./calc":1327,"./convert":1328,"./defaults":1329}],1331:[function(h,N,H){var t=h("../../components/annotations/attributes"),m=h("../../lib/extend").extendFlat,g=h("../../plot_api/edit_types").overrideAll,p=h("../../plots/font_attributes"),e=h("../../plots/domain").attributes,f=h("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers;(N.exports=g({domain:e({name:"table",trace:!0}),columnwidth:{valType:"number",arrayOk:!0,dflt:null},columnorder:{valType:"data_array"},header:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[],description:f("cell value")},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:28},align:m({},t.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:m({},p({arrayOk:!0}))},cells:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[],description:f("cell value")},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:20},align:m({},t.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:m({},p({arrayOk:!0}))}},"calc","from-root")).transforms=void 0},{"../../components/annotations/attributes":633,"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plots/cartesian/axis_format_attributes":841,"../../plots/domain":866,"../../plots/font_attributes":867}],1332:[function(h,N,H){var t=h("../../plots/get_data").getModuleCalcData,m=h("./plot");H.name="table",H.plot=function(g){var p=t(g.calcdata,"table")[0];p.length&&m(g,p)},H.clean=function(g,p,e,f){var u=f._has&&f._has("table"),i=p._has&&p._has("table");u&&!i&&f._paperdiv.selectAll(".table").remove()}},{"../../plots/get_data":875,"./plot":1339}],1333:[function(h,N,H){var t=h("../../lib/gup").wrap;N.exports=function(){return t({})}},{"../../lib/gup":784}],1334:[function(h,N,H){N.exports={cellPad:8,columnExtentOffset:10,columnTitleOffset:28,emptyHeaderHeight:16,latexCheck:/^\$.*\$$/,goldenRatio:1.618,lineBreaker:"<br>",maxDimensionCount:60,overdrag:45,releaseTransitionDuration:120,releaseTransitionEase:"cubic-out",scrollbarCaptureWidth:18,scrollbarHideDelay:1e3,scrollbarHideDuration:1e3,scrollbarOffset:5,scrollbarWidth:8,transitionDuration:100,transitionEase:"cubic-out",uplift:5,wrapSpacer:" ",wrapSplitCharacter:" ",cn:{table:"table",tableControlView:"table-control-view",scrollBackground:"scroll-background",yColumn:"y-column",columnBlock:"column-block",scrollAreaClip:"scroll-area-clip",scrollAreaClipRect:"scroll-area-clip-rect",columnBoundary:"column-boundary",columnBoundaryClippath:"column-boundary-clippath",columnBoundaryRect:"column-boundary-rect",columnCells:"column-cells",columnCell:"column-cell",cellRect:"cell-rect",cellText:"cell-text",cellTextHolder:"cell-text-holder",scrollbarKit:"scrollbar-kit",scrollbar:"scrollbar",scrollbarSlider:"scrollbar-slider",scrollbarGlyph:"scrollbar-glyph",scrollbarCaptureZone:"scrollbar-capture-zone"}}},{}],1335:[function(h,N,H){var t=h("./constants"),m=h("../../lib/extend").extendFlat,g=h("fast-isnumeric");function p(a){if(Array.isArray(a)){for(var c=0,r=0;r<a.length;r++)c=Math.max(c,p(a[r]));return c}return a}function e(a,c){return a+c}function f(a){var c,r=a.slice(),n=1/0,d=0;for(c=0;c<r.length;c++)Array.isArray(r[c])||(r[c]=[r[c]]),n=Math.min(n,r[c].length),d=Math.max(d,r[c].length);if(n!==d)for(c=0;c<r.length;c++){var l=d-r[c].length;l&&(r[c]=r[c].concat(u(l)))}return r}function u(a){for(var c=new Array(a),r=0;r<a;r++)c[r]="";return c}function i(a){return a.calcdata.columns.reduce(function(c,r){return r.xIndex<a.xIndex?c+r.columnWidth:c},0)}function s(a,c){return Object.keys(a).map(function(r){return m({},a[r],{auxiliaryBlocks:c})})}function o(a,c){for(var r,n={},d=0,l=0,y={firstRowIndex:null,lastRowIndex:null,rows:[]},v=0,_=0,x=0;x<a.length;x++)r=a[x],y.rows.push({rowIndex:x,rowHeight:r}),((l+=r)>=c||x===a.length-1)&&(n[d]=y,y.key=_++,y.firstRowIndex=v,y.lastRowIndex=x,y={firstRowIndex:null,lastRowIndex:null,rows:[]},d+=l,v=x+1,l=0);return n}N.exports=function(a,c){var r=f(c.cells.values),n=function(j){return j.slice(c.header.values.length,j.length)},d=f(c.header.values);d.length&&!d[0].length&&(d[0]=[""],d=f(d));var l=d.concat(n(r).map(function(){return u((d[0]||[""]).length)})),y=c.domain,v=Math.floor(a._fullLayout._size.w*(y.x[1]-y.x[0])),_=Math.floor(a._fullLayout._size.h*(y.y[1]-y.y[0])),x=c.header.values.length?l[0].map(function(){return c.header.height}):[t.emptyHeaderHeight],T=r.length?r[0].map(function(){return c.cells.height}):[],A=x.reduce(e,0),S=o(T,_-A+t.uplift),w=s(o(x,A),[]),L=s(S,w),k={},C=c._fullInput.columnorder.concat(n(r.map(function(j,W){return W}))),M=l.map(function(j,W){var Z=Array.isArray(c.columnwidth)?c.columnwidth[Math.min(W,c.columnwidth.length-1)]:c.columnwidth;return g(Z)?Number(Z):1}),P=M.reduce(e,0);M=M.map(function(j){return j/P*v});var O=Math.max(p(c.header.line.width),p(c.cells.line.width)),F={key:c.uid+a._context.staticPlot,translateX:y.x[0]*a._fullLayout._size.w,translateY:a._fullLayout._size.h*(1-y.y[1]),size:a._fullLayout._size,width:v,maxLineWidth:O,height:_,columnOrder:C,groupHeight:_,rowBlocks:L,headerRowBlocks:w,scrollY:0,cells:m({},c.cells,{values:r}),headerCells:m({},c.header,{values:l}),gdColumns:l.map(function(j){return j[0]}),gdColumnsOriginalOrder:l.map(function(j){return j[0]}),prevPages:[0,0],scrollbarState:{scrollbarScrollInProgress:!1},columns:l.map(function(j,W){var Z=k[j];return k[j]=(Z||0)+1,{key:j+"__"+k[j],label:j,specIndex:W,xIndex:C[W],xScale:i,x:void 0,calcdata:void 0,columnWidth:M[W]}})};return F.columns.forEach(function(j){j.calcdata=F,j.x=i(j)}),F}},{"../../lib/extend":777,"./constants":1334,"fast-isnumeric":246}],1336:[function(h,N,H){var t=h("../../lib/extend").extendFlat;H.splitToPanels=function(m){var g=[0,0],p=t({},m,{key:"header",type:"header",page:0,prevPages:g,currentRepaint:[null,null],dragHandle:!0,values:m.calcdata.headerCells.values[m.specIndex],rowBlocks:m.calcdata.headerRowBlocks,calcdata:t({},m.calcdata,{cells:m.calcdata.headerCells})});return[t({},m,{key:"cells1",type:"cells",page:0,prevPages:g,currentRepaint:[null,null],dragHandle:!1,values:m.calcdata.cells.values[m.specIndex],rowBlocks:m.calcdata.rowBlocks}),t({},m,{key:"cells2",type:"cells",page:1,prevPages:g,currentRepaint:[null,null],dragHandle:!1,values:m.calcdata.cells.values[m.specIndex],rowBlocks:m.calcdata.rowBlocks}),p]},H.splitToCells=function(m){var g=function(p){var e=p.rowBlocks[p.page],f=e?e.rows[0].rowIndex:0,u=e?f+e.rows.length:0;return[f,u]}(m);return(m.values||[]).slice(g[0],g[1]).map(function(p,e){return{keyWithinBlock:e+(typeof p=="string"&&p.match(/[<$&> ]/)?"_keybuster_"+Math.random():""),key:g[0]+e,column:m,calcdata:m.calcdata,page:m.page,rowBlocks:m.rowBlocks,value:p}})}},{"../../lib/extend":777}],1337:[function(h,N,H){var t=h("../../lib"),m=h("./attributes"),g=h("../../plots/domain").defaults;N.exports=function(p,e,f,u){function i(s,o){return t.coerce(p,e,m,s,o)}g(e,u,i),i("columnwidth"),i("header.values"),i("header.format"),i("header.align"),i("header.prefix"),i("header.suffix"),i("header.height"),i("header.line.width"),i("header.line.color"),i("header.fill.color"),t.coerceFont(i,"header.font",t.extendFlat({},u.font)),function(s,o){for(var a=s.columnorder||[],c=s.header.values.length,r=a.slice(0,c),n=r.slice().sort(function(y,v){return y-v}),d=r.map(function(y){return n.indexOf(y)}),l=d.length;l<c;l++)d.push(l);o("columnorder",d)}(e,i),i("cells.values"),i("cells.format"),i("cells.align"),i("cells.prefix"),i("cells.suffix"),i("cells.height"),i("cells.line.width"),i("cells.line.color"),i("cells.fill.color"),t.coerceFont(i,"cells.font",t.extendFlat({},u.font)),e._length=null}},{"../../lib":787,"../../plots/domain":866,"./attributes":1331}],1338:[function(h,N,H){N.exports={attributes:h("./attributes"),supplyDefaults:h("./defaults"),calc:h("./calc"),plot:h("./plot"),moduleType:"trace",name:"table",basePlotModule:h("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":1331,"./base_plot":1332,"./calc":1333,"./defaults":1337,"./plot":1339}],1339:[function(h,N,H){var t=h("./constants"),m=h("@plotly/d3"),g=h("../../lib").numberFormat,p=h("../../lib/gup"),e=h("../../components/drawing"),f=h("../../lib/svg_text_utils"),u=h("../../lib").raiseToTop,i=h("../../lib").strTranslate,s=h("../../lib").cancelTransition,o=h("./data_preparation_helper"),a=h("./data_split_helpers"),c=h("../../components/color");function r(G){return Math.ceil(G.calcdata.maxLineWidth/2)}function n(G,Y){return"clip"+G._fullLayout._uid+"_scrollAreaBottomClip_"+Y.key}function d(G,Y){return"clip"+G._fullLayout._uid+"_columnBoundaryClippath_"+Y.calcdata.key+"_"+Y.specIndex}function l(G){return[].concat.apply([],G.map(function(Y){return Y})).map(function(Y){return Y.__data__})}function y(G,Y,K){var D=G.selectAll("."+t.cn.scrollbarKit).data(p.repeat,p.keyFun);D.enter().append("g").classed(t.cn.scrollbarKit,!0).style("shape-rendering","geometricPrecision"),D.each(function($){var te=$.scrollbarState;te.totalHeight=function(ie){var ae=ie.rowBlocks;return W(ae,ae.length-1)+(ae.length?Z(ae[ae.length-1],1/0):1)}($),te.scrollableAreaHeight=$.groupHeight-L($),te.currentlyVisibleHeight=Math.min(te.totalHeight,te.scrollableAreaHeight),te.ratio=te.currentlyVisibleHeight/te.totalHeight,te.barLength=Math.max(te.ratio*te.currentlyVisibleHeight,t.goldenRatio*t.scrollbarWidth),te.barWiggleRoom=te.currentlyVisibleHeight-te.barLength,te.wiggleRoom=Math.max(0,te.totalHeight-te.scrollableAreaHeight),te.topY=te.barWiggleRoom===0?0:$.scrollY/te.wiggleRoom*te.barWiggleRoom,te.bottomY=te.topY+te.barLength,te.dragMultiplier=te.wiggleRoom/te.barWiggleRoom}).attr("transform",function($){var te=$.width+t.scrollbarWidth/2+t.scrollbarOffset;return i(te,L($))});var B=D.selectAll("."+t.cn.scrollbar).data(p.repeat,p.keyFun);B.enter().append("g").classed(t.cn.scrollbar,!0);var q=B.selectAll("."+t.cn.scrollbarSlider).data(p.repeat,p.keyFun);q.enter().append("g").classed(t.cn.scrollbarSlider,!0),q.attr("transform",function($){return i(0,$.scrollbarState.topY||0)});var ee=q.selectAll("."+t.cn.scrollbarGlyph).data(p.repeat,p.keyFun);ee.enter().append("line").classed(t.cn.scrollbarGlyph,!0).attr("stroke","black").attr("stroke-width",t.scrollbarWidth).attr("stroke-linecap","round").attr("y1",t.scrollbarWidth/2),ee.attr("y2",function($){return $.scrollbarState.barLength-t.scrollbarWidth/2}).attr("stroke-opacity",function($){return $.columnDragInProgress||!$.scrollbarState.barWiggleRoom||K?0:.4}),ee.transition().delay(0).duration(0),ee.transition().delay(t.scrollbarHideDelay).duration(t.scrollbarHideDuration).attr("stroke-opacity",0);var J=B.selectAll("."+t.cn.scrollbarCaptureZone).data(p.repeat,p.keyFun);J.enter().append("line").classed(t.cn.scrollbarCaptureZone,!0).attr("stroke","white").attr("stroke-opacity",.01).attr("stroke-width",t.scrollbarCaptureWidth).attr("stroke-linecap","butt").attr("y1",0).on("mousedown",function($){var te=m.event.y,ie=this.getBoundingClientRect(),ae=$.scrollbarState,he=te-ie.top,se=m.scale.linear().domain([0,ae.scrollableAreaHeight]).range([0,ae.totalHeight]).clamp(!0);ae.topY<=he&&he<=ae.bottomY||C(Y,G,null,se(he-ae.barLength/2))($)}).call(m.behavior.drag().origin(function($){return m.event.stopPropagation(),$.scrollbarState.scrollbarScrollInProgress=!0,$}).on("drag",C(Y,G)).on("dragend",function(){})),J.attr("y2",function($){return $.scrollbarState.scrollableAreaHeight}),Y._context.staticPlot&&(ee.remove(),J.remove())}function v(G,Y,K,D){var B=function(ee){var J=ee.selectAll("."+t.cn.columnCell).data(a.splitToCells,function($){return $.keyWithinBlock});return J.enter().append("g").classed(t.cn.columnCell,!0),J.exit().remove(),J}(function(ee){var J=ee.selectAll("."+t.cn.columnCells).data(p.repeat,p.keyFun);return J.enter().append("g").classed(t.cn.columnCells,!0),J.exit().remove(),J}(K));(function(ee){ee.each(function(J,$){var te=J.calcdata.cells.font,ie=J.column.specIndex,ae={size:T(te.size,ie,$),color:T(te.color,ie,$),family:T(te.family,ie,$)};J.rowNumber=J.key,J.align=T(J.calcdata.cells.align,ie,$),J.cellBorderWidth=T(J.calcdata.cells.line.width,ie,$),J.font=ae})})(B),function(ee){ee.attr("width",function(J){return J.column.columnWidth}).attr("stroke-width",function(J){return J.cellBorderWidth}).each(function(J){var $=m.select(this);c.stroke($,T(J.calcdata.cells.line.color,J.column.specIndex,J.rowNumber)),c.fill($,T(J.calcdata.cells.fill.color,J.column.specIndex,J.rowNumber))})}(function(ee){var J=ee.selectAll("."+t.cn.cellRect).data(p.repeat,function($){return $.keyWithinBlock});return J.enter().append("rect").classed(t.cn.cellRect,!0),J}(B));var q=function(ee){var J=ee.selectAll("."+t.cn.cellText).data(p.repeat,function($){return $.keyWithinBlock});return J.enter().append("text").classed(t.cn.cellText,!0).style("cursor",function(){return"auto"}).on("mousedown",function(){m.event.stopPropagation()}),J}(function(ee){var J=ee.selectAll("."+t.cn.cellTextHolder).data(p.repeat,function($){return $.keyWithinBlock});return J.enter().append("g").classed(t.cn.cellTextHolder,!0).style("shape-rendering","geometricPrecision"),J}(B));(function(ee){ee.each(function(J){e.font(m.select(this),J.font)})})(q),_(q,Y,D,G),j(B)}function _(G,Y,K,D){G.text(function(B){var q=B.column.specIndex,ee=B.rowNumber,J=B.value,$=typeof J=="string",te=$&&J.match(/<br>/i),ie=!$||te;B.mayHaveMarkup=$&&J.match(/[<&>]/);var ae,he=typeof(ae=J)=="string"&&ae.match(t.latexCheck);B.latex=he;var se,de,ce=he?"":T(B.calcdata.cells.prefix,q,ee)||"",ve=he?"":T(B.calcdata.cells.suffix,q,ee)||"",ke=he?null:T(B.calcdata.cells.format,q,ee)||null,Ee=ce+(ke?g(ke)(B.value):B.value)+ve;if(B.wrappingNeeded=!B.wrapped&&!ie&&!he&&(se=x(Ee)),B.cellHeightMayIncrease=te||he||B.mayHaveMarkup||(se===void 0?x(Ee):se),B.needsConvertToTspans=B.mayHaveMarkup||B.wrappingNeeded||B.latex,B.wrappingNeeded){var be=(t.wrapSplitCharacter===" "?Ee.replace(/<a href=/gi,"<a_href="):Ee).split(t.wrapSplitCharacter),xe=t.wrapSplitCharacter===" "?be.map(function(ue){return ue.replace(/<a_href=/gi,"<a href=")}):be;B.fragments=xe.map(function(ue){return{text:ue,width:null}}),B.fragments.push({fragment:t.wrapSpacer,width:null}),de=xe.join(t.lineBreaker)+t.lineBreaker+t.wrapSpacer}else delete B.fragments,de=Ee;return de}).attr("dy",function(B){return B.needsConvertToTspans?0:"0.75em"}).each(function(B){var q=m.select(this),ee=B.wrappingNeeded?P:O;B.needsConvertToTspans?f.convertToTspans(q,D,ee(K,this,Y,D,B)):m.select(this.parentNode).attr("transform",function(J){return i(F(J),t.cellPad)}).attr("text-anchor",function(J){return{left:"start",center:"middle",right:"end"}[J.align]})})}function x(G){return G.indexOf(t.wrapSplitCharacter)!==-1}function T(G,Y,K){if(Array.isArray(G)){var D=G[Math.min(Y,G.length-1)];return Array.isArray(D)?D[Math.min(K,D.length-1)]:D}return G}function A(G,Y,K){G.transition().ease(t.releaseTransitionEase).duration(t.releaseTransitionDuration).attr("transform",i(Y.x,K))}function S(G){return G.type==="cells"}function w(G){return G.type==="header"}function L(G){return(G.rowBlocks.length?G.rowBlocks[0].auxiliaryBlocks:[]).reduce(function(Y,K){return Y+Z(K,1/0)},0)}function k(G,Y,K){var D=l(Y)[0];if(D!==void 0){var B=D.rowBlocks,q=D.calcdata,ee=W(B,B.length),J=D.calcdata.groupHeight-L(D),$=q.scrollY=Math.max(0,Math.min(ee-J,q.scrollY)),te=function(ie,ae,he){for(var se=[],de=0,ce=0;ce<ie.length;ce++){for(var ve=ie[ce],ke=ve.rows,Ee=0,be=0;be<ke.length;be++)Ee+=ke[be].rowHeight;ve.allRowsHeight=Ee,ae<de+Ee&&ae+he>de&&se.push(ce),de+=Ee}return se}(B,$,J);te.length===1&&(te[0]===B.length-1?te.unshift(te[0]-1):te.push(te[0]+1)),te[0]%2&&te.reverse(),Y.each(function(ie,ae){ie.page=te[ae],ie.scrollY=$}),Y.attr("transform",function(ie){var ae=W(ie.rowBlocks,ie.page)-ie.scrollY;return i(0,ae)}),G&&(M(G,K,Y,te,D.prevPages,D,0),M(G,K,Y,te,D.prevPages,D,1),y(K,G))}}function C(G,Y,K,D){return function(B){var q=B.calcdata?B.calcdata:B,ee=Y.filter(function(ie){return q.key===ie.key}),J=K||q.scrollbarState.dragMultiplier,$=q.scrollY;q.scrollY=D===void 0?q.scrollY+J*m.event.dy:D;var te=ee.selectAll("."+t.cn.yColumn).selectAll("."+t.cn.columnBlock).filter(S);return k(G,te,ee),q.scrollY===$}}function M(G,Y,K,D,B,q,ee){D[ee]!==B[ee]&&(clearTimeout(q.currentRepaint[ee]),q.currentRepaint[ee]=setTimeout(function(){var J=K.filter(function($,te){return te===ee&&D[te]!==B[te]});v(G,Y,J,K),B[ee]=D[ee]}))}function P(G,Y,K,D){return function(){var B=m.select(Y.parentNode);B.each(function(q){var ee=q.fragments;B.selectAll("tspan.line").each(function(de,ce){ee[ce].width=this.getComputedTextLength()});var J,$,te=ee[ee.length-1].width,ie=ee.slice(0,-1),ae=[],he=0,se=q.column.columnWidth-2*t.cellPad;for(q.value="";ie.length;)he+($=(J=ie.shift()).width+te)>se&&(q.value+=ae.join(t.wrapSpacer)+t.lineBreaker,ae=[],he=0),ae.push(J.text),he+=$;he&&(q.value+=ae.join(t.wrapSpacer)),q.wrapped=!0}),B.selectAll("tspan.line").remove(),_(B.select("."+t.cn.cellText),K,G,D),m.select(Y.parentNode.parentNode).call(j)}}function O(G,Y,K,D,B){return function(){if(!B.settledY){var q=m.select(Y.parentNode),ee=X(B),J=B.key-ee.firstRowIndex,$=ee.rows[J].rowHeight,te=B.cellHeightMayIncrease?Y.parentNode.getBoundingClientRect().height+2*t.cellPad:$,ie=Math.max(te,$);ie-ee.rows[J].rowHeight&&(ee.rows[J].rowHeight=ie,G.selectAll("."+t.cn.columnCell).call(j),k(null,G.filter(S),0),y(K,D,!0)),q.attr("transform",function(){var ae=this.parentNode.getBoundingClientRect(),he=m.select(this.parentNode).select("."+t.cn.cellRect).node().getBoundingClientRect(),se=this.transform.baseVal.consolidate(),de=he.top-ae.top+(se?se.matrix.f:t.cellPad);return i(F(B,m.select(this.parentNode).select("."+t.cn.cellTextHolder).node().getBoundingClientRect().width),de)}),B.settledY=!0}}}function F(G,Y){switch(G.align){case"left":return t.cellPad;case"right":return G.column.columnWidth-(Y||0)-t.cellPad;case"center":return(G.column.columnWidth-(Y||0))/2;default:return t.cellPad}}function j(G){G.attr("transform",function(Y){var K=Y.rowBlocks[0].auxiliaryBlocks.reduce(function(B,q){return B+Z(q,1/0)},0),D=Z(X(Y),Y.key);return i(0,D+K)}).selectAll("."+t.cn.cellRect).attr("height",function(Y){return(K=X(Y),D=Y.key,K.rows[D-K.firstRowIndex]).rowHeight;var K,D})}function W(G,Y){for(var K=0,D=Y-1;D>=0;D--)K+=Q(G[D]);return K}function Z(G,Y){for(var K=0,D=0;D<G.rows.length&&G.rows[D].rowIndex<Y;D++)K+=G.rows[D].rowHeight;return K}function Q(G){var Y=G.allRowsHeight;if(Y!==void 0)return Y;for(var K=0,D=0;D<G.rows.length;D++)K+=G.rows[D].rowHeight;return G.allRowsHeight=K,K}function X(G){return G.rowBlocks[G.page]}N.exports=function(G,Y){var K=!G._context.staticPlot,D=G._fullLayout._paper.selectAll("."+t.cn.table).data(Y.map(function(ve){var ke=p.unwrap(ve).trace;return o(G,ke)}),p.keyFun);D.exit().remove(),D.enter().append("g").classed(t.cn.table,!0).attr("overflow","visible").style("box-sizing","content-box").style("position","absolute").style("left",0).style("overflow","visible").style("shape-rendering","crispEdges").style("pointer-events","all"),D.attr("width",function(ve){return ve.width+ve.size.l+ve.size.r}).attr("height",function(ve){return ve.height+ve.size.t+ve.size.b}).attr("transform",function(ve){return i(ve.translateX,ve.translateY)});var B=D.selectAll("."+t.cn.tableControlView).data(p.repeat,p.keyFun),q=B.enter().append("g").classed(t.cn.tableControlView,!0).style("box-sizing","content-box");if(K){var ee="onwheel"in document?"wheel":"mousewheel";q.on("mousemove",function(ve){B.filter(function(ke){return ve===ke}).call(y,G)}).on(ee,function(ve){if(!ve.scrollbarState.wheeling){ve.scrollbarState.wheeling=!0;var ke=ve.scrollY+m.event.deltaY;C(G,B,null,ke)(ve)||(m.event.stopPropagation(),m.event.preventDefault()),ve.scrollbarState.wheeling=!1}}).call(y,G,!0)}B.attr("transform",function(ve){return i(ve.size.l,ve.size.t)});var J=B.selectAll("."+t.cn.scrollBackground).data(p.repeat,p.keyFun);J.enter().append("rect").classed(t.cn.scrollBackground,!0).attr("fill","none"),J.attr("width",function(ve){return ve.width}).attr("height",function(ve){return ve.height}),B.each(function(ve){e.setClipUrl(m.select(this),n(G,ve),G)});var $=B.selectAll("."+t.cn.yColumn).data(function(ve){return ve.columns},p.keyFun);$.enter().append("g").classed(t.cn.yColumn,!0),$.exit().remove(),$.attr("transform",function(ve){return i(ve.x,0)}),K&&$.call(m.behavior.drag().origin(function(ve){return A(m.select(this),ve,-t.uplift),u(this),ve.calcdata.columnDragInProgress=!0,y(B.filter(function(ke){return ve.calcdata.key===ke.key}),G),ve}).on("drag",function(ve){var ke=m.select(this),Ee=function(be){return(ve===be?m.event.x:be.x)+be.columnWidth/2};ve.x=Math.max(-t.overdrag,Math.min(ve.calcdata.width+t.overdrag-ve.columnWidth,m.event.x)),l($).filter(function(be){return be.calcdata.key===ve.calcdata.key}).sort(function(be,xe){return Ee(be)-Ee(xe)}).forEach(function(be,xe){be.xIndex=xe,be.x=ve===be?be.x:be.xScale(be)}),$.filter(function(be){return ve!==be}).transition().ease(t.transitionEase).duration(t.transitionDuration).attr("transform",function(be){return i(be.x,0)}),ke.call(s).attr("transform",i(ve.x,-t.uplift))}).on("dragend",function(ve){var ke=m.select(this),Ee=ve.calcdata;ve.x=ve.xScale(ve),ve.calcdata.columnDragInProgress=!1,A(ke,ve,0),function(be,xe,ue){var me=xe.gdColumnsOriginalOrder;xe.gdColumns.sort(function(we,Me){return ue[me.indexOf(we)]-ue[me.indexOf(Me)]}),xe.columnorder=ue,be.emit("plotly_restyle")}(G,Ee,Ee.columns.map(function(be){return be.xIndex}))})),$.each(function(ve){e.setClipUrl(m.select(this),d(G,ve),G)});var te=$.selectAll("."+t.cn.columnBlock).data(a.splitToPanels,p.keyFun);te.enter().append("g").classed(t.cn.columnBlock,!0).attr("id",function(ve){return ve.key}),te.style("cursor",function(ve){return ve.dragHandle?"ew-resize":ve.calcdata.scrollbarState.barWiggleRoom?"ns-resize":"default"});var ie=te.filter(w),ae=te.filter(S);K&&ae.call(m.behavior.drag().origin(function(ve){return m.event.stopPropagation(),ve}).on("drag",C(G,B,-1)).on("dragend",function(){})),v(G,B,ie,te),v(G,B,ae,te);var he=B.selectAll("."+t.cn.scrollAreaClip).data(p.repeat,p.keyFun);he.enter().append("clipPath").classed(t.cn.scrollAreaClip,!0).attr("id",function(ve){return n(G,ve)});var se=he.selectAll("."+t.cn.scrollAreaClipRect).data(p.repeat,p.keyFun);se.enter().append("rect").classed(t.cn.scrollAreaClipRect,!0).attr("x",-t.overdrag).attr("y",-t.uplift).attr("fill","none"),se.attr("width",function(ve){return ve.width+2*t.overdrag}).attr("height",function(ve){return ve.height+t.uplift}),$.selectAll("."+t.cn.columnBoundary).data(p.repeat,p.keyFun).enter().append("g").classed(t.cn.columnBoundary,!0);var de=$.selectAll("."+t.cn.columnBoundaryClippath).data(p.repeat,p.keyFun);de.enter().append("clipPath").classed(t.cn.columnBoundaryClippath,!0),de.attr("id",function(ve){return d(G,ve)});var ce=de.selectAll("."+t.cn.columnBoundaryRect).data(p.repeat,p.keyFun);ce.enter().append("rect").classed(t.cn.columnBoundaryRect,!0).attr("fill","none"),ce.attr("width",function(ve){return ve.columnWidth+2*r(ve)}).attr("height",function(ve){return ve.calcdata.height+2*r(ve)+t.uplift}).attr("x",function(ve){return-r(ve)}).attr("y",function(ve){return-r(ve)}),k(null,ae,B)}},{"../../components/color":650,"../../components/drawing":672,"../../lib":787,"../../lib/gup":784,"../../lib/svg_text_utils":813,"./constants":1334,"./data_preparation_helper":1335,"./data_split_helpers":1336,"@plotly/d3":58}],1340:[function(h,N,H){var t=h("../../plots/template_attributes").hovertemplateAttrs,m=h("../../plots/template_attributes").texttemplateAttrs,g=h("../../components/colorscale/attributes"),p=h("../../plots/domain").attributes,e=h("../pie/attributes"),f=h("../sunburst/attributes"),u=h("./constants"),i=h("../../lib/extend").extendFlat;N.exports={labels:f.labels,parents:f.parents,values:f.values,branchvalues:f.branchvalues,count:f.count,level:f.level,maxdepth:f.maxdepth,tiling:{packing:{valType:"enumerated",values:["squarify","binary","dice","slice","slice-dice","dice-slice"],dflt:"squarify",editType:"plot"},squarifyratio:{valType:"number",min:1,dflt:1,editType:"plot"},flip:{valType:"flaglist",flags:["x","y"],dflt:"",editType:"plot"},pad:{valType:"number",min:0,dflt:3,editType:"plot"},editType:"calc"},marker:i({pad:{t:{valType:"number",min:0,editType:"plot"},l:{valType:"number",min:0,editType:"plot"},r:{valType:"number",min:0,editType:"plot"},b:{valType:"number",min:0,editType:"plot"},editType:"calc"},colors:f.marker.colors,depthfade:{valType:"enumerated",values:[!0,!1,"reversed"],editType:"style"},line:f.marker.line,editType:"calc"},g("marker",{colorAttr:"colors",anim:!1})),pathbar:{visible:{valType:"boolean",dflt:!0,editType:"plot"},side:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},edgeshape:{valType:"enumerated",values:[">","<","|","/","\\"],dflt:">",editType:"plot"},thickness:{valType:"number",min:12,editType:"plot"},textfont:i({},e.textfont,{}),editType:"calc"},text:e.text,textinfo:f.textinfo,texttemplate:m({editType:"plot"},{keys:u.eventDataKeys.concat(["label","value"])}),hovertext:e.hovertext,hoverinfo:f.hoverinfo,hovertemplate:t({},{keys:u.eventDataKeys}),textfont:e.textfont,insidetextfont:e.insidetextfont,outsidetextfont:i({},e.outsidetextfont,{}),textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"top left",editType:"plot"},sort:e.sort,root:f.root,domain:p({name:"treemap",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/domain":866,"../../plots/template_attributes":910,"../pie/attributes":1176,"../sunburst/attributes":1314,"./constants":1343}],1341:[function(h,N,H){var t=h("../../plots/plots");H.name="treemap",H.plot=function(m,g,p,e){t.plotBasePlot(H.name,m,g,p,e)},H.clean=function(m,g,p,e){t.cleanBasePlot(H.name,m,g,p,e)}},{"../../plots/plots":901}],1342:[function(h,N,H){var t=h("../sunburst/calc");H.calc=function(m,g){return t.calc(m,g)},H.crossTraceCalc=function(m){return t._runCrossTraceCalc("treemap",m)}},{"../sunburst/calc":1316}],1343:[function(h,N,H){N.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"poly",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"],gapWithPathbar:1}},{}],1344:[function(h,N,H){var t=h("../../lib"),m=h("./attributes"),g=h("../../components/color"),p=h("../../plots/domain").defaults,e=h("../bar/defaults").handleText,f=h("../bar/constants").TEXTPAD,u=h("../../components/colorscale"),i=u.hasColorscale,s=u.handleDefaults;N.exports=function(o,a,c,r){function n(S,w){return t.coerce(o,a,m,S,w)}var d=n("labels"),l=n("parents");if(d&&d.length&&l&&l.length){var y=n("values");y&&y.length?n("branchvalues"):n("count"),n("level"),n("maxdepth"),n("tiling.packing")==="squarify"&&n("tiling.squarifyratio"),n("tiling.flip"),n("tiling.pad");var v=n("text");n("texttemplate"),a.texttemplate||n("textinfo",Array.isArray(v)?"text+label":"label"),n("hovertext"),n("hovertemplate");var _=n("pathbar.visible");e(o,a,r,n,"auto",{hasPathbar:_,moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),n("textposition");var x=a.textposition.indexOf("bottom")!==-1;n("marker.line.width")&&n("marker.line.color",r.paper_bgcolor);var T=n("marker.colors");(a._hasColorscale=i(o,"marker","colors")||(o.marker||{}).coloraxis)?s(o,a,r,n,{prefix:"marker.",cLetter:"c"}):n("marker.depthfade",!(T||[]).length);var A=2*a.textfont.size;n("marker.pad.t",x?A/4:A),n("marker.pad.l",A/4),n("marker.pad.r",A/4),n("marker.pad.b",x?A:A/4),a._hovered={marker:{line:{width:2,color:g.contrast(r.paper_bgcolor)}}},_&&(n("pathbar.thickness",a.pathbar.textfont.size+2*f),n("pathbar.side"),n("pathbar.edgeshape")),n("sort"),n("root.color"),p(a,r,n),a._length=null}else a.visible=!1}},{"../../components/color":650,"../../components/colorscale":662,"../../lib":787,"../../plots/domain":866,"../bar/constants":927,"../bar/defaults":929,"./attributes":1340}],1345:[function(h,N,H){var t=h("@plotly/d3"),m=h("../sunburst/helpers"),g=h("../bar/uniform_text").clearMinTextSize,p=h("../bar/style").resizeText,e=h("./plot_one");N.exports=function(f,u,i,s,o){var a,c,r=o.type,n=o.drawDescendants,d=f._fullLayout,l=d["_"+r+"layer"],y=!i;g(r,d),(a=l.selectAll("g.trace."+r).data(u,function(v){return v[0].trace.uid})).enter().append("g").classed("trace",!0).classed(r,!0),a.order(),!d.uniformtext.mode&&m.hasTransition(i)?(s&&(c=s()),t.transition().duration(i.duration).ease(i.easing).each("end",function(){c&&c()}).each("interrupt",function(){c&&c()}).each(function(){l.selectAll("g.trace").each(function(v){e(f,v,this,i,n)})})):(a.each(function(v){e(f,v,this,i,n)}),d.uniformtext.mode&&p(f,l.selectAll(".trace"),r)),y&&a.exit().remove()}},{"../bar/style":939,"../bar/uniform_text":941,"../sunburst/helpers":1320,"./plot_one":1354,"@plotly/d3":58}],1346:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../lib"),g=h("../../components/drawing"),p=h("../../lib/svg_text_utils"),e=h("./partition"),f=h("./style").styleOne,u=h("./constants"),i=h("../sunburst/helpers"),s=h("../sunburst/fx");N.exports=function(o,a,c,r,n){var d=n.barDifY,l=n.width,y=n.height,v=n.viewX,_=n.viewY,x=n.pathSlice,T=n.toMoveInsideSlice,A=n.strTransform,S=n.hasTransition,w=n.handleSlicesExit,L=n.makeUpdateSliceInterpolator,k=n.makeUpdateTextInterpolator,C={},M=o._fullLayout,P=a[0],O=P.trace,F=P.hierarchy,j=l/O._entryDepth,W=i.listPath(c.data,"id"),Z=e(F.copy(),[l,y],{packing:"dice",pad:{inner:0,top:0,left:0,right:0,bottom:0}}).descendants();(Z=Z.filter(function(X){var G=W.indexOf(X.data.id);return G!==-1&&(X.x0=j*G,X.x1=j*(G+1),X.y0=d,X.y1=d+y,X.onPathbar=!0,!0)})).reverse(),(r=r.data(Z,i.getPtId)).enter().append("g").classed("pathbar",!0),w(r,!0,C,[l,y],x),r.order();var Q=r;S&&(Q=Q.transition().each("end",function(){var X=t.select(this);i.setSliceCursor(X,o,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:!1})})),Q.each(function(X){X._x0=v(X.x0),X._x1=v(X.x1),X._y0=_(X.y0),X._y1=_(X.y1),X._hoverX=v(X.x1-Math.min(l,y)/2),X._hoverY=_(X.y1-y/2);var G=t.select(this),Y=m.ensureSingle(G,"path","surface",function(q){q.style("pointer-events","all")});S?Y.transition().attrTween("d",function(q){var ee=L(q,!0,C,[l,y]);return function(J){return x(ee(J))}}):Y.attr("d",x),G.call(s,c,o,a,{styleOne:f,eventDataKeys:u.eventDataKeys,transitionTime:u.CLICK_TRANSITION_TIME,transitionEasing:u.CLICK_TRANSITION_EASING}).call(i.setSliceCursor,o,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:o._transitioning}),Y.call(f,X,O,{hovered:!1}),X._text=(i.getPtLabel(X)||"").split("<br>").join(" ")||"";var K=m.ensureSingle(G,"g","slicetext"),D=m.ensureSingle(K,"text","",function(q){q.attr("data-notex",1)}),B=m.ensureUniformFontSize(o,i.determineTextFont(O,X,M.font,{onPathbar:!0}));D.text(X._text||" ").classed("slicetext",!0).attr("text-anchor","start").call(g.font,B).call(p.convertToTspans,o),X.textBB=g.bBox(D.node()),X.transform=T(X,{fontSize:B.size,onPathbar:!0}),X.transform.fontSize=B.size,S?D.transition().attrTween("transform",function(q){var ee=k(q,!0,C,[l,y]);return function(J){return A(ee(J))}}):D.attr("transform",A(X))})}},{"../../components/drawing":672,"../../lib":787,"../../lib/svg_text_utils":813,"../sunburst/fx":1319,"../sunburst/helpers":1320,"./constants":1343,"./partition":1352,"./style":1355,"@plotly/d3":58}],1347:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../lib"),g=h("../../components/drawing"),p=h("../../lib/svg_text_utils"),e=h("./partition"),f=h("./style").styleOne,u=h("./constants"),i=h("../sunburst/helpers"),s=h("../sunburst/fx"),o=h("../sunburst/plot").formatSliceLabel;N.exports=function(a,c,r,n,d){var l=d.width,y=d.height,v=d.viewX,_=d.viewY,x=d.pathSlice,T=d.toMoveInsideSlice,A=d.strTransform,S=d.hasTransition,w=d.handleSlicesExit,L=d.makeUpdateSliceInterpolator,k=d.makeUpdateTextInterpolator,C=d.prevEntry,M=a._fullLayout,P=c[0].trace,O=P.textposition.indexOf("left")!==-1,F=P.textposition.indexOf("right")!==-1,j=P.textposition.indexOf("bottom")!==-1,W=!j&&!P.marker.pad.t||j&&!P.marker.pad.b,Z=e(r,[l,y],{packing:P.tiling.packing,squarifyratio:P.tiling.squarifyratio,flipX:P.tiling.flip.indexOf("x")>-1,flipY:P.tiling.flip.indexOf("y")>-1,pad:{inner:P.tiling.pad,top:P.marker.pad.t,left:P.marker.pad.l,right:P.marker.pad.r,bottom:P.marker.pad.b}}).descendants(),Q=1/0,X=-1/0;Z.forEach(function(B){var q=B.depth;q>=P._maxDepth?(B.x0=B.x1=(B.x0+B.x1)/2,B.y0=B.y1=(B.y0+B.y1)/2):(Q=Math.min(Q,q),X=Math.max(X,q))}),n=n.data(Z,i.getPtId),P._maxVisibleLayers=isFinite(X)?X-Q+1:0,n.enter().append("g").classed("slice",!0),w(n,!1,{},[l,y],x),n.order();var G=null;if(S&&C){var Y=i.getPtId(C);n.each(function(B){G===null&&i.getPtId(B)===Y&&(G={x0:B.x0,x1:B.x1,y0:B.y0,y1:B.y1})})}var K=function(){return G||{x0:0,x1:l,y0:0,y1:y}},D=n;return S&&(D=D.transition().each("end",function(){var B=t.select(this);i.setSliceCursor(B,a,{hideOnRoot:!0,hideOnLeaves:!1,isTransitioning:!1})})),D.each(function(B){var q=i.isHeader(B,P);B._x0=v(B.x0),B._x1=v(B.x1),B._y0=_(B.y0),B._y1=_(B.y1),B._hoverX=v(B.x1-P.marker.pad.r),B._hoverY=_(j?B.y1-P.marker.pad.b/2:B.y0+P.marker.pad.t/2);var ee=t.select(this),J=m.ensureSingle(ee,"path","surface",function(ae){ae.style("pointer-events","all")});S?J.transition().attrTween("d",function(ae){var he=L(ae,!1,K(),[l,y]);return function(se){return x(he(se))}}):J.attr("d",x),ee.call(s,r,a,c,{styleOne:f,eventDataKeys:u.eventDataKeys,transitionTime:u.CLICK_TRANSITION_TIME,transitionEasing:u.CLICK_TRANSITION_EASING}).call(i.setSliceCursor,a,{isTransitioning:a._transitioning}),J.call(f,B,P,{hovered:!1}),B.x0===B.x1||B.y0===B.y1?B._text="":B._text=q?W?"":i.getPtLabel(B)||"":o(B,r,P,c,M)||"";var $=m.ensureSingle(ee,"g","slicetext"),te=m.ensureSingle($,"text","",function(ae){ae.attr("data-notex",1)}),ie=m.ensureUniformFontSize(a,i.determineTextFont(P,B,M.font));te.text(B._text||" ").classed("slicetext",!0).attr("text-anchor",F?"end":O||q?"start":"middle").call(g.font,ie).call(p.convertToTspans,a),B.textBB=g.bBox(te.node()),B.transform=T(B,{fontSize:ie.size,isHeader:q}),B.transform.fontSize=ie.size,S?te.transition().attrTween("transform",function(ae){var he=k(ae,!1,K(),[l,y]);return function(se){return A(he(se))}}):te.attr("transform",A(B))}),G}},{"../../components/drawing":672,"../../lib":787,"../../lib/svg_text_utils":813,"../sunburst/fx":1319,"../sunburst/helpers":1320,"../sunburst/plot":1324,"./constants":1343,"./partition":1352,"./style":1355,"@plotly/d3":58}],1348:[function(h,N,H){N.exports=function t(m,g,p){var e;p.swapXY&&(e=m.x0,m.x0=m.y0,m.y0=e,e=m.x1,m.x1=m.y1,m.y1=e),p.flipX&&(e=m.x0,m.x0=g[0]-m.x1,m.x1=g[0]-e),p.flipY&&(e=m.y0,m.y0=g[1]-m.y1,m.y1=g[1]-e);var f=m.children;if(f)for(var u=0;u<f.length;u++)t(f[u],g,p)}},{}],1349:[function(h,N,H){N.exports={moduleType:"trace",name:"treemap",basePlotModule:h("./base_plot"),categories:[],animatable:!0,attributes:h("./attributes"),layoutAttributes:h("./layout_attributes"),supplyDefaults:h("./defaults"),supplyLayoutDefaults:h("./layout_defaults"),calc:h("./calc").calc,crossTraceCalc:h("./calc").crossTraceCalc,plot:h("./plot"),style:h("./style").style,colorbar:h("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":1220,"./attributes":1340,"./base_plot":1341,"./calc":1342,"./defaults":1344,"./layout_attributes":1350,"./layout_defaults":1351,"./plot":1353,"./style":1355}],1350:[function(h,N,H){N.exports={treemapcolorway:{valType:"colorlist",editType:"calc"},extendtreemapcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1351:[function(h,N,H){var t=h("../../lib"),m=h("./layout_attributes");N.exports=function(g,p){function e(f,u){return t.coerce(g,p,m,f,u)}e("treemapcolorway",p.colorway),e("extendtreemapcolors")}},{"../../lib":787,"./layout_attributes":1350}],1352:[function(h,N,H){var t=h("d3-hierarchy"),m=h("./flip_tree");N.exports=function(g,p,e){var f,u=e.flipX,i=e.flipY,s=e.packing==="dice-slice",o=e.pad[i?"bottom":"top"],a=e.pad[u?"right":"left"],c=e.pad[u?"left":"right"],r=e.pad[i?"top":"bottom"];s&&(f=a,a=o,o=f,f=c,c=r,r=f);var n=t.treemap().tile(function(d,l){switch(d){case"squarify":return t.treemapSquarify.ratio(l);case"binary":return t.treemapBinary;case"dice":return t.treemapDice;case"slice":return t.treemapSlice;default:return t.treemapSliceDice}}(e.packing,e.squarifyratio)).paddingInner(e.pad.inner).paddingLeft(a).paddingRight(c).paddingTop(o).paddingBottom(r).size(s?[p[1],p[0]]:p)(g);return(s||u||i)&&m(n,p,{swapXY:s,flipX:u,flipY:i}),n}},{"./flip_tree":1348,"d3-hierarchy":167}],1353:[function(h,N,H){var t=h("./draw"),m=h("./draw_descendants");N.exports=function(g,p,e,f){return t(g,p,e,f,{type:"treemap",drawDescendants:m})}},{"./draw":1345,"./draw_descendants":1347}],1354:[function(h,N,H){var t=h("@plotly/d3"),m=h("d3-interpolate").interpolate,g=h("../sunburst/helpers"),p=h("../../lib"),e=h("../bar/constants").TEXTPAD,f=h("../bar/plot").toMoveInsideBar,u=h("../bar/uniform_text").recordMinTextSize,i=h("./constants"),s=h("./draw_ancestors");function o(a){return g.isHierarchyRoot(a)?"":g.getPtId(a)}N.exports=function(a,c,r,n,d){var l=a._fullLayout,y=c[0],v=y.trace,_=v.type==="icicle",x=y.hierarchy,T=g.findEntryWithLevel(x,v.level),A=t.select(r),S=A.selectAll("g.pathbar"),w=A.selectAll("g.slice");if(!T)return S.remove(),void w.remove();var L=g.isHierarchyRoot(T),k=!l.uniformtext.mode&&g.hasTransition(n),C=g.getMaxDepth(v),M=l._size,P=v.domain,O=M.w*(P.x[1]-P.x[0]),F=M.h*(P.y[1]-P.y[0]),j=O,W=v.pathbar.thickness,Z=v.marker.line.width+i.gapWithPathbar,Q=v.pathbar.visible?v.pathbar.side.indexOf("bottom")>-1?F+Z:-(W+Z):0,X={x0:j,x1:j,y0:Q,y1:Q+W},G=function(Se,De,Fe){var Ye=v.tiling.pad,et=function(Ge){return Ge-Ye<=De.x0},Oe=function(Ge){return Ge+Ye>=De.x1},je=function(Ge){return Ge-Ye<=De.y0},We=function(Ge){return Ge+Ye>=De.y1};return Se.x0===De.x0&&Se.x1===De.x1&&Se.y0===De.y0&&Se.y1===De.y1?{x0:Se.x0,x1:Se.x1,y0:Se.y0,y1:Se.y1}:{x0:et(Se.x0-Ye)?0:Oe(Se.x0-Ye)?Fe[0]:Se.x0,x1:et(Se.x1+Ye)?0:Oe(Se.x1+Ye)?Fe[0]:Se.x1,y0:je(Se.y0-Ye)?0:We(Se.y0-Ye)?Fe[1]:Se.y0,y1:je(Se.y1+Ye)?0:We(Se.y1+Ye)?Fe[1]:Se.y1}},Y=null,K={},D={},B=null,q=function(Se,De){return De?K[o(Se)]:D[o(Se)]},ee=function(Se,De,Fe,Ye){if(De)return K[o(x)]||X;var et=D[v.level]||Fe;return function(Oe){return Oe.data.depth-T.data.depth<C}(Se)?G(Se,et,Ye):{}};y.hasMultipleRoots&&L&&C++,v._maxDepth=C,v._backgroundColor=l.paper_bgcolor,v._entryDepth=T.data.depth,v._atRootLevel=L;var J=-O/2+M.l+M.w*(P.x[1]+P.x[0])/2,$=-F/2+M.t+M.h*(1-(P.y[1]+P.y[0])/2),te=function(Se){return J+Se},ie=function(Se){return $+Se},ae=ie(0),he=te(0),se=function(Se){return he+Se},de=function(Se){return ae+Se};function ce(Se,De){return Se+","+De}var ve=se(0),ke=function(Se){Se.x=Math.max(ve,Se.x)},Ee=v.pathbar.edgeshape,be=function(Se,De){var Fe=Se.x0,Ye=Se.x1,et=Se.y0,Oe=Se.y1,je=Se.textBB,We=function(xt){return v.textposition.indexOf(xt)!==-1},Ge=We("bottom"),Qe=We("top")||De.isHeader&&!Ge?"start":Ge?"end":"middle",it=We("right"),lt=We("left")||De.onPathbar?-1:it?1:0,Lt=v[_?"tiling":"marker"].pad;if(De.isHeader){if((Fe+=(_?Lt:Lt.l)-e)>=(Ye-=(_?Lt:Lt.r)-e)){var wt=(Fe+Ye)/2;Fe=wt,Ye=wt}var rt;Ge?et<(rt=Oe-(_?Lt:Lt.b))&&rt<Oe&&(et=rt):et<(rt=et+(_?Lt:Lt.t))&&rt<Oe&&(Oe=rt)}var $e=f(Fe,Ye,et,Oe,je,{isHorizontal:!1,constrained:!0,angle:0,anchor:Qe,leftToRight:lt});return $e.fontSize=De.fontSize,$e.targetX=te($e.targetX),$e.targetY=ie($e.targetY),isNaN($e.targetX)||isNaN($e.targetY)?{}:(Fe!==Ye&&et!==Oe&&u(v.type,$e,l),{scale:$e.scale,rotate:$e.rotate,textX:$e.textX,textY:$e.textY,anchorX:$e.anchorX,anchorY:$e.anchorY,targetX:$e.targetX,targetY:$e.targetY})},xe=function(Se,De){for(var Fe,Ye=0,et=Se;!Fe&&Ye<C;)Ye++,(et=et.parent)?Fe=q(et,De):Ye=C;return Fe||{}},ue=function(Se,De,Fe,Ye,et){var Oe,je=q(Se,De);if(je)Oe=je;else if(De)Oe=X;else if(Y)if(Se.parent){var We=B||Fe;We&&!De?Oe=G(Se,We,Ye):(Oe={},p.extendFlat(Oe,xe(Se,De)))}else Oe=p.extendFlat({},Se),_&&(et.orientation==="h"?et.flipX?Oe.x0=Se.x1:Oe.x1=0:et.flipY?Oe.y0=Se.y1:Oe.y1=0);else Oe={};return m(Oe,{x0:Se.x0,x1:Se.x1,y0:Se.y0,y1:Se.y1})},me=function(Se,De,Fe,Ye){var et=q(Se,De),Oe={},je=ee(Se,De,Fe,Ye);p.extendFlat(Oe,{transform:be({x0:je.x0,x1:je.x1,y0:je.y0,y1:je.y1,textBB:Se.textBB,_text:Se._text},{isHeader:g.isHeader(Se,v)})}),et?Oe=et:Se.parent&&p.extendFlat(Oe,xe(Se,De));var We=Se.transform;return Se.x0!==Se.x1&&Se.y0!==Se.y1&&u(v.type,We,l),m(Oe,{transform:{scale:We.scale,rotate:We.rotate,textX:We.textX,textY:We.textY,anchorX:We.anchorX,anchorY:We.anchorY,targetX:We.targetX,targetY:We.targetY}})},we=function(Se,De,Fe,Ye,et){var Oe=Ye[0],je=Ye[1];k?Se.exit().transition().each(function(){var We=t.select(this);We.select("path.surface").transition().attrTween("d",function(Ge){var Qe=function(it,lt,Lt,wt){var rt,$e=q(it,lt);if(lt)rt=X;else{var xt=q(T,lt);rt=xt?G(it,xt,wt):{}}return m($e,rt)}(Ge,De,0,[Oe,je]);return function(it){return et(Qe(it))}}),We.select("g.slicetext").attr("opacity",0)}).remove():Se.exit().remove()},Me=function(Se){var De=Se.transform;return Se.x0!==Se.x1&&Se.y0!==Se.y1&&u(v.type,De,l),p.getTextTransform({textX:De.textX,textY:De.textY,anchorX:De.anchorX,anchorY:De.anchorY,targetX:De.targetX,targetY:De.targetY,scale:De.scale,rotate:De.rotate})};k&&(S.each(function(Se){K[o(Se)]={x0:Se.x0,x1:Se.x1,y0:Se.y0,y1:Se.y1},Se.transform&&(K[o(Se)].transform={textX:Se.transform.textX,textY:Se.transform.textY,anchorX:Se.transform.anchorX,anchorY:Se.transform.anchorY,targetX:Se.transform.targetX,targetY:Se.transform.targetY,scale:Se.transform.scale,rotate:Se.transform.rotate})}),w.each(function(Se){D[o(Se)]={x0:Se.x0,x1:Se.x1,y0:Se.y0,y1:Se.y1},Se.transform&&(D[o(Se)].transform={textX:Se.transform.textX,textY:Se.transform.textY,anchorX:Se.transform.anchorX,anchorY:Se.transform.anchorY,targetX:Se.transform.targetX,targetY:Se.transform.targetY,scale:Se.transform.scale,rotate:Se.transform.rotate}),!Y&&g.isEntry(Se)&&(Y=Se)})),B=d(a,c,T,w,{width:O,height:F,viewX:te,viewY:ie,pathSlice:function(Se){var De=te(Se.x0),Fe=te(Se.x1),Ye=ie(Se.y0),et=ie(Se.y1),Oe=Fe-De,je=et-Ye;return!Oe||!je?"":"M"+ce(De,Ye+0)+"L"+ce(Fe-0,Ye)+"L"+ce(Fe,et-0)+"L"+ce(De+0,et)+"Z"},toMoveInsideSlice:be,prevEntry:Y,makeUpdateSliceInterpolator:ue,makeUpdateTextInterpolator:me,handleSlicesExit:we,hasTransition:k,strTransform:Me}),v.pathbar.visible?s(a,c,T,S,{barDifY:Q,width:j,height:W,viewX:se,viewY:de,pathSlice:function(Se){var De=se(Math.max(Math.min(Se.x0,Se.x0),0)),Fe=se(Math.min(Math.max(Se.x1,Se.x1),j)),Ye=de(Se.y0),et=de(Se.y1),Oe=W/2,je={},We={};je.x=De,We.x=Fe,je.y=We.y=(Ye+et)/2;var Ge={x:De,y:Ye},Qe={x:Fe,y:Ye},it={x:Fe,y:et},lt={x:De,y:et};return Ee===">"?(Ge.x-=Oe,Qe.x-=Oe,it.x-=Oe,lt.x-=Oe):Ee==="/"?(it.x-=Oe,lt.x-=Oe,je.x-=Oe/2,We.x-=Oe/2):Ee==="\\"?(Ge.x-=Oe,Qe.x-=Oe,je.x-=Oe/2,We.x-=Oe/2):Ee==="<"&&(je.x-=Oe,We.x-=Oe),ke(Ge),ke(lt),ke(je),ke(Qe),ke(it),ke(We),"M"+ce(Ge.x,Ge.y)+"L"+ce(Qe.x,Qe.y)+"L"+ce(We.x,We.y)+"L"+ce(it.x,it.y)+"L"+ce(lt.x,lt.y)+"L"+ce(je.x,je.y)+"Z"},toMoveInsideSlice:be,makeUpdateSliceInterpolator:ue,makeUpdateTextInterpolator:me,handleSlicesExit:we,hasTransition:k,strTransform:Me}):S.remove()}},{"../../lib":787,"../bar/constants":927,"../bar/plot":936,"../bar/uniform_text":941,"../sunburst/helpers":1320,"./constants":1343,"./draw_ancestors":1346,"@plotly/d3":58,"d3-interpolate":168}],1355:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../components/color"),g=h("../../lib"),p=h("../sunburst/helpers"),e=h("../bar/uniform_text").resizeText;function f(u,i,s,o){var a,c,r=(o||{}).hovered,n=i.data.data,d=n.i,l=n.color,y=p.isHierarchyRoot(i),v=1;if(r)a=s._hovered.marker.line.color,c=s._hovered.marker.line.width;else if(y&&l===s.root.color)v=100,a="rgba(0,0,0,0)",c=0;else if(a=g.castOption(s,d,"marker.line.color")||m.defaultLine,c=g.castOption(s,d,"marker.line.width")||0,!s._hasColorscale&&!i.onPathbar){var _=s.marker.depthfade;if(_){var x,T=m.combine(m.addOpacity(s._backgroundColor,.75),l);if(_===!0){var A=p.getMaxDepth(s);x=isFinite(A)?p.isLeaf(i)?0:s._maxVisibleLayers-(i.data.depth-s._entryDepth):i.data.height+1}else x=i.data.depth-s._entryDepth,s._atRootLevel||x++;if(x>0)for(var S=0;S<x;S++){var w=.5*S/x;l=m.combine(m.addOpacity(T,w),l)}}}u.style("stroke-width",c).call(m.fill,l).call(m.stroke,a).style("opacity",v)}N.exports={style:function(u){var i=u._fullLayout._treemaplayer.selectAll(".trace");e(u,i,"treemap"),i.each(function(s){var o=t.select(this),a=s[0].trace;o.style("opacity",a.opacity),o.selectAll("path.surface").each(function(c){t.select(this).call(f,c,a,{hovered:!1})})})},styleOne:f}},{"../../components/color":650,"../../lib":787,"../bar/uniform_text":941,"../sunburst/helpers":1320,"@plotly/d3":58}],1356:[function(h,N,H){var t=h("../box/attributes"),m=h("../../lib/extend").extendFlat,g=h("../../plots/cartesian/axis_format_attributes").axisHoverFormat;N.exports={y:t.y,x:t.x,x0:t.x0,y0:t.y0,xhoverformat:g("x"),yhoverformat:g("y"),name:m({},t.name,{}),orientation:m({},t.orientation,{}),bandwidth:{valType:"number",min:0,editType:"calc"},scalegroup:{valType:"string",dflt:"",editType:"calc"},scalemode:{valType:"enumerated",values:["width","count"],dflt:"width",editType:"calc"},spanmode:{valType:"enumerated",values:["soft","hard","manual"],dflt:"soft",editType:"calc"},span:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:t.fillcolor,points:m({},t.boxpoints,{}),jitter:m({},t.jitter,{}),pointpos:m({},t.pointpos,{}),width:m({},t.width,{}),marker:t.marker,text:t.text,hovertext:t.hovertext,hovertemplate:t.hovertemplate,box:{visible:{valType:"boolean",dflt:!1,editType:"plot"},width:{valType:"number",min:0,max:1,dflt:.25,editType:"plot"},fillcolor:{valType:"color",editType:"style"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"style"},editType:"plot"},meanline:{visible:{valType:"boolean",dflt:!1,editType:"plot"},color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"plot"},side:{valType:"enumerated",values:["both","positive","negative"],dflt:"both",editType:"calc"},offsetgroup:t.offsetgroup,alignmentgroup:t.alignmentgroup,selected:t.selected,unselected:t.unselected,hoveron:{valType:"flaglist",flags:["violins","points","kde"],dflt:"violins+points+kde",extras:["all"],editType:"style"}}},{"../../lib/extend":777,"../../plots/cartesian/axis_format_attributes":841,"../box/attributes":950}],1357:[function(h,N,H){var t=h("../../lib"),m=h("../../plots/cartesian/axes"),g=h("../box/calc"),p=h("./helpers"),e=h("../../constants/numerical").BADNUM;function f(i,s,o){var a=s.max-s.min;if(!a)return i.bandwidth?i.bandwidth:0;if(i.bandwidth)return Math.max(i.bandwidth,a/1e4);var c=o.length,r=t.stdev(o,c-1,s.mean);return Math.max(function(n,d,l){return 1.059*Math.min(d,l/1.349)*Math.pow(n,-.2)}(c,r,s.q3-s.q1),a/100)}function u(i,s,o,a){var c,r=i.spanmode,n=i.span||[],d=[s.min,s.max],l=[s.min-2*a,s.max+2*a];function y(_){var x=n[_],T=o.type==="multicategory"?o.r2c(x):o.d2c(x,0,i[s.valLetter+"calendar"]);return T===e?l[_]:T}var v={type:"linear",range:c=r==="soft"?l:r==="hard"?d:[y(0),y(1)]};return m.setConvert(v),v.cleanRange(),c}N.exports=function(i,s){var o=g(i,s);if(o[0].t.empty)return o;for(var a=i._fullLayout,c=m.getFromId(i,s[s.orientation==="h"?"xaxis":"yaxis"]),r=1/0,n=-1/0,d=0,l=0,y=0;y<o.length;y++){var v=o[y],_=v.pts.map(p.extractVal),x=v.bandwidth=f(s,v,_),T=v.span=u(s,v,c,x);if(v.min===v.max&&x===0)T=v.span=[v.min,v.max],v.density=[{v:1,t:T[0]}],v.bandwidth=x,d=Math.max(d,1);else{var A=T[1]-T[0],S=Math.ceil(A/(x/3)),w=A/S;if(!isFinite(w)||!isFinite(S))return t.error("Something went wrong with computing the violin span"),o[0].t.empty=!0,o;var L=p.makeKDE(v,s,_);v.density=new Array(S);for(var k=0,C=T[0];C<T[1]+w/2;k++,C+=w){var M=L(C);v.density[k]={v:M,t:C},d=Math.max(d,M)}}l=Math.max(l,_.length),r=Math.min(r,T[0]),n=Math.max(n,T[1])}var P=m.findExtremes(c,[r,n],{padded:!0});if(s._extremes[c._id]=P,s.width)o[0].t.maxKDE=d;else{var O=a._violinScaleGroupStats,F=s.scalegroup,j=O[F];j?(j.maxKDE=Math.max(j.maxKDE,d),j.maxCount=Math.max(j.maxCount,l)):O[F]={maxKDE:d,maxCount:l}}return o[0].t.labels.kde=t._(i,"kde:"),o}},{"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/axes":838,"../box/calc":951,"./helpers":1360}],1358:[function(h,N,H){var t=h("../box/cross_trace_calc").setPositionOffset,m=["v","h"];N.exports=function(g,p){for(var e=g.calcdata,f=p.xaxis,u=p.yaxis,i=0;i<m.length;i++){for(var s=m[i],o=s==="h"?u:f,a=[],c=0;c<e.length;c++){var r=e[c],n=r[0].t,d=r[0].trace;d.visible!==!0||d.type!=="violin"||n.empty||d.orientation!==s||d.xaxis!==f._id||d.yaxis!==u._id||a.push(c)}t("violin",g,a,o)}}},{"../box/cross_trace_calc":952}],1359:[function(h,N,H){var t=h("../../lib"),m=h("../../components/color"),g=h("../box/defaults"),p=h("./attributes");N.exports=function(e,f,u,i){function s(A,S){return t.coerce(e,f,p,A,S)}function o(A,S){return t.coerce2(e,f,p,A,S)}if(g.handleSampleDefaults(e,f,s,i),f.visible!==!1){s("bandwidth"),s("side"),s("width")||(s("scalegroup",f.name),s("scalemode"));var a,c=s("span");Array.isArray(c)&&(a="manual"),s("spanmode",a);var r=s("line.color",(e.marker||{}).color||u),n=s("line.width"),d=s("fillcolor",m.addOpacity(f.line.color,.5));g.handlePointsDefaults(e,f,s,{prefix:""});var l=o("box.width"),y=o("box.fillcolor",d),v=o("box.line.color",r),_=o("box.line.width",n);s("box.visible",Boolean(l||y||v||_))||(f.box={visible:!1});var x=o("meanline.color",r),T=o("meanline.width",n);s("meanline.visible",Boolean(x||T))||(f.meanline={visible:!1})}}},{"../../components/color":650,"../../lib":787,"../box/defaults":953,"./attributes":1356}],1360:[function(h,N,H){var t=h("../../lib"),m=function(g){return 1/Math.sqrt(2*Math.PI)*Math.exp(-.5*g*g)};H.makeKDE=function(g,p,e){var f=e.length,u=m,i=g.bandwidth,s=1/(f*i);return function(o){for(var a=0,c=0;c<f;c++)a+=u((o-e[c])/i);return s*a}},H.getPositionOnKdePath=function(g,p,e){var f,u;p.orientation==="h"?(f="y",u="x"):(f="x",u="y");var i=t.findPointOnPath(g.path,e,u,{pathLength:g.pathLength}),s=g.posCenterPx,o=i[f];return[o,p.side==="both"?2*s-o:s]},H.getKdeValue=function(g,p,e){var f=g.pts.map(H.extractVal);return H.makeKDE(g,p,f)(e)/g.posDensityScale},H.extractVal=function(g){return g.v}},{"../../lib":787}],1361:[function(h,N,H){var t=h("../../lib"),m=h("../../plots/cartesian/axes"),g=h("../box/hover"),p=h("./helpers");N.exports=function(e,f,u,i,s){s||(s={});var o,a,c=s.hoverLayer,r=e.cd,n=r[0].trace,d=n.hoveron,l=d.indexOf("violins")!==-1,y=d.indexOf("kde")!==-1,v=[];if(l||y){var _=g.hoverOnBoxes(e,f,u,i);if(y&&_.length>0){var x,T,A,S,w,L=e.xa,k=e.ya;n.orientation==="h"?(w=f,x="y",A=k,T="x",S=L):(w=u,x="x",A=L,T="y",S=k);var C=r[e.index];if(w>=C.span[0]&&w<=C.span[1]){var M=t.extendFlat({},e),P=S.c2p(w,!0),O=p.getKdeValue(C,n,w),F=p.getPositionOnKdePath(C,n,P),j=A._offset,W=A._length;M[x+"0"]=F[0],M[x+"1"]=F[1],M[T+"0"]=M[T+"1"]=P,M[T+"Label"]=T+": "+m.hoverLabelText(S,w,n[T+"hoverformat"])+", "+r[0].t.labels.kde+" "+O.toFixed(3),M.spikeDistance=_[0].spikeDistance;var Z=x+"Spike";M[Z]=_[0][Z],_[0].spikeDistance=void 0,_[0][Z]=void 0,M.hovertemplate=!1,v.push(M),(a={stroke:e.color})[x+"1"]=t.constrain(j+F[0],j,j+W),a[x+"2"]=t.constrain(j+F[1],j,j+W),a[T+"1"]=a[T+"2"]=S._offset+P}}l&&(v=v.concat(_))}d.indexOf("points")!==-1&&(o=g.hoverOnPoints(e,f,u));var Q=c.selectAll(".violinline-"+n.uid).data(a?[0]:[]);return Q.enter().append("line").classed("violinline-"+n.uid,!0).attr("stroke-width",1.5),Q.exit().remove(),Q.attr(a),i==="closest"?o?[o]:v:(o&&v.push(o),v)}},{"../../lib":787,"../../plots/cartesian/axes":838,"../box/hover":955,"./helpers":1360}],1362:[function(h,N,H){N.exports={attributes:h("./attributes"),layoutAttributes:h("./layout_attributes"),supplyDefaults:h("./defaults"),crossTraceDefaults:h("../box/defaults").crossTraceDefaults,supplyLayoutDefaults:h("./layout_defaults"),calc:h("./calc"),crossTraceCalc:h("./cross_trace_calc"),plot:h("./plot"),style:h("./style"),styleOnSelect:h("../scatter/style").styleOnSelect,hoverPoints:h("./hover"),selectPoints:h("../box/select"),moduleType:"trace",name:"violin",basePlotModule:h("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","violinLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":852,"../box/defaults":953,"../box/select":960,"../scatter/style":1226,"./attributes":1356,"./calc":1357,"./cross_trace_calc":1358,"./defaults":1359,"./hover":1361,"./layout_attributes":1363,"./layout_defaults":1364,"./plot":1365,"./style":1366}],1363:[function(h,N,H){var t=h("../box/layout_attributes"),m=h("../../lib").extendFlat;N.exports={violinmode:m({},t.boxmode,{}),violingap:m({},t.boxgap,{}),violingroupgap:m({},t.boxgroupgap,{})}},{"../../lib":787,"../box/layout_attributes":957}],1364:[function(h,N,H){var t=h("../../lib"),m=h("./layout_attributes"),g=h("../box/layout_defaults");N.exports=function(p,e,f){g._supply(p,e,f,function(u,i){return t.coerce(p,e,m,u,i)},"violin")}},{"../../lib":787,"../box/layout_defaults":958,"./layout_attributes":1363}],1365:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../lib"),g=h("../../components/drawing"),p=h("../box/plot"),e=h("../scatter/line_points"),f=h("./helpers");N.exports=function(u,i,s,o){var a=u._fullLayout,c=i.xaxis,r=i.yaxis;function n(d){var l=e(d,{xaxis:c,yaxis:r,connectGaps:!0,baseTolerance:.75,shape:"spline",simplify:!0,linearized:!0});return g.smoothopen(l[0],1)}m.makeTraceGroups(o,s,"trace violins").each(function(d){var l=t.select(this),y=d[0],v=y.t,_=y.trace;if(_.visible!==!0||v.empty)l.remove();else{var x=v.bPos,T=v.bdPos,A=i[v.valLetter+"axis"],S=i[v.posLetter+"axis"],w=_.side==="both",L=w||_.side==="positive",k=w||_.side==="negative",C=l.selectAll("path.violin").data(m.identity);C.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","violin"),C.exit().remove(),C.each(function(Q){var X,G,Y,K,D,B,q,ee,J=t.select(this),$=Q.density,te=$.length,ie=S.c2l(Q.pos+x,!0),ae=S.l2p(ie);if(_.width)X=v.maxKDE/T;else{var he=a._violinScaleGroupStats[_.scalegroup];X=_.scalemode==="count"?he.maxKDE/T*(he.maxCount/Q.pts.length):he.maxKDE/T}if(L){for(q=new Array(te),D=0;D<te;D++)(ee=q[D]={})[v.posLetter]=ie+$[D].v/X,ee[v.valLetter]=A.c2l($[D].t,!0);G=n(q)}if(k){for(q=new Array(te),B=0,D=te-1;B<te;B++,D--)(ee=q[B]={})[v.posLetter]=ie-$[D].v/X,ee[v.valLetter]=A.c2l($[D].t,!0);Y=n(q)}if(w)K=G+"L"+Y.substr(1)+"Z";else{var se=[ae,A.c2p($[0].t)],de=[ae,A.c2p($[te-1].t)];_.orientation==="h"&&(se.reverse(),de.reverse()),K=L?"M"+se+"L"+G.substr(1)+"L"+de:"M"+de+"L"+Y.substr(1)+"L"+se}J.attr("d",K),Q.posCenterPx=ae,Q.posDensityScale=X*T,Q.path=J.node(),Q.pathLength=Q.path.getTotalLength()/(w?2:1)});var M,P,O,F=_.box,j=F.width,W=(F.line||{}).width;w?(M=T*j,P=0):L?(M=[0,T*j/2],P=W*{x:1,y:-1}[v.posLetter]):(M=[T*j/2,0],P=W*{x:-1,y:1}[v.posLetter]),p.plotBoxAndWhiskers(l,{pos:S,val:A},_,{bPos:x,bdPos:M,bPosPxOffset:P}),p.plotBoxMean(l,{pos:S,val:A},_,{bPos:x,bdPos:M,bPosPxOffset:P}),!_.box.visible&&_.meanline.visible&&(O=m.identity);var Z=l.selectAll("path.meanline").data(O||[]);Z.enter().append("path").attr("class","meanline").style("fill","none").style("vector-effect","non-scaling-stroke"),Z.exit().remove(),Z.each(function(Q){var X=A.c2p(Q.mean,!0),G=f.getPositionOnKdePath(Q,_,X);t.select(this).attr("d",_.orientation==="h"?"M"+X+","+G[0]+"V"+G[1]:"M"+G[0]+","+X+"H"+G[1])}),p.plotPoints(l,{x:c,y:r},_,v)}})}},{"../../components/drawing":672,"../../lib":787,"../box/plot":959,"../scatter/line_points":1216,"./helpers":1360,"@plotly/d3":58}],1366:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../components/color"),g=h("../scatter/style").stylePoints;N.exports=function(p){var e=t.select(p).selectAll("g.trace.violins");e.style("opacity",function(f){return f[0].trace.opacity}),e.each(function(f){var u=f[0].trace,i=t.select(this),s=u.box||{},o=s.line||{},a=u.meanline||{},c=a.width;i.selectAll("path.violin").style("stroke-width",u.line.width+"px").call(m.stroke,u.line.color).call(m.fill,u.fillcolor),i.selectAll("path.box").style("stroke-width",o.width+"px").call(m.stroke,o.color).call(m.fill,s.fillcolor);var r={"stroke-width":c+"px","stroke-dasharray":2*c+"px,"+c+"px"};i.selectAll("path.mean").style(r).call(m.stroke,a.color),i.selectAll("path.meanline").style(r).call(m.stroke,a.color),g(i,u,p)})}},{"../../components/color":650,"../scatter/style":1226,"@plotly/d3":58}],1367:[function(h,N,H){var t=h("../../components/colorscale/attributes"),m=h("../isosurface/attributes"),g=h("../surface/attributes"),p=h("../../plots/attributes"),e=h("../../lib/extend").extendFlat,f=h("../../plot_api/edit_types").overrideAll,u=N.exports=f(e({x:m.x,y:m.y,z:m.z,value:m.value,isomin:m.isomin,isomax:m.isomax,surface:m.surface,spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:1}},slices:m.slices,caps:m.caps,text:m.text,hovertext:m.hovertext,xhoverformat:m.xhoverformat,yhoverformat:m.yhoverformat,zhoverformat:m.zhoverformat,valuehoverformat:m.valuehoverformat,hovertemplate:m.hovertemplate},t("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{colorbar:m.colorbar,opacity:m.opacity,opacityscale:g.opacityscale,lightposition:m.lightposition,lighting:m.lighting,flatshading:m.flatshading,contour:m.contour,hoverinfo:e({},p.hoverinfo),showlegend:e({},p.showlegend,{dflt:!1})}),"calc","nested");u.x.editType=u.y.editType=u.z.editType=u.value.editType="calc+clearAxisTypes",u.transforms=void 0},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plots/attributes":834,"../isosurface/attributes":1138,"../surface/attributes":1326}],1368:[function(h,N,H){var t=h("gl-mesh3d"),m=h("../../lib/gl_format_color").parseColorScale,g=h("../../lib/str2rgbarray"),p=h("../../components/colorscale").extractOpts,e=h("../../plots/gl3d/zip3"),f=h("../isosurface/convert").findNearestOnAxis,u=h("../isosurface/convert").generateIsoMeshes;function i(o,a,c){this.scene=o,this.uid=c,this.mesh=a,this.name="",this.data=null,this.showContour=!1}var s=i.prototype;s.handlePick=function(o){if(o.object===this.mesh){var a=o.data.index,c=this.data._meshX[a],r=this.data._meshY[a],n=this.data._meshZ[a],d=this.data._Ys.length,l=this.data._Zs.length,y=f(c,this.data._Xs).id,v=f(r,this.data._Ys).id,_=f(n,this.data._Zs).id,x=o.index=_+l*v+l*d*y;o.traceCoordinate=[this.data._meshX[x],this.data._meshY[x],this.data._meshZ[x],this.data._value[x]];var T=this.data.hovertext||this.data.text;return Array.isArray(T)&&T[x]!==void 0?o.textLabel=T[x]:T&&(o.textLabel=T),!0}},s.update=function(o){var a=this.scene,c=a.fullSceneLayout;function r(l,y,v,_){return y.map(function(x){return l.d2l(x,0,_)*v})}this.data=u(o);var n={positions:e(r(c.xaxis,o._meshX,a.dataScale[0],o.xcalendar),r(c.yaxis,o._meshY,a.dataScale[1],o.ycalendar),r(c.zaxis,o._meshZ,a.dataScale[2],o.zcalendar)),cells:e(o._meshI,o._meshJ,o._meshK),lightPosition:[o.lightposition.x,o.lightposition.y,o.lightposition.z],ambient:o.lighting.ambient,diffuse:o.lighting.diffuse,specular:o.lighting.specular,roughness:o.lighting.roughness,fresnel:o.lighting.fresnel,vertexNormalsEpsilon:o.lighting.vertexnormalsepsilon,faceNormalsEpsilon:o.lighting.facenormalsepsilon,opacity:o.opacity,opacityscale:o.opacityscale,contourEnable:o.contour.show,contourColor:g(o.contour.color).slice(0,3),contourWidth:o.contour.width,useFacetNormals:o.flatshading},d=p(o);n.vertexIntensity=o._meshIntensity,n.vertexIntensityBounds=[d.min,d.max],n.colormap=m(o),this.mesh.update(n)},s.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},N.exports=function(o,a){var c=o.glplot.gl,r=t({gl:c}),n=new i(o,r,a.uid);return r._trace=n,n.update(a),o.glplot.add(r),n}},{"../../components/colorscale":662,"../../lib/gl_format_color":783,"../../lib/str2rgbarray":812,"../../plots/gl3d/zip3":891,"../isosurface/convert":1140,"gl-mesh3d":309}],1369:[function(h,N,H){var t=h("../../lib"),m=h("./attributes"),g=h("../isosurface/defaults").supplyIsoDefaults,p=h("../surface/defaults").opacityscaleDefaults;N.exports=function(e,f,u,i){function s(o,a){return t.coerce(e,f,m,o,a)}g(e,f,u,i,s),p(e,f,i,s)}},{"../../lib":787,"../isosurface/defaults":1141,"../surface/defaults":1329,"./attributes":1367}],1370:[function(h,N,H){N.exports={attributes:h("./attributes"),supplyDefaults:h("./defaults"),calc:h("../isosurface/calc"),colorbar:{min:"cmin",max:"cmax"},plot:h("./convert"),moduleType:"trace",name:"volume",basePlotModule:h("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":880,"../isosurface/calc":1139,"./attributes":1367,"./convert":1368,"./defaults":1369}],1371:[function(h,N,H){var t=h("../bar/attributes"),m=h("../scatter/attributes").line,g=h("../../plots/attributes"),p=h("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=h("../../plots/template_attributes").hovertemplateAttrs,f=h("../../plots/template_attributes").texttemplateAttrs,u=h("./constants"),i=h("../../lib/extend").extendFlat,s=h("../../components/color");function o(a){return{marker:{color:i({},t.marker.color,{arrayOk:!1,editType:"style"}),line:{color:i({},t.marker.line.color,{arrayOk:!1,editType:"style"}),width:i({},t.marker.line.width,{arrayOk:!1,editType:"style"}),editType:"style"},editType:"style"},editType:"style"}}N.exports={measure:{valType:"data_array",dflt:[],editType:"calc"},base:{valType:"number",dflt:null,arrayOk:!1,editType:"calc"},x:t.x,x0:t.x0,dx:t.dx,y:t.y,y0:t.y0,dy:t.dy,xperiod:t.xperiod,yperiod:t.yperiod,xperiod0:t.xperiod0,yperiod0:t.yperiod0,xperiodalignment:t.xperiodalignment,yperiodalignment:t.yperiodalignment,xhoverformat:p("x"),yhoverformat:p("y"),hovertext:t.hovertext,hovertemplate:e({},{keys:u.eventDataKeys}),hoverinfo:i({},g.hoverinfo,{flags:["name","x","y","text","initial","delta","final"]}),textinfo:{valType:"flaglist",flags:["label","text","initial","delta","final"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:f({editType:"plot"},{keys:u.eventDataKeys.concat(["label"])}),text:t.text,textposition:t.textposition,insidetextanchor:t.insidetextanchor,textangle:t.textangle,textfont:t.textfont,insidetextfont:t.insidetextfont,outsidetextfont:t.outsidetextfont,constraintext:t.constraintext,cliponaxis:t.cliponaxis,orientation:t.orientation,offset:t.offset,width:t.width,increasing:o(),decreasing:o(),totals:o(),connector:{line:{color:i({},m.color,{dflt:s.defaultLine}),width:i({},m.width,{editType:"plot"}),dash:m.dash,editType:"plot"},mode:{valType:"enumerated",values:["spanning","between"],dflt:"between",editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:t.offsetgroup,alignmentgroup:t.alignmentgroup}},{"../../components/color":650,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../bar/attributes":925,"../scatter/attributes":1202,"./constants":1373}],1372:[function(h,N,H){var t=h("../../plots/cartesian/axes"),m=h("../../plots/cartesian/align_period"),g=h("../../lib").mergeArray,p=h("../scatter/calc_selection"),e=h("../../constants/numerical").BADNUM;function f(i){return i==="a"||i==="absolute"}function u(i){return i==="t"||i==="total"}N.exports=function(i,s){var o,a,c,r,n,d,l=t.getFromId(i,s.xaxis||"x"),y=t.getFromId(i,s.yaxis||"y");s.orientation==="h"?(o=l.makeCalcdata(s,"x"),c=y.makeCalcdata(s,"y"),r=m(s,y,"y",c),n=!!s.yperiodalignment,d="y"):(o=y.makeCalcdata(s,"y"),c=l.makeCalcdata(s,"x"),r=m(s,l,"x",c),n=!!s.xperiodalignment,d="x"),a=r.vals;for(var v,_=Math.min(a.length,o.length),x=new Array(_),T=0,A=!1,S=0;S<_;S++){var w=o[S]||0,L=!1;(o[S]!==e||u(s.measure[S])||f(s.measure[S]))&&S+1<_&&(o[S+1]!==e||u(s.measure[S+1])||f(s.measure[S+1]))&&(L=!0);var k=x[S]={i:S,p:a[S],s:w,rawS:w,cNext:L};f(s.measure[S])?(T=k.s,k.isSum=!0,k.dir="totals",k.s=T):u(s.measure[S])?(k.isSum=!0,k.dir="totals",k.s=T):(k.isSum=!1,k.dir=k.rawS<0?"decreasing":"increasing",v=k.s,k.s=T+v,T+=v),k.dir==="totals"&&(A=!0),n&&(x[S].orig_p=c[S],x[S][d+"End"]=r.ends[S],x[S][d+"Start"]=r.starts[S]),s.ids&&(k.id=String(s.ids[S])),k.v=(s.base||0)+T}return x.length&&(x[0].hasTotals=A),g(s.text,x,"tx"),g(s.hovertext,x,"htx"),p(x,s),x}},{"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/align_period":835,"../../plots/cartesian/axes":838,"../scatter/calc_selection":1204}],1373:[function(h,N,H){N.exports={eventDataKeys:["initial","delta","final"]}},{}],1374:[function(h,N,H){var t=h("../bar/cross_trace_calc").setGroupPositions;N.exports=function(m,g){var p,e,f=m._fullLayout,u=m._fullData,i=m.calcdata,s=g.xaxis,o=g.yaxis,a=[],c=[],r=[];for(e=0;e<u.length;e++){var n=u[e];n.visible===!0&&n.xaxis===s._id&&n.yaxis===o._id&&n.type==="waterfall"&&(p=i[e],n.orientation==="h"?r.push(p):c.push(p),a.push(p))}var d={mode:f.waterfallmode,norm:f.waterfallnorm,gap:f.waterfallgap,groupgap:f.waterfallgroupgap};for(t(m,s,o,c,d),t(m,o,s,r,d),e=0;e<a.length;e++){p=a[e];for(var l=0;l<p.length;l++){var y=p[l];y.isSum===!1&&(y.s0+=l===0?0:p[l-1].s),l+1<p.length&&(p[l].nextP0=p[l+1].p0,p[l].nextS0=p[l+1].s0)}}}},{"../bar/cross_trace_calc":928}],1375:[function(h,N,H){var t=h("../../lib"),m=h("../bar/defaults").handleGroupingDefaults,g=h("../bar/defaults").handleText,p=h("../scatter/xy_defaults"),e=h("../scatter/period_defaults"),f=h("./attributes"),u=h("../../components/color"),i=h("../../constants/delta.js"),s=i.INCREASING.COLOR,o=i.DECREASING.COLOR;function a(c,r,n){c(r+".marker.color",n),c(r+".marker.line.color",u.defaultLine),c(r+".marker.line.width")}N.exports={supplyDefaults:function(c,r,n,d){function l(v,_){return t.coerce(c,r,f,v,_)}if(p(c,r,d,l)){e(c,r,d,l),l("xhoverformat"),l("yhoverformat"),l("measure"),l("orientation",r.x&&!r.y?"h":"v"),l("base"),l("offset"),l("width"),l("text"),l("hovertext"),l("hovertemplate");var y=l("textposition");g(c,r,d,l,y,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),r.textposition!=="none"&&(l("texttemplate"),r.texttemplate||l("textinfo")),a(l,"increasing",s),a(l,"decreasing",o),a(l,"totals","#4499FF"),l("connector.visible")&&(l("connector.mode"),l("connector.line.width")&&(l("connector.line.color"),l("connector.line.dash")))}else r.visible=!1},crossTraceDefaults:function(c,r){var n,d;function l(v){return t.coerce(d._input,d,f,v)}if(r.waterfallmode==="group")for(var y=0;y<c.length;y++)n=(d=c[y])._input,m(n,d,r,l)}}},{"../../components/color":650,"../../constants/delta.js":757,"../../lib":787,"../bar/defaults":929,"../scatter/period_defaults":1222,"../scatter/xy_defaults":1229,"./attributes":1371}],1376:[function(h,N,H){N.exports=function(t,m){return t.x="xVal"in m?m.xVal:m.x,t.y="yVal"in m?m.yVal:m.y,"initial"in m&&(t.initial=m.initial),"delta"in m&&(t.delta=m.delta),"final"in m&&(t.final=m.final),m.xa&&(t.xaxis=m.xa),m.ya&&(t.yaxis=m.ya),t}},{}],1377:[function(h,N,H){var t=h("../../plots/cartesian/axes").hoverLabelText,m=h("../../components/color").opacity,g=h("../bar/hover").hoverOnBars,p=h("../../constants/delta.js"),e=p.INCREASING.SYMBOL,f=p.DECREASING.SYMBOL;N.exports=function(u,i,s,o,a){var c=g(u,i,s,o,a);if(c){var r=c.cd,n=r[0].trace,d=n.orientation==="h",l=d?"x":"y",y=d?u.xa:u.ya,v=r[c.index],_=v.isSum?v.b+v.s:v.rawS;if(!v.isSum){c.initial=v.b+v.s-_,c.delta=_,c.final=c.initial+c.delta;var x=k(Math.abs(c.delta));c.deltaLabel=_<0?"("+x+")":x,c.finalLabel=k(c.final),c.initialLabel=k(c.initial)}var T=v.hi||n.hoverinfo,A=[];if(T&&T!=="none"&&T!=="skip"){var S=T==="all",w=T.split("+"),L=function(C){return S||w.indexOf(C)!==-1};v.isSum||(!L("final")||L(d?"x":"y")||A.push(c.finalLabel),L("delta")&&(_<0?A.push(c.deltaLabel+" "+f):A.push(c.deltaLabel+" "+e)),L("initial")&&A.push("Initial: "+c.initialLabel))}return A.length&&(c.extraText=A.join("<br>")),c.color=function(C,M){var P=C[M.dir].marker,O=P.color,F=P.line.color,j=P.line.width;if(m(O))return O;if(m(F)&&j)return F}(n,v),[c]}function k(C){return t(y,C,n[l+"hoverformat"])}}},{"../../components/color":650,"../../constants/delta.js":757,"../../plots/cartesian/axes":838,"../bar/hover":932}],1378:[function(h,N,H){N.exports={attributes:h("./attributes"),layoutAttributes:h("./layout_attributes"),supplyDefaults:h("./defaults").supplyDefaults,crossTraceDefaults:h("./defaults").crossTraceDefaults,supplyLayoutDefaults:h("./layout_defaults"),calc:h("./calc"),crossTraceCalc:h("./cross_trace_calc"),plot:h("./plot"),style:h("./style").style,hoverPoints:h("./hover"),eventData:h("./event_data"),selectPoints:h("../bar/select"),moduleType:"trace",name:"waterfall",basePlotModule:h("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":852,"../bar/select":937,"./attributes":1371,"./calc":1372,"./cross_trace_calc":1374,"./defaults":1375,"./event_data":1376,"./hover":1377,"./layout_attributes":1379,"./layout_defaults":1380,"./plot":1381,"./style":1382}],1379:[function(h,N,H){N.exports={waterfallmode:{valType:"enumerated",values:["group","overlay"],dflt:"group",editType:"calc"},waterfallgap:{valType:"number",min:0,max:1,editType:"calc"},waterfallgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],1380:[function(h,N,H){var t=h("../../lib"),m=h("./layout_attributes");N.exports=function(g,p,e){var f=!1;function u(o,a){return t.coerce(g,p,m,o,a)}for(var i=0;i<e.length;i++){var s=e[i];if(s.visible&&s.type==="waterfall"){f=!0;break}}f&&(u("waterfallmode"),u("waterfallgap",.2),u("waterfallgroupgap"))}},{"../../lib":787,"./layout_attributes":1379}],1381:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../lib"),g=h("../../components/drawing"),p=h("../../constants/numerical").BADNUM,e=h("../bar/plot"),f=h("../bar/uniform_text").clearMinTextSize;N.exports=function(u,i,s,o){var a=u._fullLayout;f("waterfall",a),e.plot(u,i,s,o,{mode:a.waterfallmode,norm:a.waterfallmode,gap:a.waterfallgap,groupgap:a.waterfallgroupgap}),function(c,r,n,d){var l=r.xaxis,y=r.yaxis;m.makeTraceGroups(d,n,"trace bars").each(function(v){var _=t.select(this),x=v[0].trace,T=m.ensureSingle(_,"g","lines");if(x.connector&&x.connector.visible){var A=x.orientation==="h",S=x.connector.mode,w=T.selectAll("g.line").data(m.identity);w.enter().append("g").classed("line",!0),w.exit().remove();var L=w.size();w.each(function(k,C){if(C===L-1||k.cNext){var M=function(j,W,Z,Q){var X=[],G=[],Y=Q?W:Z,K=Q?Z:W;return X[0]=Y.c2p(j.s0,!0),G[0]=K.c2p(j.p0,!0),X[1]=Y.c2p(j.s1,!0),G[1]=K.c2p(j.p1,!0),X[2]=Y.c2p(j.nextS0,!0),G[2]=K.c2p(j.nextP0,!0),Q?[X,G]:[G,X]}(k,l,y,A),P=M[0],O=M[1],F="";P[0]!==p&&O[0]!==p&&P[1]!==p&&O[1]!==p&&(S==="spanning"&&!k.isSum&&C>0&&(F+=A?"M"+P[0]+","+O[1]+"V"+O[0]:"M"+P[1]+","+O[0]+"H"+P[0]),S!=="between"&&(k.isSum||C<L-1)&&(F+=A?"M"+P[1]+","+O[0]+"V"+O[1]:"M"+P[0]+","+O[1]+"H"+P[1]),P[2]!==p&&O[2]!==p&&(F+=A?"M"+P[1]+","+O[1]+"V"+O[2]:"M"+P[1]+","+O[1]+"H"+P[2])),F===""&&(F="M0,0Z"),m.ensureSingle(t.select(this),"path").attr("d",F).call(g.setClipUrl,r.layerClipId,c)}})}else T.remove()})}(u,i,s,o)}},{"../../components/drawing":672,"../../constants/numerical":763,"../../lib":787,"../bar/plot":936,"../bar/uniform_text":941,"@plotly/d3":58}],1382:[function(h,N,H){var t=h("@plotly/d3"),m=h("../../components/drawing"),g=h("../../components/color"),p=h("../../constants/interactions").DESELECTDIM,e=h("../bar/style"),f=h("../bar/uniform_text").resizeText,u=e.styleTextPoints;N.exports={style:function(i,s,o){var a=o||t.select(i).selectAll("g.waterfalllayer").selectAll("g.trace");f(i,a,"waterfall"),a.style("opacity",function(c){return c[0].trace.opacity}),a.each(function(c){var r=t.select(this),n=c[0].trace;r.selectAll(".point > path").each(function(d){if(!d.isBlank){var l=n[d.dir].marker;t.select(this).call(g.fill,l.color).call(g.stroke,l.line.color).call(m.dashLine,l.line.dash,l.line.width).style("opacity",n.selectedpoints&&!d.selected?p:1)}}),u(r,n,i),r.selectAll(".lines").each(function(){var d=n.connector.line;m.lineGroupStyle(t.select(this).selectAll("path"),d.width,d.color,d.dash)})})}}},{"../../components/color":650,"../../components/drawing":672,"../../constants/interactions":762,"../bar/style":939,"../bar/uniform_text":941,"@plotly/d3":58}],1383:[function(h,N,H){var t=h("../plots/cartesian/axes"),m=h("../lib"),g=h("../plot_api/plot_schema"),p=h("./helpers").pointsAccessorFunction,e=h("../constants/numerical").BADNUM;H.moduleType="transform",H.name="aggregate";var f=H.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},aggregations:{_isLinkedToArray:"aggregation",target:{valType:"string",editType:"calc"},func:{valType:"enumerated",values:["count","sum","avg","median","mode","rms","stddev","min","max","first","last","change","range"],dflt:"first",editType:"calc"},funcmode:{valType:"enumerated",values:["sample","population"],dflt:"sample",editType:"calc"},enabled:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},editType:"calc"},u=f.aggregations;function i(c,r,n,d){if(d.enabled){for(var l=d.target,y=m.nestedProperty(r,l),v=y.get(),_=function(A,S){var w=A.func,L=S.d2c,k=S.c2d;switch(w){case"count":return s;case"first":return o;case"last":return a;case"sum":return function(C,M){for(var P=0,O=0;O<M.length;O++){var F=L(C[M[O]]);F!==e&&(P+=F)}return k(P)};case"avg":return function(C,M){for(var P=0,O=0,F=0;F<M.length;F++){var j=L(C[M[F]]);j!==e&&(P+=j,O++)}return O?k(P/O):e};case"min":return function(C,M){for(var P=1/0,O=0;O<M.length;O++){var F=L(C[M[O]]);F!==e&&(P=Math.min(P,F))}return P===1/0?e:k(P)};case"max":return function(C,M){for(var P=-1/0,O=0;O<M.length;O++){var F=L(C[M[O]]);F!==e&&(P=Math.max(P,F))}return P===-1/0?e:k(P)};case"range":return function(C,M){for(var P=1/0,O=-1/0,F=0;F<M.length;F++){var j=L(C[M[F]]);j!==e&&(P=Math.min(P,j),O=Math.max(O,j))}return O===-1/0||P===1/0?e:k(O-P)};case"change":return function(C,M){var P=L(C[M[0]]),O=L(C[M[M.length-1]]);return P===e||O===e?e:k(O-P)};case"median":return function(C,M){for(var P=[],O=0;O<M.length;O++){var F=L(C[M[O]]);F!==e&&P.push(F)}if(!P.length)return e;P.sort(m.sorterAsc);var j=(P.length-1)/2;return k((P[Math.floor(j)]+P[Math.ceil(j)])/2)};case"mode":return function(C,M){for(var P={},O=0,F=e,j=0;j<M.length;j++){var W=L(C[M[j]]);if(W!==e){var Z=P[W]=(P[W]||0)+1;Z>O&&(O=Z,F=W)}}return O?k(F):e};case"rms":return function(C,M){for(var P=0,O=0,F=0;F<M.length;F++){var j=L(C[M[F]]);j!==e&&(P+=j*j,O++)}return O?k(Math.sqrt(P/O)):e};case"stddev":return function(C,M){var P,O=0,F=0,j=1,W=e;for(P=0;P<M.length&&W===e;P++)W=L(C[M[P]]);if(W===e)return e;for(;P<M.length;P++){var Z=L(C[M[P]]);if(Z!==e){var Q=Z-W;O+=Q,F+=Q*Q,j++}}var X=A.funcmode==="sample"?j-1:j;return X?Math.sqrt((F-O*O/j)/X):0}}}(d,t.getDataConversions(c,r,l,v)),x=new Array(n.length),T=0;T<n.length;T++)x[T]=_(v,n[T]);y.set(x),d.func==="count"&&m.pushUnique(r._arrayAttrs,l)}}function s(c,r){return r.length}function o(c,r){return c[r[0]]}function a(c,r){return c[r[r.length-1]]}H.supplyDefaults=function(c,r){var n,d={};function l(k,C){return m.coerce(c,d,f,k,C)}if(!l("enabled"))return d;var y=g.findArrayAttributes(r),v={};for(n=0;n<y.length;n++)v[y[n]]=1;var _=l("groups");if(!Array.isArray(_)){if(!v[_])return d.enabled=!1,d;v[_]=0}var x,T=c.aggregations||[],A=d.aggregations=new Array(T.length);function S(k,C){return m.coerce(T[n],x,u,k,C)}for(n=0;n<T.length;n++){x={_index:n};var w=S("target"),L=S("func");S("enabled")&&w&&(v[w]||L==="count"&&v[w]===void 0)?(L==="stddev"&&S("funcmode"),v[w]=0,A[n]=x):A[n]={enabled:!1,_index:n}}for(n=0;n<y.length;n++)v[y[n]]&&A.push({target:y[n],func:u.func.dflt,enabled:!0,_index:-1});return d},H.calcTransform=function(c,r,n){if(n.enabled){var d=n.groups,l=m.getTargetArray(r,{target:d});if(l){var y,v,_,x,T={},A={},S=[],w=p(r.transforms,n),L=l.length;for(r._length&&(L=Math.min(L,r._length)),y=0;y<L;y++)(_=T[v=l[y]])===void 0?(T[v]=S.length,x=[y],S.push(x),A[T[v]]=w(y)):(S[_].push(y),A[T[v]]=(A[T[v]]||[]).concat(w(y)));n._indexToPoints=A;var k=n.aggregations;for(y=0;y<k.length;y++)i(c,r,S,k[y]);typeof d=="string"&&i(c,r,S,{target:d,func:"first",enabled:!0}),r._length=S.length}}}},{"../constants/numerical":763,"../lib":787,"../plot_api/plot_schema":826,"../plots/cartesian/axes":838,"./helpers":1386}],1384:[function(h,N,H){var t=h("../lib"),m=h("../registry"),g=h("../plots/cartesian/axes"),p=h("./helpers").pointsAccessorFunction,e=h("../constants/filter_ops"),f=e.COMPARISON_OPS,u=e.INTERVAL_OPS,i=e.SET_OPS;H.moduleType="transform",H.name="filter",H.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},operation:{valType:"enumerated",values:[].concat(f).concat(u).concat(i),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},preservegaps:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc"},H.supplyDefaults=function(s){var o={};function a(n,d){return t.coerce(s,o,H.attributes,n,d)}if(a("enabled")){var c=a("target");if(t.isArrayOrTypedArray(c)&&c.length===0)return o.enabled=!1,o;a("preservegaps"),a("operation"),a("value");var r=m.getComponentMethod("calendars","handleDefaults");r(s,o,"valuecalendar",null),r(s,o,"targetcalendar",null)}return o},H.calcTransform=function(s,o,a){if(a.enabled){var c=t.getTargetArray(o,a);if(c){var r=a.target,n=c.length;o._length&&(n=Math.min(n,o._length));var d=a.targetcalendar,l=o._arrayAttrs,y=a.preservegaps;if(typeof r=="string"){var v=t.nestedProperty(o,r+"calendar").get();v&&(d=v)}var _,x,T=function(M,P,O){var F=M.operation,j=M.value,W=Array.isArray(j);function Z(Y){return Y.indexOf(F)!==-1}var Q,X=function(Y){return P(Y,0,M.valuecalendar)},G=function(Y){return P(Y,0,O)};switch(Z(f)?Q=X(W?j[0]:j):Z(u)?Q=W?[X(j[0]),X(j[1])]:[X(j),X(j)]:Z(i)&&(Q=W?j.map(X):[X(j)]),F){case"=":return function(Y){return G(Y)===Q};case"!=":return function(Y){return G(Y)!==Q};case"<":return function(Y){return G(Y)<Q};case"<=":return function(Y){return G(Y)<=Q};case">":return function(Y){return G(Y)>Q};case">=":return function(Y){return G(Y)>=Q};case"[]":return function(Y){var K=G(Y);return K>=Q[0]&&K<=Q[1]};case"()":return function(Y){var K=G(Y);return K>Q[0]&&K<Q[1]};case"[)":return function(Y){var K=G(Y);return K>=Q[0]&&K<Q[1]};case"(]":return function(Y){var K=G(Y);return K>Q[0]&&K<=Q[1]};case"][":return function(Y){var K=G(Y);return K<=Q[0]||K>=Q[1]};case")(":return function(Y){var K=G(Y);return K<Q[0]||K>Q[1]};case"](":return function(Y){var K=G(Y);return K<=Q[0]||K>Q[1]};case")[":return function(Y){var K=G(Y);return K<Q[0]||K>=Q[1]};case"{}":return function(Y){return Q.indexOf(G(Y))!==-1};case"}{":return function(Y){return Q.indexOf(G(Y))===-1}}}(a,g.getDataToCoordFunc(s,o,r,c),d),A={},S={},w=0;y?(_=function(M){A[M.astr]=t.extendDeep([],M.get()),M.set(new Array(n))},x=function(M,P){var O=A[M.astr][P];M.get()[P]=O}):(_=function(M){A[M.astr]=t.extendDeep([],M.get()),M.set([])},x=function(M,P){var O=A[M.astr][P];M.get().push(O)}),C(_);for(var L=p(o.transforms,a),k=0;k<n;k++)T(c[k])?(C(x,k),S[w++]=L(k)):y&&w++;a._indexToPoints=S,o._length=w}}function C(M,P){for(var O=0;O<l.length;O++)M(t.nestedProperty(o,l[O]),P)}}},{"../constants/filter_ops":759,"../lib":787,"../plots/cartesian/axes":838,"../registry":915,"./helpers":1386}],1385:[function(h,N,H){var t=h("../lib"),m=h("../plot_api/plot_schema"),g=h("../plots/plots"),p=h("./helpers").pointsAccessorFunction;function e(f,u){var i,s,o,a,c,r,n,d,l,y,v=u.transform,_=u.transformIndex,x=f.transforms[_].groups,T=p(f.transforms,v);if(!t.isArrayOrTypedArray(x)||x.length===0)return[f];var A=t.filterUnique(x),S=new Array(A.length),w=x.length,L=m.findArrayAttributes(f),k=v.styles||[],C={};for(i=0;i<k.length;i++)C[k[i].target]=k[i].value;v.styles&&(y=t.keyedContainer(v,"styles","target","value.name"));var M={},P={};for(i=0;i<A.length;i++){M[r=A[i]]=i,P[r]=0,(n=S[i]=t.extendDeepNoArrays({},f))._group=r,n.transforms[_]._indexToPoints={};var O=null;for(y&&(O=y.get(r)),n.name=O||O===""?O:t.templateString(v.nameformat,{trace:f.name,group:r}),d=n.transforms,n.transforms=[],s=0;s<d.length;s++)n.transforms[s]=t.extendDeepNoArrays({},d[s]);for(s=0;s<L.length;s++)t.nestedProperty(n,L[s]).set([])}for(o=0;o<L.length;o++){for(a=L[o],s=0,l=[];s<A.length;s++)l[s]=t.nestedProperty(S[s],a).get();for(c=t.nestedProperty(f,a).get(),s=0;s<w;s++)l[M[x[s]]].push(c[s])}for(s=0;s<w;s++)(n=S[M[x[s]]]).transforms[_]._indexToPoints[P[x[s]]]=T(s),P[x[s]]++;for(i=0;i<A.length;i++)r=A[i],n=S[i],g.clearExpandedTraceDefaultColors(n),n=t.extendDeepNoArrays(n,C[r]||{});return S}H.moduleType="transform",H.name="groupby",H.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"data_array",dflt:[],editType:"calc"},nameformat:{valType:"string",editType:"calc"},styles:{_isLinkedToArray:"style",target:{valType:"string",editType:"calc"},value:{valType:"any",dflt:{},editType:"calc",_compareAsJSON:!0},editType:"calc"},editType:"calc"},H.supplyDefaults=function(f,u,i){var s,o={};function a(l,y){return t.coerce(f,o,H.attributes,l,y)}if(!a("enabled"))return o;a("groups"),a("nameformat",i._dataLength>1?"%{group} (%{trace})":"%{group}");var c=f.styles,r=o.styles=[];if(c)for(s=0;s<c.length;s++){var n=r[s]={};t.coerce(c[s],r[s],H.attributes.styles,"target");var d=t.coerce(c[s],r[s],H.attributes.styles,"value");t.isPlainObject(d)?n.value=t.extendDeep({},d):d&&delete n.value}return o},H.transform=function(f,u){var i,s,o,a=[];for(s=0;s<f.length;s++)for(i=e(f[s],u),o=0;o<i.length;o++)a.push(i[o]);return a}},{"../lib":787,"../plot_api/plot_schema":826,"../plots/plots":901,"./helpers":1386}],1386:[function(h,N,H){H.pointsAccessorFunction=function(t,m){for(var g,p,e=0;e<t.length&&(g=t[e])!==m;e++)g._indexToPoints&&g.enabled!==!1&&(p=g._indexToPoints);return p?function(f){return p[f]}:function(f){return[f]}}},{}],1387:[function(h,N,H){var t=h("../lib"),m=h("../plots/cartesian/axes"),g=h("./helpers").pointsAccessorFunction,p=h("../constants/numerical").BADNUM;H.moduleType="transform",H.name="sort",H.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},order:{valType:"enumerated",values:["ascending","descending"],dflt:"ascending",editType:"calc"},editType:"calc"},H.supplyDefaults=function(e){var f={};function u(i,s){return t.coerce(e,f,H.attributes,i,s)}return u("enabled")&&(u("target"),u("order")),f},H.calcTransform=function(e,f,u){if(u.enabled){var i=t.getTargetArray(f,u);if(i){var s=u.target,o=i.length;f._length&&(o=Math.min(o,f._length));var a,c,r=f._arrayAttrs,n=function(x,T,A,S){var w,L=new Array(S),k=new Array(S);for(w=0;w<S;w++)L[w]={v:T[w],i:w};for(L.sort(function(C,M){switch(C.order){case"ascending":return function(P,O){var F=M(P.v),j=M(O.v);return F===p?1:j===p?-1:F-j};case"descending":return function(P,O){var F=M(P.v),j=M(O.v);return F===p?1:j===p?-1:j-F}}}(x,A)),w=0;w<S;w++)k[w]=L[w].i;return k}(u,i,m.getDataToCoordFunc(e,f,s,i),o),d=g(f.transforms,u),l={};for(a=0;a<r.length;a++){var y=t.nestedProperty(f,r[a]),v=y.get(),_=new Array(o);for(c=0;c<o;c++)_[c]=v[n[c]];y.set(_)}for(c=0;c<o;c++)l[c]=d(n[c]);u._indexToPoints=l,f._length=o}}}},{"../constants/numerical":763,"../lib":787,"../plots/cartesian/axes":838,"./helpers":1386}],1388:[function(h,N,H){H.version="2.5.1"},{}]},{},[27])(27)})})(qu);var Qs=fs(qu.exports),Gu={exports:{}},Yu={exports:{}};(function(Gn,Ca){(function(h,N){Gn.exports=N()})(typeof window!="undefined"?window:La,function(){if(typeof window=="undefined")return null;var h=typeof window!="undefined"&&window.Math==Math?window:typeof self!="undefined"&&self.Math==Math?self:Function("return this")(),N=h.requestAnimationFrame||h.mozRequestAnimationFrame||h.webkitRequestAnimationFrame||function(f){return h.setTimeout(f,20)},H=h.cancelAnimationFrame||h.mozCancelAnimationFrame||h.webkitCancelAnimationFrame||function(f){h.clearTimeout(f)};function t(f,u){var i=Object.prototype.toString.call(f),s=i==="[object Array]"||i==="[object NodeList]"||i==="[object HTMLCollection]"||i==="[object Object]"||typeof jQuery!="undefined"&&f instanceof jQuery||typeof Elements!="undefined"&&f instanceof Elements,o=0,a=f.length;if(s)for(;o<a;o++)u(f[o]);else u(f)}function m(f){if(!f.getBoundingClientRect)return{width:f.offsetWidth,height:f.offsetHeight};var u=f.getBoundingClientRect();return{width:Math.round(u.width),height:Math.round(u.height)}}function g(f,u){Object.keys(u).forEach(function(i){f.style[i]=u[i]})}var p=function(f,u){var i=0;function s(){var a=[];this.add=function(n){a.push(n)};var c,r;this.call=function(n){for(c=0,r=a.length;c<r;c++)a[c].call(this,n)},this.remove=function(n){var d=[];for(c=0,r=a.length;c<r;c++)a[c]!==n&&d.push(a[c]);a=d},this.length=function(){return a.length}}function o(a,c){if(!!a){if(a.resizedAttached){a.resizedAttached.add(c);return}a.resizedAttached=new s,a.resizedAttached.add(c),a.resizeSensor=document.createElement("div"),a.resizeSensor.dir="ltr",a.resizeSensor.className="resize-sensor";var r={pointerEvents:"none",position:"absolute",left:"0px",top:"0px",right:"0px",bottom:"0px",overflow:"hidden",zIndex:"-1",visibility:"hidden",maxWidth:"100%"},n={position:"absolute",left:"0px",top:"0px",transition:"0s"};g(a.resizeSensor,r);var d=document.createElement("div");d.className="resize-sensor-expand",g(d,r);var l=document.createElement("div");g(l,n),d.appendChild(l);var y=document.createElement("div");y.className="resize-sensor-shrink",g(y,r);var v=document.createElement("div");g(v,n),g(v,{width:"200%",height:"200%"}),y.appendChild(v),a.resizeSensor.appendChild(d),a.resizeSensor.appendChild(y),a.appendChild(a.resizeSensor);var _=window.getComputedStyle(a),x=_?_.getPropertyValue("position"):null;x!=="absolute"&&x!=="relative"&&x!=="fixed"&&x!=="sticky"&&(a.style.position="relative");var T=!1,A=0,S=m(a),w=0,L=0,k=!0;i=0;var C=function(){var j=a.offsetWidth,W=a.offsetHeight;l.style.width=j+10+"px",l.style.height=W+10+"px",d.scrollLeft=j+10,d.scrollTop=W+10,y.scrollLeft=j+10,y.scrollTop=W+10},M=function(){if(k){var j=a.offsetWidth===0&&a.offsetHeight===0;if(j){i||(i=N(function(){i=0,M()}));return}else k=!1}C()};a.resizeSensor.resetSensor=M;var P=function(){A=0,!!T&&(w=S.width,L=S.height,a.resizedAttached&&a.resizedAttached.call(S))},O=function(){S=m(a),T=S.width!==w||S.height!==L,T&&!A&&(A=N(P)),M()},F=function(j,W,Z){j.attachEvent?j.attachEvent("on"+W,Z):j.addEventListener(W,Z)};F(d,"scroll",O),F(y,"scroll",O),i=N(function(){i=0,M()})}}t(f,function(a){o(a,u)}),this.detach=function(a){i||(H(i),i=0),p.detach(f,a)},this.reset=function(){f.resizeSensor.resetSensor()}};if(p.reset=function(f){t(f,function(u){u.resizeSensor.resetSensor()})},p.detach=function(f,u){t(f,function(i){!i||i.resizedAttached&&typeof u=="function"&&(i.resizedAttached.remove(u),i.resizedAttached.length())||i.resizeSensor&&(i.contains(i.resizeSensor)&&i.removeChild(i.resizeSensor),delete i.resizeSensor,delete i.resizedAttached)})},typeof MutationObserver!="undefined"){var e=new MutationObserver(function(f){for(var u in f)if(f.hasOwnProperty(u))for(var i=f[u].addedNodes,s=0;s<i.length;s++)i[s].resizeSensor&&p.reset(i[s])});document.addEventListener("DOMContentLoaded",function(f){e.observe(document.body,{childList:!0,subtree:!0})})}return p})})(Yu);var Eh="Expected a function",Wu=0/0,Lh="[object Symbol]",Ch=/^\s+|\s+$/g,Ph=/^[-+]0x[0-9a-f]+$/i,Ih=/^0b[01]+$/i,Oh=/^0o[0-7]+$/i,zh=parseInt,Dh=typeof La=="object"&&La&&La.Object===Object&&La,Rh=typeof self=="object"&&self&&self.Object===Object&&self,Fh=Dh||Rh||Function("return this")(),Bh=Object.prototype,Nh=Bh.toString,jh=Math.max,Uh=Math.min,au=function(){return Fh.Date.now()};function Vh(Gn,Ca,h){var N,H,t,m,g,p,e=0,f=!1,u=!1,i=!0;if(typeof Gn!="function")throw new TypeError(Eh);Ca=Xu(Ca)||0,iu(h)&&(f=!!h.leading,u="maxWait"in h,t=u?jh(Xu(h.maxWait)||0,Ca):t,i="trailing"in h?!!h.trailing:i);function s(v){var _=N,x=H;return N=H=void 0,e=v,m=Gn.apply(x,_),m}function o(v){return e=v,g=setTimeout(r,Ca),f?s(v):m}function a(v){var _=v-p,x=v-e,T=Ca-_;return u?Uh(T,t-x):T}function c(v){var _=v-p,x=v-e;return p===void 0||_>=Ca||_<0||u&&x>=t}function r(){var v=au();if(c(v))return n(v);g=setTimeout(r,a(v))}function n(v){return g=void 0,i&&N?s(v):(N=H=void 0,m)}function d(){g!==void 0&&clearTimeout(g),e=0,N=p=H=g=void 0}function l(){return g===void 0?m:n(au())}function y(){var v=au(),_=c(v);if(N=arguments,H=this,p=v,_){if(g===void 0)return o(p);if(u)return g=setTimeout(r,Ca),s(p)}return g===void 0&&(g=setTimeout(r,Ca)),m}return y.cancel=d,y.flush=l,y}function iu(Gn){var Ca=typeof Gn;return!!Gn&&(Ca=="object"||Ca=="function")}function Hh(Gn){return!!Gn&&typeof Gn=="object"}function qh(Gn){return typeof Gn=="symbol"||Hh(Gn)&&Nh.call(Gn)==Lh}function Xu(Gn){if(typeof Gn=="number")return Gn;if(qh(Gn))return Wu;if(iu(Gn)){var Ca=typeof Gn.valueOf=="function"?Gn.valueOf():Gn;Gn=iu(Ca)?Ca+"":Ca}if(typeof Gn!="string")return Gn===0?Gn:+Gn;Gn=Gn.replace(Ch,"");var h=Ih.test(Gn);return h||Oh.test(Gn)?zh(Gn.slice(2),h?2:8):Ph.test(Gn)?Wu:+Gn}var Gh=Vh;(function(Gn,Ca){(function(h,N){Gn.exports=N(Yu.exports,Gh)})(La,function(h,N){return function(H){function t(g){if(m[g])return m[g].exports;var p=m[g]={exports:{},id:g,loaded:!1};return H[g].call(p.exports,p,p.exports,t),p.loaded=!0,p.exports}var m={};return t.m=H,t.c=m,t.p="/",t(0)}([function(H,t,m){var g,p,e;(function(f,u){p=[H,t,m(10),m(38),m(39),m(9),m(37)],g=u,e=typeof g=="function"?g.apply(t,p):g,e!==void 0&&(H.exports=e)})(this,function(f,u,i,s,o){function a(S){return S&&S.__esModule?S:{default:S}}function c(S){if(!S)return{delay:A,initial:!1};var w=S.initial,L=w!==void 0&&w,k=(0,y.default)(S).map(function(C){return parseInt(C)}).find(function(C){return!isNaN(C)});return k=k||A,{delay:k,initial:L}}function r(S,w){var L={root:document.documentElement},k=new IntersectionObserver(function(C,M){C.forEach(function(P){P.isIntersecting&&(w(),M.disconnect())})},L);return k.observe(S),k}function n(S,w){var L=w.value,k=w.arg,C=w.options,M=function(){return L(S)};switch(k){case"debounce":M=T(function(){return L(S)},C.delay);break;case"throttle":M=T(function(){return L(S)},C.delay,{leading:!0,trailing:!0,maxWait:C.delay})}var P=new v.default(S,M);return C.initial&&L(S),P}function d(S,w,L){var k=w.value,C=w.arg,M=w.modifiers,P=L.context;if(!k||typeof k!="function")return void console.warn("v-resize should received a function as value");var O=c(M);return P&&P.$el===S&&P.$once("hook:deactivated",function(){l(S),P.$once("hook:activated",function(){d(S,{value:k,arg:C,modifiers:M},{context:P})})}),S.offsetParent?void n(S,{value:k,arg:C,options:O}):(O.initial=!0,void(S.__visibility__listener__=r(S,function(){return n(S,{value:k,arg:C,options:O})})))}function l(S){S.__visibility__listener__&&S.__visibility__listener__.disconnect(),S.resizeSensor&&v.default.detach(S)}Object.defineProperty(u,"__esModule",{value:!0});var y=a(i),v=a(s),_=a(o),x=_.default.debounce,T=x===void 0?_.default:x,A=150;u.default={inserted:d,unbind:l},f.exports=u.default})},function(H,t){var m=H.exports={version:"2.4.0"};typeof __e=="number"&&(__e=m)},function(H,t,m){H.exports=!m(3)(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7})},function(H,t){H.exports=function(m){try{return!!m()}catch(g){return!0}}},function(H,t){var m=H.exports=typeof window!="undefined"&&window.Math==Math?window:typeof self!="undefined"&&self.Math==Math?self:Function("return this")();typeof __g=="number"&&(__g=m)},function(H,t){H.exports=function(m){return typeof m=="object"?m!==null:typeof m=="function"}},function(H,t){H.exports=function(m){if(m==null)throw TypeError("Can't call method on  "+m);return m}},function(H,t){var m=Math.ceil,g=Math.floor;H.exports=function(p){return isNaN(p=+p)?0:(p>0?g:m)(p)}},function(H,t,m){var g=m(23),p=m(6);H.exports=function(e){return g(p(e))}},function(H,t,m){var g,p,e;(function(f,u){p=[],g=u,e=typeof g=="function"?g.apply(t,p):g,e!==void 0&&(H.exports=e)})(this,function(){Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(f){if(this==null)throw new TypeError('"this" is null or not defined');var u=Object(this),i=u.length>>>0;if(typeof f!="function")throw new TypeError("predicate must be a function");for(var s=arguments[1],o=0;o<i;){var a=u[o];if(f.call(s,a,o,u))return a;o++}},configurable:!0,writable:!0})})},function(H,t,m){H.exports={default:m(11),__esModule:!0}},function(H,t,m){m(36),H.exports=m(1).Object.keys},function(H,t){H.exports=function(m){if(typeof m!="function")throw TypeError(m+" is not a function!");return m}},function(H,t,m){var g=m(5);H.exports=function(p){if(!g(p))throw TypeError(p+" is not an object!");return p}},function(H,t,m){var g=m(8),p=m(32),e=m(31);H.exports=function(f){return function(u,i,s){var o,a=g(u),c=p(a.length),r=e(s,c);if(f&&i!=i){for(;c>r;)if(o=a[r++],o!=o)return!0}else for(;c>r;r++)if((f||r in a)&&a[r]===i)return f||r||0;return!f&&-1}}},function(H,t){var m={}.toString;H.exports=function(g){return m.call(g).slice(8,-1)}},function(H,t,m){var g=m(12);H.exports=function(p,e,f){if(g(p),e===void 0)return p;switch(f){case 1:return function(u){return p.call(e,u)};case 2:return function(u,i){return p.call(e,u,i)};case 3:return function(u,i,s){return p.call(e,u,i,s)}}return function(){return p.apply(e,arguments)}}},function(H,t,m){var g=m(5),p=m(4).document,e=g(p)&&g(p.createElement);H.exports=function(f){return e?p.createElement(f):{}}},function(H,t){H.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(H,t,m){var g=m(4),p=m(1),e=m(16),f=m(21),u="prototype",i=function(s,o,a){var c,r,n,d=s&i.F,l=s&i.G,y=s&i.S,v=s&i.P,_=s&i.B,x=s&i.W,T=l?p:p[o]||(p[o]={}),A=T[u],S=l?g:y?g[o]:(g[o]||{})[u];l&&(a=o);for(c in a)r=!d&&S&&S[c]!==void 0,r&&c in T||(n=r?S[c]:a[c],T[c]=l&&typeof S[c]!="function"?a[c]:_&&r?e(n,g):x&&S[c]==n?function(w){var L=function(k,C,M){if(this instanceof w){switch(arguments.length){case 0:return new w;case 1:return new w(k);case 2:return new w(k,C)}return new w(k,C,M)}return w.apply(this,arguments)};return L[u]=w[u],L}(n):v&&typeof n=="function"?e(Function.call,n):n,v&&((T.virtual||(T.virtual={}))[c]=n,s&i.R&&A&&!A[c]&&f(A,c,n)))};i.F=1,i.G=2,i.S=4,i.P=8,i.B=16,i.W=32,i.U=64,i.R=128,H.exports=i},function(H,t){var m={}.hasOwnProperty;H.exports=function(g,p){return m.call(g,p)}},function(H,t,m){var g=m(24),p=m(28);H.exports=m(2)?function(e,f,u){return g.f(e,f,p(1,u))}:function(e,f,u){return e[f]=u,e}},function(H,t,m){H.exports=!m(2)&&!m(3)(function(){return Object.defineProperty(m(17)("div"),"a",{get:function(){return 7}}).a!=7})},function(H,t,m){var g=m(15);H.exports=Object("z").propertyIsEnumerable(0)?Object:function(p){return g(p)=="String"?p.split(""):Object(p)}},function(H,t,m){var g=m(13),p=m(22),e=m(34),f=Object.defineProperty;t.f=m(2)?Object.defineProperty:function(u,i,s){if(g(u),i=e(i,!0),g(s),p)try{return f(u,i,s)}catch(o){}if("get"in s||"set"in s)throw TypeError("Accessors not supported!");return"value"in s&&(u[i]=s.value),u}},function(H,t,m){var g=m(20),p=m(8),e=m(14)(!1),f=m(29)("IE_PROTO");H.exports=function(u,i){var s,o=p(u),a=0,c=[];for(s in o)s!=f&&g(o,s)&&c.push(s);for(;i.length>a;)g(o,s=i[a++])&&(~e(c,s)||c.push(s));return c}},function(H,t,m){var g=m(25),p=m(18);H.exports=Object.keys||function(e){return g(e,p)}},function(H,t,m){var g=m(19),p=m(1),e=m(3);H.exports=function(f,u){var i=(p.Object||{})[f]||Object[f],s={};s[f]=u(i),g(g.S+g.F*e(function(){i(1)}),"Object",s)}},function(H,t){H.exports=function(m,g){return{enumerable:!(1&m),configurable:!(2&m),writable:!(4&m),value:g}}},function(H,t,m){var g=m(30)("keys"),p=m(35);H.exports=function(e){return g[e]||(g[e]=p(e))}},function(H,t,m){var g=m(4),p="__core-js_shared__",e=g[p]||(g[p]={});H.exports=function(f){return e[f]||(e[f]={})}},function(H,t,m){var g=m(7),p=Math.max,e=Math.min;H.exports=function(f,u){return f=g(f),f<0?p(f+u,0):e(f,u)}},function(H,t,m){var g=m(7),p=Math.min;H.exports=function(e){return e>0?p(g(e),9007199254740991):0}},function(H,t,m){var g=m(6);H.exports=function(p){return Object(g(p))}},function(H,t,m){var g=m(5);H.exports=function(p,e){if(!g(p))return p;var f,u;if(e&&typeof(f=p.toString)=="function"&&!g(u=f.call(p))||typeof(f=p.valueOf)=="function"&&!g(u=f.call(p))||!e&&typeof(f=p.toString)=="function"&&!g(u=f.call(p)))return u;throw TypeError("Can't convert object to primitive value")}},function(H,t){var m=0,g=Math.random();H.exports=function(p){return"Symbol(".concat(p===void 0?"":p,")_",(++m+g).toString(36))}},function(H,t,m){var g=m(33),p=m(26);m(27)("keys",function(){return function(e){return p(g(e))}})},function(H,t){(function(m,g){function p(d){this.time=d.time,this.target=d.target,this.rootBounds=d.rootBounds,this.boundingClientRect=d.boundingClientRect,this.intersectionRect=d.intersectionRect||c(),this.isIntersecting=!!d.intersectionRect;var l=this.boundingClientRect,y=l.width*l.height,v=this.intersectionRect,_=v.width*v.height;y?this.intersectionRatio=_/y:this.intersectionRatio=this.isIntersecting?1:0}function e(d,l){var y=l||{};if(typeof d!="function")throw new Error("callback must be a function");if(y.root&&y.root.nodeType!=1)throw new Error("root must be an Element");this._checkForIntersections=u(this._checkForIntersections.bind(this),this.THROTTLE_TIMEOUT),this._callback=d,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(y.rootMargin),this.thresholds=this._initThresholds(y.threshold),this.root=y.root||null,this.rootMargin=this._rootMarginValues.map(function(v){return v.value+v.unit}).join(" ")}function f(){return m.performance&&performance.now&&performance.now()}function u(d,l){var y=null;return function(){y||(y=setTimeout(function(){d(),y=null},l))}}function i(d,l,y,v){typeof d.addEventListener=="function"?d.addEventListener(l,y,v||!1):typeof d.attachEvent=="function"&&d.attachEvent("on"+l,y)}function s(d,l,y,v){typeof d.removeEventListener=="function"?d.removeEventListener(l,y,v||!1):typeof d.detatchEvent=="function"&&d.detatchEvent("on"+l,y)}function o(d,l){var y=Math.max(d.top,l.top),v=Math.min(d.bottom,l.bottom),_=Math.max(d.left,l.left),x=Math.min(d.right,l.right),T=x-_,A=v-y;return T>=0&&A>=0&&{top:y,bottom:v,left:_,right:x,width:T,height:A}}function a(d){var l;try{l=d.getBoundingClientRect()}catch(y){}return l?(l.width&&l.height||(l={top:l.top,right:l.right,bottom:l.bottom,left:l.left,width:l.right-l.left,height:l.bottom-l.top}),l):c()}function c(){return{top:0,bottom:0,left:0,right:0,width:0,height:0}}function r(d,l){for(var y=l;y;){if(y==d)return!0;y=n(y)}return!1}function n(d){var l=d.parentNode;return l&&l.nodeType==11&&l.host?l.host:l}if("IntersectionObserver"in m&&"IntersectionObserverEntry"in m&&"intersectionRatio"in m.IntersectionObserverEntry.prototype)return void("isIntersecting"in m.IntersectionObserverEntry.prototype||Object.defineProperty(m.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}}));e.prototype.THROTTLE_TIMEOUT=100,e.prototype.POLL_INTERVAL=null,e.prototype.USE_MUTATION_OBSERVER=!0,e.prototype.observe=function(d){var l=this._observationTargets.some(function(y){return y.element==d});if(!l){if(!d||d.nodeType!=1)throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:d,entry:null}),this._monitorIntersections(),this._checkForIntersections()}},e.prototype.unobserve=function(d){this._observationTargets=this._observationTargets.filter(function(l){return l.element!=d}),this._observationTargets.length||(this._unmonitorIntersections(),this._unregisterInstance())},e.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorIntersections(),this._unregisterInstance()},e.prototype.takeRecords=function(){var d=this._queuedEntries.slice();return this._queuedEntries=[],d},e.prototype._initThresholds=function(d){var l=d||[0];return Array.isArray(l)||(l=[l]),l.sort().filter(function(y,v,_){if(typeof y!="number"||isNaN(y)||y<0||y>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return y!==_[v-1]})},e.prototype._parseRootMargin=function(d){var l=d||"0px",y=l.split(/\s+/).map(function(v){var _=/^(-?\d*\.?\d+)(px|%)$/.exec(v);if(!_)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(_[1]),unit:_[2]}});return y[1]=y[1]||y[0],y[2]=y[2]||y[0],y[3]=y[3]||y[1],y},e.prototype._monitorIntersections=function(){this._monitoringIntersections||(this._monitoringIntersections=!0,this.POLL_INTERVAL?this._monitoringInterval=setInterval(this._checkForIntersections,this.POLL_INTERVAL):(i(m,"resize",this._checkForIntersections,!0),i(g,"scroll",this._checkForIntersections,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in m&&(this._domObserver=new MutationObserver(this._checkForIntersections),this._domObserver.observe(g,{attributes:!0,childList:!0,characterData:!0,subtree:!0}))))},e.prototype._unmonitorIntersections=function(){this._monitoringIntersections&&(this._monitoringIntersections=!1,clearInterval(this._monitoringInterval),this._monitoringInterval=null,s(m,"resize",this._checkForIntersections,!0),s(g,"scroll",this._checkForIntersections,!0),this._domObserver&&(this._domObserver.disconnect(),this._domObserver=null))},e.prototype._checkForIntersections=function(){var d=this._rootIsInDom(),l=d?this._getRootRect():c();this._observationTargets.forEach(function(y){var v=y.element,_=a(v),x=this._rootContainsTarget(v),T=y.entry,A=d&&x&&this._computeTargetAndRootIntersection(v,l),S=y.entry=new p({time:f(),target:v,boundingClientRect:_,rootBounds:l,intersectionRect:A});T?d&&x?this._hasCrossedThreshold(T,S)&&this._queuedEntries.push(S):T&&T.isIntersecting&&this._queuedEntries.push(S):this._queuedEntries.push(S)},this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)},e.prototype._computeTargetAndRootIntersection=function(d,l){if(m.getComputedStyle(d).display!="none"){for(var y=a(d),v=y,_=n(d),x=!1;!x;){var T=null,A=_.nodeType==1?m.getComputedStyle(_):{};if(A.display=="none")return;if(_==this.root||_==g?(x=!0,T=l):_!=g.body&&_!=g.documentElement&&A.overflow!="visible"&&(T=a(_)),T&&(v=o(T,v),!v))break;_=n(_)}return v}},e.prototype._getRootRect=function(){var d;if(this.root)d=a(this.root);else{var l=g.documentElement,y=g.body;d={top:0,left:0,right:l.clientWidth||y.clientWidth,width:l.clientWidth||y.clientWidth,bottom:l.clientHeight||y.clientHeight,height:l.clientHeight||y.clientHeight}}return this._expandRectByRootMargin(d)},e.prototype._expandRectByRootMargin=function(d){var l=this._rootMarginValues.map(function(v,_){return v.unit=="px"?v.value:v.value*(_%2?d.width:d.height)/100}),y={top:d.top-l[0],right:d.right+l[1],bottom:d.bottom+l[2],left:d.left-l[3]};return y.width=y.right-y.left,y.height=y.bottom-y.top,y},e.prototype._hasCrossedThreshold=function(d,l){var y=d&&d.isIntersecting?d.intersectionRatio||0:-1,v=l.isIntersecting?l.intersectionRatio||0:-1;if(y!==v)for(var _=0;_<this.thresholds.length;_++){var x=this.thresholds[_];if(x==y||x==v||x<y!=x<v)return!0}},e.prototype._rootIsInDom=function(){return!this.root||r(g,this.root)},e.prototype._rootContainsTarget=function(d){return r(this.root||g,d)},e.prototype._registerInstance=function(){},e.prototype._unregisterInstance=function(){},m.IntersectionObserver=e,m.IntersectionObserverEntry=p})(window,document)},function(H,t){H.exports=h},function(H,t){H.exports=N}])})})(Gu);var Yh=fs(Gu.exports);const Zu=["AfterExport","AfterPlot","Animated","AnimatingFrame","AnimationInterrupted","AutoSize","BeforeExport","ButtonClicked","Click","ClickAnnotation","Deselect","DoubleClick","Framework","Hover","LegendClick","LegendDoubleClick","Relayout","Restyle","Redraw","Selected","Selecting","SliderChange","SliderEnd","SliderStart","Transitioning","TransitionInterrupted","Unhover"].map(Gn=>Gn.toLocaleLowerCase()).map(Gn=>({completeName:"plotly_"+Gn,handler:Ca=>(...h)=>{Ca.$emit.apply(Ca,[Gn,...h])}})),Wh=["restyle","relayout","update","addTraces","deleteTraces","moveTraces","extendTraces","prependTraces","purge"].reduce((Gn,Ca)=>(Gn[Ca]=function(...h){return Qs[Ca].apply(Qs,[this.$el,...h])},Gn),{});function Xh(Gn){const Ca=Object.create(null);return function(N){return Ca[N]||(Ca[N]=Gn(N))}}const Zh=/-(\w)/g,Jh=Xh(Gn=>Gn.replace(Zh,(Ca,h)=>h?h.toUpperCase():""));var Kh=function(){var Gn=this,Ca=Gn.$createElement,h=Gn._self._c||Ca;return h("div",{directives:[{name:"resize",rawName:"v-resize:debounce.100",value:Gn.onResize,expression:"onResize",arg:"debounce",modifiers:{"100":!0}}],attrs:{id:Gn.id}})},Qh=[];function $h(Gn,Ca,h,N,H,t,m,g){var p=typeof Gn=="function"?Gn.options:Gn;Ca&&(p.render=Ca,p.staticRenderFns=h,p._compiled=!0),N&&(p.functional=!0),t&&(p._scopeId="data-v-"+t);var e;if(m?(e=function(i){i=i||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!i&&typeof __VUE_SSR_CONTEXT__!="undefined"&&(i=__VUE_SSR_CONTEXT__),H&&H.call(this,i),i&&i._registeredComponents&&i._registeredComponents.add(m)},p._ssrRegister=e):H&&(e=g?function(){H.call(this,(p.functional?this.parent:this).$root.$options.shadowRoot)}:H),e)if(p.functional){p._injectStyles=e;var f=p.render;p.render=function(s,o){return e.call(o),f(s,o)}}else{var u=p.beforeCreate;p.beforeCreate=u?[].concat(u,e):[e]}return{exports:Gn,options:p}}const Ju={};typeof window!="undefined"&&(Ju.resize=Yh);const ep={name:"plotly",inheritAttrs:!1,directives:Ju,props:{data:{type:Array},layout:{type:Object},id:{type:String,required:!1,default:null}},data(){return{scheduled:null,innerLayout:xc({},this.layout)}},mounted(){Qs.newPlot(this.$el,this.data,this.innerLayout,this.options),Zu.forEach(Gn=>{this.$el.on(Gn.completeName,Gn.handler(this))})},watch:{data:{handler(){this.schedule({replot:!0})},deep:!0},options:{handler(Gn,Ca){JSON.stringify(Gn)!==JSON.stringify(Ca)&&this.schedule({replot:!0})},deep:!0},layout(Gn){this.innerLayout=xc({},Gn),this.schedule({replot:!1})}},computed:{options(){const Gn=Object.keys(this.$attrs).reduce((Ca,h)=>(Ca[Jh(h)]=this.$attrs[h],Ca),{});return xc({responsive:!1},Gn)}},beforeDestroy(){Zu.forEach(Gn=>this.$el.removeAllListeners(Gn.completeName)),Qs.purge(this.$el)},methods:Sh(xc({},Wh),{onResize(){Qs.Plots.resize(this.$el)},schedule(Gn){const{scheduled:Ca}=this;if(Ca){Ca.replot=Ca.replot||Gn.replot;return}this.scheduled=Gn,this.$nextTick(()=>{const{scheduled:{replot:h}}=this;if(this.scheduled=null,h){this.react();return}this.relayout(this.innerLayout)})},toImage(Gn){const Ca=Object.assign(this.getPrintOptions(),Gn);return Qs.toImage(this.$el,Ca)},downloadImage(Gn){const Ca=`plot--${new Date().toISOString()}`,h=Object.assign(this.getPrintOptions(),{filename:Ca},Gn);return Qs.downloadImage(this.$el,h)},getPrintOptions(){const{$el:Gn}=this;return{format:"png",width:Gn.clientWidth,height:Gn.clientHeight}},react(){Qs.react(this.$el,this.data,this.innerLayout,this.options)}})},Ku={};var tp=$h(ep,Kh,Qh,!1,rp,null,null,null);function rp(Gn){for(let Ca in Ku)this[Ca]=Ku[Ca]}var np=function(){return tp.exports}();Fo.Plotly=np,Object.defineProperty(Fo,"__esModule",{value:!0}),Fo[Symbol.toStringTag]="Module"});
